(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[function(t,e,i){(function(e){const n=i(58)("webgl"),{WebGLRenderingContext:s}=n;e.on("exit",n.cleanup);const r=s.prototype;delete r["1.0.0"],delete s["1.0.0"],t.exports={gl:r,NativeWebGL:n,NativeWebGLRenderingContext:s}}).call(this,i(12))},function(t,e){function i(t){if(t)return function(t){for(var e in i.prototype)t[e]=i.prototype[e];return t}(t)}e.Emitter=i,i.prototype.on=i.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},i.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var s=0;s<n.length;s++)if((i=n[s])===e||i.fn===e){n.splice(s,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},i.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),i=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(i){n=0;for(var s=(i=i.slice(0)).length;n<s;++n)i[n].apply(this,e)}return this},i.prototype.emitReserved=i.prototype.emit,i.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},i.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,i){"use strict";e.a="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return a}));var n=i(2);function s(t,...e){return e.reduce((e,i)=>(t.hasOwnProperty(i)&&(e[i]=t[i]),e),{})}const r=setTimeout,o=clearTimeout;function a(t,e){e.useNativeTimers?(t.setTimeoutFn=r.bind(n.a),t.clearTimeoutFn=o.bind(n.a)):(t.setTimeoutFn=setTimeout.bind(n.a),t.clearTimeoutFn=clearTimeout.bind(n.a))}},function(t,e,i){"use strict";i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return r})),i.d(e,"d",(function(){return o})),i.d(e,"b",(function(){return a}));var n=i(2);const s="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),r=n.a.WebSocket||n.a.MozWebSocket,o=!0,a="arraybuffer"},function(t,e,i){"use strict";i.d(e,"e",(function(){return v})),i.d(e,"c",(function(){return h})),i.d(e,"d",(function(){return b})),i.d(e,"a",(function(){return m})),i.d(e,"b",(function(){return y}));const n=Object.create(null);n.open="0",n.close="1",n.ping="2",n.pong="3",n.message="4",n.upgrade="5",n.noop="6";const s=Object.create(null);Object.keys(n).forEach(t=>{s[n[t]]=t});const r={type:"error",data:"parser error"},o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),a="function"==typeof ArrayBuffer,l=(t,e)=>{const i=new FileReader;return i.onload=function(){const t=i.result.split(",")[1];e("b"+t)},i.readAsDataURL(t)};for(var h=({type:t,data:e},i,s)=>{return o&&e instanceof Blob?i?s(e):l(e,s):a&&(e instanceof ArrayBuffer||(r=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer))?i?s(e):l(new Blob([e]),s):s(n[t]+(e||""));var r},c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_="undefined"==typeof Uint8Array?[]:new Uint8Array(256),u=0;u<c.length;u++)_[c.charCodeAt(u)]=u;const d="function"==typeof ArrayBuffer,p=(t,e)=>{if(d){const i=function(t){var e,i,n,s,r,o=.75*t.length,a=t.length,l=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);var h=new ArrayBuffer(o),c=new Uint8Array(h);for(e=0;e<a;e+=4)i=_[t.charCodeAt(e)],n=_[t.charCodeAt(e+1)],s=_[t.charCodeAt(e+2)],r=_[t.charCodeAt(e+3)],c[l++]=i<<2|n>>4,c[l++]=(15&n)<<4|s>>2,c[l++]=(3&s)<<6|63&r;return h}(t);return f(i,e)}return{base64:!0,data:t}},f=(t,e)=>{switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}};var m=(t,e)=>{if("string"!=typeof t)return{type:"message",data:f(t,e)};const i=t.charAt(0);if("b"===i)return{type:"message",data:p(t.substring(1),e)};return s[i]?t.length>1?{type:s[i],data:t.substring(1)}:{type:s[i]}:r};const g=String.fromCharCode(30),b=(t,e)=>{const i=t.length,n=new Array(i);let s=0;t.forEach((t,r)=>{h(t,!1,t=>{n[r]=t,++s===i&&e(n.join(g))})})},y=(t,e)=>{const i=t.split(g),n=[];for(let t=0;t<i.length;t++){const s=m(i[t],e);if(n.push(s),"error"===s.type)break}return n},v=4},function(t,e,i){"use strict";i.r(e),i.d(e,"ABSOLUTE_URL",(function(){return md})),i.d(e,"ACTION_GAMEPAD",(function(){return zx})),i.d(e,"ACTION_KEYBOARD",(function(){return Vx})),i.d(e,"ACTION_MOUSE",(function(){return Ux})),i.d(e,"ADDRESS_CLAMP_TO_EDGE",(function(){return pn})),i.d(e,"ADDRESS_MIRRORED_REPEAT",(function(){return fn})),i.d(e,"ADDRESS_REPEAT",(function(){return dn})),i.d(e,"ANIM_BLEND_1D",(function(){return Ng})),i.d(e,"ANIM_BLEND_2D_CARTESIAN",(function(){return Vg})),i.d(e,"ANIM_BLEND_2D_DIRECTIONAL",(function(){return Ug})),i.d(e,"ANIM_BLEND_DIRECT",(function(){return zg})),i.d(e,"ANIM_CONTROL_STATES",(function(){return Hg})),i.d(e,"ANIM_EQUAL_TO",(function(){return Lg})),i.d(e,"ANIM_GREATER_THAN",(function(){return Mg})),i.d(e,"ANIM_GREATER_THAN_EQUAL_TO",(function(){return Ig})),i.d(e,"ANIM_INTERRUPTION_NEXT",(function(){return Tg})),i.d(e,"ANIM_INTERRUPTION_NEXT_PREV",(function(){return Eg})),i.d(e,"ANIM_INTERRUPTION_NONE",(function(){return wg})),i.d(e,"ANIM_INTERRUPTION_PREV",(function(){return Cg})),i.d(e,"ANIM_INTERRUPTION_PREV_NEXT",(function(){return Ag})),i.d(e,"ANIM_LAYER_ADDITIVE",(function(){return Yg})),i.d(e,"ANIM_LAYER_OVERWRITE",(function(){return Xg})),i.d(e,"ANIM_LESS_THAN",(function(){return Rg})),i.d(e,"ANIM_LESS_THAN_EQUAL_TO",(function(){return Pg})),i.d(e,"ANIM_NOT_EQUAL_TO",(function(){return Dg})),i.d(e,"ANIM_PARAMETER_BOOLEAN",(function(){return Fg})),i.d(e,"ANIM_PARAMETER_FLOAT",(function(){return Og})),i.d(e,"ANIM_PARAMETER_INTEGER",(function(){return kg})),i.d(e,"ANIM_PARAMETER_TRIGGER",(function(){return Bg})),i.d(e,"ANIM_STATE_ANY",(function(){return jg})),i.d(e,"ANIM_STATE_END",(function(){return Gg})),i.d(e,"ANIM_STATE_START",(function(){return Wg})),i.d(e,"ASPECT_AUTO",(function(){return $i})),i.d(e,"ASPECT_MANUAL",(function(){return Ji})),i.d(e,"ASSET_ANIMATION",(function(){return gd})),i.d(e,"ASSET_AUDIO",(function(){return bd})),i.d(e,"ASSET_CONTAINER",(function(){return Id})),i.d(e,"ASSET_CSS",(function(){return Ed})),i.d(e,"ASSET_CUBEMAP",(function(){return Td})),i.d(e,"ASSET_HTML",(function(){return Md})),i.d(e,"ASSET_IMAGE",(function(){return yd})),i.d(e,"ASSET_JSON",(function(){return vd})),i.d(e,"ASSET_MATERIAL",(function(){return xd})),i.d(e,"ASSET_MODEL",(function(){return Sd})),i.d(e,"ASSET_SCRIPT",(function(){return Rd})),i.d(e,"ASSET_SHADER",(function(){return Ad})),i.d(e,"ASSET_TEXT",(function(){return wd})),i.d(e,"ASSET_TEXTURE",(function(){return Cd})),i.d(e,"AXIS_KEY",(function(){return qx})),i.d(e,"AXIS_MOUSE_X",(function(){return Wx})),i.d(e,"AXIS_MOUSE_Y",(function(){return Gx})),i.d(e,"AXIS_PAD_L_X",(function(){return jx})),i.d(e,"AXIS_PAD_L_Y",(function(){return Hx})),i.d(e,"AXIS_PAD_R_X",(function(){return Xx})),i.d(e,"AXIS_PAD_R_Y",(function(){return Yx})),i.d(e,"AnimBinder",(function(){return rd})),i.d(e,"AnimClip",(function(){return xg})),i.d(e,"AnimClipHandler",(function(){return dp})),i.d(e,"AnimComponent",(function(){return vb})),i.d(e,"AnimComponentLayer",(function(){return yb})),i.d(e,"AnimComponentSystem",(function(){return wb})),i.d(e,"AnimController",(function(){return ub})),i.d(e,"AnimCurve",(function(){return ed})),i.d(e,"AnimData",(function(){return id})),i.d(e,"AnimEvaluator",(function(){return Kg})),i.d(e,"AnimEvents",(function(){return nd})),i.d(e,"AnimSnapshot",(function(){return Sg})),i.d(e,"AnimStateGraph",(function(){return pp})),i.d(e,"AnimStateGraphHandler",(function(){return fp})),i.d(e,"AnimTarget",(function(){return Zg})),i.d(e,"AnimTrack",(function(){return sd})),i.d(e,"Animation",(function(){return Qu})),i.d(e,"AnimationComponent",(function(){return tb})),i.d(e,"AnimationComponentSystem",(function(){return nb})),i.d(e,"AnimationHandler",(function(){return up})),i.d(e,"Application",(function(){return hA})),i.d(e,"Asset",(function(){return Od})),i.d(e,"AssetListLoader",(function(){return hM})),i.d(e,"AssetReference",(function(){return Kp})),i.d(e,"AssetRegistry",(function(){return lm})),i.d(e,"AudioHandler",(function(){return yp})),i.d(e,"AudioListenerComponent",(function(){return Cb})),i.d(e,"AudioListenerComponentSystem",(function(){return Eb})),i.d(e,"AudioSourceComponent",(function(){return Mb})),i.d(e,"AudioSourceComponentSystem",(function(){return Pb})),i.d(e,"BAKE_COLOR",(function(){return Bi})),i.d(e,"BAKE_COLORDIR",(function(){return Ni})),i.d(e,"BLENDEQUATION_ADD",(function(){return En})),i.d(e,"BLENDEQUATION_MAX",(function(){return Pn})),i.d(e,"BLENDEQUATION_MIN",(function(){return In})),i.d(e,"BLENDEQUATION_REVERSE_SUBTRACT",(function(){return Rn})),i.d(e,"BLENDEQUATION_SUBTRACT",(function(){return Mn})),i.d(e,"BLENDMODE_DST_ALPHA",(function(){return Tn})),i.d(e,"BLENDMODE_DST_COLOR",(function(){return vn})),i.d(e,"BLENDMODE_ONE",(function(){return gn})),i.d(e,"BLENDMODE_ONE_MINUS_DST_ALPHA",(function(){return An})),i.d(e,"BLENDMODE_ONE_MINUS_DST_COLOR",(function(){return Sn})),i.d(e,"BLENDMODE_ONE_MINUS_SRC_ALPHA",(function(){return Cn})),i.d(e,"BLENDMODE_ONE_MINUS_SRC_COLOR",(function(){return yn})),i.d(e,"BLENDMODE_SRC_ALPHA",(function(){return xn})),i.d(e,"BLENDMODE_SRC_ALPHA_SATURATE",(function(){return wn})),i.d(e,"BLENDMODE_SRC_COLOR",(function(){return bn})),i.d(e,"BLENDMODE_ZERO",(function(){return mn})),i.d(e,"BLEND_ADDITIVE",(function(){return It})),i.d(e,"BLEND_ADDITIVEALPHA",(function(){return Ot})),i.d(e,"BLEND_MAX",(function(){return Ut})),i.d(e,"BLEND_MIN",(function(){return Nt})),i.d(e,"BLEND_MULTIPLICATIVE",(function(){return kt})),i.d(e,"BLEND_MULTIPLICATIVE2X",(function(){return Ft})),i.d(e,"BLEND_NONE",(function(){return Lt})),i.d(e,"BLEND_NORMAL",(function(){return Pt})),i.d(e,"BLEND_PREMULTIPLIED",(function(){return Dt})),i.d(e,"BLEND_SCREEN",(function(){return Bt})),i.d(e,"BLEND_SUBTRACTIVE",(function(){return Rt})),i.d(e,"BLUR_BOX",(function(){return be})),i.d(e,"BLUR_GAUSSIAN",(function(){return ye})),i.d(e,"BODYFLAG_KINEMATIC_OBJECT",(function(){return oy})),i.d(e,"BODYFLAG_NORESPONSE_OBJECT",(function(){return ay})),i.d(e,"BODYFLAG_STATIC_OBJECT",(function(){return ry})),i.d(e,"BODYGROUP_DEFAULT",(function(){return py})),i.d(e,"BODYGROUP_DYNAMIC",(function(){return fy})),i.d(e,"BODYGROUP_ENGINE_1",(function(){return by})),i.d(e,"BODYGROUP_ENGINE_2",(function(){return vy})),i.d(e,"BODYGROUP_ENGINE_3",(function(){return Sy})),i.d(e,"BODYGROUP_KINEMATIC",(function(){return gy})),i.d(e,"BODYGROUP_NONE",(function(){return dy})),i.d(e,"BODYGROUP_STATIC",(function(){return my})),i.d(e,"BODYGROUP_TRIGGER",(function(){return yy})),i.d(e,"BODYGROUP_USER_1",(function(){return xy})),i.d(e,"BODYGROUP_USER_2",(function(){return wy})),i.d(e,"BODYGROUP_USER_3",(function(){return Cy})),i.d(e,"BODYGROUP_USER_4",(function(){return Ty})),i.d(e,"BODYGROUP_USER_5",(function(){return Ay})),i.d(e,"BODYGROUP_USER_6",(function(){return Ey})),i.d(e,"BODYGROUP_USER_7",(function(){return My})),i.d(e,"BODYGROUP_USER_8",(function(){return Ry})),i.d(e,"BODYMASK_ALL",(function(){return Py})),i.d(e,"BODYMASK_NONE",(function(){return Iy})),i.d(e,"BODYMASK_NOT_STATIC",(function(){return Dy})),i.d(e,"BODYMASK_NOT_STATIC_KINEMATIC",(function(){return ky})),i.d(e,"BODYMASK_STATIC",(function(){return Ly})),i.d(e,"BODYSTATE_ACTIVE_TAG",(function(){return ly})),i.d(e,"BODYSTATE_DISABLE_DEACTIVATION",(function(){return _y})),i.d(e,"BODYSTATE_DISABLE_SIMULATION",(function(){return uy})),i.d(e,"BODYSTATE_ISLAND_SLEEPING",(function(){return hy})),i.d(e,"BODYSTATE_WANTS_DEACTIVATION",(function(){return cy})),i.d(e,"BODYTYPE_DYNAMIC",(function(){return ny})),i.d(e,"BODYTYPE_KINEMATIC",(function(){return sy})),i.d(e,"BODYTYPE_STATIC",(function(){return iy})),i.d(e,"BUFFER_DYNAMIC",(function(){return Dn})),i.d(e,"BUFFER_GPUDYNAMIC",(function(){return On})),i.d(e,"BUFFER_STATIC",(function(){return Ln})),i.d(e,"BUFFER_STREAM",(function(){return kn})),i.d(e,"BUTTON_TRANSITION_MODE_SPRITE_CHANGE",(function(){return kb})),i.d(e,"BUTTON_TRANSITION_MODE_TINT",(function(){return Db})),i.d(e,"BasicMaterial",(function(){return Fh})),i.d(e,"Batch",(function(){return Bh})),i.d(e,"BatchGroup",(function(){return Nh})),i.d(e,"BatchManager",(function(){return rc})),i.d(e,"BinaryHandler",(function(){return vp})),i.d(e,"BoundingBox",(function(){return Tt})),i.d(e,"BoundingSphere",(function(){return Mt})),i.d(e,"Bundle",(function(){return Sp})),i.d(e,"BundleHandler",(function(){return Ap})),i.d(e,"BundleRegistry",(function(){return hm})),i.d(e,"ButtonComponent",(function(){return Wb})),i.d(e,"ButtonComponentSystem",(function(){return Hb})),i.d(e,"CLEARFLAG_COLOR",(function(){return Fn})),i.d(e,"CLEARFLAG_DEPTH",(function(){return Bn})),i.d(e,"CLEARFLAG_STENCIL",(function(){return Nn})),i.d(e,"COMPUPDATED_BLEND",(function(){return Qi})),i.d(e,"COMPUPDATED_CAMERAS",(function(){return Zi})),i.d(e,"COMPUPDATED_INSTANCES",(function(){return qi})),i.d(e,"COMPUPDATED_LIGHTS",(function(){return Ki})),i.d(e,"CUBEFACE_NEGX",(function(){return Vn})),i.d(e,"CUBEFACE_NEGY",(function(){return Wn})),i.d(e,"CUBEFACE_NEGZ",(function(){return jn})),i.d(e,"CUBEFACE_POSX",(function(){return Un})),i.d(e,"CUBEFACE_POSY",(function(){return zn})),i.d(e,"CUBEFACE_POSZ",(function(){return Gn})),i.d(e,"CUBEPROJ_BOX",(function(){return Be})),i.d(e,"CUBEPROJ_NONE",(function(){return Fe})),i.d(e,"CULLFACE_BACK",(function(){return Xn})),i.d(e,"CULLFACE_FRONT",(function(){return Yn})),i.d(e,"CULLFACE_FRONTANDBACK",(function(){return qn})),i.d(e,"CULLFACE_NONE",(function(){return Hn})),i.d(e,"CURVE_CARDINAL",(function(){return it})),i.d(e,"CURVE_CATMULL",(function(){return et})),i.d(e,"CURVE_LINEAR",(function(){return J})),i.d(e,"CURVE_SMOOTHSTEP",(function(){return tt})),i.d(e,"CURVE_SPLINE",(function(){return nt})),i.d(e,"CURVE_STEP",(function(){return st})),i.d(e,"Camera",(function(){return ma})),i.d(e,"CameraComponent",(function(){return Zb})),i.d(e,"CameraComponentSystem",(function(){return Jb})),i.d(e,"CanvasFont",(function(){return xA})),i.d(e,"CollisionComponent",(function(){return ty})),i.d(e,"CollisionComponentSystem",(function(){return $y})),i.d(e,"Color",(function(){return rt})),i.d(e,"Command",(function(){return qh})),i.d(e,"Component",(function(){return gg})),i.d(e,"ComponentSystem",(function(){return bg})),i.d(e,"ComponentSystemRegistry",(function(){return Jy})),i.d(e,"ContactPoint",(function(){return ix})),i.d(e,"ContactResult",(function(){return nx})),i.d(e,"ContainerHandler",(function(){return Ip})),i.d(e,"ContainerResource",(function(){return Rp})),i.d(e,"ContextCreationError",(function(){return zE})),i.d(e,"Controller",(function(){return VA})),i.d(e,"CssHandler",(function(){return Pp})),i.d(e,"CubemapHandler",(function(){return Dp})),i.d(e,"Curve",(function(){return at})),i.d(e,"CurveSet",(function(){return lt})),i.d(e,"DETAILMODE_ADD",(function(){return ze})),i.d(e,"DETAILMODE_MAX",(function(){return He})),i.d(e,"DETAILMODE_MIN",(function(){return je})),i.d(e,"DETAILMODE_MUL",(function(){return Ve})),i.d(e,"DETAILMODE_OVERLAY",(function(){return Ge})),i.d(e,"DETAILMODE_SCREEN",(function(){return We})),i.d(e,"DISTANCE_EXPONENTIAL",(function(){return Hu})),i.d(e,"DISTANCE_INVERSE",(function(){return ju})),i.d(e,"DISTANCE_LINEAR",(function(){return Gu})),i.d(e,"DefaultAnimBinder",(function(){return Qg})),i.d(e,"DepthMaterial",(function(){return oc})),i.d(e,"ELEMENTTYPE_FLOAT32",(function(){return UE})),i.d(e,"ELEMENTTYPE_GROUP",(function(){return tv})),i.d(e,"ELEMENTTYPE_IMAGE",(function(){return ev})),i.d(e,"ELEMENTTYPE_INT16",(function(){return OE})),i.d(e,"ELEMENTTYPE_INT32",(function(){return BE})),i.d(e,"ELEMENTTYPE_INT8",(function(){return DE})),i.d(e,"ELEMENTTYPE_TEXT",(function(){return iv})),i.d(e,"ELEMENTTYPE_UINT16",(function(){return FE})),i.d(e,"ELEMENTTYPE_UINT32",(function(){return NE})),i.d(e,"ELEMENTTYPE_UINT8",(function(){return kE})),i.d(e,"EMITTERSHAPE_BOX",(function(){return Ae})),i.d(e,"EMITTERSHAPE_SPHERE",(function(){return Ee})),i.d(e,"EVENT_KEYDOWN",(function(){return Kx})),i.d(e,"EVENT_KEYUP",(function(){return Zx})),i.d(e,"EVENT_MOUSEDOWN",(function(){return Qx})),i.d(e,"EVENT_MOUSEMOVE",(function(){return $x})),i.d(e,"EVENT_MOUSEUP",(function(){return Jx})),i.d(e,"EVENT_MOUSEWHEEL",(function(){return tw})),i.d(e,"EVENT_SELECT",(function(){return rw})),i.d(e,"EVENT_SELECTEND",(function(){return aw})),i.d(e,"EVENT_SELECTSTART",(function(){return ow})),i.d(e,"EVENT_TOUCHCANCEL",(function(){return sw})),i.d(e,"EVENT_TOUCHEND",(function(){return iw})),i.d(e,"EVENT_TOUCHMOVE",(function(){return nw})),i.d(e,"EVENT_TOUCHSTART",(function(){return ew})),i.d(e,"ElementComponent",(function(){return Pv})),i.d(e,"ElementComponentSystem",(function(){return Ov})),i.d(e,"ElementDragHelper",(function(){return Dx})),i.d(e,"ElementInput",(function(){return vE})),i.d(e,"ElementInputEvent",(function(){return mE})),i.d(e,"ElementMouseEvent",(function(){return gE})),i.d(e,"ElementSelectEvent",(function(){return yE})),i.d(e,"ElementTouchEvent",(function(){return bE})),i.d(e,"Entity",(function(){return uA})),i.d(e,"EntityReference",(function(){return Lb})),i.d(e,"EventHandler",(function(){return x})),i.d(e,"FILLMODE_FILL_WINDOW",(function(){return pm})),i.d(e,"FILLMODE_KEEP_ASPECT",(function(){return fm})),i.d(e,"FILLMODE_NONE",(function(){return dm})),i.d(e,"FILTER_LINEAR",(function(){return Zn})),i.d(e,"FILTER_LINEAR_MIPMAP_LINEAR",(function(){return ts})),i.d(e,"FILTER_LINEAR_MIPMAP_NEAREST",(function(){return Jn})),i.d(e,"FILTER_NEAREST",(function(){return Kn})),i.d(e,"FILTER_NEAREST_MIPMAP_LINEAR",(function(){return $n})),i.d(e,"FILTER_NEAREST_MIPMAP_NEAREST",(function(){return Qn})),i.d(e,"FITTING_BOTH",(function(){return Jv})),i.d(e,"FITTING_NONE",(function(){return Zv})),i.d(e,"FITTING_SHRINK",(function(){return $v})),i.d(e,"FITTING_STRETCH",(function(){return Qv})),i.d(e,"FOG_EXP",(function(){return Wt})),i.d(e,"FOG_EXP2",(function(){return Gt})),i.d(e,"FOG_LINEAR",(function(){return zt})),i.d(e,"FOG_NONE",(function(){return Vt})),i.d(e,"FONT_BITMAP",(function(){return Fp})),i.d(e,"FONT_MSDF",(function(){return Op})),i.d(e,"FRESNEL_NONE",(function(){return jt})),i.d(e,"FRESNEL_SCHLICK",(function(){return Ht})),i.d(e,"FUNC_ALWAYS",(function(){return ls})),i.d(e,"FUNC_EQUAL",(function(){return ns})),i.d(e,"FUNC_GREATER",(function(){return rs})),i.d(e,"FUNC_GREATEREQUAL",(function(){return as})),i.d(e,"FUNC_LESS",(function(){return is})),i.d(e,"FUNC_LESSEQUAL",(function(){return ss})),i.d(e,"FUNC_NEVER",(function(){return es})),i.d(e,"FUNC_NOTEQUAL",(function(){return os})),i.d(e,"FolderHandler",(function(){return kp})),i.d(e,"Font",(function(){return Bp})),i.d(e,"FontHandler",(function(){return Up})),i.d(e,"ForwardRenderer",(function(){return d_})),i.d(e,"Frustum",(function(){return sn})),i.d(e,"GAMMA_NONE",(function(){return Xe})),i.d(e,"GAMMA_SRGB",(function(){return Ye})),i.d(e,"GAMMA_SRGBFAST",(function(){return qe})),i.d(e,"GAMMA_SRGBHDR",(function(){return Ke})),i.d(e,"GamePads",(function(){return wE})),i.d(e,"GraphNode",(function(){return La})),i.d(e,"GraphicsDevice",(function(){return zl})),i.d(e,"HierarchyHandler",(function(){return Xp})),i.d(e,"HtmlHandler",(function(){return Yp})),i.d(e,"Http",(function(){return Q})),i.d(e,"I18n",(function(){return um})),i.d(e,"INDEXFORMAT_UINT16",(function(){return cs})),i.d(e,"INDEXFORMAT_UINT32",(function(){return _s})),i.d(e,"INDEXFORMAT_UINT8",(function(){return hs})),i.d(e,"INTERPOLATION_CUBIC",(function(){return ld})),i.d(e,"INTERPOLATION_LINEAR",(function(){return ad})),i.d(e,"INTERPOLATION_STEP",(function(){return od})),i.d(e,"ImageElement",(function(){return rv})),i.d(e,"IndexBuffer",(function(){return $l})),i.d(e,"IndexedList",(function(){return W})),i.d(e,"JointComponent",(function(){return Vv})),i.d(e,"JointComponentSystem",(function(){return jv})),i.d(e,"JsonHandler",(function(){return qp})),i.d(e,"JsonStandardMaterialParser",(function(){return $p})),i.d(e,"KEY_0",(function(){return Iw})),i.d(e,"KEY_1",(function(){return Pw})),i.d(e,"KEY_2",(function(){return Lw})),i.d(e,"KEY_3",(function(){return Dw})),i.d(e,"KEY_4",(function(){return kw})),i.d(e,"KEY_5",(function(){return Ow})),i.d(e,"KEY_6",(function(){return Fw})),i.d(e,"KEY_7",(function(){return Bw})),i.d(e,"KEY_8",(function(){return Nw})),i.d(e,"KEY_9",(function(){return Uw})),i.d(e,"KEY_A",(function(){return Ww})),i.d(e,"KEY_ADD",(function(){return EC})),i.d(e,"KEY_ALT",(function(){return pw})),i.d(e,"KEY_B",(function(){return Gw})),i.d(e,"KEY_BACKSPACE",(function(){return lw})),i.d(e,"KEY_BACK_SLASH",(function(){return qC})),i.d(e,"KEY_C",(function(){return jw})),i.d(e,"KEY_CAPS_LOCK",(function(){return mw})),i.d(e,"KEY_CLOSE_BRACKET",(function(){return KC})),i.d(e,"KEY_COMMA",(function(){return jC})),i.d(e,"KEY_CONTEXT_MENU",(function(){return fC})),i.d(e,"KEY_CONTROL",(function(){return dw})),i.d(e,"KEY_D",(function(){return Hw})),i.d(e,"KEY_DECIMAL",(function(){return IC})),i.d(e,"KEY_DELETE",(function(){return Rw})),i.d(e,"KEY_DIVIDE",(function(){return PC})),i.d(e,"KEY_DOWN",(function(){return Aw})),i.d(e,"KEY_E",(function(){return Xw})),i.d(e,"KEY_END",(function(){return Sw})),i.d(e,"KEY_ENTER",(function(){return _w})),i.d(e,"KEY_EQUAL",(function(){return zw})),i.d(e,"KEY_ESCAPE",(function(){return gw})),i.d(e,"KEY_F",(function(){return Yw})),i.d(e,"KEY_F1",(function(){return LC})),i.d(e,"KEY_F10",(function(){return zC})),i.d(e,"KEY_F11",(function(){return WC})),i.d(e,"KEY_F12",(function(){return GC})),i.d(e,"KEY_F2",(function(){return DC})),i.d(e,"KEY_F3",(function(){return kC})),i.d(e,"KEY_F4",(function(){return OC})),i.d(e,"KEY_F5",(function(){return FC})),i.d(e,"KEY_F6",(function(){return BC})),i.d(e,"KEY_F7",(function(){return NC})),i.d(e,"KEY_F8",(function(){return UC})),i.d(e,"KEY_F9",(function(){return VC})),i.d(e,"KEY_G",(function(){return qw})),i.d(e,"KEY_H",(function(){return Kw})),i.d(e,"KEY_HOME",(function(){return xw})),i.d(e,"KEY_I",(function(){return Zw})),i.d(e,"KEY_INSERT",(function(){return Mw})),i.d(e,"KEY_J",(function(){return Qw})),i.d(e,"KEY_K",(function(){return $w})),i.d(e,"KEY_L",(function(){return Jw})),i.d(e,"KEY_LEFT",(function(){return ww})),i.d(e,"KEY_M",(function(){return tC})),i.d(e,"KEY_META",(function(){return ZC})),i.d(e,"KEY_MULTIPLY",(function(){return AC})),i.d(e,"KEY_N",(function(){return eC})),i.d(e,"KEY_NUMPAD_0",(function(){return mC})),i.d(e,"KEY_NUMPAD_1",(function(){return gC})),i.d(e,"KEY_NUMPAD_2",(function(){return bC})),i.d(e,"KEY_NUMPAD_3",(function(){return yC})),i.d(e,"KEY_NUMPAD_4",(function(){return vC})),i.d(e,"KEY_NUMPAD_5",(function(){return SC})),i.d(e,"KEY_NUMPAD_6",(function(){return xC})),i.d(e,"KEY_NUMPAD_7",(function(){return wC})),i.d(e,"KEY_NUMPAD_8",(function(){return CC})),i.d(e,"KEY_NUMPAD_9",(function(){return TC})),i.d(e,"KEY_O",(function(){return iC})),i.d(e,"KEY_OPEN_BRACKET",(function(){return YC})),i.d(e,"KEY_P",(function(){return nC})),i.d(e,"KEY_PAGE_DOWN",(function(){return vw})),i.d(e,"KEY_PAGE_UP",(function(){return yw})),i.d(e,"KEY_PAUSE",(function(){return fw})),i.d(e,"KEY_PERIOD",(function(){return HC})),i.d(e,"KEY_PRINT_SCREEN",(function(){return Ew})),i.d(e,"KEY_Q",(function(){return sC})),i.d(e,"KEY_R",(function(){return rC})),i.d(e,"KEY_RETURN",(function(){return cw})),i.d(e,"KEY_RIGHT",(function(){return Tw})),i.d(e,"KEY_S",(function(){return oC})),i.d(e,"KEY_SEMICOLON",(function(){return Vw})),i.d(e,"KEY_SEPARATOR",(function(){return MC})),i.d(e,"KEY_SHIFT",(function(){return uw})),i.d(e,"KEY_SLASH",(function(){return XC})),i.d(e,"KEY_SPACE",(function(){return bw})),i.d(e,"KEY_SUBTRACT",(function(){return RC})),i.d(e,"KEY_T",(function(){return aC})),i.d(e,"KEY_TAB",(function(){return hw})),i.d(e,"KEY_U",(function(){return lC})),i.d(e,"KEY_UP",(function(){return Cw})),i.d(e,"KEY_V",(function(){return hC})),i.d(e,"KEY_W",(function(){return cC})),i.d(e,"KEY_WINDOWS",(function(){return pC})),i.d(e,"KEY_X",(function(){return _C})),i.d(e,"KEY_Y",(function(){return uC})),i.d(e,"KEY_Z",(function(){return dC})),i.d(e,"Key",(function(){return Ku})),i.d(e,"Keyboard",(function(){return FA})),i.d(e,"KeyboardEvent",(function(){return PA})),i.d(e,"LAYERID_DEPTH",(function(){return Qt})),i.d(e,"LAYERID_IMMEDIATE",(function(){return Jt})),i.d(e,"LAYERID_SKYBOX",(function(){return $t})),i.d(e,"LAYERID_UI",(function(){return te})),i.d(e,"LAYERID_WORLD",(function(){return Zt})),i.d(e,"LAYER_FX",(function(){return qt})),i.d(e,"LAYER_GIZMO",(function(){return Yt})),i.d(e,"LAYER_HUD",(function(){return Xt})),i.d(e,"LAYER_WORLD",(function(){return Kt})),i.d(e,"LIGHTFALLOFF_INVERSESQUARED",(function(){return ce})),i.d(e,"LIGHTFALLOFF_LINEAR",(function(){return he})),i.d(e,"LIGHTSHAPE_DISK",(function(){return ae})),i.d(e,"LIGHTSHAPE_PUNCTUAL",(function(){return re})),i.d(e,"LIGHTSHAPE_RECT",(function(){return oe})),i.d(e,"LIGHTSHAPE_SPHERE",(function(){return le})),i.d(e,"LIGHTTYPE_DIRECTIONAL",(function(){return ee})),i.d(e,"LIGHTTYPE_OMNI",(function(){return ie})),i.d(e,"LIGHTTYPE_POINT",(function(){return ne})),i.d(e,"LIGHTTYPE_SPOT",(function(){return se})),i.d(e,"LINEBATCH_GIZMO",(function(){return vi})),i.d(e,"LINEBATCH_OVERLAY",(function(){return yi})),i.d(e,"LINEBATCH_WORLD",(function(){return bi})),i.d(e,"Layer",(function(){return w_})),i.d(e,"LayerComposition",(function(){return Ja})),i.d(e,"LayoutCalculator",(function(){return hS})),i.d(e,"LayoutChildComponent",(function(){return Hv})),i.d(e,"LayoutChildComponentSystem",(function(){return Kv})),i.d(e,"LayoutGroupComponent",(function(){return uS})),i.d(e,"LayoutGroupComponentSystem",(function(){return mS})),i.d(e,"Light",(function(){return P_})),i.d(e,"LightComponent",(function(){return yS})),i.d(e,"LightComponentSystem",(function(){return wS})),i.d(e,"Lightmapper",(function(){return bA})),i.d(e,"LocalizedAsset",(function(){return ov})),i.d(e,"MASK_BAKED",(function(){return Ei})),i.d(e,"MASK_DYNAMIC",(function(){return Ai})),i.d(e,"MASK_LIGHTMAP",(function(){return Mi})),i.d(e,"MOTION_FREE",(function(){return Fv})),i.d(e,"MOTION_LIMITED",(function(){return Bv})),i.d(e,"MOTION_LOCKED",(function(){return Nv})),i.d(e,"MOUSEBUTTON_LEFT",(function(){return $C})),i.d(e,"MOUSEBUTTON_MIDDLE",(function(){return JC})),i.d(e,"MOUSEBUTTON_NONE",(function(){return QC})),i.d(e,"MOUSEBUTTON_RIGHT",(function(){return tT})),i.d(e,"Mat3",(function(){return ct})),i.d(e,"Mat4",(function(){return bt})),i.d(e,"Material",(function(){return pl})),i.d(e,"MaterialHandler",(function(){return tf})),i.d(e,"Mesh",(function(){return xh})),i.d(e,"MeshInstance",(function(){return Kh})),i.d(e,"Model",(function(){return Uu})),i.d(e,"ModelComponent",(function(){return CS})),i.d(e,"ModelComponentSystem",(function(){return ES})),i.d(e,"ModelHandler",(function(){return hf})),i.d(e,"Morph",(function(){return Bu})),i.d(e,"MorphInstance",(function(){return Nu})),i.d(e,"MorphTarget",(function(){return $u})),i.d(e,"Mouse",(function(){return UA})),i.d(e,"MouseEvent",(function(){return NA})),i.d(e,"Node",(function(){return Zu})),i.d(e,"ORIENTATION_HORIZONTAL",(function(){return tn})),i.d(e,"ORIENTATION_VERTICAL",(function(){return en})),i.d(e,"OrientedBox",(function(){return cn})),i.d(e,"PAD_1",(function(){return eT})),i.d(e,"PAD_2",(function(){return iT})),i.d(e,"PAD_3",(function(){return nT})),i.d(e,"PAD_4",(function(){return sT})),i.d(e,"PAD_DOWN",(function(){return bT})),i.d(e,"PAD_FACE_1",(function(){return rT})),i.d(e,"PAD_FACE_2",(function(){return oT})),i.d(e,"PAD_FACE_3",(function(){return aT})),i.d(e,"PAD_FACE_4",(function(){return lT})),i.d(e,"PAD_LEFT",(function(){return yT})),i.d(e,"PAD_L_SHOULDER_1",(function(){return hT})),i.d(e,"PAD_L_SHOULDER_2",(function(){return _T})),i.d(e,"PAD_L_STICK_BUTTON",(function(){return fT})),i.d(e,"PAD_L_STICK_X",(function(){return xT})),i.d(e,"PAD_L_STICK_Y",(function(){return wT})),i.d(e,"PAD_RIGHT",(function(){return vT})),i.d(e,"PAD_R_SHOULDER_1",(function(){return cT})),i.d(e,"PAD_R_SHOULDER_2",(function(){return uT})),i.d(e,"PAD_R_STICK_BUTTON",(function(){return mT})),i.d(e,"PAD_R_STICK_X",(function(){return CT})),i.d(e,"PAD_R_STICK_Y",(function(){return TT})),i.d(e,"PAD_SELECT",(function(){return dT})),i.d(e,"PAD_START",(function(){return pT})),i.d(e,"PAD_UP",(function(){return gT})),i.d(e,"PAD_VENDOR",(function(){return ST})),i.d(e,"PARTICLEMODE_CPU",(function(){return Te})),i.d(e,"PARTICLEMODE_GPU",(function(){return Ce})),i.d(e,"PARTICLEORIENTATION_EMITTER",(function(){return Ie})),i.d(e,"PARTICLEORIENTATION_SCREEN",(function(){return Me})),i.d(e,"PARTICLEORIENTATION_WORLD",(function(){return Re})),i.d(e,"PARTICLESORT_DISTANCE",(function(){return Se})),i.d(e,"PARTICLESORT_NEWER_FIRST",(function(){return xe})),i.d(e,"PARTICLESORT_NONE",(function(){return ve})),i.d(e,"PARTICLESORT_OLDER_FIRST",(function(){return we})),i.d(e,"PIXELFORMAT_111110F",(function(){return Is})),i.d(e,"PIXELFORMAT_A8",(function(){return us})),i.d(e,"PIXELFORMAT_ASTC_4x4",(function(){return Vs})),i.d(e,"PIXELFORMAT_ATC_RGB",(function(){return zs})),i.d(e,"PIXELFORMAT_ATC_RGBA",(function(){return Ws})),i.d(e,"PIXELFORMAT_DEPTH",(function(){return Ms})),i.d(e,"PIXELFORMAT_DEPTHSTENCIL",(function(){return Rs})),i.d(e,"PIXELFORMAT_DXT1",(function(){return vs})),i.d(e,"PIXELFORMAT_DXT3",(function(){return Ss})),i.d(e,"PIXELFORMAT_DXT5",(function(){return xs})),i.d(e,"PIXELFORMAT_ETC1",(function(){return Ds})),i.d(e,"PIXELFORMAT_ETC2_RGB",(function(){return ks})),i.d(e,"PIXELFORMAT_ETC2_RGBA",(function(){return Os})),i.d(e,"PIXELFORMAT_L8",(function(){return ds})),i.d(e,"PIXELFORMAT_L8_A8",(function(){return ps})),i.d(e,"PIXELFORMAT_PVRTC_2BPP_RGBA_1",(function(){return Bs})),i.d(e,"PIXELFORMAT_PVRTC_2BPP_RGB_1",(function(){return Fs})),i.d(e,"PIXELFORMAT_PVRTC_4BPP_RGBA_1",(function(){return Us})),i.d(e,"PIXELFORMAT_PVRTC_4BPP_RGB_1",(function(){return Ns})),i.d(e,"PIXELFORMAT_R32F",(function(){return Es})),i.d(e,"PIXELFORMAT_R4_G4_B4_A4",(function(){return gs})),i.d(e,"PIXELFORMAT_R5_G5_B5_A1",(function(){return ms})),i.d(e,"PIXELFORMAT_R5_G6_B5",(function(){return fs})),i.d(e,"PIXELFORMAT_R8_G8_B8",(function(){return bs})),i.d(e,"PIXELFORMAT_R8_G8_B8_A8",(function(){return ys})),i.d(e,"PIXELFORMAT_RGB16F",(function(){return ws})),i.d(e,"PIXELFORMAT_RGB32F",(function(){return Ts})),i.d(e,"PIXELFORMAT_RGBA16F",(function(){return Cs})),i.d(e,"PIXELFORMAT_RGBA32F",(function(){return As})),i.d(e,"PIXELFORMAT_SRGB",(function(){return Ps})),i.d(e,"PIXELFORMAT_SRGBA",(function(){return Ls})),i.d(e,"PRIMITIVE_LINELOOP",(function(){return Hs})),i.d(e,"PRIMITIVE_LINES",(function(){return js})),i.d(e,"PRIMITIVE_LINESTRIP",(function(){return Xs})),i.d(e,"PRIMITIVE_POINTS",(function(){return Gs})),i.d(e,"PRIMITIVE_TRIANGLES",(function(){return Ys})),i.d(e,"PRIMITIVE_TRIFAN",(function(){return Ks})),i.d(e,"PRIMITIVE_TRISTRIP",(function(){return qs})),i.d(e,"PROJECTION_ORTHOGRAPHIC",(function(){return Le})),i.d(e,"PROJECTION_PERSPECTIVE",(function(){return Pe})),i.d(e,"ParticleEmitter",(function(){return Fu})),i.d(e,"ParticleSystemComponent",(function(){return NS})),i.d(e,"ParticleSystemComponentSystem",(function(){return zS})),i.d(e,"PhongMaterial",(function(){return jE})),i.d(e,"Picker",(function(){return SA})),i.d(e,"Plane",(function(){return un})),i.d(e,"PostEffect",(function(){return ph})),i.d(e,"PostEffectQueue",(function(){return qb})),i.d(e,"ProgramLibrary",(function(){return Ll})),i.d(e,"Quat",(function(){return yt})),i.d(e,"RENDERSTYLE_POINTS",(function(){return Oe})),i.d(e,"RENDERSTYLE_SOLID",(function(){return De})),i.d(e,"RENDERSTYLE_WIREFRAME",(function(){return ke})),i.d(e,"RESOLUTION_AUTO",(function(){return mm})),i.d(e,"RESOLUTION_FIXED",(function(){return gm})),i.d(e,"RIGIDBODY_ACTIVE_TAG",(function(){return iM})),i.d(e,"RIGIDBODY_CF_KINEMATIC_OBJECT",(function(){return tM})),i.d(e,"RIGIDBODY_CF_NORESPONSE_OBJECT",(function(){return eM})),i.d(e,"RIGIDBODY_CF_STATIC_OBJECT",(function(){return JE})),i.d(e,"RIGIDBODY_DISABLE_DEACTIVATION",(function(){return rM})),i.d(e,"RIGIDBODY_DISABLE_SIMULATION",(function(){return oM})),i.d(e,"RIGIDBODY_ISLAND_SLEEPING",(function(){return nM})),i.d(e,"RIGIDBODY_TYPE_DYNAMIC",(function(){return QE})),i.d(e,"RIGIDBODY_TYPE_KINEMATIC",(function(){return $E})),i.d(e,"RIGIDBODY_TYPE_STATIC",(function(){return ZE})),i.d(e,"RIGIDBODY_WANTS_DEACTIVATION",(function(){return sM})),i.d(e,"Ray",(function(){return rn})),i.d(e,"RaycastResult",(function(){return tx})),i.d(e,"RenderComponent",(function(){return MS})),i.d(e,"RenderComponentSystem",(function(){return LS})),i.d(e,"RenderHandler",(function(){return df})),i.d(e,"RenderTarget",(function(){return Gl})),i.d(e,"ResourceHandler",(function(){return wA})),i.d(e,"ResourceLoader",(function(){return pf})),i.d(e,"RigidBodyComponent",(function(){return ZS})),i.d(e,"RigidBodyComponentSystem",(function(){return rx})),i.d(e,"SCALEMODE_BLEND",(function(){return ax})),i.d(e,"SCALEMODE_NONE",(function(){return ox})),i.d(e,"SCROLLBAR_VISIBILITY_SHOW_ALWAYS",(function(){return Bx})),i.d(e,"SCROLLBAR_VISIBILITY_SHOW_WHEN_REQUIRED",(function(){return Nx})),i.d(e,"SCROLL_MODE_BOUNCE",(function(){return Ox})),i.d(e,"SCROLL_MODE_CLAMP",(function(){return kx})),i.d(e,"SCROLL_MODE_INFINITE",(function(){return Fx})),i.d(e,"SEMANTIC_ATTR",(function(){return _r})),i.d(e,"SEMANTIC_ATTR0",(function(){return ur})),i.d(e,"SEMANTIC_ATTR1",(function(){return dr})),i.d(e,"SEMANTIC_ATTR10",(function(){return xr})),i.d(e,"SEMANTIC_ATTR11",(function(){return wr})),i.d(e,"SEMANTIC_ATTR12",(function(){return Cr})),i.d(e,"SEMANTIC_ATTR13",(function(){return Tr})),i.d(e,"SEMANTIC_ATTR14",(function(){return Ar})),i.d(e,"SEMANTIC_ATTR15",(function(){return Er})),i.d(e,"SEMANTIC_ATTR2",(function(){return pr})),i.d(e,"SEMANTIC_ATTR3",(function(){return fr})),i.d(e,"SEMANTIC_ATTR4",(function(){return mr})),i.d(e,"SEMANTIC_ATTR5",(function(){return gr})),i.d(e,"SEMANTIC_ATTR6",(function(){return br})),i.d(e,"SEMANTIC_ATTR7",(function(){return yr})),i.d(e,"SEMANTIC_ATTR8",(function(){return vr})),i.d(e,"SEMANTIC_ATTR9",(function(){return Sr})),i.d(e,"SEMANTIC_BLENDINDICES",(function(){return tr})),i.d(e,"SEMANTIC_BLENDWEIGHT",(function(){return Js})),i.d(e,"SEMANTIC_COLOR",(function(){return er})),i.d(e,"SEMANTIC_NORMAL",(function(){return Qs})),i.d(e,"SEMANTIC_POSITION",(function(){return Zs})),i.d(e,"SEMANTIC_TANGENT",(function(){return $s})),i.d(e,"SEMANTIC_TEXCOORD",(function(){return ir})),i.d(e,"SEMANTIC_TEXCOORD0",(function(){return nr})),i.d(e,"SEMANTIC_TEXCOORD1",(function(){return sr})),i.d(e,"SEMANTIC_TEXCOORD2",(function(){return rr})),i.d(e,"SEMANTIC_TEXCOORD3",(function(){return or})),i.d(e,"SEMANTIC_TEXCOORD4",(function(){return ar})),i.d(e,"SEMANTIC_TEXCOORD5",(function(){return lr})),i.d(e,"SEMANTIC_TEXCOORD6",(function(){return hr})),i.d(e,"SEMANTIC_TEXCOORD7",(function(){return cr})),i.d(e,"SHADERDEF_DIRLM",(function(){return _i})),i.d(e,"SHADERDEF_INSTANCING",(function(){return hi})),i.d(e,"SHADERDEF_LM",(function(){return ci})),i.d(e,"SHADERDEF_LMAMBIENT",(function(){return gi})),i.d(e,"SHADERDEF_MORPH_NORMAL",(function(){return fi})),i.d(e,"SHADERDEF_MORPH_POSITION",(function(){return pi})),i.d(e,"SHADERDEF_MORPH_TEXTURE_BASED",(function(){return mi})),i.d(e,"SHADERDEF_NOSHADOW",(function(){return si})),i.d(e,"SHADERDEF_SCREENSPACE",(function(){return ui})),i.d(e,"SHADERDEF_SKIN",(function(){return ri})),i.d(e,"SHADERDEF_TANGENTS",(function(){return di})),i.d(e,"SHADERDEF_UV0",(function(){return oi})),i.d(e,"SHADERDEF_UV1",(function(){return ai})),i.d(e,"SHADERDEF_VCOLOR",(function(){return li})),i.d(e,"SHADERTAG_MATERIAL",(function(){return Mr})),i.d(e,"SHADER_DEPTH",(function(){return Pi})),i.d(e,"SHADER_FORWARD",(function(){return Ri})),i.d(e,"SHADER_FORWARDHDR",(function(){return Ii})),i.d(e,"SHADER_PICK",(function(){return Di})),i.d(e,"SHADER_SHADOW",(function(){return Li})),i.d(e,"SHADOWUPDATE_NONE",(function(){return Si})),i.d(e,"SHADOWUPDATE_REALTIME",(function(){return wi})),i.d(e,"SHADOWUPDATE_THISFRAME",(function(){return xi})),i.d(e,"SHADOW_COUNT",(function(){return ge})),i.d(e,"SHADOW_DEPTH",(function(){return ue})),i.d(e,"SHADOW_PCF3",(function(){return _e})),i.d(e,"SHADOW_PCF5",(function(){return me})),i.d(e,"SHADOW_VSM16",(function(){return pe})),i.d(e,"SHADOW_VSM32",(function(){return fe})),i.d(e,"SHADOW_VSM8",(function(){return de})),i.d(e,"SORTKEY_DEPTH",(function(){return Ti})),i.d(e,"SORTKEY_FORWARD",(function(){return Ci})),i.d(e,"SORTMODE_BACK2FRONT",(function(){return Hi})),i.d(e,"SORTMODE_CUSTOM",(function(){return Yi})),i.d(e,"SORTMODE_FRONT2BACK",(function(){return Xi})),i.d(e,"SORTMODE_MANUAL",(function(){return Gi})),i.d(e,"SORTMODE_MATERIALMESH",(function(){return ji})),i.d(e,"SORTMODE_NONE",(function(){return Wi})),i.d(e,"SPECOCC_AO",(function(){return ii})),i.d(e,"SPECOCC_GLOSSDEPENDENT",(function(){return ni})),i.d(e,"SPECOCC_NONE",(function(){return ei})),i.d(e,"SPECULAR_BLINN",(function(){return Ue})),i.d(e,"SPECULAR_PHONG",(function(){return Ne})),i.d(e,"SPRITETYPE_ANIMATED",(function(){return YT})),i.d(e,"SPRITETYPE_SIMPLE",(function(){return XT})),i.d(e,"SPRITE_RENDERMODE_SIMPLE",(function(){return ki})),i.d(e,"SPRITE_RENDERMODE_SLICED",(function(){return Oi})),i.d(e,"SPRITE_RENDERMODE_TILED",(function(){return Fi})),i.d(e,"STENCILOP_DECREMENT",(function(){return kr})),i.d(e,"STENCILOP_DECREMENTWRAP",(function(){return Or})),i.d(e,"STENCILOP_INCREMENT",(function(){return Lr})),i.d(e,"STENCILOP_INCREMENTWRAP",(function(){return Dr})),i.d(e,"STENCILOP_INVERT",(function(){return Fr})),i.d(e,"STENCILOP_KEEP",(function(){return Rr})),i.d(e,"STENCILOP_REPLACE",(function(){return Pr})),i.d(e,"STENCILOP_ZERO",(function(){return Ir})),i.d(e,"Scene",(function(){return Vu})),i.d(e,"SceneHandler",(function(){return ff})),i.d(e,"SceneRegistry",(function(){return rA})),i.d(e,"SceneRegistryItem",(function(){return sA})),i.d(e,"SceneSettingsHandler",(function(){return CA})),i.d(e,"ScopeId",(function(){return Fl})),i.d(e,"ScopeSpace",(function(){return Bl})),i.d(e,"ScreenComponent",(function(){return hx})),i.d(e,"ScreenComponentSystem",(function(){return ux})),i.d(e,"ScriptAttributes",(function(){return mx})),i.d(e,"ScriptComponent",(function(){return gx})),i.d(e,"ScriptComponentSystem",(function(){return vx})),i.d(e,"ScriptHandler",(function(){return yf})),i.d(e,"ScriptLegacyComponent",(function(){return Sx})),i.d(e,"ScriptLegacyComponentSystem",(function(){return Cx})),i.d(e,"ScriptRegistry",(function(){return cm})),i.d(e,"ScriptType",(function(){return AA})),i.d(e,"ScrollViewComponent",(function(){return ET})),i.d(e,"ScrollViewComponentSystem",(function(){return IT})),i.d(e,"ScrollbarComponent",(function(){return PT})),i.d(e,"ScrollbarComponentSystem",(function(){return kT})),i.d(e,"Shader",(function(){return Go})),i.d(e,"ShaderHandler",(function(){return vf})),i.d(e,"SingleContactResult",(function(){return ex})),i.d(e,"Skeleton",(function(){return Jg})),i.d(e,"Skin",(function(){return Ju})),i.d(e,"SkinBatchInstance",(function(){return zh})),i.d(e,"SkinInstance",(function(){return Vh})),i.d(e,"SortedLoopArray",(function(){return G})),i.d(e,"Sound",(function(){return mp})),i.d(e,"SoundComponent",(function(){return VT})),i.d(e,"SoundComponentSystem",(function(){return HT})),i.d(e,"SoundInstance",(function(){return FT})),i.d(e,"SoundInstance3d",(function(){return BT})),i.d(e,"SoundManager",(function(){return qu})),i.d(e,"SoundSlot",(function(){return UT})),i.d(e,"Sprite",(function(){return wf})),i.d(e,"SpriteAnimationClip",(function(){return qT})),i.d(e,"SpriteComponent",(function(){return KT})),i.d(e,"SpriteComponentSystem",(function(){return $T})),i.d(e,"SpriteHandler",(function(){return Af})),i.d(e,"StandardMaterial",(function(){return wl})),i.d(e,"StencilParameters",(function(){return nv})),i.d(e,"TEXHINT_ASSET",(function(){return Hr})),i.d(e,"TEXHINT_LIGHTMAP",(function(){return Xr})),i.d(e,"TEXHINT_NONE",(function(){return Gr})),i.d(e,"TEXHINT_SHADOWMAP",(function(){return jr})),i.d(e,"TEXTURELOCK_READ",(function(){return Br})),i.d(e,"TEXTURELOCK_WRITE",(function(){return Nr})),i.d(e,"TEXTUREPROJECTION_CUBE",(function(){return qr})),i.d(e,"TEXTUREPROJECTION_EQUIRECT",(function(){return Kr})),i.d(e,"TEXTUREPROJECTION_NONE",(function(){return Yr})),i.d(e,"TEXTUREPROJECTION_OCTAHEDRAL",(function(){return Zr})),i.d(e,"TEXTURETYPE_DEFAULT",(function(){return Ur})),i.d(e,"TEXTURETYPE_RGBE",(function(){return zr})),i.d(e,"TEXTURETYPE_RGBM",(function(){return Vr})),i.d(e,"TEXTURETYPE_SWIZZLEGGGR",(function(){return Wr})),i.d(e,"TONEMAP_ACES",(function(){return Je})),i.d(e,"TONEMAP_ACES2",(function(){return ti})),i.d(e,"TONEMAP_FILMIC",(function(){return Qe})),i.d(e,"TONEMAP_HEJL",(function(){return $e})),i.d(e,"TONEMAP_LINEAR",(function(){return Ze})),i.d(e,"TYPE_FLOAT32",(function(){return no})),i.d(e,"TYPE_INT16",(function(){return Jr})),i.d(e,"TYPE_INT32",(function(){return eo})),i.d(e,"TYPE_INT8",(function(){return Qr})),i.d(e,"TYPE_UINT16",(function(){return to})),i.d(e,"TYPE_UINT32",(function(){return io})),i.d(e,"TYPE_UINT8",(function(){return $r})),i.d(e,"Tags",(function(){return j})),i.d(e,"Template",(function(){return Ef})),i.d(e,"TemplateHandler",(function(){return Mf})),i.d(e,"TextElement",(function(){return xv})),i.d(e,"TextHandler",(function(){return Rf})),i.d(e,"Texture",(function(){return _a})),i.d(e,"TextureAtlas",(function(){return If})),i.d(e,"TextureAtlasHandler",(function(){return kf})),i.d(e,"TextureHandler",(function(){return om})),i.d(e,"TextureParser",(function(){return rm})),i.d(e,"Timer",(function(){return X})),i.d(e,"Touch",(function(){return TE})),i.d(e,"TouchDevice",(function(){return EE})),i.d(e,"TouchEvent",(function(){return AE})),i.d(e,"TransformFeedback",(function(){return gh})),i.d(e,"UNIFORMTYPE_BOOL",(function(){return so})),i.d(e,"UNIFORMTYPE_BVEC2",(function(){return po})),i.d(e,"UNIFORMTYPE_BVEC3",(function(){return fo})),i.d(e,"UNIFORMTYPE_BVEC4",(function(){return mo})),i.d(e,"UNIFORMTYPE_FLOAT",(function(){return oo})),i.d(e,"UNIFORMTYPE_FLOATARRAY",(function(){return xo})),i.d(e,"UNIFORMTYPE_INT",(function(){return ro})),i.d(e,"UNIFORMTYPE_IVEC2",(function(){return co})),i.d(e,"UNIFORMTYPE_IVEC3",(function(){return _o})),i.d(e,"UNIFORMTYPE_IVEC4",(function(){return uo})),i.d(e,"UNIFORMTYPE_MAT2",(function(){return go})),i.d(e,"UNIFORMTYPE_MAT3",(function(){return bo})),i.d(e,"UNIFORMTYPE_MAT4",(function(){return yo})),i.d(e,"UNIFORMTYPE_TEXTURE2D",(function(){return vo})),i.d(e,"UNIFORMTYPE_TEXTURE2D_SHADOW",(function(){return wo})),i.d(e,"UNIFORMTYPE_TEXTURE3D",(function(){return To})),i.d(e,"UNIFORMTYPE_TEXTURECUBE",(function(){return So})),i.d(e,"UNIFORMTYPE_TEXTURECUBE_SHADOW",(function(){return Co})),i.d(e,"UNIFORMTYPE_VEC2",(function(){return ao})),i.d(e,"UNIFORMTYPE_VEC2ARRAY",(function(){return Ao})),i.d(e,"UNIFORMTYPE_VEC3",(function(){return lo})),i.d(e,"UNIFORMTYPE_VEC3ARRAY",(function(){return Eo})),i.d(e,"UNIFORMTYPE_VEC4",(function(){return ho})),i.d(e,"UNIFORMTYPE_VEC4ARRAY",(function(){return Mo})),i.d(e,"URI",(function(){return K})),i.d(e,"UnsupportedBrowserError",(function(){return VE})),i.d(e,"VIEW_CENTER",(function(){return Ui})),i.d(e,"VIEW_LEFT",(function(){return Vi})),i.d(e,"VIEW_RIGHT",(function(){return zi}));i.d(e,"Vec2",(function(){return _t})),i.d(e,"Vec3",(function(){return ht})),i.d(e,"Vec4",(function(){return ut})),i.d(e,"VertexBuffer",(function(){return Fo})),i.d(e,"VertexFormat",(function(){return No})),i.d(e,"VertexIterator",(function(){return uh})),i.d(e,"VrDisplay",(function(){return bm})),i.d(e,"VrManager",(function(){return ym})),i.d(e,"WorldClusters",(function(){return ja})),i.d(e,"XRDEPTHSENSINGFORMAT_F32",(function(){return Vm})),i.d(e,"XRDEPTHSENSINGFORMAT_L8A8",(function(){return Um})),i.d(e,"XRDEPTHSENSINGUSAGE_CPU",(function(){return Bm})),i.d(e,"XRDEPTHSENSINGUSAGE_GPU",(function(){return Nm})),i.d(e,"XRHAND_LEFT",(function(){return Lm})),i.d(e,"XRHAND_NONE",(function(){return Pm})),i.d(e,"XRHAND_RIGHT",(function(){return Dm})),i.d(e,"XRSPACE_BOUNDEDFLOOR",(function(){return Am})),i.d(e,"XRSPACE_LOCAL",(function(){return Cm})),i.d(e,"XRSPACE_LOCALFLOOR",(function(){return Tm})),i.d(e,"XRSPACE_UNBOUNDED",(function(){return Em})),i.d(e,"XRSPACE_VIEWER",(function(){return wm})),i.d(e,"XRTARGETRAY_GAZE",(function(){return Mm})),i.d(e,"XRTARGETRAY_POINTER",(function(){return Im})),i.d(e,"XRTARGETRAY_SCREEN",(function(){return Rm})),i.d(e,"XRTRACKABLE_MESH",(function(){return Fm})),i.d(e,"XRTRACKABLE_PLANE",(function(){return Om})),i.d(e,"XRTRACKABLE_POINT",(function(){return km})),i.d(e,"XRTYPE_AR",(function(){return xm})),i.d(e,"XRTYPE_INLINE",(function(){return vm})),i.d(e,"XRTYPE_VR",(function(){return Sm})),i.d(e,"XrDepthSensing",(function(){return ug})),i.d(e,"XrDomOverlay",(function(){return _g})),i.d(e,"XrHitTest",(function(){return jm})),i.d(e,"XrHitTestSource",(function(){return Gm})),i.d(e,"XrImageTracking",(function(){return cg})),i.d(e,"XrInput",(function(){return ng})),i.d(e,"XrInputSource",(function(){return ig})),i.d(e,"XrLightEstimation",(function(){return lg})),i.d(e,"XrManager",(function(){return mg})),i.d(e,"XrPlane",(function(){return pg})),i.d(e,"XrPlaneDetection",(function(){return fg})),i.d(e,"XrTrackedImage",(function(){return hg})),i.d(e,"ZoneComponent",(function(){return JT})),i.d(e,"ZoneComponentSystem",(function(){return iA})),i.d(e,"anim",(function(){return XE})),i.d(e,"app",(function(){return lA})),i.d(e,"apps",(function(){return u})),i.d(e,"asset",(function(){return qE})),i.d(e,"audio",(function(){return YE})),i.d(e,"basisInitialize",(function(){return Gf})),i.d(e,"basisSetDownloadConfig",(function(){return lM})),i.d(e,"basisTranscode",(function(){return Hf})),i.d(e,"calculateNormals",(function(){return Ch})),i.d(e,"calculateTangents",(function(){return Th})),i.d(e,"common",(function(){return _})),i.d(e,"config",(function(){return c})),i.d(e,"createBox",(function(){return kh})),i.d(e,"createCapsule",(function(){return Ih})),i.d(e,"createCone",(function(){return Ph})),i.d(e,"createCylinder",(function(){return Rh})),i.d(e,"createMesh",(function(){return Ah})),i.d(e,"createPlane",(function(){return Dh})),i.d(e,"createScript",(function(){return MA})),i.d(e,"createSphere",(function(){return Lh})),i.d(e,"createStyle",(function(){return Lp})),i.d(e,"createTorus",(function(){return Eh})),i.d(e,"createURI",(function(){return Y})),i.d(e,"data",(function(){return d})),i.d(e,"debug",(function(){return S})),i.d(e,"drawFullscreenQuad",(function(){return mh})),i.d(e,"drawQuadWithShader",(function(){return zo})),i.d(e,"drawTexture",(function(){return Wo})),i.d(e,"events",(function(){return w})),i.d(e,"extend",(function(){return f})),i.d(e,"fw",(function(){return aM})),i.d(e,"getTouchTargetCoords",(function(){return CE})),i.d(e,"gfx",(function(){return WE})),i.d(e,"guid",(function(){return C})),i.d(e,"http",(function(){return $})),i.d(e,"inherits",(function(){return IE})),i.d(e,"input",(function(){return KE})),i.d(e,"isDefined",(function(){return m})),i.d(e,"log",(function(){return ME})),i.d(e,"makeArray",(function(){return PE})),i.d(e,"math",(function(){return Z})),i.d(e,"now",(function(){return H})),i.d(e,"path",(function(){return T})),i.d(e,"platform",(function(){return B})),i.d(e,"posteffect",(function(){return GE})),i.d(e,"prefilterCubemap",(function(){return Hl})),i.d(e,"programlib",(function(){return cl})),i.d(e,"registerScript",(function(){return IA})),i.d(e,"reprojectTexture",(function(){return Ql})),i.d(e,"revision",(function(){return h})),i.d(e,"scene",(function(){return HE})),i.d(e,"script",(function(){return bf})),i.d(e,"semanticToLocation",(function(){return ko})),i.d(e,"shFromCubemap",(function(){return ql})),i.d(e,"shaderChunks",(function(){return jo})),i.d(e,"shape",(function(){return LE})),i.d(e,"string",(function(){return z})),i.d(e,"time",(function(){return RE})),i.d(e,"type",(function(){return p})),i.d(e,"typedArrayIndexFormats",(function(){return Lo})),i.d(e,"typedArrayIndexFormatsByteSize",(function(){return Do})),i.d(e,"typedArrayToType",(function(){return Po})),i.d(e,"typedArrayTypes",(function(){return Ro})),i.d(e,"typedArrayTypesByteSize",(function(){return Io})),i.d(e,"version",(function(){return l})),
/**
 * @license
 * PlayCanvas Engine v1.48.0 revision 14f01fa65
 * Copyright 2011-2021 PlayCanvas Ltd. All rights reserved.
 */
Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),i=e.length>>>0,n=arguments[1],s=n>>0,r=s<0?Math.max(i+s,0):Math.min(s,i),o=arguments[2],a=void 0===o?i:o>>0,l=a<0?Math.max(i+a,0):Math.min(a,i);r<l;)e[r]=t,r++;return e}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw TypeError("predicate must be a function");for(var n=arguments[1],s=0;s<i;){var r=e[s];if(t.call(n,r,s,e))return r;s++}},configurable:!0,writable:!0}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],s=0;s<i;){var r=e[s];if(t.call(n,r,s,e))return s;s++}return-1},configurable:!0,writable:!0}),Math.log2=Math.log2||function(t){return Math.log(t)*Math.LOG2E},Math.sign||(Math.sign=function(t){return(t>0)-(t<0)||+t}),void 0===Number.isFinite&&(Number.isFinite=function(t){return"number"==typeof t&&isFinite(t)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1;n<arguments.length;n++){var s=arguments[n];if(null!=s)for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(i[r]=s[r])}return i},writable:!0,configurable:!0}),function(){if("undefined"!=typeof navigator&&"undefined"!=typeof document){navigator.pointer=navigator.pointer||navigator.webkitPointer||navigator.mozPointer;var t=function(){var t=document.createEvent("CustomEvent");t.initCustomEvent("pointerlockchange",!0,!1,null),document.dispatchEvent(t)},e=function(){var t=document.createEvent("CustomEvent");t.initCustomEvent("pointerlockerror",!0,!1,null),document.dispatchEvent(t)};document.addEventListener("webkitpointerlockchange",t,!1),document.addEventListener("webkitpointerlocklost",t,!1),document.addEventListener("mozpointerlockchange",t,!1),document.addEventListener("mozpointerlocklost",t,!1),document.addEventListener("webkitpointerlockerror",e,!1),document.addEventListener("mozpointerlockerror",e,!1),Element.prototype.mozRequestPointerLock?Element.prototype.requestPointerLock=function(){this.mozRequestPointerLock()}:Element.prototype.requestPointerLock=Element.prototype.requestPointerLock||Element.prototype.webkitRequestPointerLock||Element.prototype.mozRequestPointerLock,!Element.prototype.requestPointerLock&&navigator.pointer&&(Element.prototype.requestPointerLock=function(){document.pointerLockElement=this,navigator.pointer.lock(this,t,e)}),document.exitPointerLock=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock,document.exitPointerLock||(document.exitPointerLock=function(){navigator.pointer&&(document.pointerLockElement=null,navigator.pointer.unlock())})}}(),function(){if("undefined"!=typeof window){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var n=(new Date).getTime(),s=Math.max(0,16-(n-t)),r=window.setTimeout((function(){e(n+s)}),s);return t=n+s,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}}(),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){return(void 0===e||e>this.length)&&(e=this.length),this.substring(e-t.length,e)===t}),String.prototype.includes||(String.prototype.includes=function(t,e){return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t}),Int8Array.prototype.fill||(Int8Array.prototype.fill=Array.prototype.fill),Uint8Array.prototype.fill||(Uint8Array.prototype.fill=Array.prototype.fill),Uint8ClampedArray.prototype.fill||(Uint8ClampedArray.prototype.fill=Array.prototype.fill),Int16Array.prototype.fill||(Int16Array.prototype.fill=Array.prototype.fill),Uint16Array.prototype.fill||(Uint16Array.prototype.fill=Array.prototype.fill),Int32Array.prototype.fill||(Int32Array.prototype.fill=Array.prototype.fill),Uint32Array.prototype.fill||(Uint32Array.prototype.fill=Array.prototype.fill),Float32Array.prototype.fill||(Float32Array.prototype.fill=Array.prototype.fill);var n={};function s(t,e){var i;n[t]=!0,void 0!==e&&(i=e,window.console&&window.console.error&&window.console.error(i))}var r=function t(e){var i=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(var n=0;n<this.attribs.length;n++){var s=new t.VertexAttrib(i);this.attribs[n]=s}this.maxAttrib=0};(r.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=t.FLOAT,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var o=function(t){var e=this;this.gl=t,function(t){var e=t.getError;t.getError=function(){do{(i=e.apply(t))!=t.NO_ERROR&&(n[i]=!0)}while(i!=t.NO_ERROR);for(var i in n)if(n[i])return delete n[i],parseInt(i);return t.NO_ERROR}}(t);var i=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t==e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject==e.defaultVertexArrayObject?null:e.currentVertexArrayObject:i.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){var n=e.currentVertexArrayObject;n.maxAttrib=Math.max(n.maxAttrib,t);var s=n.attribs[t];return s.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){var n=e.currentVertexArrayObject;n.maxAttrib=Math.max(n.maxAttrib,t);var s=n.attribs[t];return s.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(n,s){switch(n){case t.ARRAY_BUFFER:e.currentArrayBuffer=s;break;case t.ELEMENT_ARRAY_BUFFER:e.currentVertexArrayObject.elementArrayBuffer=s}return i.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(n,s){var r=e.currentVertexArrayObject,o=r.attribs[n];switch(s){case t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:return o.buffer;case t.VERTEX_ATTRIB_ARRAY_ENABLED:return o.enabled;case t.VERTEX_ATTRIB_ARRAY_SIZE:return o.size;case t.VERTEX_ATTRIB_ARRAY_STRIDE:return o.stride;case t.VERTEX_ATTRIB_ARRAY_TYPE:return o.type;case t.VERTEX_ATTRIB_ARRAY_NORMALIZED:return o.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,n,s,r,o,a){var l=e.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,t);var h=l.attribs[t];return h.buffer=e.currentArrayBuffer,h.size=n,h.type=s,h.normalized=r,h.stride=o,h.offset=a,h.recache(),i.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas.addEventListener("webglcontextrestored",(function(){var t;t="OESVertexArrayObject emulation library context restored",window.console&&window.console.log&&window.console.log(t),e.reset_()}),!0),this.reset_()};o.prototype.VERTEX_ARRAY_BINDING_OES=34229,o.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(var t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;var e=this.gl;this.maxVertexAttribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.defaultVertexArrayObject=new r(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},o.prototype.createVertexArrayOES=function(){var t=new r(this);return this.vertexArrayObjects.push(t),t},o.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject==t&&this.bindVertexArrayOES(null)},o.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof r&&t.hasBeenBound&&t.ext==this)},o.prototype.bindVertexArrayOES=function(t){var e=this.gl;if(!t||t.isAlive){var i=this.original,n=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;var r=this.currentVertexArrayObject;if(n!=r){n&&r.elementArrayBuffer==n.elementArrayBuffer||i.bindBuffer.call(e,e.ELEMENT_ARRAY_BUFFER,r.elementArrayBuffer);for(var o=this.currentArrayBuffer,a=Math.max(n?n.maxAttrib:0,r.maxAttrib),l=0;l<=a;l++){var h=r.attribs[l],c=n?n.attribs[l]:null;if(n&&h.enabled==c.enabled||(h.enabled?i.enableVertexAttribArray.call(e,l):i.disableVertexAttribArray.call(e,l)),h.enabled){var _=!1;n&&h.buffer==c.buffer||(o!=h.buffer&&(i.bindBuffer.call(e,e.ARRAY_BUFFER,h.buffer),o=h.buffer),_=!0),(_||h.cached!=c.cached)&&i.vertexAttribPointer.call(e,l,h.size,h.type,h.normalized,h.stride,h.offset)}}this.currentArrayBuffer!=o&&i.bindBuffer.call(e,e.ARRAY_BUFFER,this.currentArrayBuffer)}}else s(e.INVALID_OPERATION,"bindVertexArrayOES: attempt to bind deleted arrayObject")};const a=function(){const t={},e=["Array","Object","Function","Date","RegExp","Float32Array"];for(let i=0;i<e.length;i++)t["[object "+e[i]+"]"]=e[i].toLowerCase();return t}(),l="1.48.0",h="14f01fa65",c={},_={},u={},d={};function p(t){if(null===t)return"null";const e=typeof t;return"undefined"===e||"number"===e||"string"===e||"boolean"===e?e:a[Object.prototype.toString.call(t)]}function f(t,e){for(const i in e){const n=e[i];"object"===p(n)?t[i]=f({},n):"array"===p(n)?t[i]=f([],n):t[i]=n}return t}function m(t){return void 0!==t}let g=null,b=null,y=null,v=null;const S={display:function(t){g||(g=document.createElement("table"),b=document.createElement("tr"),y=document.createElement("td"),v=document.createElement("td"),g.style.cssText="position:absolute;font-family:sans-serif;font-size:12px;color:#cccccc",g.style.top="0px",g.style.left="0px",g.style.border="thin solid #cccccc",document.body.appendChild(g)),g.innerHTML="";for(const e in t){const i=b.cloneNode(),n=y.cloneNode(),s=v.cloneNode();n.textContent=e,s.textContent=t[e],i.appendChild(n),i.appendChild(s),g.appendChild(i)}}};class x{constructor(){this.initEventHandler()}initEventHandler(){this._callbacks={},this._callbackActive={}}_addCallback(t,e,i,n=!1){t&&"string"==typeof t&&e&&(this._callbacks[t]||(this._callbacks[t]=[]),this._callbackActive[t]&&this._callbackActive[t]===this._callbacks[t]&&(this._callbackActive[t]=this._callbackActive[t].slice()),this._callbacks[t].push({callback:e,scope:i||this,once:n}))}on(t,e,i){return this._addCallback(t,e,i,!1),this}off(t,e,i){if(t)this._callbackActive[t]&&this._callbackActive[t]===this._callbacks[t]&&(this._callbackActive[t]=this._callbackActive[t].slice());else for(const t in this._callbackActive)this._callbacks[t]&&this._callbacks[t]===this._callbackActive[t]&&(this._callbackActive[t]=this._callbackActive[t].slice());if(t)if(e){const n=this._callbacks[t];if(!n)return this;let s=n.length;for(let t=0;t<s;t++)n[t].callback===e&&(i&&n[t].scope!==i||(n[t--]=n[--s]));n.length=s}else this._callbacks[t]&&(this._callbacks[t]=[]);else this._callbacks={};return this}fire(t,e,i,n,s,r,o,a,l){if(!t||!this._callbacks[t])return this;let h;this._callbackActive[t]?(this._callbackActive[t]===this._callbacks[t]&&(this._callbackActive[t]=this._callbackActive[t].slice()),h=this._callbacks[t].slice()):this._callbackActive[t]=this._callbacks[t];for(let c=0;(h||this._callbackActive[t])&&c<(h||this._callbackActive[t]).length;c++){const _=(h||this._callbackActive[t])[c];if(_.callback.call(_.scope,e,i,n,s,r,o,a,l),_.once){const e=this._callbacks[t],i=e?e.indexOf(_):-1;-1!==i&&(this._callbackActive[t]===e&&(this._callbackActive[t]=this._callbackActive[t].slice()),this._callbacks[t].splice(i,1))}}return h||(this._callbackActive[t]=null),this}once(t,e,i){return this._addCallback(t,e,i,!0),this}hasEvent(t){return this._callbacks[t]&&0!==this._callbacks[t].length||!1}}const w={attach:function(t){const e=w;return t._addCallback=e._addCallback,t.on=e.on,t.off=e.off,t.fire=e.fire,t.once=e.once,t.hasEvent=e.hasEvent,t._callbacks={},t._callbackActive={},t},_addCallback:x.prototype._addCallback,on:x.prototype.on,off:x.prototype.off,fire:x.prototype.fire,once:x.prototype.once,hasEvent:x.prototype.hasEvent},C={create:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}},T={delimiter:"/",join:function(){const t=arguments.length;let e=arguments[0];for(let i=0;i<t-1;++i){const t=arguments[i],n=arguments[i+1];if(!m(t)||!m(n))throw new Error("undefined argument to pc.path.join");n[0]!==T.delimiter?t&&n&&t[t.length-1]!==T.delimiter&&n[0]!==T.delimiter?e+=T.delimiter+n:e+=n:e=n}return e},normalize:function(t){const e=t.startsWith(T.delimiter),i=t.endsWith(T.delimiter),n=t.split("/");let s="",r=[];for(let t=0;t<n.length;t++)""!==n[t]&&"."!==n[t]&&(".."===n[t]&&r.length>0?r=r.slice(0,r.length-2):(t>0&&r.push(T.delimiter),r.push(n[t])));return s=r.join(""),e||s[0]!==T.delimiter||(s=s.slice(1)),i&&s[s.length-1]!==T.delimiter&&(s+=T.delimiter),s},split:function(t){const e=t.split(T.delimiter),i=e.slice(e.length-1)[0];return[e.slice(0,e.length-1).join(T.delimiter),i]},getBasename:function(t){return T.split(t)[1]},getDirectory:function(t){const e=t.split(T.delimiter);return e.slice(0,e.length-1).join(T.delimiter)},getExtension:function(t){const e=t.split("?")[0].split(".").pop();return e!==t?"."+e:""},isRelativePath:function(t){return"/"!==t.charAt(0)&&null===t.match(/:\/\//)},extractPath:function(t){let e="";const i=t.split("/");let n=0;if(i.length>1)if(T.isRelativePath(t))if("."===i[0])for(n=0;n<i.length-1;++n)e+=0===n?i[n]:"/"+i[n];else if(".."===i[0])for(n=0;n<i.length-1;++n)e+=0===n?i[n]:"/"+i[n];else for(e=".",n=0;n<i.length-1;++n)e+="/"+i[n];else for(n=0;n<i.length-1;++n)e+=0===n?i[n]:"/"+i[n];return e}};let A=!1,E=!1,M=!1,R=!1,I=!1,P=!1,L=!1,D=!1,k=!1,O=!1;if("undefined"!=typeof navigator){const t=navigator.userAgent;/(windows|mac os|linux|cros)/i.test(t)&&(A=!0),/xbox/i.test(t)&&(R=!0),/(windows phone|iemobile|wpdesktop)/i.test(t)?(A=!1,E=!0,M=!0):/android/i.test(t)?(A=!1,E=!0,I=!0):/ip([ao]d|hone)/i.test(t)&&(A=!1,E=!0,P=!0),"undefined"!=typeof window&&(L="ontouchstart"in window||"maxTouchPoints"in navigator&&navigator.maxTouchPoints>0),D="getGamepads"in navigator,k="undefined"!=typeof Worker;try{const t=Object.defineProperty({},"passive",{get:function(){return O=!0,!1}});window.addEventListener("testpassive",null,t),window.removeEventListener("testpassive",null,t)}catch(t){}}const F="undefined"!=typeof window?"browser":"node",B={environment:F,global:"browser"===F?window:global,browser:"browser"===F,desktop:A,mobile:E,ios:P,android:I,windows:M,xbox:R,gamepads:D,touch:L,workers:k,passiveEvents:O};function N(t,e=0){const i=t.length;if(e<0||e>=i)return null;const n=t.charCodeAt(e);if(i>1&&n>=55296&&n<=56319){const i=t.charCodeAt(e+1);if(i>=56320&&i<=57343)return{code:1024*(n-55296)+i-56320+65536,long:!0}}return{code:n,long:!1}}function U(t,e,i){if(!t)return!1;const n=N(t);if(n){const t=n.code;return t>=e&&t<=i}return!1}function V(t,e){if(e===t.length-1)return 1;if(U(t[e],55296,56319)){const i=t.substring(e,e+2),n=t.substring(e+2,e+4);return U(n,127995,127999)||U(i,127462,127487)&&U(n,127462,127487)?4:U(n,65024,65039)?3:2}return U(t[e+1],65024,65039)?2:1}const z={ASCII_LOWERCASE:"abcdefghijklmnopqrstuvwxyz",ASCII_UPPERCASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",ASCII_LETTERS:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",format:function(t){for(let e=1;e<arguments.length;e++)t=t.replace("{"+(e-1)+"}",arguments[e]);return t},toBool:function(t,e=!1){if("true"===t)return!0;if(e){if("false"===t)return!1;throw new TypeError("Not a boolean string")}return!1},getCodePoint:function(t,e){const i=N(t,e);return i&&i.code},getCodePoints:function(t){if("string"!=typeof t)throw new TypeError("Not a string");let e=0;const i=[];let n;for(;n=N(t,e);)i.push(n.code),e+=n.long?2:1;return i},getSymbols:function(t){if("string"!=typeof t)throw new TypeError("Not a string");let e=0;const i=t.length,n=[];let s,r=0;for(;e<i;){if(r+=V(t,e+r),s=t[e+r],U(s,8400,8447)&&(s=t[e+r++]),U(s,65024,65039)&&(s=t[e+r++]),s&&8205===s.charCodeAt(0)){s=t[e+r++];continue}const i=t.substring(e,e+r);n.push(i),e+=r,r=0}return n},fromCodePoint:function(){const t=[];let e,i,n;for(let s=0;s<arguments.length;++s)e=Number(arguments[s]),i=e-65536,n=e>65535?[55296+(i>>10),i%1024+56320]:[e],t.push(String.fromCharCode.apply(null,n));return t.join("")}};class W{constructor(){this._list=[],this._index={}}push(t,e){if(this._index[t])throw Error("Key already in index "+t);const i=this._list.push(e)-1;this._index[t]=i}has(t){return void 0!==this._index[t]}get(t){const e=this._index[t];return void 0!==e?this._list[e]:null}remove(t){const e=this._index[t];if(void 0!==e){for(t in this._list.splice(e,1),delete this._index[t],this._index){const i=this._index[t];i>e&&(this._index[t]=i-1)}return!0}return!1}list(){return this._list}clear(){this._list.length=0;for(const t in this._index)delete this._index[t]}}class G{constructor(t){this._sortBy=t.sortBy,this.items=[],this.length=0,this.loopIndex=-1,this._sortHandler=this._doSort.bind(this)}_binarySearch(t){let e=0,i=this.items.length-1;const n=t[this._sortBy];let s,r;for(;e<=i;)s=Math.floor((e+i)/2),r=this.items[s][this._sortBy],r<=n?e=s+1:r>n&&(i=s-1);return e}_doSort(t,e){const i=this._sortBy;return t[i]-e[i]}insert(t){const e=this._binarySearch(t);this.items.splice(e,0,t),this.length++,this.loopIndex>=e&&this.loopIndex++}append(t){this.items.push(t),this.length++}remove(t){const e=this.items.indexOf(t);e<0||(this.items.splice(e,1),this.length--,this.loopIndex>=e&&this.loopIndex--)}sort(){const t=this.loopIndex>=0?this.items[this.loopIndex]:null;this.items.sort(this._sortHandler),null!==t&&(this.loopIndex=this.items.indexOf(t))}}class j extends x{constructor(t){super(),this._index={},this._list=[],this._parent=t}add(){let t=!1;const e=this._processArguments(arguments,!0);if(!e.length)return t;for(let i=0;i<e.length;i++)this._index[e[i]]||(t=!0,this._index[e[i]]=!0,this._list.push(e[i]),this.fire("add",e[i],this._parent));return t&&this.fire("change",this._parent),t}remove(){let t=!1;if(!this._list.length)return t;const e=this._processArguments(arguments,!0);if(!e.length)return t;for(let i=0;i<e.length;i++)this._index[e[i]]&&(t=!0,delete this._index[e[i]],this._list.splice(this._list.indexOf(e[i]),1),this.fire("remove",e[i],this._parent));return t&&this.fire("change",this._parent),t}clear(){if(!this._list.length)return;const t=this._list.slice(0);this._list=[],this._index={};for(let e=0;e<t.length;e++)this.fire("remove",t[e],this._parent);this.fire("change",this._parent)}has(){return!!this._list.length&&this._has(this._processArguments(arguments))}_has(t){if(!this._list.length||!t.length)return!1;for(let e=0;e<t.length;e++)if(1===t[e].length){if(this._index[t[e][0]])return!0}else{let i=!0;for(let n=0;n<t[e].length;n++)if(!this._index[t[e][n]]){i=!1;break}if(i)return!0}return!1}list(){return this._list.slice(0)}_processArguments(t,e){const i=[];let n=[];if(!t||!t.length)return i;for(let s=0;s<t.length;s++)if(t[s]instanceof Array){e||(n=[]);for(let r=0;r<t[s].length;r++)"string"==typeof t[s][r]&&(e?i.push(t[s][r]):n.push(t[s][r]));!e&&n.length&&i.push(n)}else"string"==typeof t[s]&&(e?i.push(t[s]):i.push([t[s]]));return i}get size(){return this._list.length}}const H="undefined"!=typeof window&&window.performance&&window.performance.now&&window.performance.timing?function(){return window.performance.now()}:Date.now;class X{constructor(){this._isRunning=!1,this._a=0,this._b=0}start(){this._isRunning=!0,this._a=H()}stop(){this._isRunning=!1,this._b=H()}getMilliseconds(){return this._b-this._a}}function Y(t){let e="";if((t.authority||t.scheme)&&(t.host||t.hostpath))throw new Error("Can't have 'scheme' or 'authority' and 'host' or 'hostpath' option");if(t.host&&t.hostpath)throw new Error("Can't have 'host' and 'hostpath' option");if(t.path&&t.hostpath)throw new Error("Can't have 'path' and 'hostpath' option");return t.scheme&&(e+=t.scheme+":"),t.authority&&(e+="//"+t.authority),t.host&&(e+=t.host),t.path&&(e+=t.path),t.hostpath&&(e+=t.hostpath),t.query&&(e+="?"+t.query),t.fragment&&(e+="#"+t.fragment),e}const q=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class K{constructor(t){const e=t.match(q);this.scheme=e[2],this.authority=e[4],this.path=e[5],this.query=e[7],this.fragment=e[9]}toString(){let t="";return this.scheme&&(t+=this.scheme+":"),this.authority&&(t+="//"+this.authority),t+=this.path,this.query&&(t+="?"+this.query),this.fragment&&(t+="#"+this.fragment),t}getQuery(){const t={};if(this.query){const e=decodeURIComponent(this.query).split("&");for(const i of e){const e=i.split("=");t[e[0]]=e[1]}}return t}setQuery(t){let e="";for(const i in t)t.hasOwnProperty(i)&&(""!==e&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));this.query=e}}const Z={DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,clamp:function(t,e,i){return t>=i?i:t<=e?e:t},intToBytes24:function(t){return[t>>16&255,t>>8&255,255&t]},intToBytes32:function(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]},bytesToInt24:function(t,e,i){return t.length&&(i=t[2],e=t[1],t=t[0]),t<<16|e<<8|i},bytesToInt32:function(t,e,i,n){return t.length&&(n=t[3],i=t[2],e=t[1],t=t[0]),(t<<24|e<<16|i<<8|n)>>>32},lerp:function(t,e,i){return t+(e-t)*Z.clamp(i,0,1)},lerpAngle:function(t,e,i){return e-t>180&&(e-=360),e-t<-180&&(e+=360),Z.lerp(t,e,Z.clamp(i,0,1))},powerOfTwo:function(t){return 0!==t&&!(t&t-1)},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t},random:function(t,e){const i=e-t;return Math.random()*i+t},smoothstep:function(t,e,i){return i<=t?0:i>=e?1:(i=(i-t)/(e-t))*i*(3-2*i)},smootherstep:function(t,e,i){return i<=t?0:i>=e?1:(i=(i-t)/(e-t))*i*i*(i*(6*i-15)+10)},roundUp:function(t,e){return 0===e?t:Math.ceil(t/e)*e},between:function(t,e,i,n){const s=Math.min(e,i),r=Math.max(e,i);return n?t>=s&&t<=r:t>s&&t<r}};class Q{constructor(){this.ContentType=Q.ContentType,this.ResponseType=Q.ResponseType,this.binaryExtensions=Q.binaryExtensions}get(t,e,i){return"function"==typeof e&&(i=e,e={}),this.request("GET",t,e,i)}post(t,e,i,n){return"function"==typeof i&&(n=i,i={}),i.postdata=e,this.request("POST",t,i,n)}put(t,e,i,n){return"function"==typeof i&&(n=i,i={}),i.postdata=e,this.request("PUT",t,i,n)}del(t,e,i){return"function"==typeof e&&(i=e,e={}),this.request("DELETE",t,e,i)}request(t,e,i,n){let s,r,o,a=!1;if("function"==typeof i&&(n=i,i={}),i.retry&&(i=Object.assign({retries:0,maxRetries:5},i)),i.callback=n,null==i.async&&(i.async=!0),null==i.headers&&(i.headers={}),null!=i.postdata)if(i.postdata instanceof Document)o=i.postdata;else if(i.postdata instanceof FormData)o=i.postdata;else if(i.postdata instanceof Object){let t=i.headers["Content-Type"];switch(void 0===t&&(i.headers["Content-Type"]=Q.ContentType.FORM_URLENCODED,t=i.headers["Content-Type"]),t){case Q.ContentType.FORM_URLENCODED:{o="";let t=!0;for(const e in i.postdata)i.postdata.hasOwnProperty(e)&&(t?t=!1:o+="&",o+=escape(e)+"="+escape(i.postdata[e]));break}default:case Q.ContentType.JSON:null==t&&(i.headers["Content-Type"]=Q.ContentType.JSON),o=JSON.stringify(i.postdata)}}else o=i.postdata;if(!1===i.cache){const t=H();s=new K(e),s.query?s.query=s.query+"&ts="+t:s.query="ts="+t,e=s.toString()}i.query&&(s=new K(e),r=f(s.getQuery(),i.query),s.setQuery(r),e=s.toString());const l=new XMLHttpRequest;l.open(t,e,i.async),l.withCredentials=void 0!==i.withCredentials&&i.withCredentials,l.responseType=i.responseType||this._guessResponseType(e);for(const t in i.headers)i.headers.hasOwnProperty(t)&&l.setRequestHeader(t,i.headers[t]);l.onreadystatechange=()=>{this._onReadyStateChange(t,e,i,l)},l.onerror=()=>{this._onError(t,e,i,l),a=!0};try{l.send(o)}catch(t){a||i.error(l.status,l,t)}return l}_guessResponseType(t){const e=new K(t),i=T.getExtension(e.path);return Q.binaryExtensions.indexOf(i)>=0?Q.ResponseType.ARRAY_BUFFER:".xml"===i?Q.ResponseType.DOCUMENT:Q.ResponseType.TEXT}_isBinaryContentType(t){return[Q.ContentType.MP4,Q.ContentType.WAV,Q.ContentType.OGG,Q.ContentType.MP3,Q.ContentType.BIN,Q.ContentType.DDS,Q.ContentType.BASIS,Q.ContentType.GLB].indexOf(t)>=0}_onReadyStateChange(t,e,i,n){if(4===n.readyState)switch(n.status){case 0:n.responseURL&&n.responseURL.startsWith("file:///")?this._onSuccess(t,e,i,n):this._onError(t,e,i,n);break;case 200:case 201:case 206:case 304:this._onSuccess(t,e,i,n);break;default:this._onError(t,e,i,n)}}_onSuccess(t,e,i,n){let s,r;const o=n.getResponseHeader("Content-Type");if(o){r=o.split(";")[0].trim()}try{s=r===this.ContentType.JSON||e.split("?")[0].endsWith(".json")?JSON.parse(n.responseText):this._isBinaryContentType(r)||n.responseType===Q.ResponseType.ARRAY_BUFFER||n.responseType===Q.ResponseType.BLOB||n.responseType===Q.ResponseType.JSON?n.response:n.responseType===Q.ResponseType.DOCUMENT||r===this.ContentType.XML?n.responseXML:n.responseText,i.callback(null,s)}catch(t){i.callback(t)}}_onError(t,e,i,n){if(!i.retrying)if(i.retry&&i.retries<i.maxRetries){i.retries++,i.retrying=!0;const s=Z.clamp(Math.pow(2,i.retries)*Q.retryDelay,0,i.maxRetryDelay||5e3);console.log(t+": "+e+" - Error "+n.status+". Retrying in "+s+" ms"),setTimeout(()=>{i.retrying=!1,this.request(t,e,i,i.callback)},s)}else i.callback(0===n.status?"Network error":n.status,null)}}Q.ContentType={FORM_URLENCODED:"application/x-www-form-urlencoded",GIF:"image/gif",JPEG:"image/jpeg",DDS:"image/dds",JSON:"application/json",PNG:"image/png",TEXT:"text/plain",XML:"application/xml",WAV:"audio/x-wav",OGG:"audio/ogg",MP3:"audio/mpeg",MP4:"audio/mp4",AAC:"audio/aac",BIN:"application/octet-stream",BASIS:"image/basis",GLB:"model/gltf-binary"},Q.ResponseType={TEXT:"text",ARRAY_BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json"},Q.binaryExtensions=[".model",".wav",".ogg",".mp3",".mp4",".m4a",".aac",".dds",".basis",".glb"],Q.retryDelay=100;const $=new Q,J=0,tt=1,et=2,it=3,nt=4,st=5;class rt{constructor(t=0,e=0,i=0,n=1){const s=t.length;3===s||4===s?(this.r=t[0],this.g=t[1],this.b=t[2],this.a=void 0!==t[3]?t[3]:1):(this.r=t,this.g=e,this.b=i,this.a=n)}clone(){return new rt(this.r,this.g,this.b,this.a)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}equals(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}set(t,e,i,n=1){return this.r=t,this.g=e,this.b=i,this.a=n,this}lerp(t,e,i){return this.r=t.r+i*(e.r-t.r),this.g=t.g+i*(e.g-t.g),this.b=t.b+i*(e.b-t.b),this.a=t.a+i*(e.a-t.a),this}fromString(t){const e=parseInt(t.replace("#","0x"),16);let i;return t.length>7?i=Z.intToBytes32(e):(i=Z.intToBytes24(e),i[3]=255),this.set(i[0]/255,i[1]/255,i[2]/255,i[3]/255),this}toString(t){let e="#"+((1<<24)+(Math.round(255*this.r)<<16)+(Math.round(255*this.g)<<8)+Math.round(255*this.b)).toString(16).slice(1);if(!0===t){const t=Math.round(255*this.a).toString(16);this.a<16/255?e+="0"+t:e+=t}return e}}rt.BLACK=Object.freeze(new rt(0,0,0,1)),rt.BLUE=Object.freeze(new rt(0,0,1,1)),rt.CYAN=Object.freeze(new rt(0,1,1,1)),rt.GRAY=Object.freeze(new rt(.5,.5,.5,1)),rt.GREEN=Object.freeze(new rt(0,1,0,1)),rt.MAGENTA=Object.freeze(new rt(1,0,1,1)),rt.RED=Object.freeze(new rt(1,0,0,1)),rt.WHITE=Object.freeze(new rt(1,1,1,1)),rt.YELLOW=Object.freeze(new rt(1,1,0,1));class ot{constructor(t,e=0){this._curve=t,this._left=-1/0,this._right=1/0,this._recip=0,this._p0=0,this._p1=0,this._m0=0,this._m1=0,this._reset(e)}evaluate(t,e){let i;(e||t<this._left||t>=this._right)&&this._reset(t);const n=this._curve.type;if(n===st)i=this._p0;else{const e=0===this._recip?0:(t-this._left)*this._recip;i=n===J?Z.lerp(this._p0,this._p1,e):n===tt?Z.lerp(this._p0,this._p1,e*e*(3-2*e)):this._evaluateHermite(this._p0,this._p1,this._m0,this._m1,e)}return i}_reset(t){const e=this._curve.keys,i=e.length;if(i)if(t<e[0][0])this._left=-1/0,this._right=e[0][0],this._recip=0,this._p0=this._p1=e[0][1],this._m0=this._m1=0;else if(t>=e[i-1][0])this._left=e[i-1][0],this._right=1/0,this._recip=0,this._p0=this._p1=e[i-1][1],this._m0=this._m1=0;else{let i=0;for(;t>=e[i+1][0];)i++;this._left=e[i][0],this._right=e[i+1][0];const n=1/(this._right-this._left);this._recip=isFinite(n)?n:0,this._p0=e[i][1],this._p1=e[i+1][1],this._isHermite()&&this._calcTangents(e,i)}else this._left=-1/0,this._right=1/0,this._recip=0,this._p0=this._p1=this._m0=this._m1=0}_isHermite(){return this._curve.type===et||this._curve.type===it||this._curve.type===nt}_calcTangents(t,e){let i;const n=t[e],s=t[e+1];let r;if(i=0===e?[t[0][0]+(t[0][0]-t[1][0]),t[0][1]+(t[0][1]-t[1][1])]:t[e-1],r=e===t.length-2?[t[e+1][0]+(t[e+1][0]-t[e][0]),t[e+1][1]+(t[e+1][1]-t[e][1])]:t[e+2],this._curve.type===nt){const t=2*(s[0]-n[0])/(s[0]-i[0]),e=2*(s[0]-n[0])/(r[0]-n[0]);this._m0=this._curve.tension*(isFinite(t)?t:0)*(s[1]-i[1]),this._m1=this._curve.tension*(isFinite(e)?e:0)*(r[1]-n[1])}else{const t=(s[0]-n[0])/(n[0]-i[0]),e=(s[0]-n[0])/(r[0]-s[0]),o=n[1]+(i[1]-n[1])*(isFinite(t)?t:0),a=s[1]+(r[1]-s[1])*(isFinite(e)?e:0),l=this._curve.type===et?.5:this._curve.tension;this._m0=l*(s[1]-o),this._m1=l*(a-n[1])}}_evaluateHermite(t,e,i,n,s){const r=s*s,o=s+s,a=1-s,l=a*a;return t*((1+o)*l)+i*(s*l)+e*(r*(3-o))+n*(r*(s-1))}}class at{constructor(t){if(this.keys=[],this.type=tt,this.tension=.5,this._eval=new ot(this),t)for(let e=0;e<t.length-1;e+=2)this.keys.push([t[e],t[e+1]]);this.sort()}add(t,e){const i=this.keys,n=i.length;let s=0;for(;s<n&&!(i[s][0]>t);s++);const r=[t,e];return this.keys.splice(s,0,r),r}get(t){return this.keys[t]}sort(){this.keys.sort((function(t,e){return t[0]-e[0]}))}value(t){return this._eval.evaluate(t,!0)}closest(t){const e=this.keys,i=e.length;let n=2,s=null;for(let r=0;r<i;r++){const i=Math.abs(t-e[r][0]);if(!(n>=i))break;n=i,s=e[r]}return s}clone(){const t=new at;return t.keys=f(t.keys,this.keys),t.type=this.type,t.tension=this.tension,t}quantize(t){t=Math.max(t,2);const e=new Float32Array(t),i=1/(t-1);e[0]=this._eval.evaluate(0,!0);for(let n=1;n<t;n++)e[n]=this._eval.evaluate(i*n);return e}quantizeClamped(t,e,i){const n=this.quantize(t);for(let t=0;t<n.length;++t)n[t]=Math.min(i,Math.max(e,n[t]));return n}get length(){return this.keys.length}}class lt{constructor(){if(this.curves=[],this._type=tt,arguments.length>1)for(let t=0;t<arguments.length;t++)this.curves.push(new at(arguments[t]));else if(0===arguments.length)this.curves.push(new at);else{const t=arguments[0];if("number"==typeof t)for(let e=0;e<t;e++)this.curves.push(new at);else for(let e=0;e<t.length;e++)this.curves.push(new at(t[e]))}}get(t){return this.curves[t]}value(t,e=[]){const i=this.curves.length;e.length=i;for(let n=0;n<i;n++)e[n]=this.curves[n].value(t);return e}clone(){const t=new lt;t.curves=[];for(let e=0;e<this.curves.length;e++)t.curves.push(this.curves[e].clone());return t._type=this._type,t}quantize(t){t=Math.max(t,2);const e=this.curves.length,i=new Float32Array(t*e),n=1/(t-1);for(let s=0;s<e;s++){const r=new ot(this.curves[s]);for(let o=0;o<t;o++)i[o*e+s]=r.evaluate(n*o)}return i}quantizeClamped(t,e,i){const n=this.quantize(t);for(let t=0;t<n.length;++t)n[t]=Math.min(i,Math.max(e,n[t]));return n}get length(){return this.curves.length}get type(){return this._type}set type(t){this._type=t;for(let e=0;e<this.curves.length;e++)this.curves[e].type=t}}class ht{constructor(t=0,e=0,i=0){3===t.length?(this.x=t[0],this.y=t[1],this.z=t[2]):(this.x=t,this.y=e,this.z=i)}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}add2(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}clone(){return new ht(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}cross(t,e){const i=t.x,n=t.y,s=t.z,r=e.x,o=e.y,a=e.z;return this.x=n*a-o*s,this.y=s*r-a*i,this.z=i*o-r*n,this}distance(t){const e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return Math.sqrt(e*e+i*i+n*n)}div(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}div2(t,e){return this.x=t.x/e.x,this.y=t.y/e.y,this.z=t.z/e.z,this}divScalar(t){return this.x/=t,this.y/=t,this.z/=t,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}equals(t){return this.x===t.x&&this.y===t.y&&this.z===t.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}lerp(t,e,i){return this.x=t.x+i*(e.x-t.x),this.y=t.y+i*(e.y-t.y),this.z=t.z+i*(e.z-t.z),this}mul(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}mul2(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}mulScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}normalize(){const t=this.x*this.x+this.y*this.y+this.z*this.z;if(t>0){const e=1/Math.sqrt(t);this.x*=e,this.y*=e,this.z*=e}return this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}min(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),this}max(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),this}project(t){const e=(this.x*t.x+this.y*t.y+this.z*t.z)/(t.x*t.x+t.y*t.y+t.z*t.z);return this.x=t.x*e,this.y=t.y*e,this.z=t.z*e,this}set(t,e,i){return this.x=t,this.y=e,this.z=i,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}sub2(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}toString(){return"["+this.x+", "+this.y+", "+this.z+"]"}}ht.ZERO=Object.freeze(new ht(0,0,0)),ht.ONE=Object.freeze(new ht(1,1,1)),ht.UP=Object.freeze(new ht(0,1,0)),ht.DOWN=Object.freeze(new ht(0,-1,0)),ht.RIGHT=Object.freeze(new ht(1,0,0)),ht.LEFT=Object.freeze(new ht(-1,0,0)),ht.FORWARD=Object.freeze(new ht(0,0,-1)),ht.BACK=Object.freeze(new ht(0,0,1));class ct{constructor(){const t=new Float32Array(9);t[0]=t[4]=t[8]=1,this.data=t}clone(){return(new ct).copy(this)}copy(t){const e=t.data,i=this.data;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],this}set(t){const e=this.data;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this}equals(t){const e=this.data,i=t.data;return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]&&e[3]===i[3]&&e[4]===i[4]&&e[5]===i[5]&&e[6]===i[6]&&e[7]===i[7]&&e[8]===i[8]}isIdentity(){const t=this.data;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&1===t[4]&&0===t[5]&&0===t[6]&&0===t[7]&&1===t[8]}setIdentity(){const t=this.data;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this}toString(){let t="[";for(let e=0;e<9;e++)t+=this.data[e],t+=8!==e?", ":"";return t+="]",t}transpose(){const t=this.data;let e;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}setFromMat4(t){const e=t.data,i=this.data;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],this}transformVector(t,e=new ht){const i=this.data,n=t.x,s=t.y,r=t.z;return e.x=n*i[0]+s*i[3]+r*i[6],e.y=n*i[1]+s*i[4]+r*i[7],e.z=n*i[2]+s*i[5]+r*i[8],e}}ct.IDENTITY=Object.freeze(new ct),ct.ZERO=Object.freeze((new ct).set([0,0,0,0,0,0,0,0,0]));class _t{constructor(t=0,e=0){2===t.length?(this.x=t[0],this.y=t[1]):(this.x=t,this.y=e)}add(t){return this.x+=t.x,this.y+=t.y,this}add2(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScalar(t){return this.x+=t,this.y+=t,this}clone(){return new _t(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}cross(t){return this.x*t.y-this.y*t.x}distance(t){const e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)}div(t){return this.x/=t.x,this.y/=t.y,this}div2(t,e){return this.x=t.x/e.x,this.y=t.y/e.y,this}divScalar(t){return this.x/=t,this.y/=t,this}dot(t){return this.x*t.x+this.y*t.y}equals(t){return this.x===t.x&&this.y===t.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSq(){return this.x*this.x+this.y*this.y}lerp(t,e,i){return this.x=t.x+i*(e.x-t.x),this.y=t.y+i*(e.y-t.y),this}mul(t){return this.x*=t.x,this.y*=t.y,this}mul2(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this}mulScalar(t){return this.x*=t,this.y*=t,this}normalize(){const t=this.x*this.x+this.y*this.y;if(t>0){const e=1/Math.sqrt(t);this.x*=e,this.y*=e}return this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}min(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),this}max(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),this}set(t,e){return this.x=t,this.y=e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}sub2(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}subScalar(t){return this.x-=t,this.y-=t,this}toString(){return"["+this.x+", "+this.y+"]"}static angleRad(t,e){return Math.atan2(t.x*e.y-t.y*e.x,t.x*e.x+t.y*e.y)}}_t.ZERO=Object.freeze(new _t(0,0)),_t.ONE=Object.freeze(new _t(1,1)),_t.UP=Object.freeze(new _t(0,1)),_t.DOWN=Object.freeze(new _t(0,-1)),_t.RIGHT=Object.freeze(new _t(1,0)),_t.LEFT=Object.freeze(new _t(-1,0));class ut{constructor(t=0,e=0,i=0,n=0){4===t.length?(this.x=t[0],this.y=t[1],this.z=t[2],this.w=t[3]):(this.x=t,this.y=e,this.z=i,this.w=n)}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}add2(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}clone(){return new ut(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}div(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}div2(t,e){return this.x=t.x/e.x,this.y=t.y/e.y,this.z=t.z/e.z,this.w=t.w/e.w,this}divScalar(t){return this.x/=t,this.y/=t,this.z/=t,this.w/=t,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}equals(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}lerp(t,e,i){return this.x=t.x+i*(e.x-t.x),this.y=t.y+i*(e.y-t.y),this.z=t.z+i*(e.z-t.z),this.w=t.w+i*(e.w-t.w),this}mul(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}mul2(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this.w=t.w*e.w,this}mulScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}normalize(){const t=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;if(t>0){const e=1/Math.sqrt(t);this.x*=e,this.y*=e,this.z*=e,this.w*=e}return this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}min(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),t.w<this.w&&(this.w=t.w),this}max(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),t.w>this.w&&(this.w=t.w),this}set(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}sub2(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}toString(){return"["+this.x+", "+this.y+", "+this.z+", "+this.w+"]"}}ut.ZERO=Object.freeze(new ut(0,0,0,0)),ut.ONE=Object.freeze(new ut(1,1,1,1));const dt=new _t,pt=new ht,ft=new ht,mt=new ht,gt=new ht;class bt{constructor(){const t=new Float32Array(16);t[0]=t[5]=t[10]=t[15]=1,this.data=t}static _getPerspectiveHalfSize(t,e,i,n,s){s?(t.x=n*Math.tan(e*Math.PI/360),t.y=t.x/i):(t.y=n*Math.tan(e*Math.PI/360),t.x=t.y*i)}add2(t,e){const i=t.data,n=e.data,s=this.data;return s[0]=i[0]+n[0],s[1]=i[1]+n[1],s[2]=i[2]+n[2],s[3]=i[3]+n[3],s[4]=i[4]+n[4],s[5]=i[5]+n[5],s[6]=i[6]+n[6],s[7]=i[7]+n[7],s[8]=i[8]+n[8],s[9]=i[9]+n[9],s[10]=i[10]+n[10],s[11]=i[11]+n[11],s[12]=i[12]+n[12],s[13]=i[13]+n[13],s[14]=i[14]+n[14],s[15]=i[15]+n[15],this}add(t){return this.add2(this,t)}clone(){return(new bt).copy(this)}copy(t){const e=t.data,i=this.data;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],this}equals(t){const e=this.data,i=t.data;return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]&&e[3]===i[3]&&e[4]===i[4]&&e[5]===i[5]&&e[6]===i[6]&&e[7]===i[7]&&e[8]===i[8]&&e[9]===i[9]&&e[10]===i[10]&&e[11]===i[11]&&e[12]===i[12]&&e[13]===i[13]&&e[14]===i[14]&&e[15]===i[15]}isIdentity(){const t=this.data;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}mul2(t,e){const i=t.data,n=e.data,s=this.data,r=i[0],o=i[1],a=i[2],l=i[3],h=i[4],c=i[5],_=i[6],u=i[7],d=i[8],p=i[9],f=i[10],m=i[11],g=i[12],b=i[13],y=i[14],v=i[15];let S,x,w,C;return S=n[0],x=n[1],w=n[2],C=n[3],s[0]=r*S+h*x+d*w+g*C,s[1]=o*S+c*x+p*w+b*C,s[2]=a*S+_*x+f*w+y*C,s[3]=l*S+u*x+m*w+v*C,S=n[4],x=n[5],w=n[6],C=n[7],s[4]=r*S+h*x+d*w+g*C,s[5]=o*S+c*x+p*w+b*C,s[6]=a*S+_*x+f*w+y*C,s[7]=l*S+u*x+m*w+v*C,S=n[8],x=n[9],w=n[10],C=n[11],s[8]=r*S+h*x+d*w+g*C,s[9]=o*S+c*x+p*w+b*C,s[10]=a*S+_*x+f*w+y*C,s[11]=l*S+u*x+m*w+v*C,S=n[12],x=n[13],w=n[14],C=n[15],s[12]=r*S+h*x+d*w+g*C,s[13]=o*S+c*x+p*w+b*C,s[14]=a*S+_*x+f*w+y*C,s[15]=l*S+u*x+m*w+v*C,this}mulAffine2(t,e){const i=t.data,n=e.data,s=this.data,r=i[0],o=i[1],a=i[2],l=i[4],h=i[5],c=i[6],_=i[8],u=i[9],d=i[10],p=i[12],f=i[13],m=i[14];let g,b,y;return g=n[0],b=n[1],y=n[2],s[0]=r*g+l*b+_*y,s[1]=o*g+h*b+u*y,s[2]=a*g+c*b+d*y,s[3]=0,g=n[4],b=n[5],y=n[6],s[4]=r*g+l*b+_*y,s[5]=o*g+h*b+u*y,s[6]=a*g+c*b+d*y,s[7]=0,g=n[8],b=n[9],y=n[10],s[8]=r*g+l*b+_*y,s[9]=o*g+h*b+u*y,s[10]=a*g+c*b+d*y,s[11]=0,g=n[12],b=n[13],y=n[14],s[12]=r*g+l*b+_*y+p,s[13]=o*g+h*b+u*y+f,s[14]=a*g+c*b+d*y+m,s[15]=1,this}mul(t){return this.mul2(this,t)}transformPoint(t,e=new ht){const i=this.data,n=t.x,s=t.y,r=t.z;return e.x=n*i[0]+s*i[4]+r*i[8]+i[12],e.y=n*i[1]+s*i[5]+r*i[9]+i[13],e.z=n*i[2]+s*i[6]+r*i[10]+i[14],e}transformVector(t,e=new ht){const i=this.data,n=t.x,s=t.y,r=t.z;return e.x=n*i[0]+s*i[4]+r*i[8],e.y=n*i[1]+s*i[5]+r*i[9],e.z=n*i[2]+s*i[6]+r*i[10],e}transformVec4(t,e=new ut){const i=this.data,n=t.x,s=t.y,r=t.z,o=t.w;return e.x=n*i[0]+s*i[4]+r*i[8]+o*i[12],e.y=n*i[1]+s*i[5]+r*i[9]+o*i[13],e.z=n*i[2]+s*i[6]+r*i[10]+o*i[14],e.w=n*i[3]+s*i[7]+r*i[11]+o*i[15],e}setLookAt(t,e,i){mt.sub2(t,e).normalize(),ft.copy(i).normalize(),pt.cross(ft,mt).normalize(),ft.cross(mt,pt);const n=this.data;return n[0]=pt.x,n[1]=pt.y,n[2]=pt.z,n[3]=0,n[4]=ft.x,n[5]=ft.y,n[6]=ft.z,n[7]=0,n[8]=mt.x,n[9]=mt.y,n[10]=mt.z,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}setFrustum(t,e,i,n,s,r){const o=2*s,a=e-t,l=n-i,h=r-s,c=this.data;return c[0]=o/a,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=o/l,c[6]=0,c[7]=0,c[8]=(e+t)/a,c[9]=(n+i)/l,c[10]=(-r-s)/h,c[11]=-1,c[12]=0,c[13]=0,c[14]=-o*r/h,c[15]=0,this}setPerspective(t,e,i,n,s){return bt._getPerspectiveHalfSize(dt,t,e,i,s),this.setFrustum(-dt.x,dt.x,-dt.y,dt.y,i,n)}setOrtho(t,e,i,n,s,r){const o=this.data;return o[0]=2/(e-t),o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/(n-i),o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/(r-s),o[11]=0,o[12]=-(e+t)/(e-t),o[13]=-(n+i)/(n-i),o[14]=-(r+s)/(r-s),o[15]=1,this}setFromAxisAngle(t,e){e*=Z.DEG_TO_RAD;const i=t.x,n=t.y,s=t.z,r=Math.cos(e),o=Math.sin(e),a=1-r,l=a*i,h=a*n,c=this.data;return c[0]=l*i+r,c[1]=l*n+o*s,c[2]=l*s-o*n,c[3]=0,c[4]=l*n-o*s,c[5]=h*n+r,c[6]=h*s+o*i,c[7]=0,c[8]=l*s+o*n,c[9]=h*s-i*o,c[10]=a*s*s+r,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}setTranslate(t,e,i){const n=this.data;return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=t,n[13]=e,n[14]=i,n[15]=1,this}setScale(t,e,i){const n=this.data;return n[0]=t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=i,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}setViewport(t,e,i,n){const s=this.data;return s[0]=.5*i,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=.5*n,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=.5,s[11]=0,s[12]=t+.5*i,s[13]=e+.5*n,s[14]=.5,s[15]=1,this}invert(){const t=this.data,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],l=t[7],h=t[8],c=t[9],_=t[10],u=t[11],d=t[12],p=t[13],f=t[14],m=t[15],g=e*o-i*r,b=e*a-n*r,y=e*l-s*r,v=i*a-n*o,S=i*l-s*o,x=n*l-s*a,w=h*p-c*d,C=h*f-_*d,T=h*m-u*d,A=c*f-_*p,E=c*m-u*p,M=_*m-u*f,R=g*M-b*E+y*A+v*T-S*C+x*w;if(0===R)this.setIdentity();else{const I=1/R;t[0]=(o*M-a*E+l*A)*I,t[1]=(-i*M+n*E-s*A)*I,t[2]=(p*x-f*S+m*v)*I,t[3]=(-c*x+_*S-u*v)*I,t[4]=(-r*M+a*T-l*C)*I,t[5]=(e*M-n*T+s*C)*I,t[6]=(-d*x+f*y-m*b)*I,t[7]=(h*x-_*y+u*b)*I,t[8]=(r*E-o*T+l*w)*I,t[9]=(-e*E+i*T-s*w)*I,t[10]=(d*S-p*y+m*g)*I,t[11]=(-h*S+c*y-u*g)*I,t[12]=(-r*A+o*C-a*w)*I,t[13]=(e*A-i*C+n*w)*I,t[14]=(-d*v+p*b-f*g)*I,t[15]=(h*v-c*b+_*g)*I}return this}set(t){const e=this.data;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this}setIdentity(){const t=this.data;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}setTRS(t,e,i){const n=e.x,s=e.y,r=e.z,o=e.w,a=i.x,l=i.y,h=i.z,c=n+n,_=s+s,u=r+r,d=n*c,p=n*_,f=n*u,m=s*_,g=s*u,b=r*u,y=o*c,v=o*_,S=o*u,x=this.data;return x[0]=(1-(m+b))*a,x[1]=(p+S)*a,x[2]=(f-v)*a,x[3]=0,x[4]=(p-S)*l,x[5]=(1-(d+b))*l,x[6]=(g+y)*l,x[7]=0,x[8]=(f+v)*h,x[9]=(g-y)*h,x[10]=(1-(d+m))*h,x[11]=0,x[12]=t.x,x[13]=t.y,x[14]=t.z,x[15]=1,this}transpose(){let t;const e=this.data;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}invertTo3x3(t){const e=this.data,i=t.data,n=e[0],s=e[1],r=e[2],o=e[4],a=e[5],l=e[6],h=e[8],c=e[9],_=e[10],u=_*a-l*c,d=-_*s+r*c,p=l*s-r*a,f=-_*o+l*h,m=_*n-r*h,g=-l*n+r*o,b=c*o-a*h,y=-c*n+s*h,v=a*n-s*o,S=n*u+s*f+r*b;if(0===S)return this;const x=1/S;return i[0]=x*u,i[1]=x*d,i[2]=x*p,i[3]=x*f,i[4]=x*m,i[5]=x*g,i[6]=x*b,i[7]=x*y,i[8]=x*v,this}getTranslation(t=new ht){return t.set(this.data[12],this.data[13],this.data[14])}getX(t=new ht){return t.set(this.data[0],this.data[1],this.data[2])}getY(t=new ht){return t.set(this.data[4],this.data[5],this.data[6])}getZ(t=new ht){return t.set(this.data[8],this.data[9],this.data[10])}getScale(t=new ht){return this.getX(pt),this.getY(ft),this.getZ(mt),t.set(pt.length(),ft.length(),mt.length()),t}setFromEulerAngles(t,e,i){t*=Z.DEG_TO_RAD,e*=Z.DEG_TO_RAD,i*=Z.DEG_TO_RAD;const n=Math.sin(-t),s=Math.cos(-t),r=Math.sin(-e),o=Math.cos(-e),a=Math.sin(-i),l=Math.cos(-i),h=this.data;return h[0]=o*l,h[1]=-o*a,h[2]=r,h[3]=0,h[4]=s*a+l*n*r,h[5]=s*l-n*r*a,h[6]=-o*n,h[7]=0,h[8]=n*a-s*l*r,h[9]=l*n+s*r*a,h[10]=s*o,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,this}getEulerAngles(t=new ht){this.getScale(gt);const e=gt.x,i=gt.y,n=gt.z;if(0===e||0===i||0===n)return t.set(0,0,0);const s=this.data,r=Math.asin(-s[2]/e),o=.5*Math.PI;let a,l;return r<o?r>-o?(a=Math.atan2(s[6]/i,s[10]/n),l=Math.atan2(s[1]/e,s[0]/e)):(l=0,a=-Math.atan2(s[4]/i,s[5]/i)):(l=0,a=Math.atan2(s[4]/i,s[5]/i)),t.set(a,r,l).mulScalar(Z.RAD_TO_DEG)}toString(){let t="[";for(let e=0;e<16;e+=1)t+=this.data[e],t+=15!==e?", ":"";return t+="]",t}}bt.IDENTITY=Object.freeze(new bt),bt.ZERO=Object.freeze((new bt).set([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]));class yt{constructor(t=0,e=0,i=0,n=1){4===t.length?(this.x=t[0],this.y=t[1],this.z=t[2],this.w=t[3]):(this.x=t,this.y=e,this.z=i,this.w=n)}clone(){return new yt(this.x,this.y,this.z,this.w)}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}equals(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}getAxisAngle(t){let e=2*Math.acos(this.w);const i=Math.sin(e/2);return 0!==i?(t.x=this.x/i,t.y=this.y/i,t.z=this.z/i,(t.x<0||t.y<0||t.z<0)&&(t.x*=-1,t.y*=-1,t.z*=-1,e*=-1)):(t.x=1,t.y=0,t.z=0),e*Z.RAD_TO_DEG}getEulerAngles(t=new ht){let e,i,n;const s=this.x,r=this.y,o=this.z,a=this.w,l=2*(a*r-s*o);return l<=-.99999?(e=2*Math.atan2(s,a),i=-Math.PI/2,n=0):l>=.99999?(e=2*Math.atan2(s,a),i=Math.PI/2,n=0):(e=Math.atan2(2*(a*s+r*o),1-2*(s*s+r*r)),i=Math.asin(l),n=Math.atan2(2*(a*o+s*r),1-2*(r*r+o*o))),t.set(e,i,n).mulScalar(Z.RAD_TO_DEG)}invert(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}mul(t){const e=this.x,i=this.y,n=this.z,s=this.w,r=t.x,o=t.y,a=t.z,l=t.w;return this.x=s*r+e*l+i*a-n*o,this.y=s*o+i*l+n*r-e*a,this.z=s*a+n*l+e*o-i*r,this.w=s*l-e*r-i*o-n*a,this}mul2(t,e){const i=t.x,n=t.y,s=t.z,r=t.w,o=e.x,a=e.y,l=e.z,h=e.w;return this.x=r*o+i*h+n*l-s*a,this.y=r*a+n*h+s*o-i*l,this.z=r*l+s*h+i*a-n*o,this.w=r*h-i*o-n*a-s*l,this}normalize(){let t=this.length();return 0===t?(this.x=this.y=this.z=0,this.w=1):(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this}set(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}setFromAxisAngle(t,e){e*=.5*Z.DEG_TO_RAD;const i=Math.sin(e),n=Math.cos(e);return this.x=i*t.x,this.y=i*t.y,this.z=i*t.z,this.w=n,this}setFromEulerAngles(t,e,i){const n=.5*Z.DEG_TO_RAD;t*=n,e*=n,i*=n;const s=Math.sin(t),r=Math.cos(t),o=Math.sin(e),a=Math.cos(e),l=Math.sin(i),h=Math.cos(i);return this.x=s*a*h-r*o*l,this.y=r*o*h+s*a*l,this.z=r*a*l-s*o*h,this.w=r*a*h+s*o*l,this}setFromMat4(t){let e,i,n,s,r,o,a,l,h,c,_,u,d,p;if(e=(t=t.data)[0],i=t[1],n=t[2],s=t[4],r=t[5],o=t[6],a=t[8],l=t[9],h=t[10],u=e*e+i*i+n*n,0===u)return this;if(u=1/Math.sqrt(u),d=s*s+r*r+o*o,0===d)return this;if(d=1/Math.sqrt(d),p=a*a+l*l+h*h,0===p)return this;p=1/Math.sqrt(p),e*=u,i*=u,n*=u,s*=d,r*=d,o*=d,a*=p,l*=p,h*=p;const f=e+r+h;return f>=0?(c=Math.sqrt(f+1),this.w=.5*c,c=.5/c,this.x=(o-l)*c,this.y=(a-n)*c,this.z=(i-s)*c):e>r?e>h?(_=e-(r+h)+1,_=Math.sqrt(_),this.x=.5*_,_=.5/_,this.w=(o-l)*_,this.y=(i+s)*_,this.z=(n+a)*_):(_=h-(e+r)+1,_=Math.sqrt(_),this.z=.5*_,_=.5/_,this.w=(i-s)*_,this.x=(a+n)*_,this.y=(l+o)*_):r>h?(_=r-(h+e)+1,_=Math.sqrt(_),this.y=.5*_,_=.5/_,this.w=(a-n)*_,this.z=(o+l)*_,this.x=(s+i)*_):(_=h-(e+r)+1,_=Math.sqrt(_),this.z=.5*_,_=.5/_,this.w=(i-s)*_,this.x=(a+n)*_,this.y=(l+o)*_),this}slerp(t,e,i){const n=t.x,s=t.y,r=t.z,o=t.w;let a=e.x,l=e.y,h=e.z,c=e.w,_=o*c+n*a+s*l+r*h;if(_<0&&(c=-c,a=-a,l=-l,h=-h,_=-_),Math.abs(_)>=1)return this.w=o,this.x=n,this.y=s,this.z=r,this;const u=Math.acos(_),d=Math.sqrt(1-_*_);if(Math.abs(d)<.001)return this.w=.5*o+.5*c,this.x=.5*n+.5*a,this.y=.5*s+.5*l,this.z=.5*r+.5*h,this;const p=Math.sin((1-i)*u)/d,f=Math.sin(i*u)/d;return this.w=o*p+c*f,this.x=n*p+a*f,this.y=s*p+l*f,this.z=r*p+h*f,this}transformVector(t,e=new ht){const i=t.x,n=t.y,s=t.z,r=this.x,o=this.y,a=this.z,l=this.w,h=l*i+o*s-a*n,c=l*n+a*i-r*s,_=l*s+r*n-o*i,u=-r*i-o*n-a*s;return e.x=h*l+u*-r+c*-a-_*-o,e.y=c*l+u*-o+_*-r-h*-a,e.z=_*l+u*-a+h*-o-c*-r,e}toString(){return"["+this.x+", "+this.y+", "+this.z+", "+this.w+"]"}}yt.IDENTITY=Object.freeze(new yt(0,0,0,1)),yt.ZERO=Object.freeze(new yt(0,0,0,0));const vt=new ht,St=new ht,xt=new ht,wt=new ht,Ct=new ht;class Tt{constructor(t=new ht,e=new ht(.5,.5,.5)){this.center=t,this.halfExtents=e,this._min=new ht,this._max=new ht}add(t){const e=this.center,i=e.x,n=e.y,s=e.z,r=this.halfExtents,o=r.x,a=r.y,l=r.z;let h=i-o,c=i+o,_=n-a,u=n+a,d=s-l,p=s+l;const f=t.center,m=f.x,g=f.y,b=f.z,y=t.halfExtents,v=y.x,S=y.y,x=y.z,w=m-v,C=m+v,T=g-S,A=g+S,E=b-x,M=b+x;w<h&&(h=w),C>c&&(c=C),T<_&&(_=T),A>u&&(u=A),E<d&&(d=E),M>p&&(p=M),e.x=.5*(h+c),e.y=.5*(_+u),e.z=.5*(d+p),r.x=.5*(c-h),r.y=.5*(u-_),r.z=.5*(p-d)}copy(t){this.center.copy(t.center),this.halfExtents.copy(t.halfExtents)}clone(){return new Tt(this.center.clone(),this.halfExtents.clone())}intersects(t){const e=this.getMax(),i=this.getMin(),n=t.getMax(),s=t.getMin();return i.x<=n.x&&e.x>=s.x&&i.y<=n.y&&e.y>=s.y&&i.z<=n.z&&e.z>=s.z}_intersectsRay(t,e){const i=vt.copy(this.getMin()).sub(t.origin),n=St.copy(this.getMax()).sub(t.origin),s=t.direction;0===s.x?(i.x=i.x<0?-Number.MAX_VALUE:Number.MAX_VALUE,n.x=n.x<0?-Number.MAX_VALUE:Number.MAX_VALUE):(i.x/=s.x,n.x/=s.x),0===s.y?(i.y=i.y<0?-Number.MAX_VALUE:Number.MAX_VALUE,n.y=n.y<0?-Number.MAX_VALUE:Number.MAX_VALUE):(i.y/=s.y,n.y/=s.y),0===s.z?(i.z=i.z<0?-Number.MAX_VALUE:Number.MAX_VALUE,n.z=n.z<0?-Number.MAX_VALUE:Number.MAX_VALUE):(i.z/=s.z,n.z/=s.z);const r=xt.set(Math.min(i.x,n.x),Math.min(i.y,n.y),Math.min(i.z,n.z)),o=wt.set(Math.max(i.x,n.x),Math.max(i.y,n.y),Math.max(i.z,n.z)),a=Math.min(Math.min(o.x,o.y),o.z),l=Math.max(Math.max(r.x,r.y),r.z),h=a>=l&&l>=0;return h&&e.copy(t.direction).mulScalar(l).add(t.origin),h}_fastIntersectsRay(t){const e=vt,i=St,n=xt,s=wt,r=Ct,o=t.direction;return e.sub2(t.origin,this.center),s.set(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)),n.mul2(e,o),!(s.x>this.halfExtents.x&&n.x>=0)&&(!(s.y>this.halfExtents.y&&n.y>=0)&&(!(s.z>this.halfExtents.z&&n.z>=0)&&(r.set(Math.abs(o.x),Math.abs(o.y),Math.abs(o.z)),i.cross(o,e),i.set(Math.abs(i.x),Math.abs(i.y),Math.abs(i.z)),!(i.x>this.halfExtents.y*r.z+this.halfExtents.z*r.y)&&(!(i.y>this.halfExtents.x*r.z+this.halfExtents.z*r.x)&&!(i.z>this.halfExtents.x*r.y+this.halfExtents.y*r.x)))))}intersectsRay(t,e){return e?this._intersectsRay(t,e):this._fastIntersectsRay(t)}setMinMax(t,e){this.center.add2(e,t).mulScalar(.5),this.halfExtents.sub2(e,t).mulScalar(.5)}getMin(){return this._min.copy(this.center).sub(this.halfExtents)}getMax(){return this._max.copy(this.center).add(this.halfExtents)}containsPoint(t){const e=this.getMin(),i=this.getMax();return!(t.x<e.x||t.x>i.x||t.y<e.y||t.y>i.y||t.z<e.z||t.z>i.z)}setFromTransformedAabb(t,e){const i=t.center,n=t.halfExtents,s=e.data,r=s[0],o=s[4],a=s[8],l=s[1],h=s[5],c=s[9],_=s[2],u=s[6],d=s[10];this.center.set(s[12]+r*i.x+o*i.y+a*i.z,s[13]+l*i.x+h*i.y+c*i.z,s[14]+_*i.x+u*i.y+d*i.z),this.halfExtents.set(Math.abs(r)*n.x+Math.abs(o)*n.y+Math.abs(a)*n.z,Math.abs(l)*n.x+Math.abs(h)*n.y+Math.abs(c)*n.z,Math.abs(_)*n.x+Math.abs(u)*n.y+Math.abs(d)*n.z)}compute(t,e){if((e=void 0===e?t.length/3:e)>0){const i=vt.set(t[0],t[1],t[2]),n=St.set(t[0],t[1],t[2]);for(let s=1;s<e;s++){const e=t[3*s+0],r=t[3*s+1],o=t[3*s+2];e<i.x&&(i.x=e),r<i.y&&(i.y=r),o<i.z&&(i.z=o),e>n.x&&(n.x=e),r>n.y&&(n.y=r),o>n.z&&(n.z=o)}this.setMinMax(i,n)}}intersectsBoundingSphere(t){return this._distanceToBoundingSphereSq(t)<=t.radius*t.radius}_distanceToBoundingSphereSq(t){const e=this.getMin(),i=this.getMax();let n=0;const s=["x","y","z"];for(let r=0;r<3;++r){let o=0;const a=t.center[s[r]],l=e[s[r]],h=i[s[r]];let c=0;a<l&&(c=l-a,o+=c*c),a>h&&(c=a-h,o+=c*c),n+=o}return n}_expand(t,e){vt.add2(this.getMin(),t),St.add2(this.getMax(),e),this.setMinMax(vt,St)}}const At=new ht,Et=new ht;class Mt{constructor(t=new ht,e=.5){this.center=t,this.radius=e}containsPoint(t){const e=At.sub2(t,this.center).lengthSq(),i=this.radius;return e<i*i}intersectsRay(t,e){const i=At.copy(t.origin).sub(this.center),n=i.dot(Et.copy(t.direction).normalize()),s=i.dot(i)-this.radius*this.radius;if(s>0&&n>0)return null;const r=n*n-s;if(r<0)return!1;const o=Math.abs(-n-Math.sqrt(r));return e&&e.copy(t.direction).mulScalar(o).add(t.origin),!0}intersectsBoundingSphere(t){At.sub2(t.center,this.center);const e=t.radius+this.radius;return At.lengthSq()<=e*e}}const Rt=0,It=1,Pt=2,Lt=3,Dt=4,kt=5,Ot=6,Ft=7,Bt=8,Nt=9,Ut=10,Vt="none",zt="linear",Wt="exp",Gt="exp2",jt=0,Ht=2,Xt=0,Yt=1,qt=2,Kt=15,Zt=0,Qt=1,$t=2,Jt=3,te=4,ee=0,ie=1,ne=ie,se=2,re=0,oe=1,ae=2,le=3,he=0,ce=1,_e=0,ue=0,de=1,pe=2,fe=3,me=4,ge=5,be=0,ye=1,ve=0,Se=1,xe=2,we=3,Ce=0,Te=1,Ae=0,Ee=1,Me=0,Re=1,Ie=2,Pe=0,Le=1,De=0,ke=1,Oe=2,Fe=0,Be=1,Ne=0,Ue=1,Ve="mul",ze="add",We="screen",Ge="overlay",je="min",He="max",Xe=0,Ye=1,qe=2,Ke=3,Ze=0,Qe=1,$e=2,Je=3,ti=4,ei=0,ii=1,ni=2,si=1,ri=2,oi=4,ai=8,li=16,hi=32,ci=64,_i=128,ui=256,di=512,pi=1024,fi=2048,mi=4096,gi=8192,bi=0,yi=1,vi=2,Si=0,xi=1,wi=2,Ci=0,Ti=1,Ai=1,Ei=2,Mi=4,Ri=0,Ii=1,Pi=2,Li=3,Di=18,ki=0,Oi=1,Fi=2,Bi=0,Ni=1,Ui=0,Vi=1,zi=2,Wi=0,Gi=1,ji=2,Hi=3,Xi=4,Yi=5,qi=1,Ki=2,Zi=4,Qi=8,$i=0,Ji=1,tn=0,en=1,nn=[new ht,new ht,new ht,new ht,new ht,new ht,new ht,new ht];class sn{constructor(){this.planes=[];for(let t=0;t<6;t++)this.planes[t]=[]}setFromMat4(t){const e=t.data;let i;const n=this.planes;i=n[0],i[0]=e[3]-e[0],i[1]=e[7]-e[4],i[2]=e[11]-e[8],i[3]=e[15]-e[12];let s=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);i[0]/=s,i[1]/=s,i[2]/=s,i[3]/=s,i=n[1],i[0]=e[3]+e[0],i[1]=e[7]+e[4],i[2]=e[11]+e[8],i[3]=e[15]+e[12],s=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),i[0]/=s,i[1]/=s,i[2]/=s,i[3]/=s,i=n[2],i[0]=e[3]+e[1],i[1]=e[7]+e[5],i[2]=e[11]+e[9],i[3]=e[15]+e[13],s=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),i[0]/=s,i[1]/=s,i[2]/=s,i[3]/=s,i=n[3],i[0]=e[3]-e[1],i[1]=e[7]-e[5],i[2]=e[11]-e[9],i[3]=e[15]-e[13],s=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),i[0]/=s,i[1]/=s,i[2]/=s,i[3]/=s,i=n[4],i[0]=e[3]-e[2],i[1]=e[7]-e[6],i[2]=e[11]-e[10],i[3]=e[15]-e[14],s=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),i[0]/=s,i[1]/=s,i[2]/=s,i[3]/=s,i=n[5],i[0]=e[3]+e[2],i[1]=e[7]+e[6],i[2]=e[11]+e[10],i[3]=e[15]+e[14],s=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),i[0]/=s,i[1]/=s,i[2]/=s,i[3]/=s}containsPoint(t){let e,i;for(e=0;e<6;e++)if(i=this.planes[e],i[0]*t.x+i[1]*t.y+i[2]*t.z+i[3]<=0)return!1;return!0}containsSphere(t){let e,i,n=0;const s=t.radius,r=t.center,o=r.x,a=r.y,l=r.z,h=this.planes;let c;for(i=0;i<6;i++){if(c=h[i],e=c[0]*o+c[1]*a+c[2]*l+c[3],e<=-s)return 0;e>s&&n++}return 6===n?2:1}static getPoints(t,e,i){e=e||t._nearClip,i=i||t._farClip;const n=t._fov*Math.PI/180;let s=t._projection===Pe?Math.tan(n/2)*e:t._orthoHeight,r=s*t._aspectRatio;const o=nn;return o[0].x=r,o[0].y=-s,o[0].z=-e,o[1].x=r,o[1].y=s,o[1].z=-e,o[2].x=-r,o[2].y=s,o[2].z=-e,o[3].x=-r,o[3].y=-s,o[3].z=-e,t._projection===Pe&&(s=Math.tan(n/2)*i,r=s*t._aspectRatio),o[4].x=r,o[4].y=-s,o[4].z=-i,o[5].x=r,o[5].y=s,o[5].z=-i,o[6].x=-r,o[6].y=s,o[6].z=-i,o[7].x=-r,o[7].y=-s,o[7].z=-i,o}}class rn{constructor(t=new ht,e=new ht(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}}const on=new rn,an=new ht,ln=new Mt,hn=new bt;class cn{constructor(t=new bt,e=new ht(.5,.5,.5)){this.halfExtents=e,this._modelTransform=t.clone().invert(),this._worldTransform=t.clone(),this._aabb=new Tt(new ht,this.halfExtents)}intersectsRay(t,e){if(this._modelTransform.transformPoint(t.origin,on.origin),this._modelTransform.transformVector(t.direction,on.direction),e){const t=this._aabb._intersectsRay(on,e);return hn.copy(this._modelTransform).invert().transformPoint(e,e),t}return this._aabb._fastIntersectsRay(on)}containsPoint(t){return this._modelTransform.transformPoint(t,an),this._aabb.containsPoint(an)}intersectsBoundingSphere(t){return this._modelTransform.transformPoint(t.center,ln.center),ln.radius=t.radius,!!this._aabb.intersectsBoundingSphere(ln)}get worldTransform(){return this._worldTransform}set worldTransform(t){this._worldTransform.copy(t),this._modelTransform.copy(t).invert()}}const _n=new ht;class un{constructor(t=new ht,e=new ht(0,0,1)){this.normal=e,this.point=t}intersectsLine(t,e,i){const n=-this.normal.dot(this.point),s=this.normal.dot(t)+n,r=s/(s-(this.normal.dot(e)+n)),o=r>=0&&r<=1;return o&&i&&i.lerp(t,e,r),o}intersectsRay(t,e){const i=_n.sub2(this.point,t.origin),n=this.normal.dot(i)/this.normal.dot(t.direction),s=n>=0;return s&&e&&e.copy(t.direction).mulScalar(n).add(t.origin),s}}const dn=0,pn=1,fn=2,mn=0,gn=1,bn=2,yn=3,vn=4,Sn=5,xn=6,wn=7,Cn=8,Tn=9,An=10,En=0,Mn=1,Rn=2,In=3,Pn=4,Ln=0,Dn=1,kn=2,On=3,Fn=1,Bn=2,Nn=4,Un=0,Vn=1,zn=2,Wn=3,Gn=4,jn=5,Hn=0,Xn=1,Yn=2,qn=3,Kn=0,Zn=1,Qn=2,$n=3,Jn=4,ts=5,es=0,is=1,ns=2,ss=3,rs=4,os=5,as=6,ls=7,hs=0,cs=1,_s=2,us=0,ds=1,ps=2,fs=3,ms=4,gs=5,bs=6,ys=7,vs=8,Ss=9,xs=10,ws=11,Cs=12,Ts=13,As=14,Es=15,Ms=16,Rs=17,Is=18,Ps=19,Ls=20,Ds=21,ks=22,Os=23,Fs=24,Bs=25,Ns=26,Us=27,Vs=28,zs=29,Ws=30,Gs=0,js=1,Hs=2,Xs=3,Ys=4,qs=5,Ks=6,Zs="POSITION",Qs="NORMAL",$s="TANGENT",Js="BLENDWEIGHT",tr="BLENDINDICES",er="COLOR",ir="TEXCOORD",nr="TEXCOORD0",sr="TEXCOORD1",rr="TEXCOORD2",or="TEXCOORD3",ar="TEXCOORD4",lr="TEXCOORD5",hr="TEXCOORD6",cr="TEXCOORD7",_r="ATTR",ur="ATTR0",dr="ATTR1",pr="ATTR2",fr="ATTR3",mr="ATTR4",gr="ATTR5",br="ATTR6",yr="ATTR7",vr="ATTR8",Sr="ATTR9",xr="ATTR10",wr="ATTR11",Cr="ATTR12",Tr="ATTR13",Ar="ATTR14",Er="ATTR15",Mr=1,Rr=0,Ir=1,Pr=2,Lr=3,Dr=4,kr=5,Or=6,Fr=7,Br=1,Nr=2,Ur="default",Vr="rgbm",zr="rgbe",Wr="swizzleGGGR",Gr=0,jr=1,Hr=2,Xr=3,Yr="none",qr="cube",Kr="equirect",Zr="octahedral",Qr=0,$r=1,Jr=2,to=3,eo=4,io=5,no=6,so=0,ro=1,oo=2,ao=3,lo=4,ho=5,co=6,_o=7,uo=8,po=9,fo=10,mo=11,go=12,bo=13,yo=14,vo=15,So=16,xo=17,wo=18,Co=19,To=20,Ao=21,Eo=22,Mo=23,Ro=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array],Io=[1,1,2,2,4,4,4],Po={Int8Array:Qr,Uint8Array:$r,Int16Array:Jr,Uint16Array:to,Int32Array:eo,Uint32Array:io,Float32Array:no},Lo=[Uint8Array,Uint16Array,Uint32Array],Do=[1,2,4],ko={};ko[Zs]=0,ko[Qs]=1,ko[Js]=2,ko[tr]=3,ko[er]=4,ko[nr]=5,ko[sr]=6,ko[rr]=7,ko[or]=8,ko[ar]=9,ko[lr]=10,ko[hr]=11,ko[cr]=12,ko[$s]=13,ko[ur]=0,ko[dr]=1,ko[pr]=2,ko[fr]=3,ko[mr]=4,ko[gr]=5,ko[br]=6,ko[yr]=7,ko[vr]=8,ko[Sr]=9,ko[xr]=10,ko[wr]=11,ko[Cr]=12,ko[Tr]=13,ko[Ar]=14,ko[Er]=15;let Oo=0;class Fo{constructor(t,e,i,n=Ln,s){this.device=t,this.format=e,this.numVertices=i,this.usage=n,this.id=Oo++,this._vao=null,this.instancing=!1,this.numBytes=e.verticesByteSize?e.verticesByteSize:e.size*i,t._vram.vb+=this.numBytes,s?this.setData(s):this.storage=new ArrayBuffer(this.numBytes),this.device.buffers.push(this)}destroy(){const t=this.device,e=t.buffers.indexOf(this);if(-1!==e&&t.buffers.splice(e,1),this.bufferId){const e=t.gl;t.boundVao=null,e.bindVertexArray(null),e.deleteBuffer(this.bufferId),t._vram.vb-=this.storage.byteLength,this.bufferId=null}}loseContext(){this.bufferId=void 0,this._vao=null}getFormat(){return this.format}getUsage(){return this.usage}getNumVertices(){return this.numVertices}lock(){return this.storage}unlock(){const t=this.device.gl;let e;switch(this.bufferId||(this.bufferId=t.createBuffer()),this.usage){case Ln:e=t.STATIC_DRAW;break;case Dn:e=t.DYNAMIC_DRAW;break;case kn:e=t.STREAM_DRAW;break;case On:e=this.device.webgl2?t.DYNAMIC_COPY:t.STATIC_DRAW}t.bindBuffer(t.ARRAY_BUFFER,this.bufferId),t.bufferData(t.ARRAY_BUFFER,this.storage,e)}setData(t){return t.byteLength!==this.numBytes?(console.error("VertexBuffer: wrong initial data size: expected "+this.numBytes+", got "+t.byteLength),!1):(this.storage=t,this.unlock(),!0)}}function Bo(t){let e=0;for(let i=0,n=t.length;i<n;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}class No{constructor(t,e,i){this.elements=[],this.hasUv0=!1,this.hasUv1=!1,this.hasColor=!1,this.hasTangents=!1,this.verticesByteSize=0,this.vertexCount=i,this.interleaved=void 0===i,this.size=e.reduce((t,e)=>t+4*Math.ceil(e.components*Io[e.type]/4),0);let n,s=0;for(let t=0,r=e.length;t<r;t++){const r=e[t];n=r.components*Io[r.type],i&&(s=Z.roundUp(s,n));const o={name:r.semantic,offset:i?s:r.hasOwnProperty("offset")?r.offset:s,stride:i?n:r.hasOwnProperty("stride")?r.stride:this.size,dataType:r.type,numComponents:r.components,normalize:void 0!==r.normalize&&r.normalize,size:n};this.elements.push(o),s+=i?n*i:4*Math.ceil(n/4),r.semantic===nr?this.hasUv0=!0:r.semantic===sr?this.hasUv1=!0:r.semantic===er?this.hasColor=!0:r.semantic===$s&&(this.hasTangents=!0)}i&&(this.verticesByteSize=s),this.update()}static init(t){const e=[{semantic:Cr,components:4,type:no},{semantic:Tr,components:4,type:no},{semantic:Ar,components:4,type:no},{semantic:Er,components:4,type:no}];No._defaultInstancingFormat=new No(t,e)}static get defaultInstancingFormat(){return No._defaultInstancingFormat}update(){this._evaluateHash()}_evaluateHash(){let t;const e=[];let i;const n=[],s=this.elements.length;for(let r=0;r<s;r++){const s=this.elements[r];t=s.name,t+=s.dataType,t+=s.numComponents,t+=s.normalize,e.push(t),i=t,i+=s.offset,i+=s.stride,i+=s.size,n.push(i)}e.sort(),this.batchingHash=Bo(e.join()),this.renderingingHash=Bo(n.join())}}No._defaultInstancingFormat=null;let Uo=null;const Vo={type:qs,base:0,count:4,indexed:!1};function zo(t,e,i,n,s,r=!1){if(null===Uo){const e=new No(t,[{semantic:Zs,components:2,type:no}]),i=new Float32Array(8);i.set([-1,-1,1,-1,-1,1,1,1]),Uo=new Fo(t,e,4,Ln,i)}const o=t.renderTarget;let a,l,h,c,_,u,d,p;t.setRenderTarget(e),t.updateBegin(),n?(a=n.x,l=n.y,h=n.z,c=n.w):(h=e?e.width:t.width,c=e?e.height:t.height,a=0,l=0),s?(_=s.x,u=s.y,d=s.z,p=s.w):(_=a,u=l,d=h,p=c);const f=t.vx,m=t.vy,g=t.vw,b=t.vh;t.setViewport(a,l,h,c);const y=t.sx,v=t.sy,S=t.sw,x=t.sh;t.setScissor(_,u,d,p);const w=t.getDepthTest(),C=t.getDepthWrite(),T=t.getCullMode(),A=t.writeRed,E=t.writeGreen,M=t.writeBlue,R=t.writeAlpha;t.setDepthTest(!1),t.setDepthWrite(!1),t.setCullMode(Hn),t.setColorWrite(!0,!0,!0,!0),r||t.setBlending(!1),t.setVertexBuffer(Uo,0),t.setShader(i),t.draw(Vo),t.setDepthTest(w),t.setDepthWrite(C),t.setCullMode(T),t.setColorWrite(A,E,M,R),t.updateEnd(),t.setRenderTarget(o),t.updateBegin(),t.setViewport(f,m,g,b),t.setScissor(y,v,S,x)}function Wo(t,e,i,n,s,r,o=!1){n=n||t.getCopyShader(),t.constantTexSource.setValue(e),zo(t,i,n,s,r,o)}class Go{constructor(t,e){this.device=t,this.definition=e,this.init(),this.device.createShader(this)}init(){this.attributes=[],this.uniforms=[],this.samplers=[],this.ready=!1,this.failed=!1}destroy(){this.device.destroyShader(this)}loseContext(){this.init()}}const jo={alphaTestPS:"uniform float alpha_ref;\nvoid alphaTest(float a) {\n\tif (a < alpha_ref) discard;\n}\n",ambientConstantPS:"void addAmbient() {\n\tdDiffuseLight += light_globalAmbient;\n}\n",ambientPrefilteredCubePS:"#ifndef PMREM4\n#define PMREM4\nuniform samplerCube texture_prefilteredCubeMap4;\n#endif\nvoid addAmbient() {\n\tvec3 fixedReflDir = fixSeamsStatic(cubeMapRotate(dNormalW), 1.0 - 1.0 / 4.0);\n#ifndef RIGHT_HANDED_CUBEMAP\n\tfixedReflDir.x *= -1.0;\n#endif\n\tdDiffuseLight += processEnvironment($DECODE(textureCube(texture_prefilteredCubeMap4, fixedReflDir)).rgb);\n}\n",ambientPrefilteredCubeLodPS:"#ifndef PMREM4\n#define PMREM4\n#extension GL_EXT_shader_texture_lod : enable\nuniform samplerCube texture_prefilteredCubeMap128;\n#endif\nvoid addAmbient() {\n\tvec3 fixedReflDir = fixSeamsStatic(cubeMapRotate(dNormalW), 1.0 - 1.0 / 4.0);\n#ifndef RIGHT_HANDED_CUBEMAP\n\tfixedReflDir.x *= -1.0;\n#endif\n\tdDiffuseLight += processEnvironment($DECODE( textureCubeLodEXT(texture_prefilteredCubeMap128, fixedReflDir, 5.0) ).rgb);\n}\n",ambientSHPS:"uniform vec3 ambientSH[9];\nvoid addAmbient() {\n\tvec3 n = cubeMapRotate(dNormalW);\n\tvec3 color =\n\t\tambientSH[0] +\n\t\tambientSH[1] * n.x +\n\t\tambientSH[2] * n.y +\n\t\tambientSH[3] * n.z +\n\t\tambientSH[4] * n.x * n.z +\n\t\tambientSH[5] * n.z * n.y +\n\t\tambientSH[6] * n.y * n.x +\n\t\tambientSH[7] * (3.0 * n.z * n.z - 1.0) +\n\t\tambientSH[8] * (n.x * n.x - n.y * n.y);\n\tdDiffuseLight += processEnvironment(max(color, vec3(0.0)));\n}\n",aoPS:"#ifdef MAPTEXTURE\nuniform sampler2D texture_aoMap;\n#endif\nvoid applyAO() {\n\tdAo = 1.0;\n\t#ifdef MAPTEXTURE\n\tdAo *= texture2D(texture_aoMap, $UV).$CH;\n\t#endif\n\t#ifdef MAPVERTEX\n\tdAo *= saturate(vVertexColor.$VC);\n\t#endif\n\tdDiffuseLight *= dAo;\n}\n",aoSpecOccPS:"uniform float material_occludeSpecularIntensity;\nvoid occludeSpecular() {\n\tfloat specPow = exp2(dGlossiness * 11.0);\n\tfloat specOcc = saturate(pow(dot(dNormalW, dViewDirW) + dAo, 0.01*specPow) - 1.0 + dAo);\n\tspecOcc = mix(1.0, specOcc, material_occludeSpecularIntensity);\n\tdSpecularLight *= specOcc;\n\tdReflection *= specOcc;\n}\n",aoSpecOccConstPS:"void occludeSpecular() {\n\tfloat specPow = exp2(dGlossiness * 11.0);\n\tfloat specOcc = saturate(pow(dot(dNormalW, dViewDirW) + dAo, 0.01*specPow) - 1.0 + dAo);\n\tdSpecularLight *= specOcc;\n\tdReflection *= specOcc;\n}\n",aoSpecOccConstSimplePS:"void occludeSpecular() {\n\tfloat specOcc = dAo;\n\tdSpecularLight *= specOcc;\n\tdReflection *= specOcc;\n}\n",aoSpecOccSimplePS:"uniform float material_occludeSpecularIntensity;\nvoid occludeSpecular() {\n\tfloat specOcc = mix(1.0, dAo, material_occludeSpecularIntensity);\n\tdSpecularLight *= specOcc;\n\tdReflection *= specOcc;\n}\n",bakeDirLmEndPS:"\tvec4 dirLm = texture2D(texture_dirLightMap, vUv1);\n\tif (bakeDir > 0.5) {\n\t\tif (dAtten > 0.00001) {\n\t\t\tdirLm.xyz = dirLm.xyz * 2.0 - vec3(1.0);\n\t\t\tdAtten = saturate(dAtten);\n\t\t\tgl_FragColor.rgb = normalize(dLightDirNormW.xyz*dAtten + dirLm.xyz*dirLm.w) * 0.5 + vec3(0.5);\n\t\t\tgl_FragColor.a = dirLm.w + dAtten;\n\t\t\tgl_FragColor.a = max(gl_FragColor.a, 1.0 / 255.0);\n\t\t} else {\n\t\t\tgl_FragColor = dirLm;\n\t\t}\n\t} else {\n\t\tgl_FragColor.rgb = dirLm.xyz;\n\t\tgl_FragColor.a = max(dirLm.w, dAtten > 0.00001? (1.0/255.0) : 0.0);\n\t}\n",bakeLmEndPS:"\tgl_FragColor.rgb = dDiffuseLight;\n\tgl_FragColor.rgb = pow(gl_FragColor.rgb, vec3(0.5));\n\tgl_FragColor.rgb /= 8.0;\n\tgl_FragColor.a = clamp( max( max( gl_FragColor.r, gl_FragColor.g ), max( gl_FragColor.b, 1.0 / 255.0 ) ), 0.0,1.0 );\n\tgl_FragColor.a = ceil(gl_FragColor.a * 255.0) / 255.0;\n\tgl_FragColor.rgb /= gl_FragColor.a;\n",basePS:"uniform vec3 view_position;\nuniform vec3 light_globalAmbient;\nfloat square(float x) {\n\treturn x*x;\n}\nfloat saturate(float x) {\n\treturn clamp(x, 0.0, 1.0);\n}\nvec3 saturate(vec3 x) {\n\treturn clamp(x, vec3(0.0), vec3(1.0));\n}\n",baseVS:"attribute vec3 vertex_position;\nattribute vec3 vertex_normal;\nattribute vec4 vertex_tangent;\nattribute vec2 vertex_texCoord0;\nattribute vec2 vertex_texCoord1;\nattribute vec4 vertex_color;\nuniform mat4 matrix_viewProjection;\nuniform mat4 matrix_model;\nuniform mat3 matrix_normal;\nvec3 dPositionW;\nmat4 dModelMatrix;\nmat3 dNormalMatrix;\n",baseNineSlicedPS:"#define NINESLICED\nvarying vec2 vMask;\nvarying vec2 vTiledUv;\nuniform mediump vec4 innerOffset;\nuniform mediump vec2 outerScale;\nuniform mediump vec4 atlasRect;\nvec2 nineSlicedUv;\n",baseNineSlicedVS:"#define NINESLICED\nvarying vec2 vMask;\nvarying vec2 vTiledUv;\nuniform mediump vec4 innerOffset;\nuniform mediump vec2 outerScale;\nuniform mediump vec4 atlasRect;\n",baseNineSlicedTiledPS:"#define NINESLICED\n#define NINESLICETILED\nvarying vec2 vMask;\nvarying vec2 vTiledUv;\nuniform mediump vec4 innerOffset;\nuniform mediump vec2 outerScale;\nuniform mediump vec4 atlasRect;\nvec2 nineSlicedUv;\n",biasConstPS:"#define SHADOWBIAS\nfloat getShadowBias(float resolution, float maxBias) {\n\treturn maxBias;\n}\n",blurVSMPS:"varying vec2 vUv0;\nuniform sampler2D source;\nuniform vec2 pixelOffset;\n#ifdef GAUSS\nuniform float weight[SAMPLES];\n#endif\n#ifdef PACKED\nfloat decodeFloatRG(vec2 rg) {\n\treturn rg.y*(1.0/255.0) + rg.x;\n}\nvec2 encodeFloatRG( float v ) {\n\tvec2 enc = vec2(1.0, 255.0) * v;\n\tenc = fract(enc);\n\tenc -= enc.yy * vec2(1.0/255.0, 1.0/255.0);\n\treturn enc;\n}\n#endif\nvoid main(void) {\n\tvec3 moments = vec3(0.0);\n\tvec2 uv = vUv0 - pixelOffset * (float(SAMPLES) * 0.5);\n\tfor (int i=0; i<SAMPLES; i++) {\n\t\tvec4 c = texture2D(source, uv + pixelOffset * float(i));\n\t\t#ifdef PACKED\n\t\tc.xy = vec2(decodeFloatRG(c.xy), decodeFloatRG(c.zw));\n\t\t#endif\n\t\t#ifdef GAUSS\n\t\tmoments += c.xyz * weight[i];\n\t\t#else\n\t\tmoments += c.xyz;\n\t\t#endif\n\t}\n\t#ifndef GAUSS\n\tmoments /= float(SAMPLES);\n\t#endif\n\t#ifdef PACKED\n\tgl_FragColor = vec4(encodeFloatRG(moments.x), encodeFloatRG(moments.y));\n\t#else\n\tgl_FragColor = vec4(moments.x, moments.y, moments.z, 1.0);\n\t#endif\n}\n",clearCoatPS:"#ifdef MAPFLOAT\nuniform float material_clearCoat;\n#endif\n#ifdef MAPTEXTURE\nuniform sampler2D texture_clearCoatMap;\n#endif\nvoid getClearCoat() {\n\tccSpecularity = 1.0;\n\t#ifdef MAPFLOAT\n\tccSpecularity *= material_clearCoat;\n\t#endif\n\t#ifdef MAPTEXTURE\n\tccSpecularity *= texture2D(texture_clearCoatMap, $UV).$CH;\n\t#endif\n\t#ifdef MAPVERTEX\n\tccSpecularity *= saturate(vVertexColor.$VC);\n\t#endif\n}\n",clearCoatGlossPS:"#ifdef MAPFLOAT\nuniform float material_clearCoatGlossiness;\n#endif\n#ifdef MAPTEXTURE\nuniform sampler2D texture_clearCoatGlossMap;\n#endif\nvoid getClearCoatGlossiness() {\n\tccGlossiness = 1.0;\n\t#ifdef MAPFLOAT\n\tccGlossiness *= material_clearCoatGlossiness;\n\t#endif\n\t#ifdef MAPTEXTURE\n\tccGlossiness *= texture2D(texture_clearCoatGlossMap, $UV).$CH;\n\t#endif\n\t#ifdef MAPVERTEX\n\tccGlossiness *= saturate(vVertexColor.$VC);\n\t#endif\n\tccGlossiness += 0.0000001;\n}\n",clearCoatNormalPS:"#ifdef MAPTEXTURE\nuniform sampler2D texture_clearCoatNormalMap;\nuniform float material_clearCoatBumpiness;\n#endif\nvoid getClearCoatNormal() {\n\t#ifdef MAPTEXTURE\n\tvec3 normalMap = unpackNormal(texture2D(texture_clearCoatNormalMap, $UV));\n\tnormalMap = normalize(mix(vec3(0.0, 0.0, 1.0), normalMap, material_clearCoatBumpiness));\n\tccNormalW = dTBN * normalMap;\n\t#else\n\tccNormalW = normalize(dVertexNormalW);\n\t#endif\n\tccReflDirW = normalize(-reflect(dViewDirW, ccNormalW));\n}\n",clusteredLightCookiesPS:"vec3 _getCookieClustered(sampler2D tex, vec2 uv, float intensity, bool isRgb, vec4 cookieChannel) {\n\tvec4 pixel = mix(vec4(1.0), texture2D(tex, uv), intensity);\n\treturn isRgb == true ? pixel.rgb : vec3(dot(pixel, cookieChannel));\n}\nvec3 getCookie2DClustered(sampler2D tex, mat4 transform, vec3 worldPosition, float intensity, bool isRgb, vec4 cookieChannel) {\n\tvec4 projPos = transform * vec4(worldPosition, 1.0);\n\treturn _getCookieClustered(tex, projPos.xy / projPos.w, intensity, isRgb, cookieChannel);\n}\nvec3 getCookieCubeClustered(sampler2D tex, vec3 dir, float intensity, bool isRgb, vec4 cookieChannel, float shadowTextureResolution, float shadowEdgePixels, vec3 omniAtlasViewport) {\n\tvec2 uv = getCubemapAtlasCoordinates(omniAtlasViewport, shadowEdgePixels, shadowTextureResolution, dir);\n\treturn _getCookieClustered(tex, uv, intensity, isRgb, cookieChannel);\n}\n",clusteredLightShadowsPS:"\n#ifdef GL2\nfloat getShadowOmniClusteredSingleSample(sampler2DShadow shadowMap, vec4 shadowParams, vec3 omniAtlasViewport, float shadowEdgePixels, vec3 dir) {\n\tfloat shadowTextureResolution = shadowParams.x;\n\tvec2 uv = getCubemapAtlasCoordinates(omniAtlasViewport, shadowEdgePixels, shadowTextureResolution, dir);\n\tfloat shadowZ = length(dir) * shadowParams.w + shadowParams.z;\n\treturn texture(shadowMap, vec3(uv, shadowZ));\n}\nfloat getShadowOmniClusteredPCF3x3(sampler2DShadow shadowMap, vec4 shadowParams, vec3 omniAtlasViewport, float shadowEdgePixels, vec3 dir) {\n\tfloat shadowTextureResolution = shadowParams.x;\n\tvec2 uv = getCubemapAtlasCoordinates(omniAtlasViewport, shadowEdgePixels, shadowTextureResolution, dir);\n\tfloat shadowZ = length(dir) * shadowParams.w + shadowParams.z;\n\tdShadowCoord = vec3(uv, shadowZ);\n\treturn getShadowPCF3x3(shadowMap, shadowParams.xyz);\n}\n#else\nfloat getShadowOmniClusteredSingleSample(sampler2D shadowMap, vec4 shadowParams, vec3 omniAtlasViewport, float shadowEdgePixels, vec3 dir) {\n\tfloat shadowTextureResolution = shadowParams.x;\n\tvec2 uv = getCubemapAtlasCoordinates(omniAtlasViewport, shadowEdgePixels, shadowTextureResolution, dir);\n\tfloat depth = unpackFloat(texture2D(shadowMap, uv));\n\tfloat shadowZ = length(dir) * shadowParams.w + shadowParams.z;\n\treturn depth > shadowZ ? 1.0 : 0.0;\n}\nfloat getShadowOmniClusteredPCF3x3(sampler2D shadowMap, vec4 shadowParams, vec3 omniAtlasViewport, float shadowEdgePixels, vec3 dir) {\n\tfloat shadowTextureResolution = shadowParams.x;\n\tvec2 uv = getCubemapAtlasCoordinates(omniAtlasViewport, shadowEdgePixels, shadowTextureResolution, dir);\n\tfloat shadowZ = length(dir) * shadowParams.w + shadowParams.z;\n\tdShadowCoord = vec3(uv, shadowZ);\n\treturn getShadowPCF3x3(shadowMap, shadowParams.xyz);\n}\n#endif\n",clusteredLightUtilsPS:"\nvec2 getCubemapFaceCoordinates(const vec3 dir, out float faceIndex, out vec2 tileOffset)\n{\n\tvec3 vAbs = abs(dir);\n\tfloat ma;\n\tvec2 uv;\n\tif (vAbs.z >= vAbs.x && vAbs.z >= vAbs.y) {\n\t\tfaceIndex = dir.z < 0.0 ? 5.0 : 4.0;\n\t\tma = 0.5 / vAbs.z;\n\t\tuv = vec2(dir.z < 0.0 ? -dir.x : dir.x, -dir.y);\n\t\ttileOffset.x = 2.0;\n\t\ttileOffset.y = dir.z < 0.0 ? 1.0 : 0.0;\n\t} else if(vAbs.y >= vAbs.x) {\n\t\tfaceIndex = dir.y < 0.0 ? 3.0 : 2.0;\n\t\tma = 0.5 / vAbs.y;\n\t\tuv = vec2(dir.x, dir.y < 0.0 ? -dir.z : dir.z);\n\t\ttileOffset.x = 1.0;\n\t\ttileOffset.y = dir.y < 0.0 ? 1.0 : 0.0;\n\t} else {\n\t\tfaceIndex = dir.x < 0.0 ? 1.0 : 0.0;\n\t\tma = 0.5 / vAbs.x;\n\t\tuv = vec2(dir.x < 0.0 ? dir.z : -dir.z, -dir.y);\n\t\ttileOffset.x = 0.0;\n\t\ttileOffset.y = dir.x < 0.0 ? 1.0 : 0.0;\n\t}\n\treturn uv * ma + 0.5;\n}\nvec2 getCubemapAtlasCoordinates(const vec3 omniAtlasViewport, float shadowEdgePixels, float shadowTextureResolution, const vec3 dir) {\n\tfloat faceIndex;\n\tvec2 tileOffset;\n\tvec2 uv = getCubemapFaceCoordinates(dir, faceIndex, tileOffset);\n\tfloat atlasFaceSize = omniAtlasViewport.z;\n\tfloat tileSize = shadowTextureResolution * atlasFaceSize;\n\tfloat offset = shadowEdgePixels / tileSize;\n\tuv = uv * vec2(1.0 - offset * 2.0) + vec2(offset * 1.0);\n\tuv *= atlasFaceSize;\n\tuv += tileOffset * atlasFaceSize;\n\tuv += omniAtlasViewport.xy;\n\treturn uv;\n}\n",clusteredLightPS:"uniform sampler2D clusterWorldTexture;\nuniform sampler2D lightsTexture8;\nuniform highp sampler2D lightsTextureFloat;\n#ifdef CLUSTER_SHADOWS\n\t#ifdef GL2\n\t\tuniform sampler2DShadow shadowAtlasTexture;\n\t#else\n\t\tuniform sampler2D shadowAtlasTexture;\n\t#endif\n#endif\n#ifdef CLUSTER_COOKIES\n\tuniform sampler2D cookieAtlasTexture;\n#endif\nuniform float clusterPixelsPerCell;\nuniform vec3 clusterCellsCountByBoundsSize;\nuniform vec4 lightsTextureInvSize;\nuniform vec3 clusterTextureSize;\nuniform vec3 clusterBoundsMin;\nuniform vec3 clusterBoundsDelta;\nuniform vec3 clusterCellsDot;\nuniform vec3 clusterCellsMax;\nuniform vec2 clusterCompressionLimit0;\nuniform vec2 shadowAtlasParams;\nstruct ClusterLightData {\n\tfloat lightV;\n\tbool isSpot;\n\tfloat shape;\n\tfloat falloffMode;\n\tbool castShadows;\n\tfloat shadowBias;\n\tfloat shadowNormalBias;\n\tmat4 lightProjectionMatrix;\n\tvec3 position;\n\tvec3 direction;\n\tfloat range;\n\tfloat innerConeAngleCos;\n\tfloat outerConeAngleCos;\n\tvec3 color;\n\tvec3 omniAtlasViewport;\n\tbool isCookie;\n\tbool isCookieRgb;\n\tfloat cookieIntensity;\n\tvec4 cookieChannelMask;\n};\nvec4 decodeClusterLowRange4Vec4(vec4 d0, vec4 d1, vec4 d2, vec4 d3) {\n\treturn vec4(\n\t\tbytes2floatRange4(d0, -2.0, 2.0),\n\t\tbytes2floatRange4(d1, -2.0, 2.0),\n\t\tbytes2floatRange4(d2, -2.0, 2.0),\n\t\tbytes2floatRange4(d3, -2.0, 2.0)\n\t);\n}\nvec4 sampleLightsTexture8(const ClusterLightData clusterLightData, float index) {\n\treturn texture2D(lightsTexture8, vec2(index * lightsTextureInvSize.z, clusterLightData.lightV));\n}\nvec4 sampleLightTextureF(const ClusterLightData clusterLightData, float index) {\n\treturn texture2D(lightsTextureFloat, vec2(index * lightsTextureInvSize.x, clusterLightData.lightV));\n}\nvoid decodeClusterLightCore(inout ClusterLightData clusterLightData, float lightIndex) {\n\tclusterLightData.lightV = (lightIndex + 0.5) * lightsTextureInvSize.w;\n\tvec4 lightInfo = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_FLAGS);\n\tclusterLightData.isSpot = lightInfo.x > 0.5;\n\tclusterLightData.shape = lightInfo.y;\n\tclusterLightData.falloffMode = lightInfo.z;\n\tclusterLightData.castShadows = lightInfo.w > 0.5;\n\tvec4 colorA = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_COLOR_A);\n\tvec4 colorB = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_COLOR_B);\n\tclusterLightData.color = vec3(bytes2float2(colorA.xy), bytes2float2(colorA.zw), bytes2float2(colorB.xy)) * clusterCompressionLimit0.y;\n\tclusterLightData.isCookie = colorB.z > 0.5;\n\t#ifdef CLUSTER_TEXTURE_FLOAT\n\t\tvec4 lightPosRange = sampleLightTextureF(clusterLightData, CLUSTER_TEXTURE_F_POSITION_RANGE);\n\t\tclusterLightData.position = lightPosRange.xyz;\n\t\tclusterLightData.range = lightPosRange.w;\n\t\tvec4 lightDir_Unused = sampleLightTextureF(clusterLightData, CLUSTER_TEXTURE_F_SPOT_DIRECTION);\n\t\tclusterLightData.direction = lightDir_Unused.xyz;\n\t#else\n\t\tvec4 encPosX = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_POSITION_X);\n\t\tvec4 encPosY = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_POSITION_Y);\n\t\tvec4 encPosZ = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_POSITION_Z);\n\t\tclusterLightData.position = vec3(bytes2float4(encPosX), bytes2float4(encPosY), bytes2float4(encPosZ)) * clusterBoundsDelta + clusterBoundsMin;\n\t\tvec4 encRange = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_RANGE);\n\t\tclusterLightData.range = bytes2float4(encRange) * clusterCompressionLimit0.x;\n\t\tvec4 encDirX = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_SPOT_DIRECTION_X);\n\t\tvec4 encDirY = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_SPOT_DIRECTION_Y);\n\t\tvec4 encDirZ = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_SPOT_DIRECTION_Z);\n\t\tclusterLightData.direction = vec3(bytes2float4(encDirX), bytes2float4(encDirY), bytes2float4(encDirZ)) * 2.0 - 1.0;\n\t#endif\n}\nvoid decodeClusterLightSpot(inout ClusterLightData clusterLightData) {\n\tvec4 coneAngle = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_SPOT_ANGLES);\n\tclusterLightData.innerConeAngleCos = bytes2float2(coneAngle.xy) * 2.0 - 1.0;\n\tclusterLightData.outerConeAngleCos = bytes2float2(coneAngle.zw) * 2.0 - 1.0;\n}\nvoid decodeClusterLightOmniAtlasViewport(inout ClusterLightData clusterLightData) {\n\t#ifdef CLUSTER_TEXTURE_FLOAT\n\t\tclusterLightData.omniAtlasViewport = sampleLightTextureF(clusterLightData, CLUSTER_TEXTURE_F_PROJ_MAT_0).xyz;\n\t#else\n\t\tvec4 viewportA = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_ATLAS_VIEWPORT_A);\n\t\tvec4 viewportB = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_ATLAS_VIEWPORT_B);\n\t\tclusterLightData.omniAtlasViewport = vec3(bytes2float2(viewportA.xy), bytes2float2(viewportA.zw), bytes2float2(viewportB.xy));\n\t#endif\n}\nvoid decodeClusterLightProjectionMatrixData(inout ClusterLightData clusterLightData) {\n\t#ifdef CLUSTER_TEXTURE_FLOAT\n\t\tvec4 m0 = sampleLightTextureF(clusterLightData, CLUSTER_TEXTURE_F_PROJ_MAT_0);\n\t\tvec4 m1 = sampleLightTextureF(clusterLightData, CLUSTER_TEXTURE_F_PROJ_MAT_1);\n\t\tvec4 m2 = sampleLightTextureF(clusterLightData, CLUSTER_TEXTURE_F_PROJ_MAT_2);\n\t\tvec4 m3 = sampleLightTextureF(clusterLightData, CLUSTER_TEXTURE_F_PROJ_MAT_3);\n\t#else\n\t\tvec4 m00 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_00);\n\t\tvec4 m01 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_01);\n\t\tvec4 m02 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_02);\n\t\tvec4 m03 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_03);\n\t\tvec4 m0 = decodeClusterLowRange4Vec4(m00, m01, m02, m03);\n\t\tvec4 m10 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_10);\n\t\tvec4 m11 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_11);\n\t\tvec4 m12 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_12);\n\t\tvec4 m13 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_13);\n\t\tvec4 m1 = decodeClusterLowRange4Vec4(m10, m11, m12, m13);\n\t\tvec4 m20 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_20);\n\t\tvec4 m21 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_21);\n\t\tvec4 m22 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_22);\n\t\tvec4 m23 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_23);\n\t\tvec4 m2 = decodeClusterLowRange4Vec4(m20, m21, m22, m23);\n\t\tvec4 m30 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_30);\n\t\tvec4 m31 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_31);\n\t\tvec4 m32 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_32);\n\t\tvec4 m33 = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_PROJ_MAT_33);\n\t\tvec4 m3 = vec4(mantisaExponent2Float(m30), mantisaExponent2Float(m31), mantisaExponent2Float(m32), mantisaExponent2Float(m33));\n\t#endif\n\tclusterLightData.lightProjectionMatrix = mat4(m0, m1, m2, m3);\n}\nvoid decodeClusterLightShadowData(inout ClusterLightData clusterLightData) {\n\tvec4 biases = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_SHADOW_BIAS);\n\tclusterLightData.shadowBias = bytes2floatRange2(biases.xy, -1.0, 20.0),\n\tclusterLightData.shadowNormalBias = bytes2float2(biases.zw);\n}\nvoid decodeClusterLightCookieData(inout ClusterLightData clusterLightData) {\n\tvec4 cookieA = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_COOKIE_A);\n\tclusterLightData.cookieIntensity = cookieA.x;\n\tclusterLightData.isCookieRgb = cookieA.y > 0.5;\n\tclusterLightData.cookieChannelMask = sampleLightsTexture8(clusterLightData, CLUSTER_TEXTURE_8_COOKIE_B);\n}\nvoid evaluateLight(ClusterLightData light) {\n\tdAtten3 = vec3(1.0);\n\tgetLightDirPoint(light.position);\n\tdAtten = getFalloffLinear(light.range);\n\tif (dAtten > 0.00001) {\n\t\tdAtten *= getLightDiffuse();\n\t\tif (light.isSpot == true) {\n\t\t\tdecodeClusterLightSpot(light);\n\t\t\tdAtten *= getSpotEffect(light.direction, light.innerConeAngleCos, light.outerConeAngleCos);\n\t\t}\n\t\t#if defined(CLUSTER_COOKIES) || defined(CLUSTER_SHADOWS)\n\t\tif (dAtten > 0.00001) {\n\t\t\tif (light.castShadows == true || light.isCookie == true) {\n\t\t\t\tif (light.isSpot == true) {\n\t\t\t\t\tdecodeClusterLightProjectionMatrixData(light);\n\t\t\t\t} else {\n\t\t\t\t\tdecodeClusterLightOmniAtlasViewport(light);\n\t\t\t\t}\n\t\t\t\tfloat shadowTextureResolution = shadowAtlasParams.x;\n\t\t\t\tfloat shadowEdgePixels = shadowAtlasParams.y;\n\t\t\t\t#ifdef CLUSTER_COOKIES\n\t\t\t\tif (light.isCookie == true) {\n\t\t\t\t\tdecodeClusterLightCookieData(light);\n\t\t\t\t\tif (light.isSpot == true) {\n\t\t\t\t\t\tdAtten3 = getCookie2DClustered(cookieAtlasTexture, light.lightProjectionMatrix, vPositionW, light.cookieIntensity, light.isCookieRgb, light.cookieChannelMask);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdAtten3 = getCookieCubeClustered(cookieAtlasTexture, dLightDirW, light.cookieIntensity, light.isCookieRgb, light.cookieChannelMask, shadowTextureResolution, shadowEdgePixels, light.omniAtlasViewport);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t#endif\n\t\t\t\t#ifdef CLUSTER_SHADOWS\n\t\t\t\tif (light.castShadows== true) {\n\t\t\t\t\tdecodeClusterLightShadowData(light);\n\t\t\t\t\tvec4 shadowParams = vec4(shadowTextureResolution, light.shadowNormalBias, light.shadowBias, 1.0 / light.range);\n\t\t\t\t\tif (light.isSpot == true) {\n\t\t\t\t\t\tgetShadowCoordPerspZbufferNormalOffset(light.lightProjectionMatrix, shadowParams);\n\t\t\t\t\t\tdAtten *= getShadowSpotPCF3x3(shadowAtlasTexture, shadowParams);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnormalOffsetPointShadow(shadowParams);\n\t\t\t\t\t\tdAtten *= getShadowOmniClusteredPCF3x3(shadowAtlasTexture, shadowParams, light.omniAtlasViewport, shadowEdgePixels, dLightDirW);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t#endif\n\t\t\t}\n\t\t}\n\t\t#endif\n\t\tdDiffuseLight += dAtten * light.color * dAtten3;\n\t}\n}\nvoid evaluateClusterLight(float lightIndex) {\n\tClusterLightData clusterLightData;\n\tdecodeClusterLightCore(clusterLightData, lightIndex);\n\tevaluateLight(clusterLightData);\n}\nconst vec4 channelSelector[4] = vec4[4] (\n\tvec4(1., 0., 0., 0.),\n\tvec4(0., 1., 0., 0.),\n\tvec4(0., 0., 1., 0.),\n\tvec4(0., 0., 0., 1.)\n);\nvoid addClusteredLights() {\n\tvec3 cellCoords = floor((vPositionW - clusterBoundsMin) * clusterCellsCountByBoundsSize);\n\tif (!(any(lessThan(cellCoords, vec3(0.0))) || any(greaterThanEqual(cellCoords, clusterCellsMax)))) {\n\t\tfloat cellIndex = dot(clusterCellsDot, cellCoords);\n\t\tfloat clusterV = floor(cellIndex * clusterTextureSize.y);\n\t\tfloat clusterU = cellIndex - (clusterV * clusterTextureSize.x);\n\t\tclusterV = (clusterV + 0.5) * clusterTextureSize.z;\n\t\tconst float maxLightCells = 256.0 / 4.0;\n\t\tfor (float lightCellIndex = 0.5; lightCellIndex < maxLightCells; lightCellIndex++) {\n\t\t\tvec4 lightIndices = texture2D(clusterWorldTexture, vec2(clusterTextureSize.y * (clusterU + lightCellIndex), clusterV));\n\t\t\tvec4 indices = lightIndices * 255.0;\n\t\t\tfor (int i = 0; i < 4; i++) {\n\t\t\t\tfloat index = dot(channelSelector[i], indices);\n\t\t\t\tif (index <= 0.0)\n\t\t\t\t\treturn;\n\t\t\t\tevaluateClusterLight(index);\n\t\t\t}\n\t\t\tif (lightCellIndex > clusterPixelsPerCell) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n",combineClearCoatPS:"vec3 combineColorCC() {\n\treturn combineColor()+(ccSpecularLight*ccSpecularity+ccReflection.rgb*ccSpecularity*ccReflection.a);\n}\n",combineDiffusePS:"vec3 combineColor() {\n\treturn dAlbedo * dDiffuseLight;\n}\n",combineDiffuseSpecularPS:"vec3 combineColor() {\n\treturn mix(dAlbedo * dDiffuseLight, dSpecularLight + dReflection.rgb * dReflection.a, dSpecularity);\n}\n",combineDiffuseSpecularNoConservePS:"vec3 combineColor() {\n\treturn dAlbedo * dDiffuseLight + (dSpecularLight + dReflection.rgb * dReflection.a) * dSpecularity;\n}\n",combineDiffuseSpecularNoReflPS:"vec3 combineColor() {\n\treturn dAlbedo * dDiffuseLight + dSpecularLight * dSpecularity;\n}\n",combineDiffuseSpecularNoReflSeparateAmbientPS:"uniform vec3 material_ambient;\nvec3 combineColor() {\n\treturn (dDiffuseLight - light_globalAmbient) * dAlbedo + dSpecularLight * dSpecularity + material_ambient * light_globalAmbient;\n}\n",combineDiffuseSpecularOldPS:"vec3 combineColor() {\n\treturn mix(dAlbedo * dDiffuseLight + dSpecularLight * dSpecularity, dReflection.rgb, dReflection.a);\n}\n",cookiePS:"\nvec4 getCookie2D(sampler2D tex, mat4 transform, float intensity) {\n\tvec4 projPos = transform * vec4(vPositionW, 1.0);\n\tprojPos.xy /= projPos.w;\n\treturn mix(vec4(1.0), texture2D(tex, projPos.xy), intensity);\n}\nvec4 getCookie2DClip(sampler2D tex, mat4 transform, float intensity) {\n\tvec4 projPos = transform * vec4(vPositionW, 1.0);\n\tprojPos.xy /= projPos.w;\n\tif (projPos.x < 0.0 || projPos.x > 1.0 || projPos.y < 0.0 || projPos.y > 1.0 || projPos.z < 0.0) return vec4(0.0);\n\treturn mix(vec4(1.0), texture2D(tex, projPos.xy), intensity);\n}\nvec4 getCookie2DXform(sampler2D tex, mat4 transform, float intensity, vec4 cookieMatrix, vec2 cookieOffset) {\n\tvec4 projPos = transform * vec4(vPositionW, 1.0);\n\tprojPos.xy /= projPos.w;\n\tprojPos.xy += cookieOffset;\n\tvec2 uv = mat2(cookieMatrix) * (projPos.xy-vec2(0.5)) + vec2(0.5);\n\treturn mix(vec4(1.0), texture2D(tex, uv), intensity);\n}\nvec4 getCookie2DClipXform(sampler2D tex, mat4 transform, float intensity, vec4 cookieMatrix, vec2 cookieOffset) {\n\tvec4 projPos = transform * vec4(vPositionW, 1.0);\n\tprojPos.xy /= projPos.w;\n\tprojPos.xy += cookieOffset;\n\tif (projPos.x < 0.0 || projPos.x > 1.0 || projPos.y < 0.0 || projPos.y > 1.0 || projPos.z < 0.0) return vec4(0.0);\n\tvec2 uv = mat2(cookieMatrix) * (projPos.xy-vec2(0.5)) + vec2(0.5);\n\treturn mix(vec4(1.0), texture2D(tex, uv), intensity);\n}\nvec4 getCookieCube(samplerCube tex, mat4 transform, float intensity) {\n\treturn mix(vec4(1.0), textureCube(tex, dLightDirNormW * mat3(transform)), intensity);\n}\n",cubeMapProjectBoxPS:"uniform vec3 envBoxMin, envBoxMax;\nvec3 cubeMapProject(vec3 nrdir) {\n\tnrdir = cubeMapRotate(nrdir);\n\tvec3 rbmax = (envBoxMax - vPositionW) / nrdir;\n\tvec3 rbmin = (envBoxMin - vPositionW) / nrdir;\n\tvec3 rbminmax;\n\trbminmax.x = nrdir.x>0.0? rbmax.x : rbmin.x;\n\trbminmax.y = nrdir.y>0.0? rbmax.y : rbmin.y;\n\trbminmax.z = nrdir.z>0.0? rbmax.z : rbmin.z;\n\tfloat fa = min(min(rbminmax.x, rbminmax.y), rbminmax.z);\n\tvec3 posonbox = vPositionW + nrdir * fa;\n\tvec3 envBoxPos = (envBoxMin + envBoxMax) * 0.5;\n\treturn posonbox - envBoxPos;\n}\n",cubeMapProjectNonePS:"vec3 cubeMapProject(vec3 dir) {\n\treturn cubeMapRotate(dir);\n}\n",cubeMapRotatePS:"#ifdef CUBEMAP_ROTATION\nuniform mat3 cubeMapRotationMatrix;\n#endif\nvec3 cubeMapRotate(vec3 refDir) {\n#ifdef CUBEMAP_ROTATION\n\treturn refDir * cubeMapRotationMatrix;\n#else\n\treturn refDir;\n#endif\n}\n",detailModesPS:"vec3 detailMode_mul(vec3 c1, vec3 c2) {\n\treturn c1 * c2;\n}\nvec3 detailMode_add(vec3 c1, vec3 c2) {\n\treturn c1 + c2;\n}\nvec3 detailMode_screen(vec3 c1, vec3 c2) {\n\treturn 1.0 - (1.0 - c1)*(1.0 - c2);\n}\nvec3 detailMode_overlay(vec3 c1, vec3 c2) {\n\treturn mix(1.0 - 2.0*(1.0 - c1)*(1.0 - c2), 2.0*c1*c2, step(c1, vec3(0.5)));\n}\nvec3 detailMode_min(vec3 c1, vec3 c2) {\n\treturn min(c1, c2);\n}\nvec3 detailMode_max(vec3 c1, vec3 c2) {\n\treturn max(c1, c2);\n}\n",diffusePS:"#ifdef MAPCOLOR\nuniform vec3 material_diffuse;\n#endif\n#ifdef MAPTEXTURE\nuniform sampler2D texture_diffuseMap;\n#endif\nvoid getAlbedo() {\n\tdAlbedo = vec3(1.0);\n\t#ifdef MAPCOLOR\n\tdAlbedo *= material_diffuse.rgb;\n\t#endif\n\t#ifdef MAPTEXTURE\n\tdAlbedo *= gammaCorrectInput(addAlbedoDetail(texture2D(texture_diffuseMap, $UV).$CH));\n\t#endif\n\t#ifdef MAPVERTEX\n\tdAlbedo *= gammaCorrectInput(saturate(vVertexColor.$VC));\n\t#endif\n}\n",diffuseDetailMapPS:"#ifdef MAPTEXTURE\nuniform sampler2D texture_diffuseDetailMap;\n#endif\nvec3 addAlbedoDetail(vec3 albedo) {\n\t#ifdef MAPTEXTURE\n\tvec3 albedoDetail = vec3(texture2D(texture_diffuseDetailMap, $UV).$CH);\n\treturn detailMode_$DETAILMODE(albedo, albedoDetail);\n\t#else\n\treturn albedo;\n\t#endif\n}\n",dilatePS:"#define SHADER_NAME Dilate\nvarying vec2 vUv0;\nuniform sampler2D source;\nuniform vec2 pixelOffset;\nvoid main(void) {\n\tvec4 c = texture2D(source, vUv0);\n\tc = c.a>0.0? c : texture2D(source, vUv0 - pixelOffset);\n\tc = c.a>0.0? c : texture2D(source, vUv0 + vec2(0, -pixelOffset.y));\n\tc = c.a>0.0? c : texture2D(source, vUv0 + vec2(pixelOffset.x, -pixelOffset.y));\n\tc = c.a>0.0? c : texture2D(source, vUv0 + vec2(-pixelOffset.x, 0));\n\tc = c.a>0.0? c : texture2D(source, vUv0 + vec2(pixelOffset.x, 0));\n\tc = c.a>0.0? c : texture2D(source, vUv0 + vec2(-pixelOffset.x, pixelOffset.y));\n\tc = c.a>0.0? c : texture2D(source, vUv0 + vec2(0, pixelOffset.y));\n\tc = c.a>0.0? c : texture2D(source, vUv0 + pixelOffset);\n\tgl_FragColor = c;\n}\n",bilateralDeNoisePS:"\n#define SHADER_NAME BilateralDeNoise\nfloat normpdf3(in vec3 v, in float sigma) {\n\treturn 0.39894 * exp(-0.5 * dot(v, v) / (sigma * sigma)) / sigma;\n}\nvec3 decodeRGBM(vec4 rgbm) {\n\tvec3 color = (8.0 * rgbm.a) * rgbm.rgb;\n\treturn color * color;\n}\nfloat saturate(float x) {\n\treturn clamp(x, 0.0, 1.0);\n}\nvec4 encodeRGBM(vec3 color) {\n\tvec4 encoded;\n\tencoded.rgb = pow(color.rgb, vec3(0.5));\n\tencoded.rgb *= 1.0 / 8.0;\n\tencoded.a = saturate( max( max( encoded.r, encoded.g ), max( encoded.b, 1.0 / 255.0 ) ) );\n\tencoded.a = ceil(encoded.a * 255.0) / 255.0;\n\tencoded.rgb /= encoded.a;\n\treturn encoded;\n}\n#define MSIZE 15\nvarying vec2 vUv0;\nuniform sampler2D source;\nuniform vec2 pixelOffset;\nuniform vec2 sigmas;\nuniform float bZnorm;\nuniform float kernel[MSIZE];\nvoid main(void) {\n\tvec4 pixelRgbm = texture2D(source, vUv0);\n\tif (pixelRgbm.a <= 0.0) {\n\t\tgl_FragColor = pixelRgbm;\n\t\treturn ;\n\t}\n\tfloat sigma = sigmas.x;\n\tfloat bSigma = sigmas.y;\n\tvec3 pixelHdr = decodeRGBM(pixelRgbm);\n\tvec3 accumulatedHdr = vec3(0.0);\n\tfloat accumulatedFactor = 0.0;\n\tconst int kSize = (MSIZE-1)/2;\n\tfor (int i = -kSize; i <= kSize; ++i) {\n\t\tfor (int j = -kSize; j <= kSize; ++j) {\n\t\t\tvec2 coord = vUv0 + vec2(float(i), float(j)) * pixelOffset;\n\t\t\tvec4 rgbm = texture2D(source, coord);\n\t\t\tif (rgbm.a > 0.0) {\n\t\t\t\tvec3 hdr = decodeRGBM(rgbm);\n\t\t\t\tfloat factor = kernel[kSize + j] * kernel[kSize + i];\n\t\t\t\tfactor *= normpdf3(hdr - pixelHdr, bSigma) * bZnorm;\n\t\t\t\taccumulatedHdr += factor * hdr;\n\t\t\t\taccumulatedFactor += factor;\n\t\t\t}\n\t\t}\n\t}\n\tgl_FragColor = encodeRGBM(accumulatedHdr / accumulatedFactor);\n}\n",dpAtlasQuadPS:"varying vec2 vUv0;\nuniform sampler2D source;\nuniform vec4 params;\nvoid main(void) {\n\tvec2 uv = vUv0;\n\tuv = uv * 2.0 - vec2(1.0);\n\tuv *= params.xy;\n\tuv = uv * 0.5 + 0.5;\n\tgl_FragColor = texture2D(source, uv);\n}\n",emissivePS:"#ifdef MAPCOLOR\nuniform vec3 material_emissive;\n#endif\n#ifdef MAPFLOAT\nuniform float material_emissiveIntensity;\n#endif\n#ifdef MAPTEXTURE\nuniform sampler2D texture_emissiveMap;\n#endif\nvec3 getEmission() {\n\tvec3 emission = vec3(1.0);\n\t#ifdef MAPFLOAT\n\temission *= material_emissiveIntensity;\n\t#endif\n\t#ifdef MAPCOLOR\n\temission *= material_emissive;\n\t#endif\n\t#ifdef MAPTEXTURE\n\temission *= $texture2DSAMPLE(texture_emissiveMap, $UV).$CH;\n\t#endif\n\t#ifdef MAPVERTEX\n\temission *= gammaCorrectInput(saturate(vVertexColor.$VC));\n\t#endif\n\treturn emission;\n}\n",endPS:"\t#ifdef CLEARCOAT\n\tgl_FragColor.rgb = combineColorCC();\n\t#else\n\tgl_FragColor.rgb = combineColor();\n\t#endif\n\tgl_FragColor.rgb += getEmission();\n\tgl_FragColor.rgb = addFog(gl_FragColor.rgb);\n\t#ifndef HDR\n\tgl_FragColor.rgb = toneMap(gl_FragColor.rgb);\n\tgl_FragColor.rgb = gammaCorrectOutput(gl_FragColor.rgb);\n\t#endif\n",endVS:"\n",envConstPS:"vec3 processEnvironment(vec3 color) {\n\treturn color;\n}\n",envMultiplyPS:"uniform float skyboxIntensity;\nvec3 processEnvironment(vec3 color) {\n\treturn color * skyboxIntensity;\n}\n",extensionPS:"\n",extensionVS:"\n",falloffInvSquaredPS:"float getFalloffWindow(float lightRadius) {\n\tfloat sqrDist = dot(dLightDirW, dLightDirW);\n\tfloat invRadius = 1.0 / lightRadius;\n\treturn square( saturate( 1.0 - square( sqrDist * square(invRadius) ) ) );\n}\nfloat getFalloffInvSquared(float lightRadius) {\n\tfloat sqrDist = dot(dLightDirW, dLightDirW);\n\tfloat falloff = 1.0 / (sqrDist + 1.0);\n\tfloat invRadius = 1.0 / lightRadius;\n\tfalloff *= 16.0;\n\tfalloff *= square( saturate( 1.0 - square( sqrDist * square(invRadius) ) ) );\n\treturn falloff;\n}\n",falloffLinearPS:"float getFalloffLinear(float lightRadius) {\n\tfloat d = length(dLightDirW);\n\treturn max(((lightRadius - d) / lightRadius), 0.0);\n}\n",fixCubemapSeamsNonePS:"vec3 fixSeams(vec3 vec, float mipmapIndex) {\n\treturn vec;\n}\nvec3 fixSeams(vec3 vec) {\n\treturn vec;\n}\nvec3 fixSeamsStatic(vec3 vec, float invRecMipSize) {\n\treturn vec;\n}\nvec3 calcSeam(vec3 vec) {\n\treturn vec3(0);\n}\nvec3 applySeam(vec3 vec, vec3 seam, float scale) {\n\treturn vec;\n}\n",fixCubemapSeamsStretchPS:"vec3 fixSeams(vec3 vec, float mipmapIndex) {\n\tfloat scale = 1.0 - exp2(mipmapIndex) / 128.0;\n\tfloat M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n\tif (abs(vec.x) != M) vec.x *= scale;\n\tif (abs(vec.y) != M) vec.y *= scale;\n\tif (abs(vec.z) != M) vec.z *= scale;\n\treturn vec;\n}\nvec3 fixSeams(vec3 vec) {\n\tfloat scale = 1.0 - 1.0 / 128.0;\n\tfloat M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n\tif (abs(vec.x) != M) vec.x *= scale;\n\tif (abs(vec.y) != M) vec.y *= scale;\n\tif (abs(vec.z) != M) vec.z *= scale;\n\treturn vec;\n}\nvec3 fixSeamsStatic(vec3 vec, float invRecMipSize) {\n\tfloat scale = invRecMipSize;\n\tfloat M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n\tif (abs(vec.x) != M) vec.x *= scale;\n\tif (abs(vec.y) != M) vec.y *= scale;\n\tif (abs(vec.z) != M) vec.z *= scale;\n\treturn vec;\n}\nvec3 calcSeam(vec3 vec) {\n\tvec3 avec = abs(vec);\n\tfloat M = max(avec.x, max(avec.y, avec.z));\n\treturn vec3(avec.x != M ? 1.0 : 0.0,\n\t\t\t\tavec.y != M ? 1.0 : 0.0,\n\t\t\t\tavec.z != M ? 1.0 : 0.0);\n}\nvec3 applySeam(vec3 vec, vec3 seam, float scale) {\n\treturn vec * (seam * -scale + vec3(1.0));\n}\n",floatUnpackingPS:"\nfloat bytes2float2(vec2 data) {\n\treturn dot(data, vec2(1.0, 1.0 / 255.0));\n}\nfloat bytes2float3(vec3 data) {\n\treturn dot(data, vec3(1.0, 1.0 / 255.0, 1.0 / 65025.0));\n}\nfloat bytes2float4(vec4 data) {\n\treturn dot(data, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));\n}\nfloat bytes2floatRange2(vec2 data, float min, float max) {\n\treturn mix(min, max, bytes2float2(data));\n}\nfloat bytes2floatRange3(vec3 data, float min, float max) {\n\treturn mix(min, max, bytes2float3(data));\n}\nfloat bytes2floatRange4(vec4 data, float min, float max) {\n\treturn mix(min, max, bytes2float4(data));\n}\nfloat mantisaExponent2Float(vec4 pack)\n{\n\tfloat value = bytes2floatRange3(pack.xyz, -1.0, 1.0);\n\tfloat exponent = floor(pack.w * 255.0 - 127.0);\n\treturn value * exp2(exponent);\n}\n",fogExpPS:"uniform vec3 fog_color;\nuniform float fog_density;\nfloat dBlendModeFogFactor = 1.0;\nvec3 addFog(vec3 color) {\n\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\tfloat fogFactor = exp(-depth * fog_density);\n\tfogFactor = clamp(fogFactor, 0.0, 1.0);\n\treturn mix(fog_color * dBlendModeFogFactor, color, fogFactor);\n}\n",fogExp2PS:"uniform vec3 fog_color;\nuniform float fog_density;\nfloat dBlendModeFogFactor = 1.0;\nvec3 addFog(vec3 color) {\n\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\tfloat fogFactor = exp(-depth * depth * fog_density * fog_density);\n\tfogFactor = clamp(fogFactor, 0.0, 1.0);\n\treturn mix(fog_color * dBlendModeFogFactor, color, fogFactor);\n}\n",fogLinearPS:"uniform vec3 fog_color;\nuniform float fog_start;\nuniform float fog_end;\nfloat dBlendModeFogFactor = 1.0;\nvec3 addFog(vec3 color) {\n\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\tfloat fogFactor = (fog_end - depth) / (fog_end - fog_start);\n\tfogFactor = clamp(fogFactor, 0.0, 1.0);\n\tfogFactor = gammaCorrectInput(fogFactor);\n\treturn mix(fog_color * dBlendModeFogFactor, color, fogFactor);\n}\n",fogNonePS:"float dBlendModeFogFactor = 1.0;\nvec3 addFog(vec3 color) {\n\treturn color;\n}\n",fresnelSchlickPS:"\nuniform float material_fresnelFactor;\nvoid getFresnel() {\n\tfloat fresnel = 1.0 - max(dot(dNormalW, dViewDirW), 0.0);\n\tfloat fresnel2 = fresnel * fresnel;\n\tfresnel *= fresnel2 * fresnel2;\n\tfresnel *= dGlossiness * dGlossiness;\n\tdSpecularity = dSpecularity + (1.0 - dSpecularity) * fresnel;\n\t#ifdef CLEARCOAT\n\tfresnel = 1.0 - max(dot(ccNormalW, dViewDirW), 0.0);\n\tfresnel2 = fresnel * fresnel;\n\tfresnel *= fresnel2 * fresnel2;\n\tfresnel *= ccGlossiness * ccGlossiness;\n\tccSpecularity = ccSpecularity + (1.0 - ccSpecularity) * fresnel;\n\t#endif\n}\n",fullscreenQuadPS:"varying vec2 vUv0;\nuniform sampler2D source;\nvoid main(void) {\n\tgl_FragColor = texture2D(source, vUv0);\n}\n",fullscreenQuadVS:"attribute vec2 vertex_position;\nvarying vec2 vUv0;\nvoid main(void)\n{\n\tgl_Position = vec4(vertex_position, 0.5, 1.0);\n\tvUv0 = vertex_position.xy*0.5+0.5;\n}\n",gamma1_0PS:"vec4 texture2DSRGB(sampler2D tex, vec2 uv) {\n\treturn texture2D(tex, uv);\n}\nvec4 texture2DSRGB(sampler2D tex, vec2 uv, float bias) {\n\treturn texture2D(tex, uv, bias);\n}\nvec4 textureCubeSRGB(samplerCube tex, vec3 uvw) {\n\treturn textureCube(tex, uvw);\n}\nvec3 gammaCorrectOutput(vec3 color) {\n\treturn color;\n}\nvec3 gammaCorrectInput(vec3 color) {\n\treturn color;\n}\nfloat gammaCorrectInput(float color) {\n\treturn color;\n}\nvec4 gammaCorrectInput(vec4 color) {\n\treturn color;\n}\n",gamma2_2PS:"vec3 gammaCorrectInput(vec3 color) {\n\treturn pow(color, vec3(2.2));\n}\nfloat gammaCorrectInput(float color) {\n\treturn pow(color, 2.2);\n}\nvec4 gammaCorrectInput(vec4 color) {\n\treturn vec4(pow(color.rgb, vec3(2.2)), color.a);\n}\nvec4 texture2DSRGB(sampler2D tex, vec2 uv) {\n\tvec4 rgba = texture2D(tex, uv);\n\trgba.rgb = gammaCorrectInput(rgba.rgb);\n\treturn rgba;\n}\nvec4 texture2DSRGB(sampler2D tex, vec2 uv, float bias) {\n\tvec4 rgba = texture2D(tex, uv, bias);\n\trgba.rgb = gammaCorrectInput(rgba.rgb);\n\treturn rgba;\n}\nvec4 textureCubeSRGB(samplerCube tex, vec3 uvw) {\n\tvec4 rgba = textureCube(tex, uvw);\n\trgba.rgb = gammaCorrectInput(rgba.rgb);\n\treturn rgba;\n}\nvec3 gammaCorrectOutput(vec3 color) {\n\t#ifdef HDR\n\treturn color;\n\t#else\n\tcolor += vec3(0.0000001);\n\treturn pow(color, vec3(0.45));\n\t#endif\n}\n",genParaboloidPS:"varying vec2 vUv0;\nuniform samplerCube source;\nuniform vec4 params;\nvoid main(void) {\n\tvec2 uv = vUv0;\n\tfloat side = uv.x < 0.5? 1.0 : -1.0;\n\tvec2 tc;\n\ttc.x = fract(uv.x * 2.0) * 2.0 - 1.0;\n\ttc.y = uv.y * 2.0 - 1.0;\n\tconst float scale = 1.1;\n\ttc *= scale;\n\tvec3 dir;\n\tdir.y = (dot(tc, tc) - 1.0) * side;\n\tdir.xz = tc * -2.0;\n\tdir.x *= -side * params.y;\n\tdir = fixSeams(dir, params.x);\n\tvec4 color = textureCube(source, dir, -100.0);\n\tgl_FragColor = color;\n}\n",gles3PS:"#define varying in\nout highp vec4 pc_fragColor;\n#define gl_FragColor pc_fragColor\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad\n#define GL2\n",gles3VS:"#define attribute in\n#define varying out\n#define texture2D texture\n#define GL2\n#define VERTEXSHADER\n",glossPS:"#ifdef MAPFLOAT\nuniform float material_shininess;\n#endif\n#ifdef MAPTEXTURE\nuniform sampler2D texture_glossMap;\n#endif\nvoid getGlossiness() {\n\tdGlossiness = 1.0;\n\t#ifdef MAPFLOAT\n\tdGlossiness *= material_shininess;\n\t#endif\n\t#ifdef MAPTEXTURE\n\tdGlossiness *= texture2D(texture_glossMap, $UV).$CH;\n\t#endif\n\t#ifdef MAPVERTEX\n\tdGlossiness *= saturate(vVertexColor.$VC);\n\t#endif\n\tdGlossiness += 0.0000001;\n}\n",instancingVS:"attribute vec4 instance_line1;\nattribute vec4 instance_line2;\nattribute vec4 instance_line3;\nattribute vec4 instance_line4;\n",lightDiffuseLambertPS:"float getLightDiffuse() {\n\treturn max(dot(dNormalW, -dLightDirNormW), 0.0);\n}\n",lightDirPointPS:"void getLightDirPoint(vec3 lightPosW) {\n\tdLightDirW = vPositionW - lightPosW;\n\tdLightDirNormW = normalize(dLightDirW);\n\tdLightPosW = lightPosW;\n}\n",lightmapDirPS:"uniform sampler2D texture_lightMap;\nuniform sampler2D texture_dirLightMap;\nvoid addLightMap() {\n\tvec3 color = $texture2DSAMPLE(texture_lightMap, $UV).$CH;\n\tvec3 dir = texture2D(texture_dirLightMap, $UV).xyz;\n\tif (dot(dir, vec3(1.0)) < 0.00001) {\n\t\tdDiffuseLight += color;\n\t} else {\n\t\tdLightDirNormW = normalize(dir * 2.0 - vec3(1.0));\n\t\tfloat vlight = saturate(dot(dLightDirNormW, -dVertexNormalW));\n\t\tfloat flight = saturate(dot(dLightDirNormW, -dNormalW));\n\t\tfloat nlight = (flight / max(vlight, 0.01)) * 0.5;\n\t\tdDiffuseLight += color * nlight * 2.0;\n\t}\n\tdSpecularLight += color * getLightSpecular();\n}\n",lightmapSinglePS:"#ifdef MAPTEXTURE\nuniform sampler2D texture_lightMap;\n#endif\nvoid addLightMap() {\n\tvec3 lm = vec3(1.0);\n\t#ifdef MAPTEXTURE\n\tlm *= $texture2DSAMPLE(texture_lightMap, $UV).$CH;\n\t#endif\n\t#ifdef MAPVERTEX\n\tlm *= saturate(vVertexColor.$VC);\n\t#endif\n\tdDiffuseLight += lm;\n}\n",lightmapSingleVertPS:"void addLightMap() {\n\tdDiffuseLight += saturate(vVertexColor.$CH);\n}\n",lightSpecularAnisoGGXPS:"\nfloat calcLightSpecular(float tGlossiness, vec3 tNormalW) {\n\tfloat PI = 3.141592653589793;\n\tfloat roughness = max((1.0 - tGlossiness) * (1.0 - tGlossiness), 0.001);\n\tfloat anisotropy = material_anisotropy * roughness;\n\tfloat at = max((roughness + anisotropy), roughness / 4.0);\n\tfloat ab = max((roughness - anisotropy), roughness / 4.0);\n\tvec3 h = normalize(normalize(-dLightDirNormW) + normalize(dViewDirW));\n\tfloat NoH = dot(tNormalW, h);\n\tfloat ToH = dot(dTBN[0], h);\n\tfloat BoH = dot(dTBN[1], h);\n\tfloat a2 = at * ab;\n\tvec3 v = vec3(ab * ToH, at * BoH, a2 * NoH);\n\tfloat v2 = dot(v, v);\n\tfloat w2 = a2 / v2;\n\tfloat D = a2 * w2 * w2 * (1.0 / PI);\n\tfloat ToV = dot(dTBN[0], dViewDirW);\n\tfloat BoV = dot(dTBN[1], dViewDirW);\n\tfloat ToL = dot(dTBN[0], -dLightDirNormW);\n\tfloat BoL = dot(dTBN[1], -dLightDirNormW);\n\tfloat NoV = dot(tNormalW, dViewDirW);\n\tfloat NoL = dot(tNormalW, -dLightDirNormW);\n\tfloat lambdaV = NoL * length(vec3(at * ToV, ab * BoV, NoV));\n\tfloat lambdaL = NoV * length(vec3(at * ToL, ab * BoL, NoL));\n\tfloat G = 0.5 / (lambdaV + lambdaL);\n\treturn D * G;\n}\nfloat getLightSpecular() {\n\treturn calcLightSpecular(dGlossiness, dNormalW);\n}\nfloat getLightSpecularCC() {\n\treturn calcLightSpecular(ccGlossiness, ccNormalW);\n}\n",lightSpecularBlinnPS:"\nfloat calcLightSpecular(float tGlossiness, vec3 tNormalW) {\n\tvec3 h = normalize( -dLightDirNormW + dViewDirW );\n\tfloat nh = max( dot( h, tNormalW ), 0.0 );\n\tfloat specPow = exp2(tGlossiness * 11.0);\n\tspecPow = antiAliasGlossiness(specPow);\n\tspecPow = max(specPow, 0.0001);\n\treturn pow(nh, specPow) * (specPow + 2.0) / 8.0;\n}\nfloat getLightSpecular() {\n\treturn calcLightSpecular(dGlossiness, dNormalW);\n}\nfloat getLightSpecularCC() {\n\treturn calcLightSpecular(ccGlossiness, ccNormalW);\n}\n",lightSpecularPhongPS:"float calcLightSpecular(float tGlossiness, vec3 tReflDirW) {\n\tfloat specPow = tGlossiness;\n\tspecPow = antiAliasGlossiness(specPow);\n\treturn pow(max(dot(tReflDirW, -dLightDirNormW), 0.0), specPow + 0.0001);\n}\nfloat getLightSpecular() {\n\treturn calcLightSpecular(dGlossiness, dReflDirW);\n}\nfloat getLightSpecularCC() {\n\treturn calcLightSpecular(ccGlossiness, ccReflDirW);\n}\n",ltc:"\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nstruct Coords {\n\tvec3 coord0;\n\tvec3 coord1;\n\tvec3 coord2;\n\tvec3 coord3;\n};\nfloat LTC_EvaluateRect( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in Coords rectCoords) {\n\tvec3 v1 = rectCoords.coord1 - rectCoords.coord0;\n\tvec3 v2 = rectCoords.coord3 - rectCoords.coord0;\n\tvec3 lightNormal = cross( v1, v2 );\n\tfloat factor = sign(-dot( lightNormal, P - rectCoords.coord0 ));\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 =  factor * cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords.coord0 - P );\n\tcoords[ 1 ] = mat * ( rectCoords.coord1 - P );\n\tcoords[ 2 ] = mat * ( rectCoords.coord2 - P );\n\tcoords[ 3 ] = mat * ( rectCoords.coord3 - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn result;\n}\nCoords dLTCCoords;\nCoords getLTCLightCoords(vec3 lightPos, vec3 halfWidth, vec3 halfHeight){\n\tCoords coords;\n\tcoords.coord0 = lightPos + halfWidth - halfHeight;\n\tcoords.coord1 = lightPos - halfWidth - halfHeight;\n\tcoords.coord2 = lightPos - halfWidth + halfHeight;\n\tcoords.coord3 = lightPos + halfWidth + halfHeight;\n\treturn coords;\n}\nfloat dSphereRadius;\nCoords getSphereLightCoords(vec3 lightPos, vec3 halfWidth, vec3 halfHeight){\n\tCoords coords;\n\tfloat radius = max(length(halfWidth), length(halfWidth));\n\tdSphereRadius = radius;\n\tvec3 f = normalize(lightPos-view_position);\n\tvec3 w = normalize(cross(f, halfHeight));\n\tvec3 h = normalize(cross(f, w));\n\tcoords.coord0 = lightPos + w * radius - h * radius;\n\tcoords.coord1 = lightPos - w * radius - h * radius;\n\tcoords.coord2 = lightPos - w * radius + h * radius;\n\tcoords.coord3 = lightPos + w * radius + h * radius;\n\treturn coords;\n}\nvec2 dLTCUV;\n#ifdef CLEARCOAT\nvec2 ccLTCUV;\n#endif\nvec2 getLTCLightUV(float tGlossiness, vec3 tNormalW)\n{\n\tfloat roughness = max((1.0 - tGlossiness) * (1.0 - tGlossiness), 0.001);\n\treturn LTC_Uv( tNormalW, dViewDirW, roughness );\n}\nvec3 dLTCSpecFres;\n#ifdef CLEARCOAT\nvec3 ccLTCSpecFres;\n#endif\nvec3 getLTCLightSpecFres(vec2 uv, vec3 tSpecularity)\n{\n\tvec4 t2 = texture2D( areaLightsLutTex2, uv );\n\t#ifdef AREA_R8_G8_B8_A8_LUTS\n\tt2 *= vec4(0.693103,1,1,1);\n\tt2 += vec4(0.306897,0,0,0);\n\t#endif\n\treturn tSpecularity * t2.x + ( vec3( 1.0 ) - tSpecularity) * t2.y;\n}\nvoid calcLTCLightValues()\n{\n\tdLTCUV = getLTCLightUV(dGlossiness, dNormalW);\n\tdLTCSpecFres = getLTCLightSpecFres(dLTCUV, dSpecularityNoFres);\n#ifdef CLEARCOAT\n\tccLTCUV = getLTCLightUV(ccGlossiness, ccNormalW);\n\tccLTCSpecFres = getLTCLightSpecFres(ccLTCUV, vec3(ccSpecularityNoFres));\n#endif\n}\nvoid calcRectLightValues(vec3 lightPos, vec3 halfWidth, vec3 halfHeight)\n{\n\tdLTCCoords = getLTCLightCoords(lightPos, halfWidth, halfHeight);\n\tcalcLTCLightValues();\n}\nvoid calcDiskLightValues(vec3 lightPos, vec3 halfWidth, vec3 halfHeight)\n{\n\tcalcRectLightValues(lightPos, halfWidth, halfHeight);\n}\nvoid calcSphereLightValues(vec3 lightPos, vec3 halfWidth, vec3 halfHeight)\n{\n\tdLTCCoords = getSphereLightCoords(lightPos, halfWidth, halfHeight);\n\tcalcLTCLightValues();\n}\nvec3 SolveCubic(vec4 Coefficient)\n{\n\tfloat pi = 3.14159;\n\tCoefficient.xyz /= Coefficient.w;\n\tCoefficient.yz /= 3.0;\n\tfloat A = Coefficient.w;\n\tfloat B = Coefficient.z;\n\tfloat C = Coefficient.y;\n\tfloat D = Coefficient.x;\n\tvec3 Delta = vec3(\n\t\t-Coefficient.z * Coefficient.z + Coefficient.y,\n\t\t-Coefficient.y * Coefficient.z + Coefficient.x,\n\t\tdot(vec2(Coefficient.z, -Coefficient.y), Coefficient.xy)\n\t);\n\tfloat Discriminant = dot(vec2(4.0 * Delta.x, -Delta.y), Delta.zy);\n\tvec3 RootsA, RootsD;\n\tvec2 xlc, xsc;\n\t{\n\t\tfloat A_a = 1.0;\n\t\tfloat C_a = Delta.x;\n\t\tfloat D_a = -2.0 * B * Delta.x + Delta.y;\n\t\tfloat Theta = atan(sqrt(Discriminant), -D_a) / 3.0;\n\t\tfloat x_1a = 2.0 * sqrt(-C_a) * cos(Theta);\n\t\tfloat x_3a = 2.0 * sqrt(-C_a) * cos(Theta + (2.0 / 3.0) * pi);\n\t\tfloat xl;\n\t\tif ((x_1a + x_3a) > 2.0 * B)\n\t\t\txl = x_1a;\n\t\telse\n\t\t\txl = x_3a;\n\t\txlc = vec2(xl - B, A);\n\t}\n\t{\n\t\tfloat A_d = D;\n\t\tfloat C_d = Delta.z;\n\t\tfloat D_d = -D * Delta.y + 2.0 * C * Delta.z;\n\t\tfloat Theta = atan(D * sqrt(Discriminant), -D_d) / 3.0;\n\t\tfloat x_1d = 2.0 * sqrt(-C_d) * cos(Theta);\n\t\tfloat x_3d = 2.0 * sqrt(-C_d) * cos(Theta + (2.0 / 3.0) * pi);\n\t\tfloat xs;\n\t\tif (x_1d + x_3d < 2.0 * C)\n\t\t\txs = x_1d;\n\t\telse\n\t\t\txs = x_3d;\n\t\txsc = vec2(-D, xs + C);\n\t}\n\tfloat E =  xlc.y * xsc.y;\n\tfloat F = -xlc.x * xsc.y - xlc.y * xsc.x;\n\tfloat G =  xlc.x * xsc.x;\n\tvec2 xmc = vec2(C * F - B * G, -B * F + C * E);\n\tvec3 Root = vec3(xsc.x / xsc.y, xmc.x / xmc.y, xlc.x / xlc.y);\n\tif (Root.x < Root.y && Root.x < Root.z)\n\t\tRoot.xyz = Root.yxz;\n\telse if (Root.z < Root.x && Root.z < Root.y)\n\t\tRoot.xyz = Root.xzy;\n\treturn Root;\n}\nfloat LTC_EvaluateDisk(vec3 N, vec3 V, vec3 P, mat3 Minv, Coords points)\n{\n\tvec3 T1, T2;\n\tT1 = normalize(V - N * dot(V, N));\n\tT2 = cross(N, T1);\n\tmat3 R = transposeMat3( mat3( T1, T2, N ) );\n\tvec3 L_[ 3 ];\n\tL_[ 0 ] = R * ( points.coord0 - P );\n\tL_[ 1 ] = R * ( points.coord1 - P );\n\tL_[ 2 ] = R * ( points.coord2 - P );\n\tvec3 Lo_i = vec3(0);\n\tvec3 C  = 0.5 * (L_[0] + L_[2]);\n\tvec3 V1 = 0.5 * (L_[1] - L_[2]);\n\tvec3 V2 = 0.5 * (L_[1] - L_[0]);\n\tC  = Minv * C;\n\tV1 = Minv * V1;\n\tV2 = Minv * V2;\n\tfloat a, b;\n\tfloat d11 = dot(V1, V1);\n\tfloat d22 = dot(V2, V2);\n\tfloat d12 = dot(V1, V2);\n\tif (abs(d12) / sqrt(d11 * d22) > 0.0001)\n\t{\n\t\tfloat tr = d11 + d22;\n\t\tfloat det = -d12 * d12 + d11 * d22;\n\t\tdet = sqrt(det);\n\t\tfloat u = 0.5 * sqrt(tr - 2.0 * det);\n\t\tfloat v = 0.5 * sqrt(tr + 2.0 * det);\n\t\tfloat e_max = (u + v) * (u + v);\n\t\tfloat e_min = (u - v) * (u - v);\n\t\tvec3 V1_, V2_;\n\t\tif (d11 > d22)\n\t\t{\n\t\t\tV1_ = d12 * V1 + (e_max - d11) * V2;\n\t\t\tV2_ = d12 * V1 + (e_min - d11) * V2;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tV1_ = d12*V2 + (e_max - d22)*V1;\n\t\t\tV2_ = d12*V2 + (e_min - d22)*V1;\n\t\t}\n\t\ta = 1.0 / e_max;\n\t\tb = 1.0 / e_min;\n\t\tV1 = normalize(V1_);\n\t\tV2 = normalize(V2_);\n\t}\n\telse\n\t{\n\t\ta = 1.0 / dot(V1, V1);\n\t\tb = 1.0 / dot(V2, V2);\n\t\tV1 *= sqrt(a);\n\t\tV2 *= sqrt(b);\n\t}\n\tvec3 V3 = cross(V1, V2);\n\tif (dot(C, V3) < 0.0)\n\t\tV3 *= -1.0;\n\tfloat L  = dot(V3, C);\n\tfloat x0 = dot(V1, C) / L;\n\tfloat y0 = dot(V2, C) / L;\n\tfloat E1 = inversesqrt(a);\n\tfloat E2 = inversesqrt(b);\n\ta *= L * L;\n\tb *= L * L;\n\tfloat c0 = a * b;\n\tfloat c1 = a * b * (1.0 + x0 * x0 + y0 * y0) - a - b;\n\tfloat c2 = 1.0 - a * (1.0 + x0 * x0) - b * (1.0 + y0 * y0);\n\tfloat c3 = 1.0;\n\tvec3 roots = SolveCubic(vec4(c0, c1, c2, c3));\n\tfloat e1 = roots.x;\n\tfloat e2 = roots.y;\n\tfloat e3 = roots.z;\n\tvec3 avgDir = vec3(a * x0 / (a - e2), b * y0 / (b - e2), 1.0);\n\tmat3 rotate = mat3(V1, V2, V3);\n\tavgDir = rotate * avgDir;\n\tavgDir = normalize(avgDir);\n\tfloat L1 = sqrt(-e2 / e3);\n\tfloat L2 = sqrt(-e2 / e1);\n\tfloat formFactor = L1 * L2 * inversesqrt((1.0 + L1 * L1) * (1.0 + L2 * L2));\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tvec2 uv = vec2(avgDir.z * 0.5 + 0.5, formFactor);\n\tuv = uv*LUT_SCALE + LUT_BIAS;\n\tfloat scale = texture2D( areaLightsLutTex2, uv ).w;\n\treturn formFactor*scale;\n}\nfloat getRectLightDiffuse() {\n\treturn LTC_EvaluateRect( dNormalW, dViewDirW, vPositionW, mat3( 1.0 ), dLTCCoords );\n}\nfloat getDiskLightDiffuse() {\n\treturn LTC_EvaluateDisk( dNormalW, dViewDirW, vPositionW, mat3( 1.0 ), dLTCCoords );\n}\nfloat getSphereLightDiffuse() {\n\tfloat falloff = dSphereRadius / (dot(dLightDirW, dLightDirW) + dSphereRadius);\n\treturn getLightDiffuse()*falloff;\n}\nmat3 getLTCLightInvMat(vec2 uv)\n{\n\tvec4 t1 = texture2D( areaLightsLutTex1, uv );\n\t#ifdef AREA_R8_G8_B8_A8_LUTS\n\tt1 *= vec4(1.001, 0.3239, 0.60437568, 1.0);\n\tt1 += vec4(0.0, -0.2976, -0.01381, 0.0);\n\t#endif\n\treturn mat3(\n\t\tvec3( t1.x, 0, t1.y ),\n\t\tvec3(\t0, 1,\t0 ),\n\t\tvec3( t1.z, 0, t1.w )\n\t);\n}\nfloat calcRectLightSpecular(vec3 tNormalW, vec2 uv) {\n\tmat3 mInv = getLTCLightInvMat(uv);\n\treturn LTC_EvaluateRect( tNormalW, dViewDirW, vPositionW, mInv, dLTCCoords );\n}\nfloat getRectLightSpecular() {\n\treturn calcRectLightSpecular(dNormalW, dLTCUV);\n}\n#ifdef CLEARCOAT\nfloat getRectLightSpecularCC() {\n\treturn calcRectLightSpecular(ccNormalW, ccLTCUV);\n}\n#endif\nfloat calcDiskLightSpecular(vec3 tNormalW, vec2 uv) {\n\tmat3 mInv = getLTCLightInvMat(uv);\n\treturn LTC_EvaluateDisk( tNormalW, dViewDirW, vPositionW, mInv, dLTCCoords );\n}\nfloat getDiskLightSpecular() {\n\treturn calcDiskLightSpecular(dNormalW, dLTCUV);\n}\n#ifdef CLEARCOAT\nfloat getDiskLightSpecularCC() {\n\treturn calcDiskLightSpecular(ccNormalW, ccLTCUV);\n}\n#endif\nfloat getSphereLightSpecular() {\n\treturn calcDiskLightSpecular(dNormalW, dLTCUV);\n}\n#ifdef CLEARCOAT\nfloat getSphereLightSpecularCC() {\n\treturn calcDiskLightSpecular(ccNormalW, ccLTCUV);\n}\n#endif\n",metalnessPS:"void processMetalness(float metalness) {\n\tconst float dielectricF0 = 0.04;\n\tdSpecularity = mix(vec3(dielectricF0), dAlbedo, metalness);\n\tdAlbedo *= 1.0 - metalness;\n}\n#ifdef MAPFLOAT\nuniform float material_metalness;\n#endif\n#ifdef MAPTEXTURE\nuniform sampler2D texture_metalnessMap;\n#endif\nvoid getSpecularity() {\n\tfloat metalness = 1.0;\n\t#ifdef MAPFLOAT\n\tmetalness *= material_metalness;\n\t#endif\n\t#ifdef MAPTEXTURE\n\tmetalness *= texture2D(texture_metalnessMap, $UV).$CH;\n\t#endif\n\t#ifdef MAPVERTEX\n\tmetalness *= saturate(vVertexColor.$VC);\n\t#endif\n\tprocessMetalness(metalness);\n}\n",msdfPS:"uniform sampler2D texture_msdfMap;\n#ifdef GL_OES_standard_derivatives\n#define USE_FWIDTH\n#endif\n#ifdef GL2\n#define USE_FWIDTH\n#endif\nfloat median(float r, float g, float b) {\n\treturn max(min(r, g), min(max(r, g), b));\n}\nfloat map (float min, float max, float v) {\n\treturn (v - min) / (max - min);\n}\nuniform float font_sdfIntensity;\nuniform float font_pxrange;\nuniform float font_textureWidth;\nuniform vec4 outline_color;\nuniform float outline_thickness;\nuniform vec4 shadow_color;\nuniform vec2 shadow_offset;\nvec4 applyMsdf(vec4 color) {\n\tvec3 tsample = texture2D(texture_msdfMap, vUv0).rgb;\n\tvec2 uvShdw = vUv0 - shadow_offset;\n\tvec3 ssample = texture2D(texture_msdfMap, uvShdw).rgb;\n\tfloat sigDist = median(tsample.r, tsample.g, tsample.b);\n\tfloat sigDistShdw = median(ssample.r, ssample.g, ssample.b);\n\t#ifdef USE_FWIDTH\n\tvec2 w = fwidth(vUv0);\n\tfloat smoothing = clamp(w.x * font_textureWidth / font_pxrange, 0.0, 0.5);\n\t#else\n\tfloat font_size = 16.0;\n\tfloat smoothing = clamp(font_pxrange / font_size, 0.0, 0.5);\n\t#endif\n\tfloat mapMin = 0.05;\n\tfloat mapMax = clamp(1.0 - font_sdfIntensity, mapMin, 1.0);\n\tfloat sigDistInner = map(mapMin, mapMax, sigDist);\n\tfloat sigDistOutline = map(mapMin, mapMax, sigDist + outline_thickness);\n\tsigDistShdw = map(mapMin, mapMax, sigDistShdw + outline_thickness);\n\tfloat center = 0.5;\n\tfloat inside = smoothstep(center-smoothing, center+smoothing, sigDistInner);\n\tfloat outline = smoothstep(center-smoothing, center+smoothing, sigDistOutline);\n\tfloat shadow = smoothstep(center-smoothing, center+smoothing, sigDistShdw);\n\tvec4 tcolor = (outline > inside) ? outline * vec4(outline_color.a * outline_color.rgb, outline_color.a) : vec4(0.0);\n\ttcolor = mix(tcolor, color, inside);\n\tvec4 scolor = (shadow > outline) ? shadow * vec4(shadow_color.a * shadow_color.rgb, shadow_color.a) : tcolor;\n\ttcolor = mix(scolor, tcolor, outline);\n\treturn tcolor;\n}\n",normalVS:"#ifdef MORPHING_TEXTURE_BASED_NORMAL\nuniform highp sampler2D morphNormalTex;\n#endif\nvec3 getNormal() {\n\t#ifdef SKIN\n\tdNormalMatrix = mat3(dModelMatrix[0].xyz, dModelMatrix[1].xyz, dModelMatrix[2].xyz);\n\t#elif defined(INSTANCING)\n\tdNormalMatrix = mat3(instance_line1.xyz, instance_line2.xyz, instance_line3.xyz);\n\t#else\n\tdNormalMatrix = matrix_normal;\n\t#endif\n\tvec3 tempNormal = vertex_normal;\n\t#ifdef MORPHING\n\t#ifdef MORPHING_NRM03\n\ttempNormal += morph_weights_a[0] * morph_nrm0;\n\ttempNormal += morph_weights_a[1] * morph_nrm1;\n\ttempNormal += morph_weights_a[2] * morph_nrm2;\n\ttempNormal += morph_weights_a[3] * morph_nrm3;\n\t#endif\n\t#ifdef MORPHING_NRM47\n\ttempNormal += morph_weights_b[0] * morph_nrm4;\n\ttempNormal += morph_weights_b[1] * morph_nrm5;\n\ttempNormal += morph_weights_b[2] * morph_nrm6;\n\ttempNormal += morph_weights_b[3] * morph_nrm7;\n\t#endif\n\t#endif\n\t#ifdef MORPHING_TEXTURE_BASED_NORMAL\n\tvec2 morphUV = getTextureMorphCoords();\n\tvec3 morphNormal = texture2D(morphNormalTex, morphUV).xyz;\n\ttempNormal += morphNormal;\n\t#endif\n\treturn normalize(dNormalMatrix * tempNormal);\n}\n",normalDetailMapPS:"#ifdef MAPTEXTURE\nuniform sampler2D texture_normalDetailMap;\nuniform float material_normalDetailMapBumpiness;\nvec3 blendNormals(vec3 n1, vec3 n2) {\n\tn1 += vec3(0, 0, 1);\n\tn2 *= vec3(-1, -1, 1);\n\treturn normalize(n1*dot(n1, n2)/n1.z - n2);\n}\n#endif\nvec3 addNormalDetail(vec3 normalMap) {\n\t#ifdef MAPTEXTURE\n\tvec3 normalDetailMap = unpackNormal(texture2D(texture_normalDetailMap, $UV));\n\tnormalDetailMap = normalize(mix(vec3(0.0, 0.0, 1.0), normalDetailMap, material_normalDetailMapBumpiness));\n\treturn blendNormals(normalMap, normalDetailMap);\n\t#else\n\treturn normalMap;\n\t#endif\n}\n",normalInstancedVS:"vec3 getNormal() {\n\tdNormalMatrix = mat3(instance_line1.xyz, instance_line2.xyz, instance_line3.xyz);\n\treturn normalize(dNormalMatrix * vertex_normal);\n}\n",normalMapPS:"uniform sampler2D texture_normalMap;\nuniform float material_bumpiness;\nvoid getNormal() {\n\tvec3 normalMap = unpackNormal(texture2D(texture_normalMap, $UV));\n\tnormalMap = normalize(mix(vec3(0.0, 0.0, 1.0), normalMap, material_bumpiness));\n\tdNormalMap = addNormalDetail(normalMap);\n\tdNormalW = dTBN * dNormalMap;\n}\n",normalMapFastPS:"uniform sampler2D texture_normalMap;\nvoid getNormal() {\n\tvec3 normalMap = unpackNormal(texture2D(texture_normalMap, $UV));\n\tdNormalMap = addNormalDetail(normalMap);\n\tdNormalW = dTBN * dNormalMap;\n}\n",normalSkinnedVS:"vec3 getNormal() {\n\tdNormalMatrix = mat3(dModelMatrix[0].xyz, dModelMatrix[1].xyz, dModelMatrix[2].xyz);\n\treturn normalize(dNormalMatrix * vertex_normal);\n}\n",normalVertexPS:"void getNormal() {\n\tdNormalW = normalize(dVertexNormalW);\n}\n",normalXYPS:"vec3 unpackNormal(vec4 nmap) {\n\tvec3 normal;\n\tnormal.xy = nmap.wy * 2.0 - 1.0;\n\tnormal.z = sqrt(1.0 - saturate(dot(normal.xy, normal.xy)));\n\treturn normal;\n}\n",normalXYZPS:"vec3 unpackNormal(vec4 nmap) {\n\treturn nmap.xyz * 2.0 - 1.0;\n}\n",opacityPS:"#ifdef MAPFLOAT\nuniform float material_opacity;\n#endif\n#ifdef MAPTEXTURE\nuniform sampler2D texture_opacityMap;\n#endif\nvoid getOpacity() {\n\tdAlpha = 1.0;\n\t#ifdef MAPFLOAT\n\tdAlpha *= material_opacity;\n\t#endif\n\t#ifdef MAPTEXTURE\n\tdAlpha *= texture2D(texture_opacityMap, $UV).$CH;\n\t#endif\n\t#ifdef MAPVERTEX\n\tdAlpha *= clamp(vVertexColor.$VC, 0.0, 1.0);\n\t#endif\n}\n",outputAlphaPS:"gl_FragColor.a = dAlpha;\n",outputAlphaOpaquePS:"gl_FragColor.a = 1.0;\n",outputAlphaPremulPS:"gl_FragColor.rgb *= dAlpha;\ngl_FragColor.a = dAlpha;\n",outputCubemapPS:"varying vec2 vUv0;\nuniform samplerCube source;\nuniform vec4 params;\nfloat saturate(float x) {\n\treturn clamp(x, 0.0, 1.0);\n}\nvec4 encodeRGBM(vec4 color) {\n\tcolor.rgb = pow(color.rgb, vec3(0.5));\n\tcolor.rgb *= 1.0 / 8.0;\n\tcolor.a = saturate( max( max( color.r, color.g ), max( color.b, 1.0 / 255.0 ) ) );\n\tcolor.a = ceil(color.a * 255.0) / 255.0;\n\tcolor.rgb /= color.a;\n\treturn color;\n}\nvoid main(void) {\n\tvec2 st = vUv0 * 2.0 - 1.0;\n\tfloat face = params.x;\n\tvec3 vec;\n\tif (face==0.0) {\n\t\tvec = vec3(1, -st.y, -st.x);\n\t} else if (face==1.0) {\n\t\tvec = vec3(-1, -st.y, st.x);\n\t} else if (face==2.0) {\n\t\tvec = vec3(st.x, 1, st.y);\n\t} else if (face==3.0) {\n\t\tvec = vec3(st.x, -1, -st.y);\n\t} else if (face==4.0) {\n\t\tvec = vec3(st.x, -st.y, 1);\n\t} else {\n\t\tvec = vec3(-st.x, -st.y, -1);\n\t}\n\tgl_FragColor = textureCube(source, vec);\n\tif (params.w >= 2.0) gl_FragColor = encodeRGBM(gl_FragColor);\n}\n",outputTex2DPS:"varying vec2 vUv0;\nuniform sampler2D source;\nvoid main(void) {\n\tgl_FragColor = texture2D(source, vUv0);\n}\n",packDepthPS:"\nvec4 packFloat(float depth) {\n\tconst vec4 bit_shift = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\n\tconst vec4 bit_mask  = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\n\tvec4 res = mod(depth * bit_shift * vec4(255), vec4(256) ) / vec4(255);\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\n",packDepthMaskPS:"vec4 packFloat(float depth) {\n\tconst vec4 bit_shift = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\n\tconst vec4 bit_mask  = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\n\tvec4 res = mod(depth * bit_shift * vec4(255), vec4(256) ) / vec4(255);\n\tres.x = 0.0;\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\n",parallaxPS:"uniform sampler2D texture_heightMap;\nuniform float material_heightMapFactor;\nvoid getParallax() {\n\tfloat parallaxScale = material_heightMapFactor;\n\tfloat height = texture2D(texture_heightMap, $UV).$CH;\n\theight = height * parallaxScale - parallaxScale*0.5;\n\tvec3 viewDirT = dViewDirW * dTBN;\n\tviewDirT.z += 0.42;\n\tdUvOffset = height * (viewDirT.xy / viewDirT.z);\n}\n",particlePS:"varying vec4 texCoordsAlphaLife;\nuniform sampler2D colorMap;\nuniform sampler2D colorParam;\nuniform float graphSampleSize;\nuniform float graphNumSamples;\n#ifndef CAMERAPLANES\n#define CAMERAPLANES\nuniform vec4 camera_params;\n#endif\nuniform float softening;\nuniform float colorMult;\nfloat saturate(float x) {\n\treturn clamp(x, 0.0, 1.0);\n}\n#ifndef UNPACKFLOAT\n#define UNPACKFLOAT\nfloat unpackFloat(vec4 rgbaDepth) {\n\tconst vec4 bitShift = vec4(1.0 / (256.0 * 256.0 * 256.0), 1.0 / (256.0 * 256.0), 1.0 / 256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\n#endif\nvoid main(void) {\n\tvec4 tex  = texture2DSRGB(colorMap, vec2(texCoordsAlphaLife.x, 1.0 - texCoordsAlphaLife.y));\n\tvec4 ramp = texture2DSRGB(colorParam, vec2(texCoordsAlphaLife.w, 0.0));\n\tramp.rgb *= colorMult;\n\tramp.a += texCoordsAlphaLife.z;\n\tvec3 rgb = tex.rgb * ramp.rgb;\n\tfloat a  = tex.a * ramp.a;\n",particleVS:"vec3 unpack3NFloats(float src) {\n\tfloat r = fract(src);\n\tfloat g = fract(src * 256.0);\n\tfloat b = fract(src * 65536.0);\n\treturn vec3(r, g, b);\n}\nfloat saturate(float x) {\n\treturn clamp(x, 0.0, 1.0);\n}\nvec4 tex1Dlod_lerp(highp sampler2D tex, vec2 tc) {\n\treturn mix( texture2D(tex,tc), texture2D(tex,tc + graphSampleSize), fract(tc.x*graphNumSamples) );\n}\nvec4 tex1Dlod_lerp(highp sampler2D tex, vec2 tc, out vec3 w) {\n\tvec4 a = texture2D(tex,tc);\n\tvec4 b = texture2D(tex,tc + graphSampleSize);\n\tfloat c = fract(tc.x*graphNumSamples);\n\tvec3 unpackedA = unpack3NFloats(a.w);\n\tvec3 unpackedB = unpack3NFloats(b.w);\n\tw = mix(unpackedA, unpackedB, c);\n\treturn mix(a, b, c);\n}\nvec2 rotate(vec2 quadXY, float pRotation, out mat2 rotMatrix) {\n\tfloat c = cos(pRotation);\n\tfloat s = sin(pRotation);\n\tmat2 m = mat2(c, -s, s, c);\n\trotMatrix = m;\n\treturn m * quadXY;\n}\nvec3 billboard(vec3 InstanceCoords, vec2 quadXY) {\n\t#ifdef SCREEN_SPACE\n\t\tvec3 pos = vec3(-1, 0, 0) * quadXY.x + vec3(0, -1, 0) * quadXY.y;\n\t#else\n\t\tvec3 pos = -matrix_viewInverse[0].xyz * quadXY.x + -matrix_viewInverse[1].xyz * quadXY.y;\n\t#endif\n\treturn pos;\n}\nvec3 customFace(vec3 InstanceCoords, vec2 quadXY) {\n\tvec3 pos = faceTangent * quadXY.x + faceBinorm * quadXY.y;\n\treturn pos;\n}\nvec2 safeNormalize(vec2 v) {\n\tfloat l = length(v);\n\treturn (l > 1e-06) ? v / l : v;\n}\nvoid main(void) {\n\tvec3 meshLocalPos = particle_vertexData.xyz;\n\tfloat id = floor(particle_vertexData.w);\n\tfloat rndFactor = fract(sin(id + 1.0 + seed));\n\tvec3 rndFactor3 = vec3(rndFactor, fract(rndFactor*10.0), fract(rndFactor*100.0));\n\tfloat uv = id / numParticlesPot;\n\treadInput(uv);\n#ifdef LOCAL_SPACE\n\tinVel = mat3(matrix_model) * inVel;\n#endif\n\tvec2 velocityV = safeNormalize((mat3(matrix_view) * inVel).xy);\n\tfloat particleLifetime = lifetime;\n\tif (inLife <= 0.0 || inLife > particleLifetime || !inShow) meshLocalPos = vec3(0.0);\n\tvec2 quadXY = meshLocalPos.xy;\n\tfloat nlife = clamp(inLife / particleLifetime, 0.0, 1.0);\n\tvec3 paramDiv;\n\tvec4 params = tex1Dlod_lerp(internalTex2, vec2(nlife, 0), paramDiv);\n\tfloat scale = params.y;\n\tfloat scaleDiv = paramDiv.x;\n\tfloat alphaDiv = paramDiv.z;\n\tscale += (scaleDiv * 2.0 - 1.0) * scaleDivMult * fract(rndFactor*10000.0);\n#ifndef USE_MESH\n\ttexCoordsAlphaLife = vec4(quadXY * -0.5 + 0.5, (alphaDiv * 2.0 - 1.0) * alphaDivMult * fract(rndFactor*1000.0), nlife);\n#else\n\ttexCoordsAlphaLife = vec4(particle_uv, (alphaDiv * 2.0 - 1.0) * alphaDivMult * fract(rndFactor*1000.0), nlife);\n#endif\n\tvec3 particlePos = inPos;\n\tvec3 particlePosMoved = vec3(0.0);\n\tmat2 rotMatrix;\n",particleAnimFrameClampVS:"\tfloat animFrame = min(floor(texCoordsAlphaLife.w * animTexParams.y) + animTexParams.x, animTexParams.z);\n",particleAnimFrameLoopVS:"\tfloat animFrame = floor(mod(texCoordsAlphaLife.w * animTexParams.y + animTexParams.x, animTexParams.z + 1.0));\n",particleAnimTexVS:"\tfloat animationIndex;\n\tif (animTexIndexParams.y == 1.0) {\n\t\tanimationIndex = floor((animTexParams.w + 1.0) * rndFactor3.z) * (animTexParams.z + 1.0);\n\t} else {\n\t\tanimationIndex = animTexIndexParams.x * (animTexParams.z + 1.0);\n\t}\n\tfloat atlasX = (animationIndex + animFrame) * animTexTilesParams.x;\n\tfloat atlasY = 1.0 - floor(atlasX + 1.0) * animTexTilesParams.y;\n\tatlasX = fract(atlasX);\n\ttexCoordsAlphaLife.xy *= animTexTilesParams.xy;\n\ttexCoordsAlphaLife.xy += vec2(atlasX, atlasY);\n",particleInputFloatPS:"void readInput(float uv) {\n\tvec4 tex = texture2D(particleTexIN, vec2(uv, 0.25));\n\tvec4 tex2 = texture2D(particleTexIN, vec2(uv, 0.75));\n\tinPos = tex.xyz;\n\tinVel = tex2.xyz;\n\tinAngle = (tex.w < 0.0? -tex.w : tex.w) - 1000.0;\n\tinShow = tex.w >= 0.0;\n\tinLife = tex2.w;\n}\n",particleInputRgba8PS:"\n#define PI2 6.283185307179586\nuniform vec3 inBoundsSize;\nuniform vec3 inBoundsCenter;\nuniform float maxVel;\nfloat decodeFloatRG(vec2 rg) {\n\treturn rg.y*(1.0/255.0) + rg.x;\n}\nfloat decodeFloatRGBA( vec4 rgba ) {\n  return dot( rgba, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/160581375.0) );\n}\nvoid readInput(float uv) {\n\tvec4 tex0 = texture2D(particleTexIN, vec2(uv, 0.125));\n\tvec4 tex1 = texture2D(particleTexIN, vec2(uv, 0.375));\n\tvec4 tex2 = texture2D(particleTexIN, vec2(uv, 0.625));\n\tvec4 tex3 = texture2D(particleTexIN, vec2(uv, 0.875));\n\tinPos = vec3(decodeFloatRG(tex0.rg), decodeFloatRG(tex0.ba), decodeFloatRG(tex1.rg));\n\tinPos = (inPos - vec3(0.5)) * inBoundsSize + inBoundsCenter;\n\tinVel = tex2.xyz;\n\tinVel = (inVel - vec3(0.5)) * maxVel;\n\tinAngle = decodeFloatRG(tex1.ba) * PI2;\n\tinShow = tex2.a > 0.5;\n\tinLife = decodeFloatRGBA(tex3);\n\tfloat maxNegLife = max(lifetime, (numParticles - 1.0) * (rate+rateDiv));\n\tfloat maxPosLife = lifetime+1.0;\n\tinLife = inLife * (maxNegLife + maxPosLife) - maxNegLife;\n}\n",particleOutputFloatPS:"void writeOutput() {\n\tif (gl_FragCoord.y<1.0) {\n\t\tgl_FragColor = vec4(outPos, (outAngle + 1000.0) * visMode);\n\t} else {\n\t\tgl_FragColor = vec4(outVel, outLife);\n\t}\n}\n",particleOutputRgba8PS:"uniform vec3 outBoundsMul;\nuniform vec3 outBoundsAdd;\nvec2 encodeFloatRG( float v ) {\n\tvec2 enc = vec2(1.0, 255.0) * v;\n\tenc = fract(enc);\n\tenc -= enc.yy * vec2(1.0/255.0, 1.0/255.0);\n\treturn enc;\n}\nvec4 encodeFloatRGBA( float v ) {\n\tvec4 enc = vec4(1.0, 255.0, 65025.0, 160581375.0) * v;\n\tenc = fract(enc);\n\tenc -= enc.yzww * vec4(1.0/255.0,1.0/255.0,1.0/255.0,0.0);\n\treturn enc;\n}\nvoid writeOutput() {\n\toutPos = outPos * outBoundsMul + outBoundsAdd;\n\toutAngle = fract(outAngle / PI2);\n\toutVel = (outVel / maxVel) + vec3(0.5);\n\tfloat maxNegLife = max(lifetime, (numParticles - 1.0) * (rate+rateDiv));\n\tfloat maxPosLife = lifetime+1.0;\n\toutLife = (outLife + maxNegLife) / (maxNegLife + maxPosLife);\n\tif (gl_FragCoord.y < 1.0) {\n\t\tgl_FragColor = vec4(encodeFloatRG(outPos.x), encodeFloatRG(outPos.y));\n\t} else if (gl_FragCoord.y < 2.0) {\n\t\tgl_FragColor = vec4(encodeFloatRG(outPos.z), encodeFloatRG(outAngle));\n\t} else if (gl_FragCoord.y < 3.0) {\n\t\tgl_FragColor = vec4(outVel, visMode*0.5+0.5);\n\t} else {\n\t\tgl_FragColor = encodeFloatRGBA(outLife);\n\t}\n}\n",particleUpdaterAABBPS:"uniform mat3 spawnBounds;\nuniform vec3 spawnPosInnerRatio;\nvec3 calcSpawnPosition(vec3 inBounds, float rndFactor) {\n\tvec3 pos = inBounds - vec3(0.5);\n\tvec3 posAbs = abs(pos);\n\tvec3 maxPos = vec3(max(posAbs.x, max(posAbs.y, posAbs.z)));\n\tvec3 edge = maxPos + (vec3(0.5) - maxPos) * spawnPosInnerRatio;\n\tpos.x = edge.x * (maxPos.x == posAbs.x ? sign(pos.x) : 2.0 * pos.x);\n\tpos.y = edge.y * (maxPos.y == posAbs.y ? sign(pos.y) : 2.0 * pos.y);\n\tpos.z = edge.z * (maxPos.z == posAbs.z ? sign(pos.z) : 2.0 * pos.z);\n#ifndef LOCAL_SPACE\n\treturn emitterPos + spawnBounds * pos;\n#else\n\treturn spawnBounds * pos;\n#endif\n}\nvoid addInitialVelocity(inout vec3 localVelocity, vec3 inBounds) {\n\tlocalVelocity -= vec3(0, 0, initialVelocity);\n}\n",particleUpdaterEndPS:"\twriteOutput();\n}\n",particleUpdaterInitPS:"varying vec2 vUv0;\nuniform highp sampler2D particleTexIN;\nuniform highp sampler2D internalTex0;\nuniform highp sampler2D internalTex1;\nuniform highp sampler2D internalTex2;\nuniform highp sampler2D internalTex3;\nuniform mat3 emitterMatrix, emitterMatrixInv;\nuniform vec3 emitterScale;\nuniform vec3 emitterPos, frameRandom, localVelocityDivMult, velocityDivMult;\nuniform float delta, rate, rateDiv, lifetime, numParticles, rotSpeedDivMult, radialSpeedDivMult, seed;\nuniform float startAngle, startAngle2;\nuniform float initialVelocity;\nuniform float graphSampleSize;\nuniform float graphNumSamples;\nvec3 inPos;\nvec3 inVel;\nfloat inAngle;\nbool inShow;\nfloat inLife;\nfloat visMode;\nvec3 outPos;\nvec3 outVel;\nfloat outAngle;\nbool outShow;\nfloat outLife;\n",particleUpdaterNoRespawnPS:"\tif (outLife >= lifetime) {\n\t\toutLife -= max(lifetime, (numParticles - 1.0) * particleRate);\n\t\tvisMode = -1.0;\n\t}\n",particleUpdaterOnStopPS:"\tvisMode = outLife < 0.0? -1.0: visMode;\n",particleUpdaterRespawnPS:"\tif (outLife >= lifetime) {\n\t\toutLife -= max(lifetime, (numParticles - 1.0) * particleRate);\n\t\tvisMode = 1.0;\n\t}\n\tvisMode = outLife < 0.0? 1.0: visMode;\n",particleUpdaterSpherePS:"uniform float spawnBoundsSphere;\nuniform float spawnBoundsSphereInnerRatio;\nvec3 calcSpawnPosition(vec3 inBounds, float rndFactor) {\n\tfloat rnd4 = fract(rndFactor * 1000.0);\n\tvec3 norm = normalize(inBounds.xyz - vec3(0.5));\n\tfloat r = rnd4 * (1.0 - spawnBoundsSphereInnerRatio) + spawnBoundsSphereInnerRatio;\n#ifndef LOCAL_SPACE\n\treturn emitterPos + norm * r * spawnBoundsSphere;\n#else\n\treturn norm * r * spawnBoundsSphere;\n#endif\n}\nvoid addInitialVelocity(inout vec3 localVelocity, vec3 inBounds) {\n\tlocalVelocity += normalize(inBounds - vec3(0.5)) * initialVelocity;\n}\n",particleUpdaterStartPS:"float saturate(float x) {\n\treturn clamp(x, 0.0, 1.0);\n}\nvec3 unpack3NFloats(float src) {\n\tfloat r = fract(src);\n\tfloat g = fract(src * 256.0);\n\tfloat b = fract(src * 65536.0);\n\treturn vec3(r, g, b);\n}\nvec3 tex1Dlod_lerp(highp sampler2D tex, vec2 tc, out vec3 w) {\n\tvec4 a = texture2D(tex, tc);\n\tvec4 b = texture2D(tex, tc + graphSampleSize);\n\tfloat c = fract(tc.x * graphNumSamples);\n\tvec3 unpackedA = unpack3NFloats(a.w);\n\tvec3 unpackedB = unpack3NFloats(b.w);\n\tw = mix(unpackedA, unpackedB, c);\n\treturn mix(a.xyz, b.xyz, c);\n}\n#define HASHSCALE4 vec4(1031, .1030, .0973, .1099)\nvec4 hash41(float p) {\n\tvec4 p4 = fract(vec4(p) * HASHSCALE4);\n\tp4 += dot(p4, p4.wzxy+19.19);\n\treturn fract(vec4((p4.x + p4.y)*p4.z, (p4.x + p4.z)*p4.y, (p4.y + p4.z)*p4.w, (p4.z + p4.w)*p4.x));\n}\nvoid main(void) {\n\tif (gl_FragCoord.x > numParticles) discard;\n\treadInput(vUv0.x);\n\tvisMode = inShow? 1.0 : -1.0;\n\tvec4 rndFactor = hash41(gl_FragCoord.x + seed);\n\tfloat particleRate = rate + rateDiv * rndFactor.x;\n\toutLife = inLife + delta;\n\tfloat nlife = clamp(outLife / lifetime, 0.0, 1.0);\n\tvec3 localVelocityDiv;\n\tvec3 velocityDiv;\n\tvec3 paramDiv;\n\tvec3 localVelocity = tex1Dlod_lerp(internalTex0, vec2(nlife, 0), localVelocityDiv);\n\tvec3 velocity =\t  tex1Dlod_lerp(internalTex1, vec2(nlife, 0), velocityDiv);\n\tvec3 params =\t\ttex1Dlod_lerp(internalTex2, vec2(nlife, 0), paramDiv);\n\tfloat rotSpeed = params.x;\n\tfloat rotSpeedDiv = paramDiv.y;\n\tvec3 radialParams = tex1Dlod_lerp(internalTex3, vec2(nlife, 0), paramDiv);\n\tfloat radialSpeed = radialParams.x;\n\tfloat radialSpeedDiv = radialParams.y;\n\tbool respawn = inLife <= 0.0 || outLife >= lifetime;\n\tinPos = respawn ? calcSpawnPosition(rndFactor.xyz, rndFactor.x) : inPos;\n\tinAngle = respawn ? mix(startAngle, startAngle2, rndFactor.x) : inAngle;\n#ifndef LOCAL_SPACE\n\tvec3 radialVel = inPos - emitterPos;\n#else\n\tvec3 radialVel = inPos;\n#endif\n\tradialVel = (dot(radialVel, radialVel) > 1.0E-8) ? radialSpeed * normalize(radialVel) : vec3(0.0);\n\tradialVel += (radialSpeedDiv * vec3(2.0) - vec3(1.0)) * radialSpeedDivMult * rndFactor.xyz;\n\tlocalVelocity +=\t(localVelocityDiv * vec3(2.0) - vec3(1.0)) * localVelocityDivMult * rndFactor.xyz;\n\tvelocity +=\t\t (velocityDiv * vec3(2.0) - vec3(1.0)) * velocityDivMult * rndFactor.xyz;\n\trotSpeed +=\t\t (rotSpeedDiv * 2.0 - 1.0) * rotSpeedDivMult * rndFactor.y;\n\taddInitialVelocity(localVelocity, rndFactor.xyz);\n#ifndef LOCAL_SPACE\n\toutVel = emitterMatrix * localVelocity + (radialVel + velocity) * emitterScale;\n#else\n\toutVel = (localVelocity + radialVel) / emitterScale + emitterMatrixInv * velocity;\n#endif\n\toutPos = inPos + outVel * delta;\n\toutAngle = inAngle + rotSpeed * delta;\n",particle_billboardVS:"\tquadXY = rotate(quadXY, inAngle, rotMatrix);\n\tvec3 localPos = billboard(particlePos, quadXY);\n",particle_blendAddPS:"\tdBlendModeFogFactor = 0.0;\n\trgb *= saturate(gammaCorrectInput(max(a, 0.0)));\n\tif ((rgb.r + rgb.g + rgb.b) < 0.000001) discard;\n",particle_blendMultiplyPS:"\trgb = mix(vec3(1.0), rgb, vec3(a));\n\tif (rgb.r + rgb.g + rgb.b > 2.99) discard;\n",particle_blendNormalPS:"\tif (a < 0.01) discard;\n",particle_cpuVS:"attribute vec4 particle_vertexData;\nattribute vec4 particle_vertexData2;\nattribute vec4 particle_vertexData3;\nattribute float particle_vertexData4;\n#ifndef USE_MESH\n#define VDATA5TYPE vec2\n#else\n#define VDATA5TYPE vec4\n#endif\nattribute VDATA5TYPE particle_vertexData5;\nuniform mat4 matrix_viewProjection;\nuniform mat4 matrix_model;\n#ifndef VIEWMATRIX\n#define VIEWMATRIX\nuniform mat4 matrix_view;\n#endif\nuniform mat3 matrix_normal;\nuniform mat4 matrix_viewInverse;\nuniform float numParticles;\nuniform float lifetime;\nuniform float stretch;\nuniform float seed;\nuniform vec3 wrapBounds, emitterScale, faceTangent, faceBinorm;\nuniform sampler2D texLifeAndSourcePosOUT;\nuniform highp sampler2D internalTex0;\nuniform highp sampler2D internalTex1;\nuniform highp sampler2D internalTex2;\nuniform vec3 emitterPos;\nvarying vec4 texCoordsAlphaLife;\nvec2 rotate(vec2 quadXY, float pRotation, out mat2 rotMatrix)\n{\n\tfloat c = cos(pRotation);\n\tfloat s = sin(pRotation);\n\tmat2 m = mat2(c, -s, s, c);\n\trotMatrix = m;\n\treturn m * quadXY;\n}\nvec3 billboard(vec3 InstanceCoords, vec2 quadXY)\n{\n\tvec3 pos = -matrix_viewInverse[0].xyz * quadXY.x + -matrix_viewInverse[1].xyz * quadXY.y;\n\treturn pos;\n}\nvec3 customFace(vec3 InstanceCoords, vec2 quadXY)\n{\n\tvec3 pos = faceTangent * quadXY.x + faceBinorm * quadXY.y;\n\treturn pos;\n}\nvoid main(void)\n{\n\tvec3 particlePos = particle_vertexData.xyz;\n\tvec3 inPos = particlePos;\n\tvec3 vertPos = particle_vertexData3.xyz;\n\tvec3 inVel = vec3(particle_vertexData2.w, particle_vertexData3.w, particle_vertexData5.x);\n\tfloat id = floor(particle_vertexData4);\n\tfloat rndFactor = fract(sin(id + 1.0 + seed));\n\tvec3 rndFactor3 = vec3(rndFactor, fract(rndFactor*10.0), fract(rndFactor*100.0));\n#ifdef LOCAL_SPACE\n\tinVel = mat3(matrix_model) * inVel;\n#endif\n\tvec2 velocityV = normalize((mat3(matrix_view) * inVel).xy);\n\tvec2 quadXY = vertPos.xy;\n#ifdef USE_MESH\n\ttexCoordsAlphaLife = vec4(particle_vertexData5.zw, particle_vertexData2.z, particle_vertexData.w);\n#else\n\ttexCoordsAlphaLife = vec4(quadXY * -0.5 + 0.5, particle_vertexData2.z, particle_vertexData.w);\n#endif\n\tmat2 rotMatrix;\n\tfloat inAngle = particle_vertexData2.x;\n\tvec3 particlePosMoved = vec3(0.0);\n\tvec3 meshLocalPos = particle_vertexData3.xyz;\n",particle_cpu_endVS:"\tlocalPos *= particle_vertexData2.y * emitterScale;\n\tlocalPos += particlePos;\n\tgl_Position = matrix_viewProjection * vec4(localPos, 1.0);\n",particle_customFaceVS:"\tquadXY = rotate(quadXY, inAngle, rotMatrix);\n\tvec3 localPos = customFace(particlePos, quadXY);\n",particle_endPS:"\trgb = addFog(rgb);\n\trgb = toneMap(rgb);\n\trgb = gammaCorrectOutput(rgb);\n\tgl_FragColor = vec4(rgb, a);\n}\n",particle_endVS:"\tlocalPos *= scale * emitterScale;\n\tlocalPos += particlePos;\n\t#ifdef SCREEN_SPACE\n\tgl_Position = vec4(localPos.x, localPos.y, 0.0, 1.0);\n\t#else\n\tgl_Position = matrix_viewProjection * vec4(localPos.xyz, 1.0);\n\t#endif\n",particle_halflambertPS:"\tvec3 negNormal = normal*0.5+0.5;\n\tvec3 posNormal = -normal*0.5+0.5;\n\tnegNormal *= negNormal;\n\tposNormal *= posNormal;\n",particle_initVS:"attribute vec4 particle_vertexData;\n#ifdef USE_MESH\nattribute vec2 particle_uv;\n#endif\nuniform mat4 matrix_viewProjection;\nuniform mat4 matrix_model;\nuniform mat3 matrix_normal;\nuniform mat4 matrix_viewInverse;\n#ifndef VIEWMATRIX\n#define VIEWMATRIX\nuniform mat4 matrix_view;\n#endif\nuniform float numParticles, numParticlesPot;\nuniform float graphSampleSize;\nuniform float graphNumSamples;\nuniform float stretch;\nuniform vec3 wrapBounds;\nuniform vec3 emitterScale, emitterPos, faceTangent, faceBinorm;\nuniform float rate, rateDiv, lifetime, deltaRandomnessStatic, scaleDivMult, alphaDivMult, seed, delta;\nuniform sampler2D particleTexOUT, particleTexIN;\nuniform highp sampler2D internalTex0;\nuniform highp sampler2D internalTex1;\nuniform highp sampler2D internalTex2;\n#ifndef CAMERAPLANES\n#define CAMERAPLANES\nuniform vec4 camera_params;\n#endif\nvarying vec4 texCoordsAlphaLife;\nvec3 inPos;\nvec3 inVel;\nfloat inAngle;\nbool inShow;\nfloat inLife;\n",particle_lambertPS:"\tvec3 negNormal = max(normal, vec3(0.0));\n\tvec3 posNormal = max(-normal, vec3(0.0));\n",particle_lightingPS:"\tvec3 light = negNormal.x*lightCube[0] + posNormal.x*lightCube[1] +\n\t\t\t\t\t\tnegNormal.y*lightCube[2] + posNormal.y*lightCube[3] +\n\t\t\t\t\t\tnegNormal.z*lightCube[4] + posNormal.z*lightCube[5];\n\trgb *= light;\n",particle_localShiftVS:"\tparticlePos = (matrix_model * vec4(particlePos, 1.0)).xyz;\n",particle_meshVS:"\tvec3 localPos = meshLocalPos;\n\tlocalPos.xy = rotate(localPos.xy, inAngle, rotMatrix);\n\tlocalPos.yz = rotate(localPos.yz, inAngle, rotMatrix);\n\tbillboard(particlePos, quadXY);\n",particle_normalVS:"\tNormal = normalize(localPos + matrix_viewInverse[2].xyz);\n",particle_normalMapPS:"\tvec3 normalMap = normalize(texture2D(normalMap, vec2(texCoordsAlphaLife.x, 1.0 - texCoordsAlphaLife.y)).xyz * 2.0 - 1.0);\n\tvec3 normal = ParticleMat * normalMap;\n",particle_pointAlongVS:"\tinAngle = atan(velocityV.x, velocityV.y);\n",particle_softPS:"\tfloat depth = getLinearScreenDepth();\n\tfloat particleDepth = vDepth;\n\tfloat depthDiff = saturate(abs(particleDepth - depth) * softening);\n\ta *= depthDiff;\n",particle_softVS:"\tvDepth = getLinearDepth(localPos);\n",particle_stretchVS:"\tvec3 moveDir = inVel * stretch;\n\tvec3 posPrev = particlePos - moveDir;\n\tposPrev += particlePosMoved;\n\tvec2 centerToVertexV = normalize((mat3(matrix_view) * localPos).xy);\n\tfloat interpolation = dot(-velocityV, centerToVertexV) * 0.5 + 0.5;\n\tparticlePos = mix(particlePos, posPrev, interpolation);\n",particle_TBNVS:"\tmat3 rot3 = mat3(rotMatrix[0][0], rotMatrix[0][1], 0.0, rotMatrix[1][0], rotMatrix[1][1], 0.0, 0.0, 0.0, 1.0);\n\tParticleMat = mat3(-matrix_viewInverse[0].xyz, -matrix_viewInverse[1].xyz, matrix_viewInverse[2].xyz) * rot3;\n",particle_wrapVS:"\tvec3 origParticlePos = particlePos;\n\tparticlePos -= matrix_model[3].xyz;\n\tparticlePos = mod(particlePos, wrapBounds) - wrapBounds * 0.5;\n\tparticlePos += matrix_model[3].xyz;\n\tparticlePosMoved = particlePos - origParticlePos;\n",precisionTestPS:"void main(void) {\n\tgl_FragColor = vec4(2147483648.0);\n}\n",precisionTest2PS:"uniform sampler2D source;\nvec4 packFloat(float depth) {\n\tconst vec4 bit_shift = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\n\tconst vec4 bit_mask  = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\n\tvec4 res = mod(depth * bit_shift * vec4(255), vec4(256) ) / vec4(255);\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nvoid main(void) {\n\tfloat c = texture2D(source, vec2(0.0)).r;\n\tfloat diff = abs(c - 2147483648.0) / 2147483648.0;\n\tgl_FragColor = packFloat(diff);\n}\n",prefilterCubemapPS:"varying vec2 vUv0;\nuniform samplerCube source;\nuniform vec4 params;\nfloat saturate(float x) {\n\treturn clamp(x, 0.0, 1.0);\n}\nfloat rnd(vec2 uv) {\n\treturn fract(sin(dot(uv, vec2(12.9898, 78.233) * 2.0)) * 43758.5453);\n}\nconst float PI = 3.14159265358979;\nvec3 hemisphereSample_cos(vec2 uv, mat3 vecSpace, vec3 cubeDir, float gloss) {\n\tfloat phi = uv.y * 2.0 * PI;\n\tfloat cosTheta = sqrt(1.0 - uv.x);\n\tfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\tvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n\treturn normalize(mix(vecSpace * sampleDir, cubeDir, params.y));\n}\nvec3 hemisphereSample_phong(vec2 uv, mat3 vecSpace, vec3 cubeDir, float specPow) {\n\tfloat phi = uv.y * 2.0 * PI;\n\tfloat cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\n\tfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\tvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n\treturn vecSpace * sampleDir;\n}\nmat3 matrixFromVector(vec3 n) {\n\tfloat a = 1.0 / (1.0 + n.z);\n\tfloat b = -n.x * n.y * a;\n\tvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n\tvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n\treturn mat3(b1, b2, n);\n}\nvec4 encodeRGBM(vec3 color) {\n\tvec4 encoded;\n\tencoded.rgb = pow(color.rgb, vec3(0.5));\n\tencoded.rgb *= 1.0 / 8.0;\n\tencoded.a = saturate( max( max( encoded.r, encoded.g ), max( encoded.b, 1.0 / 255.0 ) ) );\n\tencoded.a = ceil(encoded.a * 255.0) / 255.0;\n\tencoded.rgb /= encoded.a;\n\treturn encoded;\n}\nvoid main(void) {\n\tvec2 st = vUv0 * 2.0 - 1.0;\n\tif (params.w==1.0 || params.w==3.0) {\n\t\tst = 2.0 * floor(gl_FragCoord.xy) / (params.z - 1.0) - 1.0;\n\t}\n\tfloat face = params.x;\n\tvec3 vec;\n\tif (face==0.0) {\n\t\tvec = vec3(1, -st.y, -st.x);\n\t} else if (face==1.0) {\n\t\tvec = vec3(-1, -st.y, st.x);\n\t} else if (face==2.0) {\n\t\tvec = vec3(st.x, 1, st.y);\n\t} else if (face==3.0) {\n\t\tvec = vec3(st.x, -1, -st.y);\n\t} else if (face==4.0) {\n\t\tvec = vec3(st.x, -st.y, 1);\n\t} else {\n\t\tvec = vec3(-st.x, -st.y, -1);\n\t}\n\tmat3 vecSpace = matrixFromVector(normalize(vec));\n\tvec3 color = vec3(0.0);\n\tconst int samples = $NUMSAMPLES;\n\tvec3 vect;\n\tfor(int i=0; i<samples; i++) {\n\t\tfloat sini = sin(float(i));\n\t\tfloat cosi = cos(float(i));\n\t\tfloat rand = rnd(vec2(sini, cosi));\n\t\tvect = hemisphereSample_$METHOD(vec2(float(i) / float(samples), rand), vecSpace, vec, params.y);\n\t\tcolor += $textureCube(source, vect).rgb;\n\t}\n\tcolor /= float(samples);\n\tgl_FragColor = params.w < 2.0? vec4(color, 1.0) : encodeRGBM(color);\n}\n",reflDirPS:"void getReflDir() {\n\tdReflDirW = normalize(-reflect(dViewDirW, dNormalW));\n}\n",reflDirAnisoPS:"void getReflDir() {\n\tfloat roughness = sqrt(1.0 - min(dGlossiness, 1.0));\n\tfloat anisotropy = material_anisotropy * roughness;\n\tvec3 anisotropicDirection = anisotropy >= 0.0 ? dTBN[1] : dTBN[0];\n\tvec3 anisotropicTangent = cross(anisotropicDirection, dViewDirW);\n\tvec3 anisotropicNormal = cross(anisotropicTangent, anisotropicDirection);\n\tvec3 bentNormal = normalize(mix(normalize(dNormalW), normalize(anisotropicNormal), anisotropy));\n\tdReflDirW = reflect(-dViewDirW, bentNormal);\n}\n",reflectionCCPS:"#ifdef CLEARCOAT\nuniform float material_clearCoatReflectivity;\nvoid addReflectionCC() {\n\tccReflection += vec4(calcReflection(ccReflDirW, ccGlossiness), material_clearCoatReflectivity);\n}\n#endif\n",reflectionCubePS:"uniform samplerCube texture_cubeMap;\nuniform float material_reflectivity;\nvec3 calcReflection(vec3 tReflDirW, float tGlossiness) {\n\tvec3 lookupVec = fixSeams(cubeMapProject(tReflDirW));\n#ifndef RIGHT_HANDED_CUBEMAP\n\tlookupVec.x *= -1.0;\n#endif\n\treturn $textureCubeSAMPLE(texture_cubeMap, lookupVec).rgb;\n}\nvoid addReflection() {\n\tdReflection += vec4(calcReflection(dReflDirW, dGlossiness), material_reflectivity);\n}\n",reflectionDpAtlasPS:"uniform sampler2D texture_sphereMap;\nuniform float material_reflectivity;\nvec2 getDpAtlasUv(vec2 uv, float mip) {\n\tvec4 rect;\n\tfloat sx = saturate(mip - 2.0);\n\trect.x = sx * 0.5;\n\tfloat t = mip - rect.x * 6.0;\n\tfloat i = 1.0 - rect.x;\n\trect.y = min(t * 0.5, 0.75) * i + rect.x;\n\tfloat st = saturate(t);\n\trect.z = (1.0 - st * 0.5) * i;\n\trect.w = rect.z * 0.5;\n\tfloat rcRectZ = 1.0 / rect.z;\n\tfloat scaleFactor = 0.00390625 * rcRectZ;\n\tvec2 scale = vec2(scaleFactor, scaleFactor * 2.0);\n\tuv = uv * (vec2(1.0) - scale) + scale * 0.5;\n\tuv = uv * rect.zw + rect.xy;\n\treturn uv;\n}\nvec3 calcReflection(vec3 tReflDirW, float tGlossiness) {\n\tvec3 reflDir = normalize(cubeMapProject(tReflDirW));\n\tbool up = reflDir.y > 0.0;\n\tfloat scale = 0.90909090909090909090909090909091;\n\tvec3 reflDirWarp = reflDir.xzx * vec3(-0.25, 0.5, 0.25);\n\tfloat reflDirVer = abs(reflDir.y) + 1.0;\n\treflDirWarp /= reflDirVer;\n\treflDirWarp *= scale;\n\treflDirWarp = vec3(0.75, 0.5, 0.25) - reflDirWarp;\n\tvec2 tc = up? reflDirWarp.xy : reflDirWarp.zy;\n\tfloat bias = saturate(1.0 - tGlossiness) * 5.0;\n\tfloat mip = floor(bias);\n\tvec3 tex1 = $texture2DSAMPLE(texture_sphereMap, getDpAtlasUv(tc, mip)).rgb;\n\tmip = min(mip + 1.0, 5.0);\n\tvec3 tex2 = $texture2DSAMPLE(texture_sphereMap, getDpAtlasUv(tc, mip)).rgb;\n\ttex1 = mix(tex1, tex2, fract(bias));\n\ttex1 = processEnvironment(tex1);\n\treturn tex1;\n}\nvoid addReflection() {\n\tdReflection += vec4(calcReflection(dReflDirW, dGlossiness), material_reflectivity);\n}\n",reflectionPrefilteredCubePS:"uniform samplerCube texture_prefilteredCubeMap128;\nuniform samplerCube texture_prefilteredCubeMap64;\nuniform samplerCube texture_prefilteredCubeMap32;\nuniform samplerCube texture_prefilteredCubeMap16;\nuniform samplerCube texture_prefilteredCubeMap8;\n#ifndef PMREM4\n#define PMREM4\nuniform samplerCube texture_prefilteredCubeMap4;\n#endif\nuniform float material_reflectivity;\nvec3 calcReflection(vec3 tReflDirW, float tGlossiness) {\n\tvec3 refl = cubeMapProject(tReflDirW);\n#ifndef RIGHT_HANDED_CUBEMAP\n\trefl.x *= -1.0;\n#endif\n\tvec3 seam = calcSeam(refl);\n\tvec4 c0 = textureCube(texture_prefilteredCubeMap128, applySeam(refl, seam, 1.0 / 128.0));\n\tvec4 c1 = textureCube(texture_prefilteredCubeMap64, applySeam(refl, seam, 2.0 / 128.0));\n\tvec4 c2 = textureCube(texture_prefilteredCubeMap32, applySeam(refl, seam, 4.0 / 128.0));\n\tvec4 c3 = textureCube(texture_prefilteredCubeMap16, applySeam(refl, seam, 8.0 / 128.0));\n\tvec4 c4 = textureCube(texture_prefilteredCubeMap8, applySeam(refl, seam, 16.0 / 128.0));\n\tvec4 c5 = textureCube(texture_prefilteredCubeMap4, applySeam(refl, seam, 32.0 / 128.0));\n\tfloat bias = saturate(1.0 - tGlossiness) * 5.0;\n\tvec4 cubes0;\n\tvec4 cubes1;\n\tif (bias < 1.0) {\n\t\tcubes0 = c0;\n\t\tcubes1 = c1;\n\t} else if (bias < 2.0) {\n\t\tcubes0 = c1;\n\t\tcubes1 = c2;\n\t} else if (bias < 3.0) {\n\t\tcubes0 = c2;\n\t\tcubes1 = c3;\n\t} else if (bias < 4.0) {\n\t\tcubes0 = c3;\n\t\tcubes1 = c4;\n\t} else {\n\t\tcubes0 = c4;\n\t\tcubes1 = c5;\n\t}\n\tvec4 cubeFinal = mix(cubes0, cubes1, fract(bias));\n\treturn processEnvironment($DECODE(cubeFinal).rgb);\n}\nvoid addReflection() {\n\tdReflection += vec4(calcReflection(dReflDirW, dGlossiness), material_reflectivity);\n}\n",reflectionPrefilteredCubeLodPS:"#ifndef PMREM4\n#define PMREM4\n#ifndef GL2\n#extension GL_EXT_shader_texture_lod : enable\n#endif\nuniform samplerCube texture_prefilteredCubeMap128;\n#endif\nuniform float material_reflectivity;\nvec3 calcReflection(vec3 tReflDirW, float tGlossiness) {\n\tfloat bias = saturate(1.0 - tGlossiness) * 5.0;\n\tvec3 fixedReflDir = fixSeams(cubeMapProject(tReflDirW), bias);\n#ifndef RIGHT_HANDED_CUBEMAP\n\tfixedReflDir.x *= -1.0;\n#endif\n\tvec3 refl = processEnvironment($DECODE( textureCubeLodEXT(texture_prefilteredCubeMap128, fixedReflDir, bias) ).rgb);\n\treturn refl;\n}\nvoid addReflection() {\n\tdReflection += vec4(calcReflection(dReflDirW, dGlossiness), material_reflectivity);\n}\n",reflectionSpherePS:"#ifndef VIEWMATRIX\n#define VIEWMATRIX\nuniform mat4 matrix_view;\n#endif\nuniform sampler2D texture_sphereMap;\nuniform float material_reflectivity;\nvec3 calcReflection(vec3 tReflDirW, float tGlossiness) {\n\tvec3 reflDirV = (mat3(matrix_view) * tReflDirW).xyz;\n\tfloat m = 2.0 * sqrt( dot(reflDirV.xy, reflDirV.xy) + (reflDirV.z+1.0)*(reflDirV.z+1.0) );\n\tvec2 sphereMapUv = reflDirV.xy / m + 0.5;\n\treturn $texture2DSAMPLE(texture_sphereMap, sphereMapUv).rgb;\n}\nvoid addReflection() {\n\tdReflection += vec4(calcReflection(dReflDirW, dGlossiness), material_reflectivity);\n}\n",reflectionSphereLowPS:"uniform sampler2D texture_sphereMap;\nuniform float material_reflectivity;\nvec3 calcReflection(vec3 tReflDirW, float tGlossiness) {\n\tvec3 reflDirV = vNormalV;\n\tvec2 sphereMapUv = reflDirV.xy * 0.5 + 0.5;\n\treturn $texture2DSAMPLE(texture_sphereMap, sphereMapUv).rgb;\n}\nvoid addReflection() {\n\tdReflection += vec4(calcReflection(dReflDirW, dGlossiness), material_reflectivity);\n}\n",refractionPS:"uniform float material_refraction, material_refractionIndex;\nvec3 refract2(vec3 viewVec, vec3 Normal, float IOR) {\n\tfloat vn = dot(viewVec, Normal);\n\tfloat k = 1.0 - IOR * IOR * (1.0 - vn * vn);\n\tvec3 refrVec = IOR * viewVec - (IOR * vn + sqrt(k)) * Normal;\n\treturn refrVec;\n}\nvoid addRefraction() {\n\tvec3 tmp = dReflDirW;\n\tvec4 tmp2 = dReflection;\n\tdReflection = vec4(0.0);\n\tdReflDirW = refract2(-dViewDirW, dNormalW, material_refractionIndex);\n\taddReflection();\n\tdDiffuseLight = mix(dDiffuseLight, dReflection.rgb * dAlbedo, material_refraction);\n\tdReflDirW = tmp;\n\tdReflection = tmp2;\n}\n",reprojectPS:"\nvarying vec2 vUv0;\nuniform sampler2D sourceTex;\nuniform samplerCube sourceCube;\nuniform vec4 params;\nfloat targetFace() { return params.x; }\nfloat specularPower() { return params.y; }\nfloat sourceCubeSeamScale() { return params.z; }\nfloat targetCubeSeamScale() { return params.w; }\nfloat PI = 3.141592653589793;\nfloat saturate(float x) {\n\treturn clamp(x, 0.0, 1.0);\n}\nvec3 decodeLinear(vec4 source) {\n\treturn source.rgb;\n}\nvec4 encodeLinear(vec3 source) {\n\treturn vec4(source, 1.0);\n}\nvec3 decodeGamma(vec4 source) {\n\treturn pow(source.xyz, vec3(2.2));\n}\nvec4 encodeGamma(vec3 source) {\n\treturn vec4(pow(source + 0.0000001, vec3(1.0 / 2.2)), 1.0);\n}\nvec3 decodeRGBM(vec4 rgbm) {\n\tvec3 color = (8.0 * rgbm.a) * rgbm.rgb;\n\treturn color * color;\n}\nvec4 encodeRGBM(vec3 source) {\n\tvec4 result;\n\tresult.rgb = pow(source.rgb, vec3(0.5));\n\tresult.rgb *= 1.0 / 8.0;\n\tresult.a = saturate( max( max( result.r, result.g ), max( result.b, 1.0 / 255.0 ) ) );\n\tresult.a = ceil(result.a * 255.0) / 255.0;\n\tresult.rgb /= result.a;\n\treturn result;\n}\nvec3 decodeRGBE(vec4 source) {\n\tif (source.a == 0.0) {\n\t\treturn vec3(0.0, 0.0, 0.0);\n\t} else {\n\t\treturn source.xyz * pow(2.0, source.w * 255.0 - 128.0);\n\t}\n}\nvec4 encodeRGBE(vec3 source) {\n\tfloat maxVal = max(source.x, max(source.y, source.z));\n\tif (maxVal < 1e-32) {\n\t\treturn vec4(0, 0, 0, 0);\n\t} else {\n\t\tfloat e = ceil(log2(maxVal));\n\t\treturn vec4(source / pow(2.0, e), (e + 128.0) / 255.0);\n\t}\n}\nvec3 modifySeams(vec3 dir, float amount) {\n\tif (amount != 1.0) {\n\t\tvec3 adir = abs(dir);\n\t\tfloat M = max(max(adir.x, adir.y), adir.z);\n\t\tif (adir.x == M) {\n\t\t\tdir.y *= amount;\n\t\t\tdir.z *= amount;\n\t\t}\n\t\telse if (adir.y == M) {\n\t\t\tdir.x *= amount;\n\t\t\tdir.z *= amount;\n\t\t} else {\n\t\t\tdir.x *= amount;\n\t\t\tdir.y *= amount;\n\t\t}\n\t}\n\treturn dir;\n}\nvec2 toSpherical(vec3 dir) {\n\treturn vec2(atan(dir.z, dir.x), asin(dir.y));\n}\nvec3 fromSpherical(vec2 uv) {\n\treturn vec3(cos(uv.y) * cos(uv.x),\n\t\t\t\tsin(uv.y),\n\t\t\t\tcos(uv.y) * sin(uv.x));\n}\nvec4 sampleEquirect(vec2 sph) {\n\tvec2 uv = sph / vec2(PI * 2.0, PI) + 0.5;\n\treturn texture2D(sourceTex, vec2(uv.x, 1.0 - uv.y));\n}\nvec4 sampleEquirect(vec3 dir) {\n\treturn sampleEquirect(toSpherical(dir));\n}\nvec4 sampleCubemap(vec3 dir) {\n\treturn textureCube(sourceCube, modifySeams(dir, sourceCubeSeamScale()));\n}\nvec4 sampleCubemap(vec2 sph) {\n\treturn sampleCubemap(fromSpherical(sph));\n}\nvec3 getDirectionEquirect() {\n\treturn fromSpherical((vec2(vUv0.x, 1.0 - vUv0.y) * 2.0 - 1.0) * vec2(PI, PI * 0.5));\n}\nfloat signNotZero(float k){\n\treturn(k >= 0.0) ? 1.0 : -1.0;\n}\nvec2 signNotZero(vec2 v) {\n\treturn vec2(signNotZero(v.x), signNotZero(v.y));\n}\nvec3 octDecode(vec2 o) {\n\tvec3 v = vec3(o.x, 1.0 - abs(o.x) - abs(o.y), o.y);\n\tif (v.y < 0.0) {\n\t\tv.xz = (1.0 - abs(v.zx)) * signNotZero(v.xz);\n\t}\n\treturn normalize(v);\n}\nvec3 getDirectionOctahedral() {\n\treturn octDecode(vec2(vUv0.x, 1.0 - vUv0.y) * 2.0 - 1.0);\n}\nvec2 octEncode(in vec3 v) {\n\tfloat l1norm = abs(v.x) + abs(v.y) + abs(v.z);\n\tvec2 result = v.xz * (1.0 / l1norm);\n\tif (v.y < 0.0) {\n\t\tresult = (1.0 - abs(result.yx)) * signNotZero(result.xy);\n\t}\n\treturn result;\n}\nvec4 sampleOctahedral(vec3 dir) {\n\tvec2 uv = octEncode(dir) * 0.5 + 0.5;\n\treturn texture2D(sourceTex, vec2(uv.x, 1.0 - uv.y));\n}\nvec4 sampleOctahedral(vec2 sph) {\n\treturn sampleOctahedral(fromSpherical(sph));\n}\nvec3 getDirectionCubemap() {\n\tvec2 st = vUv0 * 2.0 - 1.0;\n\tfloat face = targetFace();\n\tvec3 vec;\n\tif (face == 0.0) {\n\t\tvec = vec3(1, -st.y, -st.x);\n\t} else if (face == 1.0) {\n\t\tvec = vec3(-1, -st.y, st.x);\n\t} else if (face == 2.0) {\n\t\tvec = vec3(st.x, 1, st.y);\n\t} else if (face == 3.0) {\n\t\tvec = vec3(st.x, -1, -st.y);\n\t} else if (face == 4.0) {\n\t\tvec = vec3(st.x, -st.y, 1);\n\t} else {\n\t\tvec = vec3(-st.x, -st.y, -1);\n\t}\n\treturn normalize(modifySeams(vec, 1.0 / targetCubeSeamScale()));\n}\nmat3 matrixFromVector(vec3 n) {\n\tfloat a = 1.0 / (1.0 + n.z);\n\tfloat b = -n.x * n.y * a;\n\tvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n\tvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n\treturn mat3(b1, b2, n);\n}\nmat3 matrixFromVectorSlow(vec3 n) {\n\tvec3 a = normalize(cross(n, vec3(0, 1, 0)));\n\tvec3 b = cross(n, a);\n\treturn mat3(a, b, n);\n}\nfloat rnd(int i) {\n\tfloat sini = sin(float(i));\n\tfloat cosi = cos(float(i));\n\treturn fract(sin(dot(vec2(sini, cosi), vec2(12.9898, 78.233) * 2.0)) * 43758.5453);\n}\nvec3 hemisphereSamplePhong(vec2 uv, float specPow) {\n\tfloat phi = uv.y * 2.0 * PI;\n\tfloat cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\n\tfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\treturn vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n}\nvec4 reproject() {\n\tif (NUM_SAMPLES <= 1) {\n\t\treturn ENCODE_FUNC(DECODE_FUNC(SOURCE_FUNC(TARGET_FUNC())));\n\t} else {\n\t\tvec2 sph = toSpherical(TARGET_FUNC());\n\t\tvec2 sphu = dFdx(sph);\n\t\tvec2 sphv = dFdy(sph);\n\t\tvec3 result = vec3(0.0);\n\t\tfor (float u = 0.0; u < NUM_SAMPLES_SQRT; ++u) {\n\t\t\tfor (float v = 0.0; v < NUM_SAMPLES_SQRT; ++v) {\n\t\t\t\tresult += DECODE_FUNC(SOURCE_FUNC(sph +\n\t\t\t\t\t\t\t\t\t\t\t\t  sphu * (u / NUM_SAMPLES_SQRT - 0.5) +\n\t\t\t\t\t\t\t\t\t\t\t\t  sphv * (v / NUM_SAMPLES_SQRT - 0.5)));\n\t\t\t}\n\t\t}\n\t\treturn ENCODE_FUNC(result / (NUM_SAMPLES_SQRT * NUM_SAMPLES_SQRT));\n\t}\n}\nvec4 prefilter() {\n\tvec3 vec = TARGET_FUNC();\n\tmat3 vecSpace = matrixFromVectorSlow(vec);\n\tvec3 result = vec3(0.0);\n\tfor (int i=0; i<NUM_SAMPLES; ++i) {\n\t\tvec2 uv = vec2(float(i) / float(NUM_SAMPLES), rnd(i));\n\t\tvec3 dir = vecSpace * hemisphereSamplePhong(uv, specularPower());\n\t\tresult += DECODE_FUNC(SOURCE_FUNC(dir));\n\t}\n\treturn ENCODE_FUNC(result / float(NUM_SAMPLES));\n}\nvoid main(void) {\n\tgl_FragColor = PROCESS_FUNC();\n}\n",rgbmPS:"vec3 decodeRGBM(vec4 rgbm) {\n\tvec3 color = (8.0 * rgbm.a) * rgbm.rgb;\n\treturn color * color;\n}\nvec3 texture2DRGBM(sampler2D tex, vec2 uv) {\n\treturn decodeRGBM(texture2D(tex, uv));\n}\nvec3 textureCubeRGBM(samplerCube tex, vec3 uvw) {\n\treturn decodeRGBM(textureCube(tex, uvw));\n}\n",screenDepthPS:"uniform highp sampler2D uDepthMap;\n#ifndef SCREENSIZE\n#define SCREENSIZE\nuniform vec4 uScreenSize;\n#endif\n#ifndef VIEWMATRIX\n#define VIEWMATRIX\nuniform mat4 matrix_view;\n#endif\n#ifndef CAMERAPLANES\n#define CAMERAPLANES\nuniform vec4 camera_params;\n#endif\n#ifdef GL2\nfloat linearizeDepth(float z) {\n\tz = z * 2.0 - 1.0;\n\treturn 1.0 / (camera_params.z * z + camera_params.w);\n}\n#else\n#ifndef UNPACKFLOAT\n#define UNPACKFLOAT\nfloat unpackFloat(vec4 rgbaDepth) {\n\tconst vec4 bitShift = vec4(1.0 / (256.0 * 256.0 * 256.0), 1.0 / (256.0 * 256.0), 1.0 / 256.0, 1.0);\n\treturn dot(rgbaDepth, bitShift);\n}\n#endif\n#endif\nfloat getLinearScreenDepth(vec2 uv) {\n\t#ifdef GL2\n\treturn linearizeDepth(texture2D(uDepthMap, uv).r) * camera_params.y;\n\t#else\n\treturn unpackFloat(texture2D(uDepthMap, uv)) * camera_params.y;\n\t#endif\n}\n#ifndef VERTEXSHADER\nfloat getLinearScreenDepth() {\n\tvec2 uv = gl_FragCoord.xy * uScreenSize.zw;\n\treturn getLinearScreenDepth(uv);\n}\n#endif\nfloat getLinearDepth(vec3 pos) {\n\treturn -(matrix_view * vec4(pos, 1.0)).z;\n}\n",shadowCascadesPS:"const float maxCascades = 4.0;\nmat4 cascadeShadowMat;\nvoid getShadowCascadeMatrix(mat4 shadowMatrixPalette[4], float shadowCascadeDistances[4], float shadowCascadeCount) {\n\tfloat depth = 1.0 / gl_FragCoord.w;\n\tfloat cascadeIndex = 0.0;\n\tfor (float i = 0.0; i < maxCascades; i++) {\n\t\tif (depth < shadowCascadeDistances[int(i)]) {\n\t\t\tcascadeIndex = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tcascadeIndex = min(cascadeIndex, shadowCascadeCount - 1.0);\n\t#ifdef GL2\n\t\tcascadeShadowMat = shadowMatrixPalette[int(cascadeIndex)];\n\t#else\n\t\tif (cascadeIndex == 0.0) {\n\t\t\tcascadeShadowMat = shadowMatrixPalette[0];\n\t\t}\n\t\telse if (cascadeIndex == 1.0) {\n\t\t\tcascadeShadowMat = shadowMatrixPalette[1];\n\t\t}\n\t\telse if (cascadeIndex == 2.0) {\n\t\t\tcascadeShadowMat = shadowMatrixPalette[2];\n\t\t}\n\t\telse {\n\t\t\tcascadeShadowMat = shadowMatrixPalette[3];\n\t\t}\n\t#endif\n}\nvoid fadeShadow(float shadowCascadeDistances[4]) {\n\tfloat depth = 1.0 / gl_FragCoord.w;\n\tif (depth > shadowCascadeDistances[int(maxCascades - 1.0)]) {\n\t\tdShadowCoord.z = -9999999.0;\n\t}\n}\n",shadowCommonPS:"void normalOffsetPointShadow(vec4 shadowParams) {\n\tfloat distScale = length(dLightDirW);\n\tvec3 wPos = vPositionW + dVertexNormalW * shadowParams.y * clamp(1.0 - dot(dVertexNormalW, -dLightDirNormW), 0.0, 1.0) * distScale;\n\tvec3 dir = wPos - dLightPosW;\n\tdLightDirW = dir;\n}\n",shadowCoordPS:"void _getShadowCoordOrtho(mat4 shadowMatrix, vec3 shadowParams, vec3 wPos) {\n\tdShadowCoord = (shadowMatrix * vec4(wPos, 1.0)).xyz;\n\tdShadowCoord.z = saturate(dShadowCoord.z) - 0.0001;\n\t#ifdef SHADOWBIAS\n\tdShadowCoord.z += getShadowBias(shadowParams.x, shadowParams.z);\n\t#endif\n}\nvoid _getShadowCoordPersp(mat4 shadowMatrix, vec4 shadowParams, vec3 wPos) {\n\tvec4 projPos = shadowMatrix * vec4(wPos, 1.0);\n\tprojPos.xy /= projPos.w;\n\tdShadowCoord.xy = projPos.xy;\n\tdShadowCoord.z = length(dLightDirW) * shadowParams.w;\n\t#ifdef SHADOWBIAS\n\tdShadowCoord.z += getShadowBias(shadowParams.x, shadowParams.z);\n\t#endif\n}\nvoid getShadowCoordOrtho(mat4 shadowMatrix, vec3 shadowParams) {\n\t_getShadowCoordOrtho(shadowMatrix, shadowParams, vPositionW);\n}\nvoid getShadowCoordPersp(mat4 shadowMatrix, vec4 shadowParams) {\n\t_getShadowCoordPersp(shadowMatrix, shadowParams, vPositionW);\n}\nvoid getShadowCoordPerspNormalOffset(mat4 shadowMatrix, vec4 shadowParams) {\n\tfloat distScale = abs(dot(vPositionW - dLightPosW, dLightDirNormW));\n\tvec3 wPos = vPositionW + dVertexNormalW * shadowParams.y * clamp(1.0 - dot(dVertexNormalW, -dLightDirNormW), 0.0, 1.0) * distScale;\n\t_getShadowCoordPersp(shadowMatrix, shadowParams, wPos);\n}\nvoid getShadowCoordOrthoNormalOffset(mat4 shadowMatrix, vec3 shadowParams) {\n\tvec3 wPos = vPositionW + dVertexNormalW * shadowParams.y * clamp(1.0 - dot(dVertexNormalW, -dLightDirNormW), 0.0, 1.0);\n\t_getShadowCoordOrtho(shadowMatrix, shadowParams, wPos);\n}\n",shadowCoordPerspZbufferPS:"void _getShadowCoordPerspZbuffer(mat4 shadowMatrix, vec4 shadowParams, vec3 wPos) {\n\tvec4 projPos = shadowMatrix * vec4(wPos, 1.0);\n\tprojPos.xyz /= projPos.w;\n\tdShadowCoord = projPos.xyz;\n}\nvoid getShadowCoordPerspZbufferNormalOffset(mat4 shadowMatrix, vec4 shadowParams) {\n\tfloat distScale = abs(dot(vPositionW - dLightPosW, dLightDirNormW));\n\tvec3 wPos = vPositionW + dVertexNormalW * shadowParams.y * clamp(1.0 - dot(dVertexNormalW, -dLightDirNormW), 0.0, 1.0) * distScale;\n\t_getShadowCoordPerspZbuffer(shadowMatrix, shadowParams, wPos);\n}\nvoid getShadowCoordPerspZbuffer(mat4 shadowMatrix, vec4 shadowParams) {\n\t_getShadowCoordPerspZbuffer(shadowMatrix, shadowParams, vPositionW);\n}\n",shadowEVSMPS:"float VSM$(sampler2D tex, vec2 texCoords, float resolution, float Z, float vsmBias, float exponent) {\n\tvec3 moments = texture2D(tex, texCoords).xyz;\n\treturn calculateEVSM(moments, Z, vsmBias, exponent);\n}\nfloat getShadowVSM$(sampler2D shadowMap, vec3 shadowParams, float exponent) {\n\treturn VSM$(shadowMap, dShadowCoord.xy, shadowParams.x, dShadowCoord.z, shadowParams.y, exponent);\n}\nfloat getShadowSpotVSM$(sampler2D shadowMap, vec4 shadowParams, float exponent) {\n\treturn VSM$(shadowMap, dShadowCoord.xy, shadowParams.x, length(dLightDirW) * shadowParams.w + shadowParams.z, shadowParams.y, exponent);\n}\n",shadowEVSMnPS:"float VSM$(sampler2D tex, vec2 texCoords, float resolution, float Z, float vsmBias, float exponent) {\n\tfloat pixelSize = 1.0 / resolution;\n\ttexCoords -= vec2(pixelSize);\n\tvec3 s00 = texture2D(tex, texCoords).xyz;\n\tvec3 s10 = texture2D(tex, texCoords + vec2(pixelSize, 0)).xyz;\n\tvec3 s01 = texture2D(tex, texCoords + vec2(0, pixelSize)).xyz;\n\tvec3 s11 = texture2D(tex, texCoords + vec2(pixelSize)).xyz;\n\tvec2 fr = fract(texCoords * resolution);\n\tvec3 h0 = mix(s00, s10, fr.x);\n\tvec3 h1 = mix(s01, s11, fr.x);\n\tvec3 moments = mix(h0, h1, fr.y);\n\treturn calculateEVSM(moments, Z, vsmBias, exponent);\n}\nfloat getShadowVSM$(sampler2D shadowMap, vec3 shadowParams, float exponent) {\n\treturn VSM$(shadowMap, dShadowCoord.xy, shadowParams.x, dShadowCoord.z, shadowParams.y, exponent);\n}\nfloat getShadowSpotVSM$(sampler2D shadowMap, vec4 shadowParams, float exponent) {\n\treturn VSM$(shadowMap, dShadowCoord.xy, shadowParams.x, length(dLightDirW) * shadowParams.w + shadowParams.z, shadowParams.y, exponent);\n}\n",shadowStandardPS:"vec3 lessThan2(vec3 a, vec3 b) {\n\treturn clamp((b - a)*1000.0, 0.0, 1.0);\n}\n#ifndef UNPACKFLOAT\n#define UNPACKFLOAT\nfloat unpackFloat(vec4 rgbaDepth) {\n\tconst vec4 bitShift = vec4(1.0 / (256.0 * 256.0 * 256.0), 1.0 / (256.0 * 256.0), 1.0 / 256.0, 1.0);\n\treturn dot(rgbaDepth, bitShift);\n}\n#endif\n#ifdef GL2\nfloat _getShadowPCF3x3(sampler2DShadow shadowMap, vec3 shadowParams) {\n\tfloat z = dShadowCoord.z;\n\tvec2 uv = dShadowCoord.xy * shadowParams.x;\n\tfloat shadowMapSizeInv = 1.0 / shadowParams.x;\n\tvec2 base_uv = floor(uv + 0.5);\n\tfloat s = (uv.x + 0.5 - base_uv.x);\n\tfloat t = (uv.y + 0.5 - base_uv.y);\n\tbase_uv -= vec2(0.5);\n\tbase_uv *= shadowMapSizeInv;\n\tfloat sum = 0.0;\n\tfloat uw0 = (3.0 - 2.0 * s);\n\tfloat uw1 = (1.0 + 2.0 * s);\n\tfloat u0 = (2.0 - s) / uw0 - 1.0;\n\tfloat u1 = s / uw1 + 1.0;\n\tfloat vw0 = (3.0 - 2.0 * t);\n\tfloat vw1 = (1.0 + 2.0 * t);\n\tfloat v0 = (2.0 - t) / vw0 - 1.0;\n\tfloat v1 = t / vw1 + 1.0;\n\tu0 = u0 * shadowMapSizeInv + base_uv.x;\n\tv0 = v0 * shadowMapSizeInv + base_uv.y;\n\tu1 = u1 * shadowMapSizeInv + base_uv.x;\n\tv1 = v1 * shadowMapSizeInv + base_uv.y;\n\tsum += uw0 * vw0 * texture(shadowMap, vec3(u0, v0, z));\n\tsum += uw1 * vw0 * texture(shadowMap, vec3(u1, v0, z));\n\tsum += uw0 * vw1 * texture(shadowMap, vec3(u0, v1, z));\n\tsum += uw1 * vw1 * texture(shadowMap, vec3(u1, v1, z));\n\tsum *= 1.0f / 16.0;\n\treturn sum;\n}\nfloat getShadowPCF3x3(sampler2DShadow shadowMap, vec3 shadowParams) {\n\treturn _getShadowPCF3x3(shadowMap, shadowParams);\n}\nfloat getShadowSpotPCF3x3(sampler2DShadow shadowMap, vec4 shadowParams) {\n\treturn _getShadowPCF3x3(shadowMap, shadowParams.xyz);\n}\n#else\nfloat _xgetShadowPCF3x3(mat3 depthKernel, sampler2D shadowMap, vec3 shadowParams) {\n\tmat3 shadowKernel;\n\tvec3 shadowCoord = dShadowCoord;\n\tvec3 shadowZ = vec3(shadowCoord.z);\n\tshadowKernel[0] = vec3(greaterThan(depthKernel[0], shadowZ));\n\tshadowKernel[1] = vec3(greaterThan(depthKernel[1], shadowZ));\n\tshadowKernel[2] = vec3(greaterThan(depthKernel[2], shadowZ));\n\tvec2 fractionalCoord = fract( shadowCoord.xy * shadowParams.x );\n\tshadowKernel[0] = mix(shadowKernel[0], shadowKernel[1], fractionalCoord.x);\n\tshadowKernel[1] = mix(shadowKernel[1], shadowKernel[2], fractionalCoord.x);\n\tvec4 shadowValues;\n\tshadowValues.x = mix(shadowKernel[0][0], shadowKernel[0][1], fractionalCoord.y);\n\tshadowValues.y = mix(shadowKernel[0][1], shadowKernel[0][2], fractionalCoord.y);\n\tshadowValues.z = mix(shadowKernel[1][0], shadowKernel[1][1], fractionalCoord.y);\n\tshadowValues.w = mix(shadowKernel[1][1], shadowKernel[1][2], fractionalCoord.y);\n\treturn dot( shadowValues, vec4( 1.0 ) ) * 0.25;\n}\nfloat _getShadowPCF3x3(sampler2D shadowMap, vec3 shadowParams) {\n\tvec3 shadowCoord = dShadowCoord;\n\tfloat xoffset = 1.0 / shadowParams.x;\n\tfloat dx0 = -xoffset;\n\tfloat dx1 = xoffset;\n\tmat3 depthKernel;\n\tdepthKernel[0][0] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, dx0)));\n\tdepthKernel[0][1] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, 0.0)));\n\tdepthKernel[0][2] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, dx1)));\n\tdepthKernel[1][0] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(0.0, dx0)));\n\tdepthKernel[1][1] = unpackFloat(texture2D(shadowMap, shadowCoord.xy));\n\tdepthKernel[1][2] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(0.0, dx1)));\n\tdepthKernel[2][0] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, dx0)));\n\tdepthKernel[2][1] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, 0.0)));\n\tdepthKernel[2][2] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, dx1)));\n\treturn _xgetShadowPCF3x3(depthKernel, shadowMap, shadowParams);\n}\nfloat getShadowPCF3x3(sampler2D shadowMap, vec3 shadowParams) {\n\treturn _getShadowPCF3x3(shadowMap, shadowParams);\n}\nfloat getShadowSpotPCF3x3(sampler2D shadowMap, vec4 shadowParams) {\n\treturn _getShadowPCF3x3(shadowMap, shadowParams.xyz);\n}\n#endif\nfloat _getShadowPoint(samplerCube shadowMap, vec4 shadowParams, vec3 dir) {\n\tvec3 tc = normalize(dir);\n\tvec3 tcAbs = abs(tc);\n\tvec4 dirX = vec4(1,0,0, tc.x);\n\tvec4 dirY = vec4(0,1,0, tc.y);\n\tfloat majorAxisLength = tc.z;\n\tif ((tcAbs.x > tcAbs.y) && (tcAbs.x > tcAbs.z)) {\n\t\tdirX = vec4(0,0,1, tc.z);\n\t\tdirY = vec4(0,1,0, tc.y);\n\t\tmajorAxisLength = tc.x;\n\t} else if ((tcAbs.y > tcAbs.x) && (tcAbs.y > tcAbs.z)) {\n\t\tdirX = vec4(1,0,0, tc.x);\n\t\tdirY = vec4(0,0,1, tc.z);\n\t\tmajorAxisLength = tc.y;\n\t}\n\tfloat shadowParamsInFaceSpace = ((1.0/shadowParams.x) * 2.0) * abs(majorAxisLength);\n\tvec3 xoffset = (dirX.xyz * shadowParamsInFaceSpace);\n\tvec3 yoffset = (dirY.xyz * shadowParamsInFaceSpace);\n\tvec3 dx0 = -xoffset;\n\tvec3 dy0 = -yoffset;\n\tvec3 dx1 = xoffset;\n\tvec3 dy1 = yoffset;\n\tmat3 shadowKernel;\n\tmat3 depthKernel;\n\tdepthKernel[0][0] = unpackFloat(textureCube(shadowMap, tc + dx0 + dy0));\n\tdepthKernel[0][1] = unpackFloat(textureCube(shadowMap, tc + dx0));\n\tdepthKernel[0][2] = unpackFloat(textureCube(shadowMap, tc + dx0 + dy1));\n\tdepthKernel[1][0] = unpackFloat(textureCube(shadowMap, tc + dy0));\n\tdepthKernel[1][1] = unpackFloat(textureCube(shadowMap, tc));\n\tdepthKernel[1][2] = unpackFloat(textureCube(shadowMap, tc + dy1));\n\tdepthKernel[2][0] = unpackFloat(textureCube(shadowMap, tc + dx1 + dy0));\n\tdepthKernel[2][1] = unpackFloat(textureCube(shadowMap, tc + dx1));\n\tdepthKernel[2][2] = unpackFloat(textureCube(shadowMap, tc + dx1 + dy1));\n\tvec3 shadowZ = vec3(length(dir) * shadowParams.w + shadowParams.z);\n\tshadowKernel[0] = vec3(lessThan2(depthKernel[0], shadowZ));\n\tshadowKernel[1] = vec3(lessThan2(depthKernel[1], shadowZ));\n\tshadowKernel[2] = vec3(lessThan2(depthKernel[2], shadowZ));\n\tvec2 uv = (vec2(dirX.w, dirY.w) / abs(majorAxisLength)) * 0.5;\n\tvec2 fractionalCoord = fract( uv * shadowParams.x );\n\tshadowKernel[0] = mix(shadowKernel[0], shadowKernel[1], fractionalCoord.x);\n\tshadowKernel[1] = mix(shadowKernel[1], shadowKernel[2], fractionalCoord.x);\n\tvec4 shadowValues;\n\tshadowValues.x = mix(shadowKernel[0][0], shadowKernel[0][1], fractionalCoord.y);\n\tshadowValues.y = mix(shadowKernel[0][1], shadowKernel[0][2], fractionalCoord.y);\n\tshadowValues.z = mix(shadowKernel[1][0], shadowKernel[1][1], fractionalCoord.y);\n\tshadowValues.w = mix(shadowKernel[1][1], shadowKernel[1][2], fractionalCoord.y);\n\treturn 1.0 - dot( shadowValues, vec4( 1.0 ) ) * 0.25;\n}\nfloat getShadowPointPCF3x3(samplerCube shadowMap, vec4 shadowParams) {\n\treturn _getShadowPoint(shadowMap, shadowParams, dLightDirW);\n}\n",shadowStandardGL2PS:"float _getShadowPCF5x5(sampler2DShadow shadowMap, vec3 shadowParams) {\n\tfloat z = dShadowCoord.z;\n\tvec2 uv = dShadowCoord.xy * shadowParams.x;\n\tfloat shadowMapSizeInv = 1.0 / shadowParams.x;\n\tvec2 base_uv = floor(uv + 0.5);\n\tfloat s = (uv.x + 0.5 - base_uv.x);\n\tfloat t = (uv.y + 0.5 - base_uv.y);\n\tbase_uv -= vec2(0.5);\n\tbase_uv *= shadowMapSizeInv;\n\tfloat uw0 = (4.0 - 3.0 * s);\n\tfloat uw1 = 7.0;\n\tfloat uw2 = (1.0 + 3.0 * s);\n\tfloat u0 = (3.0 - 2.0 * s) / uw0 - 2.0;\n\tfloat u1 = (3.0 + s) / uw1;\n\tfloat u2 = s / uw2 + 2.0;\n\tfloat vw0 = (4.0 - 3.0 * t);\n\tfloat vw1 = 7.0;\n\tfloat vw2 = (1.0 + 3.0 * t);\n\tfloat v0 = (3.0 - 2.0 * t) / vw0 - 2.0;\n\tfloat v1 = (3.0 + t) / vw1;\n\tfloat v2 = t / vw2 + 2.0;\n\tfloat sum = 0.0;\n\tu0 = u0 * shadowMapSizeInv + base_uv.x;\n\tv0 = v0 * shadowMapSizeInv + base_uv.y;\n\tu1 = u1 * shadowMapSizeInv + base_uv.x;\n\tv1 = v1 * shadowMapSizeInv + base_uv.y;\n\tu2 = u2 * shadowMapSizeInv + base_uv.x;\n\tv2 = v2 * shadowMapSizeInv + base_uv.y;\n\tsum += uw0 * vw0 * texture(shadowMap, vec3(u0, v0, z));\n\tsum += uw1 * vw0 * texture(shadowMap, vec3(u1, v0, z));\n\tsum += uw2 * vw0 * texture(shadowMap, vec3(u2, v0, z));\n\tsum += uw0 * vw1 * texture(shadowMap, vec3(u0, v1, z));\n\tsum += uw1 * vw1 * texture(shadowMap, vec3(u1, v1, z));\n\tsum += uw2 * vw1 * texture(shadowMap, vec3(u2, v1, z));\n\tsum += uw0 * vw2 * texture(shadowMap, vec3(u0, v2, z));\n\tsum += uw1 * vw2 * texture(shadowMap, vec3(u1, v2, z));\n\tsum += uw2 * vw2 * texture(shadowMap, vec3(u2, v2, z));\n\tsum *= 1.0f / 144.0;\n\tsum = gammaCorrectInput(sum);\n\tsum = saturate(sum);\n\treturn sum;\n}\nfloat getShadowPCF5x5(sampler2DShadow shadowMap, vec3 shadowParams) {\n\treturn _getShadowPCF5x5(shadowMap, shadowParams);\n}\nfloat getShadowSpotPCF5x5(sampler2DShadow shadowMap, vec4 shadowParams) {\n\treturn _getShadowPCF5x5(shadowMap, shadowParams.xyz);\n}\n",shadowVSM8PS:"float calculateVSM8(vec3 moments, float Z, float vsmBias) {\n\tfloat VSMBias = vsmBias;\n\tfloat depthScale = VSMBias * Z;\n\tfloat minVariance1 = depthScale * depthScale;\n\treturn chebyshevUpperBound(moments.xy, Z, minVariance1, 0.1);\n}\nfloat decodeFloatRG(vec2 rg) {\n\treturn rg.y*(1.0/255.0) + rg.x;\n}\nfloat VSM8(sampler2D tex, vec2 texCoords, float resolution, float Z, float vsmBias, float exponent) {\n\tvec4 c = texture2D(tex, texCoords);\n\tvec3 moments = vec3(decodeFloatRG(c.xy), decodeFloatRG(c.zw), 0.0);\n\treturn calculateVSM8(moments, Z, vsmBias);\n}\nfloat getShadowVSM8(sampler2D shadowMap, vec3 shadowParams, float exponent) {\n\treturn VSM8(shadowMap, dShadowCoord.xy, shadowParams.x, dShadowCoord.z, shadowParams.y, 0.0);\n}\nfloat getShadowSpotVSM8(sampler2D shadowMap, vec4 shadowParams, float exponent) {\n\treturn VSM8(shadowMap, dShadowCoord.xy, shadowParams.x, length(dLightDirW) * shadowParams.w + shadowParams.z, shadowParams.y, 0.0);\n}\n",shadowVSM_commonPS:"float linstep(float a, float b, float v) {\n\treturn saturate((v - a) / (b - a));\n}\nfloat reduceLightBleeding(float pMax, float amount) {\n   return linstep(amount, 1.0, pMax);\n}\nfloat chebyshevUpperBound(vec2 moments, float mean, float minVariance, float lightBleedingReduction) {\n\tfloat variance = moments.y - (moments.x * moments.x);\n\tvariance = max(variance, minVariance);\n\tfloat d = mean - moments.x;\n\tfloat pMax = variance / (variance + (d * d));\n\tpMax = reduceLightBleeding(pMax, lightBleedingReduction);\n\treturn (mean <= moments.x ? 1.0 : pMax);\n}\nfloat calculateEVSM(vec3 moments, float Z, float vsmBias, float exponent) {\n\tZ = 2.0 * Z - 1.0;\n\tfloat warpedDepth = exp(exponent * Z);\n\tmoments.xy += vec2(warpedDepth, warpedDepth*warpedDepth) * (1.0 - moments.z);\n\tfloat VSMBias = vsmBias;\n\tfloat depthScale = VSMBias * exponent * warpedDepth;\n\tfloat minVariance1 = depthScale * depthScale;\n\treturn chebyshevUpperBound(moments.xy, warpedDepth, minVariance1, 0.1);\n}\n",skinBatchConstVS:"attribute float vertex_boneIndices;\nuniform vec4 matrix_pose[BONE_LIMIT * 3];\nmat4 getBoneMatrix(const in float i) {\n\tvec4 v1 = matrix_pose[int(3.0 * i)];\n\tvec4 v2 = matrix_pose[int(3.0 * i + 1.0)];\n\tvec4 v3 = matrix_pose[int(3.0 * i + 2.0)];\n\treturn mat4(\n\t\tv1.x, v2.x, v3.x, 0,\n\t\tv1.y, v2.y, v3.y, 0,\n\t\tv1.z, v2.z, v3.z, 0,\n\t\tv1.w, v2.w, v3.w, 1\n\t);\n}\n",skinBatchTexVS:"attribute float vertex_boneIndices;\nuniform highp sampler2D texture_poseMap;\nuniform vec4 texture_poseMapSize;\nmat4 getBoneMatrix(const in float i) {\n\tfloat j = i * 3.0;\n\tfloat dx = texture_poseMapSize.z;\n\tfloat dy = texture_poseMapSize.w;\n\tfloat y = floor(j * dx);\n\tfloat x = j - (y * texture_poseMapSize.x);\n\ty = dy * (y + 0.5);\n\tvec4 v1 = texture2D(texture_poseMap, vec2(dx * (x + 0.5), y));\n\tvec4 v2 = texture2D(texture_poseMap, vec2(dx * (x + 1.5), y));\n\tvec4 v3 = texture2D(texture_poseMap, vec2(dx * (x + 2.5), y));\n\treturn mat4(\n\t\tv1.x, v2.x, v3.x, 0,\n\t\tv1.y, v2.y, v3.y, 0,\n\t\tv1.z, v2.z, v3.z, 0,\n\t\tv1.w, v2.w, v3.w, 1\n\t);\n}\n",skinConstVS:"attribute vec4 vertex_boneWeights;\nattribute vec4 vertex_boneIndices;\nuniform vec4 matrix_pose[BONE_LIMIT * 3];\nvoid getBoneMatrix(const in float i, out vec4 v1, out vec4 v2, out vec4 v3) {\n\tv1 = matrix_pose[int(3.0 * i)];\n\tv2 = matrix_pose[int(3.0 * i + 1.0)];\n\tv3 = matrix_pose[int(3.0 * i + 2.0)];\n}\nmat4 getSkinMatrix(const in vec4 indices, const in vec4 weights) {\n\tvec4 a1, a2, a3;\n\tgetBoneMatrix(indices.x, a1, a2, a3);\n\tvec4 b1, b2, b3;\n\tgetBoneMatrix(indices.y, b1, b2, b3);\n\tvec4 c1, c2, c3;\n\tgetBoneMatrix(indices.z, c1, c2, c3);\n\tvec4 d1, d2, d3;\n\tgetBoneMatrix(indices.w, d1, d2, d3);\n\tvec4 v1 = a1 * weights.x + b1 * weights.y + c1 * weights.z + d1 * weights.w;\n\tvec4 v2 = a2 * weights.x + b2 * weights.y + c2 * weights.z + d2 * weights.w;\n\tvec4 v3 = a3 * weights.x + b3 * weights.y + c3 * weights.z + d3 * weights.w;\n\tfloat one = dot(weights, vec4(1.0));\n\treturn mat4(\n\t\tv1.x, v2.x, v3.x, 0,\n\t\tv1.y, v2.y, v3.y, 0,\n\t\tv1.z, v2.z, v3.z, 0,\n\t\tv1.w, v2.w, v3.w, one\n\t);\n}\n",skinTexVS:"attribute vec4 vertex_boneWeights;\nattribute vec4 vertex_boneIndices;\nuniform highp sampler2D texture_poseMap;\nuniform vec4 texture_poseMapSize;\nvoid getBoneMatrix(const in float i, out vec4 v1, out vec4 v2, out vec4 v3) {\n\tfloat j = i * 3.0;\n\tfloat dx = texture_poseMapSize.z;\n\tfloat dy = texture_poseMapSize.w;\n\tfloat y = floor(j * dx);\n\tfloat x = j - (y * texture_poseMapSize.x);\n\ty = dy * (y + 0.5);\n\tv1 = texture2D(texture_poseMap, vec2(dx * (x + 0.5), y));\n\tv2 = texture2D(texture_poseMap, vec2(dx * (x + 1.5), y));\n\tv3 = texture2D(texture_poseMap, vec2(dx * (x + 2.5), y));\n}\nmat4 getSkinMatrix(const in vec4 indices, const in vec4 weights) {\n\tvec4 a1, a2, a3;\n\tgetBoneMatrix(indices.x, a1, a2, a3);\n\tvec4 b1, b2, b3;\n\tgetBoneMatrix(indices.y, b1, b2, b3);\n\tvec4 c1, c2, c3;\n\tgetBoneMatrix(indices.z, c1, c2, c3);\n\tvec4 d1, d2, d3;\n\tgetBoneMatrix(indices.w, d1, d2, d3);\n\tvec4 v1 = a1 * weights.x + b1 * weights.y + c1 * weights.z + d1 * weights.w;\n\tvec4 v2 = a2 * weights.x + b2 * weights.y + c2 * weights.z + d2 * weights.w;\n\tvec4 v3 = a3 * weights.x + b3 * weights.y + c3 * weights.z + d3 * weights.w;\n\tfloat one = dot(weights, vec4(1.0));\n\treturn mat4(\n\t\tv1.x, v2.x, v3.x, 0,\n\t\tv1.y, v2.y, v3.y, 0,\n\t\tv1.z, v2.z, v3.z, 0,\n\t\tv1.w, v2.w, v3.w, one\n\t);\n}\n",skyboxPS:"varying vec3 vViewDir;\nuniform samplerCube texture_cubeMap;\nvoid main(void) {\n\tgl_FragColor = textureCube(texture_cubeMap, fixSeams(vViewDir));\n}\n",skyboxVS:"attribute vec3 aPosition;\n#ifndef VIEWMATRIX\n#define VIEWMATRIX\nuniform mat4 matrix_view;\n#endif\nuniform mat4 matrix_projectionSkybox;\nvarying vec3 vViewDir;\nvoid main(void) {\n\tmat4 view = matrix_view;\n\tview[3][0] = view[3][1] = view[3][2] = 0.0;\n\tgl_Position = matrix_projectionSkybox * view * vec4(aPosition, 1.0);\n\tgl_Position.z = gl_Position.w - 0.00001;\n\tvViewDir = aPosition;\n}\n",skyboxHDRPS:"varying vec3 vViewDir;\nuniform samplerCube texture_cubeMap;\n#ifdef CUBEMAP_ROTATION\nuniform mat3 cubeMapRotationMatrix;\n#endif\nvoid main(void) {\n#ifdef CUBEMAP_ROTATION\n\tvec3 dir=vViewDir * cubeMapRotationMatrix;\n#else\n\tvec3 dir=vViewDir;\n#endif\n#ifndef RIGHT_HANDED_CUBEMAP\n\tdir.x *= -1.0;\n#endif\n\tvec3 color = processEnvironment($textureCubeSAMPLE(texture_cubeMap, fixSeamsStatic(dir, $FIXCONST)).rgb);\n\tcolor = toneMap(color);\n\tcolor = gammaCorrectOutput(color);\n\tgl_FragColor = vec4(color, 1.0);\n}\n",skyboxPrefilteredCubePS:"varying vec3 vViewDir;\nuniform samplerCube texture_cubeMap;\nvec3 fixSeamsStretch(vec3 vec, float mipmapIndex, float cubemapSize) {\n\tfloat scale = 1.0 - exp2(mipmapIndex) / cubemapSize;\n\tfloat M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n\tif (abs(vec.x) != M) vec.x *= scale;\n\tif (abs(vec.y) != M) vec.y *= scale;\n\tif (abs(vec.z) != M) vec.z *= scale;\n\treturn vec;\n}\nvoid main(void) {\n\tvec3 color = textureCubeRGBM(texture_cubeMap, fixSeamsStretch(vViewDir, 0.0, 128.0));\n\tcolor = toneMap(color);\n\tcolor = gammaCorrectOutput(color);\n\tgl_FragColor = vec4(color, 1.0);\n}\n",specularPS:"#ifdef MAPCOLOR\nuniform vec3 material_specular;\n#endif\n#ifdef MAPTEXTURE\nuniform sampler2D texture_specularMap;\n#endif\nvoid getSpecularity() {\n\tdSpecularity = vec3(1.0);\n\t#ifdef MAPCOLOR\n\tdSpecularity *= material_specular;\n\t#endif\n\t#ifdef MAPTEXTURE\n\tdSpecularity *= texture2D(texture_specularMap, $UV).$CH;\n\t#endif\n\t#ifdef MAPVERTEX\n\tdSpecularity *= saturate(vVertexColor.$VC);\n\t#endif\n}\n",specularAaNonePS:"float antiAliasGlossiness(float power) {\n\treturn power;\n}\n",specularAaToksvigPS:"float antiAliasGlossiness(float power) {\n\tfloat rlen = 1.0 / saturate(length(dNormalMap));\n\tfloat toksvig = 1.0 / (1.0 + power * (rlen - 1.0));\n\treturn power * mix(1.0, toksvig, material_bumpiness);\n}\n",specularAaToksvigFastPS:"float antiAliasGlossiness(float power) {\n\tfloat rlen = 1.0 / saturate(length(dNormalMap));\n\tfloat toksvig = 1.0 / (1.0 + power * (rlen - 1.0));\n\treturn power * toksvig;\n}\n",spotPS:"float getSpotEffect(vec3 lightSpotDirW, float lightInnerConeAngle, float lightOuterConeAngle) {\n\tfloat cosAngle = dot(dLightDirNormW, lightSpotDirW);\n\treturn smoothstep(lightOuterConeAngle, lightInnerConeAngle, cosAngle);\n}\n",startPS:"void main(void) {\n\tdDiffuseLight = vec3(0);\n\tdSpecularLight = vec3(0);\n\tdReflection = vec4(0);\n\tdSpecularity = vec3(0);\n\t#ifdef CLEARCOAT\n\tccSpecularLight = vec3(0);\n\tccReflection = vec4(0);\n\t#endif\n",startVS:"void main(void) {\n\tgl_Position = getPosition();\n",startNineSlicedPS:"\tnineSlicedUv = vUv0;\n\tnineSlicedUv.y = 1.0 - nineSlicedUv.y;\n",startNineSlicedTiledPS:"\tvec2 tileMask = step(vMask, vec2(0.99999));\n\tvec2 tileSize = 0.5 * (innerOffset.xy + innerOffset.zw);\n\tvec2 tileScale = vec2(1.0) / (vec2(1.0) - tileSize);\n\tvec2 clampedUv = mix(innerOffset.xy * 0.5, vec2(1.0) - innerOffset.zw * 0.5, fract((vTiledUv - tileSize) * tileScale));\n\tclampedUv = clampedUv * atlasRect.zw + atlasRect.xy;\n\tnineSlicedUv = vUv0 * tileMask + clampedUv * (vec2(1.0) - tileMask);\n\tnineSlicedUv.y = 1.0 - nineSlicedUv.y;\n",storeEVSMPS:"float exponent = VSM_EXPONENT;\ndepth = 2.0 * depth - 1.0;\ndepth =  exp(exponent * depth);\ngl_FragColor = vec4(depth, depth*depth, 1.0, 1.0);\n",tangentBinormalVS:"vec3 getTangent() {\n\treturn normalize(dNormalMatrix * vertex_tangent.xyz);\n}\nvec3 getBinormal() {\n\treturn cross(vNormalW, vTangentW) * vertex_tangent.w;\n}\nvec3 getObjectSpaceUp() {\n\treturn normalize(dNormalMatrix * vec3(0, 1, 0));\n}\n",TBNPS:"void getTBN() {\n\tdTBN = mat3(normalize(dTangentW), normalize(dBinormalW), normalize(dVertexNormalW));\n}\n",TBNderivativePS:"uniform float tbnBasis;\nvoid getTBN() {\n\tvec2 uv = $UV;\n\tvec3 dp1 = dFdx( vPositionW );\n\tvec3 dp2 = dFdy( vPositionW );\n\tvec2 duv1 = dFdx( uv );\n\tvec2 duv2 = dFdy( uv );\n\tvec3 dp2perp = cross( dp2, dVertexNormalW );\n\tvec3 dp1perp = cross( dVertexNormalW, dp1 );\n\tvec3 T = dp2perp * duv1.x + dp1perp * duv2.x;\n\tvec3 B = dp2perp * duv1.y + dp1perp * duv2.y;\n\tfloat denom = max( dot(T,T), dot(B,B) );\n\tfloat invmax = (denom == 0.0) ? 0.0 : tbnBasis / sqrt( denom );\n\tdTBN = mat3(T * invmax, -B * invmax, dVertexNormalW );\n}\n",TBNfastPS:"void getTBN() {\n\tdTBN = mat3(dTangentW, dBinormalW, dVertexNormalW);\n}\n",TBNObjectSpacePS:"void getTBN() {\n\tvec3 B = cross(dVertexNormalW, vObjectSpaceUpW);\n\tvec3 T = cross(dVertexNormalW, B);\n\tif (dot(B,B)==0.0)\n\t{\n\t\tfloat major=max(max(dVertexNormalW.x, dVertexNormalW.y),dVertexNormalW.z);\n\t\tif (dVertexNormalW.x==major)\n\t\t{\n\t\t\tB=cross(dVertexNormalW, vec3(0,1,0));\n\t\t\tT=cross(dVertexNormalW, B);\n\t\t}\n\t\telse if (dVertexNormalW.y==major)\n\t\t{\n\t\t\tB=cross(dVertexNormalW, vec3(0,0,1));\n\t\t\tT=cross(dVertexNormalW, B);\n\t\t}\n\t\telse if (dVertexNormalW.z==major)\n\t\t{\n\t\t\tB=cross(dVertexNormalW, vec3(1,0,0));\n\t\t\tT=cross(dVertexNormalW, B);\n\t\t}\n\t}\n\tdTBN = mat3(normalize(T), normalize(B), normalize(dVertexNormalW));\n}\n",tonemappingAcesPS:"uniform float exposure;\nvec3 toneMap(vec3 color) {\n\tfloat tA = 2.51;\n\tfloat tB = 0.03;\n\tfloat tC = 2.43;\n\tfloat tD = 0.59;\n\tfloat tE = 0.14;\n\tvec3 x = color * exposure;\n\treturn (x*(tA*x+tB))/(x*(tC*x+tD)+tE);\n}\n",tonemappingAces2PS:"uniform float exposure;\nconst mat3 ACESInputMat = mat3(\n\t0.59719, 0.35458, 0.04823,\n\t0.07600, 0.90834, 0.01566,\n\t0.02840, 0.13383, 0.83777\n);\nconst mat3 ACESOutputMat = mat3(\n\t 1.60475, -0.53108, -0.07367,\n\t-0.10208,  1.10813, -0.00605,\n\t-0.00327, -0.07276,  1.07602\n);\nvec3 RRTAndODTFit(vec3 v) {\n\tvec3 a = v * (v + 0.0245786) - 0.000090537;\n\tvec3 b = v * (0.983729 * v + 0.4329510) + 0.238081;\n\treturn a / b;\n}\nvec3 toneMap(vec3 color) {\n\tcolor *= exposure;\n\tcolor = color * ACESInputMat;\n\tcolor = RRTAndODTFit(color);\n\tcolor = color * ACESOutputMat;\n\tcolor = clamp(color, 0.0, 1.0);\n\treturn color;\n}\n",tonemappingFilmicPS:"const float A =  0.15;\nconst float B =  0.50;\nconst float C =  0.10;\nconst float D =  0.20;\nconst float E =  0.02;\nconst float F =  0.30;\nconst float W =  11.2;\nuniform float exposure;\nvec3 uncharted2Tonemap(vec3 x) {\n   return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\nvec3 toneMap(vec3 color) {\n\tcolor = uncharted2Tonemap(color * exposure);\n\tvec3 whiteScale = 1.0 / uncharted2Tonemap(vec3(W,W,W));\n\tcolor = color * whiteScale;\n\treturn color;\n}\n",tonemappingHejlPS:"uniform float exposure;\nvec3 toneMap(vec3 color) {\n\tcolor *= exposure;\n\tconst float  A = 0.22, B = 0.3, C = .1, D = 0.2, E = .01, F = 0.3;\n\tconst float Scl = 1.25;\n\tvec3 h = max( vec3(0.0), color - vec3(0.004) );\n\treturn (h*((Scl*A)*h+Scl*vec3(C*B,C*B,C*B))+Scl*vec3(D*E,D*E,D*E)) / (h*(A*h+vec3(B,B,B))+vec3(D*F,D*F,D*F)) - Scl*vec3(E/F,E/F,E/F);\n}\n",tonemappingLinearPS:"uniform float exposure;\nvec3 toneMap(vec3 color) {\n\treturn color * exposure;\n}\n",tonemappingNonePS:"vec3 toneMap(vec3 color) {\n\treturn color;\n}\n",transformVS:"#ifdef PIXELSNAP\nuniform vec4 uScreenSize;\n#endif\n#ifdef MORPHING\nuniform vec4 morph_weights_a;\nuniform vec4 morph_weights_b;\n#endif\n#ifdef MORPHING_TEXTURE_BASED\nuniform vec4 morph_tex_params;\nvec2 getTextureMorphCoords() {\n\tfloat vertexId = morph_vertex_id;\n\tvec2 textureSize = morph_tex_params.xy;\n\tvec2 invTextureSize = morph_tex_params.zw;\n\tfloat morphGridV = floor(vertexId * invTextureSize.x);\n\tfloat morphGridU = vertexId - (morphGridV * textureSize.x);\n\treturn (vec2(morphGridU, morphGridV) * invTextureSize) + (0.5 * invTextureSize);\n}\n#endif\n#ifdef MORPHING_TEXTURE_BASED_POSITION\nuniform highp sampler2D morphPositionTex;\n#endif\nmat4 getModelMatrix() {\n\t#ifdef DYNAMICBATCH\n\treturn getBoneMatrix(vertex_boneIndices);\n\t#elif defined(SKIN)\n\treturn matrix_model * getSkinMatrix(vertex_boneIndices, vertex_boneWeights);\n\t#elif defined(INSTANCING)\n\treturn mat4(instance_line1, instance_line2, instance_line3, instance_line4);\n\t#else\n\treturn matrix_model;\n\t#endif\n}\nvec4 getPosition() {\n\tdModelMatrix = getModelMatrix();\n\tvec3 localPos = vertex_position;\n\t#ifdef NINESLICED\n\tlocalPos.xz *= outerScale;\n\tvec2 positiveUnitOffset = clamp(vertex_position.xz, vec2(0.0), vec2(1.0));\n\tvec2 negativeUnitOffset = clamp(-vertex_position.xz, vec2(0.0), vec2(1.0));\n\tlocalPos.xz += (-positiveUnitOffset * innerOffset.xy + negativeUnitOffset * innerOffset.zw) * vertex_texCoord0.xy;\n\tvTiledUv = (localPos.xz - outerScale + innerOffset.xy) * -0.5 + 1.0;\n\tlocalPos.xz *= -0.5;\n\tlocalPos = localPos.xzy;\n\t#endif\n\t#ifdef MORPHING\n\t#ifdef MORPHING_POS03\n\tlocalPos.xyz += morph_weights_a[0] * morph_pos0;\n\tlocalPos.xyz += morph_weights_a[1] * morph_pos1;\n\tlocalPos.xyz += morph_weights_a[2] * morph_pos2;\n\tlocalPos.xyz += morph_weights_a[3] * morph_pos3;\n\t#endif\n\t#ifdef MORPHING_POS47\n\tlocalPos.xyz += morph_weights_b[0] * morph_pos4;\n\tlocalPos.xyz += morph_weights_b[1] * morph_pos5;\n\tlocalPos.xyz += morph_weights_b[2] * morph_pos6;\n\tlocalPos.xyz += morph_weights_b[3] * morph_pos7;\n\t#endif\n\t#endif\n\t#ifdef MORPHING_TEXTURE_BASED_POSITION\n\tvec2 morphUV = getTextureMorphCoords();\n\tvec3 morphPos = texture2D(morphPositionTex, morphUV).xyz;\n\tlocalPos += morphPos;\n\t#endif\n\tvec4 posW = dModelMatrix * vec4(localPos, 1.0);\n\t#ifdef SCREENSPACE\n\tposW.zw = vec2(0.0, 1.0);\n\t#endif\n\tdPositionW = posW.xyz;\n\tvec4 screenPos;\n\t#ifdef UV1LAYOUT\n\tscreenPos = vec4(vertex_texCoord1.xy * 2.0 - 1.0, 0.5, 1);\n\t#else\n\t#ifdef SCREENSPACE\n\tscreenPos = posW;\n\t#else\n\tscreenPos = matrix_viewProjection * posW;\n\t#endif\n\t#ifdef PIXELSNAP\n\tscreenPos.xy = (screenPos.xy * 0.5) + 0.5;\n\tscreenPos.xy *= uScreenSize.xy;\n\tscreenPos.xy = floor(screenPos.xy);\n\tscreenPos.xy *= uScreenSize.zw;\n\tscreenPos.xy = (screenPos.xy * 2.0) - 1.0;\n\t#endif\n\t#endif\n\treturn screenPos;\n}\nvec3 getWorldPosition() {\n\treturn dPositionW;\n}\n",transformDeclVS:"attribute vec3 vertex_position;\nuniform mat4 matrix_model;\nuniform mat4 matrix_viewProjection;\nvec3 dPositionW;\nmat4 dModelMatrix;\n",uv0VS:"#ifdef NINESLICED\nvec2 getUv0() {\n\tvec2 uv = vertex_position.xz;\n\tvec2 positiveUnitOffset = clamp(vertex_position.xz, vec2(0.0), vec2(1.0));\n\tvec2 negativeUnitOffset = clamp(-vertex_position.xz, vec2(0.0), vec2(1.0));\n\tuv += (-positiveUnitOffset * innerOffset.xy + negativeUnitOffset * innerOffset.zw) * vertex_texCoord0.xy;\n\tuv = uv * -0.5 + 0.5;\n\tuv = uv * atlasRect.zw + atlasRect.xy;\n\tvMask = vertex_texCoord0.xy;\n\treturn uv;\n}\n#else\nvec2 getUv0() {\n\treturn vertex_texCoord0;\n}\n#endif\n",uv1VS:"vec2 getUv1() {\n\treturn vertex_texCoord1;\n}\n",viewDirPS:"void getViewDir() {\n\tdViewDirW = normalize(view_position - vPositionW);\n}\n",viewNormalVS:"#ifndef VIEWMATRIX\n#define VIEWMATRIX\nuniform mat4 matrix_view;\n#endif\nvec3 getViewNormal() {\n\treturn mat3(matrix_view) * vNormalW;\n}\n"};function Ho(t,e){return e||(e=jo),t===Ye||t===qe?e.gamma2_2PS?e.gamma2_2PS:jo.gamma2_2PS:t===Ke?"#define HDR\n"+(e.gamma2_2PS?e.gamma2_2PS:jo.gamma2_2PS):e.gamma1_0PS?e.gamma1_0PS:jo.gamma1_0PS}function Xo(t,e){return e||(e=jo),t===Qe?e.tonemappingFilmicPS?e.tonemappingFilmicPS:jo.tonemappingFilmicPS:t===Ze?e.tonemappingLinearPS?e.tonemappingLinearPS:jo.tonemappingLinearPS:t===$e?e.tonemappingHejlPS?e.tonemappingHejlPS:jo.tonemappingHejlPS:t===Je?e.tonemappingAcesPS?e.tonemappingAcesPS:jo.tonemappingAcesPS:t===ti?e.tonemappingAces2PS?e.tonemappingAces2PS:jo.tonemappingAces2PS:e.tonemapingNonePS?e.tonemapingNonePS:jo.tonemappingNonePS}function Yo(t,e){return e||(e=jo),"linear"===t?e.fogLinearPS?e.fogLinearPS:jo.fogLinearPS:"exp"===t?e.fogExpPS?e.fogExpPS:jo.fogExpPS:"exp2"===t?e.fogExp2PS?e.fogExp2PS:jo.fogExp2PS:e.fogNonePS?e.fogNonePS:jo.fogNonePS}function qo(t,e){return e||(e=jo),t.supportsBoneTextures?e.skinTexVS:"#define BONE_LIMIT "+t.getBoneLimit()+"\n"+e.skinConstVS}function Ko(t){let e="precision "+t.precision+" float;\n";return t.webgl2&&(e+="#ifdef GL2\nprecision "+t.precision+" sampler2DShadow;\n#endif\n"),e}function Zo(t){return t.webgl2?"#version 300 es\n":""}function Qo(){return"void main(void) {gl_FragColor = vec4(0.0);}"}function $o(){return"void main(void)\n{\n"}function Jo(){return"}\n"}const ta={vertex_position:Zs,vertex_normal:Qs,vertex_tangent:$s,vertex_texCoord0:nr,vertex_texCoord1:sr,vertex_texCoord2:rr,vertex_texCoord3:or,vertex_texCoord4:ar,vertex_texCoord5:lr,vertex_texCoord6:hr,vertex_texCoord7:cr,vertex_color:er,vertex_boneIndices:tr,vertex_boneWeights:Js};function ea(t){const e={};let i=0,n=t.indexOf("attribute");for(;n>=0&&!(n>0&&"/"===t[n-1]);){const s=t.indexOf(";",n),r=t.lastIndexOf(" ",s),o=t.substr(r+1,s-(r+1)),a=ta[o];void 0!==a?e[o]=a:(e[o]="ATTR"+i,i++),n=t.indexOf("attribute",n+1)}return e}function ia(t,e,i,n,s,r){const o=t.programLib._cache,a=o[n];if(void 0!==a)return a;i=Ko(t)+"\n"+(i||"void main(void) {gl_FragColor = vec4(0.0);}");const l=ea(e);return t.webgl2&&(e=Zo(t)+jo.gles3VS+e,i=Zo(t)+jo.gles3PS+i),o[n]=new Go(t,{attributes:l,vshader:e,fshader:(r||"")+i,useTransformFeedback:s}),o[n]}jo.collectAttribs=ea,jo.createShader=function(t,e,i,n){let s=jo[e],r=Ko(t)+"\n"+jo[i];const o=ea(s);return t.webgl2&&(s=Zo(t)+jo.gles3VS+s,r=Zo(t)+jo.gles3PS+r),new Go(t,{attributes:o,vshader:s,fshader:r,useTransformFeedback:n})},jo.createShaderFromCode=ia;const na={generateKey:function(t){let e="basic";return t.fog&&(e+="_fog"),t.alphaTest&&(e+="_atst"),t.vertexColors&&(e+="_vcol"),t.diffuseMap&&(e+="_diff"),t.skin&&(e+="_skin"),t.screenSpace&&(e+="_ss"),t.useInstancing&&(e+="_inst"),t.useMorphPosition&&(e+="_morphp"),t.useMorphNormal&&(e+="_morphn"),t.useMorphTextureBased&&(e+="_morpht"),e+="_"+t.pass,e},createShaderDefinition:function(t,e){const i={vertex_position:Zs};e.skin&&(i.vertex_boneWeights=Js,i.vertex_boneIndices=tr),e.vertexColors&&(i.vertex_color=er),e.diffuseMap&&(i.vertex_texCoord0=nr);let n="";n+=jo.transformDeclVS,e.skin?(n+=qo(t),n+=jo.transformSkinnedVS):n+=jo.transformVS,e.vertexColors&&(n+="attribute vec4 vertex_color;\n",n+="varying vec4 vColor;\n"),e.diffuseMap&&(n+="attribute vec2 vertex_texCoord0;\n",n+="varying vec2 vUv0;\n"),e.pass===Pi&&(n+="varying float vDepth;\n",n+="#ifndef VIEWMATRIX\n",n+="#define VIEWMATRIX\n",n+="uniform mat4 matrix_view;\n",n+="#endif\n",n+="#ifndef CAMERAPLANES\n",n+="#define CAMERAPLANES\n",n+="uniform vec4 camera_params;\n\n",n+="#endif\n"),n+="void main(void)\n{\n",n+="\t gl_Position = getPosition();\n",e.pass===Pi&&(n+="\t\tvDepth = -(matrix_view * vec4(getWorldPosition(),1.0)).z * camera_params.x;\n"),e.vertexColors&&(n+="\t\tvColor = vertex_color;\n"),e.diffuseMap&&(n+="\t\tvUv0 = vertex_texCoord0;\n"),n+="}\n";const s=n;n=Ko(t),e.vertexColors?n+="varying vec4 vColor;\n":n+="uniform vec4 uColor;\n",e.diffuseMap&&(n+="varying vec2 vUv0;\n",n+="uniform sampler2D texture_diffuseMap;\n"),e.fog&&(n+=Yo(e.fog)),e.alphatest&&(n+=jo.alphaTestPS),e.pass===Pi&&(n+="varying float vDepth;\n",n+=jo.packDepthPS),n+="void main(void)\n{\n",e.vertexColors?n+="\t\tgl_FragColor = vColor;\n":n+="\t\tgl_FragColor = uColor;\n",e.diffuseMap&&(n+="\t\tgl_FragColor *= texture2D(texture_diffuseMap, vUv0);\n"),e.alphatest&&(n+="\t alphaTest(gl_FragColor.a);\n"),e.pass!==Di&&(e.pass===Pi?n+="\t\tgl_FragColor = packFloat(vDepth);\n":e.fog&&(n+="\t glFragColor.rgb = addFog(gl_FragColor.rgb);\n")),n+="}\n";return{attributes:i,vshader:s,fshader:n}}},sa={generateKey:function(t){let e="particle";for(const i in t)t.hasOwnProperty(i)&&(e+=t[i]);return e},_animTex:function(t){let e="";return e+=t.animTexLoop?jo.particleAnimFrameLoopVS:jo.particleAnimFrameClampVS,e+=jo.particleAnimTexVS,e},createShaderDefinition:function(t,e){let i="",n=Ko(t)+"\n";n+="#define PARTICLE\n",t.webgl2&&(i+="#define GL2\n",n+="#define GL2\n"),i+="#define VERTEXSHADER\n",e.mesh&&(i+="#define USE_MESH\n"),e.localSpace&&(i+="#define LOCAL_SPACE\n"),e.screenSpace&&(i+="#define SCREEN_SPACE\n"),e.animTex&&(i+="\nuniform vec2 animTexTilesParams;\n"),e.animTex&&(i+="\nuniform vec4 animTexParams;\n"),e.animTex&&(i+="\nuniform vec2 animTexIndexParams;\n"),2===e.normal&&(i+="\nvarying mat3 ParticleMat;\n"),1===e.normal&&(i+="\nvarying vec3 Normal;\n"),e.soft&&(i+="\nvarying float vDepth;\n");const s=e.customFace?jo.particle_customFaceVS:jo.particle_billboardVS;e.useCpu?(e.soft>0&&(i+=jo.screenDepthPS),i+=jo.particle_cpuVS,e.localSpace&&(i+=jo.particle_localShiftVS),e.animTex&&(i+=this._animTex(e)),e.alignToMotion&&(i+=jo.particle_pointAlongVS),i+=e.mesh?jo.particle_meshVS:s,1===e.normal&&(i+=jo.particle_normalVS),2===e.normal&&(i+=jo.particle_TBNVS),e.stretch>0&&(i+=jo.particle_stretchVS),i+=jo.particle_cpu_endVS,e.soft>0&&(i+=jo.particle_softVS)):(i+=jo.particle_initVS,i+=e.pack8?jo.particleInputRgba8PS:jo.particleInputFloatPS,e.soft>0&&(i+=jo.screenDepthPS),i+=jo.particleVS,e.localSpace&&(i+=jo.particle_localShiftVS),e.animTex&&(i+=this._animTex(e)),e.wrap&&(i+=jo.particle_wrapVS),e.alignToMotion&&(i+=jo.particle_pointAlongVS),i+=e.mesh?jo.particle_meshVS:s,1===e.normal&&(i+=jo.particle_normalVS),2===e.normal&&(i+=jo.particle_TBNVS),e.stretch>0&&(i+=jo.particle_stretchVS),i+=jo.particle_endVS,e.soft>0&&(i+=jo.particle_softVS)),i+="}\n",e.normal>0&&(1===e.normal?n+="\nvarying vec3 Normal;\n":2===e.normal&&(n+="\nvarying mat3 ParticleMat;\n"),n+="\nuniform vec3 lightCube[6];\n"),e.soft&&(n+="\nvarying float vDepth;\n"),0===e.normal&&"none"===e.fog&&(e.srgb=!1),n+=Ho(e.gamma),n+=Xo(e.toneMap),"linear"===e.fog?n+=jo.fogLinearPS:"exp"===e.fog?n+=jo.fogExpPS:"exp2"===e.fog?n+=jo.fogExp2PS:n+=jo.fogNonePS,2===e.normal&&(n+="\nuniform sampler2D normalMap;\n"),e.soft>0&&(n+=jo.screenDepthPS),n+=jo.particlePS,e.soft>0&&(n+=jo.particle_softPS),1===e.normal&&(n+="\nvec3 normal = Normal;\n"),2===e.normal&&(n+=jo.particle_normalMapPS),e.normal>0&&(n+=e.halflambert?jo.particle_halflambertPS:jo.particle_lambertPS),e.normal>0&&(n+=jo.particle_lightingPS),e.blend===Pt?n+=jo.particle_blendNormalPS:e.blend===It?n+=jo.particle_blendAddPS:e.blend===kt&&(n+=jo.particle_blendMultiplyPS),n+=jo.particle_endPS;return{attributes:ea(i),vshader:i,fshader:n}}},ra={generateKey:function(t){return"skybox"+t.rgbm+" "+t.hdr+" "+t.fixSeams+t.toneMapping+t.gamma+t.useIntensity+t.useCubeMapRotation+t.useRightHandedCubeMap+t.mip},createShaderDefinition:function(t,e){let i=Ko(t);return i+=e.useCubeMapRotation?"#define CUBEMAP_ROTATION\n":"",i+=e.useRightHandedCubeMap?"#define RIGHT_HANDED_CUBEMAP\n":"",i+=e.mip?jo.fixCubemapSeamsStretchPS:jo.fixCubemapSeamsNonePS,i+=e.useIntensity?jo.envMultiplyPS:jo.envConstPS,i+=Ho(e.gamma),i+=Xo(e.toneMapping),i+=jo.rgbmPS,i+=jo.skyboxHDRPS.replace(/\$textureCubeSAMPLE/g,e.rgbm?"textureCubeRGBM":e.hdr?"textureCube":"textureCubeSRGB").replace(/\$FIXCONST/g,1-1/[128,64,32,16,8,4,2][e.mip]+""),{attributes:{aPosition:Zs},vshader:jo.skyboxVS,fshader:i}}},oa=new Float32Array(1),aa=new Int32Array(oa.buffer);class la{static float2Half(t){oa[0]=t;const e=aa[0];let i=e>>16&32768,n=e>>12&2047;const s=e>>23&255;return s<103?i:s>142?(i|=31744,i|=(255===s?0:1)&&8388607&e,i):s<113?(n|=2048,i|=(n>>114-s)+(n>>113-s&1),i):(i|=s-112<<10|n>>1,i+=1&n,i)}static float2Bytes(t,e,i,n){const s=255*t%1;if(e[i+0]=Math.round(255*(t%1-1/255*s)),n>1){const r=65025*t%1;if(e[i+1]=Math.round(255*(s-1/255*r)),n>2){const s=16581375*t%1;e[i+2]=Math.round(255*(r-1/255*s)),n>3&&(e[i+3]=Math.round(255*s))}}}static float2BytesRange(t,e,i,n,s,r){t=Z.clamp((t-n)/(s-n),0,1),la.float2Bytes(t,e,i,r)}static float2MantisaExponent(t,e,i,n){const s=Math.floor(Math.log2(Math.abs(t)))+1;t/=Math.pow(2,s),la.float2BytesRange(t,e,i,-1,1,n-1),e[i+n-1]=Math.round(s+127)}}var ha=null,ca=null;class _a{constructor(t,e){this.device=t,this.name=null,this._width=4,this._height=4,this._depth=1,this._format=ys,this.type=Ur,this.projection=Yr,this._cubemap=!1,this._volume=!1,this.fixCubemapSeams=!1,this._flipY=!1,this._premultiplyAlpha=!1,this._isRenderTarget=!1,this._mipmaps=!0,this._minFilter=ts,this._magFilter=Zn,this._anisotropy=1,this._addressU=dn,this._addressV=dn,this._addressW=dn,this._compareOnRead=!1,this._compareFunc=is,void 0!==e&&(void 0!==e.name&&(this.name=e.name),this._width=void 0!==e.width?e.width:this._width,this._height=void 0!==e.height?e.height:this._height,this._format=void 0!==e.format?e.format:this._format,e.hasOwnProperty("type")?this.type=e.type:e.hasOwnProperty("rgbm")?this.type=e.rgbm?Vr:Ur:e.hasOwnProperty("swizzleGGGR")&&(this.type=e.swizzleGGGR?Wr:Ur),void 0!==e.mipmaps?this._mipmaps=e.mipmaps:this._mipmaps=void 0!==e.autoMipmap?e.autoMipmap:this._mipmaps,this._levels=e.levels,this._cubemap=void 0!==e.cubemap?e.cubemap:this._cubemap,this.fixCubemapSeams=void 0!==e.fixCubemapSeams?e.fixCubemapSeams:this.fixCubemapSeams,this._cubemap?this.projection=qr:e.projection&&e.projection!==qr&&(this.projection=e.projection),this._minFilter=void 0!==e.minFilter?e.minFilter:this._minFilter,this._magFilter=void 0!==e.magFilter?e.magFilter:this._magFilter,this._anisotropy=void 0!==e.anisotropy?e.anisotropy:this._anisotropy,this._addressU=void 0!==e.addressU?e.addressU:this._addressU,this._addressV=void 0!==e.addressV?e.addressV:this._addressV,this._compareOnRead=void 0!==e.compareOnRead?e.compareOnRead:this._compareOnRead,this._compareFunc=void 0!==e._compareFunc?e._compareFunc:this._compareFunc,this._flipY=void 0!==e.flipY?e.flipY:this._flipY,this._premultiplyAlpha=void 0!==e.premultiplyAlpha?e.premultiplyAlpha:this._premultiplyAlpha,t.webgl2&&(this._depth=void 0!==e.depth?e.depth:this._depth,this._volume=void 0!==e.volume?e.volume:this._volume,this._addressW=void 0!==e.addressW?e.addressW:this._addressW)),this._compressed=this._format===vs||this._format===Ss||this._format===xs||this._format>=Ds,this._invalid=!1,this._lockedLevel=-1,this._levels||(this._levels=this._cubemap?[[null,null,null,null,null,null]]:[null]),this.dirtyAll(),this._gpuSize=0}get minFilter(){return this._minFilter}set minFilter(t){this._minFilter!==t&&(this._minFilter=t,this._parameterFlags|=1)}get magFilter(){return this._magFilter}set magFilter(t){this._magFilter!==t&&(this._magFilter=t,this._parameterFlags|=2)}get addressU(){return this._addressU}set addressU(t){this._addressU!==t&&(this._addressU=t,this._parameterFlags|=4)}get addressV(){return this._addressV}set addressV(t){this._addressV!==t&&(this._addressV=t,this._parameterFlags|=8)}get addressW(){return this._addressW}set addressW(t){this.device.webgl2&&this._volume&&t!==this._addressW&&(this._addressW=t,this._parameterFlags|=16)}get compareOnRead(){return this._compareOnRead}set compareOnRead(t){this._compareOnRead!==t&&(this._compareOnRead=t,this._parameterFlags|=32)}get compareFunc(){return this._compareFunc}set compareFunc(t){this._compareFunc!==t&&(this._compareFunc=t,this._parameterFlags|=64)}get anisotropy(){return this._anisotropy}set anisotropy(t){this._anisotropy!==t&&(this._anisotropy=t,this._parameterFlags|=128)}get autoMipmap(){return this._mipmaps}set autoMipmap(t){this._mipmaps=t}get mipmaps(){return this._mipmaps}set mipmaps(t){this._mipmaps!==t&&(this._mipmaps=t,this._minFilterDirty=!0,t&&(this._needsMipmapsUpload=!0))}get width(){return this._width}get height(){return this._height}get depth(){return this._depth}get format(){return this._format}get cubemap(){return this._cubemap}get gpuSize(){var t=this.pot&&this._mipmaps&&!(this._compressed&&1===this._levels.length);return _a.calcGpuSize(this._width,this._height,this._depth,this._format,t,this._cubemap)}get volume(){return this._volume}get flipY(){return this._flipY}set flipY(t){this._flipY!==t&&(this._flipY=t,this._needsUpload=!0)}get premultiplyAlpha(){return this._premultiplyAlpha}set premultiplyAlpha(t){this._premultiplyAlpha!==t&&(this._premultiplyAlpha=t,this._needsUpload=!0)}get pot(){return Z.powerOfTwo(this._width)&&Z.powerOfTwo(this._height)}static calcGpuSize(t,e,i,n,s,r){ha||((ha=[])[us]=1,ha[ds]=1,ha[ps]=2,ha[fs]=2,ha[ms]=2,ha[gs]=2,ha[bs]=4,ha[ys]=4,ha[ws]=8,ha[Cs]=8,ha[Ts]=16,ha[As]=16,ha[Es]=4,ha[Ms]=4,ha[Rs]=4,ha[Is]=4,ha[Ps]=4,ha[Ls]=4),ca||((ca=[])[Ds]=8,ca[ks]=8,ca[Fs]=8,ca[Bs]=8,ca[Ns]=8,ca[Us]=8,ca[vs]=8,ca[zs]=8,ca[Os]=16,ca[Ss]=16,ca[xs]=16,ca[Vs]=16,ca[Ws]=16);for(var o=ha.hasOwnProperty(n)?ha[n]:0,a=ca.hasOwnProperty(n)?ca[n]:0,l=0;;){if(o>0)l+=t*e*i*o;else{var h=Math.floor((t+3)/4),c=Math.floor((e+3)/4),_=Math.floor((i+3)/4);n!==Fs&&n!==Bs||(h=Math.max(Math.floor(h/2),1)),l+=h*c*_*a}if(!s||1===t&&1===e&&1===i)break;t=Math.max(Math.floor(t/2),1),e=Math.max(Math.floor(e/2),1),i=Math.max(Math.floor(i/2),1)}return l*(r?6:1)}destroy(){this.device&&this.device.destroyTexture(this),this.device=null,this._levels=this._cubemap?[[null,null,null,null,null,null]]:[null]}dirtyAll(){this._levelsUpdated=this._cubemap?[[!0,!0,!0,!0,!0,!0]]:[!0],this._needsUpload=!0,this._needsMipmapsUpload=this._mipmaps,this._mipmapsUploaded=!1,this._parameterFlags=255}lock(t={}){if(void 0===t.level&&(t.level=0),void 0===t.face&&(t.face=0),void 0===t.mode&&(t.mode=Nr),this._lockedLevel=t.level,null===this._levels[t.level])switch(this._format){case us:case ds:this._levels[t.level]=new Uint8Array(this._width*this._height*this._depth);break;case ps:this._levels[t.level]=new Uint8Array(this._width*this._height*this._depth*2);break;case fs:case ms:case gs:this._levels[t.level]=new Uint16Array(this._width*this._height*this._depth);break;case bs:this._levels[t.level]=new Uint8Array(this._width*this._height*this._depth*3);break;case ys:this._levels[t.level]=new Uint8Array(this._width*this._height*this._depth*4);break;case vs:this._levels[t.level]=new Uint8Array(Math.floor((this._width+3)/4)*Math.floor((this._height+3)/4)*8*this._depth);break;case Ss:case xs:this._levels[t.level]=new Uint8Array(Math.floor((this._width+3)/4)*Math.floor((this._height+3)/4)*16*this._depth);break;case ws:this._levels[t.level]=new Uint16Array(this._width*this._height*this._depth*3);break;case Ts:this._levels[t.level]=new Float32Array(this._width*this._height*this._depth*3);break;case Cs:this._levels[t.level]=new Uint16Array(this._width*this._height*this._depth*4);break;case As:this._levels[t.level]=new Float32Array(this._width*this._height*this._depth*4)}return this._levels[t.level]}setSource(t,e=0){var i,n,s,r=!1;if(this._cubemap){if(t[0])for(n=t[0].width||0,s=t[0].height||0,i=0;i<6;i++){var o=t[i];if(!o||o.width!==n||o.height!==s||!this.device._isBrowserInterface(o)){r=!0;break}}else r=!0;if(!r)for(i=0;i<6;i++)this._levels[e][i]!==t[i]&&(this._levelsUpdated[e][i]=!0)}else this.device._isBrowserInterface(t)||(r=!0),r||(t!==this._levels[e]&&(this._levelsUpdated[e]=!0),n=t.width,s=t.height);if(r)if(this._width=4,this._height=4,this._cubemap)for(i=0;i<6;i++)this._levels[e][i]=null,this._levelsUpdated[e][i]=!0;else this._levels[e]=null,this._levelsUpdated[e]=!0;else 0===e&&(this._width=n,this._height=s),this._levels[e]=t;this._invalid===r&&r||(this._invalid=r,this.upload())}getSource(t=0){return this._levels[t]}unlock(){this.upload(),this._lockedLevel=-1}upload(){this._needsUpload=!0,this._needsMipmapsUpload=this._mipmaps}getDds(){for(var t,e,i=128,n=0;this._levels[n];){var s;if(this.cubemap)for(e=0;e<6;e++){if(!this._levels[n][e])return;if(!(s=this._levels[n][e].length))return;i+=s}else{if(!(s=this._levels[n].length))return;i+=s}i+=this._levels[n].length,n++}var r=new ArrayBuffer(i),o=new Uint32Array(r,0,32),a=528391;this._levels.length>1&&(a|=131072);var l=4096;this._levels.length>1&&(l|=4194304),(this._levels.length>1||this.cubemap)&&(l|=8);var h=this.cubemap?65024:0;for(o[0]=542327876,o[1]=124,o[2]=a,o[3]=this.height,o[4]=this.width,o[5]=this.width*this.height*4,o[6]=0,o[7]=this._levels.length,n=0;n<11;n++)o[8+n]=0;o[19]=32,o[20]=65,o[21]=0,o[22]=32,o[23]=16711680,o[24]=65280,o[25]=255,o[26]=4278190080,o[27]=l,o[28]=h,o[29]=0,o[30]=0,o[31]=0;var c,_,u=128;if(this.cubemap)for(e=0;e<6;e++)for(n=0;n<this._levels.length;n++){for(c=this._levels[n][e],_=new Uint8Array(r,u,c.length),t=0;t<c.length;t++)_[t]=c[t];u+=c.length}else for(n=0;n<this._levels.length;n++){for(c=this._levels[n],_=new Uint8Array(r,u,c.length),t=0;t<c.length;t++)_[t]=c[t];u+=c.length}return r}}const ua=new ht,da=new ht,pa=new ht,fa=new bt;class ma{constructor(){this._aspectRatio=16/9,this._aspectRatioMode=$i,this._calculateProjection=null,this._calculateTransform=null,this._clearColor=new rt(.75,.75,.75,1),this._clearColorBuffer=!0,this._clearDepth=1,this._clearDepthBuffer=!0,this._clearStencil=0,this._clearStencilBuffer=!0,this._cullingMask=4294967295,this._cullFaces=!0,this._farClip=1e3,this._flipFaces=!1,this._fov=45,this._frustumCulling=!0,this._horizontalFov=!1,this._layers=[Zt,Qt,$t,te,Jt],this._nearClip=.1,this._node=null,this._orthoHeight=10,this._projection=Pe,this._rect=new ut(0,0,1,1),this._renderTarget=null,this._scissorRect=new ut(0,0,1,1),this._scissorRectClear=!1,this._vrDisplay=null,this._projMat=new bt,this._projMatDirty=!0,this._projMatSkybox=new bt,this._viewMat=new bt,this._viewMatDirty=!0,this._viewProjMat=new bt,this._viewProjMatDirty=!0,this.frustum=new sn}get aspectRatio(){return this._aspectRatio}set aspectRatio(t){this._aspectRatio!==t&&(this._aspectRatio=t,this._projMatDirty=!0)}get aspectRatioMode(){return this._aspectRatioMode}set aspectRatioMode(t){this._aspectRatioMode!==t&&(this._aspectRatioMode=t,this._projMatDirty=!0)}get calculateProjection(){return this._calculateProjection}set calculateProjection(t){this._calculateProjection=t,this._projMatDirty=!0}get calculateTransform(){return this._calculateTransform}set calculateTransform(t){this._calculateTransform=t}get clearColor(){return this._clearColor}set clearColor(t){this._clearColor.copy(t)}get clearColorBuffer(){return this._clearColorBuffer}set clearColorBuffer(t){this._clearColorBuffer=t}get clearDepth(){return this._clearDepth}set clearDepth(t){this._clearDepth=t}get clearDepthBuffer(){return this._clearDepthBuffer}set clearDepthBuffer(t){this._clearDepthBuffer=t}get clearStencil(){return this._clearStencil}set clearStencil(t){this._clearStencil=t}get clearStencilBuffer(){return this._clearStencilBuffer}set clearStencilBuffer(t){this._clearStencilBuffer=t}get cullingMask(){return this._cullingMask}set cullingMask(t){this._cullingMask=t}get cullFaces(){return this._cullFaces}set cullFaces(t){this._cullFaces=t}get farClip(){return this._farClip}set farClip(t){this._farClip!==t&&(this._farClip=t,this._projMatDirty=!0)}get flipFaces(){return this._flipFaces}set flipFaces(t){this._flipFaces=t}get fov(){return this._fov}set fov(t){this._fov!==t&&(this._fov=t,this._projMatDirty=!0)}get frustumCulling(){return this._frustumCulling}set frustumCulling(t){this._frustumCulling=t}get horizontalFov(){return this._horizontalFov}set horizontalFov(t){this._horizontalFov!==t&&(this._horizontalFov=t,this._projMatDirty=!0)}get layers(){return this._layers}set layers(t){this._layers=t.slice(0)}get nearClip(){return this._nearClip}set nearClip(t){this._nearClip!==t&&(this._nearClip=t,this._projMatDirty=!0)}get node(){return this._node}set node(t){this._node=t}get orthoHeight(){return this._orthoHeight}set orthoHeight(t){this._orthoHeight!==t&&(this._orthoHeight=t,this._projMatDirty=!0)}get projection(){return this._projection}set projection(t){this._projection!==t&&(this._projection=t,this._projMatDirty=!0)}get projectionMatrix(){return this._evaluateProjectionMatrix(),this._projMat}get rect(){return this._rect}set rect(t){this._rect.copy(t)}get renderTarget(){return this._renderTarget}set renderTarget(t){this._renderTarget=t}get scissorRect(){return this._scissorRect}set scissorRect(t){this._scissorRect.copy(t)}get viewMatrix(){if(this._viewMatDirty){const t=this._node.getWorldTransform();this._viewMat.copy(t).invert(),this._viewMatDirty=!1}return this._viewMat}get vrDisplay(){return this._vrDisplay}set vrDisplay(t){this._vrDisplay=t,t&&(t._camera=this)}clone(){return(new ma).copy(this)}copy(t){return this.aspectRatio=t.aspectRatio,this.aspectRatioMode=t.aspectRatioMode,this.calculateProjection=t.calculateProjection,this.calculateTransform=t.calculateTransform,this.clearColor=t.clearColor,this.clearColorBuffer=t.clearColorBuffer,this.clearDepth=t.clearDepth,this.clearDepthBuffer=t.clearDepthBuffer,this.clearStencil=t.clearStencil,this.clearStencilBuffer=t.clearStencilBuffer,this.cullFaces=t.cullFaces,this.cullingMask=t.cullingMask,this.farClip=t.farClip,this.flipFaces=t.flipFaces,this.fov=t.fov,this.frustumCulling=t.frustumCulling,this.horizontalFov=t.horizontalFov,this.layers=t.layers,this.nearClip=t.nearClip,this.orthoHeight=t.orthoHeight,this.projection=t.projection,this.rect=t.rect,this.renderTarget=t.renderTarget,this.scissorRect=t.scissorRect,this.vrDisplay=t.vrDisplay,this}_updateViewProjMat(){(this._projMatDirty||this._viewMatDirty||this._viewProjMatDirty)&&(this._viewProjMat.mul2(this.projectionMatrix,this.viewMatrix),this._viewProjMatDirty=!1)}worldToScreen(t,e,i,n=new ht){this._updateViewProjMat(),this._viewProjMat.transformPoint(t,n);const s=this._viewProjMat.data,r=t.x*s[3]+t.y*s[7]+t.z*s[11]+1*s[15];return n.x=.5*(n.x/r+1)*e,n.y=.5*(1-n.y/r)*i,n}screenToWorld(t,e,i,n,s,r=new ht){const o=this._farClip-this._nearClip;if(ua.set(t/n,(s-e)/s,i/o),ua.mulScalar(2),ua.sub(ht.ONE),this._projection===Pe){bt._getPerspectiveHalfSize(da,this._fov,this._aspectRatio,this._nearClip,this._horizontalFov),da.x*=ua.x,da.y*=ua.y;const t=this._node.getWorldTransform();da.z=-this._nearClip,t.transformPoint(da,pa);const e=this._node.getPosition();r.sub2(pa,e),r.normalize(),r.mulScalar(i),r.add(e)}else this._updateViewProjMat(),fa.copy(this._viewProjMat).invert(),fa.transformPoint(ua,r);return r}_evaluateProjectionMatrix(){if(this._projMatDirty){if(this._projection===Pe)this._projMat.setPerspective(this._fov,this._aspectRatio,this._nearClip,this._farClip,this._horizontalFov),this._projMatSkybox.copy(this._projMat);else{const t=this._orthoHeight,e=t*this._aspectRatio;this._projMat.setOrtho(-e,e,-t,t,this._nearClip,this._farClip),this._projMatSkybox.setPerspective(this._fov,this._aspectRatio,this._nearClip,this._farClip)}this._projMatDirty=!1}}getProjectionMatrixSkybox(){return this._evaluateProjectionMatrix(),this._projMatSkybox}}const ga=new bt,ba=new ht,ya=new yt,va=new yt,Sa=new ht,xa=new ht,wa=new bt,Ca=new yt,Ta=new ht,Aa=new bt,Ea=new yt,Ma=new yt,Ra=new bt,Ia=new ht,Pa=new ht;class La extends x{constructor(t){super(),this.name="string"==typeof t?t:"Untitled",this.tags=new j(this),this._labels={},this.localPosition=new ht(0,0,0),this.localRotation=new yt(0,0,0,1),this.localScale=new ht(1,1,1),this.localEulerAngles=new ht(0,0,0),this.position=new ht(0,0,0),this.rotation=new yt(0,0,0,1),this.eulerAngles=new ht(0,0,0),this._scale=null,this.localTransform=new bt,this._dirtyLocal=!1,this._aabbVer=0,this._frozen=!1,this.worldTransform=new bt,this._dirtyWorld=!1,this.normalMatrix=new ct,this._dirtyNormal=!0,this._right=null,this._up=null,this._forward=null,this._parent=null,this._children=[],this._graphDepth=0,this._enabled=!0,this._enabledInHierarchy=!1,this.scaleCompensation=!1}get right(){return this._right||(this._right=new ht),this.getWorldTransform().getX(this._right).normalize()}get up(){return this._up||(this._up=new ht),this.getWorldTransform().getY(this._up).normalize()}get forward(){return this._forward||(this._forward=new ht),this.getWorldTransform().getZ(this._forward).normalize().mulScalar(-1)}get enabled(){return this._enabled&&this._enabledInHierarchy}set enabled(t){this._enabled!==t&&(this._enabled=t,this._parent&&!this._parent.enabled||this._notifyHierarchyStateChanged(this,t))}get parent(){return this._parent}get path(){let t=this._parent;if(t){let e=this.name;for(;t&&t._parent;)e=t.name+"/"+e,t=t._parent;return e}return""}get root(){let t=this._parent;if(!t)return this;for(;t._parent;)t=t._parent;return t}get children(){return this._children}get graphDepth(){return this._graphDepth}_notifyHierarchyStateChanged(t,e){t._onHierarchyStateChanged(e);const i=t._children;for(let t=0,n=i.length;t<n;t++)i[t]._enabled&&this._notifyHierarchyStateChanged(i[t],e)}_onHierarchyStateChanged(t){this._enabledInHierarchy=t,t&&!this._frozen&&this._unfreezeParentToRoot()}_cloneInternal(t){t.name=this.name;const e=this.tags._list;t.tags.clear();for(let i=0;i<e.length;i++)t.tags.add(e[i]);t._labels=Object.assign({},this._labels),t.localPosition.copy(this.localPosition),t.localRotation.copy(this.localRotation),t.localScale.copy(this.localScale),t.localEulerAngles.copy(this.localEulerAngles),t.position.copy(this.position),t.rotation.copy(this.rotation),t.eulerAngles.copy(this.eulerAngles),t.localTransform.copy(this.localTransform),t._dirtyLocal=this._dirtyLocal,t.worldTransform.copy(this.worldTransform),t._dirtyWorld=this._dirtyWorld,t._dirtyNormal=this._dirtyNormal,t._aabbVer=this._aabbVer+1,t._enabled=this._enabled,t.scaleCompensation=this.scaleCompensation,t._enabledInHierarchy=!1}clone(){const t=new La;return this._cloneInternal(t),t}copy(t){return t._cloneInternal(this),this}find(t,e){let i,n=[];const s=this._children.length;if(t instanceof Function){const e=t;i=e(this),i&&n.push(this);for(let t=0;t<s;t++){const i=this._children[t].find(e);i.length&&(n=n.concat(i))}}else{let i;this[t]&&(i=this[t]instanceof Function?this[t]():this[t],i===e&&n.push(this));for(let i=0;i<s;++i){const s=this._children[i].find(t,e);s.length&&(n=n.concat(s))}}return n}findOne(t,e){const i=this._children.length;let n=null;if(t instanceof Function){const e=t;if(n=e(this),n)return this;for(let t=0;t<i;t++)if(n=this._children[t].findOne(e),n)return n}else{let s;if(this[t]&&(s=this[t]instanceof Function?this[t]():this[t],s===e))return this;for(let s=0;s<i;s++)if(n=this._children[s].findOne(t,e),null!==n)return n}return null}findByTag(){const t=this.tags._processArguments(arguments);return this._findByTag(t)}_findByTag(t){let e=[];const i=this._children.length;for(let n=0;n<i;n++){this._children[n].tags._has(t)&&e.push(this._children[n]);const i=this._children[n]._findByTag(t);i.length&&(e=e.concat(i))}return e}findByName(t){if(this.name===t)return this;for(let e=0;e<this._children.length;e++){const i=this._children[e].findByName(t);if(null!==i)return i}return null}findByPath(t){let e;if(Array.isArray(t)){if(0===t.length)return null;e=t}else e=t.split("/");let i=this,n=null;for(let t=0,s=e.length;t<s&&i;t++){const s=e[t];n=null;const r=i._children;for(let t=0,e=r.length;t<e;t++)if(r[t].name===s){n=r[t];break}i=n}return n}forEach(t,e){t.call(e,this);const i=this._children;for(let n=0;n<i.length;n++)i[n].forEach(t,e)}isDescendantOf(t){let e=this._parent;for(;e;){if(e===t)return!0;e=e._parent}return!1}isAncestorOf(t){return t.isDescendantOf(this)}getEulerAngles(){return this.getWorldTransform().getEulerAngles(this.eulerAngles),this.eulerAngles}getLocalEulerAngles(){return this.localRotation.getEulerAngles(this.localEulerAngles),this.localEulerAngles}getLocalPosition(){return this.localPosition}getLocalRotation(){return this.localRotation}getLocalScale(){return this.localScale}getLocalTransform(){return this._dirtyLocal&&(this.localTransform.setTRS(this.localPosition,this.localRotation,this.localScale),this._dirtyLocal=!1),this.localTransform}getPosition(){return this.getWorldTransform().getTranslation(this.position),this.position}getRotation(){return this.rotation.setFromMat4(this.getWorldTransform()),this.rotation}getScale(){return this._scale||(this._scale=new ht),this.getWorldTransform().getScale(this._scale)}getWorldTransform(){return this._dirtyLocal||this._dirtyWorld?(this._parent&&this._parent.getWorldTransform(),this._sync(),this.worldTransform):this.worldTransform}reparent(t,e){const i=this._parent;i&&i.removeChild(this),t&&(e>=0?t.insertChild(this,e):t.addChild(this))}setLocalEulerAngles(t,e,i){t instanceof ht?this.localRotation.setFromEulerAngles(t.x,t.y,t.z):this.localRotation.setFromEulerAngles(t,e,i),this._dirtyLocal||this._dirtifyLocal()}setLocalPosition(t,e,i){t instanceof ht?this.localPosition.copy(t):this.localPosition.set(t,e,i),this._dirtyLocal||this._dirtifyLocal()}setLocalRotation(t,e,i,n){t instanceof yt?this.localRotation.copy(t):this.localRotation.set(t,e,i,n),this._dirtyLocal||this._dirtifyLocal()}setLocalScale(t,e,i){t instanceof ht?this.localScale.copy(t):this.localScale.set(t,e,i),this._dirtyLocal||this._dirtifyLocal()}_dirtifyLocal(){this._dirtyLocal||(this._dirtyLocal=!0,this._dirtyWorld||this._dirtifyWorld())}_unfreezeParentToRoot(){let t=this._parent;for(;t;)t._frozen=!1,t=t._parent}_dirtifyWorld(){this._dirtyWorld||this._unfreezeParentToRoot(),this._dirtifyWorldInternal()}_dirtifyWorldInternal(){if(!this._dirtyWorld){this._frozen=!1,this._dirtyWorld=!0;for(let t=0;t<this._children.length;t++)this._children[t]._dirtyWorld||this._children[t]._dirtifyWorldInternal()}this._dirtyNormal=!0,this._aabbVer++}setPosition(t,e,i){t instanceof ht?Ta.copy(t):Ta.set(t,e,i),null===this._parent?this.localPosition.copy(Ta):(Aa.copy(this._parent.getWorldTransform()).invert(),Aa.transformPoint(Ta,this.localPosition)),this._dirtyLocal||this._dirtifyLocal()}setRotation(t,e,i,n){if(t instanceof yt?Ea.copy(t):Ea.set(t,e,i,n),null===this._parent)this.localRotation.copy(Ea);else{const t=this._parent.getRotation();Ma.copy(t).invert(),this.localRotation.copy(Ma).mul(Ea)}this._dirtyLocal||this._dirtifyLocal()}setEulerAngles(t,e,i){if(t instanceof ht?this.localRotation.setFromEulerAngles(t.x,t.y,t.z):this.localRotation.setFromEulerAngles(t,e,i),null!==this._parent){const t=this._parent.getRotation();Ma.copy(t).invert(),this.localRotation.mul2(Ma,this.localRotation)}this._dirtyLocal||this._dirtifyLocal()}addChild(t){if(null!==t._parent)throw new Error("GraphNode is already parented");this._children.push(t),this._onInsertChild(t)}addChildAndSaveTransform(t){const e=t.getPosition(),i=t.getRotation(),n=t._parent;n&&n.removeChild(t),t.setPosition(wa.copy(this.worldTransform).invert().transformPoint(e)),t.setRotation(Ca.copy(this.getRotation()).invert().mul(i)),this._children.push(t),this._onInsertChild(t)}insertChild(t,e){if(null!==t._parent)throw new Error("GraphNode is already parented");this._children.splice(e,0,t),this._onInsertChild(t)}_fireOnHierarchy(t,e,i){this.fire(t,i);for(let t=0;t<this._children.length;t++)this._children[t]._fireOnHierarchy(e,e,i)}_onInsertChild(t){t._parent=this;const e=t._enabled&&this.enabled;t._enabledInHierarchy!==e&&(t._enabledInHierarchy=e,t._notifyHierarchyStateChanged(t,e)),t._updateGraphDepth(),t._dirtifyWorld(),this._frozen&&t._unfreezeParentToRoot(),t._fireOnHierarchy("insert","inserthierarchy",this),this.fire&&this.fire("childinsert",t)}_updateGraphDepth(){this._parent?this._graphDepth=this._parent._graphDepth+1:this._graphDepth=0;for(let t=0,e=this._children.length;t<e;t++)this._children[t]._updateGraphDepth()}removeChild(t){const e=this._children.length;for(let i=0;i<e;++i)if(this._children[i]===t)return this._children.splice(i,1),t._parent=null,t._fireOnHierarchy("remove","removehierarchy",this),void(this.fire&&this.fire("childremove",t))}_sync(){if(this._dirtyLocal&&(this.localTransform.setTRS(this.localPosition,this.localRotation,this.localScale),this._dirtyLocal=!1),this._dirtyWorld){if(null===this._parent)this.worldTransform.copy(this.localTransform);else if(this.scaleCompensation){let t;const e=this._parent;let i=this.localScale,n=e;if(n){for(;n&&n.scaleCompensation;)n=n._parent;n&&(n=n._parent,n&&(t=n.worldTransform.getScale(),Sa.mul2(t,this.localScale),i=Sa))}va.setFromMat4(e.worldTransform),ya.mul2(va,this.localRotation);let s=e.worldTransform;e.scaleCompensation&&(xa.mul2(t,e.getLocalScale()),ga.setTRS(e.worldTransform.getTranslation(ba),va,xa),s=ga),s.transformPoint(this.localPosition,ba),this.worldTransform.setTRS(ba,ya,i)}else this.worldTransform.mulAffine2(this._parent.worldTransform,this.localTransform);this._dirtyWorld=!1}}syncHierarchy(){if(!this._enabled)return;if(this._frozen)return;this._frozen=!0,(this._dirtyLocal||this._dirtyWorld)&&this._sync();const t=this._children;for(let e=0,i=t.length;e<i;e++)t[e].syncHierarchy()}lookAt(t,e,i,n=0,s=1,r=0){if(t instanceof ht)Ia.copy(t),e instanceof ht?Pa.copy(e):Pa.copy(ht.UP);else{if(void 0===i)return;Ia.set(t,e,i),Pa.set(n,s,r)}Ra.setLookAt(this.getPosition(),Ia,Pa),Ea.setFromMat4(Ra),this.setRotation(Ea)}translate(t,e,i){t instanceof ht?Ta.copy(t):Ta.set(t,e,i),Ta.add(this.getPosition()),this.setPosition(Ta)}translateLocal(t,e,i){t instanceof ht?Ta.copy(t):Ta.set(t,e,i),this.localRotation.transformVector(Ta,Ta),this.localPosition.add(Ta),this._dirtyLocal||this._dirtifyLocal()}rotate(t,e,i){if(t instanceof ht?Ea.setFromEulerAngles(t.x,t.y,t.z):Ea.setFromEulerAngles(t,e,i),null===this._parent)this.localRotation.mul2(Ea,this.localRotation);else{const t=this.getRotation(),e=this._parent.getRotation();Ma.copy(e).invert(),Ea.mul2(Ma,Ea),this.localRotation.mul2(Ea,t)}this._dirtyLocal||this._dirtifyLocal()}rotateLocal(t,e,i){t instanceof ht?Ea.setFromEulerAngles(t.x,t.y,t.z):Ea.setFromEulerAngles(t,e,i),this.localRotation.mul(Ea),this._dirtyLocal||this._dirtifyLocal()}}const Da=new bt,ka=new bt,Oa=new bt;class Fa{static create(t,e,i){const n=new ma;switch(n.node=new La(t),n.aspectRatio=1,n.aspectRatioMode=Ji,n._scissorRectClear=!0,e){case ie:n.node.setRotation(Fa.pointLightRotations[i]),n.fov=90,n.projection=Pe;break;case se:n.projection=Pe;break;case ee:n.projection=Le}return n}static evalSpotCookieMatrix(t){let e=Fa._spotCookieCamera;e||(e=Fa.create("SpotCookieCamera",se),Fa._spotCookieCamera=e),e.fov=2*t._outerConeAngle;const i=e._node;i.setPosition(t._node.getPosition()),i.setRotation(t._node.getRotation()),i.rotateLocal(-90,0,0),Da.setTRS(i.getPosition(),i.getRotation(),ht.ONE).invert(),ka.mul2(e.projectionMatrix,Da);const n=t.cookieMatrix,s=t.atlasViewport;return Oa.setViewport(s.x,s.y,s.z,s.w),n.mul2(Oa,ka),n}}Fa.pointLightRotations=[(new yt).setFromEulerAngles(0,90,180),(new yt).setFromEulerAngles(0,-90,180),(new yt).setFromEulerAngles(90,0,0),(new yt).setFromEulerAngles(-90,0,0),(new yt).setFromEulerAngles(0,180,180),(new yt).setFromEulerAngles(0,0,180)],Fa._spotCookieCamera=null;const Ba=new ht,Na=new ht,Ua=new ht,Va=new Tt,za={FLAGS:0,COLOR_A:1,COLOR_B:2,SPOT_ANGLES:3,SHADOW_BIAS:4,COOKIE_A:5,COOKIE_B:6,COUNT_ALWAYS:7,POSITION_X:7,POSITION_Y:8,POSITION_Z:9,RANGE:10,SPOT_DIRECTION_X:11,SPOT_DIRECTION_Y:12,SPOT_DIRECTION_Z:13,PROJ_MAT_00:14,ATLAS_VIEWPORT_A:14,PROJ_MAT_01:15,ATLAS_VIEWPORT_B:15,PROJ_MAT_02:16,PROJ_MAT_03:17,PROJ_MAT_10:18,PROJ_MAT_11:19,PROJ_MAT_12:20,PROJ_MAT_13:21,PROJ_MAT_20:22,PROJ_MAT_21:23,PROJ_MAT_22:24,PROJ_MAT_23:25,PROJ_MAT_30:26,PROJ_MAT_31:27,PROJ_MAT_32:28,PROJ_MAT_33:29,COUNT:30},Wa={POSITION_RANGE:0,SPOT_DIRECTION:1,PROJ_MAT_0:2,ATLAS_VIEWPORT:2,PROJ_MAT_1:3,PROJ_MAT_2:4,PROJ_MAT_3:5,COUNT:6};class Ga{constructor(){this.light=null,this.min=new ht,this.max=new ht}}class ja{static init(t){ja.lightTextureFormat=t.extTextureFloat?ja.FORMAT_FLOAT:ja.FORMAT_8BIT,ja.initShaderDefines()}static initShaderDefines(){const t=ja.lightTextureFormat===ja.FORMAT_FLOAT?"FLOAT":"8BIT";ja.shaderDefines=`\n\t\t\t\t\t\t\n#define CLUSTER_TEXTURE_${t}\n\t\t\t\t\t\t${ja.buildShaderDefines(za,"CLUSTER_TEXTURE_8_")}\n\t\t\t\t\t\t${ja.buildShaderDefines(Wa,"CLUSTER_TEXTURE_F_")}\n\t\t\t\t`}static buildShaderDefines(t,e){let i="";return Object.keys(t).forEach(n=>{i+=`\n#define ${e}${n} ${t[n]}.5`}),i}constructor(t,e,i,n=!1,s=!1){this.device=t,this.name="Untitled",this.cookiesEnabled=n,this.shadowsEnabled=s,this.reportCount=0,this._bounds=new Tt,this.boundsMin=new ht,this.boundsMax=new ht,this.boundsDelta=new ht,this._cells=new ht,this._cellsLimit=new ht,this.cells=e,this._maxCellLightCount=0,this._pixelsPerCellCount=0,this.maxCellLightCount=i,this._maxAttenuation=0,this._maxColorValue=0,this._usedLights=[],this._usedLights.push(new Ga),this.registerUniforms(t),this.initLightsTexture()}destroy(){this.lightsTexture8&&(this.lightsTexture8.destroy(),this.lightsTexture8=null),this.lightsTextureFloat&&(this.lightsTextureFloat.destroy(),this.lightsTextureFloat=null),this.releaseClusterTexture()}releaseClusterTexture(){this.clusterTexture&&(this.clusterTexture.destroy(),this.clusterTexture=null)}registerUniforms(t){this._clusterWorldTextureId=t.scope.resolve("clusterWorldTexture"),this._clusterPixelsPerCellId=t.scope.resolve("clusterPixelsPerCell"),this._clusterTextureSizeId=t.scope.resolve("clusterTextureSize"),this._clusterTextureSizeData=new Float32Array(3),this._clusterBoundsMinId=t.scope.resolve("clusterBoundsMin"),this._clusterBoundsMinData=new Float32Array(3),this._clusterBoundsDeltaId=t.scope.resolve("clusterBoundsDelta"),this._clusterBoundsDeltaData=new Float32Array(3),this._clusterCellsCountByBoundsSizeId=t.scope.resolve("clusterCellsCountByBoundsSize"),this._clusterCellsCountByBoundsSizeData=new Float32Array(3),this._clusterCellsDotId=t.scope.resolve("clusterCellsDot"),this._clusterCellsDotData=new Float32Array(3),this._clusterCellsMaxId=t.scope.resolve("clusterCellsMax"),this._clusterCellsMaxData=new Float32Array(3),this._clusterCompressionLimit0Id=t.scope.resolve("clusterCompressionLimit0"),this._clusterCompressionLimit0Data=new Float32Array(2)}get maxCellLightCount(){return this._maxCellLightCount}set maxCellLightCount(t){const e=Z.roundUp(t,4);e!==this._maxCellLightCount&&(this._maxCellLightCount=e,this._pixelsPerCellCount=this._maxCellLightCount/4,this._cellsDirty=!0)}get cells(){return this._cells}set cells(t){Ba.copy(t).floor(),this._cells.equals(Ba)||(this._cells.copy(Ba),this._cellsLimit.copy(Ba).sub(ht.ONE),this._cellsDirty=!0)}createTexture(t,e,i){return new _a(this.device,{width:t,height:e,mipmaps:!1,format:i,addressU:pn,addressV:pn,type:Ur,magFilter:Kn,minFilter:Kn,anisotropy:1})}initLightsTexture(){this.maxLights=255;let t=za.COUNT_ALWAYS,e=0;ja.lightTextureFormat===ja.FORMAT_FLOAT?e=Wa.COUNT:t=za.COUNT,this.lights8=new Uint8ClampedArray(4*t*this.maxLights),this.lightsTexture8=this.createTexture(t,this.maxLights,ys),this._lightsTexture8Id=this.device.scope.resolve("lightsTexture8"),e?(this.lightsFloat=new Float32Array(4*e*this.maxLights),this.lightsTextureFloat=this.createTexture(e,this.maxLights,As),this._lightsTextureFloatId=this.device.scope.resolve("lightsTextureFloat")):(this.lightsFloat=null,this.lightsTextureFloat=null,this._lightsTextureFloatId=void 0),this._lightsTextureInvSizeId=this.device.scope.resolve("lightsTextureInvSize"),this._lightsTextureInvSizeData=new Float32Array(4),this._lightsTextureInvSizeData[0]=e?1/this.lightsTextureFloat.width:0,this._lightsTextureInvSizeData[1]=e?1/this.lightsTextureFloat.height:0,this._lightsTextureInvSizeData[2]=1/this.lightsTexture8.width,this._lightsTextureInvSizeData[3]=1/this.lightsTexture8.height}getSpotDirection(t,e){e._node.getWorldTransform().getY(t).mulScalar(-1),t.normalize()}addLightDataFlags(t,e,i,n){t[e+0]=n?255:0,t[e+1]=255*i._shape,t[e+2]=255*i._falloffMode,t[e+3]=i.castShadows?255:0}addLightDataColor(t,e,i,n,s){const r=1/this._maxColorValue,o=n?i._linearFinalColor:i._finalColor;la.float2Bytes(o[0]*r,t,e+0,2),la.float2Bytes(o[1]*r,t,e+2,2),la.float2Bytes(o[2]*r,t,e+4,2),t[e+6]=s?255:0}addLightDataSpotAngles(t,e,i){la.float2Bytes(.499999*i._innerConeAngleCos+.5,t,e+0,2),la.float2Bytes(.499999*i._outerConeAngleCos+.5,t,e+2,2)}addLightDataShadowBias(t,e,i){const n=i.getRenderData(null,0),s=i._getUniformBiasValues(n);la.float2BytesRange(s.bias,t,e,-1,20,2),la.float2Bytes(s.normalBias,t,e+2,2)}addLightDataPositionRange(t,e,i,n){const s=Ba.sub2(n,this.boundsMin).div(this.boundsDelta);la.float2Bytes(s.x,t,e+0,4),la.float2Bytes(s.y,t,e+4,4),la.float2Bytes(s.z,t,e+8,4),la.float2Bytes(i.attenuationEnd/this._maxAttenuation,t,e+12,4)}addLightDataSpotDirection(t,e,i){this.getSpotDirection(Ba,i),la.float2Bytes(.499999*Ba.x+.5,t,e+0,4),la.float2Bytes(.499999*Ba.y+.5,t,e+4,4),la.float2Bytes(.499999*Ba.z+.5,t,e+8,4)}addLightDataLightProjMatrix(t,e,i){const n=i.data;for(let i=0;i<12;i++)la.float2BytesRange(n[i],t,e+4*i,-2,2,4);for(let i=12;i<16;i++)la.float2MantisaExponent(n[i],t,e+4*i,4)}addLightDataCookies(t,e,i){const n="rgb"===i._cookieChannel;if(t[e+0]=Math.floor(255*i.cookieIntensity),t[e+1]=n?255:0,!n){const n=i._cookieChannel;t[e+4]="rrr"===n?255:0,t[e+5]="ggg"===n?255:0,t[e+6]="bbb"===n?255:0,t[e+7]="aaa"===n?255:0}}addLightAtlasViewport(t,e,i){la.float2Bytes(i.x,t,e+0,2),la.float2Bytes(i.y,t,e+2,2),la.float2Bytes(i.z/3,t,e+4,2)}addLightData(t,e,i){const n=t._type===se,s=this.cookiesEnabled&&!!t._cookie,r=this.shadowsEnabled&&t.castShadows,o=t._node.getPosition();let a=null,l=null;if(n)if(r){a=t.getRenderData(null,0).shadowMatrix}else s&&(a=Fa.evalSpotCookieMatrix(t));else(r||s)&&(l=t.atlasViewport);const h=this.lights8,c=e*this.lightsTexture8.width*4;if(this.addLightDataFlags(h,c+4*za.FLAGS,t,n),this.addLightDataColor(h,c+4*za.COLOR_A,t,i,s),n&&this.addLightDataSpotAngles(h,c+4*za.SPOT_ANGLES,t),t.castShadows&&this.addLightDataShadowBias(h,c+4*za.SHADOW_BIAS,t),s&&this.addLightDataCookies(h,c+4*za.COOKIE_A,t),ja.lightTextureFormat===ja.FORMAT_FLOAT){const i=this.lightsFloat,s=e*this.lightsTextureFloat.width*4;if(i[s+4*Wa.POSITION_RANGE+0]=o.x,i[s+4*Wa.POSITION_RANGE+1]=o.y,i[s+4*Wa.POSITION_RANGE+2]=o.z,i[s+4*Wa.POSITION_RANGE+3]=t.attenuationEnd,n&&(this.getSpotDirection(Ba,t),i[s+4*Wa.SPOT_DIRECTION+0]=Ba.x,i[s+4*Wa.SPOT_DIRECTION+1]=Ba.y,i[s+4*Wa.SPOT_DIRECTION+2]=Ba.z),a){const t=a.data;for(let e=0;e<16;e++)i[s+4*Wa.PROJ_MAT_0+e]=t[e]}l&&(i[s+4*Wa.ATLAS_VIEWPORT+0]=l.x,i[s+4*Wa.ATLAS_VIEWPORT+1]=l.y,i[s+4*Wa.ATLAS_VIEWPORT+2]=l.z/3)}else this.addLightDataPositionRange(h,c+4*za.POSITION_X,t,o),n&&this.addLightDataSpotDirection(h,c+4*za.SPOT_DIRECTION_X,t),a&&this.addLightDataLightProjMatrix(h,c+4*za.PROJ_MAT_00,a),l&&this.addLightAtlasViewport(h,c+4*za.ATLAS_VIEWPORT_A,l)}updateCells(){if(this._cellsDirty){this._cellsDirty=!1;const t=this._cells.x,e=this._cells.y,i=this._cells.z,n=t*e*i,s=this._pixelsPerCellCount*n;let r=Math.ceil(Math.sqrt(s));r=Z.roundUp(r,this._pixelsPerCellCount);const o=Math.ceil(s/r);this._clusterCellsMaxData[0]=t,this._clusterCellsMaxData[1]=e,this._clusterCellsMaxData[2]=i,this._clusterCellsDotData[0]=this._pixelsPerCellCount,this._clusterCellsDotData[1]=t*i*this._pixelsPerCellCount,this._clusterCellsDotData[2]=t*this._pixelsPerCellCount,this.clusters=new Uint8ClampedArray(4*s),this.counts=new Int32Array(n),this._clusterTextureSizeData[0]=r,this._clusterTextureSizeData[1]=1/r,this._clusterTextureSizeData[2]=1/o,this.releaseClusterTexture(),this.clusterTexture=this.createTexture(r,o,ys)}}uploadTextures(){let t=this.clusterTexture.lock();t.set(this.clusters),this.clusterTexture.unlock(),this.lightsTextureFloat&&(t=this.lightsTextureFloat.lock(),t.set(this.lightsFloat),this.lightsTextureFloat.unlock()),t=this.lightsTexture8.lock(),t.set(this.lights8),this.lightsTexture8.unlock()}updateUniforms(){this._clusterWorldTextureId.setValue(this.clusterTexture),this._lightsTexture8Id.setValue(this.lightsTexture8),ja.lightTextureFormat===ja.FORMAT_FLOAT&&this._lightsTextureFloatId.setValue(this.lightsTextureFloat);const t=this.boundsDelta;this._clusterCellsCountByBoundsSizeData[0]=this._cells.x/t.x,this._clusterCellsCountByBoundsSizeData[1]=this._cells.y/t.y,this._clusterCellsCountByBoundsSizeData[2]=this._cells.z/t.z,this._clusterCellsCountByBoundsSizeId.setValue(this._clusterCellsCountByBoundsSizeData),this._clusterBoundsMinData[0]=this.boundsMin.x,this._clusterBoundsMinData[1]=this.boundsMin.y,this._clusterBoundsMinData[2]=this.boundsMin.z,this._clusterBoundsDeltaData[0]=t.x,this._clusterBoundsDeltaData[1]=t.y,this._clusterBoundsDeltaData[2]=t.z,this._clusterCompressionLimit0Data[0]=this._maxAttenuation,this._clusterCompressionLimit0Data[1]=this._maxColorValue,this._clusterPixelsPerCellId.setValue(this._pixelsPerCellCount),this._lightsTextureInvSizeId.setValue(this._lightsTextureInvSizeData),this._clusterTextureSizeId.setValue(this._clusterTextureSizeData),this._clusterBoundsMinId.setValue(this._clusterBoundsMinData),this._clusterBoundsDeltaId.setValue(this._clusterBoundsDeltaData),this._clusterCellsDotId.setValue(this._clusterCellsDotData),this._clusterCellsMaxId.setValue(this._clusterCellsMaxData),this._clusterCompressionLimit0Id.setValue(this._clusterCompressionLimit0Data)}evalLightCellMinMax(t,e,i){e.copy(t.min),e.sub(this.boundsMin),e.div(this.boundsDelta),e.mul2(e,this.cells),e.floor(),i.copy(t.max),i.sub(this.boundsMin),i.div(this.boundsDelta),i.mul2(i,this.cells),i.ceil(),e.max(ht.ZERO),i.min(this._cellsLimit)}collectLights(t){const e=this._usedLights;let i=1;for(let n=0;n<t.length;n++){const s=t[n];if(s.enabled&&s.type!==ee&&s.visibleThisFrame&&s.intensity>0){if(!(i<this.maxLights)){console.warn("Clustered lighting: more than "+(this.maxLights-1)+" lights in the frame, ignoring some.");break}{let t;i<e.length?t=e[i]:(t=new Ga,e.push(t)),t.light=s,s.getBoundingBox(Va),t.min.copy(Va.getMin()),t.max.copy(Va.getMax()),i++}}}e.length=i}evaluateBounds(){const t=this._usedLights,e=this.boundsMin,i=this.boundsMax;if(t.length>1){e.copy(t[1].min),i.copy(t[1].max);for(let n=2;n<t.length;n++)e.min(t[n].min),i.max(t[n].max)}else e.set(0,0,0),i.set(1,1,1);this.boundsDelta.sub2(i,e)}evaluateCompressionLimits(t){let e=0,i=0;const n=this._usedLights;for(let s=1;s<n.length;s++){const r=n[s].light;e=Math.max(r.attenuationEnd,e);const o=t?r._linearFinalColor:r._finalColor;i=Math.max(o[0],i),i=Math.max(o[1],i),i=Math.max(o[2],i)}this._maxAttenuation=e+1e-6,this._maxColorValue=i+1e-6}updateClusters(t){this.counts.fill(0),this.clusters.fill(0);const e=this._cells.x,i=this._cells.z,n=this.counts,s=this._maxCellLightCount,r=this.clusters,o=this._pixelsPerCellCount,a=this._usedLights;for(let l=1;l<a.length;l++){const h=a[l],c=h.light;this.addLightData(c,l,t),this.evalLightCellMinMax(h,Na,Ua);const _=Na.x,u=Ua.x,d=Na.y,p=Ua.y,f=Na.z,m=Ua.z;for(let t=_;t<=u;t++)for(let a=f;a<=m;a++)for(let h=d;h<=p;h++){const c=t+e*(a+h*i),_=n[c];_<s&&(r[o*c*4+_]=l,n[c]=_+1)}}}update(t,e){this.updateCells(),this.collectLights(t),this.evaluateBounds(),this.evaluateCompressionLimits(e),this.updateClusters(e),this.uploadTextures()}activate(){this.updateUniforms()}}ja.FORMAT_FLOAT=0,ja.FORMAT_8BIT=1,ja.lightTextureFormat=ja.FORMAT_8BIT,ja.shaderDefines="";const Ha=function(t,e){if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0};class Xa{constructor(){this.layerIndex=0,this.cameraIndex=0,this.camera=null,this.renderTarget=null,this.lightClusters=null,this.clearColor=!1,this.clearDepth=!1,this.clearStencil=!1,this.triggerPostprocess=!1,this.firstCameraUse=!1,this.directionalLightsSet=new Set,this.directionalLights=[],this.directionalLightsIndices=[]}reset(){this.lightClusters=null,this.directionalLightsSet.clear(),this.directionalLights.length=0,this.directionalLightsIndices.length=0}collectDirectionalLights(t,e,i){this.directionalLightsSet.clear(),this.directionalLights.length=0,this.directionalLightsIndices.length=0;for(let n=0;n<e.length;n++){const s=e[n];if(s.castShadows)for(let e=0;e<t.length;e++)if(t[e]._splitLights[ee].indexOf(s)>=0&&!this.directionalLightsSet.has(s)){this.directionalLightsSet.add(s),this.directionalLights.push(s);const t=i.indexOf(s);this.directionalLightsIndices.push(t)}}}}class Ya{constructor(){this.shadowCastersSet=new Set,this.shadowCastersList=[]}clearShadowCasters(){this.shadowCastersSet.clear(),this.shadowCastersList.length=0}addShadowCasters(t){for(let e=0;e<t.length;e++){const i=t[e];this.shadowCastersSet.has(i)||(this.shadowCastersSet.add(i),this.shadowCastersList.push(i))}}}let qa;function Ka(){return qa}function Za(t){qa=t}const Qa=new Set,$a=[];class Ja extends x{constructor(t,e="Untitled"){var i;super(),"string"==typeof t&&(e=t=null),this.device=t||(null==(i=Ka())?void 0:i.graphicsDevice),this.name=e,this.logRenderActions=!1,this.layerList=[],this.subLayerList=[],this.subLayerEnabled=[],this._opaqueOrder={},this._transparentOrder={},this._dirty=!1,this._dirtyBlend=!1,this._dirtyLights=!1,this._dirtyCameras=!1,this._meshInstances=[],this._meshInstancesSet=new Set,this._lights=[],this._lightsMap=new Map,this._lightCompositionData=[],this._splitLights=[[],[],[]],this.cameras=[],this._renderActions=[],this._worldClusters=[],this._emptyWorldClusters=null,this._clusteredLightingCells=new ht(10,3,10),this._clusteredLightingMaxLights=64,this._clusteredLightingCookiesEnabled=!0,this._clusteredLightingShadowsEnabled=!0}destroy(){this._emptyWorldClusters&&(this._emptyWorldClusters.destroy(),this._emptyWorldClusters=null),this._worldClusters.forEach(t=>t.destroy()),this._worldClusters=null}get clusteredLightingCells(){return this._clusteredLightingCells}set clusteredLightingCells(t){this._clusteredLightingCells.equals(t)||(this._clusteredLightingCells.copy(t),this.updateWorldClusters())}get clusteredLightingMaxLights(){return this._clusteredLightingMaxLights}set clusteredLightingMaxLights(t){this._clusteredLightingMaxLights!==t&&(this._clusteredLightingMaxLights=t,this.updateWorldClusters())}get clusteredLightingCookiesEnabled(){return this._clusteredLightingCookiesEnabled}set clusteredLightingCookiesEnabled(t){this._clusteredLightingCookiesEnabled!==t&&(this._clusteredLightingCookiesEnabled=t,this._dirtyLights=!0,this.updateWorldClusters())}get clusteredLightingShadowsEnabled(){return this._clusteredLightingShadowsEnabled}set clusteredLightingShadowsEnabled(t){this._clusteredLightingShadowsEnabled!==t&&(this._clusteredLightingShadowsEnabled=t,this._dirtyLights=!0,this.updateWorldClusters())}updateWorldClusters(){this._worldClusters.forEach(t=>{t.cells=this._clusteredLightingCells,t.maxCellLightCount=this._clusteredLightingMaxLights,t.cookiesEnabled=this._clusteredLightingCookiesEnabled,t.shadowsEnabled=this._clusteredLightingShadowsEnabled})}get emptyWorldClusters(){return this._emptyWorldClusters||(this._emptyWorldClusters=new ja(this.device,new ht(1,1,1),4),this._emptyWorldClusters.name="ClusterEmpty",this._emptyWorldClusters.update([],!1)),this._emptyWorldClusters}_splitLightsArray(t){var e,i=t._lights;t._splitLights[ee].length=0,t._splitLights[ie].length=0,t._splitLights[se].length=0;for(var n=0;n<i.length;n++)(e=i[n]).enabled&&t._splitLights[e._type].push(e)}_update(){var t,e,i,n,s,r=this.layerList.length,o=0;if(!this._dirty||!this._dirtyLights||!this._dirtyCameras)for(t=0;t<r;t++)(i=this.layerList[t])._dirty&&(this._dirty=!0),i._dirtyLights&&(this._dirtyLights=!0),i._dirtyCameras&&(this._dirtyCameras=!0);function a(t,e,i){for(var n,s,r=!1,o=i.length,a=0;a<o;a++)n=i[a],e.has(n)||(e.add(n),t.push(n),(s=n.material)&&s._dirtyBlend&&(r=!0,s._dirtyBlend=!1));return r}if(this._dirty){for(o|=qi,this._meshInstances.length=0,this._meshInstancesSet.clear(),t=0;t<r;t++)(i=this.layerList[t]).passThrough||(this._dirtyBlend=a(this._meshInstances,this._meshInstancesSet,i.opaqueMeshInstances)||this._dirtyBlend,this._dirtyBlend=a(this._meshInstances,this._meshInstancesSet,i.transparentMeshInstances)||this._dirtyBlend),i._dirty=!1;this._dirty=!1}function l(t,e,i){for(var n,s=0;s<e.length;)((n=e[s].material)&&n.blendType!==Lt)===i?(t.push(e[s]),e[s]=e[e.length-1],e.length--):s++}if(this._dirtyBlend){for(o|=Qi,t=0;t<r;t++)(i=this.layerList[t]).passThrough||(l(i.opaqueMeshInstances,i.transparentMeshInstances,!1),l(i.transparentMeshInstances,i.opaqueMeshInstances,!0));this._dirtyBlend=!1}if(this._dirtyLights&&(o|=Ki,this._dirtyLights=!1,this.updateLights()),o&&this.updateShadowCasters(),this._dirtyCameras||o&Ki){for(this._dirtyCameras=!1,o|=Zi,this.cameras.length=0,t=0;t<r;t++)for((i=this.layerList[t])._dirtyCameras=!1,e=0;e<i.cameras.length;e++)n=i.cameras[e],this.cameras.indexOf(n)<0&&this.cameras.push(n);this.cameras.length>1&&this.cameras.sort((t,e)=>t.priority-e.priority);const a=[];var h=0;for(t=0;t<this.cameras.length;t++){n=this.cameras[t],a.length=0;let o=!0;const l=h;let c=null,_=!1;for(e=0;e<r;e++)(i=this.layerList[e])&&i.cameras.length>0&&n.layers.indexOf(i.id)>=0&&(a.push(i),_||i.id!==n.disablePostEffectsLayer||(_=!0,c&&(c.triggerPostprocess=!0)),(s=i.cameras.indexOf(n))>=0&&(c=this.addRenderAction(this._renderActions,h,i,e,s,o,_),h++,o=!1));l<h&&this._renderActions[l].collectDirectionalLights(a,this._splitLights[ee],this._lights),!_&&c&&(c.triggerPostprocess=!0),n.renderTarget&&n.postEffectsEnabled&&this.propagateRenderTarget(l-1,n)}this._renderActions.length=h,Ja.clusteredLightingEnabled&&this.allocateLightClusters()}return(o&Ki||o&Zi)&&this._logRenderActions(),o}updateShadowCasters(){const t=this._lights.length;for(let e=0;e<t;e++)this._lightCompositionData[e].clearShadowCasters();const e=this.layerList.length;for(let t=0;t<e;t++){const e=this.layerList[t];if(!Qa.has(e)){Qa.add(e);const t=e._lights;for(let i=0;i<t.length;i++)if(t[i].castShadows){const n=this._lightsMap.get(t[i]);this._lightCompositionData[n].addShadowCasters(e.shadowCasters)}}}Qa.clear()}updateLights(){this._lights.length=0,this._lightsMap.clear();const t=this.layerList.length;for(let e=0;e<t;e++){const t=this.layerList[e];if(!Qa.has(t)){Qa.add(t);const e=t._lights;for(let t=0;t<e.length;t++){const i=e[t];let n=this._lightsMap.get(i);if(void 0===n){n=this._lights.length,this._lightsMap.set(i,n),this._lights.push(i);let t=this._lightCompositionData[n];t||(t=new Ya,this._lightCompositionData[n]=t)}}}this._splitLightsArray(t),t._dirtyLights=!1}Qa.clear(),this._splitLightsArray(this);const e=this._lights.length;this._lightCompositionData.length=e}findCompatibleCluster(t,e){for(let i=0;i<e;i++){const e=this._renderActions[i],n=this.layerList[e.layerIndex];if(t===n)return e.lightClusters;if(e.lightClusters&&Ha(t._clusteredLightsSet,n._clusteredLightsSet))return e.lightClusters}return null}allocateLightClusters(){$a.push(...this._worldClusters),this._worldClusters.length=0;const t=this._renderActions.length;for(let e=0;e<t;e++){const t=this._renderActions[e],i=this.layerList[t.layerIndex];if(i._clusteredLightsSet.size){if((this.subLayerList[t.layerIndex]?i.transparentMeshInstances:i.opaqueMeshInstances).length){let n=this.findCompatibleCluster(i,e);n||($a.length&&(n=$a.pop()),n||(n=new ja(this.device,this._clusteredLightingCells,this._clusteredLightingMaxLights,this._clusteredLightingCookiesEnabled,this._clusteredLightingShadowsEnabled)),n.name="Cluster-"+this._worldClusters.length,this._worldClusters.push(n)),t.lightClusters=n}}t.lightClusters||(t.lightClusters=this.emptyWorldClusters)}$a.forEach(t=>t.destroy()),$a.length=0}addRenderAction(t,e,i,n,s,r,o){let a=t[e];a||(a=t[e]=new Xa);let l=i.renderTarget;const h=i.cameras[s];h&&h.renderTarget&&i.id!==Qt&&(l=h.renderTarget);let c=!1;for(let i=e-1;i>=0;i--)if(t[i].camera===h&&t[i].renderTarget===l){c=!0;break}const _=r||!c;let u=!!_&&h.clearColorBuffer,d=!!_&&h.clearDepthBuffer,p=!!_&&h.clearStencilBuffer;return u|=i.clearColorBuffer,d|=i.clearDepthBuffer,p|=i.clearStencilBuffer,o&&h.postEffectsEnabled&&(l=null),a.reset(),a.triggerPostprocess=!1,a.layerIndex=n,a.cameraIndex=s,a.camera=h,a.renderTarget=l,a.clearColor=u,a.clearDepth=d,a.clearStencil=p,a.firstCameraUse=r,a}propagateRenderTarget(t,e){for(let i=t;i>=0;i--){const t=this._renderActions[i],n=this.layerList[t.layerIndex];if(t.renderTarget&&n.id!==Qt)break;if(n.id===Qt)continue;const s=null==t?void 0:t.camera.camera;if(s&&(!e.camera.rect.equals(s.rect)||!e.camera.scissorRect.equals(s.scissorRect)))break;t.renderTarget=e.renderTarget}}_logRenderActions(){}_isLayerAdded(t){return this.layerList.indexOf(t)>=0}_isSublayerAdded(t,e){for(var i=0;i<this.layerList.length;i++)if(this.layerList[i]===t&&this.subLayerList[i]===e)return!0;return!1}push(t){this._isLayerAdded(t)||(this.layerList.push(t),this.layerList.push(t),this._opaqueOrder[t.id]=this.subLayerList.push(!1)-1,this._transparentOrder[t.id]=this.subLayerList.push(!0)-1,this.subLayerEnabled.push(!0),this.subLayerEnabled.push(!0),this._dirty=!0,this._dirtyLights=!0,this._dirtyCameras=!0,this.fire("add",t))}insert(t,e){if(!this._isLayerAdded(t)){this.layerList.splice(e,0,t,t),this.subLayerList.splice(e,0,!1,!0);var i=this.layerList.length;this._updateOpaqueOrder(e,i-1),this._updateTransparentOrder(e,i-1),this.subLayerEnabled.splice(e,0,!0,!0),this._dirty=!0,this._dirtyLights=!0,this._dirtyCameras=!0,this.fire("add",t)}}remove(t){var e=this.layerList.indexOf(t);for(delete this._opaqueOrder[e],delete this._transparentOrder[e];e>=0;)this.layerList.splice(e,1),this.subLayerList.splice(e,1),this.subLayerEnabled.splice(e,1),e=this.layerList.indexOf(t),this._dirty=!0,this._dirtyLights=!0,this._dirtyCameras=!0,this.fire("remove",t);var i=this.layerList.length;this._updateOpaqueOrder(0,i-1),this._updateTransparentOrder(0,i-1)}pushOpaque(t){this._isSublayerAdded(t,!1)||(this.layerList.push(t),this._opaqueOrder[t.id]=this.subLayerList.push(!1)-1,this.subLayerEnabled.push(!0),this._dirty=!0,this._dirtyLights=!0,this._dirtyCameras=!0,this.fire("add",t))}insertOpaque(t,e){if(!this._isSublayerAdded(t,!1)){this.layerList.splice(e,0,t),this.subLayerList.splice(e,0,!1);var i=this.subLayerList.length;this._updateOpaqueOrder(e,i-1),this.subLayerEnabled.splice(e,0,!0),this._dirty=!0,this._dirtyLights=!0,this._dirtyCameras=!0,this.fire("add",t)}}removeOpaque(t){for(var e=0,i=this.layerList.length;e<i;e++)if(this.layerList[e]===t&&!this.subLayerList[e])return this.layerList.splice(e,1),this.subLayerList.splice(e,1),i--,this._updateOpaqueOrder(e,i-1),this.subLayerEnabled.splice(e,1),this._dirty=!0,this._dirtyLights=!0,this._dirtyCameras=!0,void(this.layerList.indexOf(t)<0&&this.fire("remove",t))}pushTransparent(t){this._isSublayerAdded(t,!0)||(this.layerList.push(t),this._transparentOrder[t.id]=this.subLayerList.push(!0)-1,this.subLayerEnabled.push(!0),this._dirty=!0,this._dirtyLights=!0,this._dirtyCameras=!0,this.fire("add",t))}insertTransparent(t,e){if(!this._isSublayerAdded(t,!0)){this.layerList.splice(e,0,t),this.subLayerList.splice(e,0,!0);var i=this.subLayerList.length;this._updateTransparentOrder(e,i-1),this.subLayerEnabled.splice(e,0,!0),this._dirty=!0,this._dirtyLights=!0,this._dirtyCameras=!0,this.fire("add",t)}}removeTransparent(t){for(var e=0,i=this.layerList.length;e<i;e++)if(this.layerList[e]===t&&this.subLayerList[e])return this.layerList.splice(e,1),this.subLayerList.splice(e,1),i--,this._updateTransparentOrder(e,i-1),this.subLayerEnabled.splice(e,1),this._dirty=!0,this._dirtyLights=!0,this._dirtyCameras=!0,void(this.layerList.indexOf(t)<0&&this.fire("remove",t))}_getSublayerIndex(t,e){var i=this.layerList.indexOf(t);if(i<0)return-1;if(this.subLayerList[i]!==e){if((i=this.layerList.indexOf(t,i+1))<0)return-1;if(this.subLayerList[i]!==e)return-1}return i}getOpaqueIndex(t){return this._getSublayerIndex(t,!1)}getTransparentIndex(t){return this._getSublayerIndex(t,!0)}getLayerById(t){for(var e=0;e<this.layerList.length;e++)if(this.layerList[e].id===t)return this.layerList[e];return null}getLayerByName(t){for(var e=0;e<this.layerList.length;e++)if(this.layerList[e].name===t)return this.layerList[e];return null}_updateOpaqueOrder(t,e){for(var i=t;i<=e;i++)!1===this.subLayerList[i]&&(this._opaqueOrder[this.layerList[i].id]=i)}_updateTransparentOrder(t,e){for(var i=t;i<=e;i++)!0===this.subLayerList[i]&&(this._transparentOrder[this.layerList[i].id]=i)}_sortLayersDescending(t,e,i){var n=0,s=0,r=0,o=-1,a=-1;for(n=0,s=t.length;n<s;n++)r=t[n],i.hasOwnProperty(r)&&(o=Math.max(o,i[r]));for(n=0,s=e.length;n<s;n++)r=e[n],i.hasOwnProperty(r)&&(a=Math.max(a,i[r]));return-1===o&&-1!==a?1:-1===a&&-1!==o?-1:a-o}sortTransparentLayers(t,e){return this._sortLayersDescending(t,e,this._transparentOrder)}sortOpaqueLayers(t,e){return this._sortLayersDescending(t,e,this._opaqueOrder)}}Ja.clusteredLightingEnabled=!1;var tl=function(t,e,i){return"\n#ifdef MAPFLOAT\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"},el=function(t,e,i){return"\n#ifdef MAPCOLOR\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"},il=function(t,e,i){return"\n#ifdef MAPTEXTURE\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"},nl=function(t,e,i){return"#undef MAPTEXTURECOLOR\n#ifdef MAPTEXTURE\n#ifdef MAPCOLOR\n#define MAPTEXTURECOLOR\n#endif\n#endif\n#ifdef MAPTEXTURECOLOR\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"},sl=function(t,e,i){return"#undef MAPTEXTUREFLOAT\n#ifdef MAPTEXTURE\n#ifdef MAPFLOAT\n#define MAPTEXTUREFLOAT\n#endif\n#endif\n#ifdef MAPTEXTUREFLOAT\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"},rl=function(t,e,i){return"\n#ifdef MAPVERTEX\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"},ol=function(t,e,i){return"#undef MAPVERTEXCOLOR\n#ifdef MAPVERTEX\n#ifdef MAPCOLOR\n#define MAPVERTEXCOLOR\n#endif\n#endif\n#ifdef MAPVERTEXCOLOR\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"},al=function(t,e,i){return"#undef MAPVERTEXFLOAT\n#ifdef MAPVERTEX\n#ifdef MAPFLOAT\n#define MAPVERTEXFLOAT\n#endif\n#endif\n#ifdef MAPVERTEXFLOAT\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"},ll=[],hl={_oldChunkToNew:{aoTexPS:{n:"aoPS",f:il},aoVertPS:{n:"aoPS",f:rl},diffuseConstPS:{n:"diffusePS",f:el},diffuseTexPS:{n:"diffusePS",f:il},diffuseTexConstPS:{n:"diffusePS",f:nl},diffuseVertPS:{n:"diffusePS",f:rl},diffuseVertConstPS:{n:"diffusePS",f:ol},emissiveConstPS:{n:"emissivePS",f:el},emissiveTexPS:{n:"emissivePS",f:il},emissiveTexConstPS:{n:"emissivePS",f:nl},emissiveTexConstFloatPS:{n:"emissivePS",f:sl},emissiveVertPS:{n:"emissivePS",f:rl},emissiveVertConstPS:{n:"emissivePS",f:ol},emissiveVertConstFloatPS:{n:"emissivePS",f:al},glossConstPS:{n:"glossPS",f:tl},glossTexPS:{n:"glossPS",f:il},glossTexConstPS:{n:"glossPS",f:sl},glossVertPS:{n:"glossPS",f:rl},glossVertConstPS:{n:"glossPS",f:al},metalnessConstPS:{n:"metalnessPS",f:tl},metalnessTexPS:{n:"metalnessPS",f:il},metalnessTexConstPS:{n:"metalnessPS",f:sl},metalnessVertPS:{n:"metalnessPS",f:rl},metalnessVertConstPS:{n:"metalnessPS",f:al},opacityConstPS:{n:"opacityPS",f:tl},opacityTexPS:{n:"opacityPS",f:il},opacityTexConstPS:{n:"opacityPS",f:sl},opacityVertPS:{n:"opacityPS",f:rl},opacityVertConstPS:{n:"opacityPS",f:al},specularConstPS:{n:"specularPS",f:el},specularTexPS:{n:"specularPS",f:il},specularTexConstPS:{n:"specularPS",f:nl},specularVertPS:{n:"specularPS",f:rl},specularVertConstPS:{n:"specularPS",f:ol},transformBatchSkinnedVS:{n:"transformVS",f:function(t,e,i){return"\n#ifdef DYNAMICBATCH\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"}},transformInstancedVS:{n:"transformVS",f:function(t,e,i){return"\n#ifdef INSTANCING\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"}},transformPixelSnapVS:{n:"transformVS",f:function(t,e,i){return"\n#ifdef PIXELSNAP\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"}},transformScreenSpaceVS:{n:"transformVS",f:function(t,e,i){return"\n#ifdef SCREENSPACE\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"}},transformScreenSpaceBatchSkinned:{n:"transformVS",f:function(t,e,i){return"#undef SCREENSPACEBATCH\n#ifdef SCREENSPACE\n#ifdef BATCH\n#define SCREENSPACEBATCH\n#endif\n#endif\n#ifdef SCREENSPACEBATCH\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"}},transformSkinned:{n:"transformVS",f:function(t,e,i){return"\n#ifdef SKIN\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"}},transformUv1:{n:"transformVS",f:function(t,e,i){return"\n#ifdef UV1LAYOUT\n"+t+"\n#else\n"+jo[e]+"\n#endif\n"}}},optionsContext:{},optionsContextMin:{},generateKey:function(t){var e,i=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&"chunks"!==i&&"lights"!==i&&e.push(i);return e.sort()};t===this.optionsContextMin?(this.propsMin||(this.propsMin=i(t)),e=this.propsMin):t===this.optionsContext?(this.props||(this.props=i(t)),e=this.props):e=i(t);var n,s="standard";for(n=0;n<e.length;n++)t[e[n]]&&(s+=e[n]+t[e[n]]);if(t.chunks){var r=[];for(var o in t.chunks)t.chunks.hasOwnProperty(o)&&r.push(o+t.chunks[o]);r.sort(),s+=r}if(t.lights)for(n=0;n<t.lights.length;n++)s+=t.lights[n].key;return Bo(s)},_correctChannel:function(t,e){if(ll[t]>0){if(ll[t]<e.length)return e.substring(0,ll[t]);if(ll[t]>e.length){for(var i=e,n=i.charAt(i.length-1),s=ll[t]-i.length,r=0;r<s;r++)i+=n;return i}return e}},_setMapTransform:function(t,e,i,n){const s=`texture_${e}MapTransform`,r=i+100*n;return t[0]+=`uniform vec3 ${s}0;\n`,t[0]+=`uniform vec3 ${s}1;\n`,t[3][r]||(t[1]+=`varying vec2 vUV${n}_${i};\n`,t[2]+=`\t vUV${n}_${i} = vec2(dot(vec3(uv${n}, 1), ${s}0), dot(vec3(uv${n}, 1), ${s}1));\n`,t[3][r]=!0),t},_getUvSourceExpression:function(t,e,i){var n,s=i[t],r=i[e],o=i.pass===Ri||i.pass===Ii;return o&&i.nineSlicedMode===Oi?n="nineSlicedUv":o&&i.nineSlicedMode===Fi?n="nineSlicedUv, -1000.0":(n=0===s?"vUv"+r:"vUV"+r+"_"+s,i.heightMap&&"heightMapTransform"!==t&&(n+=" + dUvOffset")),n},_addMapDef:function(t,e){var i="\n#undef "+t+"\n";return e&&(i+=" #define "+t+"\n"),i},_addMapDefs:function(t,e,i,n){var s="";return s+=this._addMapDef("MAPFLOAT",t),s+=this._addMapDef("MAPCOLOR",e),s+=this._addMapDef("MAPVERTEX",i),s+=this._addMapDef("MAPTEXTURE",n)},_addMap:function(t,e,i,n,s){var r=t+"Map",o=r+"Uv",a=r+"Transform",l=r+"Channel",h=t+"VertexColorChannel",c=t+"VertexColor",_=t+"Mode",u=i[t+"Tint"],d=i[c],p=i[r],f=i[_],m=n[e];if(p){var g=this._getUvSourceExpression(a,o,i);if(m=m.replace(/\$UV/g,g).replace(/\$CH/g,i[l]),void 0!==s){var b=0===s?"texture2DSRGB":1===s?"texture2DRGBM":"texture2D";m=m.replace(/\$texture2DSAMPLE/g,b)}}d&&(m=m.replace(/\$VC/g,i[h])),f&&(m=m.replace(/\$DETAILMODE/g,f));var y=1===u,v=3===u;return(m=this._addMapDefs(y,v,d,p)+m).replace(/\$/g,"")},_directionalShadowMapProjection:function(t,e,i,n,s){let r="";return t.numCascades>1&&(r+=`getShadowCascadeMatrix(light${n}_shadowMatrixPalette, light${n}_shadowCascadeDistances, light${n}_shadowCascadeCount);\n`,e=`(cascadeShadowMat, ${i});\n`),r+=s+e,r+=`fadeShadow(light${n}_shadowCascadeDistances);\n`,r},_nonPointShadowMapProjection:function(t,e,i,n,s){const r=`(${i}, ${n});\n`;return!e._normalOffsetBias||e._isVsm?e._type===se?e._isPcf&&(t.webgl2||t.extStandardDerivatives)?"\t\t\t getShadowCoordPerspZbuffer"+r:"\t\t\t getShadowCoordPersp"+r:this._directionalShadowMapProjection(e,r,n,s,"getShadowCoordOrtho"):e._type===se?e._isPcf&&(t.webgl2||t.extStandardDerivatives)?"\t\t\t getShadowCoordPerspZbufferNormalOffset"+r:"\t\t\t getShadowCoordPerspNormalOffset"+r:this._directionalShadowMapProjection(e,r,n,s,"getShadowCoordOrthoNormalOffset")},_addVaryingIfNeeded:function(t,e,i){return t.indexOf(i)>=0?"varying "+e+" "+i+";\n":""},_getLightSourceShapeString:function(t){switch(t){case oe:return"Rect";case ae:return"Disk";case le:return"Sphere";default:return""}},_vsAddTransformCode:function(t,e,i,n){return t+=i.transformVS},_vsAddBaseCode:function(t,e,i,n){return t+=i.baseVS,n.nineSlicedMode!==Oi&&n.nineSlicedMode!==Fi||(t+=i.baseNineSlicedVS),t},_fsAddBaseCode:function(t,e,i,n){return t+=i.basePS,n.nineSlicedMode===Oi?t+=i.baseNineSlicedPS:n.nineSlicedMode===Fi&&(t+=i.baseNineSlicedTiledPS),t},_fsAddStartCode:function(t,e,i,n){return t+=i.startPS,n.nineSlicedMode===Oi?t+=i.startNineSlicedPS:n.nineSlicedMode===Fi&&(t+=i.startNineSlicedTiledPS),t},_buildShadowPassFragmentCode:function(t,e,i,n,s){const r=Ja.clusteredLightingEnabled,o=n.pass-Li,a=ge,l=Math.floor(o/a),h=o-l*a;e.extStandardDerivatives&&!e.webgl2&&(t+="uniform vec2 polygonOffset;\n"),h===fe?e.textureFloatHighPrecision?t+="#define VSM_EXPONENT 15.0\n\n":t+="#define VSM_EXPONENT 5.54\n\n":h===pe&&(t+="#define VSM_EXPONENT 5.54\n\n"),l!==ee&&(t+="uniform vec3 view_position;\n",t+="uniform float light_radius;\n"),t+=s,n.alphaTest&&(t+="float dAlpha;\n",t+=this._addMap("opacity","opacityPS",n,i),t+=i.alphaTestPS),h!==_e||e.webgl2&&l!==ie?h===de&&(t+="vec2 encodeFloatRG( float v ) {\n",t+="\t\tvec2 enc = vec2(1.0, 255.0) * v;\n",t+="\t\tenc = fract(enc);\n",t+="\t\tenc -= enc.yy * vec2(1.0/255.0, 1.0/255.0);\n",t+="\t\treturn enc;\n",t+="}\n\n"):t+=i.packDepthPS,t+="void main(void)\n{\n",n.alphaTest&&(t+="\t getOpacity();\n",t+="\t alphaTest(dAlpha);\n");return t+=l===ie||(h===de||h===pe||h===fe)&&l!==ee?"\t float depth = min(distance(view_position, vPositionW) / light_radius, 0.99999);\n":"\t float depth = gl_FragCoord.z;\n",h!==_e||e.webgl2&&(l!==ie||r)?h===_e||h===me?(t+="\t gl_FragColor = vec4(1.0);\n",r&&l===ie&&e.webgl2&&(t+="\t gl_FragDepth = depth;\n")):t+=h===de?"\t gl_FragColor = vec4(encodeFloatRG(depth), encodeFloatRG(depth*depth));\n":i.storeEVSMPS:e.extStandardDerivatives&&!e.webgl2?(t+="\t float minValue = 2.3374370500153186e-10; //(1.0 / 255.0) / (256.0 * 256.0 * 256.0);\n",t+="\t depth += polygonOffset.x * max(abs(dFdx(depth)), abs(dFdy(depth))) + minValue * polygonOffset.y;\n",t+="\t gl_FragColor = packFloat(depth);\n"):t+="\t gl_FragColor = packFloat(depth);\n",t+="}\n"},createShaderDefinition:function(t,e){var i,n,s=e.lights.length>0;e.dirLightMap&&(s=!0),Ja.clusteredLightingEnabled&&(s=!0),e.shadingModel===Ne?(e.fresnelModel=0,e.specularAntialias=!1,e.prefilteredCubemap=!1,e.dpAtlas=!1,e.ambientSH=!1):e.fresnelModel=0===e.fresnelModel?Ht:e.fresnelModel;var r=(e.cubeMap||e.prefilteredCubemap&&e.useSpecular)&&!e.sphereMap&&!e.dpAtlas,o=e.sphereMap||r||e.dpAtlas,a=e.useTexCubeLod;e.cubeMap&&(e.sphereMap=null),e.dpAtlas&&(e.prefilteredCubemap=null),e.useSpecular||(e.specularMap=e.glossMap=null);var l=s||o||e.ambientSH||e.prefilteredCubemap||e.heightMap||e.enableGGXSpecular,h=e.pass>=Li&&e.pass<=17;this.options=e;var c,_,u,d="",p="",f="",m=jo,g={vertex_position:Zs};if(e.chunks){var b,y={};for(n in m)m.hasOwnProperty(n)&&(e.chunks[n]?((u=e.chunks[n]).indexOf("vertex_normal")>=0&&(g.vertex_normal=Qs),u.indexOf("vertex_tangent")>=0&&(g.vertex_tangent=$s),u.indexOf("vertex_texCoord0")>=0&&(g.vertex_texCoord0=nr),u.indexOf("vertex_texCoord1")>=0&&(g.vertex_texCoord1=sr),u.indexOf("vertex_color")>=0&&(g.vertex_color=er),u.indexOf("vertex_boneWeights")>=0&&(g.vertex_boneWeights=Js),u.indexOf("vertex_boneIndices")>=0&&(g.vertex_boneIndices=tr),y[n]=u):y[n]=m[n]);for(n in e.chunks)(b=this._oldChunkToNew[n])&&(y[b.n]=b.f(e.chunks[n],b.n,n));m=y}d=this._vsAddBaseCode(d,t,m,e),p+="\t vPositionW\t\t= getWorldPosition();\n",e.pass===Pi&&(d+="varying float vDepth;\n",d+="#ifndef VIEWMATRIX\n",d+="#define VIEWMATRIX\n",d+="uniform mat4 matrix_view;\n",d+="#endif\n",d+="#ifndef CAMERAPLANES\n",d+="#define CAMERAPLANES\n",d+="uniform vec4 camera_params;\n\n",d+="#endif\n",p+="\t\tvDepth = -(matrix_view * vec4(vPositionW,1.0)).z * camera_params.x;\n"),e.useInstancing&&(g.instance_line1=Cr,g.instance_line2=Tr,g.instance_line3=Ar,g.instance_line4=Er,d+=m.instancingVS),l&&(g.vertex_normal=Qs,p+="\t vNormalW = getNormal();\n",e.sphereMap&&t.fragmentUniformsCount<=16&&(d+=m.viewNormalVS,p+="\t vNormalV\t\t= getViewNormal();\n"),(e.heightMap||e.normalMap||e.enableGGXSpecular)&&e.hasTangents?(g.vertex_tangent=$s,d+=m.tangentBinormalVS,p+="\t vTangentW\t = getTangent();\n",p+="\t vBinormalW\t= getBinormal();\n"):e.enableGGXSpecular&&(d+=m.tangentBinormalVS,p+="\t vObjectSpaceUpW\t= getObjectSpaceUp();\n"));var v,S,x,w,C=[],T=[];for(n in ll)if(S=n+"Map",e[n+"VertexColor"]&&(e[v=n+"VertexColorChannel"]=this._correctChannel(n,e[v])),e[S]){v=S+"Channel",x=S+"Transform",e[w=S+"Uv"]=Math.min(e[w],1),e[v]=this._correctChannel(n,e[v]);var A=e[w];C[A]=!0,T[A]=T[A]||e[S]&&!e[x]}for(e.forceUv1&&(C[1]=!0,T[1]=void 0===T[1]||T[1]),i=0;i<2;i++)C[i]&&(g["vertex_texCoord"+i]="TEXCOORD"+i,d+=m["uv"+i+"VS"],p+="\t vec2 uv"+i+" = getUv"+i+"();\n"),T[i]&&(p+="\t vUv"+i+" = uv"+i+";\n");var E=[d,f,p,[]];for(n in ll)e[S=n+"Map"]&&e[x=S+"Transform"]&&(w=S+"Uv",this._setMapTransform(E,n,e[x],e[w]));d=E[0],f=E[1],p=E[2],e.vertexColors&&(g.vertex_color=er,p+="\t vVertexColor = vertex_color;\n"),(e.useMorphPosition||e.useMorphNormal)&&(e.useMorphTextureBased?(d+="#define MORPHING_TEXTURE_BASED\n",e.useMorphPosition&&(d+="#define MORPHING_TEXTURE_BASED_POSITION\n"),e.useMorphNormal&&(d+="#define MORPHING_TEXTURE_BASED_NORMAL\n"),g.morph_vertex_id=Er,d+="attribute float morph_vertex_id;\n"):(d+="#define MORPHING\n",e.useMorphPosition?(g.morph_pos0=vr,g.morph_pos1=Sr,g.morph_pos2=xr,g.morph_pos3=wr,d+="#define MORPHING_POS03\n",d+="attribute vec3 morph_pos0;\n",d+="attribute vec3 morph_pos1;\n",d+="attribute vec3 morph_pos2;\n",d+="attribute vec3 morph_pos3;\n"):e.useMorphNormal&&(g.morph_nrm0=vr,g.morph_nrm1=Sr,g.morph_nrm2=xr,g.morph_nrm3=wr,d+="#define MORPHING_NRM03\n",d+="attribute vec3 morph_nrm0;\n",d+="attribute vec3 morph_nrm1;\n",d+="attribute vec3 morph_nrm2;\n",d+="attribute vec3 morph_nrm3;\n"),e.useMorphNormal?(g.morph_nrm4=Cr,g.morph_nrm5=Tr,g.morph_nrm6=Ar,g.morph_nrm7=Er,d+="#define MORPHING_NRM47\n",d+="attribute vec3 morph_nrm4;\n",d+="attribute vec3 morph_nrm5;\n",d+="attribute vec3 morph_nrm6;\n",d+="attribute vec3 morph_nrm7;\n"):(g.morph_pos4=Cr,g.morph_pos5=Tr,g.morph_pos6=Ar,g.morph_pos7=Er,d+="#define MORPHING_POS47\n",d+="attribute vec3 morph_pos4;\n",d+="attribute vec3 morph_pos5;\n",d+="attribute vec3 morph_pos6;\n",d+="attribute vec3 morph_pos7;\n"))),e.skin?(g.vertex_boneWeights=Js,g.vertex_boneIndices=tr,d+=qo(t,m),d+="#define SKIN\n"):e.useInstancing&&(d+="#define INSTANCING\n"),e.screenSpace&&(d+="#define SCREENSPACE\n"),e.pixelSnap&&(d+="#define PIXELSNAP\n"),d=this._vsAddTransformCode(d,t,m,e),l&&(d+=m.normalVS),d+="\n",d+=m.startVS,d+=p,d+=m.endVS;var M=d+="}",R=f;f="",f+=this._addVaryingIfNeeded(d,"vec4","vVertexColor"),f+=this._addVaryingIfNeeded(d,"vec3","vPositionW"),f+=this._addVaryingIfNeeded(d,"vec3","vNormalV"),f+=this._addVaryingIfNeeded(d,"vec3","vNormalW"),f+=this._addVaryingIfNeeded(d,"vec3","vTangentW"),f+=this._addVaryingIfNeeded(d,"vec3","vBinormalW"),f+=this._addVaryingIfNeeded(d,"vec3","vObjectSpaceUpW"),f+=this._addVaryingIfNeeded(d,"vec2","vUv0"),f+=this._addVaryingIfNeeded(d,"vec2","vUv1"),M=(f+=R)+M;var I="";if(t.webgl2?(I=Zo(t),m.extensionVS&&(I+=m.extensionVS+"\n"),M=I+m.gles3VS+M):(m.extensionVS&&(I=m.extensionVS+"\n"),M=I+M),e.forceFragmentPrecision&&"highp"!==e.forceFragmentPrecision&&"mediump"!==e.forceFragmentPrecision&&"lowp"!==e.forceFragmentPrecision&&(e.forceFragmentPrecision=null),e.forceFragmentPrecision&&("highp"===e.forceFragmentPrecision&&"highp"!==t.maxPrecision&&(e.forceFragmentPrecision="mediump"),"mediump"===e.forceFragmentPrecision&&"lowp"===t.maxPrecision&&(e.forceFragmentPrecision="lowp")),d="",t.webgl2&&(d+=Zo(t)),t.extStandardDerivatives&&!t.webgl2&&(d+="#extension GL_OES_standard_derivatives : enable\n\n"),m.extensionPS&&(d+=m.extensionPS+"\n"),t.webgl2&&(d+=m.gles3PS),d+=e.forceFragmentPrecision?"precision "+e.forceFragmentPrecision+" float;\n\n":Ko(t),e.pass===Di)return d+="uniform vec4 uColor;\n",d+=f,e.alphaTest&&(d+="float dAlpha;\n",d+=this._addMap("opacity","opacityPS",e,m),d+=m.alphaTestPS),d+="void main(void)\n{\n",e.alphaTest&&(d+="\t getOpacity();\n",d+="\t alphaTest(dAlpha);\n"),d+="\t\tgl_FragColor = uColor;\n",{attributes:g,vshader:M,fshader:d+="}\n"};if(e.pass===Pi)return d+="varying float vDepth;\n",d+=f,d+=m.packDepthPS,e.alphaTest&&(d+="float dAlpha;\n",d+=this._addMap("opacity","opacityPS",e,m),d+=m.alphaTestPS),d+="void main(void)\n{\n",e.alphaTest&&(d+="\t getOpacity();\n",d+="\t alphaTest(dAlpha);\n"),d+="\t\tgl_FragColor = packFloat(vDepth);\n",{attributes:g,vshader:M,fshader:d+="}\n"};if(h)return{attributes:g,vshader:M,fshader:this._buildShadowPassFragmentCode(d,t,m,e,f)};if(e.customFragmentShader)return{attributes:g,vshader:M,fshader:d+e.customFragmentShader,tag:Mr};d+=f,d=this._fsAddBaseCode(d,t,m,e),e.detailModes&&(d+=m.detailModesPS);var P=d;d="",e.clearCoat>0&&(d+="#define CLEARCOAT\n"),!1===e.opacityFadesSpecular&&(d+="uniform float material_alphaFade;\n");var L,D=0,k=[],O=!1,F=!1,B=!1;const N=Ja.clusteredLightingEnabled;var U=e.lights.some((function(t){return t._shape&&t._shape!==re}));t.areaLightLutFormat===ys?(d+="#define AREA_R8_G8_B8_A8_LUTS\n",d+="#define AREA_LUTS_PRECISION lowp\n"):d+="#define AREA_LUTS_PRECISION highp\n",U&&(d+="#define AREA_LIGHTS\n",d+="uniform AREA_LUTS_PRECISION sampler2D areaLightsLutTex1;\n",d+="uniform AREA_LUTS_PRECISION sampler2D areaLightsLutTex2;\n");var V,z=re;for(i=0;i<e.lights.length;i++)c=(L=e.lights[i])._type,N&&c!==ee||(z=U&&L._shape?L._shape:re,d+="uniform vec3 light"+i+"_color;\n",c===ee?d+="uniform vec3 light"+i+"_direction;\n":(d+="uniform vec3 light"+i+"_position;\n",d+="uniform float light"+i+"_radius;\n",c===se&&(d+="uniform vec3 light"+i+"_direction;\n",d+="uniform float light"+i+"_innerConeAngle;\n",d+="uniform float light"+i+"_outerConeAngle;\n")),z!==re&&(c===ee&&(d+="uniform vec3 light"+i+"_position;\n"),d+="uniform vec3 light"+i+"_halfWidth;\n",d+="uniform vec3 light"+i+"_halfHeight;\n"),L.castShadows&&!e.noShadow&&(d+="uniform mat4 light"+i+"_shadowMatrix;\n",c===ee&&(d+="uniform mat4 light"+i+"_shadowMatrixPalette[4];\n",d+="uniform float light"+i+"_shadowCascadeDistances[4];\n",d+="uniform float light"+i+"_shadowCascadeCount;\n"),c!==ee?d+="uniform vec4 light"+i+"_shadowParams;\n":(O=!0,d+="uniform vec3 light"+i+"_shadowParams;\n"),c===ie?d+="uniform samplerCube light"+i+"_shadowMap;\n":L._isPcf&&t.webgl2?d+="uniform sampler2DShadow light"+i+"_shadowMap;\n":d+="uniform sampler2D light"+i+"_shadowMap;\n",D++,k[L._shadowType]=!0,L._isVsm&&(F=!0),L._isPcf&&(t.webgl2||t.extStandardDerivatives)&&c===se&&(B=!0)),L._cookie&&(L._cookie._cubemap?c===ie&&(d+="uniform samplerCube light"+i+"_cookie;\n",d+="uniform float light"+i+"_cookieIntensity;\n",L.castShadows&&!e.noShadow||(d+="uniform mat4 light"+i+"_shadowMatrix;\n")):c===se&&(d+="uniform sampler2D light"+i+"_cookie;\n",d+="uniform float light"+i+"_cookieIntensity;\n",L.castShadows&&!e.noShadow||(d+="uniform mat4 light"+i+"_shadowMatrix;\n"),L._cookieTransform&&(d+="uniform vec4 light"+i+"_cookieMatrix;\n",d+="uniform vec2 light"+i+"_cookieOffset;\n"))));if(d+="\n",V=!e.hasTangents&&t.extStandardDerivatives?m.TBNderivativePS:e.fastTbn?m.TBNfastPS:m.TBNPS,l)if(e.normalMap||e.clearCoatNormalMap){if(d+=e.packedNormal?m.normalXYPS:m.normalXYZPS,!e.hasTangents){const t=e.normalMap?"normalMapTransform":"clearCoatNormalMapTransform",i=this._getUvSourceExpression(t,"normalMapUv",e);V=V.replace(/\$UV/g,i)}d+=V}else e.enableGGXSpecular&&!e.heightMap&&(d+=m.normalVertexPS,d+=m.TBNObjectSpacePS);if(l)if(e.normalMap){e.normalDetail&&(d+=this._addMap("normalDetail","normalDetailMapPS",e,m));var W=this._getUvSourceExpression("normalMapTransform","normalMapUv",e);e.normalizeNormalMap?d+=m.normalMapPS.replace(/\$UV/g,W):d+=m.normalMapFastPS.replace(/\$UV/g,W)}else e.enableGGXSpecular&&!e.heightMap||(d+=m.normalVertexPS);if(d+=Ho(e.gamma,m),d+=Xo(e.toneMap,m),d+=Yo(e.fog,m),e.useRgbm&&(d+=m.rgbmPS),(r||e.prefilteredCubemap)&&(d+=e.fixSeams?m.fixCubemapSeamsStretchPS:m.fixCubemapSeamsNonePS),e.useCubeMapRotation&&(d+="#define CUBEMAP_ROTATION\n"),e.useRightHandedCubeMap&&(d+="#define RIGHT_HANDED_CUBEMAP\n"),l&&(d+=m.cubeMapRotatePS,d+=e.cubeMapProjection>0?m.cubeMapProjectBoxPS:m.cubeMapProjectNonePS,d+=e.skyboxIntensity?m.envMultiplyPS:m.envConstPS),e.diffuseDetail&&(d+=this._addMap("diffuseDetail","diffuseDetailMapPS",e,m)),d+=this._addMap("diffuse","diffusePS",e,m),(e.blendType!==Lt||e.alphaTest||e.alphaToCoverage)&&(d+=this._addMap("opacity","opacityPS",e,m)),d+=this._addMap("emissive","emissivePS",e,m,e.emissiveFormat),s&&e.useSpecular||o){e.specularAntialias&&e.normalMap?e.normalizeNormalMap&&l?d+=m.specularAaToksvigPS:d+=m.specularAaToksvigFastPS:d+=m.specularAaNonePS;var G=e.useMetalness?"metalness":"specular";d+=this._addMap(G,G+"PS",e,m),d+=this._addMap("gloss","glossPS",e,m),e.fresnelModel===Ht&&(d+=m.fresnelSchlickPS)}if(e.clearCoat>0&&(d+=this._addMap("clearCoat","clearCoatPS",e,m),d+=this._addMap("clearCoatGloss","clearCoatGlossPS",e,m),d+=this._addMap("clearCoatNormal","clearCoatNormalPS",e,m)),e.heightMap){if(!e.normalMap){var j=this._getUvSourceExpression("heightMapTransform","heightMapUv",e);e.hasTangents||(V=V.replace(/\$UV/g,j)),d+=V}d+=this._addMap("height","parallaxPS",e,m)}var H=e.aoMap||e.aoVertexColor;H&&(d+=this._addMap("ao","aoPS",e,m),e.occludeSpecular&&(e.occludeSpecular===ii?d+=e.occludeSpecularFloat?m.aoSpecOccSimplePS:m.aoSpecOccConstSimplePS:d+=e.occludeSpecularFloat?m.aoSpecOccPS:m.aoSpecOccConstPS));var X=e.rgbmReflection?"decodeRGBM":e.hdrReflection?"":"gammaCorrectInput";if(e.sphereMap){var Y=t.fragmentUniformsCount>16?m.reflectionSpherePS:m.reflectionSphereLowPS;d+=Y=Y.replace(/\$texture2DSAMPLE/g,e.rgbmReflection?"texture2DRGBM":e.hdrReflection?"texture2D":"texture2DSRGB")}else r?e.prefilteredCubemap?d+=a?m.reflectionPrefilteredCubeLodPS.replace(/\$DECODE/g,X):m.reflectionPrefilteredCubePS.replace(/\$DECODE/g,X):d+=m.reflectionCubePS.replace(/\$textureCubeSAMPLE/g,e.rgbmReflection?"textureCubeRGBM":e.hdrReflection?"textureCube":"textureCubeSRGB"):e.dpAtlas&&(d+=m.reflectionDpAtlasPS.replace(/\$texture2DSAMPLE/g,e.rgbmReflection?"texture2DRGBM":e.hdrReflection?"texture2D":"texture2DSRGB"));(r||e.sphereMap||e.dpAtlas)&&(e.clearCoat>0&&(d+=m.reflectionCCPS),e.refraction&&(d+=m.refractionPS)),Ja.clusteredLightingEnabled&&(d+=m.clusteredLightUtilsPS,d+=m.clusteredLightCookiesPS,k[_e]=!0,B=!0),(D>0||Ja.clusteredLightingEnabled)&&(O&&(d+=m.shadowCascadesPS),k[_e]&&(d+=m.shadowStandardPS),k[me]&&(d+=m.shadowStandardGL2PS),F&&(d+=m.shadowVSM_commonPS,k[de]&&(d+=m.shadowVSM8PS),k[pe]&&(d+=t.extTextureHalfFloatLinear?m.shadowEVSMPS.replace(/\$/g,"16"):m.shadowEVSMnPS.replace(/\$/g,"16")),k[fe]&&(d+=t.extTextureFloatLinear?m.shadowEVSMPS.replace(/\$/g,"32"):m.shadowEVSMnPS.replace(/\$/g,"32"))),t.webgl2||t.extStandardDerivatives||(d+=m.biasConstPS),d+=m.shadowCoordPS+m.shadowCommonPS,B&&(d+=m.shadowCoordPerspZbufferPS)),Ja.clusteredLightingEnabled&&(d+=m.clusteredLightShadowsPS),e.enableGGXSpecular&&(d+="uniform float material_anisotropy;\n"),s&&(d+=m.lightDiffuseLambertPS,U&&(d+=m.ltc));var q=!1;e.useSpecular?(s&&(d+=e.shadingModel===Ne?m.lightSpecularPhongPS:e.enableGGXSpecular?m.lightSpecularAnisoGGXPS:m.lightSpecularBlinnPS),e.sphereMap||r||e.dpAtlas||e.fresnelModel>0?e.fresnelModel>0?e.conserveEnergy&&!U?d+=m.combineDiffuseSpecularPS:d+=m.combineDiffuseSpecularNoConservePS:d+=m.combineDiffuseSpecularOldPS:e.diffuseMap?d+=m.combineDiffuseSpecularNoReflPS:(d+=m.combineDiffuseSpecularNoReflSeparateAmbientPS,q=!0)):d+=m.combineDiffusePS,e.clearCoat>0&&(d+=m.combineClearCoatPS);var K=!0;if(e.lightMap||e.lightVertexColor){var Z=e.dirLightMap&&e.useSpecular?"lightmapDirPS":"lightmapSinglePS";d+=this._addMap("light",Z,e,m,e.lightMapFormat),K=e.lightMapWithoutAmbient}if(K){var Q=e.rgbmAmbient?"decodeRGBM":e.hdrAmbient?"":"gammaCorrectInput";e.ambientSH?d+=m.ambientSHPS:e.prefilteredCubemap?d+=a?m.ambientPrefilteredCubeLodPS.replace(/\$DECODE/g,Q):m.ambientPrefilteredCubePS.replace(/\$DECODE/g,Q):d+=m.ambientConstantPS}e.ambientTint&&!q&&(d+="uniform vec3 material_ambient;\n"),e.alphaTest&&(d+=m.alphaTestPS),e.msdf&&(d+=m.msdfPS),l&&(d+=m.viewDirPS,e.useSpecular&&(d+=e.enableGGXSpecular?m.reflDirAnisoPS:m.reflDirPS));var $,J=!1,tt=!1,et=!1,it=!1,nt=!1;Ja.clusteredLightingEnabled&&(it=!0,J=!0,tt=!0,nt=!0,d+=m.floatUnpackingPS,e.clusteredLightingCookiesEnabled&&(d+="\n#define CLUSTER_COOKIES"),e.clusteredLightingShadowsEnabled&&(d+="\n#define CLUSTER_SHADOWS"),d+=ja.shaderDefines,d+=m.clusteredLightPS),e.twoSidedLighting&&(d+="uniform float twoSidedLightingNegScaleFactor;\n"),d=this._fsAddStartCode(d,t,m,e),l&&(e.hasTangents||!t.extStandardDerivatives||e.fastTbn?e.twoSidedLighting?d+="\t dVertexNormalW = gl_FrontFacing ? vNormalW * twoSidedLightingNegScaleFactor : -vNormalW * twoSidedLightingNegScaleFactor;\n":d+="\t dVertexNormalW = vNormalW;\n":e.twoSidedLighting?d+="\t dVertexNormalW = normalize(gl_FrontFacing ? vNormalW * twoSidedLightingNegScaleFactor : -vNormalW * twoSidedLightingNegScaleFactor);\n":d+="\t dVertexNormalW = normalize(vNormalW);\n",(e.heightMap||e.normalMap)&&e.hasTangents&&(e.twoSidedLighting?(d+="\t dTangentW = gl_FrontFacing ? vTangentW * twoSidedLightingNegScaleFactor : -vTangentW * twoSidedLightingNegScaleFactor;\n",d+="\t dBinormalW = gl_FrontFacing ? vBinormalW * twoSidedLightingNegScaleFactor : -vBinormalW * twoSidedLightingNegScaleFactor;\n"):(d+="\t dTangentW = vTangentW;\n",d+="\t dBinormalW = vBinormalW;\n")));var st=!1;e.blendType!==Lt||e.alphaTest||e.alphaToCoverage?e.heightMap&&e.opacityMap?st=!0:(d+="\t getOpacity();\n",e.alphaTest&&(d+="\t alphaTest(dAlpha);\n")):d+="\t dAlpha = 1.0;\n";var rt=!1;if(l&&(d+="\t getViewDir();\n",(e.heightMap||e.normalMap||e.clearCoatNormalMap||e.enableGGXSpecular)&&(d+="\t getTBN();\n"),e.heightMap&&(d+="\t getParallax();\n"),st&&(d+="\t getOpacity();\n",e.alphaTest&&(d+="\t alphaTest(dAlpha);\n")),d+="\t getNormal();\n",e.useSpecular&&(e.enableGGXSpecular&&(d+="\t getGlossiness();\n",rt=!0),d+="\t getReflDir();\n")),d+="\t getAlbedo();\n",e.clearCoat>0&&(d+="\t getClearCoat();\n",d+="\t getClearCoatGlossiness();\n",d+="\t getClearCoatNormal();\n"),(s&&e.useSpecular||o)&&(d+="\t getSpecularity();\n",rt||(d+="\t getGlossiness();\n"),U&&(d+="\t #ifdef AREA_LIGHTS\n",d+="\t dSpecularityNoFres = dSpecularity;\n",d+="\t #ifdef CLEARCOAT\n",d+="\t ccSpecularityNoFres = ccSpecularity;\n",d+="\t #endif\n",d+="\t #endif\n"),e.fresnelModel>0&&(d+="\t getFresnel();\n")),K&&(d+="\t addAmbient();\n",e.separateAmbient&&(d+="\n\t\t\t\t\t\t\t\t\t\tvec3 dAmbientLight = dDiffuseLight;\n\t\t\t\t\t\t\t\t\t\tdDiffuseLight = vec3(0);\n\t\t\t\t\t\t\t\t")),e.ambientTint&&!q&&(d+="\t dDiffuseLight *= material_ambient;\n"),H&&!e.occludeDirect&&(d+="\t\tapplyAO();\n"),(e.lightMap||e.lightVertexColor)&&(d+="\t addLightMap();\n"),s||o){(r||e.sphereMap||e.dpAtlas)&&(e.clearCoat>0&&(d+="\t addReflectionCC();\n"),d+="\t addReflection();\n"),U&&(d+="\t ccReflection.rgb *= ccSpecularity;\n",d+="\t dReflection.rgb *= dSpecularity;\n",d+="\t dSpecularLight *= dSpecularity;\n",d+="\t float roughness = max((1.0 - dGlossiness) * (1.0 - dGlossiness), 0.001);\n");var ot="";for(Ja.clusteredLightingEnabled&&(tt=!0,J=!0,d+="\t addClusteredLights();"),i=0;i<e.lights.length;i++)if(c=(L=e.lights[i])._type,!Ja.clusteredLightingEnabled||c===ee){if($=!1,U&&L._shape?(z=L._shape,ot=this._getLightSourceShapeString(z)):(z=re,ot=""),z!==re&&(d+="\t calc"+ot+"LightValues(light"+i+"_position, light"+i+"_halfWidth, light"+i+"_halfHeight);\n"),c===ee?(d+="\t dLightDirNormW = light"+i+"_direction;\n",d+="\t dAtten = 1.0;\n"):(L._cookie&&(c!==se||L._cookie._cubemap?c===ie&&L._cookie._cubemap&&(nt=!0,$=!0):(nt=!0,$=!0)),d+="\t getLightDirPoint(light"+i+"_position);\n",J=!0,$&&(d+=c===se?"\t dAtten3 = getCookie2D"+(L._cookieFalloff?"":"Clip")+(L._cookieTransform?"Xform":"")+"(light"+i+"_cookie, light"+i+"_shadowMatrix, light"+i+"_cookieIntensity"+(L._cookieTransform?", light"+i+"_cookieMatrix, light"+i+"_cookieOffset":"")+")."+L._cookieChannel+";\n":"\t dAtten3 = getCookieCube(light"+i+"_cookie, light"+i+"_shadowMatrix, light"+i+"_cookieIntensity)."+L._cookieChannel+";\n"),z===re?L._falloffMode===he?(d+="\t dAtten = getFalloffLinear(light"+i+"_radius);\n",tt=!0):(d+="\t dAtten = getFalloffInvSquared(light"+i+"_radius);\n",et=!0):(d+="\t dAtten = getFalloffWindow(light"+i+"_radius);\n",et=!0),d+="\t if (dAtten > 0.00001) {\n",c===se&&($&&!L._cookieFalloff||(d+="\t\t\t dAtten *= getSpotEffect(light"+i+"_direction, light"+i+"_innerConeAngle, light"+i+"_outerConeAngle);\n",it=!0))),d+=z!==re?c===ee?"\t\t\t dAttenD = getLightDiffuse();\n":"\t\t\t dAttenD = get"+ot+"LightDiffuse() * 16.0;\n":"\t\t\t dAtten *= getLightDiffuse();\n",L.castShadows&&!e.noShadow){var at,lt=null;if(L._shadowType===de?(lt="VSM8",at="0.0"):L._shadowType===pe?(lt="VSM16",at="5.54"):L._shadowType===fe?(lt="VSM32",at=t.textureFloatHighPrecision?"15.0":"5.54"):lt=L._shadowType===me?"PCF5x5":"PCF3x3",null!==lt)if(c===ie)_="(light"+i+"_shadowMap, light"+i+"_shadowParams);\n",L._normalOffsetBias&&(d+="\t\t\t normalOffsetPointShadow(light"+i+"_shadowParams);\n"),d+="\t\t\t dAtten *= getShadowPoint"+lt+_;else{const n=`light${i}_shadowMatrix`,s=`light${i}_shadowParams`;d+=this._nonPointShadowMapProjection(t,e.lights[i],n,s,i),c===se&&(lt="Spot"+lt),d+="\t\t\t dAtten *= getShadow"+lt+"(light"+i+"_shadowMap, light"+i+"_shadowParams"+(L._isVsm?", "+at:"")+");\n"}}z!==re?e.conserveEnergy&&e.useSpecular?d+="\t\t\t dDiffuseLight += mix((dAttenD * dAtten) * light"+i+"_color"+($?" * dAtten3":"")+", vec3(0), dLTCSpecFres);\n":d+="\t\t\t dDiffuseLight += (dAttenD * dAtten) * light"+i+"_color"+($?" * dAtten3":"")+";\n":U&&e.conserveEnergy&&e.useSpecular?d+="\t\t\t dDiffuseLight += mix(dAtten * light"+i+"_color"+($?" * dAtten3":"")+", vec3(0), dSpecularity);\n":d+="\t\t\t dDiffuseLight += dAtten * light"+i+"_color"+($?" * dAtten3":"")+";\n",z!==re?(e.clearCoat>0&&(d+="\t\t\t ccSpecularLight += ccLTCSpecFres * get"+ot+"LightSpecularCC() * dAtten * light"+i+"_color"+($?" * dAtten3":"")+";\n"),e.useSpecular&&(d+="\t\t\t dSpecularLight += dLTCSpecFres * get"+ot+"LightSpecular() * dAtten * light"+i+"_color"+($?" * dAtten3":"")+";\n")):U?(e.clearCoat>0&&(d+="\t\t\t ccSpecularLight += ccSpecularity * getLightSpecularCC() * dAtten * light"+i+"_color"+($?" * dAtten3":"")+";\n"),e.useSpecular&&(d+="\t\t\t dSpecularLight += dSpecularity * getLightSpecular() * dAtten * light"+i+"_color"+($?" * dAtten3":"")+";\n")):(e.clearCoat>0&&(d+="\t\t\t ccSpecularLight += getLightSpecularCC() * dAtten * light"+i+"_color"+($?" * dAtten3":"")+";\n"),e.useSpecular&&(d+="\t\t\t dSpecularLight += getLightSpecular() * dAtten * light"+i+"_color"+($?" * dAtten3":"")+";\n")),c!==ee&&(d+="\t }\n"),d+="\n"}U&&(e.clearCoat>0&&(d+="\t ccSpecularity = 1.0;\n"),e.useSpecular&&(d+="\t dSpecularity = vec3(1);\n")),(r||e.sphereMap||e.dpAtlas)&&e.refraction&&(d+="\t addRefraction();\n")}d+="\n",H&&(e.occludeDirect&&(d+="\t\tapplyAO();\n"),e.occludeSpecular&&(d+="\t\toccludeSpecular();\n")),!1===e.opacityFadesSpecular&&(e.blendType!==Pt&&e.blendType!==Dt||(d+="float specLum = dot((dSpecularLight + dReflection.rgb * dReflection.a) * dSpecularity, vec3( 0.2126, 0.7152, 0.0722 ));\n",d+="#ifdef CLEARCOAT\n specLum += dot(ccSpecularLight * ccSpecularity + ccReflection.rgb * ccReflection.a * ccSpecularity, vec3( 0.2126, 0.7152, 0.0722 ));\n#endif\n",d+="dAlpha = clamp(dAlpha + gammaCorrectInput(specLum), 0.0, 1.0);\n"),d+="dAlpha *= material_alphaFade;\n"),d+=m.endPS,e.blendType===Pt||e.blendType===Ot||e.alphaToCoverage?d+=m.outputAlphaPS:e.blendType===Dt?d+=m.outputAlphaPremulPS:d+=m.outputAlphaOpaquePS,e.msdf&&(d+="\t gl_FragColor = applyMsdf(gl_FragColor);\n"),d+="\n",d+="}\n",J&&(d=m.lightDirPointPS+d),tt&&(d=m.falloffLinearPS+d),et&&(d=m.falloffInvSquaredPS+d),it&&(d=m.spotPS+d),nt&&(d=m.cookiePS+d);var ht="";return d.includes("dReflection")&&(ht+="vec4 dReflection;\n"),d.includes("dTBN")&&(ht+="mat3 dTBN;\n"),d.includes("dAlbedo")&&(ht+="vec3 dAlbedo;\n"),d.includes("dEmission")&&(ht+="vec3 dEmission;\n"),d.includes("dNormalW")&&(ht+="vec3 dNormalW;\n"),d.includes("dVertexNormalW")&&(ht+="vec3 dVertexNormalW;\n"),d.includes("dTangentW")&&(ht+="vec3 dTangentW;\n"),d.includes("dBinormalW")&&(ht+="vec3 dBinormalW;\n"),d.includes("dViewDirW")&&(ht+="vec3 dViewDirW;\n"),d.includes("dReflDirW")&&(ht+="vec3 dReflDirW;\n"),d.includes("dDiffuseLight")&&(ht+="vec3 dDiffuseLight;\n"),d.includes("dSpecularLight")&&(ht+="vec3 dSpecularLight;\n"),d.includes("dLightDirNormW")&&(ht+="vec3 dLightDirNormW;\n"),d.includes("dLightDirW")&&(ht+="vec3 dLightDirW;\n"),d.includes("dLightPosW")&&(ht+="vec3 dLightPosW;\n"),d.includes("dShadowCoord")&&(ht+="vec3 dShadowCoord;\n"),d.includes("dNormalMap")&&(ht+="vec3 dNormalMap;\n"),d.includes("dSpecularity")&&(ht+="vec3 dSpecularity;\n"),d.includes("dSpecularityNoFres")&&(ht+="vec3 dSpecularityNoFres;\n"),d.includes("dUvOffset")&&(ht+="vec2 dUvOffset;\n"),d.includes("dGlossiness")&&(ht+="float dGlossiness;\n"),d.includes("dAlpha")&&(ht+="float dAlpha;\n"),d.includes("dAtten")&&(ht+="float dAtten;\n"),d.includes("dAttenD")&&(ht+="float dAttenD;\n"),d.includes("dAtten3")&&(ht+="vec3 dAtten3;\n"),d.includes("dAo")&&(ht+="float dAo;\n"),d.includes("dMsdf")&&(ht+="vec4 dMsdf;\n"),d.includes("ccReflection")&&(ht+="vec4 ccReflection;\n"),d.includes("ccNormalW")&&(ht+="vec3 ccNormalW;\n"),d.includes("ccReflDirW")&&(ht+="vec3 ccReflDirW;\n"),d.includes("ccSpecularLight")&&(ht+="vec3 ccSpecularLight;\n"),d.includes("ccSpecularity")&&(ht+="float ccSpecularity;\n"),d.includes("ccSpecularityNoFres")&&(ht+="float ccSpecularityNoFres;\n"),d.includes("ccGlossiness")&&(ht+="float ccGlossiness;\n"),{attributes:g,vshader:M,fshader:d=P+ht+d,tag:Mr}}};const cl={begin:$o,dummyFragmentCode:Qo,end:Jo,fogCode:Yo,gammaCode:Ho,precisionCode:Ko,skinCode:qo,tonemapCode:Xo,versionCode:Zo,basic:na,particle:sa,skybox:ra,standard:hl};function _l(t,e,i,n){const s=e.fixCubemapSeams?jo.fixCubemapSeamsStretchPS:jo.fixCubemapSeamsNonePS,r=ia(t,jo.fullscreenQuadVS,s+jo.genParaboloidPS,"genParaboloid"),o=t.scope.resolve("source"),a=t.scope.resolve("params"),l=new Float32Array(4);let h=e.width;const c=e.format;h=2*Math.max(h,8);const _=new _a(t,{type:e.type,format:c,width:2*h,height:h,mipmaps:!1});_.name="paraboloid";const u=new Gl({colorBuffer:_,depth:!1});return l[0]=i,l[1]=n?-1:1,o.setValue(e),a.setValue(l),zo(t,u,r),_}function ul(t,e){t.x=.5*Z.clamp(e-2,0,1);const i=e-6*t.x,n=1-t.x;return t.y=Math.min(.5*i,.75)*n+t.x,t.z=(1-.5*Z.clamp(i,0,1))*n,t.w=.5*t.z,1/t.z}let dl=0;class pl{constructor(){this.name="Untitled",this.id=dl++,this._shader=null,this.variants={},this.parameters={},this.alphaTest=0,this.alphaToCoverage=!1,this.blend=!1,this.blendSrc=gn,this.blendDst=mn,this.blendEquation=En,this.separateAlphaBlend=!1,this.blendSrcAlpha=gn,this.blendDstAlpha=mn,this.blendAlphaEquation=En,this.cull=Xn,this.depthTest=!0,this.depthWrite=!0,this.stencilFront=null,this.stencilBack=null,this.depthBias=0,this.slopeDepthBias=0,this.redWrite=!0,this.greenWrite=!0,this.blueWrite=!0,this.alphaWrite=!0,this.meshInstances=[],this._shaderVersion=0,this._scene=null,this._dirtyBlend=!1,this.dirty=!0}get shader(){return this._shader}set shader(t){this._shader=t}get blendType(){return this.blend||this.blendSrc!==gn||this.blendDst!==mn||this.blendEquation!==En?this.blend&&this.blendSrc===xn&&this.blendDst===Cn&&this.blendEquation===En?Pt:this.blend&&this.blendSrc===gn&&this.blendDst===gn&&this.blendEquation===En?It:this.blend&&this.blendSrc===xn&&this.blendDst===gn&&this.blendEquation===En?Ot:this.blend&&this.blendSrc===vn&&this.blendDst===bn&&this.blendEquation===En?Ft:this.blend&&this.blendSrc===Sn&&this.blendDst===gn&&this.blendEquation===En?Bt:this.blend&&this.blendSrc===gn&&this.blendDst===gn&&this.blendEquation===In?Nt:this.blend&&this.blendSrc===gn&&this.blendDst===gn&&this.blendEquation===Pn?Ut:this.blend&&this.blendSrc===vn&&this.blendDst===mn&&this.blendEquation===En?kt:this.blend&&this.blendSrc===gn&&this.blendDst===Cn&&this.blendEquation===En?Dt:Pt:Lt}set blendType(t){const e=this.blend;switch(t){case Lt:this.blend=!1,this.blendSrc=gn,this.blendDst=mn,this.blendEquation=En;break;case Pt:this.blend=!0,this.blendSrc=xn,this.blendDst=Cn,this.blendEquation=En;break;case Dt:this.blend=!0,this.blendSrc=gn,this.blendDst=Cn,this.blendEquation=En;break;case It:this.blend=!0,this.blendSrc=gn,this.blendDst=gn,this.blendEquation=En;break;case Ot:this.blend=!0,this.blendSrc=xn,this.blendDst=gn,this.blendEquation=En;break;case Ft:this.blend=!0,this.blendSrc=vn,this.blendDst=bn,this.blendEquation=En;break;case Bt:this.blend=!0,this.blendSrc=Sn,this.blendDst=gn,this.blendEquation=En;break;case kt:this.blend=!0,this.blendSrc=vn,this.blendDst=mn,this.blendEquation=En;break;case Nt:this.blend=!0,this.blendSrc=gn,this.blendDst=gn,this.blendEquation=In;break;case Ut:this.blend=!0,this.blendSrc=gn,this.blendDst=gn,this.blendEquation=Pn}e!==this.blend&&(this._scene?this._scene.layers._dirtyBlend=!0:this._dirtyBlend=!0),this._updateMeshInstanceKeys()}_cloneInternal(t){t.name=this.name,t.shader=this.shader,t.alphaTest=this.alphaTest,t.alphaToCoverage=this.alphaToCoverage,t.blend=this.blend,t.blendSrc=this.blendSrc,t.blendDst=this.blendDst,t.blendEquation=this.blendEquation,t.separateAlphaBlend=this.separateAlphaBlend,t.blendSrcAlpha=this.blendSrcAlpha,t.blendDstAlpha=this.blendDstAlpha,t.blendAlphaEquation=this.blendAlphaEquation,t.cull=this.cull,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,t.depthBias=this.depthBias,t.slopeDepthBias=this.slopeDepthBias,this.stencilFront&&(t.stencilFront=this.stencilFront.clone()),this.stencilBack&&(this.stencilFront===this.stencilBack?t.stencilBack=t.stencilFront:t.stencilBack=this.stencilBack.clone()),t.redWrite=this.redWrite,t.greenWrite=this.greenWrite,t.blueWrite=this.blueWrite,t.alphaWrite=this.alphaWrite}clone(){const t=new pl;return this._cloneInternal(t),t}_updateMeshInstanceKeys(){const t=this.meshInstances;for(let e=0;e<t.length;e++)t[e].updateKey()}updateUniforms(t,e){}updateShader(t,e,i){}update(){this.dirty=!0,this._shader&&(this._shader.failed=!1)}clearParameters(){this.parameters={}}getParameters(){return this.parameters}clearVariants(){this.variants={};for(let t=0;t<this.meshInstances.length;t++){const e=this.meshInstances[t];for(let t=0;t<e._shader.length;t++)e._shader[t]=null}}getParameter(t){return this.parameters[t]}setParameter(t,e){if(void 0===e&&"object"==typeof t){const i=t;if(i.length){for(let t=0;t<i.length;t++)this.setParameter(i[t]);return}t=i.name,e=i.value}const i=this.parameters[t];i?i.data=e:this.parameters[t]={scopeId:null,data:e}}deleteParameter(t){this.parameters[t]&&delete this.parameters[t]}setParameters(t,e){const i=this.parameters;void 0===e&&(e=i);for(const n in e){const e=i[n];e&&(e.scopeId||(e.scopeId=t.scope.resolve(n)),e.scopeId.setValue(e.data))}}destroy(){this.variants={},this.shader=null;for(let t=0;t<this.meshInstances.length;t++){const e=this.meshInstances[t];for(let t=0;t<e._shader.length;t++)e._shader[t]=null;e._material=null}}addMeshInstanceRef(t){this.meshInstances.push(t)}removeMeshInstanceRef(t){const e=this.meshInstances,i=e.indexOf(t);-1!==i&&e.splice(i,1)}}function fl(){this._mapXForms=null}fl.prototype.updateMinRef=function(t,e,i,n,s,r,o,a,l){this._updateSharedOptions(t,n,s,o),this._updateMinOptions(t,n),this._updateUVOptions(t,n,s,!0)},fl.prototype.updateRef=function(t,e,i,n,s,r,o,a,l){this._updateSharedOptions(t,n,s,o),t.useTexCubeLod=e.useTexCubeLod,this._updateEnvOptions(t,n,i,l),this._updateMaterialOptions(t,n),o===Ii&&(t.gamma&&(t.gamma=Ke),t.toneMap=Ze),t.hasTangents=s&&n.normalMap&&0!=(s&di),this._updateLightOptions(t,n,s,a,r),this._updateUVOptions(t,n,s,!1)},fl.prototype._updateSharedOptions=function(t,e,i,n){t.pass=n,t.alphaTest=e.alphaTest>0,t.forceFragmentPrecision=e.forceFragmentPrecision||"",t.chunks=e.chunks||"",t.blendType=e.blendType,t.forceUv1=e.forceUv1,t.separateAmbient=!1,t.screenSpace=i&&0!=(i&ui),t.skin=i&&0!=(i&ri),t.useInstancing=i&&0!=(i&hi),t.useMorphPosition=i&&0!=(i&pi),t.useMorphNormal=i&&0!=(i&fi),t.useMorphTextureBased=i&&0!=(i&mi),t.nineSlicedMode=e.nineSlicedMode||0},fl.prototype._updateUVOptions=function(t,e,i,n){var s=!1,r=!1,o=!1;for(var a in i&&(s=0!=(i&oi),r=0!=(i&ai),o=0!=(i&li)),t.vertexColors=!1,this._mapXForms=[],ll)this._updateTexOptions(t,e,a,s,r,o,n);this._mapXForms=null},fl.prototype._updateMinOptions=function(t,e){t.opacityTint=1!==e.opacity&&e.blendType!==Lt,t.lights=[]},fl.prototype._updateMaterialOptions=function(t,e){var i=1===e.diffuse.r&&1===e.diffuse.g&&1===e.diffuse.b||!e.diffuseTint&&(e.diffuseMap||e.diffuseVertexColor)?0:3,n=!1,s=!!(e.useMetalness||e.specularMap||e.sphereMap||e.cubeMap||e.dpAtlas);(s=(s=(s=s||!!e.useMetalness||!(0===e.specular.r&&0===e.specular.g&&0===e.specular.b))||e.enableGGXSpecular)||e.clearCoat>0)&&(!e.specularTint&&(e.specularMap||e.specularVertexColor)||e.useMetalness||(n=1!==e.specular.r||1!==e.specular.g||1!==e.specular.b));var r=e.emissiveMap?0:3;r||(r=(r=(1!==e.emissive.r||1!==e.emissive.g||1!==e.emissive.b||1!==e.emissiveIntensity)&&e.emissiveTint)?3:1!==e.emissiveIntensity?1:0);var o=!!e.normalMap&&(e.normalMap.format===xs||e.normalMap.type===Wr);t.opacityTint=1!==e.opacity&&e.blendType!==Lt?1:0,t.blendMapsWithColors=!0,t.ambientTint=e.ambientTint,t.diffuseTint=i,t.specularTint=n?3:0,t.metalnessTint=e.useMetalness&&e.metalness<1?1:0,t.glossTint=1,t.emissiveTint=r,t.alphaToCoverage=e.alphaToCoverage,t.normalizeNormalMap=e.normalizeNormalMap,t.sphereMap=!!e.sphereMap,t.cubeMap=!!e.cubeMap,t.dpAtlas=!!e.dpAtlas,t.ambientSH=!!e.ambientSH,t.useSpecular=s,t.emissiveFormat=e.emissiveMap?e.emissiveMap.type===Vr?1:e.emissiveMap.format===As?2:0:null,t.lightMapFormat=e.lightMap?e.lightMap.type===Vr?1:e.lightMap.format===As?2:0:null,t.specularAntialias=e.specularAntialias&&!!e.normalMap&&!!e.normalMap.mipmaps&&!o,t.conserveEnergy=e.conserveEnergy,t.opacityFadesSpecular=e.opacityFadesSpecular,t.alphaFade=e.alphaFade,t.occludeSpecular=e.occludeSpecular,t.occludeSpecularFloat=1!==e.occludeSpecularIntensity,t.occludeDirect=e.occludeDirect,t.shadingModel=e.shadingModel,t.fresnelModel=e.fresnelModel,t.packedNormal=o,t.fastTbn=e.fastTbn,t.cubeMapProjection=e.cubeMapProjection,t.customFragmentShader=e.customFragmentShader,t.refraction=!!e.refraction,t.useMetalness=e.useMetalness,t.enableGGXSpecular=e.enableGGXSpecular,t.msdf=!!e.msdfMap,t.twoSidedLighting=e.twoSidedLighting,t.pixelSnap=e.pixelSnap,t.aoMapUv=e.aoUvSet,t.diffuseDetail=!!e.diffuseMap,t.normalDetail=!!e.normalMap,t.diffuseDetailMode=e.diffuseDetailMode,t.detailModes=!!t.diffuseDetail,t.clearCoat=!!e.clearCoat,t.clearCoatTint=1!==e.clearCoat?1:0,t.clearCoatGlossiness=!!e.clearCoatGlossiness,t.clearCoatGlossTint=1!==e.clearCoatGlossiness?1:0},fl.prototype._updateEnvOptions=function(t,e,i,n){var s,r=n&&n.type===Vr||e.cubeMap&&e.cubeMap.type===Vr||e.dpAtlas&&e.dpAtlas.type===Vr,o=n&&(n.type===Vr||n.format===As)||e.cubeMap&&(e.cubeMap.type===Vr||e.cubeMap.format===As)||e.dpAtlas&&(e.dpAtlas.type===Vr||e.dpAtlas.format===As),a=n&&!e.cubeMap&&!e.sphereMap&&!e.dpAtlas&&n.type===Vr||e.cubeMap&&e.cubeMap.type===Vr||e.sphereMap&&e.sphereMap.type===Vr||e.dpAtlas&&e.dpAtlas.type===Vr,l=!(!n||e.cubeMap||e.sphereMap||e.dpAtlas)&&(n.type===Vr||n.format===As)||e.cubeMap&&(e.cubeMap.type===Vr||e.cubeMap.format===As)||e.sphereMap&&(e.sphereMap.type===Vr||e.sphereMap.format===As)||e.dpAtlas&&(e.dpAtlas.type===Vr||e.dpAtlas.format===As);e.useSkybox&&i._skyboxPrefiltered&&(s=i._skyboxPrefiltered[0]),t.fog=e.useFog?i.fog:"none",t.gamma=e.useGammaTonemap?i.gammaCorrection:Xe,t.toneMap=e.useGammaTonemap?i.toneMapping:-1,t.rgbmAmbient=r,t.hdrAmbient=o,t.rgbmReflection=a,t.hdrReflection=l,t.useRgbm=a||r||e.emissiveMap&&e.emissiveMap.type===Vr||e.lightMap&&e.lightMap.type===Vr,t.fixSeams=n?n.fixCubemapSeams:!!e.cubeMap&&e.cubeMap.fixCubemapSeams,t.prefilteredCubemap=!!n,t.skyboxIntensity=n&&s&&n===s&&1!==i.skyboxIntensity,t.useCubeMapRotation=!e.cubeMap&&!e.prefilteredCubeMap128&&e.useSkybox&&i&&i.skyboxRotation&&!i.skyboxRotation.equals(yt.IDENTITY),t.useRightHandedCubeMap=e.cubeMap?e.cubeMap._isRenderTarget:!e.prefilteredCubeMap128&&e.useSkybox&&i&&i._skyboxIsRenderTarget,i.layers&&(t.clusteredLightingCookiesEnabled=i.layers.clusteredLightingCookiesEnabled,t.clusteredLightingShadowsEnabled=i.layers.clusteredLightingShadowsEnabled)},fl.prototype._updateLightOptions=function(t,e,i,n,s){if(t.lightMap=!1,t.lightMapChannel="",t.lightMapUv=0,t.lightMapTransform=0,t.lightMapWithoutAmbient=!1,t.dirLightMap=!1,i&&(t.noShadow=0!=(i&si),0!=(i&ci)&&(t.lightMapFormat=1,t.lightMap=!0,t.lightMapChannel="rgb",t.lightMapUv=1,t.lightMapTransform=0,t.lightMapWithoutAmbient=!e.lightMap,t.useRgbm=!0,0!=(i&_i)&&(t.dirLightMap=!0),0!=(i&gi)&&(t.lightMapWithoutAmbient=!1))),e.useLighting){var r=[],o=i?i>>16:1;n&&(this._collectLights(ee,n[ee],r,o),this._collectLights(ie,n[ie],r,o,s),this._collectLights(se,n[se],r,o,s)),t.lights=r}else t.lights=[];0===t.lights.length&&(t.noShadow=!0)},fl.prototype._updateTexOptions=function(t,e,i,n,s,r,o){var a=i+"Map",l=i+"VertexColor",h=i+"VertexColorChannel",c=a+"Channel",_=a+"Transform",u=a+"Uv";"light"!==i&&(t[a]=!1,t[c]="",t[_]=0,t[u]=0),t[l]=!1,t[h]="";var d="opacity"===i;if(d&&e.blendType===Lt&&0===e.alphaTest&&!e.alphaToCoverage)return t;if((!o||d)&&("height"!==i&&e[l]&&r&&(t[l]=e[l],t[h]=e[h],t.vertexColors=!0),e[a])){var p=!0;0!==e[u]||n||(p=!1),1!==e[u]||s||(p=!1),p&&(t[a]=!!e[a],t[_]=this._getMapTransformID(e.getUniform(_),e[u]),t[c]=e[c],t[u]=e[u])}},fl.prototype._collectLights=function(t,e,i,n,s){var r,o;for(o=0;o<e.length;o++)if((r=e[o]).enabled&&r.mask&n){if(t!==ee&&r.isStatic)continue;i.push(r)}if(s)for(o=0;o<s.length;o++)(r=s[o])._type===t&&i.push(r)};const ml=(t,e)=>{if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0};fl.prototype._getMapTransformID=function(t,e){if(!t)return 0;let i=this._mapXForms[e];i||(i=[],this._mapXForms[e]=i);for(let e=0;e<i.length;e++)if(ml(i[e][0].value,t[0].value)&&ml(i[e][1].value,t[1].value))return e+1;return i.push(t)};const gl={name:"string",chunks:"chunks",mappingFormat:"string",_engine:"boolean",ambient:"rgb",ambientTint:"boolean",aoVertexColor:"boolean",aoVertexColorChannel:"string",aoMap:"texture",aoMapChannel:"string",aoMapUv:"number",aoMapTiling:"vec2",aoMapOffset:"vec2",aoMapRotation:"number",diffuse:"rgb",diffuseTint:"boolean",diffuseVertexColor:"boolean",diffuseVertexColorChannel:"string",diffuseMap:"texture",diffuseMapChannel:"string",diffuseMapUv:"number",diffuseMapTiling:"vec2",diffuseMapOffset:"vec2",diffuseMapRotation:"number",diffuseDetailMap:"texture",diffuseDetailMapChannel:"string",diffuseDetailMapUv:"number",diffuseDetailMapTiling:"vec2",diffuseDetailMapOffset:"vec2",diffuseDetailMapRotation:"number",diffuseDetailMode:"string",specular:"rgb",specularTint:"boolean",specularVertexColor:"boolean",specularVertexColorChannel:"string",specularMap:"texture",specularMapChannel:"string",specularMapUv:"number",specularMapTiling:"vec2",specularMapOffset:"vec2",specularMapRotation:"number",specularAntialias:"boolean",occludeSpecular:"enum:occludeSpecular",useMetalness:"boolean",metalness:"number",enableGGXSpecular:"boolean",anisotropy:"number",metalnessTint:"boolean",metalnessVertexColor:"boolean",metalnessVertexColorChannel:"string",metalnessMap:"texture",metalnessMapChannel:"string",metalnessMapUv:"number",metalnessMapTiling:"vec2",metalnessMapOffset:"vec2",netalnessMapRotation:"number",conserveEnergy:"boolean",shininess:"number",glossVertexColor:"boolean",glossVertexColorChannel:"string",glossMap:"texture",glossMapChannel:"string",glossMapUv:"number",glossMapTiling:"vec2",glossMapOffset:"vec2",glossMapRotation:"number",clearCoat:"number",clearCoatVertexColor:"boolean",clearCoatVertexColorChannel:"string",clearCoatMap:"texture",clearCoatMapChannel:"string",clearCoatMapUv:"number",clearCoatMapTiling:"vec2",clearCoatMapOffset:"vec2",clearCoatMapRotation:"number",clearCoatGlossiness:"number",clearCoatGlossVertexColor:"boolean",clearCoatGlossVertexColorChannel:"string",clearCoatGlossMap:"texture",clearCoatGlossMapChannel:"string",clearCoatGlossMapUv:"number",clearCoatGlossMapTiling:"vec2",clearCoatGlossMapOffset:"vec2",clearCoatGlossMapRotation:"number",clearCoatBumpiness:"number",clearCoatNormalMap:"texture",clearCoatNormalMapUv:"number",clearCoatNormalMapTiling:"vec2",clearCoatNormalMapOffset:"vec2",clearCoatNormalMapRotation:"number",fresnelModel:"number",emissive:"rgb",emissiveTint:"boolean",emissiveVertexColor:"boolean",emissiveVertexColorChannel:"string",emissiveMap:"texture",emissiveMapChannel:"string",emissiveMapUv:"number",emissiveMapTiling:"vec2",emissiveMapOffset:"vec2",emissiveMapMapRotation:"number",emissiveIntensity:"number",normalMap:"texture",normalMapTiling:"vec2",normalMapOffset:"vec2",normalMapRotation:"number",normalMapUv:"number",bumpiness:"number",normalDetailMap:"texture",normalDetailMapTiling:"vec2",normalDetailMapOffset:"vec2",normalDetailMapRotation:"number",normalDetailMapUv:"number",normalDetailMapBumpiness:"number",heightMap:"texture",heightMapChannel:"string",heightMapUv:"number",heightMapTiling:"vec2",heightMapOffset:"vec2",heightMapRotation:"number",heightMapFactor:"number",alphaToCoverage:"boolean",alphaTest:"number",alphaFade:"number",opacity:"number",opacityVertexColor:"boolean",opacityVertexColorChannel:"string",opacityMap:"texture",opacityMapChannel:"string",opacityMapUv:"number",opacityMapTiling:"vec2",opacityMapOffset:"vec2",opacityMapRotation:"number",opacityFadesSpecular:"boolean",reflectivity:"number",refraction:"number",refractionIndex:"number",sphereMap:"texture",cubeMap:"cubemap",cubeMapProjection:"number",cubeMapProjectionBox:"boundingbox",lightVertexColor:"boolean",lightVertexColorChannel:"string",lightMap:"texture",lightMapChannel:"string",lightMapUv:"number",lightMapTiling:"vec2",lightMapOffset:"vec2",lightMapRotation:"number",depthTest:"boolean",depthWrite:"boolean",depthBias:"number",slopeDepthBias:"number",cull:"enum:cull",blendType:"enum:blendType",shadingModel:"enum:shadingModel",useFog:"boolean",useLighting:"boolean",useSkybox:"boolean",useGammaTonemap:"boolean",prefilteredCubeMap128:"texture",prefilteredCubeMap64:"texture",prefilteredCubeMap32:"texture",prefilteredCubeMap16:"texture",prefilteredCubeMap8:"texture",prefilteredCubeMap4:"texture"},bl=[];for(const t in gl){"texture"===gl[t]&&bl.push(t)}const yl=[];for(const t in gl){"cubemap"===gl[t]&&yl.push(t)}const vl={},Sl={};let xl=new Set;class wl extends pl{constructor(){super(),this._dirtyShader=!0,this._assetReferences={},this._validator=null,this._activeParams=new Set,this._activeLightingParams=new Set,this.shaderOptBuilder=new fl,this.reset()}reset(){Object.keys(vl).forEach(t=>{this["_"+t]=vl[t].value()}),this._chunks={},this._uniformCache={}}clone(){const t=new wl;this._cloneInternal(t),Object.keys(vl).forEach(e=>{t[e]=this[e]});for(const e in this._chunks)this._chunks.hasOwnProperty(e)&&(t._chunks[e]=this._chunks[e]);return t}_setParameter(t,e){xl.add(t),this.setParameter(t,e)}_setParameters(t){t.forEach(t=>{this._setParameter(t.name,t.value)})}_processParameters(t){const e=this[t];for(const t of e)xl.has(t)||delete this.parameters[t];this[t]=xl,xl=e,xl.clear()}_updateMap(t){const e=t+"Map",i=this[e];if(i){this._setParameter("texture_"+e,i);const t=e+"Transform",n=this.getUniform(t);n&&this._setParameters(n)}}_allocUniform(t,e){let i=this._uniformCache[t];return i||(i=e(),this._uniformCache[t]=i),i}getUniform(t,e,i){return Sl[t](this,e,i)}updateUniforms(t,e){const i=i=>this.getUniform(i,t,e);this._setParameter("material_ambient",i("ambient")),this.diffuseMap&&!this.diffuseTint||this._setParameter("material_diffuse",i("diffuse")),this.useMetalness?(!this.metalnessMap||this.metalness<1)&&this._setParameter("material_metalness",this.metalness):this.specularMap&&!this.specularTint||this._setParameter("material_specular",i("specular")),this.enableGGXSpecular&&this._setParameter("material_anisotropy",this.anisotropy),this.clearCoat>0&&(this._setParameter("material_clearCoat",this.clearCoat),this._setParameter("material_clearCoatGlossiness",this.clearCoatGlossiness),this._setParameter("material_clearCoatReflectivity",this.clearCoat),this._setParameter("material_clearCoatBumpiness",this.clearCoatBumpiness)),this._setParameter("material_shininess",i("shininess")),this.emissiveMap&&!this.emissiveTint||this._setParameter("material_emissive",i("emissive")),this.emissiveMap&&this._setParameter("material_emissiveIntensity",this.emissiveIntensity),this.refraction>0&&(this._setParameter("material_refraction",this.refraction),this._setParameter("material_refractionIndex",this.refractionIndex)),this._setParameter("material_opacity",this.opacity),!1===this.opacityFadesSpecular&&this._setParameter("material_alphaFade",this.alphaFade),this.occludeSpecular&&this._setParameter("material_occludeSpecularIntensity",this.occludeSpecularIntensity),this.cubeMapProjection===Be&&this._setParameter(i("cubeMapProjectionBox"));for(const t in ll)this._updateMap(t);this.ambientSH&&this._setParameter("ambientSH[0]",this.ambientSH),this.normalMap&&this._setParameter("material_bumpiness",this.bumpiness),this.normalMap&&this.normalDetailMap&&this._setParameter("material_normalDetailMapBumpiness",this.normalDetailMapBumpiness),this.heightMap&&this._setParameter("material_heightMapFactor",i("heightMapFactor")),this.cubeMap&&this._setParameter("texture_cubeMap",this.cubeMap),this.sphereMap&&this._setParameter("texture_sphereMap",this.sphereMap),this.dpAtlas&&this._setParameter("texture_sphereMap",this.dpAtlas),this._setParameter("material_reflectivity",this.reflectivity),this._processParameters("_activeParams"),this._dirtyShader&&(this.shader=null,this.clearVariants())}updateLightingUniforms(t,e){let i,n,s,r,o,a;this.useSkybox&&(i=e._skyboxPrefiltered[0],n=e._skyboxPrefiltered[1],s=e._skyboxPrefiltered[2],r=e._skyboxPrefiltered[3],o=e._skyboxPrefiltered[4],a=e._skyboxPrefiltered[5]);const l=this.prefilteredCubeMap128||i,h=this.prefilteredCubeMap64||n,c=this.prefilteredCubeMap32||s,_=this.prefilteredCubeMap16||r,u=this.prefilteredCubeMap8||o,d=this.prefilteredCubeMap4||a;if(l){const i=l&&h&&c&&_&&u&&d,n=!t.extTextureLod&&i,s=n?l.sh||ql(t,_):null;if(n&&s){if(!l.dpAtlas){const e=[l,h,c,_,u,d];l.dpAtlas=function(t,e,i){let n;const s=new ut,r=new Float32Array(4),o=2*e[0].width*2,a=ia(t,jo.fullscreenQuadVS,jo.dpAtlasQuadPS,"dpAtlasQuad"),l=t.scope.resolve("source"),h=t.scope.resolve("params"),c=new _a(t,{type:e[0].type,format:e[0].format,width:o,height:o,mipmaps:!1});c.name="paraboloid";const _=new Gl({colorBuffer:c,depth:!1}),u=(o+2)/o-1;let d;for(let c=0;c<6;c++)n=_l(t,e[c],c,i),l.setValue(n),d=ul(s,c),r[0]=d*u,r[1]=2*r[0],r[0]+=1,r[1]+=1,h.setValue(r),s.x*=o,s.y*=o,s.z*=o,s.w*=o,zo(t,_,a,s);return c}(t,e),l.sh=s}this.dpAtlas=l.dpAtlas,this.ambientSH=l.sh,this._setParameter("ambientSH[0]",this.ambientSH),this._setParameter("texture_sphereMap",this.dpAtlas)}else t.useTexCubeLod?l._levels.length<6?i?this._setParameter("texture_prefilteredCubeMap128",l):console.log("Can't use prefiltered cubemap: "+i+", "+t.useTexCubeLod+", "+l._levels):this._setParameter("texture_prefilteredCubeMap128",l):i?(this._setParameter("texture_prefilteredCubeMap128",l),this._setParameter("texture_prefilteredCubeMap64",h),this._setParameter("texture_prefilteredCubeMap32",c),this._setParameter("texture_prefilteredCubeMap16",_),this._setParameter("texture_prefilteredCubeMap8",u),this._setParameter("texture_prefilteredCubeMap4",d)):console.log("Can't use prefiltered cubemap: "+i+", "+t.useTexCubeLod+", "+l._levels);this.useSkybox&&!e.skyboxRotation.equals(yt.IDENTITY)&&e._skyboxRotationMat3&&this._setParameter("cubeMapRotationMatrix",e._skyboxRotationMat3.data)}this._processParameters("_activeLightingParams")}updateShader(t,e,i,n,s,r){this.updateLightingUniforms(t,e);const o=this.prefilteredCubeMap128||this.useSkybox&&e._skyboxPrefiltered[0],a=s>Ii&&s<=Di;let l=a?hl.optionsContextMin:hl.optionsContext;a?this.shaderOptBuilder.updateMinRef(l,t,e,this,i,n,s,r,o):this.shaderOptBuilder.updateRef(l,t,e,this,i,n,s,r,o),this.onUpdateShader&&(l=this.onUpdateShader(l));const h=t.getProgramLibrary();this.shader=h.getProgram("standard",l),i||(this.clearVariants(),this.variants[0]=this.shader),this._dirtyShader=!1}destroy(){for(const t in this._assetReferences)this._assetReferences[t]._unbind();this._assetReferences=null,this._validator=null,super.destroy()}}wl.TEXTURE_PARAMETERS=bl,wl.CUBEMAP_PARAMETERS=yl;const Cl=(t,e)=>{Sl[t]=e},Tl=t=>{const e=t.name,i="_"+e,n=t.defaultValue,s=t.dirtyShaderFunc||null,r=t.getUniformFunc||null,o=n&&n.clone?{equals:(t,e)=>t.equals(e),clone:t=>t.clone(),copy:(t,e)=>t.copy(e)}:{equals:(t,e)=>t===e,clone:t=>t,copy:(t,e)=>e},a=t.default instanceof rt;Object.defineProperty(wl.prototype,e,{get:function(){return a&&(this._dirtyShader=!0),this[i]},set:function(t){const e=this[i];o.equals(e,t)||(this._dirtyShader||(this._dirtyShader=!s||s(e,t)),this[i]=o.copy(e,t))}}),vl[e]={value:()=>o.clone(n)},r&&Cl(e,r)};function Al(t,e,i,n,s,r){ll[t]=i,Tl({name:t+"Map",defaultValue:null,dirtyShaderFunc:(t,e)=>!!t!=!!e||t&&(t.type!==e.type||t.fixCubemapSeams!==e.fixCubemapSeams||t.format!==e.format)}),Tl({name:t+"MapTiling",defaultValue:new _t(1,1)}),Tl({name:t+"MapOffset",defaultValue:new _t(0,0)}),Tl({name:t+"MapRotation",defaultValue:0}),Tl({name:t+"MapUv",defaultValue:e}),i>0&&Tl({name:t+"MapChannel",defaultValue:n||(i>1?"rgb":"g")}),s&&(Tl({name:t+"VertexColor",defaultValue:!1}),i>0&&Tl({name:t+"VertexColorChannel",defaultValue:n||(i>1?"rgb":"g")})),r&&Tl({name:t+"Mode",defaultValue:Ve});const o=t+"MapTiling",a=t+"MapOffset",l=t+"MapRotation",h=t+"MapTransform";Cl(h,(t,e,i)=>{const n=t[o],s=t[a],r=t[l];if(1===n.x&&1===n.y&&0===s.x&&0===s.y&&0===r)return null;const c=t._allocUniform(h,()=>[{name:`texture_${h}0`,value:new Float32Array(3)},{name:`texture_${h}1`,value:new Float32Array(3)}]),_=Math.cos(r*Z.DEG_TO_RAD),u=Math.sin(r*Z.DEG_TO_RAD),d=c[0].value;d[0]=_*n.x,d[1]=-u*n.y,d[2]=s.x;const p=c[1].value;return p[0]=u*n.x,p[1]=_*n.y,p[2]=1-n.y-s.y,c})}function El(t,e,i){const n=t+"Intensity";Tl({name:t,defaultValue:e,getUniformFunc:(e,s,r)=>{const o=e._allocUniform(t,()=>new Float32Array(3)),a=e[t],l=i?e[n]:1;return e.useGammaTonemap&&r.gammaCorrection?(o[0]=Math.pow(a.r,2.2)*l,o[1]=Math.pow(a.g,2.2)*l,o[2]=Math.pow(a.b,2.2)*l):(o[0]=a.r*l,o[1]=a.g*l,o[2]=a.b*l),o}}),i&&Tl({name:n,defaultValue:1})}function Ml(t,e,i){Tl({name:""+t,defaultValue:e,dirtyShaderFunc:(t,e)=>(0===t||1===t)!=(0===e||1===e),getUniformFunc:i})}function Rl(t,e){Tl({name:t,defaultValue:null,dirtyShaderFunc:(t,e)=>!!t==!!e,getUniformFunc:e})}function Il(t,e){Object.defineProperty(wl.prototype,e,{get:function(){return this[t]},set:function(e){this[t]=e}})}function Pl(t,e){Tl({name:t,defaultValue:e})}El("ambient",new rt(.7,.7,.7)),El("diffuse",new rt(1,1,1)),El("specular",new rt(0,0,0)),El("emissive",new rt(0,0,0),!0),Ml("shininess",25,(t,e,i)=>t.shadingModel===Ne?Math.pow(2,.01*t.shininess*11):.01*t.shininess),Ml("heightMapFactor",1,(t,e,i)=>.025*t.heightMapFactor),Ml("opacity",1),Ml("alphaFade",1),Ml("alphaTest",0),Ml("bumpiness",1),Ml("normalDetailMapBumpiness",1),Ml("reflectivity",1),Ml("occludeSpecularIntensity",1),Ml("refraction",0),Ml("refractionIndex",1/1.5),Ml("metalness",1),Ml("anisotropy",0),Ml("clearCoat",0),Ml("clearCoatGlossiness",1),Ml("clearCoatBumpiness",1),Ml("aoUvSet",0,null),Rl("ambientSH"),Rl("cubeMapProjectionBox",(t,e,i)=>{const n=t._allocUniform("cubeMapProjectionBox",()=>[{name:"envBoxMin",value:new Float32Array(3)},{name:"envBoxMax",value:new Float32Array(3)}]),s=t.cubeMapProjectionBox.getMin(),r=n[0].value;r[0]=s.x,r[1]=s.y,r[2]=s.z;const o=t.cubeMapProjectionBox.getMax(),a=n[1].value;return a[0]=o.x,a[1]=o.y,a[2]=o.z,n}),Object.defineProperty(wl.prototype,"chunks",{get:function(){return this._dirtyShader=!0,this._chunks},set:function(t){this._dirtyShader=!0,this._chunks=t}}),Pl("ambientTint",!1),Pl("diffuseTint",!1),Pl("specularTint",!1),Pl("emissiveTint",!1),Pl("fastTbn",!1),Pl("specularAntialias",!1),Pl("useMetalness",!1),Pl("enableGGXSpecular",!1),Pl("occludeDirect",!1),Pl("normalizeNormalMap",!0),Pl("conserveEnergy",!0),Pl("opacityFadesSpecular",!0),Pl("occludeSpecular",ii),Pl("shadingModel",Ue),Pl("fresnelModel",Ht),Pl("cubeMapProjection",Fe),Pl("customFragmentShader",null),Pl("forceFragmentPrecision",null),Pl("useFog",!0),Pl("useLighting",!0),Pl("useGammaTonemap",!0),Pl("useSkybox",!0),Pl("forceUv1",!1),Pl("pixelSnap",!1),Pl("twoSidedLighting",!1),Pl("nineSlicedMode",void 0),Al("diffuse",0,3,"",!0),Al("specular",0,3,"",!0),Al("emissive",0,3,"",!0),Al("normal",0,-1,"",!1),Al("metalness",0,1,"",!0),Al("gloss",0,1,"",!0),Al("opacity",0,1,"a",!0),Al("height",0,1,"",!1),Al("ao",0,1,"",!0),Al("light",1,3,"",!0),Al("msdf",0,3,"",!1),Al("diffuseDetail",0,3,"",!1,!0),Al("normalDetail",0,-1,"",!1),Al("clearCoat",0,1,"",!0),Al("clearCoatGloss",0,1,"",!0),Al("clearCoatNormal",0,-1,"",!1),Rl("cubeMap"),Rl("sphereMap"),Rl("dpAtlas"),Rl("prefilteredCubeMap128"),Rl("prefilteredCubeMap64"),Rl("prefilteredCubeMap32"),Rl("prefilteredCubeMap16"),Rl("prefilteredCubeMap8"),Rl("prefilteredCubeMap4"),Il("diffuseTint","diffuseMapTint"),Il("specularTint","specularMapTint"),Il("emissiveTint","emissiveMapTint"),Il("aoVertexColor","aoMapVertexColor"),Il("diffuseVertexColor","diffuseMapVertexColor"),Il("specularVertexColor","specularMapVertexColor"),Il("emissiveVertexColor","emissiveMapVertexColor"),Il("metalnessVertexColor","metalnessMapVertexColor"),Il("glossVertexColor","glossMapVertexColor"),Il("opacityVertexColor","opacityMapVertexColor"),Il("lightVertexColor","lightMapVertexColor");class Ll{constructor(t){this._device=t,this._cache={},this._generators={},this._isClearingCache=!1,this._precached=!1,this._programsCollection=[],this._defaultStdMatOption={},this._defaultStdMatOptionMin={};const e=new wl;e.shaderOptBuilder.updateRef(this._defaultStdMatOption,t,{},e,null,[],Ri,null,null),e.shaderOptBuilder.updateMinRef(this._defaultStdMatOptionMin,t,{},e,null,[],Li,null,null)}register(t,e){this.isRegistered(t)||(this._generators[t]=e)}unregister(t){this.isRegistered(t)&&delete this._generators[t]}isRegistered(t){return void 0!==this._generators[t]}getProgram(t,e){const i=this._generators[t];if(void 0===i)return null;const n=this._device,s=i.generateKey(e);let r=this._cache[s];if(!r){let o;e.lights&&(o=e.lights,e.lights=o.map((function(t){const e=t.clone?t.clone():t;return e.key=t.key,e}))),this.storeNewProgram(t,e),e.lights&&(e.lights=o),this._precached&&console.warn("ProgramLibrary#getProgram: Cache miss for shader",t,"key",s,"after shaders precaching");const a=i.createShaderDefinition(n,e);r=this._cache[s]=new Go(n,a)}return r}storeNewProgram(t,e){let i={};if("standard"===t){const t=this._getDefaultStdMatOptions(e.pass);for(const n in e)(e.hasOwnProperty(n)&&t[n]!==e[n]||"pass"===n)&&(i[n]=e[n])}else i=e;this._programsCollection.push(JSON.stringify({name:t,options:i}))}dumpPrograms(){let t="let device = pc.app ? pc.app.graphicsDevice : pc.Application.getApplication().graphicsDevice;\n";t+="let shaders = [",this._programsCollection[0]&&(t+="\n\t"+this._programsCollection[0]);for(let e=1;e<this._programsCollection.length;++e)t+=",\n\t"+this._programsCollection[e];t+="\n];\n",t+="device.programLib.precompile(shaders);\n",t+='if (pc.version != "'+l+'" || pc.revision != "'+h+'")\n',t+='\tconsole.warn("precompile-shaders.js: engine version mismatch, rebuild shaders lib with current engine");';const e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),e.setAttribute("download","precompile-shaders.js"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}clearCache(){const t=this._cache;this._isClearingCache=!0;for(const e in t)t.hasOwnProperty(e)&&t[e].destroy();this._cache={},this._isClearingCache=!1}removeFromCache(t){if(this._isClearingCache)return;const e=this._cache;for(const i in e)if(e.hasOwnProperty(i)&&e[i]===t){delete e[i];break}}_getDefaultStdMatOptions(t){return t>Ii&&t<=Di?this._defaultStdMatOptionMin:this._defaultStdMatOption}precompile(t){if(t){const e=new Array(t.length);for(let i=0;i<t.length;i++){if("standard"===t[i].name){const e=t[i].options,n=this._getDefaultStdMatOptions(e.pass);for(const t in n)n.hasOwnProperty(t)&&void 0===e[t]&&(e[t]=n[t]);e.useTexCubeLod=this._device.useTexCubeLod}e[i]=this.getProgram(t[i].name,t[i].options)}}this._precached=!0}}class Dl{constructor(){this.globalId=0,this.revision=0}equals(t){return this.globalId===t.globalId&&this.revision===t.revision}copy(t){this.globalId=t.globalId,this.revision=t.revision}reset(){this.globalId=0,this.revision=0}}let kl=0;class Ol{constructor(){kl++,this.version=new Dl,this.version.globalId=kl}increment(){this.version.revision++}}class Fl{constructor(t){this.name=t,this.value=null,this.versionObject=new Ol}setValue(t){this.value=t,this.versionObject.increment()}getValue(){return this.value}}class Bl{constructor(t){this.name=t,this.variables=new Map}resolve(t){return this.variables.has(t)||this.variables.set(t,new Fl(t)),this.variables.get(t)}removeValue(t){for(const e in this.variables){const i=this.variables[e];i.value===t&&(i.value=null)}}}class Nl{constructor(t,e,i,n){if(this.locationId=n,this.scopeId=t.scope.resolve(e),this.version=new Dl,"[0]"===e.substr(e.length-3))switch(i){case oo:i=xo;break;case ao:i=Ao;break;case lo:i=Eo;break;case ho:i=Mo}this.dataType=i,this.value=[null,null,null,null],this.array=[]}}function Ul(t,e){const i=t.width,n=t.height;if(i>e||n>e){const s=e/Math.max(i,n),r=Math.floor(i*s),o=Math.floor(n*s),a=document.createElement("canvas");a.width=r,a.height=o;return a.getContext("2d").drawImage(t,0,0,i,n,0,0,r,o),a}return t}function Vl(t,e){let i=!0;const n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,2,2,0,t.RGBA,e,null);const s=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&(i=!1),t.bindTexture(t.TEXTURE_2D,null),t.deleteTexture(n),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(s),i}class zl extends x{constructor(t,e={}){super(),this.canvas=t,this._enableAutoInstancing=!1,this.autoInstancingMaxObjects=16384,this.defaultFramebuffer=null,this._maxPixelRatio=1,this._width=0,this._height=0,this.updateClientRect(),this.shaders=[],this.buffers=[],this.textures=[],this.targets=[],this.contextLost=!1,this._contextLostHandler=t=>{t.preventDefault(),this.contextLost=!0,this.loseContext(),this.fire("devicelost")},this._contextRestoredHandler=()=>{this.restoreContext(),this.contextLost=!1,this.fire("devicerestored")};const i=void 0===e.preferWebGl2||e.preferWebGl2?["webgl2","webgl","experimental-webgl"]:["webgl","experimental-webgl"];let n=null;e.stencil=!0;for(let s=0;s<i.length;s++)if(n=t.getContext(i[s],e),n){this.webgl2="webgl2"===i[s];break}if(!n)throw new Error("WebGL not supported");const s=B.browser&&!!window.chrome,r=B.browser&&-1!==navigator.appVersion.indexOf("Mac");let a,l,h,c,_;this.gl=n,this._tempEnableSafariTextureUnitWorkaround=B.browser&&!!window.safari,this._tempMacChromeBlitFramebufferWorkaround=r&&s&&!e.alpha,this.webgl2||function(t){if(t.getSupportedExtensions){if(-1!=t.getSupportedExtensions().indexOf("OES_vertex_array_object"))return}else if(t.getExtension){if(t.getExtension("OES_vertex_array_object"))return}if(t.getSupportedExtensions){var e=t.getSupportedExtensions;t.getSupportedExtensions=function(){var t=e.call(this)||[];return t.push("OES_vertex_array_object"),t}}var i=t.getExtension;t.getExtension=function(e){return"OES_vertex_array_object"==e?(t.__OESVertexArrayObject||(t.__OESVertexArrayObject=new o(t)),t.__OESVertexArrayObject):i?i.call(this,e):null}}(n),t.addEventListener("webglcontextlost",this._contextLostHandler,!1),t.addEventListener("webglcontextrestored",this._contextRestoredHandler,!1),this.initializeExtensions(),this.initializeCapabilities(),this.initializeRenderState(),this.initializeContextCaches(),this.defaultClearOptions={color:[0,0,0,1],depth:1,stencil:0,flags:Fn|Bn},this.glAddress=[n.REPEAT,n.CLAMP_TO_EDGE,n.MIRRORED_REPEAT],this.glBlendEquation=[n.FUNC_ADD,n.FUNC_SUBTRACT,n.FUNC_REVERSE_SUBTRACT,this.webgl2?n.MIN:this.extBlendMinmax?this.extBlendMinmax.MIN_EXT:n.FUNC_ADD,this.webgl2?n.MAX:this.extBlendMinmax?this.extBlendMinmax.MAX_EXT:n.FUNC_ADD],this.glBlendFunction=[n.ZERO,n.ONE,n.SRC_COLOR,n.ONE_MINUS_SRC_COLOR,n.DST_COLOR,n.ONE_MINUS_DST_COLOR,n.SRC_ALPHA,n.SRC_ALPHA_SATURATE,n.ONE_MINUS_SRC_ALPHA,n.DST_ALPHA,n.ONE_MINUS_DST_ALPHA],this.glComparison=[n.NEVER,n.LESS,n.EQUAL,n.LEQUAL,n.GREATER,n.NOTEQUAL,n.GEQUAL,n.ALWAYS],this.glStencilOp=[n.KEEP,n.ZERO,n.REPLACE,n.INCR,n.INCR_WRAP,n.DECR,n.DECR_WRAP,n.INVERT],this.glClearFlag=[0,n.COLOR_BUFFER_BIT,n.DEPTH_BUFFER_BIT,n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT,n.STENCIL_BUFFER_BIT,n.STENCIL_BUFFER_BIT|n.COLOR_BUFFER_BIT,n.STENCIL_BUFFER_BIT|n.DEPTH_BUFFER_BIT,n.STENCIL_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT],this.glCull=[0,n.BACK,n.FRONT,n.FRONT_AND_BACK],this.glFilter=[n.NEAREST,n.LINEAR,n.NEAREST_MIPMAP_NEAREST,n.NEAREST_MIPMAP_LINEAR,n.LINEAR_MIPMAP_NEAREST,n.LINEAR_MIPMAP_LINEAR],this.glPrimitive=[n.POINTS,n.LINES,n.LINE_LOOP,n.LINE_STRIP,n.TRIANGLES,n.TRIANGLE_STRIP,n.TRIANGLE_FAN],this.glType=[n.BYTE,n.UNSIGNED_BYTE,n.SHORT,n.UNSIGNED_SHORT,n.INT,n.UNSIGNED_INT,n.FLOAT],this.pcUniformType={},this.pcUniformType[n.BOOL]=so,this.pcUniformType[n.INT]=ro,this.pcUniformType[n.FLOAT]=oo,this.pcUniformType[n.FLOAT_VEC2]=ao,this.pcUniformType[n.FLOAT_VEC3]=lo,this.pcUniformType[n.FLOAT_VEC4]=ho,this.pcUniformType[n.INT_VEC2]=co,this.pcUniformType[n.INT_VEC3]=_o,this.pcUniformType[n.INT_VEC4]=uo,this.pcUniformType[n.BOOL_VEC2]=po,this.pcUniformType[n.BOOL_VEC3]=fo,this.pcUniformType[n.BOOL_VEC4]=mo,this.pcUniformType[n.FLOAT_MAT2]=go,this.pcUniformType[n.FLOAT_MAT3]=bo,this.pcUniformType[n.FLOAT_MAT4]=yo,this.pcUniformType[n.SAMPLER_2D]=vo,this.pcUniformType[n.SAMPLER_CUBE]=So,this.webgl2&&(this.pcUniformType[n.SAMPLER_2D_SHADOW]=wo,this.pcUniformType[n.SAMPLER_CUBE_SHADOW]=Co,this.pcUniformType[n.SAMPLER_3D]=To),this.targetToSlot={},this.targetToSlot[n.TEXTURE_2D]=0,this.targetToSlot[n.TEXTURE_CUBE_MAP]=1,this.targetToSlot[n.TEXTURE_3D]=2,this.commitFunction=[],this.commitFunction[so]=function(t,e){t.value!==e&&(n.uniform1i(t.locationId,e),t.value=e)},this.commitFunction[ro]=this.commitFunction[so],this.commitFunction[oo]=function(t,e){t.value!==e&&(n.uniform1f(t.locationId,e),t.value=e)},this.commitFunction[ao]=function(t,e){_=t.value,a=e[0],l=e[1],_[0]===a&&_[1]===l||(n.uniform2fv(t.locationId,e),_[0]=a,_[1]=l)},this.commitFunction[lo]=function(t,e){_=t.value,a=e[0],l=e[1],h=e[2],_[0]===a&&_[1]===l&&_[2]===h||(n.uniform3fv(t.locationId,e),_[0]=a,_[1]=l,_[2]=h)},this.commitFunction[ho]=function(t,e){_=t.value,a=e[0],l=e[1],h=e[2],c=e[3],_[0]===a&&_[1]===l&&_[2]===h&&_[3]===c||(n.uniform4fv(t.locationId,e),_[0]=a,_[1]=l,_[2]=h,_[3]=c)},this.commitFunction[co]=function(t,e){_=t.value,a=e[0],l=e[1],_[0]===a&&_[1]===l||(n.uniform2iv(t.locationId,e),_[0]=a,_[1]=l)},this.commitFunction[po]=this.commitFunction[co],this.commitFunction[_o]=function(t,e){_=t.value,a=e[0],l=e[1],h=e[2],_[0]===a&&_[1]===l&&_[2]===h||(n.uniform3iv(t.locationId,e),_[0]=a,_[1]=l,_[2]=h)},this.commitFunction[fo]=this.commitFunction[_o],this.commitFunction[uo]=function(t,e){_=t.value,a=e[0],l=e[1],h=e[2],c=e[3],_[0]===a&&_[1]===l&&_[2]===h&&_[3]===c||(n.uniform4iv(t.locationId,e),_[0]=a,_[1]=l,_[2]=h,_[3]=c)},this.commitFunction[mo]=this.commitFunction[uo],this.commitFunction[go]=function(t,e){n.uniformMatrix2fv(t.locationId,!1,e)},this.commitFunction[bo]=function(t,e){n.uniformMatrix3fv(t.locationId,!1,e)},this.commitFunction[yo]=function(t,e){n.uniformMatrix4fv(t.locationId,!1,e)},this.commitFunction[xo]=function(t,e){n.uniform1fv(t.locationId,e)},this.commitFunction[Ao]=function(t,e){n.uniform2fv(t.locationId,e)},this.commitFunction[Eo]=function(t,e){n.uniform3fv(t.locationId,e)},this.commitFunction[Mo]=function(t,e){n.uniform4fv(t.locationId,e)},this.scope=new Bl("Device"),this.programLib=new Ll(this);for(const t in cl)this.programLib.register(t,cl[t]);this.supportsBoneTextures=this.extTextureFloat&&this.maxVertexTextures>0,this.useTexCubeLod=this.extTextureLod&&this.maxTextures<16;let u=this.vertexUniformsCount;u-=16,u-=8,u-=1,u-=16,this.boneLimit=Math.floor(u/3),this.boneLimit=Math.min(this.boneLimit,128),"Mali-450 MP"===this.unmaskedRenderer&&(this.boneLimit=34),this._drawCallsPerFrame=0,this._shaderSwitchesPerFrame=0,this._primsPerFrame=[];for(let t=Gs;t<=Ks;t++)this._primsPerFrame[t]=0;this._renderTargetCreationTime=0,this._vram={tex:0,vb:0,ib:0},this._shaderStats={vsCompiled:0,fsCompiled:0,linked:0,materialShaders:0,compileTime:0},this.constantTexSource=this.scope.resolve("source"),this.extTextureFloat?this.webgl2?this.textureFloatRenderable=!!this.extColorBufferFloat:this.textureFloatRenderable=Vl(n,n.FLOAT):this.textureFloatRenderable=!1,this.extColorBufferHalfFloat?this.textureHalfFloatRenderable=!!this.extColorBufferHalfFloat:this.extTextureHalfFloat?this.webgl2?this.textureHalfFloatRenderable=!!this.extColorBufferFloat:this.textureHalfFloatRenderable=Vl(n,this.extTextureHalfFloat.HALF_FLOAT_OES):this.textureHalfFloatRenderable=!1,this.supportsMorphTargetTexturesCore="highp"===this.maxPrecision&&this.maxVertexTextures>=2,this._textureFloatHighPrecision=void 0,this._textureHalfFloatUpdatable=void 0,this.grabPassAvailable=!0,this.grabPassAlpha=e.alpha,this.createGrabPass(),No.init(this),this.areaLightLutFormat=ys,this.extTextureHalfFloat&&this.textureHalfFloatUpdatable&&this.extTextureHalfFloatLinear?this.areaLightLutFormat=Cs:this.extTextureFloat&&this.extTextureFloatLinear&&(this.areaLightLutFormat=As)}destroy(){const t=this.gl;this.destroyGrabPass(),this.webgl2&&this.feedback&&t.deleteTransformFeedback(this.feedback),this.clearShaderCache(),this.clearVertexArrayObjectCache(),this.canvas.removeEventListener("webglcontextlost",this._contextLostHandler,!1),this.canvas.removeEventListener("webglcontextrestored",this._contextRestoredHandler,!1),this._contextLostHandler=null,this._contextRestoredHandler=null,this.scope=null,this.canvas=null,this.gl=null}toJSON(t){}getPrecision(){const t=this.gl;let e="highp";if(t.getShaderPrecisionFormat){const i=t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT),n=t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT),s=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT),r=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT),o=i.precision>0&&s.precision>0,a=n.precision>0&&r.precision>0;o||(e=a?"mediump":"lowp")}return e}initializeExtensions(){const t=this.gl;let e;const i={};t.getSupportedExtensions().forEach(t=>{i[t]=!0});const n=function(){for(let e=0;e<arguments.length;e++)if(i.hasOwnProperty(arguments[e]))return t.getExtension(arguments[e]);return null};this.webgl2?(this.extBlendMinmax=!0,this.extDrawBuffers=!0,this.extInstancing=!0,this.extStandardDerivatives=!0,this.extTextureFloat=!0,this.extTextureHalfFloat=!0,this.extTextureHalfFloatLinear=!0,this.extTextureLod=!0,this.extUintElement=!0,this.extVertexArrayObject=!0,this.extColorBufferFloat=n("EXT_color_buffer_float"),this.extDisjointTimerQuery=n("EXT_disjoint_timer_query_webgl2","EXT_disjoint_timer_query")):(this.extBlendMinmax=n("EXT_blend_minmax"),this.extDrawBuffers=n("EXT_draw_buffers"),this.extInstancing=n("ANGLE_instanced_arrays"),this.extInstancing&&(e=this.extInstancing,t.drawArraysInstanced=e.drawArraysInstancedANGLE.bind(e),t.drawElementsInstanced=e.drawElementsInstancedANGLE.bind(e),t.vertexAttribDivisor=e.vertexAttribDivisorANGLE.bind(e)),this.extStandardDerivatives=n("OES_standard_derivatives"),this.extTextureFloat=n("OES_texture_float"),this.extTextureHalfFloat=n("OES_texture_half_float"),this.extTextureHalfFloatLinear=n("OES_texture_half_float_linear"),this.extTextureLod=n("EXT_shader_texture_lod"),this.extUintElement=n("OES_element_index_uint"),this.extVertexArrayObject=n("OES_vertex_array_object"),this.extVertexArrayObject&&(e=this.extVertexArrayObject,t.createVertexArray=e.createVertexArrayOES.bind(e),t.deleteVertexArray=e.deleteVertexArrayOES.bind(e),t.isVertexArray=e.isVertexArrayOES.bind(e),t.bindVertexArray=e.bindVertexArrayOES.bind(e)),this.extColorBufferFloat=null,this.extDisjointTimerQuery=null),this.extDebugRendererInfo=n("WEBGL_debug_renderer_info"),this.extTextureFloatLinear=n("OES_texture_float_linear"),this.extFloatBlend=n("EXT_float_blend"),this.extTextureFilterAnisotropic=n("EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"),this.extCompressedTextureETC1=n("WEBGL_compressed_texture_etc1"),this.extCompressedTextureETC=n("WEBGL_compressed_texture_etc"),this.extCompressedTexturePVRTC=n("WEBGL_compressed_texture_pvrtc","WEBKIT_WEBGL_compressed_texture_pvrtc"),this.extCompressedTextureS3TC=n("WEBGL_compressed_texture_s3tc","WEBKIT_WEBGL_compressed_texture_s3tc"),this.extCompressedTextureATC=n("WEBGL_compressed_texture_atc"),this.extCompressedTextureASTC=n("WEBGL_compressed_texture_astc"),this.extParallelShaderCompile=n("KHR_parallel_shader_compile"),this.extColorBufferHalfFloat=n("EXT_color_buffer_half_float"),this.supportsInstancing=!!this.extInstancing}initializeCapabilities(){const t=this.gl;let e;this.maxPrecision=this.precision=this.getPrecision();const i=t.getContextAttributes();this.supportsMsaa=i.antialias,this.supportsStencil=i.stencil,this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxCubeMapSize=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxRenderBufferSize=t.getParameter(t.MAX_RENDERBUFFER_SIZE),this.maxTextures=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this.maxCombinedTextures=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.vertexUniformsCount=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),this.fragmentUniformsCount=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),this.webgl2?(this.maxDrawBuffers=t.getParameter(t.MAX_DRAW_BUFFERS),this.maxColorAttachments=t.getParameter(t.MAX_COLOR_ATTACHMENTS),this.maxVolumeSize=t.getParameter(t.MAX_3D_TEXTURE_SIZE)):(e=this.extDrawBuffers,this.maxDrawBuffers=e?t.getParameter(e.MAX_DRAW_BUFFERS_EXT):1,this.maxColorAttachments=e?t.getParameter(e.MAX_COLOR_ATTACHMENTS_EXT):1,this.maxVolumeSize=1),e=this.extDebugRendererInfo,this.unmaskedRenderer=e?t.getParameter(e.UNMASKED_RENDERER_WEBGL):"",this.unmaskedVendor=e?t.getParameter(e.UNMASKED_VENDOR_WEBGL):"",e=this.extTextureFilterAnisotropic,this.maxAnisotropy=e?t.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1,this.samples=t.getParameter(t.SAMPLES),this.maxSamples=this.webgl2?t.getParameter(t.MAX_SAMPLES):1}initializeRenderState(){const t=this.gl;this.blending=!1,t.disable(t.BLEND),this.blendSrc=gn,this.blendDst=mn,this.blendSrcAlpha=gn,this.blendDstAlpha=mn,this.separateAlphaBlend=!1,this.blendEquation=En,this.blendAlphaEquation=En,this.separateAlphaEquation=!1,t.blendFunc(t.ONE,t.ZERO),t.blendEquation(t.FUNC_ADD),this.writeRed=!0,this.writeGreen=!0,this.writeBlue=!0,this.writeAlpha=!0,t.colorMask(!0,!0,!0,!0),this.cullMode=Xn,t.enable(t.CULL_FACE),t.cullFace(t.BACK),this.depthTest=!0,t.enable(t.DEPTH_TEST),this.depthFunc=ss,t.depthFunc(t.LEQUAL),this.depthWrite=!0,t.depthMask(!0),this.stencil=!1,t.disable(t.STENCIL_TEST),this.stencilFuncFront=this.stencilFuncBack=ls,this.stencilRefFront=this.stencilRefBack=0,this.stencilMaskFront=this.stencilMaskBack=255,t.stencilFunc(t.ALWAYS,0,255),this.stencilFailFront=this.stencilFailBack=Rr,this.stencilZfailFront=this.stencilZfailBack=Rr,this.stencilZpassFront=this.stencilZpassBack=Rr,this.stencilWriteMaskFront=255,this.stencilWriteMaskBack=255,t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.stencilMask(255),this.alphaToCoverage=!1,this.raster=!0,this.webgl2&&(t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.disable(t.RASTERIZER_DISCARD)),this.depthBiasEnabled=!1,t.disable(t.POLYGON_OFFSET_FILL),this.clearDepth=1,t.clearDepth(1),this.clearRed=0,this.clearBlue=0,this.clearGreen=0,this.clearAlpha=0,t.clearColor(0,0,0,0),this.clearStencil=0,t.clearStencil(0),this.vx=this.vy=this.vw=this.vh=0,this.sx=this.sy=this.sw=this.sh=0,this.webgl2?t.hint(t.FRAGMENT_SHADER_DERIVATIVE_HINT,t.NICEST):this.extStandardDerivatives&&t.hint(this.extStandardDerivatives.FRAGMENT_SHADER_DERIVATIVE_HINT_OES,t.NICEST),t.enable(t.SCISSOR_TEST),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),this.unpackFlipY=!1,t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),this.unpackPremultiplyAlpha=!1,t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_ALIGNMENT,1)}initializeContextCaches(){this.vertexShaderCache={},this.fragmentShaderCache={},this._vaoMap=new Map,this.boundVao=null,this.indexBuffer=null,this.vertexBuffers=[],this.shader=null,this.renderTarget=null,this.activeFramebuffer=null,this.feedback=null,this.transformFeedbackBuffer=null,this.textureUnit=0,this.textureUnits=[];for(let t=0;t<this.maxCombinedTextures;t++)this.textureUnits.push([null,null,null])}loseContext(){for(const t of this.shaders)t.loseContext();for(this.destroyGrabPass();this.textures.length>0;){const t=this.textures[0];this.destroyTexture(t),t.dirtyAll()}for(const t of this.buffers)t.loseContext();for(const t of this.targets)t.loseContext()}restoreContext(){this.initializeExtensions(),this.initializeCapabilities(),this.initializeRenderState(),this.initializeContextCaches();for(const t of this.shaders)this.compileAndLinkShader(t);for(const t of this.buffers)t.unlock();this.createGrabPass()}createGrabPass(){if(this.grabPassTexture)return;const t=new _a(this,{format:!1===this.grabPassAlpha?bs:ys,minFilter:Zn,magFilter:Zn,addressU:pn,addressV:pn,mipmaps:!1});t.name="texture_grabPass";const e=this.scope.resolve(t.name);e.setValue(t);const i=new Gl({colorBuffer:t,depth:!1});this.grabPassRenderTarget=i,this.grabPassTextureId=e,this.grabPassTexture=t}updateGrabPass(){const t=this.gl;if(!this.grabPassAvailable)return!1;const e=this.renderTarget,i=e&&e._glResolveFrameBuffer,n=this.grabPassTexture,s=this.width,r=this.height;if(this.webgl2&&!this._tempMacChromeBlitFramebufferWorkaround&&s===n._width&&r===n._height){i&&e.resolve(!0);const n=e?e._glFrameBuffer:null,o=e?e._glResolveFrameBuffer||e._glFrameBuffer:null;this.initRenderTarget(this.grabPassRenderTarget);const a=this.grabPassRenderTarget._glFrameBuffer;t.bindFramebuffer(t.READ_FRAMEBUFFER,o),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,a),t.blitFramebuffer(0,0,s,r,0,0,s,r,t.COLOR_BUFFER_BIT,t.NEAREST),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,n)}else{i&&(e.resolve(!0),t.bindFramebuffer(t.FRAMEBUFFER,e._glResolveFrameBuffer));const o=n._glFormat;t.copyTexImage2D(t.TEXTURE_2D,0,o,0,0,s,r,0),n._width=s,n._height=r,i&&t.bindFramebuffer(t.FRAMEBUFFER,e._glFrameBuffer)}return!0}destroyGrabPass(){this.grabPassRenderTarget.destroy(),this.grabPassRenderTarget=null,this.grabPassTextureId=null,this.grabPassTexture.destroy(),this.grabPassTexture=null}updateClientRect(){this.clientRect=this.canvas.getBoundingClientRect()}setViewport(t,e,i,n){this.vx===t&&this.vy===e&&this.vw===i&&this.vh===n||(this.gl.viewport(t,e,i,n),this.vx=t,this.vy=e,this.vw=i,this.vh=n)}setScissor(t,e,i,n){this.sx===t&&this.sy===e&&this.sw===i&&this.sh===n||(this.gl.scissor(t,e,i,n),this.sx=t,this.sy=e,this.sw=i,this.sh=n)}getProgramLibrary(){return this.programLib}setProgramLibrary(t){this.programLib=t}setFramebuffer(t){this.activeFramebuffer!==t&&(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t),this.activeFramebuffer=t)}_checkFbo(){const t=this.gl;switch(t.checkFramebufferStatus(t.FRAMEBUFFER)){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.error("ERROR: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.error("ERROR: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:console.error("ERROR: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case t.FRAMEBUFFER_UNSUPPORTED:console.error("ERROR: FRAMEBUFFER_UNSUPPORTED");break;case t.FRAMEBUFFER_COMPLETE:}}copyRenderTarget(t,e,i,n){const s=this.gl;if(!this.webgl2&&n)return!1;if(i)if(e){if(!t._colorBuffer||!e._colorBuffer)return!1;if(t._colorBuffer._format!==e._colorBuffer._format)return!1}else if(!t._colorBuffer)return!1;if(n){if(!t._depthBuffer||!e._depthBuffer)return!1;if(t._depthBuffer._format!==e._depthBuffer._format)return!1}if(this.webgl2&&e){const r=this.renderTarget;this.renderTarget=e,this.updateBegin(),s.bindFramebuffer(s.READ_FRAMEBUFFER,t?t._glFrameBuffer:null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,e._glFrameBuffer);const o=t?t.width:e.width,a=t?t.height:e.height;s.blitFramebuffer(0,0,o,a,0,0,o,a,(i?s.COLOR_BUFFER_BIT:0)|(n?s.DEPTH_BUFFER_BIT:0),s.NEAREST),this.renderTarget=r,s.bindFramebuffer(s.FRAMEBUFFER,r?r._glFrameBuffer:null)}else{const i=this.getCopyShader();this.constantTexSource.setValue(t._colorBuffer),zo(this,e,i)}return!0}initRenderTarget(t){if(t._glFrameBuffer)return;t._device=this;const e=this.gl;t._glFrameBuffer=e.createFramebuffer(),this.setFramebuffer(t._glFrameBuffer);const i=t._colorBuffer;i&&(i._glTexture||(i._width=Math.min(i.width,this.maxRenderBufferSize),i._height=Math.min(i.height,this.maxRenderBufferSize),this.setTexture(i,0)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,i._cubemap?e.TEXTURE_CUBE_MAP_POSITIVE_X+t._face:e.TEXTURE_2D,i._glTexture,0));const n=t._depthBuffer;if(n&&this.webgl2)n._glTexture||(n._width=Math.min(n.width,this.maxRenderBufferSize),n._height=Math.min(n.height,this.maxRenderBufferSize),this.setTexture(n,0)),t._stencil?e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,n._cubemap?e.TEXTURE_CUBE_MAP_POSITIVE_X+t._face:e.TEXTURE_2D,t._depthBuffer._glTexture,0):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,n._cubemap?e.TEXTURE_CUBE_MAP_POSITIVE_X+t._face:e.TEXTURE_2D,t._depthBuffer._glTexture,0);else if(t._depth){t._samples>1&&this.webgl2||(t._glDepthBuffer||(t._glDepthBuffer=e.createRenderbuffer()),e.bindRenderbuffer(e.RENDERBUFFER,t._glDepthBuffer),t._stencil?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t._glDepthBuffer)):(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t._glDepthBuffer)),e.bindRenderbuffer(e.RENDERBUFFER,null))}this.webgl2&&t._samples>1&&(t._glResolveFrameBuffer=t._glFrameBuffer,t._glFrameBuffer=e.createFramebuffer(),this.setFramebuffer(t._glFrameBuffer),i&&(t._glMsaaColorBuffer||(t._glMsaaColorBuffer=e.createRenderbuffer()),e.bindRenderbuffer(e.RENDERBUFFER,t._glMsaaColorBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,t._samples,i._glInternalFormat,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,t._glMsaaColorBuffer)),t._depth&&(t._glMsaaDepthBuffer||(t._glMsaaDepthBuffer=e.createRenderbuffer()),e.bindRenderbuffer(e.RENDERBUFFER,t._glMsaaDepthBuffer),t._stencil?(e.renderbufferStorageMultisample(e.RENDERBUFFER,t._samples,e.DEPTH24_STENCIL8,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t._glMsaaDepthBuffer)):(e.renderbufferStorageMultisample(e.RENDERBUFFER,t._samples,e.DEPTH_COMPONENT32F,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t._glMsaaDepthBuffer)))),this.targets.push(t)}getCopyShader(){return this._copyShader||(this._copyShader=ia(this,jo.fullscreenQuadVS,jo.outputTex2DPS,"outputTex2D")),this._copyShader}updateBegin(){if(this.boundVao=null,this._tempEnableSafariTextureUnitWorkaround)for(let t=0;t<this.textureUnits.length;++t)for(let e=0;e<3;++e)this.textureUnits[t][e]=null;const t=this.renderTarget;t?t._glFrameBuffer?this.setFramebuffer(t._glFrameBuffer):this.initRenderTarget(t):this.setFramebuffer(this.defaultFramebuffer)}updateEnd(){const t=this.gl;this.boundVao&&(this.boundVao=null,this.gl.bindVertexArray(null));const e=this.renderTarget;if(e){const i=e._colorBuffer;i&&i._glTexture&&i.mipmaps&&(i.pot||this.webgl2)&&(this.activeTexture(this.maxCombinedTextures-1),this.bindTexture(i),t.generateMipmap(i._glTarget)),this.webgl2&&e._samples>1&&e.autoResolve&&e.resolve()}}initializeTexture(t){const e=this.gl;let i;switch(t._glTexture=e.createTexture(),t._glTarget=t._cubemap?e.TEXTURE_CUBE_MAP:t._volume?e.TEXTURE_3D:e.TEXTURE_2D,t._format){case us:t._glFormat=e.ALPHA,t._glInternalFormat=e.ALPHA,t._glPixelType=e.UNSIGNED_BYTE;break;case ds:t._glFormat=e.LUMINANCE,t._glInternalFormat=e.LUMINANCE,t._glPixelType=e.UNSIGNED_BYTE;break;case ps:t._glFormat=e.LUMINANCE_ALPHA,t._glInternalFormat=e.LUMINANCE_ALPHA,t._glPixelType=e.UNSIGNED_BYTE;break;case fs:t._glFormat=e.RGB,t._glInternalFormat=e.RGB,t._glPixelType=e.UNSIGNED_SHORT_5_6_5;break;case ms:t._glFormat=e.RGBA,t._glInternalFormat=e.RGBA,t._glPixelType=e.UNSIGNED_SHORT_5_5_5_1;break;case gs:t._glFormat=e.RGBA,t._glInternalFormat=e.RGBA,t._glPixelType=e.UNSIGNED_SHORT_4_4_4_4;break;case bs:t._glFormat=e.RGB,t._glInternalFormat=this.webgl2?e.RGB8:e.RGB,t._glPixelType=e.UNSIGNED_BYTE;break;case ys:t._glFormat=e.RGBA,t._glInternalFormat=this.webgl2?e.RGBA8:e.RGBA,t._glPixelType=e.UNSIGNED_BYTE;break;case vs:i=this.extCompressedTextureS3TC,t._glFormat=e.RGB,t._glInternalFormat=i.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case Ss:i=this.extCompressedTextureS3TC,t._glFormat=e.RGBA,t._glInternalFormat=i.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case xs:i=this.extCompressedTextureS3TC,t._glFormat=e.RGBA,t._glInternalFormat=i.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;case Ds:i=this.extCompressedTextureETC1,t._glFormat=e.RGB,t._glInternalFormat=i.COMPRESSED_RGB_ETC1_WEBGL;break;case Fs:i=this.extCompressedTexturePVRTC,t._glFormat=e.RGB,t._glInternalFormat=i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case Bs:i=this.extCompressedTexturePVRTC,t._glFormat=e.RGBA,t._glInternalFormat=i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;break;case Ns:i=this.extCompressedTexturePVRTC,t._glFormat=e.RGB,t._glInternalFormat=i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case Us:i=this.extCompressedTexturePVRTC,t._glFormat=e.RGBA,t._glInternalFormat=i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case ks:i=this.extCompressedTextureETC,t._glFormat=e.RGB,t._glInternalFormat=i.COMPRESSED_RGB8_ETC2;break;case Os:i=this.extCompressedTextureETC,t._glFormat=e.RGBA,t._glInternalFormat=i.COMPRESSED_RGBA8_ETC2_EAC;break;case Vs:i=this.extCompressedTextureASTC,t._glFormat=e.RGBA,t._glInternalFormat=i.COMPRESSED_RGBA_ASTC_4x4_KHR;break;case zs:i=this.extCompressedTextureATC,t._glFormat=e.RGB,t._glInternalFormat=i.COMPRESSED_RGB_ATC_WEBGL;break;case Ws:i=this.extCompressedTextureATC,t._glFormat=e.RGBA,t._glInternalFormat=i.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL;break;case ws:i=this.extTextureHalfFloat,t._glFormat=e.RGB,this.webgl2?(t._glInternalFormat=e.RGB16F,t._glPixelType=e.HALF_FLOAT):(t._glInternalFormat=e.RGB,t._glPixelType=i.HALF_FLOAT_OES);break;case Cs:i=this.extTextureHalfFloat,t._glFormat=e.RGBA,this.webgl2?(t._glInternalFormat=e.RGBA16F,t._glPixelType=e.HALF_FLOAT):(t._glInternalFormat=e.RGBA,t._glPixelType=i.HALF_FLOAT_OES);break;case Ts:t._glFormat=e.RGB,this.webgl2?t._glInternalFormat=e.RGB32F:t._glInternalFormat=e.RGB,t._glPixelType=e.FLOAT;break;case As:t._glFormat=e.RGBA,this.webgl2?t._glInternalFormat=e.RGBA32F:t._glInternalFormat=e.RGBA,t._glPixelType=e.FLOAT;break;case Es:t._glFormat=e.RED,t._glInternalFormat=e.R32F,t._glPixelType=e.FLOAT;break;case Ms:this.webgl2?(t._glFormat=e.DEPTH_COMPONENT,t._glInternalFormat=e.DEPTH_COMPONENT32F,t._glPixelType=e.FLOAT):(t._glFormat=e.DEPTH_COMPONENT,t._glInternalFormat=e.DEPTH_COMPONENT,t._glPixelType=e.UNSIGNED_SHORT);break;case Rs:t._glFormat=e.DEPTH_STENCIL,t._glInternalFormat=e.DEPTH24_STENCIL8,t._glPixelType=e.UNSIGNED_INT_24_8;break;case Is:t._glFormat=e.RGB,t._glInternalFormat=e.R11F_G11F_B10F,t._glPixelType=e.UNSIGNED_INT_10F_11F_11F_REV;break;case Ps:t._glFormat=e.RGB,t._glInternalFormat=e.SRGB8,t._glPixelType=e.UNSIGNED_BYTE;break;case Ls:t._glFormat=e.RGBA,t._glInternalFormat=e.SRGB8_ALPHA8,t._glPixelType=e.UNSIGNED_BYTE}this.textures.push(t)}destroyTexture(t){if(t._glTexture){const e=this.textures.indexOf(t);-1!==e&&this.textures.splice(e,1),this.scope.removeValue(t);for(let e=0;e<this.textureUnits.length;e++){const i=this.textureUnits[e];for(let e=0;e<i.length;e++)i[e]===t._glTexture&&(i[e]=null)}this.gl.deleteTexture(t._glTexture),delete t._glTexture,delete t._glTarget,delete t._glFormat,delete t._glInternalFormat,delete t._glPixelType,this._vram.tex-=t._gpuSize}}setUnpackFlipY(t){if(this.unpackFlipY!==t){this.unpackFlipY=t;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t)}}setUnpackPremultiplyAlpha(t){if(this.unpackPremultiplyAlpha!==t){this.unpackPremultiplyAlpha=t;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t)}}_isBrowserInterface(t){return"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap}uploadTexture(t){const e=this.gl;if(!t._needsUpload&&(t._needsMipmapsUpload&&t._mipmapsUploaded||!t.pot))return;let i,n,s=0;const r=Math.log2(Math.max(t._width,t._height))+1;for(;t._levels[s]||0===s;)if(t._needsUpload||0!==s){if(s&&(!t._needsMipmapsUpload||!t._mipmaps))break;if(i=t._levels[s],1===s&&!t._compressed&&t._levels.length<r&&(e.generateMipmap(t._glTarget),t._mipmapsUploaded=!0),t._cubemap){let r;if(this._isBrowserInterface(i[0]))for(r=0;r<6;r++){if(!t._levelsUpdated[0][r])continue;let n=i[r];n instanceof HTMLImageElement&&(n.width>this.maxCubeMapSize||n.height>this.maxCubeMapSize)&&(n=Ul(n,this.maxCubeMapSize),0===s&&(t._width=n.width,t._height=n.height)),this.setUnpackFlipY(!1),this.setUnpackPremultiplyAlpha(t._premultiplyAlpha),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,s,t._glInternalFormat,t._glFormat,t._glPixelType,n)}else for(n=1/Math.pow(2,s),r=0;r<6;r++){if(!t._levelsUpdated[0][r])continue;const o=i[r];t._compressed?e.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,s,t._glInternalFormat,Math.max(t._width*n,1),Math.max(t._height*n,1),0,o):(this.setUnpackFlipY(!1),this.setUnpackPremultiplyAlpha(t._premultiplyAlpha),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,s,t._glInternalFormat,Math.max(t._width*n,1),Math.max(t._height*n,1),0,t._glFormat,t._glPixelType,o))}}else t._volume?(n=1/Math.pow(2,s),t._compressed?e.compressedTexImage3D(e.TEXTURE_3D,s,t._glInternalFormat,Math.max(t._width*n,1),Math.max(t._height*n,1),Math.max(t._depth*n,1),0,i):(this.setUnpackFlipY(!1),this.setUnpackPremultiplyAlpha(t._premultiplyAlpha),e.texImage3D(e.TEXTURE_3D,s,t._glInternalFormat,Math.max(t._width*n,1),Math.max(t._height*n,1),Math.max(t._depth*n,1),0,t._glFormat,t._glPixelType,i))):(this._isBrowserInterface(i)?(i instanceof HTMLImageElement&&(i.width>this.maxTextureSize||i.height>this.maxTextureSize)&&(i=Ul(i,this.maxTextureSize),0===s&&(t._width=i.width,t._height=i.height)),this.setUnpackFlipY(t._flipY),this.setUnpackPremultiplyAlpha(t._premultiplyAlpha),e.texImage2D(e.TEXTURE_2D,s,t._glInternalFormat,t._glFormat,t._glPixelType,i)):(n=1/Math.pow(2,s),t._compressed?e.compressedTexImage2D(e.TEXTURE_2D,s,t._glInternalFormat,Math.max(t._width*n,1),Math.max(t._height*n,1),0,i):(this.setUnpackFlipY(!1),this.setUnpackPremultiplyAlpha(t._premultiplyAlpha),e.texImage2D(e.TEXTURE_2D,s,t._glInternalFormat,Math.max(t._width*n,1),Math.max(t._height*n,1),0,t._glFormat,t._glPixelType,i))),t._mipmapsUploaded=0!==s);s++}else s++;if(t._needsUpload)if(t._cubemap)for(let e=0;e<6;e++)t._levelsUpdated[0][e]=!1;else t._levelsUpdated[0]=!1;!t._compressed&&t._mipmaps&&t._needsMipmapsUpload&&(t.pot||this.webgl2)&&1===t._levels.length&&(e.generateMipmap(t._glTarget),t._mipmapsUploaded=!0),t._gpuSize&&(this._vram.tex-=t._gpuSize),t._gpuSize=t.gpuSize,this._vram.tex+=t._gpuSize}activeTexture(t){this.textureUnit!==t&&(this.gl.activeTexture(this.gl.TEXTURE0+t),this.textureUnit=t)}bindTexture(t){const e=t._glTarget,i=t._glTexture,n=this.textureUnit,s=this.targetToSlot[e];this.textureUnits[n][s]!==i&&(this.gl.bindTexture(e,i),this.textureUnits[n][s]=i)}bindTextureOnUnit(t,e){const i=t._glTarget,n=t._glTexture,s=this.targetToSlot[i];this.textureUnits[e][s]!==n&&(this.activeTexture(e),this.gl.bindTexture(i,n),this.textureUnits[e][s]=n)}setTextureParameters(t){const e=this.gl,i=t._parameterFlags,n=t._glTarget;if(1&i){let i=t._minFilter;(!t.pot&&!this.webgl2||!t._mipmaps||t._compressed&&1===t._levels.length)&&(i===Qn||i===$n?i=Kn:i!==Jn&&i!==ts||(i=Zn)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,this.glFilter[i])}if(2&i&&e.texParameteri(n,e.TEXTURE_MAG_FILTER,this.glFilter[t._magFilter]),4&i&&(this.webgl2?e.texParameteri(n,e.TEXTURE_WRAP_S,this.glAddress[t._addressU]):e.texParameteri(n,e.TEXTURE_WRAP_S,this.glAddress[t.pot?t._addressU:pn])),8&i&&(this.webgl2?e.texParameteri(n,e.TEXTURE_WRAP_T,this.glAddress[t._addressV]):e.texParameteri(n,e.TEXTURE_WRAP_T,this.glAddress[t.pot?t._addressV:pn])),16&i&&this.webgl2&&e.texParameteri(n,e.TEXTURE_WRAP_R,this.glAddress[t._addressW]),32&i&&this.webgl2&&e.texParameteri(n,e.TEXTURE_COMPARE_MODE,t._compareOnRead?e.COMPARE_REF_TO_TEXTURE:e.NONE),64&i&&this.webgl2&&e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,this.glComparison[t._compareFunc]),128&i){const i=this.extTextureFilterAnisotropic;i&&e.texParameterf(n,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.max(1,Math.min(Math.round(t._anisotropy),this.maxAnisotropy)))}}setTexture(t,e){if(t._glTexture||this.initializeTexture(t),t._parameterFlags>0||t._needsUpload||t._needsMipmapsUpload||t===this.grabPassTexture){this.activeTexture(e),this.bindTexture(t),t._parameterFlags&&(this.setTextureParameters(t),t._parameterFlags=0);t===this.grabPassTexture&&this.updateGrabPass()||!t._needsUpload&&!t._needsMipmapsUpload||(this.uploadTexture(t),t._needsUpload=!1,t._needsMipmapsUpload=!1)}else this.bindTextureOnUnit(t,e)}createVertexArray(t){let e,i;const n=t.length>1;if(n){e="";for(let i=0;i<t.length;i++){const n=t[i];e+=n.id+n.format.renderingingHash}i=this._vaoMap.get(e)}if(!i){const s=this.gl;i=s.createVertexArray(),s.bindVertexArray(i),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,null);for(let e=0;e<t.length;e++){const i=t[e];s.bindBuffer(s.ARRAY_BUFFER,i.bufferId);const n=i.format.elements;for(let t=0;t<n.length;t++){const e=n[t],r=ko[e.name];s.vertexAttribPointer(r,e.numComponents,this.glType[e.dataType],e.normalize,e.stride,e.offset),s.enableVertexAttribArray(r),i.instancing&&s.vertexAttribDivisor(r,1)}}s.bindVertexArray(null),s.bindBuffer(s.ARRAY_BUFFER,null),n&&this._vaoMap.set(e,i)}return i}setBuffers(){const t=this.gl;let e;if(1===this.vertexBuffers.length){const t=this.vertexBuffers[0];t._vao||(t._vao=this.createVertexArray(this.vertexBuffers)),e=t._vao}else e=this.createVertexArray(this.vertexBuffers);this.boundVao!==e&&(this.boundVao=e,t.bindVertexArray(e)),this.vertexBuffers.length=0;const i=this.indexBuffer?this.indexBuffer.bufferId:null;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i)}draw(t,e,i){const n=this.gl;let s,r,o,a,l,h,c,_;const u=this.shader;if(!u)return;const d=u.samplers,p=u.uniforms;i||this.setBuffers();let f=0;for(let t=0,e=d.length;t<e;t++)if(s=d[t],r=s.scopeId.value,r)if(r instanceof _a)o=r,this.setTexture(o,f),s.slot!==f&&(n.uniform1i(s.locationId,f),s.slot=f),f++;else{s.array.length=0,a=r.length;for(let t=0;t<a;t++)o=r[t],this.setTexture(o,f),s.array[t]=f,f++;n.uniform1iv(s.locationId,s.array)}for(let t=0,e=p.length;t<e;t++)l=p[t],h=l.scopeId,c=l.version,_=h.versionObject.version,c.globalId===_.globalId&&c.revision===_.revision||(c.globalId=_.globalId,c.revision=_.revision,null!==h.value&&this.commitFunction[l.dataType](l,h.value));this.webgl2&&this.transformFeedbackBuffer&&(n.bindBufferBase(n.TRANSFORM_FEEDBACK_BUFFER,0,this.transformFeedbackBuffer.bufferId),n.beginTransformFeedback(n.POINTS));const m=this.glPrimitive[t.type],g=t.count;if(t.indexed){const i=this.indexBuffer,s=i.glFormat,r=t.base*i.bytesPerIndex;e>0?n.drawElementsInstanced(m,g,s,r,e):n.drawElements(m,g,s,r)}else{const i=t.base;e>0?n.drawArraysInstanced(m,i,g,e):n.drawArrays(m,i,g)}this.webgl2&&this.transformFeedbackBuffer&&(n.endTransformFeedback(),n.bindBufferBase(n.TRANSFORM_FEEDBACK_BUFFER,0,null)),this._drawCallsPerFrame++}clear(t){const e=this.defaultClearOptions,i=null==(t=t||e).flags?e.flags:t.flags;if(0!==i){const n=this.gl;if(i&Fn){const i=null==t.color?e.color:t.color;this.setClearColor(i[0],i[1],i[2],i[3])}if(i&Bn){const i=null==t.depth?e.depth:t.depth;this.setClearDepth(i),this.depthWrite||n.depthMask(!0)}if(i&Nn){const i=null==t.stencil?e.stencil:t.stencil;this.setClearStencil(i)}n.clear(this.glClearFlag[i]),i&Bn&&(this.depthWrite||n.depthMask(!1))}}readPixels(t,e,i,n,s){const r=this.gl;r.readPixels(t,e,i,n,r.RGBA,r.UNSIGNED_BYTE,s)}setClearDepth(t){t!==this.clearDepth&&(this.gl.clearDepth(t),this.clearDepth=t)}setClearColor(t,e,i,n){t===this.clearRed&&e===this.clearGreen&&i===this.clearBlue&&n===this.clearAlpha||(this.gl.clearColor(t,e,i,n),this.clearRed=t,this.clearGreen=e,this.clearBlue=i,this.clearAlpha=n)}setClearStencil(t){t!==this.clearStencil&&(this.gl.clearStencil(t),this.clearStencil=t)}setRenderTarget(t){this.renderTarget=t}getRenderTarget(){return this.renderTarget}getDepthTest(){return this.depthTest}setDepthTest(t){if(this.depthTest!==t){const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.depthTest=t}}setDepthFunc(t){this.depthFunc!==t&&(this.gl.depthFunc(this.glComparison[t]),this.depthFunc=t)}getDepthWrite(){return this.depthWrite}setDepthWrite(t){this.depthWrite!==t&&(this.gl.depthMask(t),this.depthWrite=t)}setColorWrite(t,e,i,n){this.writeRed===t&&this.writeGreen===e&&this.writeBlue===i&&this.writeAlpha===n||(this.gl.colorMask(t,e,i,n),this.writeRed=t,this.writeGreen=e,this.writeBlue=i,this.writeAlpha=n)}setAlphaToCoverage(t){this.webgl2&&this.alphaToCoverage!==t&&(this.alphaToCoverage=t,t?this.gl.enable(this.gl.SAMPLE_ALPHA_TO_COVERAGE):this.gl.disable(this.gl.SAMPLE_ALPHA_TO_COVERAGE))}setTransformFeedbackBuffer(t){if(this.transformFeedbackBuffer!==t&&(this.transformFeedbackBuffer=t,this.webgl2)){const e=this.gl;t?(this.feedback||(this.feedback=e.createTransformFeedback()),e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,this.feedback)):e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}}setRaster(t){this.raster!==t&&(this.raster=t,this.webgl2&&(t?this.gl.disable(this.gl.RASTERIZER_DISCARD):this.gl.enable(this.gl.RASTERIZER_DISCARD)))}setDepthBias(t){this.depthBiasEnabled!==t&&(this.depthBiasEnabled=t,t?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL))}setDepthBiasValues(t,e){this.gl.polygonOffset(e,t)}getBlending(){return this.blending}setBlending(t){if(this.blending!==t){const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.blending=t}}setStencilTest(t){if(this.stencil!==t){const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.stencil=t}}setStencilFunc(t,e,i){if(this.stencilFuncFront!==t||this.stencilRefFront!==e||this.stencilMaskFront!==i||this.stencilFuncBack!==t||this.stencilRefBack!==e||this.stencilMaskBack!==i){this.gl.stencilFunc(this.glComparison[t],e,i),this.stencilFuncFront=this.stencilFuncBack=t,this.stencilRefFront=this.stencilRefBack=e,this.stencilMaskFront=this.stencilMaskBack=i}}setStencilFuncFront(t,e,i){if(this.stencilFuncFront!==t||this.stencilRefFront!==e||this.stencilMaskFront!==i){const n=this.gl;n.stencilFuncSeparate(n.FRONT,this.glComparison[t],e,i),this.stencilFuncFront=t,this.stencilRefFront=e,this.stencilMaskFront=i}}setStencilFuncBack(t,e,i){if(this.stencilFuncBack!==t||this.stencilRefBack!==e||this.stencilMaskBack!==i){const n=this.gl;n.stencilFuncSeparate(n.BACK,this.glComparison[t],e,i),this.stencilFuncBack=t,this.stencilRefBack=e,this.stencilMaskBack=i}}setStencilOperation(t,e,i,n){this.stencilFailFront===t&&this.stencilZfailFront===e&&this.stencilZpassFront===i&&this.stencilFailBack===t&&this.stencilZfailBack===e&&this.stencilZpassBack===i||(this.gl.stencilOp(this.glStencilOp[t],this.glStencilOp[e],this.glStencilOp[i]),this.stencilFailFront=this.stencilFailBack=t,this.stencilZfailFront=this.stencilZfailBack=e,this.stencilZpassFront=this.stencilZpassBack=i),this.stencilWriteMaskFront===n&&this.stencilWriteMaskBack===n||(this.gl.stencilMask(n),this.stencilWriteMaskFront=n,this.stencilWriteMaskBack=n)}setStencilOperationFront(t,e,i,n){this.stencilFailFront===t&&this.stencilZfailFront===e&&this.stencilZpassFront===i||(this.gl.stencilOpSeparate(this.gl.FRONT,this.glStencilOp[t],this.glStencilOp[e],this.glStencilOp[i]),this.stencilFailFront=t,this.stencilZfailFront=e,this.stencilZpassFront=i),this.stencilWriteMaskFront!==n&&(this.gl.stencilMaskSeparate(this.gl.FRONT,n),this.stencilWriteMaskFront=n)}setStencilOperationBack(t,e,i,n){this.stencilFailBack===t&&this.stencilZfailBack===e&&this.stencilZpassBack===i||(this.gl.stencilOpSeparate(this.gl.BACK,this.glStencilOp[t],this.glStencilOp[e],this.glStencilOp[i]),this.stencilFailBack=t,this.stencilZfailBack=e,this.stencilZpassBack=i),this.stencilWriteMaskBack!==n&&(this.gl.stencilMaskSeparate(this.gl.BACK,n),this.stencilWriteMaskBack=n)}setBlendFunction(t,e){(this.blendSrc!==t||this.blendDst!==e||this.separateAlphaBlend)&&(this.gl.blendFunc(this.glBlendFunction[t],this.glBlendFunction[e]),this.blendSrc=t,this.blendDst=e,this.separateAlphaBlend=!1)}setBlendFunctionSeparate(t,e,i,n){this.blendSrc===t&&this.blendDst===e&&this.blendSrcAlpha===i&&this.blendDstAlpha===n&&this.separateAlphaBlend||(this.gl.blendFuncSeparate(this.glBlendFunction[t],this.glBlendFunction[e],this.glBlendFunction[i],this.glBlendFunction[n]),this.blendSrc=t,this.blendDst=e,this.blendSrcAlpha=i,this.blendDstAlpha=n,this.separateAlphaBlend=!0)}setBlendEquation(t){(this.blendEquation!==t||this.separateAlphaEquation)&&(this.gl.blendEquation(this.glBlendEquation[t]),this.blendEquation=t,this.separateAlphaEquation=!1)}setBlendEquationSeparate(t,e){this.blendEquation===t&&this.blendAlphaEquation===e&&this.separateAlphaEquation||(this.gl.blendEquationSeparate(this.glBlendEquation[t],this.glBlendEquation[e]),this.blendEquation=t,this.blendAlphaEquation=e,this.separateAlphaEquation=!0)}setCullMode(t){if(this.cullMode!==t){if(t===Hn)this.gl.disable(this.gl.CULL_FACE);else{this.cullMode===Hn&&this.gl.enable(this.gl.CULL_FACE);const e=this.glCull[t];this.cullFace!==e&&(this.gl.cullFace(e),this.cullFace=e)}this.cullMode=t}}getCullMode(){return this.cullMode}setIndexBuffer(t){this.indexBuffer=t}setVertexBuffer(t){t&&this.vertexBuffers.push(t)}compileShaderSource(t,e){const i=this.gl;let n=e?this.vertexShaderCache[t]:this.fragmentShaderCache[t];return n||(n=i.createShader(e?i.VERTEX_SHADER:i.FRAGMENT_SHADER),i.shaderSource(n,t),i.compileShader(n),e?this.vertexShaderCache[t]=n:this.fragmentShaderCache[t]=n),n}compileAndLinkShader(t){const e=this.gl,i=t.definition,n=i.attributes,s=this.compileShaderSource(i.vshader,!0),r=this.compileShaderSource(i.fshader,!1),o=e.createProgram();if(e.attachShader(o,s),e.attachShader(o,r),this.webgl2&&i.useTransformFeedback){const t=[];for(const e in n)n.hasOwnProperty(e)&&t.push("out_"+e);e.transformFeedbackVaryings(o,t,e.INTERLEAVED_ATTRIBS)}const a={};for(const t in n)if(n.hasOwnProperty(t)){const i=n[t],s=ko[i];a[s]=t,e.bindAttribLocation(o,s,t)}e.linkProgram(o),t._glVertexShader=s,t._glFragmentShader=r,t._glProgram=o}createShader(t){this.compileAndLinkShader(t),this.shaders.push(t)}destroyShader(t){const e=this.shaders.indexOf(t);-1!==e&&this.shaders.splice(e,1),t._glProgram&&(this.gl.deleteProgram(t._glProgram),t._glProgram=null,this.removeShaderFromCache(t))}_isShaderCompiled(t,e,i,n){const s=this.gl;if(!s.getShaderParameter(e,s.COMPILE_STATUS)){const t=s.getShaderInfoLog(e),[r,o]=this._processError(i,t);return console.error(`Failed to compile ${n} shader:\n\n${t}\n${r}`),!1}return!0}_processError(t,e){if(!t)return"";const i=t.split("\n"),n={};let s="",r=0,o=i.length;if(e&&e.startsWith("ERROR:")){const t=e.match(/^ERROR:\s([0-9]+):([0-9]+):\s*(.+)/);t&&(n.message=t[3],n.line=parseInt(t[2],10),r=Math.max(0,n.line-6),o=Math.min(i.length,n.line+5))}for(let t=r;t<o;t++)s+=t+1+":\t"+i[t]+"\n";return n.source=t,[s,n]}postLink(t){const e=this.gl,i=t._glProgram,n=t.definition;if(!this._isShaderCompiled(t,t._glVertexShader,n.vshader,"vertex"))return!1;if(!this._isShaderCompiled(t,t._glFragmentShader,n.fshader,"fragment"))return!1;if(!e.getProgramParameter(i,e.LINK_STATUS))return console.error("Failed to link shader program. Error: "+e.getProgramInfoLog(i)),!1;let s,r,o,a;s=0;const l=e.getProgramParameter(i,e.ACTIVE_ATTRIBUTES);for(;s<l;)r=e.getActiveAttrib(i,s++),o=e.getAttribLocation(i,r.name),void 0===n.attributes[r.name]&&console.error(`Vertex shader attribute "${r.name}" is not mapped to a semantic in shader definition.`),a=new Nl(this,n.attributes[r.name],this.pcUniformType[r.type],o),t.attributes.push(a);s=0;const h=e.getProgramParameter(i,e.ACTIVE_UNIFORMS);for(;s<h;)r=e.getActiveUniform(i,s++),o=e.getUniformLocation(i,r.name),a=new Nl(this,r.name,this.pcUniformType[r.type],o),r.type===e.SAMPLER_2D||r.type===e.SAMPLER_CUBE||this.webgl2&&(r.type===e.SAMPLER_2D_SHADOW||r.type===e.SAMPLER_CUBE_SHADOW||r.type===e.SAMPLER_3D)?t.samplers.push(a):t.uniforms.push(a);return t.ready=!0,!0}setShader(t){if(t!==this.shader){if(!t.ready&&!this.postLink(t))return!1;this.shader=t,this.gl.useProgram(t._glProgram),this.attributesInvalidated=!0}return!0}getHdrFormat(){return this.textureHalfFloatRenderable?Cs:this.textureFloatRenderable?As:ys}getBoneLimit(){return this.boneLimit}setBoneLimit(t){this.boneLimit=t}resizeCanvas(t,e){this._width=t,this._height=e;const i=Math.min(this._maxPixelRatio,B.browser?window.devicePixelRatio:1);t=Math.floor(t*i),e=Math.floor(e*i),this.canvas.width===t&&this.canvas.height===e||(this.canvas.width=t,this.canvas.height=e,this.fire("resizecanvas",t,e))}setResolution(t,e){this._width=t,this._height=e,this.canvas.width=t,this.canvas.height=e,this.fire("resizecanvas",t,e)}clearShaderCache(){const t=this.gl;for(const e in this.fragmentShaderCache)t.deleteShader(this.fragmentShaderCache[e]),delete this.fragmentShaderCache[e];for(const e in this.vertexShaderCache)t.deleteShader(this.vertexShaderCache[e]),delete this.vertexShaderCache[e];this.programLib.clearCache()}clearVertexArrayObjectCache(){const t=this.gl;this._vaoMap.forEach((e,i,n)=>{t.deleteVertexArray(e)}),this._vaoMap.clear()}removeShaderFromCache(t){this.programLib.removeFromCache(t)}get width(){return this.gl.drawingBufferWidth||this.canvas.width}get height(){return this.gl.drawingBufferHeight||this.canvas.height}get fullscreen(){return!!document.fullscreenElement}set fullscreen(t){if(t){this.gl.canvas.requestFullscreen()}else document.exitFullscreen()}get enableAutoInstancing(){return this._enableAutoInstancing}set enableAutoInstancing(t){this._enableAutoInstancing=t&&this.extInstancing}get maxPixelRatio(){return this._maxPixelRatio}set maxPixelRatio(t){this._maxPixelRatio=t,this.resizeCanvas(this._width,this._height)}get textureFloatHighPrecision(){return void 0===this._textureFloatHighPrecision&&(this._textureFloatHighPrecision=function(t){if(!t.textureFloatRenderable)return!1;const e=ia(t,jo.fullscreenQuadVS,jo.precisionTestPS,"ptest1"),i=ia(t,jo.fullscreenQuadVS,jo.precisionTest2PS,"ptest2"),n={format:As,width:1,height:1,mipmaps:!1,minFilter:Kn,magFilter:Kn},s=new _a(t,n);s.name="testFHP";const r=new Gl({colorBuffer:s,depth:!1});zo(t,r,e),n.format=ys;const o=new _a(t,n);o.name="testFHP";const a=new Gl({colorBuffer:o,depth:!1});t.constantTexSource.setValue(s),zo(t,a,i);const l=t.activeFramebuffer;t.setFramebuffer(a._glFrameBuffer);const h=new Uint8Array(4);t.readPixels(0,0,1,1,h),t.setFramebuffer(l);const c=h[0]/255/16777216+h[1]/255/65536+h[2]/255/256+h[3]/255;return s.destroy(),r.destroy(),o.destroy(),a.destroy(),0===c}(this)),this._textureFloatHighPrecision}get textureHalfFloatUpdatable(){return void 0===this._textureHalfFloatUpdatable&&(this.webgl2?this._textureHalfFloatUpdatable=!0:this._textureHalfFloatUpdatable=function(t,e){let i=!0;const n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const s=new Uint16Array(16);return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,2,2,0,t.RGBA,e,s),t.getError()!==t.NO_ERROR&&(i=!1,console.log("Above error related to HALF_FLOAT_OES can be ignored, it was triggered by testing half float texture support")),t.bindTexture(t.TEXTURE_2D,null),t.deleteTexture(n),i}(this.gl,this.extTextureHalfFloat.HALF_FLOAT_OES)),this._textureHalfFloatUpdatable}}const Wl={depth:!0,face:0};class Gl{constructor(t){const e=arguments[1],i=arguments[2];if(t instanceof zl?(this._colorBuffer=e,t=i):this._colorBuffer=t.colorBuffer,this._colorBuffer&&(this._colorBuffer._isRenderTarget=!0),this._device=null,this._glFrameBuffer=null,this._glDepthBuffer=null,t=void 0!==t?t:Wl,this._depthBuffer=t.depthBuffer,this._face=void 0!==t.face?t.face:0,this._depthBuffer){const t=this._depthBuffer._format;t===Ms?(this._depth=!0,this._stencil=!1):t===Rs?(this._depth=!0,this._stencil=!0):(this._depth=!1,this._stencil=!1)}else this._depth=void 0===t.depth||t.depth,this._stencil=void 0!==t.stencil&&t.stencil;var n,s;(this._samples=void 0!==t.samples?t.samples:1,this.autoResolve=void 0===t.autoResolve||t.autoResolve,this._glResolveFrameBuffer=null,this._glMsaaColorBuffer=null,this._glMsaaDepthBuffer=null,this.name=t.name,this.name)||(this.name=null==(n=this._colorBuffer)?void 0:n.name);this.name||(this.name=null==(s=this._depthBuffer)?void 0:s.name);this.name||(this.name="Untitled"),this.flipY=!!t.flipY}destroy(){const t=this._device;if(t){const e=t.targets.indexOf(this);-1!==e&&t.targets.splice(e,1),this.destroyFrameBuffers()}}destroyFrameBuffers(){const t=this._device;if(t){const e=t.gl;this._glFrameBuffer&&(e.deleteFramebuffer(this._glFrameBuffer),this._glFrameBuffer=null),this._glDepthBuffer&&(e.deleteRenderbuffer(this._glDepthBuffer),this._glDepthBuffer=null),this._glResolveFrameBuffer&&(e.deleteFramebuffer(this._glResolveFrameBuffer),this._glResolveFrameBuffer=null),this._glMsaaColorBuffer&&(e.deleteRenderbuffer(this._glMsaaColorBuffer),this._glMsaaColorBuffer=null),this._glMsaaDepthBuffer&&(e.deleteRenderbuffer(this._glMsaaDepthBuffer),this._glMsaaDepthBuffer=null)}}destroyTextureBuffers(){this._depthBuffer&&(this._depthBuffer.destroy(),this._depthBuffer=null),this._colorBuffer&&(this._colorBuffer.destroy(),this._colorBuffer=null)}loseContext(){this._glFrameBuffer=void 0,this._glDepthBuffer=void 0,this._glResolveFrameBuffer=void 0,this._glMsaaColorBuffer=void 0,this._glMsaaDepthBuffer=void 0}resolve(t=!0,e=!!this._depthBuffer){if(!this._device)return;if(!this._device.webgl2)return;const i=this._device.gl;i.bindFramebuffer(i.READ_FRAMEBUFFER,this._glFrameBuffer),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,this._glResolveFrameBuffer),i.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,(t?i.COLOR_BUFFER_BIT:0)|(e?i.DEPTH_BUFFER_BIT:0),i.NEAREST),i.bindFramebuffer(i.FRAMEBUFFER,this._glFrameBuffer)}copy(t,e,i){if(!this._device){if(!t._device)return!1;this._device=t._device}return this._device.copyRenderTarget(t,this,e,i)}get colorBuffer(){return this._colorBuffer}get depthBuffer(){return this._depthBuffer}get face(){return this._face}get width(){return this._colorBuffer?this._colorBuffer.width:this._depthBuffer.width}get height(){return this._colorBuffer?this._colorBuffer.height:this._depthBuffer.height}}function jl(t,e,i){var n=e._colorBuffer;if(n.format===ys){var s=new Uint8Array(n.width*n.height*4),r=t.gl;t.setFramebuffer(e._glFrameBuffer),r.readPixels(0,0,n.width,n.height,r.RGBA,r.UNSIGNED_BYTE,s),n._levels||(n._levels=[]),n._levels[0]||(n._levels[0]=[]),n._levels[0][i]=s}}function Hl(t){var e=t.device,i=t.sourceCubemap,n=t.method,s=t.samples,r=t.cpuSync;if(!r||i._levels[0]){var o,a,l,h,c,_,u=i.type,d=u===Vr,p=ia(e,jo.fullscreenQuadVS,jo.rgbmPS+jo.prefilterCubemapPS.replace(/\$METHOD/g,0===n?"cos":"phong").replace(/\$NUMSAMPLES/g,s).replace(/\$textureCube/g,d?"textureCubeRGBM":"textureCube"),"prefilter"+n+s+d),f=ia(e,jo.fullscreenQuadVS,jo.outputCubemapPS,"outputCubemap"),m=e.scope.resolve("source"),g=e.scope.resolve("params"),b=new Float32Array(4),y=i.width,v=i.format,S=[[],t.filteredFixed,t.filteredRgbm,t.filteredFixedRgbm],x=0===n?[.9,.85,.7,.4,.25,.15,.1]:[512,128,32,8,2,1,1],w=[64,32,16,8,4,2,1],C=v===bs,T=!1;if(r&&(T=i._levels[0][0]instanceof HTMLImageElement),(C||T)&&r){for((c=new _a(e,{cubemap:!0,type:u,format:v=ys,width:y,height:y,mipmaps:!1})).name="prefiltered-cube",l=0;l<6;l++)o=new Gl({colorBuffer:c,face:l,depth:!1}),b[0]=l,b[1]=0,m.setValue(i),g.setValue(b),zo(e,o,f),jl(e,o,l);i=c}if(y>128){var A=Math.round(Math.log2(128)),E=Math.round(Math.log2(y))-A;for(a=0;a<E;a++){y=.5*i.width;var M=0===n?1:Math.pow(2,Math.round(Math.log2(x[0])+2*(E-a)));for((c=new _a(e,{cubemap:!0,type:u,format:v,width:y,height:y,mipmaps:!1})).name="prefiltered-cube",l=0;l<6;l++)o=new Gl({colorBuffer:c,face:l,depth:!1}),b[0]=l,b[1]=M,b[2]=y,b[3]=d?3:0,m.setValue(i),g.setValue(b),zo(e,o,f),a===E-1&&r&&jl(e,o,l);i=c}}t.sourceCubemap=i;var R=null;if(!d&&t.filteredFixedRgbm){for((c=new _a(e,{cubemap:!0,type:Vr,format:ys,width:y,height:y,mipmaps:!1})).name="prefiltered-cube",l=0;l<6;l++)o=new Gl({colorBuffer:c,face:l,depth:!1}),b[0]=l,b[3]=2,m.setValue(i),g.setValue(b),zo(e,o,f),jl(e,o,l);R=c}var I,P=0===n?1:2048,L=0===n?0:-1;for(S[L]=[],a=0;a<7;a++)for(h=L;h<S.length;h++)null!=S[h]&&(S[h][a]=new _a(e,{cubemap:!0,type:h<2?u:Vr,format:h<2?v:ys,fixCubemapSeams:1===h||3===h,width:w[a],height:w[a],mipmaps:!1}),S[h][a].name="prefiltered-cube");for(h=L;h<S.length;h++)if(null!=S[h]){if(h>1&&d){S[h]=S[h-2];continue}for(a=0;a<7;a++)for(l=0;l<6;l++)o=new Gl({colorBuffer:S[h][a],face:l,depth:!1}),b[0]=l,b[1]=h<0?P:x[a],b[2]=w[a],b[3]=d?3:h,m.setValue(0===a?i:0===n?S[0][a-1]:S[-1][a-1]),g.setValue(b),zo(e,o,p),r&&jl(e,o,l)}if(t.filtered=S[0],r&&t.singleFilteredFixed){for(I=[i].concat(t.filteredFixed),(_=new _a(e,{cubemap:!0,type:u,fixCubemapSeams:!0,format:v,width:128,height:128,addressU:pn,addressV:pn})).name="prefiltered-cube",a=0;a<I.length;a++)_._levels[a]=I[a]._levels[0];_.upload(),t.singleFilteredFixed=_}if(r&&t.singleFilteredFixedRgbm&&t.filteredFixedRgbm){for(I=[R].concat(t.filteredFixedRgbm),(_=new _a(e,{cubemap:!0,type:Vr,fixCubemapSeams:!0,format:ys,width:128,height:128,addressU:pn,addressV:pn})).name="prefiltered-cube",a=0;a<I.length;a++)_._levels[a]=I[a]._levels[0];_.upload(),t.singleFilteredFixedRgbm=_}}}function Xl(t,e){return Math.atan2(t*e,Math.sqrt(t*t+e*e+1))}function Yl(t,e,i){var n=2*(t+.5)/i-1,s=2*(e+.5)/i-1,r=1/i,o=(n*=1-1/i)-r,a=(s*=1-1/i)-r,l=n+r,h=s+r,c=Xl(o,a)-Xl(o,h)-Xl(l,a)+Xl(l,h);return 0===t&&0===e||t===i-1&&0===e||0===t&&e===i-1||t===i-1&&e===i-1?c/=3:0!==t&&0!==e&&t!==i-1&&e!==i-1||(c*=.5),c}function ql(t,e,i){var n,s,r,o=e.width;if(e.format!==ys)return null;if(!e._levels[0]||!e._levels[0][0])return null;if(!e._levels[0][0].length){if(!(e._levels[0][0]instanceof HTMLImageElement))return null;var a=t.gl,l=ia(t,jo.fullscreenQuadVS,jo.fullscreenQuadPS,"fsQuadSimple"),h=t.scope.resolve("source");for(n=0;n<6;n++){var c=e._levels[0][n],_=new _a(t,{cubemap:!1,type:Ur,format:e.format,width:o,height:o,mipmaps:!1});_.name="prefiltered-cube",_._levels[0]=c,_.upload();var u=new _a(t,{cubemap:!1,type:Ur,format:e.format,width:o,height:o,mipmaps:!1});u.name="prefiltered-cube";var d=new Gl({colorBuffer:u,depth:!1});h.setValue(_),zo(t,d,l);var p=new Uint8Array(o*o*4);a.bindFramebuffer(a.FRAMEBUFFER,d._glFrameBuffer),a.readPixels(0,0,_.width,_.height,a.RGBA,a.UNSIGNED_BYTE,p),e._levels[0][n]=p}}var f=[];for(r=0;r<o;r++)for(s=0;s<o;s++){var m=s/(o-1)*2-1,g=r/(o-1)*2-1;f[r*o+s]=new ht(m,g,1).normalize()}var b,y,v,S,x,w,C,T,A,E,M,R,I,P,L=new Float32Array(27),D=0;for(n=0;n<6;n++)for(r=0;r<o;r++)for(s=0;s<o;s++)for(b=r*o+s,E=4*(x=Yl(s,r,o))/17,M=8*x/17,R=15*x/17,I=5*x/68,P=15*x/68,w=f[b],0==n?(C=w.z,T=-w.y,A=-w.x):1===n?(C=-w.z,T=-w.y,A=w.x):2===n?(C=w.x,T=w.z,A=w.y):3===n?(C=w.x,T=-w.z,A=-w.y):4===n?(C=w.x,T=-w.y,A=w.z):5===n&&(C=-w.x,T=-w.y,A=-w.z),i||(C=-C),v=e._levels[0][n][4*b+3]/255,y=0;y<3;y++)S=e._levels[0][n][4*b+y]/255,e.type===Vr?(S*=8*v,S*=S):S=Math.pow(S,2.2),L[0+y]+=S*E,L[3+y]+=S*M*C,L[6+y]+=S*M*T,L[9+y]+=S*M*A,L[12+y]+=S*R*C*A,L[15+y]+=S*R*A*T,L[18+y]+=S*R*T*C,L[21+y]+=S*I*(3*A*A-1),L[24+y]+=S*P*(C*C-T*T),D+=x;for(y=0;y<L.length;y++)L[y]*=4*Math.PI/D;return L}function Kl(t){switch(t.type){case Vr:return"RGBM";case zr:return"RGBE";default:switch(t.format){case ws:case Ts:case Cs:case As:return"Linear";default:return"Gamma"}}}function Zl(t){switch(t===Yr&&(t=Kr),t){case qr:return"Cubemap";case Kr:return"Equirect";case Zr:return"Octahedral"}}function Ql(t,e,i={}){t instanceof zl&&(t=arguments[1],e=arguments[2],i={specularPower:void 0===arguments[3]?1:arguments[3],numSamples:void 0===arguments[4]?1024:arguments[4]});const n=t.device,s=i.hasOwnProperty("specularPower")?i.specularPower:1,r=i.hasOwnProperty("numSamples")?i.numSamples:1024,o=i.hasOwnProperty("face")?i.face:null,a=1===s?"reproject":"prefilter",l="decode"+Kl(t),h="encode"+Kl(e),c="sample"+Zl(t.projection),_="getDirection"+Zl(e.projection),u=ia(n,jo.fullscreenQuadVS,"#define PROCESS_FUNC "+a+"\n#define DECODE_FUNC "+l+"\n#define ENCODE_FUNC "+h+"\n#define SOURCE_FUNC "+c+"\n#define TARGET_FUNC "+_+"\n#define NUM_SAMPLES "+r+"\n#define NUM_SAMPLES_SQRT "+Math.round(Math.sqrt(r)).toFixed(1)+"\n\n"+jo.reprojectPS,a+l+h+c+_,null,n.webgl2?"":"#extension GL_OES_standard_derivatives: enable\n"),d=n.scope.resolve(t.cubemap?"sourceCube":"sourceTex");d.setValue(t);const p=n.scope.resolve("params"),f=[0,s,1-(t.fixCubemapSeams?1/t.width:0),1-(e.fixCubemapSeams?1/e.width:0)];for(let t=0;t<(e.cubemap?6:1);t++)if(null===o||t===o){const i=new Gl({colorBuffer:e,face:t,depth:!1});f[0]=t,p.setValue(f),zo(n,i,u),i.destroy()}}class $l{constructor(t,e,i,n=Ln,s){this.device=t,this.format=e,this.numIndices=i,this.usage=n;const r=this.device.gl;let o;e===hs?(o=1,this.glFormat=r.UNSIGNED_BYTE):e===cs?(o=2,this.glFormat=r.UNSIGNED_SHORT):e===_s&&(o=4,this.glFormat=r.UNSIGNED_INT),this.bytesPerIndex=o,this.numBytes=this.numIndices*o,s?this.setData(s):this.storage=new ArrayBuffer(this.numBytes),t._vram.ib+=this.numBytes,this.device.buffers.push(this)}destroy(){const t=this.device,e=t.buffers.indexOf(this);if(-1!==e&&t.buffers.splice(e,1),this.bufferId){this.device.gl.deleteBuffer(this.bufferId),this.device._vram.ib-=this.storage.byteLength,this.bufferId=null,this.device.indexBuffer===this&&(this.device.indexBuffer=null)}}loseContext(){this.bufferId=void 0}getFormat(){return this.format}getNumIndices(){return this.numIndices}lock(){return this.storage}unlock(){const t=this.device.gl;let e;switch(this.bufferId||(this.bufferId=t.createBuffer()),this.usage){case Ln:e=t.STATIC_DRAW;break;case Dn:e=t.DYNAMIC_DRAW;break;case kn:e=t.STREAM_DRAW;break;case On:e=this.device.webgl2?t.DYNAMIC_COPY:t.STATIC_DRAW}t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.bufferId),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.storage,e)}setData(t){return t.byteLength===this.numBytes&&(this.storage=t,this.unlock(),!0)}_lockTypedArray(){const t=this.lock();return this.format===_s?new Uint32Array(t):this.format===cs?new Uint16Array(t):new Uint8Array(t)}writeData(t,e){const i=this._lockTypedArray();if(t.length>e)if(ArrayBuffer.isView(t))t=t.subarray(0,e),i.set(t);else for(let n=0;n<e;n++)i[n]=t[n];else i.set(t);this.unlock()}readData(t){const e=this._lockTypedArray(),i=this.numIndices;if(ArrayBuffer.isView(t))t.set(e);else{t.length=0;for(let n=0;n<i;n++)t[n]=e[n]}return i}}function Jl(t){this.array[this.index]=t}function th(t,e){this.array[this.index]=t,this.array[this.index+1]=e}function eh(t,e,i){this.array[this.index]=t,this.array[this.index+1]=e,this.array[this.index+2]=i}function ih(t,e,i,n){this.array[this.index]=t,this.array[this.index+1]=e,this.array[this.index+2]=i,this.array[this.index+3]=n}function nh(t,e,i){this.array[t]=e[i]}function sh(t,e,i){this.array[t]=e[i],this.array[t+1]=e[i+1]}function rh(t,e,i){this.array[t]=e[i],this.array[t+1]=e[i+1],this.array[t+2]=e[i+2]}function oh(t,e,i){this.array[t]=e[i],this.array[t+1]=e[i+1],this.array[t+2]=e[i+2],this.array[t+3]=e[i+3]}function ah(t,e,i){e[i]=this.array[t]}function lh(t,e,i){e[i]=this.array[t],e[i+1]=this.array[t+1]}function hh(t,e,i){e[i]=this.array[t],e[i+1]=this.array[t+1],e[i+2]=this.array[t+2]}function ch(t,e,i){e[i]=this.array[t],e[i+1]=this.array[t+1],e[i+2]=this.array[t+2],e[i+3]=this.array[t+3]}class _h{constructor(t,e,i){switch(this.index=0,this.numComponents=e.numComponents,i.interleaved?this.array=new Ro[e.dataType](t,e.offset):this.array=new Ro[e.dataType](t,e.offset,i.vertexCount*e.numComponents),this.stride=e.stride/this.array.constructor.BYTES_PER_ELEMENT,e.numComponents){case 1:this.set=Jl,this.getToArray=ah,this.setFromArray=nh;break;case 2:this.set=th,this.getToArray=lh,this.setFromArray=sh;break;case 3:this.set=eh,this.getToArray=hh,this.setFromArray=rh;break;case 4:this.set=ih,this.getToArray=ch,this.setFromArray=oh}}get(t){return this.array[this.index+t]}set(t,e,i,n){}getToArray(t,e,i){}setFromArray(t,e,i){}}class uh{constructor(t){this.vertexBuffer=t,this.vertexFormatSize=t.getFormat().size,this.buffer=this.vertexBuffer.lock(),this.accessors=[],this.element={};const e=this.vertexBuffer.getFormat();for(let t=0;t<e.elements.length;t++){const i=e.elements[t];this.accessors[t]=new _h(this.buffer,i,e),this.element[i.name]=this.accessors[t]}}next(t=1){let e=0;const i=this.accessors,n=this.accessors.length;for(;e<n;){const n=i[e++];n.index+=t*n.stride}}end(){this.vertexBuffer.unlock()}writeData(t,e,i){const n=this.element[t];if(n){i>this.vertexBuffer.numVertices&&(i=this.vertexBuffer.numVertices);const t=n.numComponents;if(this.vertexBuffer.getFormat().interleaved){let s=0;for(let r=0;r<i;r++)n.setFromArray(s,e,r*t),s+=n.stride}else if(e.length>i*t){const s=i*t;if(ArrayBuffer.isView(e))e=e.subarray(0,s),n.array.set(e);else for(let t=0;t<s;t++)n.array[t]=e[t]}else n.array.set(e)}}readData(t,e){const i=this.element[t];let n=0;if(i){let t;n=this.vertexBuffer.numVertices;const s=i.numComponents;if(this.vertexBuffer.getFormat().interleaved){Array.isArray(e)&&(e.length=0),i.index=0;let r=0;for(t=0;t<n;t++)i.getToArray(r,e,t*s),r+=i.stride}else if(ArrayBuffer.isView(e))e.set(i.array);else{e.length=0;const r=n*s;for(t=0;t<r;t++)e[t]=i.array[t]}}return n}}const dh={type:qs,base:0,count:4,indexed:!1};class ph{constructor(t){this.device=t,this.shader=null,this.depthMap=null,this.vertexBuffer=fh(t),this.needsDepthBuffer=!1}render(t,e,i){}}function fh(t){const e=new No(t,[{semantic:Zs,components:2,type:no}]),i=new Fo(t,e,4),n=new uh(i);return n.element[Zs].set(-1,-1),n.next(),n.element[Zs].set(1,-1),n.next(),n.element[Zs].set(-1,1),n.next(),n.element[Zs].set(1,1),n.end(),i}function mh(t,e,i,n,s){const r=t.getRenderTarget();t.setRenderTarget(e),t.updateBegin();let o=e?e.width:t.width,a=e?e.height:t.height,l=0,h=0;s&&(l=s.x*o,h=s.y*a,o*=s.z,a*=s.w);const c=t.vx,_=t.vy,u=t.vw,d=t.vh;t.setViewport(l,h,o,a);const p=t.sx,f=t.sy,m=t.sw,g=t.sh;t.setScissor(l,h,o,a);const b=t.getBlending(),y=t.getDepthTest(),v=t.getDepthWrite(),S=t.getCullMode(),x=t.writeRed,w=t.writeGreen,C=t.writeBlue,T=t.writeAlpha;t.setBlending(!1),t.setDepthTest(!1),t.setDepthWrite(!1),t.setCullMode(Hn),t.setColorWrite(!0,!0,!0,!0),t.setVertexBuffer(i,0),t.setShader(n),t.draw(dh),t.setBlending(b),t.setDepthTest(y),t.setDepthWrite(v),t.setCullMode(S),t.setColorWrite(x,w,C,T),t.updateEnd(),t.setRenderTarget(r),t.updateBegin(),t.setViewport(c,_,u,d),t.setScissor(p,f,m,g)}class gh{constructor(t,e=On){this.device=t.device;const i=this.device.gl;this._inputBuffer=t,e===On&&t.usage!==e&&(i.bindBuffer(i.ARRAY_BUFFER,t.bufferId),i.bufferData(i.ARRAY_BUFFER,t.storage,i.DYNAMIC_COPY)),this._outputBuffer=new Fo(t.device,t.format,t.numVertices,e,t.storage)}static createShader(t,e,i){return ia(t,e,null,i,!0)}destroy(){this._outputBuffer.destroy()}process(t,e=!0){const i=this.device,n=i.getRenderTarget();if(i.setRenderTarget(null),i.updateBegin(),i.setVertexBuffer(this._inputBuffer,0),i.setRaster(!1),i.setTransformFeedbackBuffer(this._outputBuffer),i.setShader(t),i.draw({type:Gs,base:0,count:this._inputBuffer.numVertices,indexed:!1}),i.setTransformFeedbackBuffer(null),i.setRaster(!0),i.updateEnd(),i.setRenderTarget(n),e){let t=this._inputBuffer.bufferId;this._inputBuffer.bufferId=this._outputBuffer.bufferId,this._outputBuffer.bufferId=t,t=this._inputBuffer._vao,this._inputBuffer._vao=this._outputBuffer._vao,this._outputBuffer._vao=t}}get inputBuffer(){return this._inputBuffer}get outputBuffer(){return this._outputBuffer}}class bh{constructor(){this._refCount=0}incRefCount(){this._refCount++}decRefCount(){this._refCount--}getRefCount(){return this._refCount}}let yh=0;class vh{constructor(){this.initDefaults()}initDefaults(){this.recreate=!1,this.verticesUsage=Ln,this.indicesUsage=Ln,this.maxVertices=0,this.maxIndices=0,this.vertexCount=0,this.indexCount=0,this.vertexStreamsUpdated=!1,this.indexStreamUpdated=!1,this.vertexStreamDictionary={},this.indices=null}_validateVertexCount(t,e){}_changeVertexCount(t,e){this.vertexCount?this._validateVertexCount(t,e):this.vertexCount=t}}vh.DEFAULT_COMPONENTS_POSITION=3,vh.DEFAULT_COMPONENTS_NORMAL=3,vh.DEFAULT_COMPONENTS_UV=2,vh.DEFAULT_COMPONENTS_COLORS=4;class Sh{constructor(t,e,i,n){this.data=t,this.componentCount=e,this.dataType=i,this.dataTypeNormalize=n}}class xh extends bh{constructor(t){super(),this.id=yh++,this.device=t||Ka().graphicsDevice,this.vertexBuffer=null,this.indexBuffer=[null],this.primitive=[{type:0,base:0,count:0}],this.skin=null,this.morph=null,this._geometryData=null,this._aabb=new Tt,this.boneAabb=null}get aabb(){return this._aabb}set aabb(t){this._aabb=t}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBuffer=null);for(let t=0;t<this.indexBuffer.length;t++)this._destroyIndexBuffer(t);this.indexBuffer.length=0,this._geometryData=null}_destroyIndexBuffer(t){this.indexBuffer[t]&&(this.indexBuffer[t].destroy(),this.indexBuffer[t]=null)}_initBoneAabbs(t){let e,i,n,s,r;this.boneAabb=[],this.boneUsed=[];const o=[],a=[],l=this.boneUsed,h=this.skin.boneNames.length;let c,_,u;for(let t=0;t<h;t++)o[t]=new ht(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a[t]=new ht(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);const d=new uh(this.vertexBuffer),p=d.element[Zs],f=d.element[Js],m=d.element[tr],g=this.vertexBuffer.numVertices;for(let h=0;h<g;h++){for(let d=0;d<4;d++){if(f.array[f.index+d]>0){const f=m.array[m.index+d];if(l[f]=!0,e=p.array[p.index],i=p.array[p.index+1],n=p.array[p.index+2],s=a[f],r=o[f],r.x>e&&(r.x=e),r.y>i&&(r.y=i),r.z>n&&(r.z=n),s.x<e&&(s.x=e),s.y<i&&(s.y=i),s.z<n&&(s.z=n),t){let o=c=e,a=_=i,l=u=n;for(let e=0;e<t.length;e++){const i=t[e],n=i.deltaPositions[3*h],s=i.deltaPositions[3*h+1],r=i.deltaPositions[3*h+2];n<0?o+=n:c+=n,s<0?a+=s:_+=s,r<0?l+=r:u+=r}r.x>o&&(r.x=o),r.y>a&&(r.y=a),r.z>l&&(r.z=l),s.x<c&&(s.x=c),s.y<_&&(s.y=_),s.z<u&&(s.z=u)}}}d.next()}const b=this.vertexBuffer.getFormat().elements.find(t=>t.name===Zs);if(b&&b.normalize){const t=(()=>{switch(b.dataType){case Qr:return t=>Math.max(t/127,-1);case $r:return t=>t/255;case Jr:return t=>Math.max(t/32767,-1);case to:return t=>t/65535;default:return t=>t}})();for(let e=0;e<h;e++)if(l[e]){const i=o[e],n=a[e];i.set(t(i.x),t(i.y),t(i.z)),n.set(t(n.x),t(n.y),t(n.z))}}for(let t=0;t<h;t++){const e=new Tt;e.setMinMax(o[t],a[t]),this.boneAabb.push(e)}}_initGeometryData(){this._geometryData||(this._geometryData=new vh,this.vertexBuffer&&(this._geometryData.vertexCount=this.vertexBuffer.numVertices,this._geometryData.maxVertices=this.vertexBuffer.numVertices),this.indexBuffer.length>0&&this.indexBuffer[0]&&(this._geometryData.indexCount=this.indexBuffer[0].numIndices,this._geometryData.maxIndices=this.indexBuffer[0].numIndices))}clear(t,e,i=0,n=0){this._initGeometryData(),this._geometryData.initDefaults(),this._geometryData.recreate=!0,this._geometryData.maxVertices=i,this._geometryData.maxIndices=n,this._geometryData.verticesUsage=t?Ln:Dn,this._geometryData.indicesUsage=e?Ln:Dn}setVertexStream(t,e,i,n,s=no,r=!1){this._initGeometryData();const o=n||e.length/i;this._geometryData._changeVertexCount(o,t),this._geometryData.vertexStreamsUpdated=!0,this._geometryData.vertexStreamDictionary[t]=new Sh(e,i,s,r)}getVertexStream(t,e){let i=0,n=!1;if(this._geometryData){const s=this._geometryData.vertexStreamDictionary[t];s&&(n=!0,i=this._geometryData.vertexCount,ArrayBuffer.isView(e)?e.set(s.data):(e.length=0,e.push(s.data)))}if(!n&&this.vertexBuffer){i=new uh(this.vertexBuffer).readData(t,e)}return i}setPositions(t,e=vh.DEFAULT_COMPONENTS_POSITION,i){this.setVertexStream(Zs,t,e,i,no,!1)}setNormals(t,e=vh.DEFAULT_COMPONENTS_NORMAL,i){this.setVertexStream(Qs,t,e,i,no,!1)}setUvs(t,e,i=vh.DEFAULT_COMPONENTS_UV,n){this.setVertexStream(ir+t,e,i,n,no,!1)}setColors(t,e=vh.DEFAULT_COMPONENTS_COLORS,i){this.setVertexStream(er,t,e,i,no,!1)}setColors32(t,e){this.setVertexStream(er,t,vh.DEFAULT_COMPONENTS_COLORS,e,$r,!0)}setIndices(t,e){this._initGeometryData(),this._geometryData.indexStreamUpdated=!0,this._geometryData.indices=t,this._geometryData.indexCount=e||t.length}getPositions(t){return this.getVertexStream(Zs,t)}getNormals(t){return this.getVertexStream(Qs,t)}getUvs(t,e){return this.getVertexStream(ir+t,e)}getColors(t){return this.getVertexStream(er,t)}getIndices(t){let e=0;if(this._geometryData&&this._geometryData.indices){const i=this._geometryData.indices;e=this._geometryData.indexCount,ArrayBuffer.isView(t)?t.set(i):(t.length=0,t.push(i))}else if(this.indexBuffer.length>0&&this.indexBuffer[0]){e=this.indexBuffer[0].readData(t)}return e}update(t=Ys,e=!0){if(this._geometryData){if(e){const t=this._geometryData.vertexStreamDictionary[Zs];t&&3===t.componentCount&&this._aabb.compute(t.data,this._geometryData.vertexCount)}let i=this._geometryData.recreate;this._geometryData.vertexCount>this._geometryData.maxVertices&&(i=!0,this._geometryData.maxVertices=this._geometryData.vertexCount),i&&this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBuffer=null);let n=this._geometryData.recreate;this._geometryData.indexCount>this._geometryData.maxIndices&&(n=!0,this._geometryData.maxIndices=this._geometryData.indexCount),n&&this.indexBuffer.length>0&&this.indexBuffer[0]&&(this.indexBuffer[0].destroy(),this.indexBuffer[0]=null),this._geometryData.vertexStreamsUpdated&&this._updateVertexBuffer(),this._geometryData.indexStreamUpdated&&this._updateIndexBuffer(),this.primitive[0].type=t,this.indexBuffer.length>0&&this.indexBuffer[0]?this._geometryData.indexStreamUpdated&&(this.primitive[0].count=this._geometryData.indexCount,this.primitive[0].indexed=!0):this._geometryData.vertexStreamsUpdated&&(this.primitive[0].count=this._geometryData.vertexCount,this.primitive[0].indexed=!1),this._geometryData.vertexCount=0,this._geometryData.indexCount=0,this._geometryData.vertexStreamsUpdated=!1,this._geometryData.indexStreamUpdated=!1,this._geometryData.recreate=!1,this.updateRenderStates()}}_buildVertexFormat(t){const e=[];for(const t in this._geometryData.vertexStreamDictionary){const i=this._geometryData.vertexStreamDictionary[t];e.push({semantic:t,components:i.componentCount,type:i.dataType,normalize:i.dataTypeNormalize})}return new No(this.device,e,t)}_updateVertexBuffer(){if(!this.vertexBuffer){const t=this._geometryData.maxVertices,e=this._buildVertexFormat(t);this.vertexBuffer=new Fo(this.device,e,t,this._geometryData.verticesUsage)}const t=new uh(this.vertexBuffer),e=this._geometryData.vertexCount;for(const i in this._geometryData.vertexStreamDictionary){const n=this._geometryData.vertexStreamDictionary[i];t.writeData(i,n.data,e),delete this._geometryData.vertexStreamDictionary[i]}t.end()}_updateIndexBuffer(){if(this.indexBuffer.length<=0||!this.indexBuffer[0]){const t=this._geometryData.maxVertices>65535?_s:cs;this.indexBuffer[0]=new $l(this.device,t,this._geometryData.maxIndices,this._geometryData.indicesUsage)}const t=this._geometryData.indices;if(t){this.indexBuffer[0].writeData(t,this._geometryData.indexCount),this._geometryData.indices=null}}prepareRenderState(t){t===ke?this.generateWireframe():t===Oe&&(this.primitive[Oe]={type:Gs,base:0,count:this.vertexBuffer?this.vertexBuffer.numVertices:0,indexed:!1})}updateRenderStates(){this.primitive[Oe]&&this.prepareRenderState(Oe),this.primitive[ke]&&this.prepareRenderState(ke)}generateWireframe(){this._destroyIndexBuffer(ke);const t=[];let e;if(this.indexBuffer.length>0&&this.indexBuffer[0]){const i=[[0,1],[1,2],[2,0]],n=this.primitive[De].base,s=this.primitive[De].count,r=this.indexBuffer[De],o=new Lo[r.format](r.storage),a={};for(let e=n;e<n+s;e+=3)for(let n=0;n<3;n++){const s=o[e+i[n][0]],r=o[e+i[n][1]],l=s>r?r<<16|s:s<<16|r;void 0===a[l]&&(a[l]=0,t.push(s,r))}e=r.format}else{for(let e=0;e<this.vertexBuffer.numVertices;e+=3)t.push(e,e+1,e+1,e+2,e+2,e);e=t.length>65535?_s:cs}const i=new $l(this.vertexBuffer.device,e,t.length);new Lo[i.format](i.storage).set(t),i.unlock(),this.primitive[ke]={type:js,base:0,count:t.length,indexed:!0},this.indexBuffer[ke]=i}}const wh=[];function Ch(t,e){var i,n,s,r,o=e.length/3,a=t.length/3,l=new ht,h=new ht,c=new ht,_=new ht,u=new ht,d=new ht,p=[];for(r=0;r<t.length;r++)p[r]=0;for(r=0;r<o;r++)i=e[3*r],n=e[3*r+1],s=e[3*r+2],l.set(t[3*i],t[3*i+1],t[3*i+2]),h.set(t[3*n],t[3*n+1],t[3*n+2]),c.set(t[3*s],t[3*s+1],t[3*s+2]),_.sub2(h,l),u.sub2(c,l),d.cross(_,u).normalize(),p[3*i]+=d.x,p[3*i+1]+=d.y,p[3*i+2]+=d.z,p[3*n]+=d.x,p[3*n+1]+=d.y,p[3*n+2]+=d.z,p[3*s]+=d.x,p[3*s+1]+=d.y,p[3*s+2]+=d.z;for(r=0;r<a;r++){var f=p[3*r],m=p[3*r+1],g=p[3*r+2],b=1/Math.sqrt(f*f+m*m+g*g);p[3*r]*=b,p[3*r+1]*=b,p[3*r+2]*=b}return p}function Th(t,e,i,n){var s,r,o,a,l,h,c,_,u,d,p,f,m,g,b,y=n.length/3,v=t.length/3,S=new ht,x=new ht,w=new ht,C=new ht,T=new ht,A=new _t,E=new _t,M=new _t,R=new Float32Array(3*v),I=new Float32Array(3*v),P=[],L=0;for(b=0;b<y;b++)s=n[3*b],r=n[3*b+1],o=n[3*b+2],w.set(t[3*s],t[3*s+1],t[3*s+2]),C.set(t[3*r],t[3*r+1],t[3*r+2]),T.set(t[3*o],t[3*o+1],t[3*o+2]),A.set(i[2*s],i[2*s+1]),E.set(i[2*r],i[2*r+1]),M.set(i[2*o],i[2*o+1]),a=C.x-w.x,l=T.x-w.x,h=C.y-w.y,c=T.y-w.y,_=C.z-w.z,u=T.z-w.z,d=E.x-A.x,p=M.x-A.x,f=E.y-A.y,0===(L=d*(m=M.y-A.y)-p*f)?(S.set(0,1,0),x.set(1,0,0)):(g=1/L,S.set((m*a-f*l)*g,(m*h-f*c)*g,(m*_-f*u)*g),x.set((d*l-p*a)*g,(d*c-p*h)*g,(d*u-p*_)*g)),R[3*s+0]+=S.x,R[3*s+1]+=S.y,R[3*s+2]+=S.z,R[3*r+0]+=S.x,R[3*r+1]+=S.y,R[3*r+2]+=S.z,R[3*o+0]+=S.x,R[3*o+1]+=S.y,R[3*o+2]+=S.z,I[3*s+0]+=x.x,I[3*s+1]+=x.y,I[3*s+2]+=x.z,I[3*r+0]+=x.x,I[3*r+1]+=x.y,I[3*r+2]+=x.z,I[3*o+0]+=x.x,I[3*o+1]+=x.y,I[3*o+2]+=x.z;f=new ht,m=new ht;var D=new ht,k=new ht;for(b=0;b<v;b++){D.set(e[3*b],e[3*b+1],e[3*b+2]),f.set(R[3*b],R[3*b+1],R[3*b+2]),m.set(I[3*b],I[3*b+1],I[3*b+2]);var O=D.dot(f);k.copy(D).mulScalar(O),k.sub2(f,k).normalize(),P[4*b]=k.x,P[4*b+1]=k.y,P[4*b+2]=k.z,k.cross(D,f),P[4*b+3]=k.dot(m)<0?-1:1}return P}function Ah(t,e,i){const n=new xh(t);return n.setPositions(e),i&&(i.normals&&n.setNormals(i.normals),i.tangents&&n.setVertexStream($s,i.tangents,4),i.colors&&n.setColors32(i.colors),i.uvs&&n.setUvs(0,i.uvs),i.uvs1&&n.setUvs(1,i.uvs1),i.blendIndices&&n.setVertexStream(tr,i.blendIndices,4,$r),i.blendWeights&&n.setVertexStream(Js,i.blendWeights,4),i.indices&&n.setIndices(i.indices)),n.update(),n}function Eh(t,e){var i,n,s,r,o,a,l,h,c,_,u=e&&void 0!==e.tubeRadius?e.tubeRadius:.2,d=e&&void 0!==e.ringRadius?e.ringRadius:.3,p=e&&void 0!==e.segments?e.segments:30,f=e&&void 0!==e.sides?e.sides:20,m=!(!e||void 0===e.calculateTangents)&&e.calculateTangents,g=[],b=[],y=[],v=[];for(i=0;i<=f;i++)for(n=0;n<=p;n++){var S,x,w,C;if(s=Math.cos(2*Math.PI*n/p)*(d+u*Math.cos(2*Math.PI*i/f)),r=Math.sin(2*Math.PI*i/f)*u,o=Math.sin(2*Math.PI*n/p)*(d+u*Math.cos(2*Math.PI*i/f)),a=Math.cos(2*Math.PI*n/p)*Math.cos(2*Math.PI*i/f),l=Math.sin(2*Math.PI*i/f),h=Math.sin(2*Math.PI*n/p)*Math.cos(2*Math.PI*i/f),c=i/f,_=1-n/p,g.push(s,r,o),b.push(a,l,h),y.push(c,1-_),i<f&&n<p)S=i*(p+1)+n,x=(i+1)*(p+1)+n,w=i*(p+1)+(n+1),C=(i+1)*(p+1)+(n+1),v.push(S,x,w),v.push(x,C,w)}var T={normals:b,uvs:y,indices:v};return m&&(T.tangents=Th(g,b,y,v)),Ah(t,g,T)}function Mh(t,e,i,n,s,r){var o,a,l,h,c,_,u,d,p,f,m,g,b,y,v,S,x,w,C,T,A=new ht,E=new ht,M=new ht,R=[],I=[],P=[],L=[],D=[];if(i>0)for(o=0;o<=n;o++)for(a=0;a<=s;a++){m=a/s*2*Math.PI-Math.PI,b=Math.sin(m),g=Math.cos(m),p=new ht(b*t,-i/2,g*t),d=new ht(b*e,i/2,g*e),A.lerp(p,d,o/n),E.sub2(d,p).normalize(),f=new ht(g,0,-b),M.cross(f,E).normalize(),R.push(A.x,A.y,A.z),I.push(M.x,M.y,M.z),_=a/s,u=o/n,P.push(_,1-u);var k=u;u=_,_=.875*(_=k)+4/64,u=.875*u+4/64,_/=3,L.push(_,1-u),o<n&&a<s&&(S=o*(s+1)+a,x=o*(s+1)+(a+1),w=(o+1)*(s+1)+a,C=(o+1)*(s+1)+(a+1),D.push(S,x,w),D.push(x,C,w))}if(r){var O,F,B=Math.floor(s/2),N=s,U=i/2;for(O=0;O<=B;O++)for(m=O*Math.PI*.5/B,b=Math.sin(m),g=Math.cos(m),F=0;F<=N;F++)y=2*F*Math.PI/N-Math.PI/2,v=Math.sin(y),l=Math.cos(y)*b,h=g,c=v*b,_=1-F/N,u=1-O/B,R.push(l*e,h*e+U,c*e),I.push(l,h,c),P.push(_,1-u),_=.875*_+4/64,u=.875*u+4/64,_/=3,u/=3,_+=1/3,L.push(_,1-u);for(T=(n+1)*(s+1),O=0;O<B;++O)for(F=0;F<N;++F)x=(S=O*(N+1)+F)+N+1,D.push(T+S+1,T+x,T+S),D.push(T+S+1,T+x+1,T+x);for(O=0;O<=B;O++)for(m=.5*Math.PI+O*Math.PI*.5/B,b=Math.sin(m),g=Math.cos(m),F=0;F<=N;F++)y=2*F*Math.PI/N-Math.PI/2,v=Math.sin(y),l=Math.cos(y)*b,h=g,c=v*b,_=1-F/N,u=1-O/B,R.push(l*e,h*e-U,c*e),I.push(l,h,c),P.push(_,1-u),_=.875*_+4/64,u=.875*u+4/64,_/=3,u/=3,_+=2/3,L.push(_,1-u);for(T=(n+1)*(s+1)+(N+1)*(B+1),O=0;O<B;++O)for(F=0;F<N;++F)x=(S=O*(N+1)+F)+N+1,D.push(T+S+1,T+x,T+S),D.push(T+S+1,T+x+1,T+x)}else{if(T=(n+1)*(s+1),t>0)for(o=0;o<s;o++)m=o/s*2*Math.PI,h=-i/2,_=1-((l=Math.sin(m))+1)/2,u=((c=Math.cos(m))+1)/2,R.push(l*t,h,c*t),I.push(0,-1,0),P.push(_,1-u),_=.875*_+4/64,u=.875*u+4/64,_/=3,u/=3,_+=1/3,L.push(_,1-u),o>1&&D.push(T,T+o,T+o-1);if(T+=s,e>0)for(o=0;o<s;o++)m=o/s*2*Math.PI,h=i/2,_=1-((l=Math.sin(m))+1)/2,u=((c=Math.cos(m))+1)/2,R.push(l*e,h,c*e),I.push(0,1,0),P.push(_,1-u),_=.875*_+4/64,u=.875*u+4/64,_/=3,u/=3,_+=2/3,L.push(_,1-u),o>1&&D.push(T,T+o-1,T+o)}return{positions:R,normals:I,uvs:P,uvs1:L,indices:D}}function Rh(t,e){var i=e&&(e.radius||e.baseRadius);i=void 0!==i?i:.5;var n=e&&void 0!==e.height?e.height:1,s=e&&void 0!==e.heightSegments?e.heightSegments:5,r=e&&void 0!==e.capSegments?e.capSegments:20,o=!(!e||void 0===e.calculateTangents)&&e.calculateTangents,a=Mh(i,i,n,s,r,!1);return o&&(a.tangents=Th(a.positions,a.normals,a.uvs,a.indices)),Ah(t,a.positions,a)}function Ih(t,e){var i=e&&void 0!==e.radius?e.radius:.3,n=e&&void 0!==e.height?e.height:1,s=e&&void 0!==e.heightSegments?e.heightSegments:1,r=e&&void 0!==e.sides?e.sides:20,o=!(!e||void 0===e.calculateTangents)&&e.calculateTangents,a=Mh(i,i,n-2*i,s,r,!0);return o&&(a.tangents=Th(a.positions,a.normals,a.uvs,a.indices)),Ah(t,a.positions,a)}function Ph(t,e){var i=e&&void 0!==e.baseRadius?e.baseRadius:.5,n=e&&void 0!==e.peakRadius?e.peakRadius:0,s=e&&void 0!==e.height?e.height:1,r=e&&void 0!==e.heightSegments?e.heightSegments:5,o=e&&void 0!==e.capSegments?e.capSegments:18,a=!(!e||void 0===e.calculateTangents)&&e.calculateTangents,l=Mh(i,n,s,r,o,!1);return a&&(l.tangents=Th(l.positions,l.normals,l.uvs,l.indices)),Ah(t,l.positions,l)}function Lh(t,e){var i,n,s,r,o,a,l,h,c,_,u,d,p,f,m=e&&void 0!==e.radius?e.radius:.5,g=e&&void 0!==e.latitudeBands?e.latitudeBands:16,b=e&&void 0!==e.longitudeBands?e.longitudeBands:16,y=!(!e||void 0===e.calculateTangents)&&e.calculateTangents,v=[],S=[],x=[],w=[];for(n=0;n<=g;n++)for(s=n*Math.PI/g,r=Math.sin(s),o=Math.cos(s),i=0;i<=b;i++)a=2*i*Math.PI/b-Math.PI/2,l=Math.sin(a),_=Math.cos(a)*r,u=o,d=l*r,p=1-i/b,f=1-n/g,v.push(_*m,u*m,d*m),S.push(_,u,d),x.push(p,1-f);for(n=0;n<g;++n)for(i=0;i<b;++i)c=(h=n*(b+1)+i)+b+1,w.push(h+1,c,h),w.push(h+1,c+1,c);var C={normals:S,uvs:x,uvs1:x,indices:w};return y&&(C.tangents=Th(v,S,x,w)),Ah(t,v,C)}function Dh(t,e){var i,n,s,r,o,a,l=e&&void 0!==e.halfExtents?e.halfExtents:new _t(.5,.5),h=e&&void 0!==e.widthSegments?e.widthSegments:5,c=e&&void 0!==e.lengthSegments?e.lengthSegments:5,_=!(!e||void 0===e.calculateTangents)&&e.calculateTangents,u=[],d=[],p=[],f=[],m=0;for(i=0;i<=h;i++)for(n=0;n<=c;n++)s=-l.x+2*l.x*i/h,0,r=-(-l.y+2*l.y*n/c),o=i/h,a=n/c,u.push(s,0,r),d.push(0,1,0),p.push(o,1-a),i<h&&n<c&&(f.push(m+c+1,m+1,m),f.push(m+c+1,m+c+2,m+1)),m++;var g={normals:d,uvs:p,uvs1:p,indices:f};return _&&(g.tangents=Th(u,d,p,f)),Ah(t,u,g)}function kh(t,e){var i=e&&void 0!==e.halfExtents?e.halfExtents:new ht(.5,.5,.5),n=e&&void 0!==e.widthSegments?e.widthSegments:1,s=e&&void 0!==e.lengthSegments?e.lengthSegments:1,r=e&&void 0!==e.heightSegments?e.heightSegments:1,o=!(!e||void 0===e.calculateTangents)&&e.calculateTangents,a=[new ht(-i.x,-i.y,i.z),new ht(i.x,-i.y,i.z),new ht(i.x,i.y,i.z),new ht(-i.x,i.y,i.z),new ht(i.x,-i.y,-i.z),new ht(-i.x,-i.y,-i.z),new ht(-i.x,i.y,-i.z),new ht(i.x,i.y,-i.z)],l=[[0,1,3],[4,5,7],[3,2,6],[1,0,4],[1,4,2],[5,0,6]],h=[[0,0,1],[0,0,-1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0]],c=1,_=2,u=3,d=4,p=5,f=[],m=[],g=[],b=[],y=[],v=0,S=function(t,e,i){var n,s,r,o;for(r=0;r<=e;r++)for(o=0;o<=i;o++){var c=new ht,_=new ht,u=new ht,d=new ht;c.lerp(a[l[t][0]],a[l[t][1]],r/e),_.lerp(a[l[t][0]],a[l[t][2]],o/i),u.sub2(_,a[l[t][0]]),d.add2(c,u),n=r/e,s=o/i,f.push(d.x,d.y,d.z),m.push(h[t][0],h[t][1],h[t][2]),g.push(n,1-s),n=.875*n+4/64,s=.875*s+4/64,n/=3,s/=3,n+=t%3/3,s+=Math.floor(t/3)/3,b.push(n,1-s),r<e&&o<i&&(y.push(v+i+1,v+1,v),y.push(v+i+1,v+i+2,v+1)),v++}};S(0,n,r),S(c,n,r),S(_,n,s),S(u,n,s),S(d,s,r),S(p,s,r);var x={normals:m,uvs:g,uvs1:b,indices:y};return o&&(x.tangents=Th(f,m,g,y)),Ah(t,f,x)}function Oh(t,e){for(var i=null,n=0;n<wh.length;n++)wh[n].type===e&&wh[n].device===t&&(i=wh[n].primData);if(!i){var s,r;switch(e){case"box":s=kh(t,{halfExtents:new ht(.5,.5,.5)}),r={x:2,y:2,z:2,uv:2/3};break;case"capsule":s=Ih(t,{radius:.5,height:2}),r={x:2*Math.PI,y:Math.PI,z:2*Math.PI,uv:1/3+1/3/3*2};break;case"cone":s=Ph(t,{baseRadius:.5,peakRadius:0,height:1}),r={x:2.54,y:2.54,z:2.54,uv:1/3+1/3/3};break;case"cylinder":s=Rh(t,{radius:.5,height:1}),r={x:Math.PI,y:1.58,z:Math.PI,uv:1/3+1/3/3*2};break;case"plane":s=Dh(t,{halfExtents:new _t(.5,.5),widthSegments:1,lengthSegments:1}),r={x:0,y:1,z:0,uv:1};break;case"sphere":s=Lh(t,{radius:.5}),r={x:Math.PI,y:Math.PI,z:Math.PI,uv:1};break;default:throw new Error("Invalid primitive type: "+e)}s.incRefCount(),i={mesh:s,area:r},wh.push({type:e,device:t,primData:i})}return i}class Fh extends pl{constructor(){super(),this.color=new rt(1,1,1,1),this.colorUniform=new Float32Array(4),this.colorMap=null,this.vertexColors=!1}clone(){const t=new Fh;return pl.prototype._cloneInternal.call(this,t),t.color.copy(this.color),t.colorMap=this.colorMap,t.vertexColors=this.vertexColors,t}updateUniforms(t,e){this.clearParameters(),this.colorUniform[0]=this.color.r,this.colorUniform[1]=this.color.g,this.colorUniform[2]=this.color.b,this.colorUniform[3]=this.color.a,this.setParameter("uColor",this.colorUniform),this.colorMap&&this.setParameter("texture_diffuseMap",this.colorMap)}updateShader(t,e,i,n,s,r){const o={skin:i&&0!=(i&ri),screenSpace:i&&0!=(i&ui),useInstancing:i&&0!=(i&hi),useMorphPosition:i&&0!=(i&pi),useMorphNormal:i&&0!=(i&fi),useMorphTextureBased:i&&0!=(i&mi),vertexColors:this.vertexColors,diffuseMap:!!this.colorMap,pass:s},a=t.getProgramLibrary();this.shader=a.getProgram("basic",o)}}class Bh{constructor(t,e,i){this.origMeshInstances=t,this._aabb=new Tt,this.meshInstance=null,this.dynamic=e,this.batchGroupId=i}destroy(t,e){this.meshInstance&&(this.removeFromLayers(t,e),this.meshInstance.destroy())}addToLayers(t,e){for(let i=0;i<e.length;i++){const n=t.layers.getLayerById(e[i]);n&&n.addMeshInstances([this.meshInstance])}}removeFromLayers(t,e){for(let i=0;i<e.length;i++){const n=t.layers.getLayerById(e[i]);n&&n.removeMeshInstances([this.meshInstance])}}updateBoundingBox(){this._aabb.copy(this.origMeshInstances[0].aabb);for(let t=1;t<this.origMeshInstances.length;t++)this._aabb.add(this.origMeshInstances[t].aabb);this.meshInstance.aabb=this._aabb,this.meshInstance._aabbVer=0}}class Nh{constructor(t,e,i,n,s=[Zt]){this.dynamic=i,this.maxAabbSize=n,this.id=t,this.name=e,this.layers=s,this._ui=!1,this._sprite=!1,this._obj={model:[],element:[],sprite:[],render:[]}}}Nh.MODEL="model",Nh.ELEMENT="element",Nh.SPRITE="sprite",Nh.RENDER="render";const Uh=new bt;class Vh{constructor(t){this._dirty=!0,this._rootBone=null,this._skinUpdateIndex=-1,this._updateBeforeCull=!0,t&&this.initSkin(t)}init(t,e){if(t.supportsBoneTextures){const i=3*e;let n=Math.ceil(Math.sqrt(i));n=Z.roundUp(n,3);const s=Math.ceil(i/n);this.boneTexture=new _a(t,{width:n,height:s,format:As,mipmaps:!1,minFilter:Kn,magFilter:Kn}),this.boneTexture.name="skin",this.matrixPalette=this.boneTexture.lock()}else this.matrixPalette=new Float32Array(12*e)}destroy(){this.boneTexture&&(this.boneTexture.destroy(),this.boneTexture=null)}get rootBone(){return this._rootBone}set rootBone(t){this._rootBone=t}resolve(t,e){this.rootBone=t;const i=this.skin,n=[];for(let s=0;s<i.boneNames.length;s++){const r=i.boneNames[s];let o=t.findByName(r);o||(o=e),n.push(o)}this.bones=n}initSkin(t){this.skin=t,this.bones=[];const e=t.inverseBindPose.length;this.init(t.device,e),this.matrices=[];for(let t=0;t<e;t++)this.matrices[t]=new bt}uploadBones(t){t.supportsBoneTextures&&(this.boneTexture.lock(),this.boneTexture.unlock())}_updateMatrices(t,e){if(this._skinUpdateIndex!==e){this._skinUpdateIndex=e,Uh.copy(t.getWorldTransform()).invert();for(let t=this.bones.length-1;t>=0;t--)this.matrices[t].mulAffine2(Uh,this.bones[t].getWorldTransform()),this.matrices[t].mulAffine2(this.matrices[t],this.skin.inverseBindPose[t])}}updateMatrices(t,e){this._updateBeforeCull&&this._updateMatrices(t,e)}updateMatrixPalette(t,e){this._updateMatrices(t,e);const i=this.matrixPalette,n=this.bones.length;for(let t=0;t<n;t++){const e=this.matrices[t].data,n=12*t;i[n]=e[0],i[n+1]=e[4],i[n+2]=e[8],i[n+3]=e[12],i[n+4]=e[1],i[n+5]=e[5],i[n+6]=e[9],i[n+7]=e[13],i[n+8]=e[2],i[n+9]=e[6],i[n+10]=e[10],i[n+11]=e[14]}this.uploadBones(this.skin.device)}}class zh extends Vh{constructor(t,e,i){super();const n=e.length;this.init(t,n),this.device=t,this.rootNode=i,this.bones=e}updateMatrices(t,e){}updateMatrixPalette(t,e){const i=this.matrixPalette,n=this.bones.length;for(let t=0;t<n;t++){const e=this.bones[t].getWorldTransform().data,n=12*t;i[n]=e[0],i[n+1]=e[4],i[n+2]=e[8],i[n+3]=e[12],i[n+4]=e[1],i[n+5]=e[5],i[n+6]=e[9],i[n+7]=e[13],i[n+8]=e[2],i[n+9]=e[6],i[n+10]=e[10],i[n+11]=e[14]}this.uploadBones(this.device)}}class Wh{static incRef(t){this.cache.incRef(t)}static decRef(t){this.cache.decRef(t)}static destroy(){this.cache.destroy()}}Wh.cache=new class{constructor(){this.cache=new Map}destroy(){this.cache.forEach((t,e)=>{e.destroy()}),this.cache.clear()}incRef(t){const e=(this.cache.get(t)||0)+1;this.cache.set(t,e)}decRef(t){if(t){let e=this.cache.get(t);e&&(e--,0===e?(this.cache.delete(t),t.destroy()):this.cache.set(t,e))}}};var Gh=new Tt,jh=new Tt,Hh=new Mt,Xh=new Set;class Yh{constructor(t){this.count=t,this.vertexBuffer=null}}class qh{constructor(t,e,i){this._key=[],this._key[Ci]=Zh(t,e,!0,0),this.command=i}get key(){return this._key[Ci]}set key(t){this._key[Ci]=t}}class Kh{constructor(t,e,i=null){if(t instanceof La){const n=t;t=e,e=i,i=n}this._key=[0,0],this._shader=[null,null,null],this.isStatic=!1,this._staticLightList=null,this._staticSource=null,this.node=i,this._mesh=t,t.incRefCount(),this.material=e,this._shaderDefs=Ai<<16,this._shaderDefs|=t.vertexBuffer.format.hasUv0?oi:0,this._shaderDefs|=t.vertexBuffer.format.hasUv1?ai:0,this._shaderDefs|=t.vertexBuffer.format.hasColor?li:0,this._shaderDefs|=t.vertexBuffer.format.hasTangents?di:0,this._lightHash=0,this.visible=!0,this.layer=Kt,this._renderStyle=De,this.castShadow=!1,this._receiveShadow=!0,this._screenSpace=!1,this._noDepthDrawGl1=!1,this.cull=!0,this.pick=!0,this._updateAabb=!0,this._updateAabbFunc=null,this._calculateSortDistance=null,this.updateKey(),this._skinInstance=null,this._morphInstance=null,this.instancingData=null,this._customAabb=null,this.aabb=new Tt,this._aabbVer=-1,this.drawOrder=0,this.visibleThisFrame=0,this.isVisibleFunc=null,this.parameters={},this.stencilFront=null,this.stencilBack=null,this.flipFaces=!1}get renderStyle(){return this._renderStyle}set renderStyle(t){this._renderStyle=t,this.mesh.prepareRenderState(t)}static _prepareRenderStyleForArray(t,e){if(t){for(let i=0;i<t.length;i++){t[i]._renderStyle=e;const n=t[i].mesh;Xh.has(n)||(Xh.add(n),n.prepareRenderState(e))}Xh.clear()}}get mesh(){return this._mesh}set mesh(t){t!==this._mesh&&(this._mesh&&this._mesh.decRefCount(),this._mesh=t,t&&t.incRefCount())}get aabb(){if(!this._updateAabb)return this._aabb;if(this._updateAabbFunc)return this._updateAabbFunc(this._aabb);let t=this._customAabb,e=!!t;if(!t)if(t=Gh,this.skinInstance){if(!this.mesh.boneAabb){const t=this._morphInstance?this._morphInstance.morph._targets:null;this.mesh._initBoneAabbs(t)}const i=this.mesh.boneUsed;let n=!0;for(let e=0;e<this.mesh.boneAabb.length;e++)i[e]&&(jh.setFromTransformedAabb(this.mesh.boneAabb[e],this.skinInstance.matrices[e]),n?(n=!1,t.center.copy(jh.center),t.halfExtents.copy(jh.halfExtents)):t.add(jh));e=!0}else this.node._aabbVer!==this._aabbVer&&(this.mesh?(t.center.copy(this.mesh.aabb.center),t.halfExtents.copy(this.mesh.aabb.halfExtents)):(t.center.set(0,0,0),t.halfExtents.set(0,0,0)),this.mesh&&this.mesh.morph&&t._expand(this.mesh.morph.aabb.getMin(),this.mesh.morph.aabb.getMax()),e=!0,this._aabbVer=this.node._aabbVer);return e&&this._aabb.setFromTransformedAabb(t,this.node.getWorldTransform()),this._aabb}set aabb(t){this._aabb=t}get material(){return this._material}set material(t){for(let t=0;t<this._shader.length;t++)this._shader[t]=null;var e=this._material;if((e&&e.removeMeshInstanceRef(this),this._material=t,this._material)&&(this._material.addMeshInstanceRef(this),this.updateKey(),(e&&e.blendType!==Lt)!==(this._material.blendType!==Lt))){var i=this._material._scene;!i&&e&&e._scene&&(i=e._scene),i?i.layers._dirtyBlend=!0:this._material._dirtyBlend=!0}}get layer(){return this._layer}set layer(t){this._layer=t,this.updateKey()}get calculateSortDistance(){return this._calculateSortDistance}set calculateSortDistance(t){this._calculateSortDistance=t}get receiveShadow(){return this._receiveShadow}set receiveShadow(t){this._receiveShadow=t,this._shaderDefs=t?this._shaderDefs&~si:this._shaderDefs|si,this._shader[Ri]=null,this._shader[Ii]=null}get skinInstance(){return this._skinInstance}set skinInstance(t){this._skinInstance=t,this._shaderDefs=t?this._shaderDefs|ri:this._shaderDefs&~ri;for(var e=0;e<this._shader.length;e++)this._shader[e]=null;this._setupSkinUpdate()}get morphInstance(){return this._morphInstance}set morphInstance(t){this._morphInstance=t,this._morphInstance&&(this._morphInstance.meshInstance=this),this._shaderDefs=t&&t.morph.useTextureMorph?this._shaderDefs|mi:this._shaderDefs&~mi,this._shaderDefs=t&&t.morph.morphPositions?this._shaderDefs|pi:this._shaderDefs&~pi,this._shaderDefs=t&&t.morph.morphNormals?this._shaderDefs|fi:this._shaderDefs&~fi;for(var e=0;e<this._shader.length;e++)this._shader[e]=null}get screenSpace(){return this._screenSpace}set screenSpace(t){this._screenSpace=t,this._shaderDefs=t?this._shaderDefs|ui:this._shaderDefs&~ui,this._shader[Ri]=null}get key(){return this._key[Ci]}set key(t){this._key[Ci]=t}get mask(){return this._shaderDefs>>16}set mask(t){var e=65535&this._shaderDefs;this._shaderDefs=e|t<<16,this._shader[Ri]=null,this._shader[Ii]=null}get instancingCount(){return this.instancingData?this.instancingData.count:0}set instancingCount(t){this.instancingData&&(this.instancingData.count=t)}destroy(){const t=this.mesh;t&&(this.mesh=null,t.getRefCount()<1&&t.destroy()),this.setRealtimeLightmap(Kh.lightmapParamNames[0],null),this.setRealtimeLightmap(Kh.lightmapParamNames[1],null),this._skinInstance&&(this._skinInstance.destroy(),this._skinInstance=null),this.morphInstance&&(this.morphInstance.destroy(),this.morphInstance=null),this.material=null}syncAabb(){}_isVisible(t){return!!this.visible&&(this.isVisibleFunc?this.isVisibleFunc(t):(Hh.center=this.aabb.center,Hh.radius=this._aabb.halfExtents.length(),t.frustum.containsSphere(Hh)))}updateKey(){var t=this.material;this._key[Ci]=Zh(this.layer,t.alphaToCoverage||t.alphaTest?Pt:t.blendType,!1,t.id)}setInstancing(t){t?(this.instancingData=new Yh(t.numVertices),this.instancingData.vertexBuffer=t,t.instancing=!0,this.cull=!1):(this.instancingData=null,this.cull=!0)}clearParameters(){this.parameters={}}getParameters(){return this.parameters}getParameter(t){return this.parameters[t]}setParameter(t,e,i=-262141){if(void 0===e&&"object"==typeof t){var n=t;if(n.length){for(var s=0;s<n.length;s++)this.setParameter(n[s]);return}t=n.name,e=n.value}var r=this.parameters[t];r?(r.data=e,r.passFlags=i):this.parameters[t]={scopeId:null,data:e,passFlags:i}}setRealtimeLightmap(t,e){const i=this.getParameter(t);i!==e&&(i&&Wh.decRef(i.data),e?(Wh.incRef(e),this.setParameter(t,e)):this.deleteParameter(t))}deleteParameter(t){this.parameters[t]&&delete this.parameters[t]}setParameters(t,e){var i,n=this.parameters;for(var s in n)(i=n[s]).passFlags&e&&(i.scopeId||(i.scopeId=t.scope.resolve(s)),i.scopeId.setValue(i.data))}setLightmapped(t){t?this.mask=(this.mask|Ei)&~(Ai|Mi):(this.setRealtimeLightmap(Kh.lightmapParamNames[0],null),this.setRealtimeLightmap(Kh.lightmapParamNames[1],null),this._shaderDefs&=~(ci|_i|gi),this.mask=(this.mask|Ai)&~(Ei|Mi))}setCustomAabb(t){t?this._customAabb?this._customAabb.copy(t):this._customAabb=t.clone():(this._customAabb=null,this._aabbVer=-1),this._setupSkinUpdate()}_setupSkinUpdate(){this._skinInstance&&(this._skinInstance._updateBeforeCull=!this._customAabb)}}function Zh(t,e,i,n){return(15&t)<<27|(e===Lt?1:0)<<26|(i?1:0)<<25|(33554431&n)<<0}function Qh(t,e){if(t&&!e)return!1;if(!t&&e)return!1;if((t=t.data)===(e=e.data))return!0;if(t instanceof Float32Array&&e instanceof Float32Array){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}return!1}function $h(t,e){for(const i in t)if(t.hasOwnProperty(i)&&!Qh(t[i],e[i]))return!1;for(const i in e)if(e.hasOwnProperty(i)&&!Qh(e[i],t[i]))return!1;return!0}function Jh(t,e){for(let i=0;i<t.length;i++)if(e.indexOf(t[i])<0)return!1;for(let i=0;i<e.length;i++)if(t.indexOf(e[i])<0)return!1;return!0}Kh.lightmapParamNames=["texture_lightMap","texture_dirLightMap"];const tc=new ct,ec=new ht,ic=new ht,nc=new ht;function sc(t){const e=t.node.worldTransform;return e.getX(ec),e.getY(ic),e.getZ(nc),ec.cross(ec,ic),ec.dot(nc)>=0?1:-1}class rc{constructor(t,e,i){this.device=t,this.rootNode=e,this.scene=i,this._init=!1,this._batchGroups={},this._batchGroupCounter=0,this._batchList=[],this._dirtyGroups=[]}destroy(){this.device=null,this.rootNode=null,this.scene=null,this._batchGroups={},this._batchList=[],this._dirtyGroups=[]}addGroup(t,e,i,n,s){if(void 0===n&&(n=this._batchGroupCounter,this._batchGroupCounter++),this._batchGroups[n])return;const r=new Nh(n,t,e,i,s);return this._batchGroups[n]=r,r}removeGroup(t){if(!this._batchGroups[t])return;const e=[];for(let i=0;i<this._batchList.length;i++)this._batchList[i].batchGroupId==t?this.destroyBatch(this._batchList[i]):e.push(this._batchList[i]);this._batchList=e,this._removeModelsFromBatchGroup(this.rootNode,t),delete this._batchGroups[t]}markGroupDirty(t){this._dirtyGroups.indexOf(t)<0&&this._dirtyGroups.push(t)}getGroupByName(t){const e=this._batchGroups;for(const i in e)if(e.hasOwnProperty(i)&&e[i].name===t)return e[i];return null}getBatches(t){const e=[],i=this._batchList.length;for(let n=0;n<i;n++){const i=this._batchList[n];i.batchGroupId===t&&e.push(i)}return e}_removeModelsFromBatchGroup(t,e){if(t.enabled){t.model&&t.model.batchGroupId===e&&(t.model.batchGroupId=-1),t.render&&t.render.batchGroupId===e&&(t.render.batchGroupId=-1),t.element&&t.element.batchGroupId===e&&(t.element.batchGroupId=-1),t.sprite&&t.sprite.batchGroupId===e&&(t.sprite.batchGroupId=-1);for(let i=0;i<t._children.length;i++)this._removeModelsFromBatchGroup(t._children[i],e)}}insert(t,e,i){const n=this._batchGroups[e];n&&n._obj[t].indexOf(i)<0&&(n._obj[t].push(i),this.markGroupDirty(e))}remove(t,e,i){const n=this._batchGroups[e];if(n){const s=n._obj[t].indexOf(i);s>=0&&(n._obj[t].splice(s,1),this.markGroupDirty(e))}}_extractRender(t,e,i,n){if(t.render){if(t.render.isStatic){const i=this.scene.drawCalls,n=t.render.meshInstances;for(let t=0;t<i.length;t++)i[t]._staticSource&&(n.indexOf(i[t]._staticSource)<0||e.push(i[t]));for(let t=0;t<n.length;t++)i.indexOf(n[t])>=0&&e.push(n[t])}else e=n[t.render.batchGroupId]=e.concat(t.render.meshInstances);t.render.removeFromLayers()}return e}_extractModel(t,e,i,n){if(t.model&&t.model.model){if(t.model.isStatic){const i=this.scene.drawCalls,n=t.model.meshInstances;for(let t=0;t<i.length;t++)i[t]._staticSource&&(n.indexOf(i[t]._staticSource)<0||e.push(i[t]));for(let t=0;t<n.length;t++)i.indexOf(n[t])>=0&&e.push(n[t])}else e=n[t.model.batchGroupId]=e.concat(t.model.meshInstances);t.model.removeModelFromLayers()}return e}_extractElement(t,e,i){if(!t.element)return;let n=!1;t.element._text&&t.element._text._model.meshInstances.length>0?(e.push(t.element._text._model.meshInstances[0]),t.element.removeModelFromLayers(t.element._text._model),n=!0):t.element._image&&(e.push(t.element._image._renderable.meshInstance),t.element.removeModelFromLayers(t.element._image._renderable.model),t.element._image._renderable.unmaskMeshInstance&&(e.push(t.element._image._renderable.unmaskMeshInstance),t.element._image._renderable.unmaskMeshInstance.stencilFront&&t.element._image._renderable.unmaskMeshInstance.stencilBack||(t.element._dirtifyMask(),t.element._onPrerender())),n=!0),n&&(i._ui=!0)}_collectAndRemoveMeshInstances(t,e){for(let i=0;i<e.length;i++){const n=e[i],s=this._batchGroups[n];if(!s)continue;let r=t[n];r||(r=t[n]=[]);for(let e=0;e<s._obj.model.length;e++)r=this._extractModel(s._obj.model[e],r,s,t);for(let e=0;e<s._obj.render.length;e++)r=this._extractRender(s._obj.render[e],r,s,t);for(let t=0;t<s._obj.element.length;t++)this._extractElement(s._obj.element[t],r,s);for(let t=0;t<s._obj.sprite.length;t++){const e=s._obj.sprite[t];e.sprite&&e.sprite._meshInstance&&(s.dynamic||e.sprite.sprite._renderMode===ki)&&(r.push(e.sprite._meshInstance),e.sprite.removeModelFromLayers(),s._sprite=!0,e.sprite._batchGroup=s)}}}generate(t){const e={};t||(t=Object.keys(this._batchGroups));const i=[];for(let e=0;e<this._batchList.length;e++)t.indexOf(this._batchList[e].batchGroupId)<0?i.push(this._batchList[e]):this.destroyBatch(this._batchList[e]);if(this._batchList=i,this._collectAndRemoveMeshInstances(e,t),t===this._dirtyGroups)this._dirtyGroups.length=0;else{const e=[];for(let i=0;i<this._dirtyGroups.length;i++)t.indexOf(this._dirtyGroups[i])<0&&e.push(this._dirtyGroups[i]);this._dirtyGroups=e}let n,s,r,o;for(const t in e)if(e.hasOwnProperty(t)&&(n=e[t],r=this._batchGroups[t],r)){s=this.prepare(n,r.dynamic,r.maxAabbSize,r._ui||r._sprite);for(let e=0;e<s.length;e++)o=this.create(s[e],r.dynamic,parseInt(t,10)),o&&o.addToLayers(this.scene,r.layers)}}prepare(t,e,i=Number.POSITIVE_INFINITY,n){if(0===t.length)return[];const s=.5*i,r=this.device.supportsBoneTextures?1024:this.device.boneLimit,o=this.device.extUintElement?4294967295:65535,a=new Tt,l=new Tt;let h,c=null;const _=[];let u=0;n&&t.sort((function(t,e){return t.drawOrder-e.drawOrder}));let d,p=t;const f=n?function(t){c?c.add(t.aabb):c=t.aabb.clone(),d.push(t)}:function(t){d.push(t)};for(;p.length>0;){_[u]=[p[0]],d=[];const t=p[0].material,i=p[0].layer,m=p[0]._shaderDefs,g=p[0].parameters,b=p[0].stencilFront,y=p[0]._staticLightList;let v=p[0].mesh.vertexBuffer.getNumVertices();const S=p[0].drawOrder;a.copy(p[0].aabb);const x=sc(p[0]),w=p[0].mesh.vertexBuffer.format.batchingHash,C=p[0].mesh.primitive[0].indexed;c=null;for(let T=1;T<p.length;T++){const A=p[T];if(e&&_[u].length>=r){d=d.concat(p.slice(T));break}if(t!==A.material||i!==A.layer||w!==A.mesh.vertexBuffer.format.batchingHash||C!==A.mesh.primitive[0].indexed||m!==A._shaderDefs||v+A.mesh.vertexBuffer.getNumVertices()>o){f(A);continue}if(l.copy(a),l.add(A.aabb),l.halfExtents.x>s||l.halfExtents.y>s||l.halfExtents.z>s){f(A);continue}if(b&&(!(h=A.stencilFront)||b.func!==h.func||b.zpass!==h.zpass)){f(A);continue}if(x!==sc(A)){f(A);continue}if(!$h(g,A.parameters)){f(A);continue}const E=A._staticLightList;if(y&&E){if(!Jh(y,E)){f(A);continue}}else if(y||E){f(A);continue}n&&c&&c.intersects(A.aabb)&&A.drawOrder!==S?f(A):(a.add(A.aabb),v+=A.mesh.vertexBuffer.getNumVertices(),_[u].push(A))}u++,p=d}return _}collectBatchedMeshData(t,e){let i=null,n=0,s=0,r=null;for(let o=0;o<t.length;o++)if(t[o].visible){const a=t[o].mesh;if(n+=a.vertexBuffer.numVertices,s+=a.primitive[0].indexed?a.primitive[0].count:a.primitive[0].type===Ks&&4===a.primitive[0].count?6:0,!i){r=t[o].material,i={};const n=a.vertexBuffer.format.elements;for(let t=0;t<n.length;t++){i[n[t].name]={numComponents:n[t].numComponents,dataType:n[t].dataType,normalize:n[t].normalize,count:0}}e&&(i[tr]={numComponents:1,dataType:no,normalize:!1,count:0})}}return{streams:i,batchNumVerts:n,batchNumIndices:s,material:r}}create(t,e,i){if(!this._init){const t="#define BONE_LIMIT "+this.device.getBoneLimit()+"\n";this.transformVS=t+"#define DYNAMICBATCH\n"+jo.transformVS,this.skinTexVS=jo.skinBatchTexVS,this.skinConstVS=jo.skinBatchConstVS,this.vertexFormats={},this._init=!0}let n,s,r,o=null,a=null;const l=this.collectBatchedMeshData(t,e);if(l.streams){const h=l.streams;let c=l.material;const _=l.batchNumVerts,u=l.batchNumIndices;let d,p,f;a=new Bh(t,e,i),this._batchList.push(a);let m,g=0,b=0;const y=new ht,v=new(_<=65535?Uint16Array:Uint32Array)(u);for(n in h)o=h[n],o.typeArrayType=Ro[o.dataType],o.elementByteSize=Io[o.dataType],o.buffer=new o.typeArrayType(_*o.numComponents);for(let i=0;i<t.length;i++)if(t[i].visible){for(n in s=t[i].mesh,r=s.vertexBuffer.numVertices,e||(m=t[i].node.getWorldTransform()),h)if(n!==tr){o=h[n];const t=new o.typeArrayType(o.buffer.buffer,o.elementByteSize*o.count),i=s.getVertexStream(n,t)*o.numComponents;if(o.count+=i,!e&&o.numComponents>=3)if(n===Zs)for(let e=0;e<i;e+=o.numComponents)y.set(t[e],t[e+1],t[e+2]),m.transformPoint(y,y),t[e]=y.x,t[e+1]=y.y,t[e+2]=y.z;else if(n===Qs||n===$s){m.invertTo3x3(tc),tc.transpose();for(let e=0;e<i;e+=o.numComponents)y.set(t[e],t[e+1],t[e+2]),tc.transformVector(y,y),t[e]=y.x,t[e+1]=y.y,t[e+2]=y.z}}if(e){o=h[tr];for(let t=0;t<r;t++)o.buffer[o.count++]=i}if(s.primitive[0].indexed){d=s.primitive[0].base,p=s.primitive[0].count;const t=s.indexBuffer[0].getFormat();f=new Lo[t](s.indexBuffer[0].storage)}else{if(s.primitive[0].type!==Ks||4!==s.primitive[0].count){p=0;continue}d=0,p=6,f=[0,1,3,2,3,1]}for(let t=0;t<p;t++)v[t+b]=f[d+t]+g;b+=p,g+=r}for(n in s=new xh(this.device),h)o=h[n],s.setVertexStream(n,o.buffer,o.numComponents,void 0,o.dataType,o.normalize);v.length>0&&s.setIndices(v),s.update(Ys,!1),e&&(c=c.clone(),c.chunks.transformVS=this.transformVS,c.chunks.skinTexVS=this.skinTexVS,c.chunks.skinConstVS=this.skinConstVS,c.update());const S=new Kh(s,c,this.rootNode);S.castShadow=a.origMeshInstances[0].castShadow,S.parameters=a.origMeshInstances[0].parameters,S.isStatic=a.origMeshInstances[0].isStatic,S.layer=a.origMeshInstances[0].layer,S._staticLightList=a.origMeshInstances[0]._staticLightList,S._shaderDefs=a.origMeshInstances[0]._shaderDefs,S.cull=a.origMeshInstances[0].cull;const x=this._batchGroups[i];if(x&&x._ui&&(S.cull=!1),e){const t=[];for(let e=0;e<a.origMeshInstances.length;e++)t.push(a.origMeshInstances[e].node);S.skinInstance=new zh(this.device,t,this.rootNode)}S._updateAabb=!1,S.drawOrder=a.origMeshInstances[0].drawOrder,S.stencilFront=a.origMeshInstances[0].stencilFront,S.stencilBack=a.origMeshInstances[0].stencilBack,S.flipFaces=sc(a.origMeshInstances[0])<0,S.castShadow=a.origMeshInstances[0].castShadow,a.meshInstance=S,a.updateBoundingBox()}return a}updateAll(){this._dirtyGroups.length>0&&this.generate(this._dirtyGroups);for(let t=0;t<this._batchList.length;t++)this._batchList[t].dynamic&&this._batchList[t].updateBoundingBox()}clone(t,e){const i=new Bh(e,t.dynamic,t.batchGroupId);this._batchList.push(i);const n=[];for(let t=0;t<e.length;t++)n.push(e[t].node);return i.meshInstance=new Kh(t.meshInstance.mesh,t.meshInstance.material,t.meshInstance.node),i.meshInstance._updateAabb=!1,i.meshInstance.parameters=e[0].parameters,i.meshInstance.isStatic=e[0].isStatic,i.meshInstance.cull=e[0].cull,i.meshInstance.layer=e[0].layer,i.meshInstance._staticLightList=e[0]._staticLightList,t.dynamic&&(i.meshInstance.skinInstance=new zh(this.device,n,this.rootNode)),i.meshInstance.castShadow=t.meshInstance.castShadow,i.meshInstance._shader=t.meshInstance._shader,i.meshInstance.castShadow=t.meshInstance.castShadow,i}destroyBatch(t){t.destroy(this.scene,this._batchGroups[t.batchGroupId].layers)}}class oc extends pl{clone(){const t=new oc;return pl.prototype._cloneInternal.call(this,t),t}updateShader(t){const e={skin:!!this.meshInstances[0].skinInstance},i=t.getProgramLibrary();this.shader=i.getProgram("depth",e)}}const ac=new ut;class lc{constructor(t,e){this.device=t,this.lightTextureAtlas=e,this.blitShader2d=null,this.blitShaderCube=null,this.blitTextureId=null,this.invViewProjId=null}destroy(){}getShader(t,e){return this[t]||(this[t]=ia(this.device,"\n\t\tattribute vec2 vertex_position;\n\t\tvarying vec2 uv0;\n\t\tvoid main(void) {\n\t\t\t\tgl_Position = vec4(vertex_position, 0.5, 1.0);\n\t\t\t\tuv0 = vertex_position.xy * 0.5 + 0.5;\n\t\t}",e,"cookie_renderer_"+t)),this.blitTextureId||(this.blitTextureId=this.device.scope.resolve("blitTexture")),this.invViewProjId||(this.invViewProjId=this.device.scope.resolve("invViewProj")),this[t]}get shader2d(){return this.getShader("blitShader2d","\n\t\tvarying vec2 uv0;\n\t\tuniform sampler2D blitTexture;\n\t\tvoid main(void) {\n\t\t\t\tgl_FragColor = texture2D(blitTexture, uv0);\n\t\t}")}get shaderCube(){return this.getShader("blitShaderCube","\n\t\tvarying vec2 uv0;\n\t\tuniform samplerCube blitTexture;\n\t\tuniform mat4 invViewProj;\n\t\tvoid main(void) {\n\t\t\t\tvec4 projPos = vec4(uv0 * 2.0 - 1.0, 0.5, 1.0);\n\t\t\t\tvec4 worldPos = invViewProj * projPos;\n\t\t\t\tgl_FragColor = textureCube(blitTexture, worldPos.xyz);\n\t\t}")}static createTexture(t,e){const i=new _a(t,{width:e,height:e,format:ys,cubemap:!1,mipmaps:!1,minFilter:Kn,magFilter:Kn,addressU:pn,addressV:pn});return i.name="CookieAtlas",i}initInvViewProjMatrices(){if(!lc._invViewProjMatrices){lc._invViewProjMatrices=[];for(let t=0;t<6;t++){const e=Fa.create(null,ie,t),i=e.projectionMatrix,n=e.node.getLocalTransform().clone().invert();lc._invViewProjMatrices[t]=(new bt).mul2(i,n).invert()}}}render(t,e){if(t.enabled&&t.cookie&&t.visibleThisFrame){const i=t.numShadowFaces,n=i>1?this.shaderCube:this.shader2d,s=this.device;i>1&&this.initInvViewProjMatrices(),this.blitTextureId.setValue(t.cookie);for(let r=0;r<i;r++){if(ac.copy(t.atlasViewport),i>1){const t=ac.z/3,e=this.lightTextureAtlas.cubeSlotsOffsets[r];ac.x+=t*e.x,ac.y+=t*e.y,ac.z=t,ac.w=t,this.invViewProjId.setValue(lc._invViewProjMatrices[r].data)}ac.mulScalar(e.colorBuffer.width),zo(s,e,n,ac)}}}}lc._invViewProjMatrices=null;class hc{constructor(t,e){this.texture=t,this.cached=!1,this.renderTargets=e}destroy(){this.texture&&(this.texture.destroy(),this.texture=null);const t=this.renderTargets;for(let e=0;e<t.length;e++)t[e].destroy();this.renderTargets.length=0}static getShadowFormat(t,e){return e===fe?As:e===pe?Cs:e===me||e===_e&&t.webgl2?Ms:ys}static getShadowFiltering(t,e){return e!==_e||t.webgl2?e===fe?t.extTextureFloatLinear?Zn:Kn:e===pe?t.extTextureHalfFloatLinear?Zn:Kn:Zn:Kn}static create(t,e){let i=null;return i=e._type===ie?this.createCubemap(t,e._shadowResolution):this.create2dMap(t,e._shadowResolution,e._shadowType),i}static createAtlas(t,e,i){const n=this.create2dMap(t,e,i),s=n.renderTargets,r=s[0];for(let t=0;t<5;t++)s.push(r);return n}static create2dMap(t,e,i){const n=this.getShadowFormat(t,i),s=this.getShadowFiltering(t,i),r=new _a(t,{format:n,width:e,height:e,mipmaps:!1,minFilter:s,magFilter:s,addressU:pn,addressV:pn});r.name="ShadowMap2D";let o=null;return i===me||i===_e&&t.webgl2?(r.compareOnRead=!0,r.compareFunc=is,o=new Gl({depthBuffer:r})):o=new Gl({colorBuffer:r,depth:!0}),new hc(r,[o])}static createCubemap(t,e){const i=new _a(t,{format:ys,width:e,height:e,cubemap:!0,mipmaps:!1,minFilter:Kn,magFilter:Kn,addressU:pn,addressV:pn});i.name="ShadowMapCube";const n=[];for(let t=0;t<6;t++){const e=new Gl({colorBuffer:i,face:t,depth:!0});n.push(e)}return new hc(i,n)}}const cc=[],_c=new ut,uc=new ut;class dc{constructor(t){this.device=t,this.subdivision=0,this.shadowMapResolution=2048,this.shadowMap=null,this.shadowEdgePixels=3,this.cookieMapResolution=2048,this.cookieMap=null,this.cookieRenderTarget=null,this.slots=[],this.cubeSlotsOffsets=[new _t(0,0),new _t(0,1),new _t(1,0),new _t(1,1),new _t(2,0),new _t(2,1)],this.allocateShadowMap(1),this.allocateCookieMap(1),this.allocateUniforms()}destroy(){this.destroyShadowMap(),this.destroyCookieMap()}destroyShadowMap(){this.shadowMap&&(this.shadowMap.destroy(),this.shadowMap=null)}destroyCookieMap(){this.cookieMap&&(this.cookieMap.destroy(),this.cookieMap=null),this.cookieRenderTarget&&(this.cookieRenderTarget.destroy(),this.cookieRenderTarget=null)}allocateShadowMap(t){this.shadowMap&&this.shadowMap.texture.width===t||(this.destroyShadowMap(),this.shadowMap=hc.createAtlas(this.device,t,_e),this.shadowMap.cached=!1)}allocateCookieMap(t){this.cookieMap&&this.cookieMap.width===t||(this.destroyCookieMap(),this.cookieMap=lc.createTexture(this.device,t),this.cookieRenderTarget=new Gl({colorBuffer:this.cookieMap,depth:!1,flipY:!0}))}allocateUniforms(){this._shadowAtlasTextureId=this.device.scope.resolve("shadowAtlasTexture"),this._shadowAtlasParamsId=this.device.scope.resolve("shadowAtlasParams"),this._shadowAtlasParams=new Float32Array(2),this._cookieAtlasTextureId=this.device.scope.resolve("cookieAtlasTexture")}updateUniforms(){const t=this.shadowMap.renderTargets[0],e=this.device.webgl2?t.depthBuffer:t.colorBuffer;this._shadowAtlasTextureId.setValue(e),this._shadowAtlasParams[0]=this.shadowMapResolution,this._shadowAtlasParams[1]=this.shadowEdgePixels,this._shadowAtlasParamsId.setValue(this._shadowAtlasParams),this._cookieAtlasTextureId.setValue(this.cookieMap)}subdivide(t){const e=Math.ceil(Math.sqrt(t));if(this.subdivision!==e){this.subdivision=e,this.slots.length=0;const t=1/e;for(let i=0;i<e;i++)for(let n=0;n<e;n++)this.slots.push(new ut(i*t,n*t,t,t))}}collectLights(t,e,i,n){let s=!1,r=!1;const o=cc;o.length=0;const a=t=>{for(let e=0;e<t.length;e++){const a=t[e];a.visibleThisFrame&&(s||(s=n&&a.castShadows),r||(r=i&&!!a.cookie),(s||r)&&o.push(a))}};return(i||n)&&(a(t),a(e)),s&&this.allocateShadowMap(this.shadowMapResolution),r&&this.allocateCookieMap(this.cookieMapResolution),(s||r)&&this.subdivide(o.length),o}update(t,e,i,n){const s=this.collectLights(t,e,i,n);if(s.length>0){const t=4/this.shadowMapResolution,e=new ut(t,t,-2*t,-2*t);let i=0;for(let t=0;t<s.length;t++){const n=s[t];n.castShadows&&(n._shadowMap=this.shadowMap);const r=this.slots[i];i++,n.atlasViewport.copy(r);const o=n.numShadowFaces;for(let t=0;t<o;t++)if(n.castShadows||n._cookie){if(_c.copy(r),uc.copy(r),n._type===se&&_c.add(e),n._type===ie){const e=_c.z/3,i=this.cubeSlotsOffsets[t];_c.x+=e*i.x,_c.y+=e*i.y,_c.z=e,_c.w=e,uc.copy(_c)}if(n.castShadows){const e=n.getRenderData(null,t);e.shadowViewport.copy(_c),e.shadowScissor.copy(uc)}}}}this.updateUniforms()}}class fc{constructor(){this.shadowMapCache=new Map}destroy(){this.clear(),this.shadowMapCache=null}clear(){this.shadowMapCache.forEach(t=>{t.forEach(t=>{t.destroy()})}),this.shadowMapCache.clear()}getKey(t){return`${t._type===ie}-${t._shadowType}-${t._shadowResolution}`}get(t,e){const i=this.getKey(e),n=this.shadowMapCache.get(i);if(n&&n.length)return n.pop();const s=hc.create(t,e);return s.cached=!0,s}add(t,e){const i=this.getKey(t),n=this.shadowMapCache.get(i);n?n.push(e):this.shadowMapCache.set(i,[e])}}const mc=[new ht,new ht,new ht,new ht,new ht,new ht,new ht,new ht],gc={min:0,max:0};function bc(t,e,i){mc[0].x=mc[1].x=mc[2].x=mc[3].x=e.x,mc[1].y=mc[3].y=mc[7].y=mc[5].y=e.y,mc[2].z=mc[3].z=mc[6].z=mc[7].z=e.z,mc[4].x=mc[5].x=mc[6].x=mc[7].x=i.x,mc[0].y=mc[2].y=mc[4].y=mc[6].y=i.y,mc[0].z=mc[1].z=mc[4].z=mc[5].z=i.z;let n=9999999999,s=-9999999999;for(let e=0;e<8;++e){t.transformPoint(mc[e],mc[e]);const i=mc[e].z;i<n&&(n=i),i>s&&(s=i)}return gc.min=n,gc.max=s,gc}function yc(t,e){return Math.exp(-t*t/(2*e*e))}const vc=new Tt,Sc=new bt,xc=new bt,wc=new Float32Array(2),Cc={x:1,y:1,z:0,w:0},Tc={r:1,g:2,b:3,a:4},Ac=new ht,Ec=new bt;function Mc(t){const e=t.material,i=t.skinInstance?10:0;let n=0;if(e.opacityMap){const t=e.opacityMapChannel;t&&(n=Tc[t])}return i+n}class Rc{constructor(t,e){this.device=t.device,this.forwardRenderer=t,this.lightTextureAtlas=e;const i=this.device.scope;this.polygonOffsetId=i.resolve("polygonOffset"),this.polygonOffset=new Float32Array(2),this.sourceId=i.resolve("source"),this.pixelOffsetId=i.resolve("pixelOffset"),this.weightId=i.resolve("weight[0]"),this.blurVsmShaderCode=[jo.blurVSMPS,"#define GAUSS\n"+jo.blurVSMPS];this.blurPackedVsmShaderCode=["#define PACKED\n"+this.blurVsmShaderCode[0],"#define PACKED\n"+this.blurVsmShaderCode[1]],this.blurVsmShader=[{},{}],this.blurPackedVsmShader=[{},{}],this.blurVsmWeights={},this.shadowMapLightRadiusId=i.resolve("light_radius"),this.shadowMapCache=new fc}destroy(){this.shadowMapCache.destroy(),this.shadowMapCache=null}static createShadowCamera(t,e,i,n){const s=Fa.create("ShadowCamera",i,n);let r=e===me||e===_e&&t.webgl2;return i!==ie||Ja.clusteredLightingEnabled||(r=!1),s.clearColor=e>=de&&e<=fe?new rt(0,0,0,0):new rt(1,1,1,1),s.clearColorBuffer=!r,s.clearDepthBuffer=!0,s.clearStencilBuffer=!1,s}cullShadowCasters(t,e,i){let n=0;const s=t.length;for(let r=0;r<s;r++){const s=t[r];s.cull&&!s._isVisible(i)||(s.visibleThisFrame=!0,e[n]=s,n++)}e.length=n,e.sort(this.forwardRenderer.depthSortCompare)}cullLocal(t,e){t.visibleThisFrame=!0,Ja.clusteredLightingEnabled||t._shadowMap||(t._shadowMap=hc.create(this.device,t));const i=t._type,n=i===se?1:6;for(let s=0;s<n;s++){const n=t.getRenderData(null,s),r=n.shadowCamera;r.nearClip=t.attenuationEnd/1e3,r.farClip=t.attenuationEnd;const o=r._node,a=t._node;if(o.setPosition(a.getPosition()),i===se)r.fov=2*t._outerConeAngle,o.setRotation(a.getRotation()),o.rotateLocal(-90,0,0);else if(i===ie)if(Ja.clusteredLightingEnabled){const e=2/(this.lightTextureAtlas.shadowMapResolution*t.atlasViewport.z/3)*this.lightTextureAtlas.shadowEdgePixels;r.fov=Math.atan(1+e)*Z.RAD_TO_DEG*2}else r.fov=90;this.forwardRenderer.updateCameraFrustum(r),this.cullShadowCasters(e,n.visibleCasters,r)}}generateSplitDistances(t,e,i){t._shadowCascadeDistances.fill(i);for(let n=1;n<t.numCascades;n++){const s=n/t.numCascades,r=e+(i-e)*s,o=e*(i/e)**s,a=Z.lerp(r,o,t.cascadeDistribution);t._shadowCascadeDistances[n-1]=a}}cullDirectional(t,e,i){t.visibleThisFrame=!0,t._shadowMap||(t._shadowMap=hc.create(this.device,t));const n=i._nearClip;this.generateSplitDistances(t,n,t.shadowDistance);for(let s=0;s<t.numCascades;s++){const r=t.getRenderData(i,s),o=r.shadowCamera;o.renderTarget=t._shadowMap.renderTargets[0],r.shadowViewport.copy(t.cascades[s]),r.shadowScissor.copy(t.cascades[s]);const a=o._node,l=t._node;a.setPosition(l.getPosition()),a.setRotation(l.getRotation()),a.rotateLocal(-90,0,0);const h=0===s?n:t._shadowCascadeDistances[s-1],c=t._shadowCascadeDistances[s],_=sn.getPoints(i,h,c);Ac.set(0,0,0);const u=i.node.getWorldTransform();for(let t=0;t<8;t++)u.transformPoint(_[t],_[t]),Ac.add(_[t]);Ac.mulScalar(1/8);let d=0;for(let t=0;t<8;t++){const e=_[t].sub(Ac).length();e>d&&(d=e)}const p=a.right,f=a.up,m=a.forward,g=.25*t._shadowResolution/d,b=Math.ceil(Ac.dot(f)*g)/g,y=Math.ceil(Ac.dot(p)*g)/g,v=f.mulScalar(b),S=p.mulScalar(y),x=Ac.dot(m),w=m.mulScalar(x);Ac.add2(v,S).add(w),a.setPosition(Ac),a.translateLocal(0,0,1e6),o.nearClip=0,o.farClip=2e6,o.orthoHeight=d,this.forwardRenderer.updateCameraFrustum(o),this.cullShadowCasters(e,r.visibleCasters,o);let C=!0;const T=r.visibleCasters;for(let t=0;t<T.length;t++){const e=T[t];C?(C=!1,vc.copy(e.aabb)):vc.add(e.aabb)}Sc.copy(a.getWorldTransform()).invert();const A=bc(Sc,vc.getMin(),vc.getMax());a.translateLocal(0,0,A.max+.1),o.farClip=A.max-A.min+.2}}setupRenderState(t,e){const i=Ja.clusteredLightingEnabled;t.webgl2?e._type!==ie||i?(t.setDepthBias(!0),t.setDepthBiasValues(-1e3*e.shadowBias,-1e3*e.shadowBias)):t.setDepthBias(!1):t.extStandardDerivatives&&(e._type===ie?(this.polygonOffset[0]=0,this.polygonOffset[1]=0,this.polygonOffsetId.setValue(this.polygonOffset)):(this.polygonOffset[0]=-1e3*e.shadowBias,this.polygonOffset[1]=-1e3*e.shadowBias,this.polygonOffsetId.setValue(this.polygonOffset))),t.setBlending(!1),t.setDepthWrite(!0),t.setDepthTest(!0),t.setDepthFunc(ss);(i?e._isPcf&&t.webgl2:e._isPcf&&t.webgl2&&e._type!==ie)?t.setColorWrite(!1,!1,!1,!1):t.setColorWrite(!0,!0,!0,!0)}restoreRenderState(t){t.webgl2?t.setDepthBias(!1):t.extStandardDerivatives&&(this.polygonOffset[0]=0,this.polygonOffset[1]=0,this.polygonOffsetId.setValue(this.polygonOffset))}dispatchUniforms(t,e,i,n){const s=e._node;t._type!==ee&&(this.forwardRenderer.dispatchViewPos(s.getPosition()),this.shadowMapLightRadiusId.setValue(t.attenuationEnd)),Sc.setTRS(s.getPosition(),s.getRotation(),ht.ONE).invert(),xc.mul2(e.projectionMatrix,Sc);const r=i.shadowViewport;e.rect=r,e.scissorRect=i.shadowScissor,Ec.setViewport(r.x,r.y,r.z,r.w),i.shadowMatrix.mul2(Ec,xc),t._type===ee&&t._shadowMatrixPalette.set(i.shadowMatrix.data,16*n)}submitCasters(t,e){const i=this.device,n=this.forwardRenderer,s=1<<Li,r=e._shadowType+e._type*ge,o=t.length;for(let e=0;e<o;e++){const o=t[e],a=o.mesh,l=o.material;n.setBaseConstants(i,l),n.setSkinning(i,o,l),l.dirty&&(l.updateUniforms(i,n.scene),l.dirty=!1),l.chunks&&(n.setCullMode(!0,!1,o),l.setParameters(i),o.setParameters(i,s));let h=o._shader[Li+r];h||(n.updateShader(o,o._shaderDefs,null,Li+r),h=o._shader[Li+r],o._key[Ti]=Mc(o)),i.setShader(h),n.setVertexBuffers(i,a),n.setMorphing(i,o.morphInstance);const c=o.renderStyle;i.setIndexBuffer(a.indexBuffer[c]),e+=n.drawInstance(i,o,a,c),n._shadowDrawCalls++}}render(t,e){if(t.enabled&&t.castShadows&&t.shadowUpdateMode!==Si&&t.visibleThisFrame){const i=this.device;t.shadowUpdateMode===xi&&(t.shadowUpdateMode=Si);const n=t._type,s=t.numShadowFaces,r=this.forwardRenderer;r._shadowMapUpdates+=s,this.setupRenderState(i,t);for(let i=0;i<s;i++){const s=t.getRenderData(n===ee?e:null,i),o=s.shadowCamera,a=n===ee?0:i;o.renderTarget=t._shadowMap.renderTargets[a],this.dispatchUniforms(t,o,s,i),r.setCamera(o,o.renderTarget,!0),this.submitCasters(s.visibleCasters,t)}t._isVsm&&t._vsmBlurSize>1&&this.applyVsmBlur(t,e),this.restoreRenderState(i)}}getVsmBlurShader(t,e,i){let n=(t?this.blurPackedVsmShader:this.blurVsmShader)[e][i];if(!n){this.blurVsmWeights[i]=function(t){t>25&&(t=25);const e=(t-1)/6,i=.5*(t-1),n=new Array(t);let s=0;for(let r=0;r<t;++r)n[r]=yc(r-i,e),s+=n[r];for(let e=0;e<t;++e)n[e]/=s;return n}(i);const s=jo.fullscreenQuadVS;let r="#define SAMPLES "+i+"\n";r+=t?this.blurPackedVsmShaderCode[e]:this.blurVsmShaderCode[e];const o="blurVsm"+e+i+t;n=ia(this.device,s,r,o),t?this.blurPackedVsmShader[e][i]=n:this.blurVsmShader[e][i]=n}return n}applyVsmBlur(t,e){const i=this.device,n=t.getRenderData(t._type===ee?e:null,0).shadowCamera.renderTarget,s=this.shadowMapCache.get(i,t),r=s.renderTargets[0],o=t._shadowType===de,a=t.vsmBlurMode,l=t._vsmBlurSize,h=this.getVsmBlurShader(o,a,l);Cc.z=t._shadowResolution-2,Cc.w=Cc.z,this.sourceId.setValue(n.colorBuffer),wc[0]=1/t._shadowResolution,wc[1]=0,this.pixelOffsetId.setValue(wc),a===ye&&this.weightId.setValue(this.blurVsmWeights[l]),zo(i,r,h,null,Cc),this.sourceId.setValue(r.colorBuffer),wc[1]=wc[0],wc[0]=0,this.pixelOffsetId.setValue(wc),zo(i,n,h,null,Cc),this.shadowMapCache.add(t,s)}}const Ic=new Mt;class Pc{static lightCompare(t,e){return t.key-e.key}static prepare(t,e,i,n){var s,r,o,a,l,h,c,_,u,d,p,f,m,g,b,y,v,S,x,w,C,T,A,E,M,R,I,P,L,D,k,O,F,B,N,U,V,z=i,W=z.length,G=[],j=new ht,H=new ht,X=new Tt,Y=new bt,q=[],K=[],Z=[],Q=[];for(s=0;s<W;s++)if((c=z[s]).isStatic){for(N=c.aabb,Q.length=0,B=ie;B<=se;B++)for(r=0;r<n.length;r++)if((_=n[r])._type===B&&_.enabled&&_.mask&c.mask&&_.isStatic){if(K[r]||(K[r]=new Tt,_._node.getWorldTransform(),_.getBoundingSphere(Ic),K[r].center.copy(Ic.center),K[r].halfExtents.x=Ic.radius,K[r].halfExtents.y=Ic.radius,K[r].halfExtents.z=Ic.radius),!K[r].intersects(N))continue;Q.push(r)}if(0===Q.length){G.push(c);continue}for(D=(u=c.mesh).vertexBuffer,d=2===(L=u.indexBuffer[c.renderStyle]).bytesPerIndex?new Uint16Array(L.lock()):new Uint32Array(L.lock()),f=u.primitive[c.renderStyle].count/3,y=u.primitive[c.renderStyle].base,m=D.format.elements,g=D.format.size/4,p=new Float32Array(D.storage),o=0;o<m.length;o++)m[o].name===Zs&&(b=m[o].offset/4);for(q.length=f,o=0;o<f;o++)q[o]=0;for(P=!1,Z.length=6*f,o=0;o<f;o++){for(w=Number.MAX_VALUE,C=Number.MAX_VALUE,T=Number.MAX_VALUE,A=-Number.MAX_VALUE,E=-Number.MAX_VALUE,M=-Number.MAX_VALUE,a=0;a<3;a++)(v=p[h=(h=d[3*o+a+y])*g+b])<w&&(w=v),(S=p[h+1])<C&&(C=S),(x=p[h+2])<T&&(T=x),v>A&&(A=v),S>E&&(E=S),x>M&&(M=x);Z[h=6*o]=w,Z[h+1]=C,Z[h+2]=T,Z[h+3]=A,Z[h+4]=E,Z[h+5]=M}for(l=0;l<Q.length;l++)for(_=n[r=Q[l]],Y.copy(c.node.worldTransform).invert(),X.setFromTransformedAabb(K[r],Y),R=X.getMin(),I=X.getMax(),U=1<<l,o=0;o<f;o++)Z[h=6*o]<=I.x&&Z[h+3]>=R.x&&Z[h+1]<=I.y&&Z[h+4]>=R.y&&Z[h+2]<=I.z&&Z[h+5]>=R.z&&(q[o]|=U,P=!0);if(P){for(k={},o=0;o<f;o++)r=3*o+y,k[O=q[o]]||(k[O]=[]),(F=k[O]).push(d[r]),F.push(d[r+1]),F.push(d[r+2]);for(O in k){F=k[O];var $=new $l(t,L.format,F.length,L.usage);for((2===$.bytesPerIndex?new Uint16Array($.lock()):new Uint32Array($.lock())).set(F),$.unlock(),w=Number.MAX_VALUE,C=Number.MAX_VALUE,T=Number.MAX_VALUE,A=-Number.MAX_VALUE,E=-Number.MAX_VALUE,M=-Number.MAX_VALUE,o=0;o<F.length;o++)(v=p[(h=F[o])*g+b])<w&&(w=v),(S=p[h*g+b+1])<C&&(C=S),(x=p[h*g+b+2])<T&&(T=x),v>A&&(A=v),S>E&&(E=S),x>M&&(M=x);j.set(w,C,T),H.set(A,E,M);var J=new Tt;J.setMinMax(j,H);var tt=new xh(t);tt.vertexBuffer=D,tt.indexBuffer[0]=$,tt.primitive[0].type=Ys,tt.primitive[0].base=0,tt.primitive[0].count=F.length,tt.primitive[0].indexed=!0,tt.aabb=J;var et=new Kh(tt,c.material,c.node);for(et.isStatic=c.isStatic,et.visible=c.visible,et.layer=c.layer,et.castShadow=c.castShadow,et._receiveShadow=c._receiveShadow,et.cull=c.cull,et.pick=c.pick,et.mask=c.mask,et.parameters=c.parameters,et._shaderDefs=c._shaderDefs,et._staticSource=c,c._staticLightList?et._staticLightList=c._staticLightList:et._staticLightList=[],o=0;o<Q.length;o++)O&(U=1<<o)&&(V=n[Q[o]],et._staticLightList.indexOf(V)<0&&et._staticLightList.push(V));et._staticLightList.sort(Pc.lightCompare),G.push(et)}}else G.push(c)}else G.push(c);for(i.length=G.length,s=0;s<G.length;s++)i[s]=G[s]}static revert(t){const e=t,i=e.length,n=[];let s;for(let t=0;t<i;t++){const i=e[t];i._staticSource?i._staticSource!==s&&(n.push(i._staticSource),s=i._staticSource):n.push(i)}t.length=n.length;for(let e=0;e<n.length;e++)t[e]=n[e]}}const Lc=new bt,Dc=new bt,kc=new ct,Oc=new bt;let Fc;const Bc=(new bt).setScale(1,-1,1),Nc=new bt,Uc=new bt,Vc=new bt,zc=new bt,Wc=new bt,Gc=new bt,jc=new ht,Hc=new ht;let Xc,Yc;const qc=new ct,Kc=new ct,Zc=new bt,Qc=new bt,$c=new ht,Jc=new ht,t_=new ht,e_=new Mt,i_=[0,0,0,0];let n_,s_,r_,o_,a_,l_,h_=null,c_=0;const __={drawCalls:[],isNewMaterial:[],lightMaskChanged:[]},u_=new Set;class d_{constructor(t){this.device=t,this.scene=null,this._shadowDrawCalls=0,this._forwardDrawCalls=0,this._skinDrawCalls=0,this._numDrawCallsCulled=0,this._instancedDrawCalls=0,this._camerasRendered=0,this._materialSwitches=0,this._shadowMapUpdates=0,this._shadowMapTime=0,this._depthMapTime=0,this._forwardTime=0,this._cullTime=0,this._sortTime=0,this._skinTime=0,this._morphTime=0,this._instancingTime=0,this._removedByInstancing=0,this._layerCompositionUpdateTime=0,this._lightClustersTime=0,this._lightClusters=0;const e=this.device,i=e.getProgramLibrary();this.library=i,this.lightTextureAtlas=new dc(e),this._shadowRenderer=new Rc(this,this.lightTextureAtlas),this._cookieRenderer=new lc(e,this.lightTextureAtlas);const n=e.scope;this.projId=n.resolve("matrix_projection"),this.projSkyboxId=n.resolve("matrix_projectionSkybox"),this.viewId=n.resolve("matrix_view"),this.viewId3=n.resolve("matrix_view3"),this.viewInvId=n.resolve("matrix_viewInverse"),this.viewProjId=n.resolve("matrix_viewProjection"),this.viewPos=new Float32Array(3),this.viewPosId=n.resolve("view_position"),this.nearClipId=n.resolve("camera_near"),this.farClipId=n.resolve("camera_far"),this.cameraParamsId=n.resolve("camera_params"),this.tbnBasis=n.resolve("tbnBasis"),this.fogColorId=n.resolve("fog_color"),this.fogStartId=n.resolve("fog_start"),this.fogEndId=n.resolve("fog_end"),this.fogDensityId=n.resolve("fog_density"),this.modelMatrixId=n.resolve("matrix_model"),this.normalMatrixId=n.resolve("matrix_normal"),this.poseMatrixId=n.resolve("matrix_pose[0]"),this.boneTextureId=n.resolve("texture_poseMap"),this.boneTextureSizeId=n.resolve("texture_poseMapSize"),this.morphWeightsA=n.resolve("morph_weights_a"),this.morphWeightsB=n.resolve("morph_weights_b"),this.morphPositionTex=n.resolve("morphPositionTex"),this.morphNormalTex=n.resolve("morphNormalTex"),this.morphTexParams=n.resolve("morph_tex_params"),this.alphaTestId=n.resolve("alpha_ref"),this.opacityMapId=n.resolve("texture_opacityMap"),this.ambientId=n.resolve("light_globalAmbient"),this.exposureId=n.resolve("exposure"),this.skyboxIntensityId=n.resolve("skyboxIntensity"),this.lightColorId=[],this.lightDir=[],this.lightDirId=[],this.lightShadowMapId=[],this.lightShadowMatrixId=[],this.lightShadowParamsId=[],this.lightRadiusId=[],this.lightPos=[],this.lightPosId=[],this.lightWidth=[],this.lightWidthId=[],this.lightHeight=[],this.lightHeightId=[],this.lightInAngleId=[],this.lightOutAngleId=[],this.lightCookieId=[],this.lightCookieIntId=[],this.lightCookieMatrixId=[],this.lightCookieOffsetId=[],this.shadowMatrixPaletteId=[],this.shadowCascadeDistancesId=[],this.shadowCascadeCountId=[],this.depthMapId=n.resolve("uDepthMap"),this.screenSizeId=n.resolve("uScreenSize"),this._screenSize=new Float32Array(4),this.twoSidedLightingNegScaleFactorId=n.resolve("twoSidedLightingNegScaleFactor"),this.fogColor=new Float32Array(3),this.ambientColor=new Float32Array(3),this.cameraParams=new Float32Array(4)}destroy(){this._shadowRenderer.destroy(),this._shadowRenderer=null,this._cookieRenderer.destroy(),this._cookieRenderer=null,this.lightTextureAtlas.destroy(),this.lightTextureAtlas=null}sortCompare(t,e){if(t.layer===e.layer){if(t.drawOrder&&e.drawOrder)return t.drawOrder-e.drawOrder;if(t.zdist&&e.zdist)return e.zdist-t.zdist;if(t.zdist2&&e.zdist2)return t.zdist2-e.zdist2}return e._key[Ci]-t._key[Ci]}sortCompareMesh(t,e){if(t.layer===e.layer){if(t.drawOrder&&e.drawOrder)return t.drawOrder-e.drawOrder;if(t.zdist&&e.zdist)return e.zdist-t.zdist}return a_=t._key[Ci],l_=e._key[Ci],a_===l_&&t.mesh&&e.mesh?e.mesh.id-t.mesh.id:l_-a_}depthSortCompare(t,e){return a_=t._key[Ti],l_=e._key[Ti],a_===l_&&t.mesh&&e.mesh?e.mesh.id-t.mesh.id:l_-a_}updateCameraFrustum(t){if(t.vrDisplay&&t.vrDisplay.presenting){Fc=t.vrDisplay.combinedProj;const e=t._node.parent;e?Dc.copy(e.getWorldTransform()).mul(t.vrDisplay.combinedViewInv).invert():Dc.copy(t.vrDisplay.combinedView),Lc.copy(Dc).invert(),this.viewInvId.setValue(Lc.data),Oc.mul2(Fc,Dc),t.frustum.setFromMat4(Oc)}else if(t.xr&&t.xr.views.length){const e=t.xr.views[0];return Oc.mul2(e.projMat,e.viewOffMat),void t.frustum.setFromMat4(Oc)}if(Fc=t.projectionMatrix,t.calculateProjection&&t.calculateProjection(Fc,Ui),t.calculateTransform)t.calculateTransform(Lc,Ui);else{const e=t._node.getPosition(),i=t._node.getRotation();Lc.setTRS(e,i,ht.ONE),this.viewInvId.setValue(Lc.data)}Dc.copy(Lc).invert(),Oc.mul2(Fc,Dc),t.frustum.setFromMat4(Oc)}setCamera(t,e,i){const n=t.vrDisplay;let s;if(n&&n.presenting){if(Xc=n.leftProj,Yc=n.rightProj,Fc=n.combinedProj,t.calculateProjection&&(t.calculateProjection(Xc,Vi),t.calculateProjection(Yc,zi),t.calculateProjection(Fc,Ui)),t.calculateTransform)t.calculateTransform(Vc,Vi),t.calculateTransform(zc,zi),t.calculateTransform(Lc,Ui),Wc.copy(Vc).invert(),Gc.copy(zc).invert(),Dc.copy(Lc).invert();else{const e=t._node.parent;e?(s=e.getWorldTransform(),Vc.mul2(s,n.leftViewInv),zc.mul2(s,n.rightViewInv),Wc.copy(Vc).invert(),Gc.copy(zc).invert(),Dc.copy(e.getWorldTransform()).mul(n.combinedViewInv).invert()):(Vc.copy(n.leftViewInv),zc.copy(n.rightViewInv),Wc.copy(n.leftView),Gc.copy(n.rightView),Dc.copy(n.combinedView))}qc.setFromMat4(Wc),Kc.setFromMat4(Gc),Zc.mul2(Xc,Wc),Qc.mul2(Yc,Gc),jc.x=Vc.data[12],jc.y=Vc.data[13],jc.z=Vc.data[14],Hc.x=zc.data[12],Hc.y=zc.data[13],Hc.z=zc.data[14],Oc.mul2(Fc,Dc),t.frustum.setFromMat4(Oc)}else if(t.xr&&t.xr.session){const e=t._node.parent;e&&(s=e.getWorldTransform());const i=t.xr.views;for(let n=0;n<i.length;n++){const r=i[n];e?(r.viewInvOffMat.mul2(s,r.viewInvMat),r.viewOffMat.copy(r.viewInvOffMat).invert()):(r.viewInvOffMat.copy(r.viewInvMat),r.viewOffMat.copy(r.viewMat)),r.viewMat3.setFromMat4(r.viewOffMat),r.projViewOffMat.mul2(r.projMat,r.viewOffMat),r.position[0]=r.viewInvOffMat.data[12],r.position[1]=r.viewInvOffMat.data[13],r.position[2]=r.viewInvOffMat.data[14],t.frustum.setFromMat4(r.projViewOffMat)}}else{if(Fc=t.projectionMatrix,t.calculateProjection&&t.calculateProjection(Fc,Ui),this.projId.setValue(Fc.data),this.projSkyboxId.setValue(t.getProjectionMatrixSkybox().data),t.calculateTransform)t.calculateTransform(Lc,Ui);else{const e=t._node.getPosition(),i=t._node.getRotation();Lc.setTRS(e,i,ht.ONE)}this.viewInvId.setValue(Lc.data),Dc.copy(Lc).invert(),this.viewId.setValue(Dc.data),kc.setFromMat4(Dc),this.viewId3.setValue(kc.data),Oc.mul2(Fc,Dc),e&&e.flipY?(Nc.mul2(Bc,Oc),Uc.mul2(Bc,t.getProjectionMatrixSkybox()),this.viewProjId.setValue(Nc.data),this.projSkyboxId.setValue(Uc.data)):(this.viewProjId.setValue(Oc.data),this.projSkyboxId.setValue(t.getProjectionMatrixSkybox().data)),this.dispatchViewPos(t._node.getPosition()),t.frustum.setFromMat4(Oc)}this.tbnBasis.setValue(e&&e.flipY?-1:1),this.nearClipId.setValue(t._nearClip),this.farClipId.setValue(t._farClip);const r=t._nearClip,o=t._farClip;this.cameraParams[0]=1/o,this.cameraParams[1]=o,this.cameraParams[2]=.5*(1-o/r),this.cameraParams[3]=.5*(1+o/r),this.cameraParamsId.setValue(this.cameraParams),this.clearView(t,e,i,!1)}clearView(t,e,i,n,s){const r=this.device;r.setRenderTarget(e),r.updateBegin(),n&&(r.setColorWrite(!0,!0,!0,!0),r.setDepthWrite(!0));const o=e?e.width:r.width,a=e?e.height:r.height,l=t.rect;let h=Math.floor(l.x*o),c=Math.floor(l.y*a),_=Math.floor(l.z*o),u=Math.floor(l.w*a);if(r.setViewport(h,c,_,u),t._scissorRectClear){const e=t.scissorRect;h=Math.floor(e.x*o),c=Math.floor(e.y*a),_=Math.floor(e.z*o),u=Math.floor(e.w*a)}r.setScissor(h,c,_,u),i&&(s||(s=t._clearOptions),r.clear(s||{color:[t._clearColor.r,t._clearColor.g,t._clearColor.b,t._clearColor.a],depth:t._clearDepth,flags:(t._clearColorBuffer?Fn:0)|(t._clearDepthBuffer?Bn:0)|(t._clearStencilBuffer?Nn:0),stencil:t._clearStencil}))}dispatchGlobalLights(t){if(this.ambientColor[0]=t.ambientLight.r,this.ambientColor[1]=t.ambientLight.g,this.ambientColor[2]=t.ambientLight.b,t.gammaCorrection)for(let t=0;t<3;t++)this.ambientColor[t]=Math.pow(this.ambientColor[t],2.2);this.ambientId.setValue(this.ambientColor),this.exposureId.setValue(t.exposure),t.skyboxModel&&this.skyboxIntensityId.setValue(t.skyboxIntensity)}_resolveLight(t,e){const i="light"+e;this.lightColorId[e]=t.resolve(i+"_color"),this.lightDir[e]=new Float32Array(3),this.lightDirId[e]=t.resolve(i+"_direction"),this.lightShadowMapId[e]=t.resolve(i+"_shadowMap"),this.lightShadowMatrixId[e]=t.resolve(i+"_shadowMatrix"),this.lightShadowParamsId[e]=t.resolve(i+"_shadowParams"),this.lightRadiusId[e]=t.resolve(i+"_radius"),this.lightPos[e]=new Float32Array(3),this.lightPosId[e]=t.resolve(i+"_position"),this.lightWidth[e]=new Float32Array(3),this.lightWidthId[e]=t.resolve(i+"_halfWidth"),this.lightHeight[e]=new Float32Array(3),this.lightHeightId[e]=t.resolve(i+"_halfHeight"),this.lightInAngleId[e]=t.resolve(i+"_innerConeAngle"),this.lightOutAngleId[e]=t.resolve(i+"_outerConeAngle"),this.lightCookieId[e]=t.resolve(i+"_cookie"),this.lightCookieIntId[e]=t.resolve(i+"_cookieIntensity"),this.lightCookieMatrixId[e]=t.resolve(i+"_cookieMatrix"),this.lightCookieOffsetId[e]=t.resolve(i+"_cookieOffset"),this.shadowMatrixPaletteId[e]=t.resolve(i+"_shadowMatrixPalette[0]"),this.shadowCascadeDistancesId[e]=t.resolve(i+"_shadowCascadeDistances[0]"),this.shadowCascadeCountId[e]=t.resolve(i+"_shadowCascadeCount")}setLTCDirectionallLight(t,e,i,n,s){this.lightPos[e][0]=n.x-i.x*s,this.lightPos[e][1]=n.y-i.y*s,this.lightPos[e][2]=n.z-i.z*s,this.lightPosId[e].setValue(this.lightPos[e]);const r=t.transformVector(new ht(-.5,0,0));this.lightWidth[e][0]=r.x*s,this.lightWidth[e][1]=r.y*s,this.lightWidth[e][2]=r.z*s,this.lightWidthId[e].setValue(this.lightWidth[e]);const o=t.transformVector(new ht(0,0,.5));this.lightHeight[e][0]=o.x*s,this.lightHeight[e][1]=o.y*s,this.lightHeight[e][2]=o.z*s,this.lightHeightId[e].setValue(this.lightHeight[e])}dispatchDirectLights(t,e,i,n){let s=0;const r=this.device.scope;for(let o=0;o<t.length;o++){if(!(t[o].mask&i))continue;const a=t[o],l=a._node.getWorldTransform();if(this.lightColorId[s]||this._resolveLight(r,s),this.lightColorId[s].setValue(e.gammaCorrection?a._linearFinalColor:a._finalColor),l.getY(a._direction).mulScalar(-1),a._direction.normalize(),this.lightDir[s][0]=a._direction.x,this.lightDir[s][1]=a._direction.y,this.lightDir[s][2]=a._direction.z,this.lightDirId[s].setValue(this.lightDir[s]),a.shape!==re&&this.setLTCDirectionallLight(l,s,a._direction,n._node.getPosition(),n.farClip),a.castShadows){const t=a.getRenderData(n,0),e=a._getUniformBiasValues(t);this.lightShadowMapId[s].setValue(t.shadowBuffer),this.lightShadowMatrixId[s].setValue(t.shadowMatrix.data),this.shadowMatrixPaletteId[s].setValue(a._shadowMatrixPalette),this.shadowCascadeDistancesId[s].setValue(a._shadowCascadeDistances),this.shadowCascadeCountId[s].setValue(a.numCascades);const i=a._shadowRenderParams;i.length=3,i[0]=a._shadowResolution,i[1]=e.normalBias,i[2]=e.bias,this.lightShadowParamsId[s].setValue(i)}s++}return s}setLTCPositionalLight(t,e){const i=t.transformVector(new ht(-.5,0,0));this.lightWidth[e][0]=i.x,this.lightWidth[e][1]=i.y,this.lightWidth[e][2]=i.z,this.lightWidthId[e].setValue(this.lightWidth[e]);const n=t.transformVector(new ht(0,0,.5));this.lightHeight[e][0]=n.x,this.lightHeight[e][1]=n.y,this.lightHeight[e][2]=n.z,this.lightHeightId[e].setValue(this.lightHeight[e])}dispatchOmniLight(t,e,i,n){const s=i._node.getWorldTransform();if(this.lightColorId[n]||this._resolveLight(e,n),this.lightRadiusId[n].setValue(i.attenuationEnd),this.lightColorId[n].setValue(t.gammaCorrection?i._linearFinalColor:i._finalColor),s.getTranslation(i._position),this.lightPos[n][0]=i._position.x,this.lightPos[n][1]=i._position.y,this.lightPos[n][2]=i._position.z,this.lightPosId[n].setValue(this.lightPos[n]),i.shape!==re&&this.setLTCPositionalLight(s,n),i.castShadows){const t=i.getRenderData(null,0);this.lightShadowMapId[n].setValue(t.shadowBuffer);const e=i._getUniformBiasValues(t),s=i._shadowRenderParams;s.length=4,s[0]=i._shadowResolution,s[1]=e.normalBias,s[2]=e.bias,s[3]=1/i.attenuationEnd,this.lightShadowParamsId[n].setValue(s)}i._cookie&&(this.lightCookieId[n].setValue(i._cookie),this.lightShadowMatrixId[n].setValue(s.data),this.lightCookieIntId[n].setValue(i.cookieIntensity))}dispatchSpotLight(t,e,i,n){const s=i._node.getWorldTransform();if(this.lightColorId[n]||this._resolveLight(e,n),this.lightInAngleId[n].setValue(i._innerConeAngleCos),this.lightOutAngleId[n].setValue(i._outerConeAngleCos),this.lightRadiusId[n].setValue(i.attenuationEnd),this.lightColorId[n].setValue(t.gammaCorrection?i._linearFinalColor:i._finalColor),s.getTranslation(i._position),this.lightPos[n][0]=i._position.x,this.lightPos[n][1]=i._position.y,this.lightPos[n][2]=i._position.z,this.lightPosId[n].setValue(this.lightPos[n]),i.shape!==re&&this.setLTCPositionalLight(s,n),s.getY(i._direction).mulScalar(-1),i._direction.normalize(),this.lightDir[n][0]=i._direction.x,this.lightDir[n][1]=i._direction.y,this.lightDir[n][2]=i._direction.z,this.lightDirId[n].setValue(this.lightDir[n]),i.castShadows){const t=i.getRenderData(null,0);this.lightShadowMapId[n].setValue(t.shadowBuffer),this.lightShadowMatrixId[n].setValue(t.shadowMatrix.data);const e=i._getUniformBiasValues(t),s=i._shadowRenderParams;s.length=4,s[0]=i._shadowResolution,s[1]=e.normalBias,s[2]=e.bias,s[3]=1/i.attenuationEnd,this.lightShadowParamsId[n].setValue(s)}if(i._cookie){if(!i.castShadows){const t=Fa.evalSpotCookieMatrix(i);this.lightShadowMatrixId[n].setValue(t.data)}this.lightCookieId[n].setValue(i._cookie),this.lightCookieIntId[n].setValue(i.cookieIntensity),i._cookieTransform&&(i._cookieTransformUniform[0]=i._cookieTransform.x,i._cookieTransformUniform[1]=i._cookieTransform.y,i._cookieTransformUniform[2]=i._cookieTransform.z,i._cookieTransformUniform[3]=i._cookieTransform.w,this.lightCookieMatrixId[n].setValue(i._cookieTransformUniform),i._cookieOffsetUniform[0]=i._cookieOffset.x,i._cookieOffsetUniform[1]=i._cookieOffset.y,this.lightCookieOffsetId[n].setValue(i._cookieOffsetUniform))}}dispatchLocalLights(t,e,i,n,s){let r=n;const o=this.device.scope,a=t[ie],l=a.length;for(let t=0;t<l;t++){const n=a[t];n.mask&i&&(n.isStatic||(this.dispatchOmniLight(e,o,n,r),r++))}let h=0;if(s){let t=s[h];for(;t&&t._type===ie;)this.dispatchOmniLight(e,o,t,r),r++,h++,t=s[h]}const c=t[se],_=c.length;for(let t=0;t<_;t++){const n=c[t];n.mask&i&&(n.isStatic||(this.dispatchSpotLight(e,o,n,r),r++))}if(s){let t=s[h];for(;t&&t._type===se;)this.dispatchSpotLight(e,o,t,r),r++,h++,t=s[h]}}cull(t,e,i){let n=0;const s=e.length,r=t.cullingMask||4294967295;if(!t.frustumCulling){for(let t=0;t<s;t++){const s=e[t];(s.visible||s.command)&&(s.mask&&0==(s.mask&r)||(i[n]=s,n++,s.visibleThisFrame=!0))}return n}for(let o=0;o<s;o++){const s=e[o];if(s.command)i[n]=s,n++,s.visibleThisFrame=!0;else{if(!s.visible)continue;let e=!0;if(s.mask&&0==(s.mask&r))continue;s.cull&&(e=s._isVisible(t)),e&&(i[n]=s,n++,s.visibleThisFrame=!0)}}return n}cullLights(t,e){for(let i=0;i<e.length;i++){const n=e[i];!n.visibleThisFrame&&n.enabled&&(n._type===ee?n.visibleThisFrame=!0:(n.getBoundingSphere(e_),(t.frustum.containsSphere(e_)||n.castShadows&&!n.shadowMap)&&(n.visibleThisFrame=!0)))}}updateCpuSkinMatrices(t){c_++;const e=t.length;if(0!==e)for(let i=0;i<e;i++){const e=t[i].skinInstance;e&&(e.updateMatrices(t[i].node,c_),e._dirty=!0)}}updateGpuSkinMatrices(t){const e=t.length;for(let i=0;i<e;i++){if(!t[i].visibleThisFrame)continue;const e=t[i].skinInstance;e&&e._dirty&&(e.updateMatrixPalette(t[i].node,c_),e._dirty=!1)}}updateMorphing(t){const e=t.length;for(let i=0;i<e;i++){const e=t[i].morphInstance;e&&e._dirty&&t[i].visibleThisFrame&&e.update()}}setBaseConstants(t,e){t.setCullMode(e.cull),e.opacityMap&&(this.opacityMapId.setValue(e.opacityMap),this.alphaTestId.setValue(e.alphaTest))}setSkinning(t,e,i){e.skinInstance&&(this._skinDrawCalls++,t.supportsBoneTextures?(n_=e.skinInstance.boneTexture,this.boneTextureId.setValue(n_),i_[0]=n_.width,i_[1]=n_.height,i_[2]=1/n_.width,i_[3]=1/n_.height,this.boneTextureSizeId.setValue(i_)):this.poseMatrixId.setValue(e.skinInstance.matrixPalette))}drawInstance(t,e,i,n,s){if(s_=e.instancingData,s_){if(s_.count>0&&(this._instancedDrawCalls++,t.setVertexBuffer(s_.vertexBuffer),t.draw(i.primitive[n],s_.count),s_.vertexBuffer===h_))return this._removedByInstancing+=s_.count,e.instancingData=null,s_.count-1}else r_=e.node.worldTransform,this.modelMatrixId.setValue(r_.data),s&&(o_=e.node.normalMatrix,e.node._dirtyNormal&&(r_.invertTo3x3(o_),o_.transpose(),e.node._dirtyNormal=!1),this.normalMatrixId.setValue(o_.data)),t.draw(i.primitive[n]);return 0}drawInstance2(t,e,i,n){if(s_=e.instancingData,s_){if(s_.count>0&&(this._instancedDrawCalls++,t.draw(i.primitive[n],s_.count,!0),s_.vertexBuffer===h_))return this._removedByInstancing+=s_.count,e.instancingData=null,s_.count-1}else t.draw(i.primitive[n],void 0,!0);return 0}renderShadows(t,e){const i=this.device;i.grabPassAvailable=!1;for(let i=0;i<t.length;i++)this._shadowRenderer.render(t[i],e);i.grabPassAvailable=!0}renderCookies(t){const e=this.lightTextureAtlas.cookieRenderTarget;for(let i=0;i<t.length;i++)this._cookieRenderer.render(t[i],e)}updateShader(t,e,i,n,s){t.material._scene=this.scene,t.material._dirtyBlend&&(this.scene.layers._dirtyBlend=!0),t.material.updateShader(this.device,this.scene,e,i,n,s),t._shader[n]=t.material.shader}setCullMode(t,e,i){const n=i.material;let s=Hn;if(t){let t=1;if(n.cull>Hn&&n.cull<qn){i.flipFaces&&(t*=-1),e&&(t*=-1);const n=i.node.worldTransform;n.getX($c),n.getY(Jc),n.getZ(t_),$c.cross($c,Jc),$c.dot(t_)<0&&(t*=-1)}s=t<0?n.cull===Yn?Xn:Yn:n.cull}if(this.device.setCullMode(s),s===Hn&&n.cull===Hn){const t=i.node.worldTransform;t.getX($c),t.getY(Jc),t.getZ(t_),$c.cross($c,Jc),$c.dot(t_)<0?this.twoSidedLightingNegScaleFactorId.setValue(-1):this.twoSidedLightingNegScaleFactorId.setValue(1)}}setVertexBuffers(t,e){t.setVertexBuffer(e.vertexBuffer)}setMorphing(t,e){if(e)if(e.morph.useTextureMorph)t.setVertexBuffer(e.morph.vertexBufferIds),this.morphPositionTex.setValue(e.texturePositions),this.morphNormalTex.setValue(e.textureNormals),this.morphTexParams.setValue(e._textureParams);else{for(let i=0;i<e._activeVertexBuffers.length;i++){const n=e._activeVertexBuffers[i];if(n){const e=_r+(i+8);n.format.elements[0].name=e,n.format.elements[0].scopeId=t.scope.resolve(e),n.format.update(),t.setVertexBuffer(n)}}this.morphWeightsA.setValue(e._shaderMorphWeightsA),this.morphWeightsB.setValue(e._shaderMorphWeightsB)}}dispatchViewPos(t){const e=this.viewPos;e[0]=t.x,e[1]=t.y,e[2]=t.z,this.viewPosId.setValue(e)}renderForwardPrepareMaterials(t,e,i,n,s,r,o){const a=(t,e,i)=>{__.drawCalls.push(t),__.isNewMaterial.push(e),__.lightMaskChanged.push(i)};__.drawCalls.length=0,__.isNewMaterial.length=0,__.lightMaskChanged.length=0;const l=this.device,h=this.scene,c=r?r._lightHash:0;let _,u,d,p=null;for(let t=0;t<i;t++){const i=e[t];if(!s||!i.mask||s&i.mask)if(i.command)a(i,!1,!1);else{i.material||(i.material=this.scene.defaultMaterial);const t=i.material,e=i._shaderDefs,s=i.mask;if(t&&t===p&&e!==_&&(p=null),(i.isStatic||u)&&(p=null),t!==p&&(this._materialSwitches++,t.dirty&&(t.updateUniforms(l,h),t.dirty=!1),!i._shader[o]||i._shaderDefs!==e||i._lightHash!==c)){if(i.isStatic)this.updateShader(i,e,i._staticLightList,o,n);else{const s=o+"_"+e+"_"+c;i._shader[o]=t.variants[s],i._shader[o]||(this.updateShader(i,e,null,o,n),t.variants[s]=i._shader[o])}i._shaderDefs=e,i._lightHash=c}a(i,t!==p,!p||s!==d),p=t,_=e,d=s,u=i.isStatic}}return __}renderForward(t,e,i,n,s,r,o,a,l){const h=this.device,c=this.scene,_=t.vrDisplay,u=1<<s,d=.5*h.width,p=this.renderForwardPrepareMaterials(t,e,i,n,r,a,s),f=p.drawCalls.length;for(let e=0;e<f;e++){const i=p.drawCalls[e];if(i.command)i.command();else{const r=p.isNewMaterial[e],a=p.lightMaskChanged[e],m=i.material;i._shaderDefs;const g=i.mask;if(r){if(i._shader[s].failed||h.setShader(i._shader[s])||(i._shader[s].failed=!0),m.setParameters(h),a){const e=this.dispatchDirectLights(n[ee],c,g,t);this.dispatchLocalLights(n,c,g,e,i._staticLightList)}this.alphaTestId.setValue(m.alphaTest),h.setBlending(m.blend),m.blend&&(m.separateAlphaBlend?(h.setBlendFunctionSeparate(m.blendSrc,m.blendDst,m.blendSrcAlpha,m.blendDstAlpha),h.setBlendEquationSeparate(m.blendEquation,m.blendAlphaEquation)):(h.setBlendFunction(m.blendSrc,m.blendDst),h.setBlendEquation(m.blendEquation))),h.setColorWrite(m.redWrite,m.greenWrite,m.blueWrite,m.alphaWrite),h.setDepthWrite(m.depthWrite),m.depthWrite&&!m.depthTest?(h.setDepthFunc(ls),h.setDepthTest(!0)):(h.setDepthFunc(ss),h.setDepthTest(m.depthTest)),h.setAlphaToCoverage(m.alphaToCoverage),m.depthBias||m.slopeDepthBias?(h.setDepthBias(!0),h.setDepthBiasValues(m.depthBias,m.slopeDepthBias)):h.setDepthBias(!1)}this.setCullMode(t._cullFaces,l,i);const b=i.stencilFront||m.stencilFront,y=i.stencilBack||m.stencilBack;b||y?(h.setStencilTest(!0),b===y?(h.setStencilFunc(b.func,b.ref,b.readMask),h.setStencilOperation(b.fail,b.zfail,b.zpass,b.writeMask)):(b?(h.setStencilFuncFront(b.func,b.ref,b.readMask),h.setStencilOperationFront(b.fail,b.zfail,b.zpass,b.writeMask)):(h.setStencilFuncFront(ls,0,255),h.setStencilOperationFront(Rr,Rr,Rr,255)),y?(h.setStencilFuncBack(y.func,y.ref,y.readMask),h.setStencilOperationBack(y.fail,y.zfail,y.zpass,y.writeMask)):(h.setStencilFuncBack(ls,0,255),h.setStencilOperationBack(Rr,Rr,Rr,255)))):h.setStencilTest(!1);const v=i.mesh;i.setParameters(h,u),this.setVertexBuffers(h,v),this.setMorphing(h,i.morphInstance),this.setSkinning(h,i,m);const S=i.renderStyle;if(h.setIndexBuffer(v.indexBuffer[S]),o&&o(i,e),_&&_.presenting)h.setViewport(0,0,d,h.height),this.projId.setValue(Xc.data),this.projSkyboxId.setValue(Xc.data),this.viewInvId.setValue(Vc.data),this.viewId.setValue(Wc.data),this.viewId3.setValue(qc.data),this.viewProjId.setValue(Zc.data),this.dispatchViewPos(jc),e+=this.drawInstance(h,i,v,S,!0),this._forwardDrawCalls++,h.setViewport(d,0,d,h.height),this.projId.setValue(Yc.data),this.projSkyboxId.setValue(Yc.data),this.viewInvId.setValue(zc.data),this.viewId.setValue(Gc.data),this.viewId3.setValue(Kc.data),this.viewProjId.setValue(Qc.data),this.dispatchViewPos(Hc),e+=this.drawInstance2(h,i,v,S),this._forwardDrawCalls++;else if(t.xr&&t.xr.session&&t.xr.views.length){const n=t.xr.views;for(let t=0;t<n.length;t++){const s=n[t];h.setViewport(s.viewport.x,s.viewport.y,s.viewport.z,s.viewport.w),this.projId.setValue(s.projMat.data),this.projSkyboxId.setValue(s.projMat.data),this.viewId.setValue(s.viewOffMat.data),this.viewInvId.setValue(s.viewInvOffMat.data),this.viewId3.setValue(s.viewMat3.data),this.viewProjId.setValue(s.projViewOffMat.data),this.viewPosId.setValue(s.position),e+=0===t?this.drawInstance(h,i,v,S,!0):this.drawInstance2(h,i,v,S),this._forwardDrawCalls++}}else e+=this.drawInstance(h,i,v,S,!0),this._forwardDrawCalls++;e<f-1&&!p.isNewMaterial[e+1]&&m.setParameters(h,i.parameters)}}h.updateEnd(),__.length=0}setupInstancing(t){t.enableAutoInstancing&&(h_||(h_=new Fo(t,No.defaultInstancingFormat,t.autoInstancingMaxObjects,Dn)))}updateShaders(t){const e=t.length;for(let i=0;i<e;i++){const e=t[i].material;e&&(u_.has(e)||(u_.add(e),e.updateShader!==pl.prototype.updateShader&&(e.clearVariants(),e.shader=null)))}u_.clear()}updateLitShaders(t){const e=t.length;for(let i=0;i<e;i++){const e=t[i].material;e&&(u_.has(e)||(u_.add(e),e.updateShader!==pl.prototype.updateShader&&(!e.useLighting||e.emitter&&!e.emitter.lighting||(e.clearVariants(),e.shader=null))))}u_.clear()}beginFrame(t){const e=this.scene,i=t._meshInstances,n=t._lights;e.updateShaders?(this.updateShaders(i),e.updateShaders=!1,e.updateLitShaders=!1,e._shaderVersion++):e.updateLitShaders&&(this.updateLitShaders(i),e.updateLitShaders=!1,e._shaderVersion++),this.updateCpuSkinMatrices(i);const s=i.length;for(let t=0;t<s;t++)i[t].visibleThisFrame=!1;const r=n.length;for(let t=0;t<r;t++)n[t].visibleThisFrame=n[t]._type===ee}beginLayers(t){const e=t.layerList.length;for(let i=0;i<e;i++)t.layerList[i]._postRenderCounter=0;const i=this.scene,n=i._shaderVersion;for(let s=0;s<e;s++){const e=t.layerList[s];e._shaderVersion=n,e._preRenderCalledForCameras=0,e._postRenderCalledForCameras=0;const r=t.subLayerList[s];e._postRenderCounter|=r?2:1,e._postRenderCounterMax=e._postRenderCounter;for(let t=0;t<e.cameras.length;t++)e.instances.prepare(t);e._needsStaticPrepare&&e._staticLightHash&&(e._staticPrepareDone&&(Pc.revert(e.opaqueMeshInstances),Pc.revert(e.transparentMeshInstances)),Pc.prepare(this.device,i,e.opaqueMeshInstances,e._lights),Pc.prepare(this.device,i,e.transparentMeshInstances,e._lights),t._dirty=!0,i.updateShaders=!0,e._needsStaticPrepare=!1,e._staticPrepareDone=!0)}}gpuUpdate(t){this.updateGpuSkinMatrices(t),this.updateMorphing(t)}setSceneConstants(){const t=this.scene;if(this.dispatchGlobalLights(t),t.fog!==Vt){if(this.fogColor[0]=t.fogColor.r,this.fogColor[1]=t.fogColor.g,this.fogColor[2]=t.fogColor.b,t.gammaCorrection)for(let t=0;t<3;t++)this.fogColor[t]=Math.pow(this.fogColor[t],2.2);this.fogColorId.setValue(this.fogColor),t.fog===zt?(this.fogStartId.setValue(t.fogStart),this.fogEndId.setValue(t.fogEnd)):this.fogDensityId.setValue(t.fogDensity)}const e=this.device;this._screenSize[0]=e.width,this._screenSize[1]=e.height,this._screenSize[2]=1/e.width,this._screenSize[3]=1/e.height,this.screenSizeId.setValue(this._screenSize)}updateLightStats(t,e){}cullShadowmaps(t){for(let e=0;e<t._lights.length;e++){const i=t._lights[e];if(i._type!==ee&&i.visibleThisFrame&&i.castShadows&&i.shadowUpdateMode!==Si){const n=t._lightCompositionData[e].shadowCastersList;this._shadowRenderer.cullLocal(i,n)}}const e=t._renderActions;for(let i=0;i<e.length;i++){const n=e[i],s=n.directionalLightsIndices.length;for(let e=0;e<s;e++){const i=n.directionalLightsIndices[e],s=t._lights[i],r=t._lightCompositionData[i].shadowCastersList;this._shadowRenderer.cullDirectional(s,r,n.camera.camera)}}}cullComposition(t){const e=t._renderActions;for(let i=0;i<e.length;i++){const n=e[i],s=n.layerIndex,r=t.layerList[s];if(!r.enabled||!t.subLayerEnabled[s])continue;const o=t.subLayerList[s],a=n.cameraIndex,l=r.cameras[a];if(l){l.frameBegin(n.renderTarget),n.firstCameraUse&&(this.updateCameraFrustum(l.camera),this._camerasRendered++),this.cullLights(l.camera,r._lights);const t=r.instances,e=o?t.visibleTransparent[a]:t.visibleOpaque[a];if(!e.done){r.onPreCull&&r.onPreCull(a);const t=o?r.transparentMeshInstances:r.opaqueMeshInstances;e.length=this.cull(l.camera,t,e.list),e.done=!0,r.onPostCull&&r.onPostCull(a)}l.frameEnd()}}this.cullShadowmaps(t)}updateLightTextureAtlas(t){this.lightTextureAtlas.update(t._splitLights[se],t._splitLights[ie],t.clusteredLightingCookiesEnabled,t.clusteredLightingShadowsEnabled)}updateClusters(t){for(let e=0;e<t._worldClusters.length;e++){t._worldClusters[e].update(t._lights,this.scene.gammaCorrection)}}renderComposition(t){const e=this.device;this.scene._updateSkybox(e),this.beginLayers(t);const i=t._update();i&Ki&&(this.scene.updateLitShaders=!0),this.updateLightStats(t,i),this.beginFrame(t),this.setSceneConstants(),this.cullComposition(t),this.gpuUpdate(t._meshInstances),Ja.clusteredLightingEnabled&&(this.updateLightTextureAtlas(t),t.clusteredLightingCookiesEnabled&&(this.renderCookies(t._splitLights[se]),this.renderCookies(t._splitLights[ie]))),(!Ja.clusteredLightingEnabled||Ja.clusteredLightingEnabled&&t.clusteredLightingShadowsEnabled)&&(this.renderShadows(t._splitLights[se]),this.renderShadows(t._splitLights[ie])),Ja.clusteredLightingEnabled&&this.updateClusters(t);const n=t._renderActions;for(let i=0;i<n.length;i++){const r=n[i],o=r.layerIndex,a=t.layerList[o],l=t.subLayerList[o],h=r.cameraIndex,c=a.cameras[h];if(r.directionalLights.length>0&&this.renderShadows(r.directionalLights,c.camera),a.enabled&&t.subLayerEnabled[o]){if(c&&c.frameBegin(r.renderTarget),!l&&a.onPreRenderOpaque?a.onPreRenderOpaque(h):l&&a.onPreRenderTransparent&&a.onPreRenderTransparent(h),a._preRenderCalledForCameras&1<<h||(a.onPreRender&&a.onPreRender(h),a._preRenderCalledForCameras|=1<<h),c){var s;if(r.clearColor||r.clearDepth||r.clearStencil){const t=c.camera._clearColorBuffer,e=c.camera._clearDepthBuffer,i=c.camera._clearStencilBuffer;c.camera._clearColorBuffer=r.clearColor,c.camera._clearDepthBuffer=r.clearDepth,c.camera._clearStencilBuffer=r.clearStencil,this.clearView(c.camera,r.renderTarget,!0,!0),c.camera._clearColorBuffer=t,c.camera._clearDepthBuffer=e,c.camera._clearStencilBuffer=i}a._sortVisible(l,c.camera.node,h);const t=a.instances,i=l?t.visibleTransparent[h]:t.visibleOpaque[h];this.scene._activeCamera=c.camera,this.setCamera(c.camera,r.renderTarget),Ja.clusteredLightingEnabled&&r.lightClusters&&r.lightClusters.activate(this.lightTextureAtlas);const n=!!(c.camera._flipFaces^(null==r||null==(s=r.renderTarget)?void 0:s.flipY)),o=this._forwardDrawCalls;this.renderForward(c.camera,i.list,i.length,a._splitLights,a.shaderPass,a.cullingMask,a.onDrawCall,a,n),a._forwardDrawCalls+=this._forwardDrawCalls-o,e.setColorWrite(!0,!0,!0,!0),e.setStencilTest(!1),e.setAlphaToCoverage(!1),e.setDepthBias(!1),c.frameEnd(),r.triggerPostprocess&&c.onPostprocessing&&c.onPostprocessing(c)}!l&&a.onPostRenderOpaque?a.onPostRenderOpaque(h):l&&a.onPostRenderTransparent&&a.onPostRenderTransparent(h),!a.onPostRender||a._postRenderCalledForCameras&1<<h||(a._postRenderCounter&=~(l?2:1),0===a._postRenderCounter&&(a.onPostRender(h),a._postRenderCalledForCameras|=1<<h,a._postRenderCounter=a._postRenderCounterMax))}}}}let p_,f_,m_,g_;const b_=[null,function(t,e){return t.drawOrder-e.drawOrder},function(t,e){return p_=t._key[Ci],f_=e._key[Ci],p_===f_&&t.mesh&&e.mesh?e.mesh.id-t.mesh.id:f_-p_},function(t,e){return e.zdist-t.zdist},function(t,e){return t.zdist-e.zdist}];function y_(t,e){return e.key-t.key}let v_=0;class S_{constructor(){this.list=[],this.length=0,this.done=!1}}class x_{constructor(){this.opaqueMeshInstances=[],this.transparentMeshInstances=[],this.shadowCasters=[],this.visibleOpaque=[],this.visibleTransparent=[]}prepare(t){this.visibleOpaque[t]||(this.visibleOpaque[t]=new S_),this.visibleTransparent[t]||(this.visibleTransparent[t]=new S_),this.visibleOpaque[t].done=!1,this.visibleTransparent[t].done=!1}delete(t){t<this.visibleOpaque.length&&this.visibleOpaque.splice(t,1),t<this.visibleTransparent.length&&this.visibleTransparent.splice(t,1)}}class w_{constructor(t={}){void 0!==t.id?(this.id=t.id,v_=Math.max(this.id+1,v_)):this.id=v_++,this.name=t.name,this._enabled=void 0===t.enabled||t.enabled,this._refCounter=this._enabled?1:0,this.opaqueSortMode=void 0===t.opaqueSortMode?ji:t.opaqueSortMode,this.transparentSortMode=void 0===t.transparentSortMode?Hi:t.transparentSortMode,this.renderTarget=t.renderTarget,this.shaderPass=void 0===t.shaderPass?Ri:t.shaderPass,this.passThrough=void 0!==t.passThrough&&t.passThrough,this._clearColorBuffer=!!t.clearColorBuffer&&t.clearColorBuffer,this._clearDepthBuffer=!!t.clearDepthBuffer&&t.clearDepthBuffer,this._clearStencilBuffer=!!t.clearStencilBuffer&&t.clearStencilBuffer,this.onPreCull=t.onPreCull,this.onPreRender=t.onPreRender,this.onPreRenderOpaque=t.onPreRenderOpaque,this.onPreRenderTransparent=t.onPreRenderTransparent,this.onPostCull=t.onPostCull,this.onPostRender=t.onPostRender,this.onPostRenderOpaque=t.onPostRenderOpaque,this.onPostRenderTransparent=t.onPostRenderTransparent,this.onDrawCall=t.onDrawCall,this.onEnable=t.onEnable,this.onDisable=t.onDisable,this._enabled&&this.onEnable&&this.onEnable(),this.layerReference=t.layerReference,this.instances=t.layerReference?t.layerReference.instances:new x_,this.cullingMask=t.cullingMask?t.cullingMask:4294967295,this.opaqueMeshInstances=this.instances.opaqueMeshInstances,this.transparentMeshInstances=this.instances.transparentMeshInstances,this.shadowCasters=this.instances.shadowCasters,this.customSortCallback=null,this.customCalculateSortValues=null,this._lights=[],this._lightsSet=new Set,this._clusteredLightsSet=new Set,this._splitLights=[[],[],[]],this.cameras=[],this._dirty=!1,this._dirtyLights=!1,this._dirtyCameras=!1,this._lightHash=0,this._staticLightHash=0,this._needsStaticPrepare=!0,this._staticPrepareDone=!1,this._shaderVersion=-1,this._lightCube=null}get renderTarget(){return this._renderTarget}set renderTarget(t){this._renderTarget=t,this._dirtyCameras=!0}get enabled(){return this._enabled}set enabled(t){t!==this._enabled&&(this._enabled=t,t?(this.incrementCounter(),this.onEnable&&this.onEnable()):(this.decrementCounter(),this.onDisable&&this.onDisable()))}get clearColor(){return this._clearColor}set clearColor(t){this._clearColor.copy(t)}get clearColorBuffer(){return this._clearColorBuffer}set clearColorBuffer(t){this._clearColorBuffer=t,this._dirtyCameras=!0}get clearDepthBuffer(){return this._clearDepthBuffer}set clearDepthBuffer(t){this._clearDepthBuffer=t,this._dirtyCameras=!0}get clearStencilBuffer(){return this._clearStencilBuffer}set clearStencilBuffer(t){this._clearStencilBuffer=t,this._dirtyCameras=!0}incrementCounter(){0===this._refCounter&&(this._enabled=!0,this.onEnable&&this.onEnable()),this._refCounter++}decrementCounter(){if(1===this._refCounter)this._enabled=!1,this.onDisable&&this.onDisable();else if(0===this._refCounter)return;this._refCounter--}addMeshInstances(t,e){const i=this._shaderVersion,n=this.shadowCasters;for(let s=0;s<t.length;s++){const r=t[s],o=r.material,a=o.blendType===Lt?this.opaqueMeshInstances:this.transparentMeshInstances;this.opaqueMeshInstances.indexOf(r)<0&&this.transparentMeshInstances.indexOf(r)<0&&a.push(r),!e&&r.castShadow&&n.indexOf(r)<0&&n.push(r),!this.passThrough&&i>=0&&o._shaderVersion!==i&&(o.updateShader!==pl.prototype.updateShader&&(o.clearVariants(),o.shader=null),o._shaderVersion=i)}this.passThrough||(this._dirty=!0)}removeMeshInstanceFromArray(t,e){let i=-1,n=0;const s=e.length;for(let r=0;r<s;r++){const s=e[r];if(s===t){i=r,n=1;break}if(s._staticSource===t)i<0&&(i=r),n++;else if(i>=0)break}i>=0&&e.splice(i,n)}removeMeshInstances(t,e){const i=this.opaqueMeshInstances,n=this.transparentMeshInstances,s=this.shadowCasters;for(let r=0;r<t.length;r++){const o=t[r];if(this.removeMeshInstanceFromArray(o,i),this.removeMeshInstanceFromArray(o,n),!e){const t=s.indexOf(o);t>=0&&s.splice(t,1)}}this._dirty=!0}clearMeshInstances(t){(0!==this.opaqueMeshInstances.length||0!==this.transparentMeshInstances.length||!t&&0!==this.shadowCasters.length)&&(this.opaqueMeshInstances.length=0,this.transparentMeshInstances.length=0,t||(this.shadowCasters.length=0),this.passThrough||(this._dirty=!0))}addLight(t){const e=t.light;this._lightsSet.has(e)||(this._lightsSet.add(e),e.type!==ee&&this._clusteredLightsSet.add(e),this._lights.push(e),this._dirtyLights=!0,this._generateLightHash())}removeLight(t){const e=t.light;this._lightsSet.has(e)&&(this._lightsSet.delete(e),e.type!==ee&&this._clusteredLightsSet.delete(e),this._lights.splice(this._lights.indexOf(e),1),this._dirtyLights=!0,this._generateLightHash())}clearLights(){this._lightsSet.clear(),this._clusteredLightsSet.clear(),this._lights.length=0,this._dirtyLights=!0}get clusteredLightsSet(){return this._clusteredLightsSet}addShadowCasters(t){const e=this.shadowCasters;for(let i=0;i<t.length;i++){const n=t[i];n.castShadow&&(e.indexOf(n)<0&&e.push(n))}this._dirtyLights=!0}removeShadowCasters(t){const e=this.shadowCasters;for(let i=0;i<t.length;i++){const n=e.indexOf(t[i]);n>=0&&e.splice(n,1)}this._dirtyLights=!0}_generateLightHash(){if(this._lights.length>0){this._lights.sort(y_);let t="",e="";for(let i=0;i<this._lights.length;i++)this._lights[i].isStatic?e+=this._lights[i].key:t+=this._lights[i].key;0===t.length?this._lightHash=0:this._lightHash=Bo(t),0===e.length?this._staticLightHash=0:this._staticLightHash=Bo(e)}else this._lightHash=0,this._staticLightHash=0}addCamera(t){this.cameras.indexOf(t)>=0||(this.cameras.push(t),this._dirtyCameras=!0)}removeCamera(t){const e=this.cameras.indexOf(t);e>=0&&(this.cameras.splice(e,1),this._dirtyCameras=!0,this.instances.delete(e))}clearCameras(){this.cameras.length=0,this._dirtyCameras=!0}_calculateSortDistances(t,e,i,n){for(let s=0;s<e;s++){const e=t[s];if(e.command)continue;if(e.layer<=qt)continue;if(e.calculateSortDistance){e.zdist=e.calculateSortDistance(e,i,n);continue}const r=e.aabb.center,o=r.x-i.x,a=r.y-i.y,l=r.z-i.z;e.zdist=o*n.x+a*n.y+l*n.z}}_sortVisible(t,e,i){const n=this.instances,s=t?this.transparentSortMode:this.opaqueSortMode;if(s===Wi)return;const r=t?n.visibleTransparent[i]:n.visibleOpaque[i];s===Yi?(m_=e.getPosition(),g_=e.forward,this.customCalculateSortValues&&this.customCalculateSortValues(r.list,r.length,m_,g_),r.list.length!==r.length&&(r.list.length=r.length),this.customSortCallback&&r.list.sort(this.customSortCallback)):(s!==Hi&&s!==Xi||(m_=e.getPosition(),g_=e.forward,this._calculateSortDistances(r.list,r.length,m_,g_)),r.list.length!==r.length&&(r.list.length=r.length),r.list.sort(b_[s]))}}const C_=new ht,T_=new ht,A_=new ht,E_={bias:0,normalBias:0},M_={r:0,g:1,b:2,a:3},R_=[[new ut(0,0,1,1)],[new ut(0,0,.5,.5),new ut(0,.5,.5,.5)],[new ut(0,0,.5,.5),new ut(0,.5,.5,.5),new ut(.5,0,.5,.5)],[new ut(0,0,.5,.5),new ut(0,.5,.5,.5),new ut(.5,0,.5,.5),new ut(.5,.5,.5,.5)]];class I_{constructor(t,e,i,n){this.light=n,this.camera=e,this.shadowCamera=Rc.createShadowCamera(t,n._shadowType,n._type,i),this.shadowMatrix=new bt,this.shadowViewport=new ut(0,0,1,1),this.shadowScissor=new ut(0,0,1,1),this.face=i,this.visibleCasters=[]}get shadowBuffer(){const t=this.shadowCamera.renderTarget;if(t){const e=this.light;return e._type===ie?t.colorBuffer:e._isPcf&&e.device.webgl2?t.depthBuffer:t.colorBuffer}return null}}class P_{constructor(t){this.device=t,this._type=ee,this._color=new rt(.8,.8,.8),this._intensity=1,this._castShadows=!1,this._enabled=!1,this.mask=Ai,this.isStatic=!1,this.key=0,this.bakeDir=!0,this.bakeNumSamples=1,this.bakeArea=0,this.attenuationStart=10,this.attenuationEnd=10,this._falloffMode=0,this._shadowType=_e,this._vsmBlurSize=11,this.vsmBlurMode=ye,this.vsmBias=.0025,this._cookie=null,this.cookieIntensity=1,this._cookieFalloff=!0,this._cookieChannel="rgb",this._cookieTransform=null,this._cookieTransformUniform=new Float32Array(4),this._cookieOffset=null,this._cookieOffsetUniform=new Float32Array(2),this._cookieTransformSet=!1,this._cookieOffsetSet=!1,this._innerConeAngle=40,this._outerConeAngle=45,this.cascades=null,this._shadowMatrixPalette=null,this._shadowCascadeDistances=null,this.numCascades=1,this.cascadeDistribution=.5,this._shape=re,this._finalColor=new Float32Array([.8,.8,.8]);const e=Math.pow(this._finalColor[0],2.2);this._linearFinalColor=new Float32Array([e,e,e]),this._position=new ht(0,0,0),this._direction=new ht(0,0,0),this._innerConeAngleCos=Math.cos(this._innerConeAngle*Math.PI/180),this._outerConeAngleCos=Math.cos(this._outerConeAngle*Math.PI/180),this._shadowMap=null,this._shadowRenderParams=[],this.shadowDistance=40,this._shadowResolution=1024,this.shadowBias=-5e-4,this._normalOffsetBias=0,this.shadowUpdateMode=wi,this._isVsm=!1,this._isPcf=!0,this._cookieMatrix=null,this._atlasViewport=null,this._scene=null,this._node=null,this._renderData=[],this.visibleThisFrame=!1}destroy(){this._destroyShadowMap(),this._renderData=null}_destroyShadowMap(){this._renderData&&(this._renderData.length=0),this._shadowMap&&(this._shadowMap.cached||this._shadowMap.destroy(),this._shadowMap=null),this.shadowUpdateMode===Si&&(this.shadowUpdateMode=xi)}getRenderData(t,e){for(let i=0;i<this._renderData.length;i++){const n=this._renderData[i];if(n.camera===t&&n.face===e)return n}const i=new I_(this.device,t,e,this);return this._renderData.push(i),i}clone(){const t=new P_(this.device);return t.type=this._type,t.setColor(this._color),t.intensity=this._intensity,t.castShadows=this.castShadows,t._enabled=this._enabled,t.attenuationStart=this.attenuationStart,t.attenuationEnd=this.attenuationEnd,t.falloffMode=this._falloffMode,t.shadowType=this._shadowType,t.vsmBlurSize=this._vsmBlurSize,t.vsmBlurMode=this.vsmBlurMode,t.vsmBias=this.vsmBias,t.shadowUpdateMode=this.shadowUpdateMode,t.mask=this.mask,t.innerConeAngle=this._innerConeAngle,t.outerConeAngle=this._outerConeAngle,t.numCascades=this.numCascades,t.cascadeDistribution=this.cascadeDistribution,t.shape=this._shape,t.shadowBias=this.shadowBias,t.normalOffsetBias=this._normalOffsetBias,t.shadowResolution=this._shadowResolution,t.shadowDistance=this.shadowDistance,t}_getUniformBiasValues(t){const e=t.shadowCamera._farClip;switch(this._type){case ie:E_.bias=this.shadowBias,E_.normalBias=this._normalOffsetBias;break;case se:this._isVsm?E_.bias=-2e-4:(E_.bias=20*this.shadowBias,!this.device.webgl2&&this.device.extStandardDerivatives&&(E_.bias*=-100)),E_.normalBias=this._isVsm?this.vsmBias/(this.attenuationEnd/7):this._normalOffsetBias;break;case ee:this._isVsm?E_.bias=-2e-4:(E_.bias=this.shadowBias/e*100,!this.device.webgl2&&this.device.extStandardDerivatives&&(E_.bias*=-100)),E_.normalBias=this._isVsm?this.vsmBias/(e/7):this._normalOffsetBias}return E_}get numCascades(){return this.cascades.length}set numCascades(t){this.cascades&&this.numCascades==t||(this.cascades=R_[t-1],this._shadowMatrixPalette=new Float32Array(64),this._shadowCascadeDistances=new Float32Array(4),this._destroyShadowMap(),this.updateKey())}get shadowMap(){return this._shadowMap}set shadowMap(t){this._shadowMap!==t&&(this._destroyShadowMap(),this._shadowMap=t)}get numShadowFaces(){const t=this._type;return t===ee?this.numCascades:t===ie?6:1}getColor(){return this._color}getBoundingSphere(t){if(this._type===se){const e=this.attenuationEnd,i=this._outerConeAngle,n=Math.cos(i*Z.DEG_TO_RAD),s=this._node;C_.copy(s.up),C_.mulScalar(.5*-e*n),C_.add(s.getPosition()),t.center=C_,T_.copy(s.up),T_.mulScalar(-e),A_.copy(s.right),A_.mulScalar(Math.sin(i*Z.DEG_TO_RAD)*e),T_.add(A_),t.radius=.5*T_.length()}else this._type===ie&&(t.center=this._node.getPosition(),t.radius=this.attenuationEnd)}getBoundingBox(t){if(this._type===se){const e=this.attenuationEnd,i=this._outerConeAngle,n=this._node,s=Math.abs(Math.sin(i*Z.DEG_TO_RAD)*e);t.center.set(0,.5*-e,0),t.halfExtents.set(s,.5*e,s),t.setFromTransformedAabb(t,n.getWorldTransform())}else this._type===ie&&(t.center.copy(this._node.getPosition()),t.halfExtents.set(this.attenuationEnd,this.attenuationEnd,this.attenuationEnd))}_updateFinalColor(){const t=this._color,e=t.r,i=t.g,n=t.b,s=this._intensity,r=this._finalColor,o=this._linearFinalColor;r[0]=e*s,r[1]=i*s,r[2]=n*s,s>=1?(o[0]=Math.pow(e,2.2)*s,o[1]=Math.pow(i,2.2)*s,o[2]=Math.pow(n,2.2)*s):(o[0]=Math.pow(r[0],2.2),o[1]=Math.pow(r[1],2.2),o[2]=Math.pow(r[2],2.2))}setColor(){1===arguments.length?this._color.set(arguments[0].r,arguments[0].g,arguments[0].b):3===arguments.length&&this._color.set(arguments[0],arguments[1],arguments[2]),this._updateFinalColor()}updateShadow(){this.shadowUpdateMode!==wi&&(this.shadowUpdateMode=xi)}layersDirty(){var t;null!=(t=this._scene)&&t.layers&&(this._scene.layers._dirtyLights=!0)}updateKey(){let t=this._type<<29|(this._castShadows?1:0)<<28|this._shadowType<<25|this._falloffMode<<23|(0!==this._normalOffsetBias?1:0)<<22|(this._cookie?1:0)<<21|(this._cookieFalloff?1:0)<<20|M_[this._cookieChannel.charAt(0)]<<18|(this._cookieTransform?1:0)<<12|this._shape<<10|this.numCascades-1<<8;3===this._cookieChannel.length&&(t|=M_[this._cookieChannel.charAt(1)]<<16,t|=M_[this._cookieChannel.charAt(2)]<<14),t!==this.key&&null!==this._scene&&this.layersDirty(),this.key=t}get type(){return this._type}set type(t){if(this._type===t)return;this._type=t,this._destroyShadowMap(),this.updateKey();const e=this._shadowType;this._shadowType=null,this.shadowType=e}get shape(){return this._shape}set shape(t){if(this._shape===t)return;this._shape=t,this._destroyShadowMap(),this.updateKey();const e=this._shadowType;this._shadowType=null,this.shadowType=e}get shadowType(){return this._shadowType}set shadowType(t){if(this._shadowType===t)return;const e=this.device;this._type===ie&&(t=_e),t!==me||e.webgl2||(t=_e),t!==fe||e.textureFloatRenderable||(t=pe),t!==pe||e.textureHalfFloatRenderable||(t=de),this._isVsm=t>=de&&t<=fe,this._isPcf=t===me||t===_e,this._shadowType=t,this._destroyShadowMap(),this.updateKey()}get enabled(){return this._enabled}set enabled(t){this._enabled!==t&&(this._enabled=t,this.layersDirty())}get castShadows(){return this._castShadows&&this.mask!==Mi&&0!==this.mask}set castShadows(t){this._castShadows!==t&&(this._castShadows=t,this._destroyShadowMap(),this.layersDirty(),this.updateKey())}get shadowResolution(){return this._shadowResolution}set shadowResolution(t){this._shadowResolution!==t&&(t=this._type===ie?Math.min(t,this.device.maxCubeMapSize):Math.min(t,this.device.maxTextureSize),this._shadowResolution=t,this._destroyShadowMap())}get vsmBlurSize(){return this._vsmBlurSize}set vsmBlurSize(t){this._vsmBlurSize!==t&&(t%2==0&&t++,this._vsmBlurSize=t)}get normalOffsetBias(){return this._normalOffsetBias}set normalOffsetBias(t){this._normalOffsetBias!==t&&((!this._normalOffsetBias&&t||this._normalOffsetBias&&!t)&&this.updateKey(),this._normalOffsetBias=t)}get falloffMode(){return this._falloffMode}set falloffMode(t){this._falloffMode!==t&&(this._falloffMode=t,this.updateKey())}get innerConeAngle(){return this._innerConeAngle}set innerConeAngle(t){this._innerConeAngle!==t&&(this._innerConeAngle=t,this._innerConeAngleCos=Math.cos(t*Math.PI/180))}get outerConeAngle(){return this._outerConeAngle}set outerConeAngle(t){this._outerConeAngle!==t&&(this._outerConeAngle=t,this._outerConeAngleCos=Math.cos(t*Math.PI/180))}get intensity(){return this._intensity}set intensity(t){this._intensity!==t&&(this._intensity=t,this._updateFinalColor())}get cookieMatrix(){return this._cookieMatrix||(this._cookieMatrix=new bt),this._cookieMatrix}get atlasViewport(){return this._atlasViewport||(this._atlasViewport=new ut(0,0,1,1)),this._atlasViewport}get cookie(){return this._cookie}set cookie(t){this._cookie!==t&&(this._cookie=t,this.updateKey())}get cookieFalloff(){return this._cookieFalloff}set cookieFalloff(t){this._cookieFalloff!==t&&(this._cookieFalloff=t,this.updateKey())}get cookieChannel(){return this._cookieChannel}set cookieChannel(t){if(this._cookieChannel!==t){if(t.length<3){const e=t.charAt(t.length-1),i=3-t.length;for(let n=0;n<i;n++)t+=e}this._cookieChannel=t,this.updateKey()}}get cookieTransform(){return this._cookieTransform}set cookieTransform(t){this._cookieTransform!==t&&(this._cookieTransform=t,this._cookieTransformSet=!!t,t&&!this._cookieOffset&&(this.cookieOffset=new _t,this._cookieOffsetSet=!1),this.updateKey())}get cookieOffset(){return this._cookieOffset}set cookieOffset(t){if(this._cookieOffset===t)return;!(!this._cookieTransformSet&&!t)&&!t&&this._cookieOffset?this._cookieOffset.set(0,0):this._cookieOffset=t,this._cookieOffsetSet=!!t,t&&!this._cookieTransform&&(this.cookieTransform=new ut(1,1,0,0),this._cookieTransformSet=!1),this.updateKey()}}const L_=function(t,e,i){const n=2.399963229728653*e,s=Math.sqrt(e)/Math.sqrt(i);t.x=s*Math.cos(n),t.y=s*Math.sin(n)},D_=function(t,e,i,n=0,s=1){n=1-2*n,s=1-2*s;const r=Z.lerp(n,s,e/i),o=Math.sqrt(1-r*r),a=2.399963229728653*e;t.x=Math.cos(a)*o,t.y=r,t.z=Math.sin(a)*o},k_=new Mt;class O_{constructor(t,e){this.scene=t,this.light=e,this.store(),e.numCascades=1,e.type!==ee&&(e._node.getWorldTransform(),e.getBoundingSphere(k_),this.lightBounds=new Tt,this.lightBounds.center.copy(k_.center),this.lightBounds.halfExtents.set(k_.radius,k_.radius,k_.radius))}store(){this.mask=this.light.mask,this.shadowUpdateMode=this.light.shadowUpdateMode,this.enabled=this.light.enabled,this.intensity=this.light.intensity,this.rotation=this.light._node.getLocalRotation().clone(),this.numCascades=this.light.numCascades}restore(){const t=this.light;t.mask=this.mask,t.shadowUpdateMode=this.shadowUpdateMode,t.enabled=this.enabled,t.intensity=this.intensity,t._node.setLocalRotation(this.rotation),t.numCascades=this.numCascades}startBake(){this.light.enabled=!0,this.light._cacheShadowMap=!0}endBake(){const t=this.light;t.enabled=!1,t._cacheShadowMap=!1,t._isCachedShadowMap&&t._destroyShadowMap()}}const F_=new _t;class B_ extends O_{get numVirtualLights(){return this.light.type===ee?this.light.bakeNumSamples:1}prepareVirtualLight(t,e){const i=this.light;if(i._node.setLocalRotation(this.rotation),t>0){const n=i.bakeArea;L_(F_,t,e),F_.mulScalar(.5*n),i._node.rotateLocal(F_.x,0,F_.y)}i._node.getWorldTransform();const n=this.scene.gammaCorrection?2.2:1,s=Math.pow(this.intensity,n);i.intensity=Math.pow(s/e,1/n)}}const N_=new La;class U_{constructor(t,e,i){this.material=e,this.layer=i,this.positions=[],this.colors=[],this.mesh=new xh(t),this.meshInstance=null}addLines(t,e){const i=this.positions,n=t.length;for(let e=0;e<n;e++){const n=t[e];i.push(n.x,n.y,n.z)}const s=this.colors;if(e.length)for(let t=0;t<n;t++){const i=e[t];s.push(i.r,i.g,i.b,i.a)}else for(let t=0;t<n;t++)s.push(e.r,e.g,e.b,e.a)}addLinesArrays(t,e){this.positions.push(...t);const i=this.colors;if(e.length)i.push(...e);else{const n=t.length/3;for(let t=0;t<n;t++)i.push(e.r,e.g,e.b,e.a)}}onPreRender(){this.positions.length>0&&(this.mesh.setPositions(this.positions),this.mesh.setColors(this.colors),this.mesh.update(js,!1),this.meshInstance||(N_.worldTransform=bt.IDENTITY,N_._dirtyWorld=N_._dirtyNormal=!1,this.meshInstance=new Kh(this.mesh,this.material,N_),this.meshInstance.cull=!1,this.layer.addMeshInstances([this.meshInstance],!0)),this.meshInstance.visible=!0)}onPostRender(){this.positions.length=0,this.colors.length=0,this.meshInstance.visible=!1}}class V_{constructor(t){this.device=t,this.map=new Map}getBatch(t,e){let i=this.map.get(t);return i||(i=new U_(this.device,t,e),this.map.set(t,i)),i}onPreRender(){this.map.forEach(t=>{t.onPreRender()})}onPostRender(){this.map.forEach(t=>{t.onPostRender()})}}const z_=[];class W_{constructor(t,e){this.device=t,this.quadMesh=null,this.textureShader=null,this.depthTextureShader=null,this.cubeLocalPos=null,this.cubeWorldPos=null,this.usedGraphNodes=[],this.freeGraphNodes=[],this.batchesMap=new Map,this.allBatches=new Set,this._materialDepth=null,this._materialNoDepth=null,this.layerMeshInstances=new Map,e.on("prerender",this.onPreRender,this),e.on("postrender",this.onPostRender,this)}createMaterial(t){const e=new Fh;return e.vertexColors=!0,e.blend=!0,e.blendType=Pt,e.depthTest=t,e.update(),e}get materialDepth(){return this._materialDepth||(this._materialDepth=this.createMaterial(!0)),this._materialDepth}get materialNoDepth(){return this._materialNoDepth||(this._materialNoDepth=this.createMaterial(!1)),this._materialNoDepth}getBatch(t,e){let i=this.batchesMap.get(t);i||(i=new V_(this.device),this.batchesMap.set(t,i)),this.allBatches.add(i);const n=e?this.materialDepth:this.materialNoDepth;return i.getBatch(n,t)}static getTextureVS(){return"\n\t\t\t\t\t\tattribute vec2 aPosition;\n\t\t\t\t\t\tuniform mat4 matrix_model;\n\t\t\t\t\t\tvarying vec2 uv0;\n\t\t\t\t\t\tvoid main(void) {\n\t\t\t\t\t\t\t\tgl_Position = matrix_model * vec4(aPosition, 0, 1);\n\t\t\t\t\t\t\t\tuv0 = aPosition.xy + 0.5;\n\t\t\t\t\t\t}\n\t\t\t\t"}getTextureShader(){if(!this.textureShader){const t={attributes:{aPosition:Zs},vshader:W_.getTextureVS(),fshader:"\n\t\t\t\t\t\t\t\t\t\tprecision lowp float;\n\t\t\t\t\t\t\t\t\t\tvarying vec2 uv0;\n\t\t\t\t\t\t\t\t\t\tuniform sampler2D colorMap;\n\t\t\t\t\t\t\t\t\t\tvoid main (void) {\n\t\t\t\t\t\t\t\t\t\t\t\tgl_FragColor = vec4(texture2D(colorMap, uv0).xyz, 1);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t"};this.textureShader=new Go(this.device,t)}return this.textureShader}getDepthTextureShader(){if(!this.depthTextureShader){const t=this.device.webgl2?"#define GL2":"",e={attributes:{aPosition:Zs},vshader:W_.getTextureVS(),fshader:`\n\t\t\t\t\t\t\t\t\t\tprecision ${this.device.precision} float;\n\t\t\t\t\t\t\t\t\t\t${t}\n\t\t\t\t\t\t\t\t\t\t${jo.screenDepthPS}\n\t\t\t\t\t\t\t\t\t\tvarying vec2 uv0;\n\t\t\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\t\t\t\t\t\t\t\tfloat depth = getLinearScreenDepth(uv0) * camera_params.x;\n\t\t\t\t\t\t\t\t\t\t\t\tgl_FragColor = vec4(vec3(depth), 1.0);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t`};this.depthTextureShader=new Go(this.device,e)}return this.depthTextureShader}getQuadMesh(){return this.quadMesh||(this.quadMesh=new xh(this.device),this.quadMesh.setPositions([-.5,-.5,0,.5,-.5,0,-.5,.5,0,.5,.5,0]),this.quadMesh.update(qs)),this.quadMesh}drawMesh(t,e,i,n,s){if(!n){const s=this.getGraphNode(e);(n=new Kh(i,t,s)).cull=!1}let r=this.layerMeshInstances.get(s);r||(r=[],this.layerMeshInstances.set(s,r)),r.push(n)}drawWireAlignedBox(t,e,i,n,s){z_.push(t.x,t.y,t.z,t.x,e.y,t.z,t.x,e.y,t.z,e.x,e.y,t.z,e.x,e.y,t.z,e.x,t.y,t.z,e.x,t.y,t.z,t.x,t.y,t.z,t.x,t.y,e.z,t.x,e.y,e.z,t.x,e.y,e.z,e.x,e.y,e.z,e.x,e.y,e.z,e.x,t.y,e.z,e.x,t.y,e.z,t.x,t.y,e.z,t.x,t.y,t.z,t.x,t.y,e.z,t.x,e.y,t.z,t.x,e.y,e.z,e.x,e.y,t.z,e.x,e.y,e.z,e.x,t.y,t.z,e.x,t.y,e.z);this.getBatch(s,n).addLinesArrays(z_,i),z_.length=0}drawWireSphere(t,e,i,n,s,r){const o=2*Math.PI/n;let a=0;for(let i=0;i<n;i++){const i=Math.sin(a),n=Math.cos(a);a+=o;const s=Math.sin(a),r=Math.cos(a);z_.push(t.x+e*i,t.y,t.z+e*n),z_.push(t.x+e*s,t.y,t.z+e*r),z_.push(t.x+e*i,t.y+e*n,t.z),z_.push(t.x+e*s,t.y+e*r,t.z),z_.push(t.x,t.y+e*i,t.z+e*n),z_.push(t.x,t.y+e*s,t.z+e*r)}this.getBatch(r,s).addLinesArrays(z_,i),z_.length=0}getGraphNode(t){let e=null;return e=this.freeGraphNodes.length>0?this.freeGraphNodes.pop():new La,this.usedGraphNodes.push(e),e.worldTransform=t,e._dirtyWorld=e._dirtyNormal=!1,e}onPreRender(){this.allBatches.forEach(t=>{t.onPreRender()}),this.layerMeshInstances.forEach((t,e)=>{e.addMeshInstances(t,!0)})}onPostRender(){this.allBatches.forEach(t=>{t.onPostRender()}),this.allBatches.clear(),this.layerMeshInstances.forEach((t,e)=>{e.removeMeshInstances(t,!0),t.length=0});const t=this.freeGraphNodes;this.freeGraphNodes=this.usedGraphNodes,this.usedGraphNodes=t}}class G_{static createTexture(t,e,i){const n=new _a(t,{width:i,height:i,format:e,addressU:pn,addressV:pn,type:Ur,magFilter:Zn,minFilter:Kn,anisotropy:1});return n.name="AreaLightLUT",n}static setUniforms(t,e,i){t.scope.resolve("areaLightsLutTex1").setValue(e),t.scope.resolve("areaLightsLutTex2").setValue(i)}static createPlaceholder(t){const e=G_.createTexture(t,ys,2);e.lock().fill(0),e.unlock(),G_.setUniforms(t,e,e)}static set(t,e){function i(t,e,i){const n=G_.createTexture(t,i,64);return n.lock().set(e),n.unlock(),n.upload(),n}function n(t,e,i){const n=t.length,s=new Float32Array(n);for(let r=0;r<n;r++){const n=r%4;s[r]=(t[r]+e[n])*i[n]}return s}function s(t){const e=t.length,i=new Uint16Array(e),n=la.float2Half;for(let s=0;s<e;s++)i[s]=n(t[s]);return i}function r(t){const e=t.length,i=new Uint8ClampedArray(e);for(let n=0;n<e;n++)i[n]=255*t[n];return i}const o=new Int16Array(e,0,2),a=o[0],l=o[1];if(0!==a||1!==l)console.warn(`areaLightLuts asset version: ${a}.${l} is not supported in current engine version!`);else{const o=new Float32Array(e,4,16384),a=new Float32Array(e,65540,16384);let l,h;const c=t.areaLightLutFormat;if(c===As)l=o,h=a;else if(c===Cs)l=s(o),h=s(a);else{const t=[-.306897,0,0,0],e=[1.442787,1,1,1];l=r(n(o,[0,.2976,.01381,0],[.999,3.08737,1.6546,.603249])),h=r(n(a,t,e))}const _=i(t,l,c),u=i(t,h,c);G_.setUniforms(t,_,u)}}}var j_,H_=1,X_=new bt,Y_=new bt,q_=new ht,K_=new ht,Z_=new ht,Q_=new ht,$_=new ht,J_=new ht,tu=new ht,eu=new ht,iu=new ht,nu=new ht,su=new ht,ru=new ht,ou=new ht;function au(t){return t-Math.floor(t)}function lu(t){return Math.max(Math.min(t,1),0)}function hu(t,e){return t-e*Math.floor(t/e)}function cu(t){var e=au(t),i=au(255*t);return[e-=i/255,i-=i/255]}class _u{constructor(t){this._emitter=t}calcSpawnPosition(t,e,i,n,s){var r,o,a,l,h,c,_=this._emitter,u=Math.random(),d=Math.random(),p=Math.random(),f=Math.random();if(_.useCpu&&(t[4*s+0+2*_.numParticlesPot*4]=u,t[4*s+1+2*_.numParticlesPot*4]=d,t[4*s+2+2*_.numParticlesPot*4]=p),K_.x=u-.5,K_.y=d-.5,K_.z=p-.5,_.emitterShape===Ae){var m=Math.max(Math.abs(K_.x),Math.max(Math.abs(K_.y),Math.abs(K_.z))),g=m+(.5-m)*i[0],b=m+(.5-m)*i[1],y=m+(.5-m)*i[2];K_.x=g*(m===Math.abs(K_.x)?Math.sign(K_.x):2*K_.x),K_.y=b*(m===Math.abs(K_.y)?Math.sign(K_.y):2*K_.y),K_.z=y*(m===Math.abs(K_.z)?Math.sign(K_.z):2*K_.z),_.localSpace?q_.copy(e.transformPoint(K_)):q_.copy(n).add(e.transformPoint(K_))}else{K_.normalize();var v=0===_.emitterRadius?0:_.emitterRadiusInner/_.emitterRadius,S=f*(1-v)+v;_.localSpace?q_.copy(K_.mulScalar(S*_.emitterRadius)):q_.copy(n).add(K_.mulScalar(S*_.emitterRadius))}if(r=-Z.lerp(_.rate,_.rate2,u)*s,_.pack8){var x=(q_.x-_.worldBounds.center.x)/_.worldBoundsSize.x+.5,w=(q_.y-_.worldBounds.center.y)/_.worldBoundsSize.y+.5,C=(q_.z-_.worldBounds.center.z)/_.worldBoundsSize.z+.5,T=Z.lerp(_.startAngle*Z.DEG_TO_RAD,_.startAngle2*Z.DEG_TO_RAD,u);T=T%(2*Math.PI)/(2*Math.PI);var A=cu(x);t[4*s]=A[0],t[4*s+1]=A[1];var E=cu(w);t[4*s+2]=E[0],t[4*s+3]=E[1];var M=cu(C);t[4*s+0+4*_.numParticlesPot]=M[0],t[4*s+1+4*_.numParticlesPot]=M[1];var R=cu(T);t[4*s+2+4*_.numParticlesPot]=R[0],t[4*s+3+4*_.numParticlesPot]=R[1];t[4*s+3+4*_.numParticlesPot*2]=1;var I=Math.max(_.lifetime,(_.numParticles-1)*Math.max(_.rate,_.rate2)),P=_.lifetime+1,L=(a=au(o=r=(r+I)/(I+P)),l=au(255*o),h=au(65025*o),c=au(160581375*o),[a-=l/255,l-=h/255,h-=c/255,c-=c/255]);t[4*s+0+4*_.numParticlesPot*3]=L[0],t[4*s+1+4*_.numParticlesPot*3]=L[1],t[4*s+2+4*_.numParticlesPot*3]=L[2],t[4*s+3+4*_.numParticlesPot*3]=L[3]}else t[4*s]=q_.x,t[4*s+1]=q_.y,t[4*s+2]=q_.z,t[4*s+3]=Z.lerp(_.startAngle*Z.DEG_TO_RAD,_.startAngle2*Z.DEG_TO_RAD,u),t[4*s+3+4*_.numParticlesPot]=r}update(t,e,i,n,s,r,o,a){var l,h,c,_,u,d=this._emitter;if(d.meshInstance.node){var p=d.meshInstance.node.worldTransform;for(u=0;u<12;u++)X_.data[u]=p.data[u];Y_.copy(X_),Y_.invert(),j_=d.meshInstance.node.localScale,H_=Math.max(Math.max(j_.x,j_.y),j_.z)}r=null===d.meshInstance.node||d.localSpace?ht.ZERO:d.meshInstance.node.getPosition();var f,m,g,b,y,v,S,x,w=d.camera?d.camera._node.getPosition():ht.ZERO,C=d.useMesh?17:15,T=d.precision-1;for(_=0;_<d.numParticles;_++){var A=Math.floor(d.vbCPU[_*d.numParticleVerts*(d.useMesh?6:4)+3]),E=i[4*A+0+2*d.numParticlesPot*4];Z_.x=E,Z_.y=i[4*A+1+2*d.numParticlesPot*4],Z_.z=i[4*A+2+2*d.numParticlesPot*4];var M=d.rate+(d.rate2-d.rate)*E,R=d.lifetime,I=i[4*A+3+4*d.numParticlesPot]+o,P=lu(I/R),L=0,D=0;(I-o<=0||I>=R)&&this.calcSpawnPosition(i,n,s,r,A);var k=I>0&&I<R;k&&(c=P*T,f=Math.floor(c),m=Math.ceil(c),c%=1,g=(l=d.qRotSpeed[f])+((h=d.qRotSpeed[m])-l)*c,b=(l=d.qRotSpeed2[f])+((h=d.qRotSpeed2[m])-l)*c,L=(l=d.qScale[f])+((h=d.qScale[m])-l)*c,y=(l=d.qScale2[f])+((h=d.qScale2[m])-l)*c,v=(l=d.qAlpha[f])+((h=d.qAlpha[m])-l)*c,S=(l=d.qAlpha2[f])+((h=d.qAlpha2[m])-l)*c,x=(l=d.qRadialSpeed[f])+((h=d.qRadialSpeed[m])-l)*c,x+=100*E%1*((l=d.qRadialSpeed2[f])+((h=d.qRadialSpeed2[m])-l)*c-x),Q_.x=i[4*A],Q_.y=i[4*A+1],Q_.z=i[4*A+2],d.localSpace?iu.copy(Q_):iu.copy(Q_).sub(r),iu.normalize().mulScalar(x),f*=3,m*=3,l=d.qLocalVelocity[f],h=d.qLocalVelocity[m],J_.x=l+(h-l)*c,l=d.qLocalVelocity[f+1],h=d.qLocalVelocity[m+1],J_.y=l+(h-l)*c,l=d.qLocalVelocity[f+2],h=d.qLocalVelocity[m+2],J_.z=l+(h-l)*c,l=d.qLocalVelocity2[f],h=d.qLocalVelocity2[m],eu.x=l+(h-l)*c,l=d.qLocalVelocity2[f+1],h=d.qLocalVelocity2[m+1],eu.y=l+(h-l)*c,l=d.qLocalVelocity2[f+2],h=d.qLocalVelocity2[m+2],eu.z=l+(h-l)*c,l=d.qVelocity[f],h=d.qVelocity[m],$_.x=l+(h-l)*c,l=d.qVelocity[f+1],h=d.qVelocity[m+1],$_.y=l+(h-l)*c,l=d.qVelocity[f+2],h=d.qVelocity[m+2],$_.z=l+(h-l)*c,l=d.qVelocity2[f],h=d.qVelocity2[m],tu.x=l+(h-l)*c,l=d.qVelocity2[f+1],h=d.qVelocity2[m+1],tu.y=l+(h-l)*c,l=d.qVelocity2[f+2],h=d.qVelocity2[m+2],tu.z=l+(h-l)*c,J_.x+=(eu.x-J_.x)*Z_.x,J_.y+=(eu.y-J_.y)*Z_.y,J_.z+=(eu.z-J_.z)*Z_.z,d.initialVelocity>0&&(d.emitterShape===Ee?(K_.copy(Z_).mulScalar(2).sub(ht.ONE).normalize(),J_.add(K_.mulScalar(d.initialVelocity))):J_.add(ht.FORWARD.mulScalar(d.initialVelocity))),$_.x+=(tu.x-$_.x)*Z_.x,$_.y+=(tu.y-$_.y)*Z_.y,$_.z+=(tu.z-$_.z)*Z_.z,g+=(b-g)*Z_.y,L=(L+1e4*E%1*(y-L))*H_,D=1e3*E%1*(S-v),d.meshInstance.node&&(d.localSpace?(J_.x/=j_.x,J_.y/=j_.y,J_.z/=j_.z):X_.transformPoint(J_,J_)),d.localSpace?(Y_.transformPoint($_,$_),J_.add($_).add(iu)):(J_.add($_.mul(j_)),J_.add(iu.mul(j_))),ru.copy(J_),nu.copy(Q_).add(J_.mulScalar(o)),su.copy(nu),i[4*A]=su.x,i[4*A+1]=su.y,i[4*A+2]=su.z,i[4*A+3]+=g*o,d.wrap&&d.wrapBounds&&(d.localSpace||su.sub(r),su.x=hu(su.x,d.wrapBounds.x)-.5*d.wrapBounds.x,su.y=hu(su.y,d.wrapBounds.y)-.5*d.wrapBounds.y,su.z=hu(su.z,d.wrapBounds.z)-.5*d.wrapBounds.z,d.localSpace||su.add(r)),d.sort>0&&(1===d.sort?(ou.copy(su).sub(w),d.particleDistance[A]=-(ou.x*ou.x+ou.y*ou.y+ou.z*ou.z)):2===d.sort?d.particleDistance[A]=I:3===d.sort&&(d.particleDistance[A]=-I))),a?I<0&&(i[4*A+3+2*d.numParticlesPot*4]=-1):(I>=R&&(I-=Math.max(R,(d.numParticles-1)*M),i[4*A+3+2*d.numParticlesPot*4]=d.loop?1:-1),I<0&&d.loop&&(i[4*A+3+2*d.numParticlesPot*4]=1)),i[4*A+3+2*d.numParticlesPot*4]<0&&(k=!1),i[4*A+3+4*d.numParticlesPot]=I;for(var O=0;O<d.numParticleVerts;O++){var F=(_*d.numParticleVerts+O)*(d.useMesh?6:4),B=d.vbCPU[F],N=d.vbCPU[F+1],U=d.vbCPU[F+2];k||(B=N=U=0);var V=_*d.numParticleVerts*C+O*C;t[V]=su.x,t[V+1]=su.y,t[V+2]=su.z,t[V+3]=P,t[V+4]=d.alignToMotion?0:i[4*A+3],t[V+5]=L,t[V+6]=D,t[V+7]=ru.x,t[V+8]=B,t[V+9]=N,t[V+10]=U,t[V+11]=ru.y,t[V+12]=A,t[V+13]=ru.z,t[V+14]=d.vbCPU[F+3],d.useMesh&&(t[V+15]=d.vbCPU[F+4],t[V+16]=d.vbCPU[F+5])}}if(d.sort>ve&&d.camera){var z=d.useMesh?6:4,W=d.particleDistance;for(_=0;_<d.numParticles;_++)e[_][0]=_,e[_][1]=W[Math.floor(d.vbCPU[_*d.numParticleVerts*z+3])];for(d.vbOld.set(d.vbCPU),e.sort((function(t,e){return t[1]-e[1]})),_=0;_<d.numParticles;_++){var G=e[_][0]*d.numParticleVerts*z,j=_*d.numParticleVerts*z;for(u=0;u<d.numParticleVerts*z;u++)d.vbCPU[j+u]=d.vbOld[G+u]}}}}var uu=new ct,du=new ct,pu=new ct;class fu{constructor(t,e){this._emitter=t,this.frameRandomUniform=new Float32Array(3),this.emitterPosUniform=new Float32Array(3),this.emitterScaleUniform=new Float32Array([1,1,1]),this.worldBoundsMulUniform=new Float32Array(3),this.worldBoundsAddUniform=new Float32Array(3),this.inBoundsSizeUniform=new Float32Array(3),this.inBoundsCenterUniform=new Float32Array(3),this.constantParticleTexIN=e.scope.resolve("particleTexIN"),this.constantParticleTexOUT=e.scope.resolve("particleTexOUT"),this.constantEmitterPos=e.scope.resolve("emitterPos"),this.constantEmitterScale=e.scope.resolve("emitterScale"),this.constantSpawnBounds=e.scope.resolve("spawnBounds"),this.constantSpawnPosInnerRatio=e.scope.resolve("spawnPosInnerRatio"),this.constantSpawnBoundsSphere=e.scope.resolve("spawnBoundsSphere"),this.constantSpawnBoundsSphereInnerRatio=e.scope.resolve("spawnBoundsSphereInnerRatio"),this.constantInitialVelocity=e.scope.resolve("initialVelocity"),this.constantFrameRandom=e.scope.resolve("frameRandom"),this.constantDelta=e.scope.resolve("delta"),this.constantRate=e.scope.resolve("rate"),this.constantRateDiv=e.scope.resolve("rateDiv"),this.constantLifetime=e.scope.resolve("lifetime"),this.constantGraphSampleSize=e.scope.resolve("graphSampleSize"),this.constantGraphNumSamples=e.scope.resolve("graphNumSamples"),this.constantInternalTex0=e.scope.resolve("internalTex0"),this.constantInternalTex1=e.scope.resolve("internalTex1"),this.constantInternalTex2=e.scope.resolve("internalTex2"),this.constantInternalTex3=e.scope.resolve("internalTex3"),this.constantEmitterMatrix=e.scope.resolve("emitterMatrix"),this.constantEmitterMatrixInv=e.scope.resolve("emitterMatrixInv"),this.constantNumParticles=e.scope.resolve("numParticles"),this.constantNumParticlesPot=e.scope.resolve("numParticlesPot"),this.constantLocalVelocityDivMult=e.scope.resolve("localVelocityDivMult"),this.constantVelocityDivMult=e.scope.resolve("velocityDivMult"),this.constantRotSpeedDivMult=e.scope.resolve("rotSpeedDivMult"),this.constantSeed=e.scope.resolve("seed"),this.constantStartAngle=e.scope.resolve("startAngle"),this.constantStartAngle2=e.scope.resolve("startAngle2"),this.constantOutBoundsMul=e.scope.resolve("outBoundsMul"),this.constantOutBoundsAdd=e.scope.resolve("outBoundsAdd"),this.constantInBoundsSize=e.scope.resolve("inBoundsSize"),this.constantInBoundsCenter=e.scope.resolve("inBoundsCenter"),this.constantMaxVel=e.scope.resolve("maxVel"),this.constantFaceTangent=e.scope.resolve("faceTangent"),this.constantFaceBinorm=e.scope.resolve("faceBinorm")}_setInputBounds(){this.inBoundsSizeUniform[0]=this._emitter.prevWorldBoundsSize.x,this.inBoundsSizeUniform[1]=this._emitter.prevWorldBoundsSize.y,this.inBoundsSizeUniform[2]=this._emitter.prevWorldBoundsSize.z,this.constantInBoundsSize.setValue(this.inBoundsSizeUniform),this.inBoundsCenterUniform[0]=this._emitter.prevWorldBoundsCenter.x,this.inBoundsCenterUniform[1]=this._emitter.prevWorldBoundsCenter.y,this.inBoundsCenterUniform[2]=this._emitter.prevWorldBoundsCenter.z,this.constantInBoundsCenter.setValue(this.inBoundsCenterUniform)}randomize(){this.frameRandomUniform[0]=Math.random(),this.frameRandomUniform[1]=Math.random(),this.frameRandomUniform[2]=Math.random()}update(t,e,i,n,s){var r=this._emitter;t.setBlending(!1),t.setColorWrite(!0,!0,!0,!0),t.setCullMode(Hn),t.setDepthTest(!1),t.setDepthWrite(!1),this.randomize(),this.constantGraphSampleSize.setValue(1/r.precision),this.constantGraphNumSamples.setValue(r.precision),this.constantNumParticles.setValue(r.numParticles),this.constantNumParticlesPot.setValue(r.numParticlesPot),this.constantInternalTex0.setValue(r.internalTex0),this.constantInternalTex1.setValue(r.internalTex1),this.constantInternalTex2.setValue(r.internalTex2),this.constantInternalTex3.setValue(r.internalTex3);var o=r.meshInstance.node,a=null===o?ht.ONE:o.localScale;if(r.pack8){this.worldBoundsMulUniform[0]=r.worldBoundsMul.x,this.worldBoundsMulUniform[1]=r.worldBoundsMul.y,this.worldBoundsMulUniform[2]=r.worldBoundsMul.z,this.constantOutBoundsMul.setValue(this.worldBoundsMulUniform),this.worldBoundsAddUniform[0]=r.worldBoundsAdd.x,this.worldBoundsAddUniform[1]=r.worldBoundsAdd.y,this.worldBoundsAddUniform[2]=r.worldBoundsAdd.z,this.constantOutBoundsAdd.setValue(this.worldBoundsAddUniform),this._setInputBounds();var l=r.maxVel*Math.max(Math.max(a.x,a.y),a.z);l=Math.max(l,1),this.constantMaxVel.setValue(l)}var h=null===o||r.localSpace?ht.ZERO:o.getPosition(),c=null===o?bt.IDENTITY:o.getWorldTransform();r.emitterShape===Ae?(uu.setFromMat4(e),this.constantSpawnBounds.setValue(uu.data),this.constantSpawnPosInnerRatio.setValue(i)):(this.constantSpawnBoundsSphere.setValue(r.emitterRadius),this.constantSpawnBoundsSphereInnerRatio.setValue(0===r.emitterRadius?0:r.emitterRadiusInner/r.emitterRadius)),this.constantInitialVelocity.setValue(r.initialVelocity),du.setFromMat4(c),c.invertTo3x3(pu),this.emitterPosUniform[0]=h.x,this.emitterPosUniform[1]=h.y,this.emitterPosUniform[2]=h.z,this.constantEmitterPos.setValue(this.emitterPosUniform),this.constantFrameRandom.setValue(this.frameRandomUniform),this.constantDelta.setValue(n),this.constantRate.setValue(r.rate),this.constantRateDiv.setValue(r.rate2-r.rate),this.constantStartAngle.setValue(r.startAngle*Z.DEG_TO_RAD),this.constantStartAngle2.setValue(r.startAngle2*Z.DEG_TO_RAD),this.constantSeed.setValue(r.seed),this.constantLifetime.setValue(r.lifetime),this.emitterScaleUniform[0]=a.x,this.emitterScaleUniform[1]=a.y,this.emitterScaleUniform[2]=a.z,this.constantEmitterScale.setValue(this.emitterScaleUniform),this.constantEmitterMatrix.setValue(du.data),this.constantEmitterMatrixInv.setValue(pu.data),this.constantLocalVelocityDivMult.setValue(r.localVelocityUMax),this.constantVelocityDivMult.setValue(r.velocityUMax),this.constantRotSpeedDivMult.setValue(r.rotSpeedUMax[0]);var _=r.swapTex?r.particleTexOUT:r.particleTexIN;_=r.beenReset?r.particleTexStart:_;var u=r.swapTex?r.particleTexIN:r.particleTexOUT;this.constantParticleTexIN.setValue(_),zo(t,r.swapTex?r.rtParticleTexIN:r.rtParticleTexOUT,s?r.shaderParticleUpdateOnStop:r.loop?r.shaderParticleUpdateRespawn:r.shaderParticleUpdateNoRespawn),r.material.setParameter("particleTexOUT",_),r.material.setParameter("particleTexIN",u),r.beenReset=!1,r.swapTex=!r.swapTex,t.setDepthTest(!0),t.setDepthWrite(!0),r.prevWorldBoundsSize.copy(r.worldBoundsSize),r.prevWorldBoundsCenter.copy(r.worldBounds.center),r.pack8&&this._setInputBounds()}}const mu=[[-1,-1],[1,-1],[1,1],[-1,1]];function gu(t,e,i,n,s=As,r,o){var a=Kn;o&&s===ys&&(a=Zn);var l=new _a(t,{width:e,height:i,format:s,cubemap:!1,mipmaps:!1,minFilter:a,magFilter:a,addressU:pn,addressV:pn});l.name="PSTexture";var h=l.lock();if(s===ys){for(var c=new Uint8Array(n.length),_=0;_<n.length;_++)c[_]=n[_]*r*255;n=c}return h.set(n),l.unlock(),l}function bu(t){return Math.max(Math.min(t,1),0)}var yu,vu,Su=new at([0,0,1,0]),xu=new at([0,1,1,1]),wu=new lt([0,0,1,0],[0,0,1,0],[0,0,1,0]),Cu=new lt([0,1,1,1],[0,1,1,1],[0,1,1,1]),Tu=2,Au=new Float32Array(3),Eu=new bt,Mu=new ht,Ru=new ht,Iu=new ht;function Pu(t,e){void 0!==vu[t]&&null!==vu[t]?yu[t]=vu[t]:yu[t]=e}function Lu(t,e,i){return(255*t<<16|255*e<<8|255*i)/(1<<24)}function Du(t,e){for(var i=t.length/3,n=new Array(4*i),s=0;s<i;s++)n[4*s]=t[3*s],n[4*s+1]=t[3*s+1],n[4*s+2]=t[3*s+2],n[4*s+3]=Lu(e[3*s],e[3*s+1],e[3*s+2]);return n}function ku(t,e){var i,n,s=e.length,r=t.length/s;for(i=0;i<r;i++)for(n=0;n<s;n++){var o=Math.abs(t[i*s+n]);e[n]=Math.max(e[n],o)}}function Ou(t,e,i){var n=function(t,e){for(var i=new Float32Array(t.length),n=0;n<t.length;n++)i[n]=t[n]-e[n];return i}(e,t);return ku(n,i),function(t,e){var i,n,s=e.length,r=t.length/s;for(i=0;i<r;i++)for(n=0;n<s;n++)t[i*s+n]/=0===e[n]?1:e[n],t[i*s+n]*=.5,t[i*s+n]+=.5}(n,i),n}class Fu{constructor(t,e){this.graphicsDevice=t;var i=t;this.precision=32,this._addTimeTime=0,Fu.staticInit(i),yu=this,vu=e,Pu("numParticles",1),this.numParticles>t.maxTextureSize&&(console.warn("WARNING: can't create more than "+t.maxTextureSize+" particles on this device."),this.numParticles=t.maxTextureSize),Pu("rate",1),Pu("rate2",this.rate),Pu("lifetime",50),Pu("emitterExtents",new ht(0,0,0)),Pu("emitterExtentsInner",new ht(0,0,0)),Pu("emitterRadius",0),Pu("emitterRadiusInner",0),Pu("emitterShape",Ae),Pu("initialVelocity",1),Pu("wrap",!1),Pu("localSpace",!1),Pu("screenSpace",!1),Pu("wrapBounds",null),Pu("colorMap",Fu.DEFAULT_PARAM_TEXTURE),Pu("normalMap",null),Pu("loop",!0),Pu("preWarm",!1),Pu("sort",ve),Pu("mode",Ce),Pu("scene",null),Pu("lighting",!1),Pu("halfLambert",!1),Pu("intensity",1),Pu("stretch",0),Pu("alignToMotion",!1),Pu("depthSoftening",0),Pu("mesh",null),Pu("particleNormal",new ht(0,1,0)),Pu("orientation",Me),Pu("depthWrite",!1),Pu("noFog",!1),Pu("blendType",Pt),Pu("node",null),Pu("startAngle",0),Pu("startAngle2",this.startAngle),Pu("animTilesX",1),Pu("animTilesY",1),Pu("animStartFrame",0),Pu("animNumFrames",1),Pu("animNumAnimations",1),Pu("animIndex",0),Pu("randomizeAnimIndex",!1),Pu("animSpeed",1),Pu("animLoop",!0),this._gpuUpdater=new fu(this,i),this._cpuUpdater=new _u(this),this.constantLightCube=i.scope.resolve("lightCube[0]"),this.emitterPosUniform=new Float32Array(3),this.wrapBoundsUniform=new Float32Array(3),this.emitterScaleUniform=new Float32Array([1,1,1]),Pu("colorGraph",Cu),Pu("colorGraph2",this.colorGraph),Pu("scaleGraph",xu),Pu("scaleGraph2",this.scaleGraph),Pu("alphaGraph",xu),Pu("alphaGraph2",this.alphaGraph),Pu("localVelocityGraph",wu),Pu("localVelocityGraph2",this.localVelocityGraph),Pu("velocityGraph",wu),Pu("velocityGraph2",this.velocityGraph),Pu("rotationSpeedGraph",Su),Pu("rotationSpeedGraph2",this.rotationSpeedGraph),Pu("radialSpeedGraph",Su),Pu("radialSpeedGraph2",this.radialSpeedGraph),this.lightCube=new Float32Array(18),this.lightCubeDir=new Array(6),this.lightCubeDir[0]=new ht(-1,0,0),this.lightCubeDir[1]=new ht(1,0,0),this.lightCubeDir[2]=new ht(0,-1,0),this.lightCubeDir[3]=new ht(0,1,0),this.lightCubeDir[4]=new ht(0,0,-1),this.lightCubeDir[5]=new ht(0,0,1),this.animTilesParams=new Float32Array(2),this.animParams=new Float32Array(4),this.animIndexParams=new Float32Array(2),this.internalTex0=null,this.internalTex1=null,this.internalTex2=null,this.colorParam=null,this.vbToSort=null,this.vbOld=null,this.particleDistance=null,this.camera=null,this.swapTex=!1,this.useMesh=!0,this.useCpu=!1,this.pack8=!0,this.localBounds=new Tt,this.worldBoundsNoTrail=new Tt,this.worldBoundsTrail=[new Tt,new Tt],this.worldBounds=new Tt,this.worldBoundsSize=new ht,this.prevWorldBoundsSize=new ht,this.prevWorldBoundsCenter=new ht,this.prevEmitterExtents=this.emitterExtents,this.prevEmitterRadius=this.emitterRadius,this.worldBoundsMul=new ht,this.worldBoundsAdd=new ht,this.timeToSwitchBounds=0,this.shaderParticleUpdateRespawn=null,this.shaderParticleUpdateNoRespawn=null,this.shaderParticleUpdateOnStop=null,this.numParticleVerts=0,this.numParticleIndices=0,this.material=null,this.meshInstance=null,this.drawOrder=0,this.seed=Math.random(),this.fixedTimeStep=1/60,this.maxSubSteps=10,this.simTime=0,this.simTimeTotal=0,this.beenReset=!1,this._layer=null,this.rebuild()}static staticInit(t){if(!Fu.DEFAULT_PARAM_TEXTURE){const e=16,i=.5*e+.5,n=new Float32Array(e*e*4);for(let t=0;t<e;t++)for(let s=0;s<e;s++){const r=s+1-i,o=t+1-i,a=bu(1-bu(Math.sqrt(r*r+o*o)/e)-.5),l=t*e+s;n[4*l]=1,n[4*l+1]=1,n[4*l+2]=1,n[4*l+3]=a}Fu.DEFAULT_PARAM_TEXTURE=gu(t,e,e,n,ys,1,!0),Fu.DEFAULT_PARAM_TEXTURE.minFilter=Zn,Fu.DEFAULT_PARAM_TEXTURE.magFilter=Zn}}static staticDestroy(){Fu.DEFAULT_PARAM_TEXTURE&&(Fu.DEFAULT_PARAM_TEXTURE.destroy(),Fu.DEFAULT_PARAM_TEXTURE=null)}onChangeCamera(){this.regenShader(),this.resetMaterial()}calculateBoundsMad(){this.worldBoundsMul.x=1/this.worldBoundsSize.x,this.worldBoundsMul.y=1/this.worldBoundsSize.y,this.worldBoundsMul.z=1/this.worldBoundsSize.z,this.worldBoundsAdd.copy(this.worldBounds.center).mul(this.worldBoundsMul).mulScalar(-1),this.worldBoundsAdd.x+=.5,this.worldBoundsAdd.y+=.5,this.worldBoundsAdd.z+=.5}calculateWorldBounds(){if(this.node){if(this.prevWorldBoundsSize.copy(this.worldBoundsSize),this.prevWorldBoundsCenter.copy(this.worldBounds.center),!this.useCpu){(this.emitterShape===Ae?!this.emitterExtents.equals(this.prevEmitterExtents):!(this.emitterRadius===this.prevEmitterRadius))&&this.calculateLocalBounds()}var t=this.node.getWorldTransform();this.localSpace?this.worldBoundsNoTrail.copy(this.localBounds):this.worldBoundsNoTrail.setFromTransformedAabb(this.localBounds,t),this.worldBoundsTrail[0].add(this.worldBoundsNoTrail),this.worldBoundsTrail[1].add(this.worldBoundsNoTrail);var e=this.simTimeTotal;e>=this.timeToSwitchBounds&&(this.worldBoundsTrail[0].copy(this.worldBoundsTrail[1]),this.worldBoundsTrail[1].copy(this.worldBoundsNoTrail),this.timeToSwitchBounds=e+this.lifetime),this.worldBounds.copy(this.worldBoundsTrail[0]),this.worldBoundsSize.copy(this.worldBounds.halfExtents).mulScalar(2),this.localSpace?(this.meshInstance.aabb.setFromTransformedAabb(this.worldBounds,t),this.meshInstance.mesh.aabb.setFromTransformedAabb(this.worldBounds,t)):(this.meshInstance.aabb.copy(this.worldBounds),this.meshInstance.mesh.aabb.copy(this.worldBounds)),this.meshInstance._aabbVer=1-this.meshInstance._aabbVer,this.pack8&&this.calculateBoundsMad()}}resetWorldBounds(){this.node&&(this.worldBoundsNoTrail.setFromTransformedAabb(this.localBounds,this.localSpace?bt.IDENTITY:this.node.getWorldTransform()),this.worldBoundsTrail[0].copy(this.worldBoundsNoTrail),this.worldBoundsTrail[1].copy(this.worldBoundsNoTrail),this.worldBounds.copy(this.worldBoundsTrail[0]),this.worldBoundsSize.copy(this.worldBounds.halfExtents).mulScalar(2),this.prevWorldBoundsSize.copy(this.worldBoundsSize),this.prevWorldBoundsCenter.copy(this.worldBounds.center),this.simTimeTotal=0,this.timeToSwitchBounds=0)}calculateLocalBounds(){var t,e,i,n,s,r,o=Number.MAX_VALUE,a=Number.MAX_VALUE,l=Number.MAX_VALUE,h=-Number.MAX_VALUE,c=-Number.MAX_VALUE,_=-Number.MAX_VALUE,u=0,d=0,p=this.lifetime/this.precision,f=[this.qVelocity,this.qVelocity2],m=[this.qLocalVelocity,this.qLocalVelocity2],g=[0,0],b=[0,0],y=[0,0],v=[0,0],S=[0,0];for(t=0;t<this.precision+1;t++){for(i=Math.min(t,this.precision-1),e=0;e<2;e++)n=m[e][3*i+0]*p+g[e],s=m[e][3*i+1]*p+b[e],r=m[e][3*i+2]*p+y[e],o=Math.min(n,o),a=Math.min(s,a),l=Math.min(r,l),h=Math.max(n,h),c=Math.max(s,c),_=Math.max(r,_),g[e]=n,b[e]=s,y[e]=r;for(e=0;e<2;e++)S[e]+=p*Math.sqrt(f[e][3*i+0]*f[e][3*i+0]+f[e][3*i+1]*f[e][3*i+1]+f[e][3*i+2]*f[e][3*i+2]);v[0]+=this.qRadialSpeed[i]*p,v[1]+=this.qRadialSpeed2[i]*p,u=Math.max(u,Math.max(Math.abs(v[0]),Math.abs(v[1]))),d=Math.max(d,this.qScale[i])}this.emitterShape===Ae?(n=.5*this.emitterExtents.x,s=.5*this.emitterExtents.y,r=.5*this.emitterExtents.z):(n=this.emitterRadius,s=this.emitterRadius,r=this.emitterRadius);var x=Math.max(S[0],S[1]);Ru.x=o-d-n-u-x,Ru.y=a-d-s-u-x,Ru.z=l-d-r-u-x,Iu.x=h+d+n+u+x,Iu.y=c+d+s+u+x,Iu.z=_+d+r+u+x,this.localBounds.setMinMax(Ru,Iu)}rebuild(){var t,e=this.graphicsDevice;(null===this.colorMap&&(this.colorMap=Fu.DEFAULT_PARAM_TEXTURE),this.spawnBounds=this.emitterShape===Ae?this.emitterExtents:this.emitterRadius,this.useCpu=this.useCpu||this.sort>ve||e.maxVertexTextures<=1||e.fragmentUniformsCount<64||e.forceCpuParticles||!e.extTextureFloat,this._destroyResources(),this.pack8=(this.pack8||!e.textureFloatRenderable)&&!this.useCpu,Tu=this.useCpu||this.pack8?4:2,this.useMesh=!1,this.mesh)&&(this.numParticles*this.mesh.vertexBuffer.numVertices>65535?console.warn("WARNING: particle system can't render mesh particles because numParticles * numVertices is more than 65k. Reverting to quad particles."):this.useMesh=!0);this.numParticlesPot=Z.nextPowerOfTwo(this.numParticles),this.rebuildGraphs(),this.calculateLocalBounds(),this.resetWorldBounds(),this.node&&(this.worldBounds.setFromTransformedAabb(this.localBounds,this.localSpace?bt.IDENTITY:this.node.getWorldTransform()),this.worldBoundsTrail[0].copy(this.worldBounds),this.worldBoundsTrail[1].copy(this.worldBounds),this.worldBoundsSize.copy(this.worldBounds.halfExtents).mulScalar(2),this.prevWorldBoundsSize.copy(this.worldBoundsSize),this.prevWorldBoundsCenter.copy(this.worldBounds.center),this.pack8&&this.calculateBoundsMad()),this.vbToSort=new Array(this.numParticles);for(var i=0;i<this.numParticles;i++)this.vbToSort[i]=[0,0];this.particleDistance=new Float32Array(this.numParticles),this._gpuUpdater.randomize(),this.particleTex=new Float32Array(this.numParticlesPot*Tu*4);var n=null===this.node||this.localSpace?ht.ZERO:this.node.getPosition();for(this.emitterShape===Ae&&(null===this.node||this.localSpace?Eu.setTRS(ht.ZERO,yt.IDENTITY,this.spawnBounds):Eu.setTRS(ht.ZERO,this.node.getRotation(),Mu.copy(this.spawnBounds).mul(this.node.localScale)),Au[0]=0!==this.emitterExtents.x?this.emitterExtentsInner.x/this.emitterExtents.x:0,Au[1]=0!==this.emitterExtents.y?this.emitterExtentsInner.y/this.emitterExtents.y:0,Au[2]=0!==this.emitterExtents.z?this.emitterExtentsInner.z/this.emitterExtents.z:0),t=0;t<this.numParticles;t++)this._cpuUpdater.calcSpawnPosition(this.particleTex,Eu,Au,n,t),this.useCpu&&(this.particleTex[4*t+3+2*this.numParticlesPot*4]=1);for(this.particleTexStart=new Float32Array(this.numParticlesPot*Tu*4),t=0;t<this.particleTexStart.length;t++)this.particleTexStart[t]=this.particleTex[t];this.useCpu||(this.pack8?(this.particleTexIN=gu(e,this.numParticlesPot,Tu,this.particleTex,ys,1,!1),this.particleTexOUT=gu(e,this.numParticlesPot,Tu,this.particleTex,ys,1,!1),this.particleTexStart=gu(e,this.numParticlesPot,Tu,this.particleTexStart,ys,1,!1)):(this.particleTexIN=gu(e,this.numParticlesPot,Tu,this.particleTex),this.particleTexOUT=gu(e,this.numParticlesPot,Tu,this.particleTex),this.particleTexStart=gu(e,this.numParticlesPot,Tu,this.particleTexStart)),this.rtParticleTexIN=new Gl({colorBuffer:this.particleTexIN,depth:!1}),this.rtParticleTexOUT=new Gl({colorBuffer:this.particleTexOUT,depth:!1}),this.swapTex=!1);var s=(this.localSpace?"#define LOCAL_SPACE\n":"")+jo.particleUpdaterInitPS+(this.pack8?jo.particleInputRgba8PS+jo.particleOutputRgba8PS:jo.particleInputFloatPS+jo.particleOutputFloatPS)+(this.emitterShape===Ae?jo.particleUpdaterAABBPS:jo.particleUpdaterSpherePS)+jo.particleUpdaterStartPS,r=s+jo.particleUpdaterRespawnPS+jo.particleUpdaterEndPS,o=s+jo.particleUpdaterNoRespawnPS+jo.particleUpdaterEndPS,a=s+jo.particleUpdaterOnStopPS+jo.particleUpdaterEndPS,l=this.emitterShape+""+this.pack8+this.localSpace;this.shaderParticleUpdateRespawn=ia(e,jo.fullscreenQuadVS,r,"fsQuad0"+l),this.shaderParticleUpdateNoRespawn=ia(e,jo.fullscreenQuadVS,o,"fsQuad1"+l),this.shaderParticleUpdateOnStop=ia(e,jo.fullscreenQuadVS,a,"fsQuad2"+l),this.numParticleVerts=this.useMesh?this.mesh.vertexBuffer.numVertices:4,this.numParticleIndices=this.useMesh?this.mesh.indexBuffer[0].numIndices:6,this._allocate(this.numParticles);var h=new xh(e);h.vertexBuffer=this.vertexBuffer,h.indexBuffer[0]=this.indexBuffer,h.primitive[0].type=Ys,h.primitive[0].base=0,h.primitive[0].count=this.numParticles*this.numParticleIndices,h.primitive[0].indexed=!0,this.material=new pl,this.material.name=this.node.name,this.material.cull=Hn,this.material.alphaWrite=!1,this.material.blend=!0,this.material.blendType=this.blendType,this.material.depthWrite=this.depthWrite,this.material.emitter=this,this.regenShader(),this.resetMaterial();var c=!this.meshInstance||this.meshInstance.visible;this.meshInstance=new Kh(h,this.material,this.node),this.meshInstance.pick=!1,this.meshInstance.updateKey(),this.meshInstance.cull=!0,this.meshInstance._noDepthDrawGl1=!0,this.localSpace?this.meshInstance.aabb.setFromTransformedAabb(this.worldBounds,this.node.getWorldTransform()):this.meshInstance.aabb.copy(this.worldBounds),this.meshInstance._updateAabb=!1,this.meshInstance.visible=c,this._initializeTextures(),this.resetTime(),this.addTime(0,!1),this.preWarm&&this.prewarm(this.lifetime)}_isAnimated(){return this.animNumFrames>=1&&(this.animTilesX>1||this.animTilesY>1)&&(this.colorMap&&this.colorMap!==Fu.DEFAULT_PARAM_TEXTURE||this.normalMap)}rebuildGraphs(){var t,e=this.precision,i=this.graphicsDevice;for(this.qLocalVelocity=this.localVelocityGraph.quantize(e),this.qVelocity=this.velocityGraph.quantize(e),this.qColor=this.colorGraph.quantizeClamped(e,0,1),this.qRotSpeed=this.rotationSpeedGraph.quantize(e),this.qScale=this.scaleGraph.quantize(e),this.qAlpha=this.alphaGraph.quantize(e),this.qRadialSpeed=this.radialSpeedGraph.quantize(e),this.qLocalVelocity2=this.localVelocityGraph2.quantize(e),this.qVelocity2=this.velocityGraph2.quantize(e),this.qColor2=this.colorGraph2.quantizeClamped(e,0,1),this.qRotSpeed2=this.rotationSpeedGraph2.quantize(e),this.qScale2=this.scaleGraph2.quantize(e),this.qAlpha2=this.alphaGraph2.quantize(e),this.qRadialSpeed2=this.radialSpeedGraph2.quantize(e),t=0;t<e;t++)this.qRotSpeed[t]*=Z.DEG_TO_RAD,this.qRotSpeed2[t]*=Z.DEG_TO_RAD;if(this.localVelocityUMax=new Float32Array(3),this.velocityUMax=new Float32Array(3),this.colorUMax=new Float32Array(3),this.rotSpeedUMax=[0],this.scaleUMax=[0],this.alphaUMax=[0],this.radialSpeedUMax=[0],this.qLocalVelocityDiv=Ou(this.qLocalVelocity,this.qLocalVelocity2,this.localVelocityUMax),this.qVelocityDiv=Ou(this.qVelocity,this.qVelocity2,this.velocityUMax),this.qColorDiv=Ou(this.qColor,this.qColor2,this.colorUMax),this.qRotSpeedDiv=Ou(this.qRotSpeed,this.qRotSpeed2,this.rotSpeedUMax),this.qScaleDiv=Ou(this.qScale,this.qScale2,this.scaleUMax),this.qAlphaDiv=Ou(this.qAlpha,this.qAlpha2,this.alphaUMax),this.qRadialSpeedDiv=Ou(this.qRadialSpeed,this.qRadialSpeed2,this.radialSpeedUMax),this.pack8){var n=[0,0,0];ku(this.qVelocity,n);var s=[0,0,0];ku(this.qVelocity2,s);var r=[0,0,0];ku(this.qLocalVelocity,r);var o=[0,0,0];ku(this.qLocalVelocity2,o);var a=[0];ku(this.qRadialSpeed,a);var l=[0];ku(this.qRadialSpeed2,l);var h=Math.max(n[0],s[0]);h=Math.max(h,n[1]),h=Math.max(h,s[1]),h=Math.max(h,n[2]),h=Math.max(h,s[2]);var c=Math.max(r[0],o[0]);c=Math.max(c,r[1]),c=Math.max(c,o[1]),c=Math.max(c,r[2]),c=Math.max(c,o[2]);var _=Math.max(a[0],l[0]);this.maxVel=h+c+_}this.useCpu||(this.internalTex0=gu(i,e,1,Du(this.qLocalVelocity,this.qLocalVelocityDiv)),this.internalTex1=gu(i,e,1,Du(this.qVelocity,this.qVelocityDiv)),this.internalTex2=gu(i,e,1,function(t,e,i,n,s){for(var r=new Array(4*t.length),o=0;o<t.length;o++)r[4*o]=t[o],r[4*o+1]=e[o],r[4*o+2]=0,r[4*o+3]=Lu(i[o],n[o],s[o]);return r}(this.qRotSpeed,this.qScale,this.qScaleDiv,this.qRotSpeedDiv,this.qAlphaDiv)),this.internalTex3=gu(i,e,1,function(t,e){for(var i=new Array(4*t.length),n=0;n<t.length;n++)i[4*n]=t[n],i[4*n+1]=e[n],i[4*n+2]=0,i[4*n+3]=0;return i}(this.qRadialSpeed,this.qRadialSpeedDiv))),this.colorParam=gu(i,e,1,function(t,e){for(var i=new Array(4*e.length),n=0;n<e.length;n++)i[4*n]=t[3*n],i[4*n+1]=t[3*n+1],i[4*n+2]=t[3*n+2],i[4*n+3]=e[n];return i}(this.qColor,this.qAlpha),ys,1,!0)}_initializeTextures(){this.colorMap&&(this.material.setParameter("colorMap",this.colorMap),this.lighting&&this.normalMap&&this.material.setParameter("normalMap",this.normalMap))}regenShader(){var t=this.graphicsDevice.getProgramLibrary(),e=null!==this.normalMap;this.normalOption=0,this.lighting&&(this.normalOption=e?2:1),this.material.updateShader=function(){this.emitter.scene&&this.emitter.camera!==this.emitter.scene._activeCamera&&(this.emitter.camera=this.emitter.scene._activeCamera,this.emitter.onChangeCamera());var e=this.emitter.inTools,i=t.getProgram("particle",{useCpu:this.emitter.useCpu,normal:this.emitter.normalOption,halflambert:this.emitter.halfLambert,stretch:this.emitter.stretch,alignToMotion:this.emitter.alignToMotion,soft:this.emitter.depthSoftening,mesh:this.emitter.useMesh,gamma:this.emitter.scene?this.emitter.scene.gammaCorrection:0,toneMap:this.emitter.scene?this.emitter.scene.toneMapping:0,fog:this.emitter.scene&&!this.emitter.noFog?this.emitter.scene.fog:"none",wrap:this.emitter.wrap&&this.emitter.wrapBounds,localSpace:this.emitter.localSpace,screenSpace:!e&&this.emitter.screenSpace,blend:this.blendType,animTex:this.emitter._isAnimated(),animTexLoop:this.emitter.animLoop,pack8:this.emitter.pack8,customFace:this.emitter.orientation!==Me});this.shader=i},this.material.updateShader()}resetMaterial(){var t=this.material;t.setParameter("stretch",this.stretch),this._isAnimated()&&(t.setParameter("animTexTilesParams",this.animTilesParams),t.setParameter("animTexParams",this.animParams),t.setParameter("animTexIndexParams",this.animIndexParams)),t.setParameter("colorMult",this.intensity),this.useCpu||(t.setParameter("internalTex0",this.internalTex0),t.setParameter("internalTex1",this.internalTex1),t.setParameter("internalTex2",this.internalTex2),t.setParameter("internalTex3",this.internalTex3)),t.setParameter("colorParam",this.colorParam),t.setParameter("numParticles",this.numParticles),t.setParameter("numParticlesPot",this.numParticlesPot),t.setParameter("lifetime",this.lifetime),t.setParameter("rate",this.rate),t.setParameter("rateDiv",this.rate2-this.rate),t.setParameter("seed",this.seed),t.setParameter("scaleDivMult",this.scaleUMax[0]),t.setParameter("alphaDivMult",this.alphaUMax[0]),t.setParameter("radialSpeedDivMult",this.radialSpeedUMax[0]),t.setParameter("graphNumSamples",this.precision),t.setParameter("graphSampleSize",1/this.precision),t.setParameter("emitterScale",new Float32Array([1,1,1])),this.pack8&&(this._gpuUpdater._setInputBounds(),t.setParameter("inBoundsSize",this._gpuUpdater.inBoundsSizeUniform),t.setParameter("inBoundsCenter",this._gpuUpdater.inBoundsCenterUniform),t.setParameter("maxVel",this.maxVel)),this.wrap&&this.wrapBounds&&(this.wrapBoundsUniform[0]=this.wrapBounds.x,this.wrapBoundsUniform[1]=this.wrapBounds.y,this.wrapBoundsUniform[2]=this.wrapBounds.z,t.setParameter("wrapBounds",this.wrapBoundsUniform)),this.colorMap&&t.setParameter("colorMap",this.colorMap),this.lighting&&this.normalMap&&t.setParameter("normalMap",this.normalMap),this.depthSoftening>0&&t.setParameter("softening",1/(this.depthSoftening*this.depthSoftening*100)),this.stretch>0&&(t.cull=Hn),this._compParticleFaceParams()}_compParticleFaceParams(){var t,e;if(this.orientation===Me)t=new Float32Array([1,0,0]),e=new Float32Array([0,0,1]);else{var i;if(this.orientation===Re)i=this.particleNormal.normalize();else i=(null===this.node?bt.IDENTITY:this.node.getWorldTransform()).transformVector(this.particleNormal).normalize();var n=new ht(1,0,0);1===Math.abs(n.dot(i))&&n.set(0,0,1);var s=(new ht).cross(i,n).normalize();n.cross(s,i).normalize(),t=new Float32Array([n.x,n.y,n.z]),e=new Float32Array([s.x,s.y,s.z])}this.material.setParameter("faceTangent",t),this.material.setParameter("faceBinorm",e)}_allocate(t){var e,i,n,s=t*this.numParticleVerts,r=t*this.numParticleIndices;if(void 0===this.vertexBuffer||this.vertexBuffer.getNumVertices()!==s){this.useCpu?(e=[{semantic:ur,components:4,type:no},{semantic:dr,components:4,type:no},{semantic:pr,components:4,type:no},{semantic:fr,components:1,type:no},{semantic:mr,components:this.useMesh?4:2,type:no}],i=new No(this.graphicsDevice,e),this.vertexBuffer=new Fo(this.graphicsDevice,i,s,Dn),this.indexBuffer=new $l(this.graphicsDevice,cs,r)):(e=[{semantic:ur,components:4,type:no}],this.useMesh&&e.push({semantic:dr,components:2,type:no}),i=new No(this.graphicsDevice,e),this.vertexBuffer=new Fo(this.graphicsDevice,i,s,Dn),this.indexBuffer=new $l(this.graphicsDevice,cs,r));var o,a,l,h,c=new Float32Array(this.vertexBuffer.lock());if(this.useMesh){a=(o=new Float32Array(this.mesh.vertexBuffer.lock())).length/this.mesh.vertexBuffer.numVertices;for(var _=0;_<this.mesh.vertexBuffer.format.elements.length;_++)if(this.mesh.vertexBuffer.format.elements[_].name===nr){l=this.mesh.vertexBuffer.format.elements[_].offset/4;break}}for(n=0;n<s;n++)if(h=Math.floor(n/this.numParticleVerts),this.useMesh){var u=n%this.numParticleVerts;c[6*n]=o[u*a],c[6*n+1]=o[u*a+1],c[6*n+2]=o[u*a+2],c[6*n+3]=h,c[6*n+4]=o[u*a+l+0],c[6*n+5]=1-o[u*a+l+1]}else{var d=n%4;c[4*n]=mu[d][0],c[4*n+1]=mu[d][1],c[4*n+2]=0,c[4*n+3]=h}this.useCpu&&(this.vbCPU=new Float32Array(c),this.vbOld=new Float32Array(this.vbCPU.length)),this.vertexBuffer.unlock(),this.useMesh&&this.mesh.vertexBuffer.unlock();var p=0,f=new Uint16Array(this.indexBuffer.lock());for(this.useMesh&&(o=new Uint16Array(this.mesh.indexBuffer[0].lock())),n=0;n<t;n++)if(this.useMesh)for(var m=0;m<this.numParticleIndices;m++)f[n*this.numParticleIndices+m]=o[m]+n*this.numParticleVerts;else{var g=4*n;f[p++]=g,f[p++]=g+1,f[p++]=g+2,f[p++]=g,f[p++]=g+2,f[p++]=g+3}this.indexBuffer.unlock(),this.useMesh&&this.mesh.indexBuffer[0].unlock()}}reset(){if(this.beenReset=!0,this.seed=Math.random(),this.material.setParameter("seed",this.seed),this.useCpu)for(var t=0;t<this.particleTexStart.length;t++)this.particleTex[t]=this.particleTexStart[t];else this._initializeTextures();this.resetWorldBounds(),this.resetTime();var e=this.loop;this.loop=!0,this.addTime(0,!1),this.loop=e,this.preWarm&&this.prewarm(this.lifetime)}prewarm(t){for(var e=t/this.lifetime,i=Math.min(Math.floor(e*this.precision),this.precision),n=t/i,s=0;s<i;s++)this.addTime(n,!1)}resetTime(){var t,e;this.endTime=(t=this,e=Math.max(t.rate,t.rate2)*t.numParticles+t.lifetime,Date.now()+1e3*e)}finishFrame(){this.useCpu&&this.vertexBuffer.unlock()}addTime(t,e){var i,n=this.graphicsDevice;if(this.simTimeTotal+=t,this.calculateWorldBounds(),this._isAnimated()){var s=this.animTilesParams;s[0]=1/this.animTilesX,s[1]=1/this.animTilesY;var r=this.animParams;r[0]=this.animStartFrame,r[1]=this.animNumFrames*this.animSpeed,r[2]=this.animNumFrames-1,r[3]=this.animNumAnimations-1;var o=this.animIndexParams;o[0]=this.animIndex,o[1]=this.randomizeAnimIndex}this.scene&&this.camera!==this.scene._activeCamera&&(this.camera=this.scene._activeCamera,this.onChangeCamera()),this.emitterShape===Ae&&(Au[0]=0!==this.emitterExtents.x?this.emitterExtentsInner.x/this.emitterExtents.x:0,Au[1]=0!==this.emitterExtents.y?this.emitterExtentsInner.y/this.emitterExtents.y:0,Au[2]=0!==this.emitterExtents.z?this.emitterExtentsInner.z/this.emitterExtents.z:0,null===this.meshInstance.node?Eu.setTRS(ht.ZERO,yt.IDENTITY,this.emitterExtents):Eu.setTRS(ht.ZERO,this.meshInstance.node.getRotation(),Mu.copy(this.emitterExtents).mul(this.meshInstance.node.localScale)));var a=null===this.meshInstance.node?ht.ONE:this.meshInstance.node.localScale;if(this.emitterScaleUniform[0]=a.x,this.emitterScaleUniform[1]=a.y,this.emitterScaleUniform[2]=a.z,this.material.setParameter("emitterScale",this.emitterScaleUniform),this.localSpace&&this.meshInstance.node&&(i=this.meshInstance.node.getPosition(),this.emitterPosUniform[0]=i.x,this.emitterPosUniform[1]=i.y,this.emitterPosUniform[2]=i.z,this.material.setParameter("emitterPos",this.emitterPosUniform)),this._compParticleFaceParams(),this.useCpu){var l=new Float32Array(this.vertexBuffer.lock());this._cpuUpdater.update(l,this.vbToSort,this.particleTex,Eu,Au,i,t,e)}else this._gpuUpdater.update(n,Eu,Au,t,e);this.loop||Date.now()>this.endTime&&(this.onFinished&&this.onFinished(),this.meshInstance.visible=!1),this.meshInstance&&(this.meshInstance.drawOrder=this.drawOrder)}_destroyResources(){this.particleTexIN&&(this.particleTexIN.destroy(),this.particleTexIN=null),this.particleTexOUT&&(this.particleTexOUT.destroy(),this.particleTexOUT=null),this.particleTexStart&&this.particleTexStart.destroy&&(this.particleTexStart.destroy(),this.particleTexStart=null),this.rtParticleTexIN&&(this.rtParticleTexIN.destroy(),this.rtParticleTexIN=null),this.rtParticleTexOUT&&(this.rtParticleTexOUT.destroy(),this.rtParticleTexOUT=null),this.internalTex0&&(this.internalTex0.destroy(),this.internalTex0=null),this.internalTex1&&(this.internalTex1.destroy(),this.internalTex1=null),this.internalTex2&&(this.internalTex2.destroy(),this.internalTex2=null),this.internalTex3&&(this.internalTex3.destroy(),this.internalTex3=null),this.colorParam&&(this.colorParam.destroy(),this.colorParam=null),this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBuffer=void 0),this.indexBuffer&&(this.indexBuffer.destroy(),this.indexBuffer=void 0),this.material&&(this.material.destroy(),this.material=null)}destroy(){this.camera=null,this._destroyResources()}}Fu.DEFAULT_PARAM_TEXTURE=null;class Bu extends bh{constructor(t,e){super(),this.device=e||Ka().graphicsDevice,this._targets=t,this.device.supportsMorphTargetTexturesCore&&(this.device.extTextureHalfFloat&&this.device.textureHalfFloatRenderable?this._renderTextureFormat=Bu.FORMAT_HALF_FLOAT:this.device.extTextureFloat&&this.device.textureFloatRenderable&&(this._renderTextureFormat=Bu.FORMAT_FLOAT),this.device.extTextureHalfFloat&&this.device.textureHalfFloatUpdatable?this._textureFormat=Bu.FORMAT_HALF_FLOAT:this.device.extTextureFloat&&(this._textureFormat=Bu.FORMAT_FLOAT),void 0!==this._renderTextureFormat&&void 0!==this._textureFormat&&(this._useTextureMorph=!0)),this._init(),this._updateMorphFlags(),this._calculateAabb()}get morphPositions(){return this._morphPositions}get morphNormals(){return this._morphNormals}get maxActiveTargets(){return this._useTextureMorph?this._targets.length:this._morphPositions&&this._morphNormals?4:8}get useTextureMorph(){return this._useTextureMorph}_init(){if(this._useTextureMorph&&(this._useTextureMorph=this._initTextureBased()),!this._useTextureMorph)for(let t=0;t<this._targets.length;t++)this._targets[t]._initVertexBuffers(this.device);for(let t=0;t<this._targets.length;t++)this._targets[t]._postInit()}_initTextureBased(){const t=[],e=[];for(let i=0;i<this._targets.length;i++){const n=this._targets[i];n.options.deltaPositions&&(t.push(n.options.deltaPositions),e.push({target:n,name:"texturePositions"})),n.options.deltaNormals&&(t.push(n.options.deltaNormals),e.push({target:n,name:"textureNormals"}))}const i=[],n=[];let s=1;const r=t[0].length;for(let e=0;e<r;e+=3){let r=!1;for(let i=0;i<t.length;i++){const n=t[i];if(0!==n[e]||0!==n[e+1]||0!==n[e+2]){r=!0;break}}r?(i.push(s+.2),n.push(e/3),s++):i.push(.2)}const o=Math.min(this.device.maxTextureSize,4096);let a=Math.ceil(Math.sqrt(s));a=Math.min(a,o);const l=Math.ceil(s/a);if(l>o)return!1;this.morphTextureWidth=a,this.morphTextureHeight=l;let h=!1,c=3;const _=la.float2Half;this._textureFormat===Bu.FORMAT_HALF_FLOAT&&(h=!0,c=4);const u=this.morphTextureWidth*this.morphTextureHeight*c,d=h?new Uint16Array(u):new Float32Array(u);for(let i=0;i<t.length;i++){const s=t[i];for(let t=0;t<n.length;t++){const e=n[t];h?(d[t*c+c]=_(s[3*e]),d[t*c+c+1]=_(s[3*e+1]),d[t*c+c+2]=_(s[3*e+2])):(d[t*c+c]=s[3*e],d[t*c+c+1]=s[3*e+1],d[t*c+c+2]=s[3*e+2])}const r=e[i].target,o=this._textureFormat===Bu.FORMAT_FLOAT?Ts:Cs;r._setTexture(e[i].name,this._createTexture("MorphTarget",o,d))}const p=[{semantic:Er,components:1,type:no}];return this.vertexBufferIds=new Fo(this.device,new No(this.device,p),i.length,Ln,new Float32Array(i)),!0}destroy(){this.vertexBufferIds&&(this.vertexBufferIds.destroy(),this.vertexBufferIds=null);for(let t=0;t<this._targets.length;t++)this._targets[t].destroy();this._targets.length=0}get targets(){return this._targets}_updateMorphFlags(){this._morphPositions=!1,this._morphNormals=!1;for(let t=0;t<this._targets.length;t++){const e=this._targets[t];e.morphPositions&&(this._morphPositions=!0),e.morphNormals&&(this._morphNormals=!0)}}_calculateAabb(){this.aabb=new Tt(new ht(0,0,0),new ht(0,0,0));for(let t=0;t<this._targets.length;t++){const e=this._targets[t];this.aabb._expand(e.aabb.getMin(),e.aabb.getMax())}}_createTexture(t,e,i){const n=new _a(this.device,{width:this.morphTextureWidth,height:this.morphTextureHeight,format:e,cubemap:!1,mipmaps:!1,minFilter:Kn,magFilter:Kn,addressU:pn,addressV:pn});return n.name=t,i&&(n.lock().set(i),n.unlock()),n}}Bu.FORMAT_FLOAT=0,Bu.FORMAT_HALF_FLOAT=1;class Nu{constructor(t){this.morph=t,t.incRefCount(),this.device=t.device,this.meshInstance=null,this._weights=[];for(let e=0;e<t._targets.length;e++)this.setWeight(e,t._targets[e].defaultWeight);if(this._activeTargets=[],t.useTextureMorph){this.shaderCache={},this.maxSubmitCount=this.device.maxTextures,this._shaderMorphWeights=new Float32Array(this.maxSubmitCount);const e=(e,i)=>{const n=t._renderTextureFormat===Bu.FORMAT_FLOAT?As:Cs;return this[i]=t._createTexture(e,n),new Gl({colorBuffer:this[i],depth:!1})};t.morphPositions&&(this.rtPositions=e("MorphRTPos","texturePositions")),t.morphNormals&&(this.rtNormals=e("MorphRTNrm","textureNormals")),this._textureParams=new Float32Array([t.morphTextureWidth,t.morphTextureHeight,1/t.morphTextureWidth,1/t.morphTextureHeight]);for(let t=0;t<this.maxSubmitCount;t++)this["morphBlendTex"+t]=this.device.scope.resolve("morphBlendTex"+t);this.morphFactor=this.device.scope.resolve("morphFactor[0]"),this.zeroTextures=!1}else this.maxSubmitCount=8,this._shaderMorphWeights=new Float32Array(this.maxSubmitCount),this._shaderMorphWeightsA=new Float32Array(this._shaderMorphWeights.buffer,0,4),this._shaderMorphWeightsB=new Float32Array(this._shaderMorphWeights.buffer,16,4),this._activeVertexBuffers=new Array(this.maxSubmitCount)}destroy(){this.meshInstance=null,this.shader=null;const t=this.morph;t&&(this.morph=null,t.decRefCount(),t.getRefCount()<1&&t.destroy()),this.rtPositions&&(this.rtPositions.destroy(),this.rtPositions=null),this.texturePositions&&(this.texturePositions.destroy(),this.texturePositions=null),this.rtNormals&&(this.rtNormals.destroy(),this.rtNormals=null),this.textureNormals&&(this.textureNormals.destroy(),this.textureNormals=null)}clone(){return new Nu(this.morph)}getWeight(t){return this._weights[t]}setWeight(t,e){this._weights[t]=e,this._dirty=!0}_getFragmentShader(t){let e="";t>0&&(e+="varying vec2 uv0;\nuniform highp float morphFactor["+t+"];\n");for(let i=0;i<t;i++)e+="uniform highp sampler2D morphBlendTex"+i+";\n";e+="void main (void) {\n\t\thighp vec4 color = vec4(0, 0, 0, 1);\n";for(let i=0;i<t;i++)e+="\t\tcolor.xyz += morphFactor["+i+"] * texture2D(morphBlendTex"+i+", uv0).xyz;\n";return e+="\t\tgl_FragColor = color;\n}\n",e}_getShader(t){let e=this.shaderCache[t];if(!e){const i=this._getFragmentShader(t);e=ia(this.device,"\n\t\tattribute vec2 vertex_position;\n\t\tvarying vec2 uv0;\n\t\tvoid main(void) {\n\t\t\t\tgl_Position = vec4(vertex_position, 0.5, 1.0);\n\t\t\t\tuv0 = vertex_position.xy * 0.5 + 0.5;\n\t\t}\n\t\t",i,"textureMorph"+t),this.shaderCache[t]=e}return e}_updateTextureRenderTarget(t,e){const i=this.device,n=(e,n)=>{this.morphFactor.setValue(this._shaderMorphWeights),i.setBlending(n),n&&(i.setBlendFunction(gn,gn),i.setBlendEquation(En));const s=this._getShader(e);zo(i,t,s,void 0,void 0,n)};let s=0,r=!1;const o=this._activeTargets.length;for(let t=0;t<o;t++){const i=this._activeTargets[t],o=i.target[e];o&&(this["morphBlendTex"+s].setValue(o),this._shaderMorphWeights[s]=i.weight,s++,s>=this.maxSubmitCount&&(n(s,r),s=0,r=!0))}(s>0||0===o&&!this.zeroTextures)&&n(s,r)}_updateTextureMorph(){this.device,(this._activeTargets.length>0||!this.zeroTextures)&&(this._updateTextureRenderTarget(this.rtPositions,"texturePositions"),this._updateTextureRenderTarget(this.rtNormals,"textureNormals"),this.zeroTextures=0===this._activeTargets.length)}_updateVertexMorph(){const t=this.maxSubmitCount;for(let e=0;e<t;e++)this._shaderMorphWeights[e]=0,this._activeVertexBuffers[e]=null;let e=0,i=this.morph.morphPositions?4:0;for(let t=0;t<this._activeTargets.length;t++){const n=this._activeTargets[t].target;n._vertexBufferPositions&&(this._activeVertexBuffers[e]=n._vertexBufferPositions,this._shaderMorphWeights[e]=this._activeTargets[t].weight,e++),n._vertexBufferNormals&&(this._activeVertexBuffers[i]=n._vertexBufferNormals,this._shaderMorphWeights[i]=this._activeTargets[t].weight,i++)}}update(){this._dirty=!1;const t=this.morph._targets;let e=0;for(let i=0;i<t.length;i++){const n=Math.abs(this.getWeight(i));if(n>1e-5){this._activeTargets.length<=e&&(this._activeTargets[e]={});const s=this._activeTargets[e++];s.absWeight=n,s.weight=this.getWeight(i),s.target=t[i]}}this._activeTargets.length=e;const i=this.morph.maxActiveTargets;this._activeTargets.length>i&&(this._activeTargets.sort((function(t,e){return t.absWeight<e.absWeight?1:e.absWeight<t.absWeight?-1:0})),this._activeTargets.length=i),this.morph.useTextureMorph?this._updateTextureMorph():this._updateVertexMorph()}}class Uu{constructor(){this.graph=null,this.meshInstances=[],this.skinInstances=[],this.morphInstances=[],this.cameras=[],this.lights=[],this._shadersVersion=0,this._immutable=!1}getGraph(){return this.graph}setGraph(t){this.graph=t}getCameras(){return this.cameras}setCameras(t){this.cameras=t}getLights(){return this.lights}setLights(t){this.lights=t}getMaterials(){const t=[];for(let e=0;e<this.meshInstances.length;e++){const i=this.meshInstances[e];-1===t.indexOf(i.material)&&t.push(i.material)}return t}clone(){const t=[],e=[],i=function i(n){const s=n.clone();t.push(n),e.push(s);for(let t=0;t<n._children.length;t++)s.addChild(i(n._children[t]));return s}(this.graph),n=[],s=[],r=[];for(let t=0;t<this.skinInstances.length;t++){const e=this.skinInstances[t].skin,n=new Vh(e),r=[];for(let t=0;t<e.boneNames.length;t++){const n=e.boneNames[t],s=i.findByName(n);r.push(s)}n.bones=r,s.push(n)}for(let t=0;t<this.morphInstances.length;t++){const e=this.morphInstances[t].morph,i=new Nu(e);r.push(i)}for(let i=0;i<this.meshInstances.length;i++){const o=this.meshInstances[i],a=t.indexOf(o.node),l=new Kh(o.mesh,o.material,e[a]);if(o.skinInstance){const t=this.skinInstances.indexOf(o.skinInstance);l.skinInstance=s[t]}if(o.morphInstance){const t=this.morphInstances.indexOf(o.morphInstance);l.morphInstance=r[t]}n.push(l)}const o=new Uu;return o.graph=i,o.meshInstances=n,o.skinInstances=s,o.morphInstances=r,o.getGraph().syncHierarchy(),o}destroy(){const t=this.meshInstances;for(let e=0;e<t.length;e++)t[e].destroy();this.meshInstances.length=0}generateWireframe(){Kh._prepareRenderStyleForArray(this.meshInstances,ke)}}class Vu extends x{constructor(){super(),this.root=null,this._gravity=new ht(0,-9.8,0),this._layers=null,this._fog=Vt,this.fogColor=new rt(0,0,0),this.fogStart=1,this.fogEnd=1e3,this.fogDensity=0,this.ambientLight=new rt(0,0,0),this._gammaCorrection=Xe,this._toneMapping=0,this.exposure=1,this._skyboxPrefiltered=[null,null,null,null,null,null],this._skyboxCubeMap=null,this.skyboxModel=null,this._skyboxIntensity=1,this._skyboxMip=0,this._skyboxRotation=new yt,this._skyboxRotationMat3=null,this._skyboxRotationMat4=null,this._skyboxIsRenderTarget=!1,this._ambientBake=!1,this._ambientBakeNumSamples=1,this._ambientBakeSpherePart=.4,this.ambientBakeOcclusionContrast=0,this.ambientBakeOcclusionBrightness=0,this.lightmapSizeMultiplier=1,this.lightmapMaxResolution=2048,this.lightmapMode=Ni,this.lightmapFilterEnabled=!1,this._lightmapFilterRange=10,this._lightmapFilterSmoothness=.2,this._stats={meshInstances:0,lights:0,dynamicLights:0,bakedLights:0,lastStaticPrepareFullTime:0,lastStaticPrepareSearchTime:0,lastStaticPrepareWriteTime:0,lastStaticPrepareTriAabbTime:0,lastStaticPrepareCombineTime:0,updateShadersTime:0},this.updateShaders=!0,this.updateSkybox=!0,this._shaderVersion=0,this._statsUpdated=!1,this._models=[],this.defaultMaterial=new wl,this.defaultMaterial.name="Default Material",this.defaultMaterial.shadingModel=Ue}destroy(){this._resetSkyboxModel(),this.root=null,this.defaultMaterial.destroy(),this.defaultMaterial=null,this.off()}get fog(){return this._fog}set fog(t){t!==this._fog&&(this._fog=t,this.updateShaders=!0)}get gammaCorrection(){return this._gammaCorrection}set gammaCorrection(t){t!==this._gammaCorrection&&(this._gammaCorrection=t,this.updateShaders=!0)}get toneMapping(){return this._toneMapping}set toneMapping(t){t!==this._toneMapping&&(this._toneMapping=t,this.updateShaders=!0)}get skybox(){return this._skyboxCubeMap}set skybox(t){this._skyboxCubeMap=t,this._resetSkyboxModel(),this.updateShaders=!0}get skyboxIntensity(){return this._skyboxIntensity}set skyboxIntensity(t){this._skyboxIntensity=t,this._resetSkyboxModel(),this.updateShaders=!0}get ambientBake(){return this._ambientBake}set ambientBake(t){this._ambientBake=t}get ambientBakeNumSamples(){return this._ambientBakeNumSamples}set ambientBakeNumSamples(t){this._ambientBakeNumSamples=Z.clamp(Math.floor(t),1,255)}get ambientBakeSpherePart(){return this._ambientBakeSpherePart}set ambientBakeSpherePart(t){this._ambientBakeSpherePart=Z.clamp(t,.001,1)}get lightmapFilterRange(){return this._lightmapFilterRange}set lightmapFilterRange(t){this._lightmapFilterRange=Math.max(t,.001)}get lightmapFilterSmoothness(){return this._lightmapFilterSmoothness}set lightmapFilterSmoothness(t){this._lightmapFilterSmoothness=Math.max(t,.001)}get skyboxRotation(){return this._skyboxRotation}set skyboxRotation(t){this._skyboxRotation.equals(t)||(this._skyboxRotation.copy(t),this._resetSkyboxModel(),this.updateShaders=!0)}get skyboxMip(){return this._skyboxMip}set skyboxMip(t){this._skyboxMip=t,this._resetSkyboxModel(),this.updateShaders=!0}get skyboxPrefiltered128(){return this._skyboxPrefiltered[0]}set skyboxPrefiltered128(t){this._skyboxPrefiltered[0]!==t&&(this._skyboxPrefiltered[0]=t,this.updateShaders=!0)}get skyboxPrefiltered64(){return this._skyboxPrefiltered[1]}set skyboxPrefiltered64(t){this._skyboxPrefiltered[1]!==t&&(this._skyboxPrefiltered[1]=t,this.updateShaders=!0)}get skyboxPrefiltered32(){return this._skyboxPrefiltered[2]}set skyboxPrefiltered32(t){this._skyboxPrefiltered[2]!==t&&(this._skyboxPrefiltered[2]=t,this.updateShaders=!0)}get skyboxPrefiltered16(){return this._skyboxPrefiltered[3]}set skyboxPrefiltered16(t){this._skyboxPrefiltered[3]!==t&&(this._skyboxPrefiltered[3]=t,this.updateShaders=!0)}get skyboxPrefiltered8(){return this._skyboxPrefiltered[4]}set skyboxPrefiltered8(t){this._skyboxPrefiltered[4]!==t&&(this._skyboxPrefiltered[4]=t,this.updateShaders=!0)}get skyboxPrefiltered4(){return this._skyboxPrefiltered[5]}set skyboxPrefiltered4(t){this._skyboxPrefiltered[5]!==t&&(this._skyboxPrefiltered[5]=t,this.updateShaders=!0)}get drawCalls(){var t=this.layers._meshInstances;return t.length||(this.layers._update(),t=this.layers._meshInstances),t}set drawCalls(t){}get layers(){return this._layers}set layers(t){var e=this._layers;this._layers=t,this.fire("set:layers",e,t)}applySettings(t){this._gravity.set(t.physics.gravity[0],t.physics.gravity[1],t.physics.gravity[2]),this.ambientLight.set(t.render.global_ambient[0],t.render.global_ambient[1],t.render.global_ambient[2]),this._fog=t.render.fog,this.fogColor.set(t.render.fog_color[0],t.render.fog_color[1],t.render.fog_color[2]),this.fogStart=t.render.fog_start,this.fogEnd=t.render.fog_end,this.fogDensity=t.render.fog_density,this._gammaCorrection=t.render.gamma_correction,this._toneMapping=t.render.tonemapping,this.lightmapSizeMultiplier=t.render.lightmapSizeMultiplier,this.lightmapMaxResolution=t.render.lightmapMaxResolution,this.lightmapMode=t.render.lightmapMode,this.exposure=t.render.exposure,this._skyboxIntensity=void 0===t.render.skyboxIntensity?1:t.render.skyboxIntensity,this._skyboxMip=void 0===t.render.skyboxMip?0:t.render.skyboxMip,t.render.skyboxRotation&&this._skyboxRotation.setFromEulerAngles(t.render.skyboxRotation[0],t.render.skyboxRotation[1],t.render.skyboxRotation[2]),this._resetSkyboxModel(),this.updateShaders=!0}_updateSkybox(t){if(this.updateSkybox&&(this.updateSkybox=!1,!this.skyboxModel)){var e=this._skyboxMip?this._skyboxPrefiltered[[0,1,3,4,5,6][this._skyboxMip]]||this._skyboxPrefiltered[0]||this._skyboxCubeMap:this._skyboxCubeMap||this._skyboxPrefiltered[0];if(!e)return;e._isRenderTarget?this._skyboxIsRenderTarget=!0:this._skyboxIsRenderTarget=!1;var i=new pl,n=this;i.updateShader=function(i,s,r,o,a){var l=t.getProgramLibrary().getProgram("skybox",{rgbm:e.type===Vr,hdr:e.type===Vr||e.format===As,useIntensity:1!==n.skyboxIntensity,useCubeMapRotation:!n.skyboxRotation.equals(yt.IDENTITY),useRightHandedCubeMap:n._skyboxIsRenderTarget,mip:e.fixCubemapSeams?n.skyboxMip:0,fixSeams:e.fixCubemapSeams,gamma:a===Ii?n.gammaCorrection?Ke:Xe:n.gammaCorrection,toneMapping:a===Ii?Ze:n.toneMapping});this.shader=l},i.updateShader(),i.setParameter("texture_cubeMap",e),this.skyboxRotation.equals(yt.IDENTITY)||(this._skyboxRotationMat4||(this._skyboxRotationMat4=new bt),this._skyboxRotationMat3||(this._skyboxRotationMat3=new ct),this._skyboxRotationMat4.setTRS(ht.ZERO,this._skyboxRotation,ht.ONE),this._skyboxRotationMat4.invertTo3x3(this._skyboxRotationMat3),i.setParameter("cubeMapRotationMatrix",this._skyboxRotationMat3.data)),i.cull=Yn,i.depthWrite=!1;var s=this.layers.getLayerById($t);if(s){var r=new La("Skybox"),o=kh(t),a=new Kh(o,i,r);a.cull=!1,a._noDepthDrawGl1=!0,a.pick=!1;var l=new Uu;l.graph=r,l.meshInstances=[a],this.skyboxModel=l,s.addMeshInstances(l.meshInstances),this.skyLayer=s,this.fire("set:skybox",e)}}}_resetSkyboxModel(){this.skyboxModel&&(this.skyLayer.removeMeshInstances(this.skyboxModel.meshInstances),this.skyboxModel.destroy()),this.skyboxModel=null,this.updateSkybox=!0}setSkybox(t){var e;t||(t=[null,null,null,null,null,null,null]);var i=!1;if(this._skyboxCubeMap!==t[0]&&(i=!0),!i)for(e=0;e<6&&!i;e++)this._skyboxPrefiltered[e]!==t[e+1]&&(i=!0);if(i){for(e=0;e<6;e++)this._skyboxPrefiltered[e]=t[e+1];this.skybox=t[0]}}addModel(t){if(!this.containsModel(t)){var e=this.layers.getLayerById(Zt);e&&(e.addMeshInstances(t.meshInstances),this._models.push(t))}}addShadowCaster(t){var e=this.layers.getLayerById(Zt);e&&e.addShadowCasters(t.meshInstances)}removeModel(t){var e=this._models.indexOf(t);if(-1!==e){var i=this.layers.getLayerById(Zt);if(!i)return;i.removeMeshInstances(t.meshInstances),this._models.splice(e,1)}}removeShadowCasters(t){var e=this.layers.getLayerById(Zt);e&&e.removeShadowCasters(t.meshInstances)}containsModel(t){return this._models.indexOf(t)>=0}getModels(t){return this._models}}function zu(){return!("undefined"==typeof AudioContext&&"undefined"==typeof webkitAudioContext)}class Wu{constructor(t,e,i={}){if(this.volume=void 0===i.volume?1:i.volume,this.loop=void 0!==i.loop&&i.loop,this.pitch=void 0===i.pitch?1:i.pitch,this.sound=e,this.paused=!1,this.suspended=!1,this.manager=t,this.source=null,zu()){this.startTime=0,this.startOffset=0;const e=t.context;this.gain=e.createGain()}else e.audio&&(this.source=e.audio.cloneNode(!1),this.source.pause())}getVolume(){return this.volume}getLoop(){return this.loop}setLoop(t){this.loop=t,this.source&&(this.source.loop=t)}getPitch(){return this.pitch}onManagerVolumeChange(){this.setVolume(this.getVolume())}onManagerSuspend(){this.isPlaying()&&!this.suspended&&(this.suspended=!0,this.pause())}onManagerResume(){this.suspended&&(this.suspended=!1,this.unpause())}}zu()?Object.assign(Wu.prototype,{play:function(){if(this.source)throw new Error("Call stop() before calling play()");this._createSource(),this.source&&(this.startTime=this.manager.context.currentTime,this.source.start(0,this.startOffset%this.source.buffer.duration),this.setVolume(this.volume),this.setLoop(this.loop),this.setPitch(this.pitch),this.manager.on("volumechange",this.onManagerVolumeChange,this),this.manager.on("suspend",this.onManagerSuspend,this),this.manager.on("resume",this.onManagerResume,this),this.manager.suspended&&this.onManagerSuspend())},pause:function(){this.source&&(this.paused=!0,this.startOffset+=this.manager.context.currentTime-this.startTime,this.source.stop(0),this.source=null)},unpause:function(){!this.source&&this.paused?(this._createSource(),this.source&&(this.startTime=this.manager.context.currentTime,this.source.start(0,this.startOffset%this.source.buffer.duration),this.setVolume(this.volume),this.setLoop(this.loop),this.setPitch(this.pitch),this.paused=!1)):console.warn("Call pause() before unpausing.")},stop:function(){this.source&&(this.source.stop(0),this.source=null),this.manager.off("volumechange",this.onManagerVolumeChange,this),this.manager.off("suspend",this.onManagerSuspend,this),this.manager.off("resume",this.onManagerResume,this)},setVolume:function(t){t=Z.clamp(t,0,1),this.volume=t,this.gain&&(this.gain.gain.value=t*this.manager.volume)},setPitch:function(t){this.pitch=t,this.source&&(this.source.playbackRate.value=t)},isPlaying:function(){return!this.paused&&this.source.playbackState===this.source.PLAYING_STATE},getDuration:function(){return this.source?this.source.buffer.duration:0},_createSource:function(){const t=this.manager.context;this.sound.buffer&&(this.source=t.createBufferSource(),this.source.buffer=this.sound.buffer,this.source.connect(this.gain),this.gain.connect(t.destination),this.loop||(this.source.onended=this.pause.bind(this)))}}):Object.assign(Wu.prototype,{play:function(){this.source&&(this.paused=!1,this.setVolume(this.volume),this.setLoop(this.loop),this.setPitch(this.pitch),this.source.play()),this.manager.on("volumechange",this.onManagerVolumeChange,this),this.manager.on("suspend",this.onManagerSuspend,this),this.manager.on("resume",this.onManagerResume,this),this.manager.suspended&&this.onManagerSuspend()},pause:function(){this.source&&(this.paused=!0,this.source.pause())},unpause:function(){this.source&&(this.paused=!1,this.source.play())},stop:function(){this.source&&this.source.pause(),this.manager.off("volumechange",this.onManagerVolumeChange,this),this.manager.off("suspend",this.onManagerSuspend,this),this.manager.off("resume",this.onManagerResume,this)},setVolume:function(t){t=Z.clamp(t,0,1),this.volume=t,this.source&&(this.source.volume=t*this.manager.volume)},setPitch:function(t){this.pitch=t,this.source&&(this.source.playbackRate=t)},getDuration:function(){return this.source&&!isNaN(this.source.duration)?this.source.duration:0},isPlaying:function(){return!this.source.paused}});const Gu="linear",ju="inverse",Hu="exponential";class Xu extends Wu{constructor(t,e,i){super(t,e,i),this.position=new ht,this.velocity=new ht,zu()?this.panner=t.context.createPanner():(this.maxDistance=1e4,this.minDistance=1,this.rollOffFactor=1,this.distanceModel=ju)}getPosition(){return this.position}getVelocity(){return this.velocity}}if(zu())Object.assign(Xu.prototype,{setPosition:function(t){this.position.copy(t),this.panner.setPosition(t.x,t.y,t.z)},setVelocity:function(t){this.velocity.copy(t),this.panner.setVelocity(t.x,t.y,t.z)},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},getMinDistance:function(){return this.panner.refDistance},setMinDistance:function(t){this.panner.refDistance=t},getRollOffFactor:function(){return this.panner.rolloffFactor},setRollOffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.pannel.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},_createSource:function(){const t=this.manager.context;this.source=t.createBufferSource(),this.source.buffer=this.sound.buffer,this.source.connect(this.panner),this.panner.connect(this.gain),this.gain.connect(t.destination),this.loop||(this.source.onended=this.pause.bind(this))}});else{let t=new ht;const e=function(e,i,n,s,r,o){t=t.sub2(e,i);const a=t.length();if(a<n)return 1;if(a>s)return 0;let l=0;return o===Gu?l=1-r*(a-n)/(s-n):o===ju?l=n/(n+r*(a-n)):o===Hu&&(l=Math.pow(a/n,-r)),Z.clamp(l,0,1)};Object.assign(Xu.prototype,{setPosition:function(t){if(this.position.copy(t),this.source){const t=this.manager.listener.getPosition(),i=e(t,this.position,this.minDistance,this.maxDistance,this.rollOffFactor,this.distanceModel),n=this.getVolume();this.source.volume=n*i}},setVelocity:function(t){this.velocity.copy(t)},getMaxDistance:function(){return this.maxDistance},setMaxDistance:function(t){this.maxDistance=t},getMinDistance:function(){return this.minDistance},setMinDistance:function(t){this.minDistance=t},getRollOffFactor:function(){return this.rollOffFactor},setRollOffFactor:function(t){this.rollOffFactor=t},getDistanceModel:function(){return this.distanceModel},setDistanceModel:function(t){this.distanceModel=t}})}class Yu{constructor(t){this._manager=t,this.position=new ht,this.velocity=new ht,this.orientation=new bt}getPosition(){return this.position}setPosition(t){this.position.copy(t);const e=this.listener;e&&e.setPosition(t.x,t.y,t.z)}getVelocity(){return this.velocity}setVelocity(t){this.velocity.copy(t);const e=this.listener;e&&e.setPosition(t.x,t.y,t.z)}setOrientation(t){this.orientation.copy(t);const e=this.listener;e&&e.setOrientation(-t.data[8],-t.data[9],-t.data[10],t.data[4],t.data[5],t.data[6])}getOrientation(){return this.orientation}get listener(){const t=this._manager.context;return t?t.listener:null}}class qu extends x{constructor(t){super(),this._context=null,this._forceWebAudioApi=t.forceWebAudioApi,this._resumeContext=null,this._unlock=null,zu()||this._forceWebAudioApi?(this._resumeContext=()=>{window.removeEventListener("mousedown",this._resumeContext),window.removeEventListener("touchend",this._resumeContext),this.context&&this.context.resume()},window.addEventListener("mousedown",this._resumeContext),window.addEventListener("touchend",this._resumeContext),B.ios&&(this._unlock=()=>{window.removeEventListener("touchend",this._unlock);const t=this.context;if(t){const e=t.createBuffer(1,1,44100),i=t.createBufferSource();i.buffer=e,i.connect(t.destination),i.start(0),i.disconnect()}},window.addEventListener("touchend",this._unlock))):console.warn("No support for 3D audio found"),this.listener=new Yu(this),this._volume=1,this.suspended=!1}suspend(){this.suspended=!0,this.fire("suspend")}resume(){const t=()=>{this.suspended=!1,this.fire("resume")};!zu()&&!this._forceWebAudioApi||"interrupted"!==this.context.state&&"suspended"!==this.context.state?t():this.context.resume().then(t)}destroy(){this._resumeContext&&(window.removeEventListener("mousedown",this._resumeContext),window.removeEventListener("touchend",this._resumeContext)),this._unlock&&window.removeEventListener("touchend",this._unlock),this.fire("destroy"),this._context&&this._context.close&&(this._context.close(),this._context=null)}playSound(t,e={}){let i=null;return Wu&&(i=new Wu(this,t,e),i.play()),i}playSound3d(t,e,i={}){let n=null;return Xu&&(n=new Xu(this,t,i),n.setPosition(e),i.volume&&n.setVolume(i.volume),i.loop&&n.setLoop(i.loop),i.maxDistance&&n.setMaxDistance(i.maxDistance),i.minDistance&&n.setMinDistance(i.minDistance),i.rollOffFactor&&n.setRollOffFactor(i.rollOffFactor),i.distanceModel&&n.setDistanceModel(i.distanceModel),n.play()),n}get volume(){return this._volume}set volume(t){t=Z.clamp(t,0,1),this._volume=t,this.fire("volumechange",t)}get context(){return this._context||(zu()||this._forceWebAudioApi)&&("undefined"!=typeof AudioContext?this._context=new AudioContext:"undefined"!=typeof webkitAudioContext&&(this._context=new webkitAudioContext)),this._context}}class Ku{constructor(t,e,i,n){this.time=t,this.position=e,this.rotation=i,this.scale=n}}class Zu{constructor(){this._name="",this._keys=[]}}class Qu{constructor(){this.name="",this.duration=0,this._nodes=[],this._nodeDict={}}getNode(t){return this._nodeDict[t]}get nodes(){return this._nodes}addNode(t){this._nodes.push(t),this._nodeDict[t._name]=t}}class $u{constructor(t){2===arguments.length&&(t=arguments[1]),this.options=t,this._name=t.name,this._defaultWeight=t.defaultWeight||0,this.aabb=t.aabb,this.aabb||(this.aabb=new Tt,t.deltaPositions&&this.aabb.compute(t.deltaPositions)),this.deltaPositions=t.deltaPositions}get name(){return this._name}get defaultWeight(){return this._defaultWeight}get morphPositions(){return!!this._vertexBufferPositions||!!this.texturePositions}get morphNormals(){return!!this._vertexBufferNormals||!!this.textureNormals}_postInit(){this.options=null}_initVertexBuffers(t){const e=this.options;this._vertexBufferPositions=this._createVertexBuffer(t,e.deltaPositions,e.deltaPositionsType),this._vertexBufferNormals=this._createVertexBuffer(t,e.deltaNormals,e.deltaNormalsType),this._vertexBufferPositions&&(this.deltaPositions=this._vertexBufferPositions.lock())}_createVertexBuffer(t,e,i=no){if(e){return new Fo(t,new No(t,[{semantic:ur,components:3,type:i}]),e.length/3,Ln,e)}return null}_setTexture(t,e){this[t]=e}destroy(){this._vertexBufferPositions&&(this._vertexBufferPositions.destroy(),this._vertexBufferPositions=null),this._vertexBufferNormals&&(this._vertexBufferNormals.destroy(),this._vertexBufferNormals=null),this.texturePositions&&(this.texturePositions.destroy(),this.texturePositions=null),this.textureNormals&&(this.textureNormals.destroy(),this.textureNormals=null)}}class Ju{constructor(t,e,i){this.device=t,this.inverseBindPose=e,this.boneNames=i}}class td extends x{constructor(){super(),this._meshes=null}destroy(){this.meshes=null}decRefMeshes(){if(this._meshes){const t=this._meshes.length;for(let e=0;e<t;e++){const t=this._meshes[e];t&&(t.decRefCount(),t.getRefCount()<1&&(t.destroy(),this._meshes[e]=null))}}}incRefMeshes(){if(this._meshes){const t=this._meshes.length;for(let e=0;e<t;e++)this._meshes[e]&&this._meshes[e].incRefCount()}}get meshes(){return this._meshes}set meshes(t){this.decRefMeshes(),this._meshes=t,this.incRefMeshes(),this.fire("set:meshes",t)}}class ed{constructor(t,e,i,n){this._paths=t,this._input=e,this._output=i,this._interpolation=n}get paths(){return this._paths}get input(){return this._input}get output(){return this._output}get interpolation(){return this._interpolation}}class id{constructor(t,e){this._components=t,this._data=e}get components(){return this._components}get data(){return this._data}}class nd{constructor(t){this._events=[...t],this._events.sort((t,e)=>t.time-e.time)}get events(){return this._events}}class sd{constructor(t,e,i,n,s,r=new nd([])){this._name=t,this._duration=e,this._inputs=i,this._outputs=n,this._curves=s,this._animEvents=r}get name(){return this._name}get duration(){return this._duration}get inputs(){return this._inputs}get outputs(){return this._outputs}get curves(){return this._curves}get events(){return this._animEvents.events}set events(t){this._animEvents=t}eval(t,e){e._time=t;var i,n=this._inputs,s=this._outputs,r=this._curves,o=e._cache,a=e._results;for(i=0;i<n.length;++i)o[i].update(t,n[i]._data);for(i=0;i<r.length;++i){var l=r[i],h=s[l._output],c=a[i];o[l._input].eval(c,l._interpolation,h)}}}class rd{static joinPath(t,e){e=e||".";return t.map((function(t){return t.replace(/\\/g,"\\\\").replace(new RegExp("\\"+e,"g"),"\\"+e)})).join(e)}static splitPath(t,e){e=e||".";for(var i=[],n="",s=0;s<t.length;){var r=t[s++];"\\"===r&&s<t.length?n+="\\"===(r=t[s++])||r===e?r:"\\"+r:r===e?(i.push(n),n=""):n+=r}return n.length>0&&i.push(n),i}static encode(t,e,i){return`${Array.isArray(t)?t.join("/"):t}/${e}/${Array.isArray(i)?i.join("/"):i}`}resolve(t){return null}unresolve(t){}update(t){}}const od=0,ad=1,ld=2,hd={en:"en-US",es:"en-ES",zh:"zh-CN","zh-HK":"zh-TW","zh-TW":"zh-HK","zh-MO":"zh-HK",fr:"fr-FR",de:"de-DE",it:"it-IT",ru:"ru-RU",ja:"ja-JP"};var cd={};function _d(t,e){for(var i=0,n=t.length;i<n;i++)cd[t[i]]=e}function ud(t){var e=t.indexOf("-");return-1!==e?t.substring(0,e):t}function dd(t,e){if(e[t])return t;var i=hd[t];if(i&&e[i])return i;var n=ud(t);return e[i=hd[n]]?i:e[n]?n:"en-US"}_d(["ja","ko","th","vi","zh","id"],(function(t){return 0})),_d(["fa","hi"],(function(t){return t>=0&&t<=1?0:1})),_d(["fr","pt"],(function(t){return t>=0&&t<2?0:1})),_d(["da"],(function(t){return 1===t||!Number.isInteger(t)&&t>=0&&t<=1?0:1})),_d(["de","en","it","el","es","tr","fi","sv","nb","no","ur"],(function(t){return 1===t?0:1})),_d(["ru","uk"],(function(t){if(Number.isInteger(t)){var e=t%10,i=t%100;if(1===e&&11!==i)return 0;if(e>=2&&e<=4&&(i<12||i>14))return 1;if(0===e||e>=5&&e<=9||i>=11&&i<=14)return 2}return 3})),_d(["pl"],(function(t){if(Number.isInteger(t)){if(1===t)return 0;var e=t%10,i=t%100;if(e>=2&&e<=4&&(i<12||i>14))return 1;if(e>=0&&e<=1||e>=5&&e<=9||i>=12&&i<=14)return 2}return 3})),_d(["ar"],(function(t){if(0===t)return 0;if(1===t)return 1;if(2===t)return 2;if(Number.isInteger(t)){var e=t%100;if(e>=3&&e<=10)return 3;if(e>=11&&e<=99)return 4}return 5}));var pd=cd[ud("en-US")];function fd(t){return cd[t]||pd}const md=new RegExp("^\\s*(?:(?:[a-z]+[a-z0-9\\-\\+\\.]*:)?//|data:|blob:)","i"),gd="animation",bd="audio",yd="image",vd="json",Sd="model",xd="material",wd="text",Cd="texture",Td="cubemap",Ad="shader",Ed="css",Md="html",Rd="script",Id="container";class Pd{constructor(t,e,i,n,s,r){this.url=t||"",this.filename=e||"",this.hash=void 0===i?null:i,this.size=void 0===n?null:n,this.opt=void 0===s?null:s,this.contents=r||null}equals(t){return this.url===t.url&&this.filename===t.filename&&this.hash===t.hash&&this.size===t.size&&this.opt===t.opt&&this.contents===t.contents}}var Ld=-1;const Dd={pvr:"extCompressedTexturePVRTC",dxt:"extCompressedTextureS3TC",etc2:"extCompressedTextureETC",etc1:"extCompressedTextureETC1",basis:"canvas"},kd=["pvr","dxt","etc2","etc1","basis"];class Od extends x{constructor(t,e,i,n,s){super(),this._id=Ld--,this.name=t||"",this.type=e,this.tags=new j(this),this._preload=!1,this._file=null,this._data=n||{},this.options=s||{},this._resources=[],this._i18n={},this.loaded=!1,this.loading=!1,this.registry=null,i&&(this.file=i)}getFileUrl(){var t=this.file;if(!t||!t.url)return null;var e=t.url;if(this.registry&&this.registry.prefix&&!md.test(e)&&(e=this.registry.prefix+e),"script"!==this.type&&t.hash){var i=-1!==e.indexOf("?")?"&":"?";e+=i+"t="+t.hash}return e}getAbsoluteUrl(t){if(t.startsWith("blob:")||t.startsWith("data:"))return t;var e=T.getDirectory(this.file.url);return T.join(e,t)}getLocalizedAssetId(t){return t=dd(t,this._i18n),this._i18n[t]||null}addLocalizedAssetId(t,e){this._i18n[t]=e,this.fire("add:localized",t,e)}removeLocalizedAssetId(t){var e=this._i18n[t];e&&(delete this._i18n[t],this.fire("remove:localized",t,e))}ready(t,e){e=e||this,this.resource?t.call(e,this):this.once("load",(function(i){t.call(e,i)}))}reload(){this.loaded&&(this.loaded=!1,this.registry.load(this))}unload(){if(this.loaded||0!==this._resources.length){this.fire("unload",this),this.registry.fire("unload:"+this.id,this);var t=this._resources;this.resources=[],this.loaded=!1,this.file&&this.registry._loader.clearCache(this.getFileUrl(),this.type);for(var e=0;e<t.length;++e){var i=t[e];i&&i.destroy&&i.destroy()}}}get id(){return this._id}set id(t){this._id=t}get file(){return this._file}set file(t){if(t&&t.variants&&-1!==["texture","textureatlas","bundle"].indexOf(this.type)){var e,i;const n=(null==(e=this.registry)||null==(i=e._loader)?void 0:i._app)||Ka(),s=null==n?void 0:n.graphicsDevice;if(s)for(let e=0,i=kd.length;e<i;e++){const i=kd[e];if(t.variants[i]&&s[Dd[i]]){t=t.variants[i];break}if(n.enableBundles){const t=n.bundles.listBundlesForAsset(this);if(t&&t.find(t=>{var e;return null==t||null==(e=t.file)?void 0:e.variants[i]}))break}}}const n=this._file,s=t?new Pd(t.url,t.filename,t.hash,t.size,t.opt,t.contents):null;(!!s!=!!n||s&&!s.equals(n))&&(this._file=s,this.fire("change",this,"file",s,n),this.reload())}get data(){return this._data}set data(t){var e=this._data;this._data=t,t!==e&&(this.fire("change",this,"data",t,e),this.loaded&&this.registry._loader.patch(this,this.registry))}get resource(){return this._resources[0]}set resource(t){var e=this._resources[0];this._resources[0]=t,this.fire("change",this,"resource",t,e)}get resources(){return this._resources}set resources(t){var e=this._resources;this._resources=t,this.fire("change",this,"resources",t,e)}get preload(){return this._preload}set preload(t){t=!!t,this._preload!==t&&(this._preload=t,this._preload&&!this.loaded&&!this.loading&&this.registry&&this.registry.load(this))}get loadFaces(){return this._loadFaces}set loadFaces(t){t=!!t,this.hasOwnProperty("_loadFaces")&&t===this._loadFaces||(this._loadFaces=t,this.loaded&&this.registry._loader.patch(this,this.registry))}static fetchArrayBuffer(t,e,i,n=0){var s;null!=i&&null!=(s=i.file)&&s.contents?setTimeout(()=>{e(null,i.file.contents)}):$.get(t,{cache:!0,responseType:"arraybuffer",retry:n>0,maxRetries:n},e)}}class Fd{constructor(t){this.gltf=t,this.nodes=null,this.scenes=null,this.animations=null,this.textures=null,this.materials=null,this.renders=null,this.skins=null,this.lights=null,this.cameras=null}destroy(){this.renders&&this.renders.forEach(t=>{t.meshes=null})}}const Bd=function(t){return/^data:.*,.*$/i.test(t)},Nd=function(t){switch(t){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16;default:return 3}},Ud=function(t){switch(t){case 5120:return Qr;case 5121:return $r;case 5122:return Jr;case 5123:return to;case 5124:return eo;case 5125:return io;case 5126:return no;default:return 0}},Vd=function(t){switch(t){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5124:case 5125:case 5126:return 4;default:return 0}},zd={POSITION:Zs,NORMAL:Qs,TANGENT:$s,COLOR_0:er,JOINTS_0:tr,WEIGHTS_0:Js,TEXCOORD_0:nr,TEXCOORD_1:sr,TEXCOORD_2:rr,TEXCOORD_3:or,TEXCOORD_4:ar,TEXCOORD_5:lr,TEXCOORD_6:hr,TEXCOORD_7:cr},Wd=function(t,e,i){const n=(t=>{switch(t){case Qr:return t=>Math.max(t/127,-1);case $r:return t=>t/255;case Jr:return t=>Math.max(t/32767,-1);case to:return t=>t/65535;default:return t=>t}})(i),s=e.length;for(let i=0;i<s;++i)t[i]=n(e[i]);return t},Gd=function t(e,i,n=!1){const s=Nd(e.type),r=function(t){switch(t){case 5120:return Int8Array;case 5121:return Uint8Array;case 5122:return Int16Array;case 5123:return Uint16Array;case 5124:return Int32Array;case 5125:return Uint32Array;case 5126:return Float32Array;default:return null}}(e.componentType);if(!r)return null;const o=i[e.bufferView];let a;if(e.sparse){const n=e.sparse,o={count:n.count,type:"SCALAR"},l=t(Object.assign(o,n.indices),i,!0),h={count:n.count,type:e.scalar,componentType:e.componentType},c=t(Object.assign(h,n.values),i,!0);if(e.hasOwnProperty("bufferView")){a=t({bufferView:e.bufferView,byteOffset:e.byteOffset,componentType:e.componentType,count:e.count,type:e.type},i,!0).slice()}else a=new r(e.count*s);for(let t=0;t<n.count;++t){const e=l[t];for(let i=0;i<s;++i)a[e*s+i]=c[t*s+i]}}else if(n&&o.hasOwnProperty("byteStride")){const t=s*r.BYTES_PER_ELEMENT,i=new ArrayBuffer(e.count*t),n=new Uint8Array(i);let l=0;for(let i=0;i<e.count;++i){let s=(e.byteOffset||0)+i*o.byteStride;for(let e=0;e<t;++e)n[l++]=o[s++]}a=new r(i)}else a=new r(o.buffer,o.byteOffset+(e.byteOffset||0),e.count*s);return a},jd=function(t,e){const i=Gd(t,e,!0);if(i instanceof Float32Array||!t.normalized)return i;const n=new Float32Array(i.length);return Wd(n,i,Ud(t.componentType)),n},Hd=function(t){let e=t.min,i=t.max;if(!e||!i)return null;if(t.normalized){const n=Ud(t.componentType);e=Wd([],e,n),i=Wd([],i,n)}return new Tt(new ht(.5*(i[0]+e[0]),.5*(i[1]+e[1]),.5*(i[2]+e[2])),new ht(.5*(i[0]-e[0]),.5*(i[1]-e[1]),.5*(i[2]-e[2])))},Xd=function(t,e){const i=t[Zs];if(!i||3!==i.components)return;let n;if(i.size!==i.stride){const t=i.stride/Io[i.type],e=new Ro[i.type](i.buffer,i.offset,i.count*t);n=new Ro[i.type](3*i.count);for(let s=0;s<i.count;++s)n[3*s+0]=e[s*t+0],n[3*s+1]=e[s*t+1],n[3*s+2]=e[s*t+2]}else n=new Ro[i.type](i.buffer,i.offset,3*i.count);const s=i.count;e||(e=function(t){const e=new Uint16Array(t);for(let i=0;i<t;i++)e[i]=i;return e}(s));const r=Ch(n,e),o=new Float32Array(r.length);o.set(r),t[Qs]={buffer:o.buffer,size:12,offset:0,stride:12,count:s,components:3,type:no}},Yd=function(t){const e=new Od(t.name+"_clone",t.type,t.file,t.data,t.options);return e.loaded=!0,e.resource=function(t){const e=new _a(t.device,t);return e._levels=function(t){const e=[];for(let i=0;i<t._levels.length;++i){let n=[];if(t.cubemap)for(let e=0;e<6;++e)n.push(t._levels[i][e]);else n=t._levels[i];e.push(n)}return e}(t),e}(t.resource),t.registry.add(e),e},qd=function(t,e,i){const n=e[Zs];if(!n)return null;const s=n.count,r=[];for(const t in e)e.hasOwnProperty(t)&&r.push({semantic:t,components:e[t].components,type:e[t].type,normalize:!!e[t].normalize});const o=[Zs,Qs,$s,er,tr,Js,nr,sr];let a,l,h,c,_,u;r.sort((function(t,e){const i=o.indexOf(t.semantic),n=o.indexOf(e.semantic);return i<n?-1:n<i?1:0}));const d=new No(t,r);let p=!0;for(a=0;a<d.elements.length;++a)if(_=d.elements[a],c=e[_.name],u=c.offset-n.offset,c.buffer!==n.buffer||c.stride!==_.stride||c.size!==_.size||u!==_.offset){p=!1;break}const f=new Fo(t,d,s,Ln),m=f.lock(),g=new Uint32Array(m);let b;if(p)b=new Uint32Array(n.buffer,n.offset,s*f.format.size/4),g.set(b);else{let t,i;for(a=0;a<f.format.elements.length;++a){_=f.format.elements[a],t=_.stride/4,c=e[_.name],i=c.stride/4,b=new Uint32Array(c.buffer,c.offset,(c.count-1)*i+(c.size+3)/4);let n=0,r=_.offset/4;const o=Math.floor((c.size+3)/4);for(l=0;l<s;++l){for(h=0;h<o;++h)g[r+h]=b[n+h];n+=i,r+=t}}}return i&&function(t){let e,i;const n=[],s=[],r=[];for(e=0;e<t.format.elements.length;++e){const i=t.format.elements[e];if(i.name===nr||i.name===sr)switch(i.dataType){case no:n.push({offset:i.offset/4+1,stride:i.stride/4});break;case to:s.push({offset:i.offset/2+1,stride:i.stride/2});break;case $r:r.push({offset:i.offset+1,stride:i.stride})}}const o=function(n,s,r){const o=new s(t.storage);for(e=0;e<n.length;++e){let s=n[e].offset;const a=n[e].stride;for(i=0;i<t.numVertices;++i)o[s]=r-o[s],s+=a}};n.length>0&&o(n,Float32Array,1),s.length>0&&o(s,Uint16Array,65535),r.length>0&&o(r,Uint8Array,255)}(f),f.unlock(),f},Kd=new bt,Zd=new ht,Qd=function(t,e,i,n,s,r,o){const a=[];return e.primitives.forEach((function(l){let h,c,_,u=null,d=!0;if(l.hasOwnProperty("extensions")){const e=l.extensions;if(e.hasOwnProperty("KHR_draco_mesh_compression")){const i=window.DracoDecoderModule;if(i){const o=e.KHR_draco_mesh_compression;if(o.hasOwnProperty("attributes")){const e=n[o.bufferView],a=new i.DecoderBuffer;a.Init(e,e.length);const l=new i.Decoder,p=l.GetEncodedGeometryType(a);let f,m;switch(p){case i.POINT_CLOUD:h=Gs,f=new i.PointCloud,m=l.DecodeBufferToPointCloud(a,f);break;case i.TRIANGULAR_MESH:h=Ys,f=new i.Mesh,m=l.DecodeBufferToMesh(a,f);break;case i.INVALID_GEOMETRY_TYPE:}if(!m||!m.ok()||0==f.ptr)return void s("Failed to decode draco compressed asset: "+(m?m.error_msg():"Mesh asset - invalid draco compressed geometry type: "+p));const g=f.num_faces();if(p===i.TRIANGULAR_MESH){const t=f.num_points()>65535;_=3*g;const e=_*(t?4:2),n=i._malloc(e);t?(l.GetTrianglesUInt32Array(f,e,n),u=new Uint32Array(i.HEAPU32.buffer,n,_).slice()):(l.GetTrianglesUInt16Array(f,e,n),u=new Uint16Array(i.HEAPU16.buffer,n,_).slice()),i._free(n)}c=function(t,e,i,n,s,r,o){const a=e.num_points(),l=function(t){const i=n.GetAttributeByUniqueId(e,t),r=a*i.num_components();let o,l,h,c;switch(i.data_type()){case s.DT_UINT8:c=$r,h=1,o=s._malloc(r*h),n.GetAttributeDataArrayForAllPoints(e,i,s.DT_UINT8,r*h,o),l=new Uint8Array(s.HEAPU8.buffer,o,r).slice();break;case s.DT_UINT16:c=to,h=2,o=s._malloc(r*h),n.GetAttributeDataArrayForAllPoints(e,i,s.DT_UINT16,r*h,o),l=new Uint16Array(s.HEAPU16.buffer,o,r).slice();break;case s.DT_FLOAT32:default:c=no,h=4,o=s._malloc(r*h),n.GetAttributeDataArrayForAllPoints(e,i,s.DT_FLOAT32,r*h,o),l=new Float32Array(s.HEAPF32.buffer,o,r).slice()}return s._free(o),{values:l,numComponents:i.num_components(),componentSizeInBytes:h,storageType:c,normalized:i.normalized()}},h={},c=i.attributes;for(const t in c)if(c.hasOwnProperty(t)&&zd.hasOwnProperty(t)){const e=zd[t],i=l(c[t]),n=i.numComponents*i.componentSizeInBytes;h[e]={values:i.values,buffer:i.values.buffer,size:n,offset:0,stride:n,count:a,components:i.numComponents,type:i.storageType,normalize:i.normalized}}return h.hasOwnProperty(Qs)||Xd(h,r),qd(t,h,o)}(t,f,o,l,i,u,r),i.destroy(f),i.destroy(l),i.destroy(a),d=!1}}}}c||(u=l.hasOwnProperty("indices")?Gd(i[l.indices],n,!0):null,c=function(t,e,i,n,s,r,o){const a={},l=[];for(const t in e)e.hasOwnProperty(t)&&zd.hasOwnProperty(t)&&(a[t]=e[t],l.push(t+":"+e[t]));l.sort();const h=l.join();let c=o[h];if(!c){const l={};for(const t in a){const i=n[e[t]],r=Gd(i,s),o=s[i.bufferView],a=zd[t],h=Nd(i.type)*Vd(i.componentType),c=o.hasOwnProperty("byteStride")?o.byteStride:h;l[a]={buffer:r.buffer,size:h,offset:r.byteOffset,stride:c,count:i.count,components:Nd(i.type),type:Ud(i.componentType),normalize:i.normalized}}l.hasOwnProperty(Qs)||Xd(l,i),c=qd(t,l,r),o[h]=c}return c}(t,l.attributes,u,i,n,r,o),h=function(t){if(!t.hasOwnProperty("mode"))return Ys;switch(t.mode){case 0:return Gs;case 1:return js;case 2:return Hs;case 3:return Xs;case 4:return Ys;case 5:return qs;case 6:return Ks;default:return Ys}}(l));let p=null;if(c){if(p=new xh(t),p.vertexBuffer=c,p.primitive[0].type=h,p.primitive[0].base=0,p.primitive[0].indexed=null!==u,null!==u){let e;e=u instanceof Uint8Array?hs:u instanceof Uint16Array?cs:_s,e!==_s||t.extUintElement||(e=cs,u=new Uint16Array(u));const i=new $l(t,e,u.length,Ln,u);p.indexBuffer[0]=i,p.primitive[0].count=u.length}else p.primitive[0].count=c.numVertices;p.materialIndex=l.material;let s=i[l.attributes.POSITION];if(p.aabb=Hd(s),d&&l.hasOwnProperty("targets")){const r=[];l.targets.forEach((function(t,o){const a={};t.hasOwnProperty("POSITION")&&(s=i[t.POSITION],a.deltaPositions=jd(s,n),a.deltaPositionsType=no,a.aabb=Hd(s)),t.hasOwnProperty("NORMAL")&&(s=i[t.NORMAL],a.deltaNormals=jd(s,n),a.deltaNormalsType=no),e.hasOwnProperty("extras")&&e.extras.hasOwnProperty("targetNames")?a.name=e.extras.targetNames[o]:a.name=o.toString(10),e.hasOwnProperty("weights")&&(a.defaultWeight=e.weights[o]),r.push(new $u(a))})),p.morph=new Bu(r,t)}}a.push(p)})),a},$d=function(t,e,i){const n=["#ifdef MAPFLOAT","uniform float material_shininess;","#endif","","#ifdef MAPTEXTURE","uniform sampler2D texture_glossMap;","#endif","","void getGlossiness() {","\t\tdGlossiness = 1.0;","","#ifdef MAPFLOAT","\t\tdGlossiness *= material_shininess;","#endif","","#ifdef MAPTEXTURE","\t\tdGlossiness *= texture2D(texture_glossMap, $UV).$CH;","#endif","","#ifdef MAPVERTEX","\t\tdGlossiness *= saturate(vVertexColor.$VC);","#endif","","\t\tdGlossiness = 1.0 - dGlossiness;","","\t\tdGlossiness += 0.0000001;","}"].join("\n"),s=["#ifdef MAPCOLOR","uniform vec3 material_specular;","#endif","","#ifdef MAPTEXTURE","uniform sampler2D texture_specularMap;","#endif","","void getSpecularity() {","\t\tdSpecularity = vec3(1.0);","","\t\t#ifdef MAPCOLOR","\t\t\t\tdSpecularity *= material_specular;","\t\t#endif","","\t\t#ifdef MAPTEXTURE","\t\t\t\tvec3 srgb = texture2D(texture_specularMap, $UV).$CH;","\t\t\t\tdSpecularity *= vec3(pow(srgb.r, 2.2), pow(srgb.g, 2.2), pow(srgb.b, 2.2));","\t\t#endif","","\t\t#ifdef MAPVERTEX","\t\t\t\tdSpecularity *= saturate(vVertexColor.$VC);","\t\t#endif","}"].join("\n"),r=["#ifdef MAPFLOAT","uniform float material_clearCoatGlossiness;","#endif","","#ifdef MAPTEXTURE","uniform sampler2D texture_clearCoatGlossMap;","#endif","","void getClearCoatGlossiness() {","\t\tccGlossiness = 1.0;","","#ifdef MAPFLOAT","\t\tccGlossiness *= material_clearCoatGlossiness;","#endif","","#ifdef MAPTEXTURE","\t\tccGlossiness *= texture2D(texture_clearCoatGlossMap, $UV).$CH;","#endif","","#ifdef MAPVERTEX","\t\tccGlossiness *= saturate(vVertexColor.$VC);","#endif","","\t\tccGlossiness = 1.0 - ccGlossiness;","","\t\tccGlossiness += 0.0000001;","}"].join("\n"),o=[0,0],a=[1,1],l=function(t,e,i){var n;let s;const r=t.texCoord;if(r)for(s=0;s<i.length;++s)e[i[s]+"MapUv"]=r;const l=null==(n=t.extensions)?void 0:n.KHR_texture_transform;if(l){const t=l.offset||o,n=l.scale||a,r=l.rotation?-l.rotation*Z.RAD_TO_DEG:0,h=new _t(n[0],n[1]),c=new _t(t[0],1-n[1]-t[1]);for(s=0;s<i.length;++s)e[i[s]+"MapTiling"]=h,e[i[s]+"MapOffset"]=c,e[i[s]+"MapRotation"]=r}},h=new wl;let c,_;if(h.occludeSpecular=!0,h.diffuseTint=!0,h.diffuseVertexColor=!0,h.specularTint=!0,h.specularVertexColor=!0,t.hasOwnProperty("name")&&(h.name=t.name),t.hasOwnProperty("extensions")&&t.extensions.hasOwnProperty("KHR_materials_pbrSpecularGlossiness")){const i=t.extensions.KHR_materials_pbrSpecularGlossiness;if(i.hasOwnProperty("diffuseFactor")?(c=i.diffuseFactor,h.diffuse.set(Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)),h.opacity=c[3]):(h.diffuse.set(1,1,1),h.opacity=1),i.hasOwnProperty("diffuseTexture")){const t=i.diffuseTexture;_=e[t.index],h.diffuseMap=_,h.diffuseMapChannel="rgb",h.opacityMap=_,h.opacityMapChannel="a",l(t,h,["diffuse","opacity"])}if(h.useMetalness=!1,i.hasOwnProperty("specularFactor")?(c=i.specularFactor,h.specular.set(Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2))):h.specular.set(1,1,1),i.hasOwnProperty("glossinessFactor")?h.shininess=100*i.glossinessFactor:h.shininess=100,i.hasOwnProperty("specularGlossinessTexture")){const t=i.specularGlossinessTexture;h.specularMap=h.glossMap=e[t.index],h.specularMapChannel="rgb",h.glossMapChannel="a",l(t,h,["gloss","metalness"])}h.chunks.specularPS=s}else if(t.hasOwnProperty("pbrMetallicRoughness")){const i=t.pbrMetallicRoughness;if(i.hasOwnProperty("baseColorFactor")?(c=i.baseColorFactor,h.diffuse.set(Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)),h.opacity=c[3]):(h.diffuse.set(1,1,1),h.opacity=1),i.hasOwnProperty("baseColorTexture")){const t=i.baseColorTexture;_=e[t.index],h.diffuseMap=_,h.diffuseMapChannel="rgb",h.opacityMap=_,h.opacityMapChannel="a",l(t,h,["diffuse","opacity"])}if(h.useMetalness=!0,i.hasOwnProperty("metallicFactor")?h.metalness=i.metallicFactor:h.metalness=1,i.hasOwnProperty("roughnessFactor")?h.shininess=100*i.roughnessFactor:h.shininess=100,i.hasOwnProperty("metallicRoughnessTexture")){const t=i.metallicRoughnessTexture;h.metalnessMap=h.glossMap=e[t.index],h.metalnessMapChannel="b",h.glossMapChannel="g",l(t,h,["gloss","metalness"])}h.chunks.glossPS=n}if(t.hasOwnProperty("normalTexture")){const i=t.normalTexture;h.normalMap=e[i.index],l(i,h,["normal"]),i.hasOwnProperty("scale")&&(h.bumpiness=i.scale)}if(t.hasOwnProperty("occlusionTexture")){const i=t.occlusionTexture;h.aoMap=e[i.index],h.aoMapChannel="r",l(i,h,["ao"])}if(t.hasOwnProperty("emissiveFactor")?(c=t.emissiveFactor,h.emissive.set(Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)),h.emissiveTint=!0):(h.emissive.set(0,0,0),h.emissiveTint=!1),t.hasOwnProperty("emissiveTexture")){const i=t.emissiveTexture;h.emissiveMap=e[i.index],l(i,h,["emissive"])}if(t.hasOwnProperty("alphaMode"))switch(t.alphaMode){case"MASK":h.blendType=Lt,t.hasOwnProperty("alphaCutoff")?h.alphaTest=t.alphaCutoff:h.alphaTest=.5;break;case"BLEND":h.blendType=Pt;break;default:case"OPAQUE":h.blendType=Lt}else h.blendType=Lt;if(t.hasOwnProperty("doubleSided")?(h.twoSidedLighting=t.doubleSided,h.cull=t.doubleSided?Hn:Xn):(h.twoSidedLighting=!1,h.cull=Xn),t.hasOwnProperty("extensions")&&t.extensions.hasOwnProperty("KHR_materials_clearcoat")){const i=t.extensions.KHR_materials_clearcoat;if(i.hasOwnProperty("clearcoatFactor")?h.clearCoat=.25*i.clearcoatFactor:h.clearCoat=0,i.hasOwnProperty("clearcoatTexture")){const t=i.clearcoatTexture;h.clearCoatMap=e[t.index],h.clearCoatMapChannel="r",l(t,h,["clearCoat"])}if(i.hasOwnProperty("clearcoatRoughnessFactor")?h.clearCoatGlossiness=i.clearcoatRoughnessFactor:h.clearCoatGlossiness=0,i.hasOwnProperty("clearcoatRoughnessTexture")){const t=i.clearcoatRoughnessTexture;h.clearCoatGlossMap=e[t.index],h.clearCoatGlossMapChannel="g",l(t,h,["clearCoatGloss"])}if(i.hasOwnProperty("clearcoatNormalTexture")){const t=i.clearcoatNormalTexture;h.clearCoatNormalMap=e[t.index],l(t,h,["clearCoatNormal"]),t.hasOwnProperty("scale")&&(h.clearCoatBumpiness=t.scale)}h.chunks.clearCoatGlossPS=r}return t.hasOwnProperty("extensions")&&t.extensions.hasOwnProperty("KHR_materials_unlit")&&(h.useLighting=!1,h.emissive.copy(h.diffuse),h.emissiveTint=h.diffuseTint,h.emissiveMap=h.diffuseMap,h.emissiveMapUv=h.diffuseMapUv,h.emissiveMapTiling.copy(h.diffuseMapTiling),h.emissiveMapOffset.copy(h.diffuseMapOffset),h.emissiveMapChannel=h.diffuseMapChannel,h.emissiveVertexColor=h.diffuseVertexColor,h.emissiveVertexColorChannel=h.diffuseVertexColorChannel,h.diffuse.set(0,0,0),h.diffuseTint=!1,h.diffuseMap=null,h.diffuseVertexColor=!1),h.update(),h},Jd=function(t,e){const i=new La;if(t.hasOwnProperty("name")&&t.name.length>0?i.name=t.name:i.name="node_"+e,t.hasOwnProperty("matrix")&&(Kd.data.set(t.matrix),Kd.getTranslation(Zd),i.setLocalPosition(Zd),Kd.getEulerAngles(Zd),i.setLocalEulerAngles(Zd),Kd.getScale(Zd),i.setLocalScale(Zd)),t.hasOwnProperty("rotation")){const e=t.rotation;i.setLocalRotation(e[0],e[1],e[2],e[3])}if(t.hasOwnProperty("translation")){const e=t.translation;i.setLocalPosition(e[0],e[1],e[2])}if(t.hasOwnProperty("scale")){const e=t.scale;i.setLocalScale(e[0],e[1],e[2])}return i},tp=function(t,e){const i="orthographic"===t.type?Le:Pe,n=i===Le?t.orthographic:t.perspective,s={enabled:!1,projection:i,nearClip:n.znear,aspectRatioMode:$i};n.zfar&&(s.farClip=n.zfar),i===Le?(s.orthoHeight=.5*n.ymag,n.ymag&&(s.aspectRatioMode=Ji,s.aspectRatio=n.xmag/n.ymag)):(s.fov=n.yfov*Z.RAD_TO_DEG,n.aspectRatio&&(s.aspectRatioMode=Ji,s.aspectRatio=n.aspectRatio));const r=new uA(t.name);return r.addComponent("camera",s),r},ep=function(t,e){const i={enabled:!1,type:"point"===t.type?"omni":t.type,color:t.hasOwnProperty("color")?new rt(t.color):rt.WHITE,range:t.hasOwnProperty("range")?t.range:Number.MAX_VALUE,falloffMode:ce,intensity:t.hasOwnProperty("intensity")?Z.clamp(t.intensity,0,2):1};t.hasOwnProperty("spot")&&(i.innerConeAngle=t.spot.hasOwnProperty("innerConeAngle")?t.spot.innerConeAngle*Z.RAD_TO_DEG:0,i.outerConeAngle=t.spot.hasOwnProperty("outerConeAngle")?t.spot.outerConeAngle*Z.RAD_TO_DEG:Math.PI/4);const n=new uA(e.name);return n.rotateLocal(90,0,0),n.addComponent("light",i),n},ip=function(t,e,i,n){if(!e.hasOwnProperty("skins")||0===e.skins.length)return[];const s=new Map;return e.skins.map((function(r){return function(t,e,i,n,s,r){let o,a,l;const h=e.joints,c=h.length,_=[];if(e.hasOwnProperty("inverseBindMatrices")){const t=e.inverseBindMatrices,s=Gd(i[t],n,!0),r=[];for(o=0;o<c;o++){for(a=0;a<16;a++)r[a]=s[16*o+a];l=new bt,l.set(r),_.push(l)}}else for(o=0;o<c;o++)l=new bt,_.push(l);const u=[];for(o=0;o<c;o++)u[o]=s[h[o]].name;const d=u.join("#");let p=r.get(d);return p||(p=new Ju(t,_,u),r.set(d,p)),p}(t,r,e.accessors,n,i,s)}))},np=function(t,e,i,n){if(!t.hasOwnProperty("animations")||0===t.animations.length)return[];const s=n&&n.animation&&n.animation.preprocess,r=n&&n.animation&&n.animation.postprocess;return t.animations.map((function(n,o){s&&s(n);const a=function(t,e,i,n,s){const r=function(t){return new id(Nd(t.type),jd(t,n))},o={STEP:od,LINEAR:ad,CUBICSPLINE:ld},a={},l=[],h={},c=[],_=[];let u;for(u=0;u<t.samplers.length;++u){const e=t.samplers[u];a.hasOwnProperty(e.input)||(a[e.input]=l.length,l.push(r(i[e.input]))),h.hasOwnProperty(e.output)||(h[e.output]=c.length,c.push(r(i[e.output])));const n=e.hasOwnProperty("interpolation")&&o.hasOwnProperty(e.interpolation)?o[e.interpolation]:ad;_.push(new ed([],a[e.input],h[e.output],n))}const d=[],p={translation:"localPosition",rotation:"localRotation",scale:"localScale",weights:"weights"};for(u=0;u<t.channels.length;++u){const e=t.channels[u],i=e.target,n=_[e.sampler],r=s[i.node],o=[s[0].name,...rd.splitPath(r.path,"/")];n._paths.push({entityPath:o,component:"graph",propertyPath:[p[i.path]]}),i.path.startsWith("rotation")&&n.interpolation!==ld?d.push(n.output):i.path.startsWith("weights")&&(c[n.output]._components=c[n.output].data.length/l[n.input].data.length)}d.sort();let f,m=null;for(u=0;u<d.length;++u){const t=d[u];if(0===u||t!==m){if(f=c[t],4===f.components){const t=f.data,e=t.length-4;for(let i=0;i<e;i+=4){t[i+0]*t[i+4]+t[i+1]*t[i+5]+t[i+2]*t[i+6]+t[i+3]*t[i+7]<0&&(t[i+4]*=-1,t[i+5]*=-1,t[i+6]*=-1,t[i+7]*=-1)}}m=t}}let g=0;for(u=0;u<l.length;u++)f=l[u]._data,g=Math.max(g,0===f.length?0:f[f.length-1]);return new sd(t.hasOwnProperty("name")?t.name:"animation_"+e,g,l,c,_)}(n,o,t.accessors,i,e);return r&&r(n,a),a}))},sp=function(t,e,i,n,s,r){const o=s&&s.global&&s.global.preprocess,a=s&&s.global&&s.global.postprocess;o&&o(e);const l=e.asset&&"PlayCanvas"===e.asset.generator,h=function(t,e){if(!t.hasOwnProperty("nodes")||0===t.nodes.length)return[];const i=e&&e.node&&e.node.preprocess,n=e&&e.node&&e.node.process||Jd,s=e&&e.node&&e.node.postprocess,r=t.nodes.map((function(t,e){i&&i(t);const r=n(t,e);return s&&s(t,r),r}));for(let e=0;e<t.nodes.length;++e){const i=t.nodes[e];if(i.hasOwnProperty("children"))for(let t=0;t<i.children.length;++t){const n=r[e],s=r[i.children[t]];s.parent||n.addChild(s)}}return r}(e,s),c=function(t,e){const i=[],n=t.scenes.length;if(1===n&&1===t.scenes[0].nodes.length){const n=t.scenes[0].nodes[0];i.push(e[n])}else for(let s=0;s<n;s++){const n=t.scenes[s],r=new La(n.name);for(let t=0;t<n.nodes.length;t++){const i=e[n.nodes[t]];r.addChild(i)}i.push(r)}return i}(e,h),_=function(t,e,i){let n=null;if(t.hasOwnProperty("nodes")&&t.hasOwnProperty("extensions")&&t.extensions.hasOwnProperty("KHR_lights_punctual")&&t.extensions.KHR_lights_punctual.hasOwnProperty("lights")){const s=t.extensions.KHR_lights_punctual.lights;if(s.length){const r=i&&i.light&&i.light.preprocess,o=i&&i.light&&i.light.process||ep,a=i&&i.light&&i.light.postprocess;t.nodes.forEach((function(t,i){if(t.hasOwnProperty("extensions")&&t.extensions.hasOwnProperty("KHR_lights_punctual")&&t.extensions.KHR_lights_punctual.hasOwnProperty("light")){const l=t.extensions.KHR_lights_punctual.light,h=s[l];if(h){r&&r(h);const s=o(h,e[i]);a&&a(h,s),s&&(n||(n=new Map),n.set(t,s))}}}))}}return n}(e,h,s),u=function(t,e,i){let n=null;if(t.hasOwnProperty("nodes")&&t.hasOwnProperty("cameras")&&t.cameras.length>0){const s=i&&i.camera&&i.camera.preprocess,r=i&&i.camera&&i.camera.process||tp,o=i&&i.camera&&i.camera.postprocess;t.nodes.forEach((function(i,a){if(i.hasOwnProperty("camera")){const l=t.cameras[i.camera];if(l){s&&s(l);const t=r(l,e[a]);o&&o(l,t),t&&(n||(n=new Map),n.set(i,t))}}}))}return n}(e,h,s),d=np(e,h,i,s),p=function(t,e,i,n){if(!t.hasOwnProperty("materials")||0===t.materials.length)return[];const s=i&&i.material&&i.material.preprocess,r=i&&i.material&&i.material.process||$d,o=i&&i.material&&i.material.postprocess;return t.materials.map((function(t){s&&s(t);const i=r(t,e,n);return o&&o(t,i),i}))}(e,n.map((function(t){return t.resource})),s,l),f=function(t,e,i,n,s){if(!e.hasOwnProperty("meshes")||0===e.meshes.length||!e.hasOwnProperty("accessors")||0===e.accessors.length||!e.hasOwnProperty("bufferViews")||0===e.bufferViews.length)return[];const r={};return e.meshes.map((function(o){return Qd(t,o,e.accessors,i,n,s,r)}))}(t,e,i,r,l),m=ip(t,e,h,i),g=[];for(let t=0;t<f.length;t++)g[t]=new td,g[t].meshes=f[t];!function(t,e,i){t.nodes.forEach(t=>{if(t.hasOwnProperty("mesh")&&t.hasOwnProperty("skin")){e[t.mesh].meshes.forEach(e=>{e.skin=i[t.skin]})}})}(e,g,m);const b=new Fd(e);b.nodes=h,b.scenes=c,b.animations=d,b.textures=n,b.materials=p,b.renders=g,b.skins=m,b.lights=_,b.cameras=u,a&&a(e,b),r(null,b)};let rp=0;const op=function(t,e,i,n,s,r,o){const a=r&&r.image&&r.image.preprocess,l=r&&r.image&&r.image.processAsync||function(t,e){e(null,null)},h=r&&r.image&&r.image.postprocess,c=function(e){h&&h(t,e),o(null,e)},_={"image/png":"png","image/jpeg":"jpg","image/basis":"basis","image/ktx":"ktx","image/vnd-ms.dds":"dds"},u=function(e,i,n,r){const a=(t.name||"gltf-texture")+"-"+rp++,l={url:e||a};if(i&&(l.contents=i),n){const t=_[n];t&&(l.filename=l.url+"."+t)}const h=new Od(a,"texture",l,null,r);h.on("load",c),h.on("error",o),s.add(h),s.load(h)};a&&a(t),l(t,(function(s,r){var a;s?o(s):r?c(r):t.hasOwnProperty("uri")?Bd(t.uri)?u(t.uri,null,(a=t.uri).substring(a.indexOf(":")+1,a.indexOf(";")),null):u(T.join(n,t.uri),null,null,{crossOrigin:"anonymous"}):t.hasOwnProperty("bufferView")&&t.hasOwnProperty("mimeType")?u(null,i[t.bufferView],t.mimeType,null):o("Invalid image found in gltf (neither uri or bufferView found). index="+e)}))},ap=function(t,e,i,n,s,r){if(!t.hasOwnProperty("images")||0===t.images.length||!t.hasOwnProperty("textures")||0===t.textures.length)return void r(null,[]);const o=s&&s.texture&&s.texture.preprocess,a=s&&s.texture&&s.texture.processAsync||function(t,e,i){i(null,null)},l=s&&s.texture&&s.texture.postprocess,h=[],c=[];let _=t.textures.length;const u=function(e,i){if(c[i]||(c[i]=[]),c[i].push(e),0==--_){const e=[];c.forEach((function(i,n){i.forEach((function(i,s){const r=0===s?h[n]:Yd(h[n]);!function(t,e){const i=function(t,e){switch(t){case 9728:return Kn;case 9729:return Zn;case 9984:return Qn;case 9985:return Jn;case 9986:return $n;case 9987:return ts;default:return e}},n=function(t,e){switch(t){case 33071:return pn;case 33648:return fn;case 10497:return dn;default:return e}};t&&(e=e||{},t.minFilter=i(e.minFilter,ts),t.magFilter=i(e.magFilter,Zn),t.addressU=n(e.wrapS,dn),t.addressV=n(e.wrapT,dn))}(r.resource,(t.samplers||[])[t.textures[i].sampler]),e[i]=r,l&&l(t.textures[i],r)}))})),r(null,e)}};for(let l=0;l<t.textures.length;++l){const c=t.textures[l];o&&o(c),a(c,t.images,function(o,a,l,c){if(l)r(l);else{var _,d;if(null==c)void 0===(c=null==a||null==(_=a.extensions)||null==(d=_.KHR_texture_basisu)?void 0:d.source)&&(c=a.source);if(h[c])u(o,c);else{const a=t.images[c];op(a,o,e,i,n,s,(function(t,e){t?r(t):(h[c]=e,u(o,c))}))}}}.bind(null,l,c))}},lp=function(t,e){const i=JSON.parse(function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return decodeURIComponent(escape(e))}(t));i.asset&&i.asset.version&&parseFloat(i.asset.version)<2?e("Invalid gltf version. Expected version 2.0 or above but found version '"+i.asset.version+"'."):e(null,i)},hp=function(t,e,i){t&&t.toLowerCase().endsWith(".glb")?function(t,e){const i=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),n=i.getUint32(0,!0),s=i.getUint32(4,!0),r=i.getUint32(8,!0);if(1179937895!==n)return void e("Invalid magic number found in glb header. Expected 0x46546C67, found 0x"+n.toString(16));if(2!==s)return void e("Invalid version number found in glb header. Expected 2, found "+s);if(r<=0||r>i.byteLength)return void e("Invalid length found in glb header. Found "+r);const o=[];let a=12;for(;a<r;){const t=i.getUint32(a,!0);if(a+t+8>i.byteLength)throw new Error("Invalid chunk length found in glb. Found "+t);const e=i.getUint32(a+4,!0),n=new Uint8Array(i.buffer,i.byteOffset+a+8,t);o.push({length:t,type:e,data:n}),a+=t+8}1===o.length||2===o.length?1313821514===o[0].type?o.length>1&&5130562!==o[1].type?e("Invalid chunk type found in glb file. Expected 0x004E4942, found 0x"+o[1].type.toString(16)):e(null,{gltfChunk:o[0].data,binaryChunk:2===o.length?o[1].data:null}):e("Invalid chunk type found in glb file. Expected 0x4E4F534A, found 0x"+o[0].type.toString(16)):e("Invalid number of chunks found in glb file.")}(e,i):i(null,{gltfChunk:e,binaryChunk:null})},cp=function(t,e,i,n){const s=[],r=i&&i.bufferView&&i.bufferView.preprocess,o=i&&i.bufferView&&i.bufferView.processAsync||function(t,e,i){i(null,null)},a=i&&i.bufferView&&i.bufferView.postprocess;let l=t.bufferViews?t.bufferViews.length:0;if(!l)return void n(null,null);const h=function(e,i){const r=t.bufferViews[e];r.hasOwnProperty("byteStride")&&(i.byteStride=r.byteStride),s[e]=i,a&&a(r,i),0==--l&&n(null,s)};for(let i=0;i<t.bufferViews.length;++i){const s=t.bufferViews[i];r&&r(s),o(s,e,function(t,i,s,r){if(s)n(s);else if(r)h(t,r);else{const n=e[i.buffer],s=new Uint8Array(n.buffer,n.byteOffset+(i.byteOffset||0),i.byteLength);h(t,s)}}.bind(null,i,s))}};class _p{static parseAsync(t,e,i,n,s,r,o){hp(t,i,(function(t,i){t?o(t):lp(i.gltfChunk,(function(t,a){t?o(t):function(t,e,i,n,s){const r=[];if(!t.buffers||0===t.buffers.length)return void s(null,r);const o=n&&n.buffer&&n.buffer.preprocess,a=n&&n.buffer&&n.buffer.processAsync||function(t,e){e(null,null)},l=n&&n.buffer&&n.buffer.postprocess;let h=t.buffers.length;const c=function(e,i){r[e]=i,l&&l(t.buffers[e],i),0==--h&&s(null,r)};for(let n=0;n<t.buffers.length;++n){const r=t.buffers[n];o&&o(r),a(r,function(t,n,r,o){if(r)s(r);else if(o)c(t,new Uint8Array(o));else if(n.hasOwnProperty("uri"))if(Bd(n.uri)){const e=atob(n.uri.split(",")[1]),i=new Uint8Array(e.length);for(let t=0;t<e.length;t++)i[t]=e.charCodeAt(t);c(t,i)}else $.get(T.join(i,n.uri),{cache:!0,responseType:"arraybuffer",retry:!1},function(t,e,i){e?s(e):c(t,new Uint8Array(i))}.bind(null,t));else c(t,e)}.bind(null,n,r))}}(a,i.binaryChunk,e,r,(function(t,i){t?o(t):cp(a,i,r,(function(t,i){t?o(t):ap(a,i,e,s,r,(function(t,e){t?o(t):sp(n,a,i,e,r,o)}))}))}))}))}))}static parse(t,e,i,n){let s=null;return n=n||{},hp(t,e,(function(t,e){t?console.error(t):lp(e.gltfChunk,(function(t,r){t?console.error(t):cp(r,[e.binaryChunk],n,(function(t,e){t?console.error(t):sp(i,r,e,[],n,(function(t,e){t?console.error(t):s=e}))}))}))})),s}}class up{constructor(){this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t});const i={retry:this.maxRetries>0,maxRetries:this.maxRetries};(t.load.startsWith("blob:")||t.load.startsWith("data:"))&&(".glb"===T.getExtension(t.original).toLowerCase()?i.responseType=Q.ResponseType.ARRAY_BUFFER:i.responseType=Q.ResponseType.JSON),$.get(t.load,i,(function(i,n){i?e("Error loading animation resource: "+t.original+" ["+i+"]"):e(null,n)}))}open(t,e){if(".glb"===T.getExtension(t).toLowerCase()){const t=_p.parse("filename.glb",e,null);if(t){const e=t.animations;return t.destroy(),e}return null}return this["_parseAnimationV"+e.animation.version](e)}_parseAnimationV3(t){const e=t.animation,i=new Qu;i.name=e.name,i.duration=e.duration;for(let t=0;t<e.nodes.length;t++){const n=new Zu,s=e.nodes[t];n._name=s.name;for(let t=0;t<s.keys.length;t++){const e=s.keys[t],i=e.time,r=e.pos,o=e.rot,a=e.scale,l=new ht(r[0],r[1],r[2]),h=(new yt).setFromEulerAngles(o[0],o[1],o[2]),c=new ht(a[0],a[1],a[2]),_=new Ku(i,l,h,c);n._keys.push(_)}i.addNode(n)}return i}_parseAnimationV4(t){const e=t.animation,i=new Qu;i.name=e.name,i.duration=e.duration;for(let t=0;t<e.nodes.length;t++){const n=new Zu,s=e.nodes[t];n._name=s.name;const r=s.defaults.p,o=s.defaults.r,a=s.defaults.s;for(let t=0;t<s.keys.length;t++){const e=s.keys[t],i=e.t,l=r||e.p,h=o||e.r,c=a||e.s,_=new ht(l[0],l[1],l[2]),u=(new yt).setFromEulerAngles(h[0],h[1],h[2]),d=new ht(c[0],c[1],c[2]),p=new Ku(i,_,u,d);n._keys.push(p)}i.addNode(n)}return i}}class dp{constructor(){this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t});const i={retry:this.maxRetries>0,maxRetries:this.maxRetries};t.load.startsWith("blob:")&&(i.responseType=Q.ResponseType.JSON),$.get(t.load,i,(function(i,n){i?e("Error loading animation clip resource: "+t.original+" ["+i+"]"):e(null,n)}))}open(t,e){const i=e.name,n=e.duration,s=e.inputs.map((function(t){return new id(1,t)})),r=e.outputs.map((function(t){return new id(t.components,t.data)})),o=e.curves.map((function(t){return new ed([t.path],t.inputIndex,t.outputIndex,t.interpolation)}));return new sd(i,n,s,r,o)}}class pp{constructor(t){var e;if(this._layers=[],this._parameters={},Array.isArray(t.layers))this._layers=t.layers;else for(var i in t.layers){var n=t.layers[i],s={name:n.name,blendType:n.blendType,weight:n.weight,states:[],transitions:[]};for(e=0;e<n.states.length;e++)s.states.push(t.states[n.states[e]]);for(e=0;e<n.transitions.length;e++){var r=t.transitions[n.transitions[e]];if(r.conditions&&!Array.isArray(r.conditions)){for(var o=Object.keys(r.conditions),a=[],l=0;l<o.length;l++){var h=r.conditions[o[l]];h.parameterName&&a.push(h)}r.conditions=a}Number.isInteger(r.from)&&(r.from=t.states[r.from].name),Number.isInteger(r.to)&&(r.to=t.states[r.to].name),s.transitions.push(r)}this._layers.push(s)}for(var c in t.parameters){var _=t.parameters[c];this._parameters[_.name]={type:_.type,value:_.value}}}get parameters(){return Object.assign({},this._parameters)}get layers(){return this._layers}}class fp{constructor(){this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t});const i={retry:this.maxRetries>0,maxRetries:this.maxRetries};t.load.startsWith("blob:")&&(i.responseType=Q.ResponseType.JSON),$.get(t.load,i,(function(i,n){i?e("Error loading animation state graph resource: "+t.original+" ["+i+"]"):e(null,n)}))}open(t,e){return new pp(e)}}class mp{constructor(t){t instanceof Audio?this.audio=t:this.buffer=t}get duration(){let t=0;return this.buffer?t=this.buffer.duration:this.audio&&(t=this.audio.duration),t||0}}const gp=function(){if("undefined"==typeof window)return!1;const t=window.navigator.userAgent,e=t.indexOf("MSIE ");if(e>0)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(t.indexOf("Trident/")>0){const e=t.indexOf("rv:");return parseInt(t.substring(e+3,t.indexOf(".",e)),10)}return!1}(),bp={".ogg":"audio/ogg",".mp3":"audio/mpeg",".wav":"audio/x-wav",".mp4a":"audio/mp4",".m4a":"audio/mp4",".mp4":"audio/mp4",".aac":"audio/aac"};class yp{constructor(t){this.manager=t,this.maxRetries=0}_isSupported(t){const e=T.getExtension(t);return!!bp[e]}load(t,e){"string"==typeof t&&(t={load:t,original:t});const i=function(t){e(null,new mp(t))},n=function(i){let n="Error loading audio url: "+t.original;i&&(n+=": "+(i.message||i)),console.warn(n),e(n)};if(this._createSound){if(!this._isSupported(t.original))return void n("Audio format for "+t.original+" not supported");this._createSound(t.load,i,n)}else n(null)}open(t,e){return e}_createSound(t,e,i){if(zu()){const n=this.manager;if(!n.context)return void i("Audio manager has no audio context");const s={retry:this.maxRetries>0,maxRetries:this.maxRetries};(t.startsWith("blob:")||t.startsWith("data:"))&&(s.responseType=Q.ResponseType.ARRAY_BUFFER),$.get(t,s,(function(t,s){t?i(t):n.context.decodeAudioData(s,e,i)}))}else{let n=null;try{n=new Audio}catch(t){return void i("No support for Audio element")}gp&&document.body.appendChild(n);const s=function t(){n.removeEventListener("canplaythrough",t),gp&&document.body.removeChild(n),e(n)};n.onerror=function(){n.onerror=null,gp&&document.body.removeChild(n),i()},n.addEventListener("canplaythrough",s),n.src=t}}}class vp{constructor(){this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t}),$.get(t.load,{responseType:Q.ResponseType.ARRAY_BUFFER,retry:this.maxRetries>0,maxRetries:this.maxRetries},(function(i,n){i?e("Error loading binary resource: "+t.original+" ["+i+"]"):e(null,n)}))}open(t,e){return e}patch(t,e){}}class Sp{constructor(t){this._blobUrls={};for(let e=0,i=t.length;e<i;e++)t[e].url&&(this._blobUrls[t[e].name]=t[e].url)}hasBlobUrl(t){return!!this._blobUrls[t]}getBlobUrl(t){return this._blobUrls[t]}destroy(){for(const t in this._blobUrls)URL.revokeObjectURL(this._blobUrls[t]);this._blobUrls=null}}let xp;function wp(t){let e,i;if("undefined"!=typeof TextDecoder)try{e=new TextDecoder("utf-8"),i=new TextDecoder("windows-1252")}catch(t){console.warn("TextDecoder not supported - pc.Untar module will not work")}else console.warn("TextDecoder not supported - pc.Untar module will not work");function n(t){this._fields=t}function s(t){this._arrayBuffer=t||new ArrayBuffer(0),this._bufferView=new DataView(this._arrayBuffer),this._globalPaxHeader=null,this._paxHeader=null,this._bytesRead=0}n.parse=function(t,i,s){const r=new Uint8Array(t,i,s);let o=0;const a=[];for(;o<s;){let n;for(n=o;n<s&&32!==r[n];n++);if(n>=s)throw new Error("Invalid PAX header data format.");const l=parseInt(e.decode(new Uint8Array(t,i+o,n-o)),10),h=e.decode(new Uint8Array(t,i+n+1,l-(n-o)-2)).split("=");if(2!==h.length)throw new Error("Invalid PAX header data format.");0===h[1].length&&(h[1]=null),a.push({name:h[0],value:h[1]}),o+=l}return new n(a)},n.prototype.applyHeader=function(t){for(let e=0;e<this._fields.length;e++){let i=this._fields[e].name;const n=this._fields[e].value;"path"===i&&(i="name"),null===n?delete t[i]:t[i]=n}},t||(xp=s),s.prototype._hasNext=function(){return this._bytesRead+4<this._arrayBuffer.byteLength&&0!==this._bufferView.getUint32(this._bytesRead)},s.prototype._readNextFile=function(){const e=new DataView(this._arrayBuffer,this._bytesRead,512),s=i.decode(e);this._bytesRead+=512;let r=s.substr(0,100).replace(/\0/g,"");const o=s.substr(257,6),a=parseInt(s.substr(124,12),8),l=s.substr(156,1),h=this._bytesRead;let c=null,_=!1;switch(l){case"0":case"":if(_=!0,!t){const t=new Blob([this._arrayBuffer.slice(this._bytesRead,this._bytesRead+a)]);c=URL.createObjectURL(t)}break;case"g":this._globalPaxHeader=n.parse(this._arrayBuffer,this._bytesRead,a);break;case"x":this._paxHeader=n.parse(this._arrayBuffer,this._bytesRead,a)}this._bytesRead+=a;const u=a%512;if(0!==u&&(this._bytesRead+=512-u),!_)return null;if(-1!==o.indexOf("ustar")){const t=s.substr(345,155).replace(/\0/g,"");t.length>0&&(r=t.trim()+r.trim())}const d={name:r,start:h,size:a,url:c};return this._globalPaxHeader&&this._globalPaxHeader.applyHeader(d),this._paxHeader&&(this._paxHeader.applyHeader(d),this._paxHeader=null),d},s.prototype.untar=function(t){if(!e)return console.error("Cannot untar because TextDecoder interface is not available for this platform."),[];const i=[];for(;this._hasNext();){const e=this._readNextFile();e&&(t&&e.name&&(e.name=t+e.name),i.push(e))}return i},t&&(self.onmessage=function(t){const e=t.data.id;try{const i=new s(t.data.arrayBuffer).untar(t.data.prefix);postMessage({id:e,files:i,arrayBuffer:t.data.arrayBuffer},[t.data.arrayBuffer])}catch(t){postMessage({id:e,error:t.toString()})}})}let Cp=null;class Tp{constructor(t){this._requestId=0,this._pendingRequests={},this._filenamePrefix=t,this._worker=new Worker(function(){if(!Cp){const t="("+wp.toString()+")(true)\n\n",e=new Blob([t],{type:"application/javascript"});Cp=URL.createObjectURL(e)}return Cp}()),this._worker.addEventListener("message",this._onMessage.bind(this))}_onMessage(t){const e=t.data.id;if(!this._pendingRequests[e])return;const i=this._pendingRequests[e];if(delete this._pendingRequests[e],t.data.error)i(t.data.error);else{const e=t.data.arrayBuffer;for(let i=0,n=t.data.files.length;i<n;i++){const n=t.data.files[i],s=new Blob([e.slice(n.start,n.start+n.size)]);n.url=URL.createObjectURL(s)}i(null,t.data.files)}}untar(t,e){const i=this._requestId++;this._pendingRequests[i]=e,this._worker.postMessage({id:i,prefix:this._filenamePrefix,arrayBuffer:t},[t])}hasPendingRequests(){for(const t in this._pendingRequests)return!0;return!1}destroy(){this._worker&&(this._worker.terminate(),this._worker=null,this._pendingRequests=null)}}wp();class Ap{constructor(t){this._assets=t,this._worker=null,this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t});const i=this;$.get(t.load,{responseType:Q.ResponseType.ARRAY_BUFFER,retry:this.maxRetries>0,maxRetries:this.maxRetries},(function(n,s){if(n)e("Error loading bundle resource "+t.original+": "+n);else try{i._untar(s,e)}catch(i){e("Error loading bundle resource "+t.original+": "+i)}}))}_untar(t,e){const i=this;if(B.workers)i._worker||(i._worker=new Tp(i._assets.prefix)),i._worker.untar(t,(function(t,n){e(t,n),i._worker.hasPendingRequests()||(i._worker.destroy(),i._worker=null)}));else{const n=new xp(t).untar(i._assets.prefix);e(null,n)}}open(t,e){return new Sp(e)}patch(t,e){}}class Ep extends bh{constructor(t,e){super(),this.skin=t,this.skinInstance=e}}class Mp{static createCachedSkinedInstance(t,e,i){let n=Mp.getCachedSkinInstance(t,e);return n||(n=new Vh(t),n.resolve(e,i),Mp.addCachedSkinInstance(t,e,n)),n}static getCachedSkinInstance(t,e){let i=null;const n=Mp._skinInstanceCache.get(e);if(n){const e=n.find(e=>e.skin===t);e&&(e.incRefCount(),i=e.skinInstance)}return i}static addCachedSkinInstance(t,e,i){let n=Mp._skinInstanceCache.get(e);n||(n=[],Mp._skinInstanceCache.set(e,n));let s=n.find(e=>e.skin===t);s||(s=new Ep(t,i),n.push(s)),s.incRefCount()}static removeCachedSkinInstance(t){if(t){const e=t.rootBone;if(e){const i=Mp._skinInstanceCache.get(e);if(i){const n=i.findIndex(e=>e.skinInstance===t);if(n>=0){const s=i[n];s.decRefCount(),0===s.getRefCount()&&(i.splice(n,1),i.length||Mp._skinInstanceCache.delete(e),t&&(t.destroy(),s.skinInstance=null))}}}}}}Mp._skinInstanceCache=new Map;class Rp{constructor(t){this.data=t,this._model=null,this.renders=[],this.materials=[],this.textures=[],this.animations=[],this.registry=null,this._defaultMaterial=null,this._assetName=null,this._assets=null}get model(){if(!this._model){const t=Rp.createModel(this.data,this._defaultMaterial),e=Rp.createAsset(this._assetName,"model",t,0);this._assets.add(e),this._model=e}return this._model}static createAsset(t,e,i,n){const s=new Od(t+"/"+e+"/"+n,e,{url:""});return s.resource=i,s.loaded=!0,s}instantiateModelEntity(t){const e=new uA;return e.addComponent("model",Object.assign({type:"asset",asset:this.model},t)),e}instantiateRenderEntity(t){const e=this._defaultMaterial,i=[],n=function(t,n,s,r,o,a){const l=void 0===s.materialIndex?e:r[s.materialIndex],h=new Kh(s,l);return s.morph&&(h.morphInstance=new Nu(s.morph)),a.hasOwnProperty("skin")&&i.push({meshInstance:h,rootBone:t,entity:n}),h},s=function e(i,s,r){const o=new uA;s._cloneInternal(o),i||(i=o);let a=null;for(let t=0;t<r.nodes.length;t++){if(r.nodes[t]===s){const e=r.gltf.nodes[t];if(e.hasOwnProperty("mesh")){const t=r.renders[e.mesh].meshes;for(var l=0;l<t.length;l++){const s=t[l];if(s){const t=n(i,o,s,r.materials,r.skins,e);a||(a=[]),a.push(t)}}}if(r.lights){const t=r.lights.get(e);t&&o.addChild(t.clone())}if(r.cameras){const t=r.cameras.get(e);t&&t.camera.system.cloneComponent(t,o)}}}a&&o.addComponent("render",Object.assign({type:"asset",meshInstances:a,rootBone:i},t));const h=s.children;for(let t=0;t<h.length;t++){const n=e(i,h[t],r);o.addChild(n)}return o},r=[];for(const t of this.data.scenes)r.push(s(null,t,this.data));return i.forEach(t=>{t.meshInstance.skinInstance=Mp.createCachedSkinedInstance(t.meshInstance.mesh.skin,t.rootBone,t.entity)}),Rp.createSceneHierarchy(r,"Entity")}static createSceneHierarchy(t,e){let i=null;if(1===t.length)i=t[0];else{i=new e("SceneGroup");for(const e of t)i.addChild(e)}return i}static createModel(t,e){const i=function(t,i,n,s,r,o,a){const l=void 0===i.materialIndex?e:r[i.materialIndex],h=new Kh(i,l,o);if(i.morph){const e=new Nu(i.morph);h.morphInstance=e,t.morphInstances.push(e)}if(a.hasOwnProperty("skin")){const e=a.skin,r=n[e];i.skin=r;const o=s[e];h.skinInstance=o,t.skinInstances.push(o)}t.meshInstances.push(h)},n=new Uu,s=[];for(const e of t.skins){const t=new Vh(e);t.bones=e.bones,s.push(t)}n.graph=Rp.createSceneHierarchy(t.scenes,"GraphNode");for(let e=0;e<t.nodes.length;e++){const o=t.nodes[e];if(o.root===n.graph){const a=t.gltf.nodes[e];if(a.hasOwnProperty("mesh")){const e=t.renders[a.mesh].meshes;for(var r=0;r<e.length;r++){const l=e[r];l&&i(n,l,t.skins,s,t.materials,o,a)}}}}return n}destroy(){const t=this.registry,e=function(e){t.remove(e),e.unload()},i=function(t){t.forEach((function(t){e(t)}))};this.animations&&(i(this.animations),this.animations=null),this.textures&&(i(this.textures),this.textures=null),this.materials&&(i(this.materials),this.materials=null),this.renders&&(i(this.renders),this.renders=null),this._model&&(e(this._model),this._model=null),this.data=null,this.assets=null}}class Ip{constructor(t,e){this._device=t,this._defaultMaterial=e,this.maxRetries=0}_getUrlWithoutParams(t){return t.indexOf("?")>=0?t.split("?")[0]:t}load(t,e,i){"string"==typeof t&&(t={load:t,original:t}),Od.fetchArrayBuffer(t.load,(n,s)=>{n?e(n):_p.parseAsync(this._getUrlWithoutParams(t.original),T.extractPath(t.load),s,this._device,i.registry,i.options,(t,i)=>{t?e(t):e(null,new Rp(i))})},i,this.maxRetries)}open(t,e,i){return e}patch(t,e){const i=t.resource,n=i&&i.data;if(n){const s=function(i,n,s){const r=Rp.createAsset(t.name,i,n,s);return e.add(r),r};let r;const o=[];for(r=0;r<n.renders.length;++r)o.push(s("render",n.renders[r],r));const a=[];for(r=0;r<n.materials.length;++r)a.push(s("material",n.materials[r],r));const l=[];for(r=0;r<n.animations.length;++r)l.push(s("animation",n.animations[r],r));i._assetName=t.name,i._assets=e,i.renders=o,i.materials=a,i.textures=n.textures,i.animations=l,i.registry=e,i._defaultMaterial=this._defaultMaterial}}}class Pp{constructor(){this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t}),$.get(t.load,{retry:this.maxRetries>0,maxRetries:this.maxRetries},(function(i,n){i?e("Error loading css resource: "+t.original+" ["+i+"]"):e(null,n)}))}open(t,e){return e}patch(t,e){}}function Lp(t){const e=document.createElement("style");return e.type="text/css",e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)),e}class Dp{constructor(t,e,i){this._device=t,this._registry=e,this._loader=i}load(t,e,i){this.loadAssets(i,e)}open(t,e,i){return i?i.resource:null}patch(t,e){this.loadAssets(t,(function(i,n){i&&(e.fire("error",t),e.fire("error:"+t.id,i,t),t.fire("error",t))}))}getAssetIds(t){const e=[];if(e[0]=t.file,(t.loadFaces||!t.file)&&t.data&&t.data.textures)for(let i=0;i<6;++i)e[i+1]=t.data.textures[i];else e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=null;return e}compareAssetIds(t,e){return t&&e?parseInt(t,10)===t||"string"==typeof t?t===e:t.url===e.url:null!==t==(null!==e)}update(t,e,i){const n=t.data||{},s=t._handlerState.assets,r=t._resources;let o,a,l;const h=[null,null,null,null,null,null,null],c=function(){return n.hasOwnProperty("type")?n.type:n.hasOwnProperty("rgbm")?n.rgbm?Vr:Ur:null};if(t.loaded&&i[0]===s[0])h[1]=r[1]||null,h[2]=r[2]||null,h[3]=r[3]||null,h[4]=r[4]||null,h[5]=r[5]||null,h[6]=r[6]||null;else if(i[0])for(o=i[0].resource,l=0;l<6;++l){const e=[o._levels[l]];if(0===l&&this._device.useTexCubeLod)for(a=1;a<o._levels.length;++a)e[a]=o._levels[a];const i=new _a(this._device,{name:t.name+"_prelitCubemap"+(o.width>>l),cubemap:!0,type:c()||o.type,width:o.width>>l,height:o.height>>l,format:o.format,levels:e,fixCubemapSeams:!0,addressU:pn,addressV:pn});h[l+1]=i}const _=i.slice(1);if(t.loaded&&this.cmpArrays(_,s.slice(1)))h[0]=r[0]||null;else if(-1===_.indexOf(null)){const e=_.map((function(t){return t.resource})),s=[];for(a=0;a<e[0]._levels.length;++a)s.push(e.map((function(t){return t._levels[a]})));const r=new _a(this._device,{name:t.name+"_faces",cubemap:!0,type:c()||e[0].type,width:e[0].width,height:e[0].height,format:e[0].format,levels:s,minFilter:n.hasOwnProperty("minFilter")?n.minFilter:e[0].minFilter,magFilter:n.hasOwnProperty("magFilter")?n.magFilter:e[0].magFilter,anisotropy:n.hasOwnProperty("anisotropy")?n.anisotropy:1,addressU:pn,addressV:pn,fixCubemapSeams:!!i[0]});h[0]=r}if(!this.cmpArrays(h,r))for(t.resources=h,t._handlerState.assetIds=e,t._handlerState.assets=i,l=0;l<r.length;++l)null!==r[l]&&-1===h.indexOf(r[l])&&r[l].destroy();for(l=0;l<s.length;++l)null!==s[l]&&-1===i.indexOf(s[l])&&s[l].unload()}cmpArrays(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}resolveId(t){const e=parseInt(t,10);return e===t||e.toString()===t?e:t}loadAssets(t,e){t.hasOwnProperty("_handlerState")||(t._handlerState={assetIds:[null,null,null,null,null,null,null],assets:[null,null,null,null,null,null,null]});const i=this,n=i.getAssetIds(t),s=[null,null,null,null,null,null,null],r=t._handlerState.assetIds,o=t._handlerState.assets,a=i._registry;let l=7;const h=function(r,o){s[r]=o,l--,0===l&&(i.update(t,n,s),e(null,t.resources))},c=function(t,i,n){e(i)},_=function(t,e){e.loaded?h(t,e):(a.once("load:"+e.id,h.bind(i,t)),a.once("error:"+e.id,c.bind(i,t)),e.loading||a.load(e))};let u;for(let e=0;e<7;++e){const s=this.resolveId(n[e]);if(s)if(i.compareAssetIds(s,r[e]))h(e,o[e]);else if(parseInt(s,10)===s)u=a.get(s),u?_(e,u):setTimeout(function(t,e){const i=a.get(e);i?_(t,i):c(0,"failed to find dependent cubemap asset="+e)}.bind(null,e,s));else{const n="string"==typeof s?{url:s,filename:s}:s;u=new Od(t.name+"_part_"+e,"texture",n),a.add(u),a.once("load:"+u.id,h.bind(i,e)),a.once("error:"+u.id,c.bind(i,e)),a.load(u)}else h(e,null)}}}class kp{load(t,e){e(null,null)}open(t,e){return e}}const Op="msdf",Fp="bitmap";class Bp{constructor(t,e){this.type=e&&e.type||Op,this.em=1,this.textures=t,this.intensity=0,this._data=null,this.data=e}get data(){return this._data}set data(t){if(this._data=t,t&&(void 0!==this._data.intensity&&(this.intensity=this._data.intensity),this._data.info||(this._data.info={}),(!this._data.version||this._data.version<2)&&(this._data.info.maps=[{width:this._data.info.width,height:this._data.info.height}],this._data.chars)))for(const t in this._data.chars)this._data.chars[t].map=0}}function Np(t){return t.version<3&&(t.version<2&&(t.info.maps=t.info.maps||[{width:t.info.width,height:t.info.height}]),t.chars=Object.keys(t.chars||{}).reduce((function(e,i){const n=t.chars[i],s=void 0!==n.letter?n.letter:z.fromCodePoint(i);return t.version<2&&(n.map=n.map||0),e[s]=n,e}),{}),t.version=3),t}class Up{constructor(t){this._loader=t,this.maxRetries=0}load(t,e,i){"string"==typeof t&&(t={load:t,original:t});const n=this;".json"===T.getExtension(t.original)?$.get(t.load,{retry:this.maxRetries>0,maxRetries:this.maxRetries},(function(i,s){if(i)e("Error loading font resource: "+t.original+" ["+i+"]");else{const i=Np(s);n._loadTextures(t.load.replace(".json",".png"),i,(function(t,n){if(t)return e(t);e(null,{data:i,textures:n})}))}})):(i&&i.data&&(i.data=Np(i.data)),this._loadTextures(t.load,i&&i.data,e))}_loadTextures(t,e,i){const n=e.info.maps.length;let s=0,r=null;const o=new Array(n),a=this._loader,l=function(e){const l=function(t,a){if(!r){if(t)return r=t,i(t);a.upload(),o[e]=a,s++,s===n&&i(null,o)}};0===e?a.load(t,"texture",l):a.load(t.replace(".png",e+".png"),"texture",l)};for(let t=0;t<n;t++)l(t)}open(t,e,i){let n;return n=e.textures?new Bp(e.textures,e.data):new Bp(e,null),n}patch(t,e){const i=t.resource;!i.data&&t.data?i.data=t.data:!t.data&&i.data&&(t.data=i.data),t.data&&(t.data=Np(t.data))}}const Vp=function(t,e,i){const n=i.singleVecs;let s,r;const o=e.___1;o||(s=i.tripleVecs,r=e.___2);let a=o?o[0]:s[r];t.setLocalPosition(n[a],n[a+1],n[a+2]),a=o?o[1]:s[r+1],t.setLocalEulerAngles(n[a],n[a+1],n[a+2]),a=o?o[2]:s[r+2],t.setLocalScale(n[a],n[a+1],n[a+2])},zp=function(t,e){const i=t.charCodeAt(0)-e.fieldFirstCode;return e.fieldArray[i]},Wp=function(t,e){let i=0;for(let n=0;n<t.length;n++)i=i*e.fieldCodeBase+t.charCodeAt(n)-e.fieldFirstCode;return e.fieldArray[i]};class Gp{constructor(t,e){this._node=t,this._data=e}run(){const t=Object.prototype.toString.call(this._node);return"[object Object]"===t?this._handleMap():"[object Array]"===t?this._handleArray():this._result=this._node,this._result}_handleMap(){this._result={};Object.keys(this._node).forEach(this._handleKey,this)}_handleKey(t){let e=t;const i=t.length;1===i?e=zp(t,this._data):2===i&&(e=Wp(t,this._data)),this._result[e]=new Gp(this._node[t],this._data).run()}_handleArray(){this._result=[],this._node.forEach(this._handleArElt,this)}_handleArElt(t){const e=new Gp(t,this._data).run();this._result.push(e)}}class jp{constructor(t,e){this._app=t,this._isTemplate=e}parse(t){const e={};let i=null;const n=t.compressedFormat;n&&!t.entDecompressed&&(t.entDecompressed=!0,t.entities=new Gp(t.entities,n).run());for(const s in t.entities){const r=t.entities[s],o=this._createEntity(r,n);e[s]=o,null===r.parent&&(i=o)}for(const i in t.entities){const n=e[i],s=t.entities[i].children,r=s.length;for(let t=0;t<r;t++){const i=e[s[t]];i&&n.addChild(i)}}return this._openComponentData(i,t.entities),i}_createEntity(t,e){const i=new uA;if(i.name=t.name,i.setGuid(t.resource_id),this._setPosRotScale(i,t,e),i._enabled=void 0===t.enabled||t.enabled,this._isTemplate?i._template=!0:i._enabledInHierarchy=i._enabled,i.template=t.template,t.tags)for(let e=0;e<t.tags.length;e++)i.tags.add(t.tags[e]);return t.labels&&t.labels.forEach((function(t){i.addLabel(t)})),i}_setPosRotScale(t,e,i){if(i)Vp(t,e,i);else{const i=e.position,n=e.rotation,s=e.scale;t.setLocalPosition(i[0],i[1],i[2]),t.setLocalEulerAngles(n[0],n[1],n[2]),t.setLocalScale(s[0],s[1],s[2])}}_openComponentData(t,e){const i=this._app.systems.list;let n=i.length;const s=e[t.getGuid()];for(let e=0;e<n;e++){const n=i[e],r=s.components[n.id];r&&n.addComponent(t,r)}n=s.children.length;const r=t._children;for(let t=0;t<n;t++)r[t]=this._openComponentData(r[t],e);return t}}const Hp=function(t,e,i){"string"==typeof t&&(t={load:t,original:t}),$.get(t.load,{retry:e>0,maxRetries:e},(function(e,n){if(e){let n="Error while loading scene JSON "+t.original;e.message?(n+=": "+e.message,e.stack&&(n+="\n"+e.stack)):n+=": "+e,i(n)}else i(e,n)}))};class Xp{constructor(t){this._app=t,this.maxRetries=0}load(t,e){Hp(t,this.maxRetries,e)}open(t,e){this._app.systems.script.preloading=!0;const i=new jp(this._app,!1).parse(e);return this._app.systems.script.preloading=!1,i}}class Yp{constructor(){this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t}),$.get(t.load,{retry:this.maxRetries>0,maxRetries:this.maxRetries},(function(i,n){i?e("Error loading html resource: "+t.original+" ["+i+"]"):e(null,n)}))}open(t,e){return e}patch(t,e){}}class qp{constructor(){this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t});const i={retry:this.maxRetries>0,maxRetries:this.maxRetries};t.load.startsWith("blob:")&&(i.responseType=Q.ResponseType.JSON),$.get(t.load,i,(function(i,n){i?e("Error loading JSON resource: "+t.original+" ["+i+"]"):e(null,n)}))}open(t,e){return e}patch(t,e){}}class Kp{constructor(t,e,i,n,s){this.propertyName=t,this.parent=e,this._scope=s,this._registry=i,this.id=null,this.url=null,this.asset=null,this._onAssetLoad=n.load,this._onAssetAdd=n.add,this._onAssetRemove=n.remove,this._onAssetUnload=n.unload}_bind(){this.id&&(this._onAssetLoad&&this._registry.on("load:"+this.id,this._onLoad,this),this._onAssetAdd&&this._registry.once("add:"+this.id,this._onAdd,this),this._onAssetRemove&&this._registry.on("remove:"+this.id,this._onRemove,this),this._onAssetUnload&&this._registry.on("unload:"+this.id,this._onUnload,this)),this.url&&(this._onAssetLoad&&this._registry.on("load:url:"+this.url,this._onLoad,this),this._onAssetAdd&&this._registry.once("add:url:"+this.url,this._onAdd,this),this._onAssetRemove&&this._registry.on("remove:url:"+this.url,this._onRemove,this))}_unbind(){this.id&&(this._onAssetLoad&&this._registry.off("load:"+this.id,this._onLoad,this),this._onAssetAdd&&this._registry.off("add:"+this.id,this._onAdd,this),this._onAssetRemove&&this._registry.off("remove:"+this.id,this._onRemove,this),this._onAssetUnload&&this._registry.off("unload:"+this.id,this._onUnload,this)),this.url&&(this._onAssetLoad&&this._registry.off("load:"+this.url,this._onLoad,this),this._onAssetAdd&&this._registry.off("add:"+this.url,this._onAdd,this),this._onAssetRemove&&this._registry.off("remove:"+this.url,this._onRemove,this))}_onLoad(t){this._onAssetLoad.call(this._scope,this.propertyName,this.parent,t)}_onAdd(t){this.asset=t,this._onAssetAdd.call(this._scope,this.propertyName,this.parent,t)}_onRemove(t){this._onAssetRemove.call(this._scope,this.propertyName,this.parent,t),this.asset=null}_onUnload(t){this._onAssetUnload.call(this._scope,this.propertyName,this.parent,t)}get id(){return this._id}set id(t){if(this.url)throw Error("Can't set id and url");this._unbind(),this._id=t,this.asset=this._registry.get(this._id),this._bind()}get url(){return this._url}set url(t){if(this.id)throw Error("Can't set id and url");this._unbind(),this._url=t,this.asset=this._registry.getByUrl(this._url),this._bind()}}function Zp(){return(Zp=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function Qp(){this.removeInvalid=!0,this.valid=!0,this.enumValidators={occludeSpecular:this._createEnumValidator([ei,ii,ni]),cull:this._createEnumValidator([Hn,Xn,Yn,qn]),blendType:this._createEnumValidator([Rt,It,Pt,Lt,Dt,kt,Ot,Ft,Bt,Nt,Ut]),shadingModel:this._createEnumValidator([Ne,Ue])}}Qp.prototype.setInvalid=function(t,e){this.valid=!1,this.removeInvalid&&delete e[t]},Qp.prototype.validate=function(t){var e,i,n=gl,s="path"===t.mappingFormat;for(var r in t)if(e=n[r])if(e.startsWith("enum")){var o=e.split(":")[1];this.enumValidators[o]&&(this.enumValidators[o](t[r])||this.setInvalid(r,t))}else if("number"===e)"number"!=typeof t[r]&&this.setInvalid(r,t);else if("boolean"===e)"boolean"!=typeof t[r]&&this.setInvalid(r,t);else if("string"===e)"string"!=typeof t[r]&&this.setInvalid(r,t);else if("vec2"===e)t[r]instanceof Array&&2===t[r].length||this.setInvalid(r,t);else if("rgb"===e)t[r]instanceof Array&&3===t[r].length||this.setInvalid(r,t);else if("texture"===e)s?"string"==typeof t[r]||t[null===r]||t[r]instanceof _a||this.setInvalid(r,t):"number"!=typeof t[r]&&null!==t[r]&&(t[r]instanceof _a||this.setInvalid(r,t));else if("boundingbox"===e)t[r].center&&t[r].center instanceof Array&&3===t[r].center.length||this.setInvalid(r,t),t[r].halfExtents&&t[r].halfExtents instanceof Array&&3===t[r].halfExtents.length||this.setInvalid(r,t);else if("cubemap"===e)"number"!=typeof t[r]&&null!==t[r]&&void 0!==t[r]&&(t[r]instanceof _a&&t[r].cubemap||this.setInvalid(r,t));else if("chunks"===e){var a=Object.keys(t[r]);for(i=0;i<a.length;i++)"string"!=typeof t[r][a[i]]&&this.setInvalid(a[i],t[r])}else console.error("Unknown material type: "+e);else this.valid=!1;return t.validated=!0,this.valid},Qp.prototype._createEnumValidator=function(t){return function(e){return t.indexOf(e)>=0}};class $p{constructor(){this._validator=null}parse(t){const e=this.migrate(t),i=this._validate(e),n=new wl;return this.initialize(n,i),n}initialize(t,e){e.validated||(e=this._validate(e)),e.chunks&&(t.chunks=Zp({},e.chunks));for(const i in e){const n=gl[i],s=e[i];if("vec2"===n)t[i]=new _t(s[0],s[1]);else if("rgb"===n)t[i]=new rt(s[0],s[1],s[2]);else if("texture"===n)s instanceof _a?t[i]=s:t[i]instanceof _a&&"number"==typeof s&&s>0||(t[i]=null);else if("cubemap"===n)s instanceof _a?t[i]=s:t[i]instanceof _a&&"number"==typeof s&&s>0||(t[i]=null);else if("boundingbox"===n){const e=new ht(s.center[0],s.center[1],s.center[2]),n=new ht(s.halfExtents[0],s.halfExtents[1],s.halfExtents[2]);t[i]=new Tt(e,n)}else t[i]=e[i]}t.update()}migrate(t){let e;void 0===t.shadingModel&&("blinn"===t.shader?t.shadingModel=Ue:t.shadingModel=Ne),t.shader&&delete t.shader,t.mapping_format&&(t.mappingFormat=t.mapping_format,delete t.mapping_format);const i=[["bumpMapFactor","bumpiness"],["aoUvSet","aoMapUv"],["aoMapVertexColor","aoVertexColor"],["diffuseMapVertexColor","diffuseVertexColor"],["emissiveMapVertexColor","emissiveVertexColor"],["specularMapVertexColor","specularVertexColor"],["metalnessMapVertexColor","metalnessVertexColor"],["opacityMapVertexColor","opacityVertexColor"],["glossMapVertexColor","glossVertexColor"],["lightMapVertexColor","lightVertexColor"],["diffuseMapTint","diffuseTint"],["specularMapTint","specularTint"],["emissiveMapTint","emissiveTint"],["metalnessMapTint","metalnessTint"]];for(e=0;e<i.length;e++){const n=i[e][0],s=i[e][1];void 0!==t[n]&&void 0===t[s]&&(t[s]=t[n],delete t[n])}const n=["fresnelFactor","shadowSampleType"];for(e=0;e<n.length;e++){const i=n[e];t.hasOwnProperty(i)&&delete t[i]}return t}_validate(t){return t.validated||(this._validator||(this._validator=new Qp),this._validator.validate(t)),t}}const Jp={aoMap:"white",diffuseMap:"gray",specularMap:"gray",metalnessMap:"black",glossMap:"gray",emissiveMap:"gray",normalMap:"normal",heightMap:"gray",opacityMap:"gray",sphereMap:"gray",lightMap:"white"};class tf{constructor(t){this._assets=t.assets,this._device=t.graphicsDevice,this._placeholderTextures=null,this._parser=new $p,this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t}),$.get(t.load,{retry:this.maxRetries>0,maxRetries:this.maxRetries},(function(i,n){i?e&&e("Error loading material: "+t.original+" ["+i+"]"):e&&(n._engine=!0,e(null,n))}))}open(t,e){const i=this._parser.parse(e);return e._engine&&(i._data=e,delete e._engine),i}_createPlaceholders(){this._placeholderTextures={};const t={white:[255,255,255,255],gray:[128,128,128,255],black:[0,0,0,255],normal:[128,128,255,255]};for(const e in t){if(!t.hasOwnProperty(e))continue;this._placeholderTextures[e]=new _a(this._device,{width:2,height:2,format:ys}),this._placeholderTextures[e].name="placeholder";const i=this._placeholderTextures[e].lock();for(let n=0;n<4;n++)for(let s=0;s<4;s++)i[4*n+s]=t[e][s];this._placeholderTextures[e].unlock()}}patch(t,e){t.resource._data&&(t._data=t.resource._data,delete t.resource._data),t.data.name=t.name,t.resource.name=t.name,this._bindAndAssignAssets(t,e),t.off("unload",this._onAssetUnload,this),t.on("unload",this._onAssetUnload,this)}_onAssetUnload(t){delete t.data.parameters,delete t.data.chunks,delete t.data.name}_assignTexture(t,e,i){e.resource[t]=i}_getPlaceholderTexture(t){this._placeholderTextures||this._createPlaceholders();const e=Jp[t];return this._placeholderTextures[e]}_assignPlaceholderTexture(t,e){e.resource[t]=this._getPlaceholderTexture(t,e)}_onTextureLoad(t,e,i){this._assignTexture(t,e,i.resource),e.resource.update()}_onTextureAdd(t,e,i){this._assets.load(i)}_onTextureRemoveOrUnload(t,e,i){const n=e.resource;n&&e.resource[t]===i.resource&&(this._assignPlaceholderTexture(t,e),n.update())}_assignCubemap(t,e,i){e.resource[t]=i[0],7===i.length&&(e.resource.prefilteredCubeMap128=i[1],e.resource.prefilteredCubeMap64=i[2],e.resource.prefilteredCubeMap32=i[3],e.resource.prefilteredCubeMap16=i[4],e.resource.prefilteredCubeMap8=i[5],e.resource.prefilteredCubeMap4=i[6])}_onCubemapLoad(t,e,i){this._assignCubemap(t,e,i.resources),this._parser.initialize(e.resource,e.data)}_onCubemapAdd(t,e,i){e.data.shadingModel===Ne&&(e.loadFaces=!0),this._assets.load(i)}_onCubemapRemoveOrUnload(t,e,i){const n=e.resource;e.data.prefilteredCubeMap128===i.resources[1]&&(this._assignCubemap(t,e,[null,null,null,null,null,null,null]),n.update())}_bindAndAssignAssets(t,e){const i=this._parser.migrate(t.data),n=t.resource,s="path"===i.mappingFormat,r=bl;let o,a,l;for(o=0;o<r.length;o++){a=r[o],l=n._assetReferences[a];const h=i[a],c=n[a],_=c===this._getPlaceholderTexture(a,t),u=i.validated;!h||c&&u&&!_?l&&(s?l.url=null:l.id=null):(l||(l=new Kp(a,t,e,{load:this._onTextureLoad,add:this._onTextureAdd,remove:this._onTextureRemoveOrUnload,unload:this._onTextureRemoveOrUnload},this),n._assetReferences[a]=l),s?l.url=t.getAbsoluteUrl(h):l.id=h,l.asset&&(l.asset.resource?this._assignTexture(a,t,l.asset.resource):this._assignPlaceholderTexture(a,t),e.load(l.asset)))}const h=yl;for(o=0;o<h.length;o++)a=h[o],l=n._assetReferences[a],i[a]&&!t.data.prefilteredCubeMap128&&(l||(l=new Kp(a,t,e,{load:this._onCubemapLoad,add:this._onCubemapAdd,remove:this._onCubemapRemoveOrUnload,unload:this._onCubemapRemoveOrUnload},this),n._assetReferences[a]=l),s?l.url=i[a]:l.id=i[a],l.asset&&(l.asset.loaded&&this._assignCubemap(a,t,l.asset.resources),e.load(l.asset)));this._parser.initialize(n,i)}}class ef{constructor(t,e){this._device=t,this._defaultMaterial=e}parse(t){const e=_p.parse("filename.glb",t,this._device);if(e){const t=Rp.createModel(e,this._defaultMaterial);return e.destroy(),t}return null}}class nf{constructor(){this.index=0,this.boneIndices=[0,0,0,0]}}class sf{constructor(){this.partition=0,this.vertexStart=0,this.vertexCount=0,this.indexStart=0,this.indexCount=0,this.boneIndices=[],this.vertices=[],this.indices=[],this.indexMap={},this.originalMesh=null}addVertex(t,e,i){var n=-1;if(void 0!==this.indexMap[e])n=this.indexMap[e],this.indices.push(n);else{for(var s=0;s<4;s++)if(0!==i.blendWeight.data[4*e+s]){var r=i.blendIndices.data[4*t.index+s];t.boneIndices[s]=this.getBoneRemap(r)}n=this.vertices.length,this.indices.push(n),this.vertices.push(t),this.indexMap[e]=n}}addPrimitive(t,e,i,n){var s,r,o=[],a=0,l=t.length;for(s=0;s<l;s++)for(var h=t[s].index,c=0;c<4;c++)if(i.blendWeight.data[4*h+c]>0){var _=i.blendIndices.data[4*h+c],u=!0;for(r=0;r<a;r++)if(o[r]===_){u=!1;break}if(u)o[a]=_,a+=-1===this.getBoneRemap(_)?1:0}if(this.boneIndices.length+a>n)return!1;for(s=0;s<a;s++)this.boneIndices.push(o[s]);for(s=0;s<l;s++)this.addVertex(t[s],e[s],i);return!0}getBoneRemap(t){for(var e=0;e<this.boneIndices.length;e++)if(this.boneIndices[e]===t)return e;return-1}}function rf(t,e,i){var n,s,r,o;!function(t){var e,i=t.vertices,n=t.skins,s=t.meshes,r=t.meshInstances;for(e=0;e<s.length;e++)s[e].vertices=i[s[e].vertices],void 0!==s[e].skin&&(s[e].skin=n[s[e].skin]);for(e=0;e<r.length;e++)r[e].mesh=s[r[e].mesh]}(t);var a,l=t.vertices,h=t.skins,c=t.meshes,_=t.meshInstances,u=function(t){var e=new nf;return e.index=t,e};for(n=h.length-1;n>=0;n--)if(h[n].boneNames.length>i){var d=h.splice(n,1)[0],p=[];for(s=0;s<c.length;s++)c[s].skin===d&&p.push(c[s]);for(s=0;s<p.length;s++)-1!==(o=c.indexOf(p[s]))&&c.splice(o,1);if(0===p.length)throw new Error("partitionSkin: There should be at least one mesh that references a skin");var f,m=p[0].vertices;for(s=1;s<p.length;s++)if(p[s].vertices!==m)throw new Error("partitionSkin: All meshes that share a skin should also share the same vertex buffer");var g=[],b=[],y=[],v=0;for(s=0;s<p.length;s++){for(var S=(a=p[s]).indices,x=a.base;x<a.base+a.count;){o=S[x++],b[0]=u(o),y[0]=o,o=S[x++],b[1]=u(o),y[1]=o,o=S[x++],b[2]=u(o),y[2]=o;for(var w=!1,C=v;C<g.length;C++)if((f=g[C]).addPrimitive(b,y,m,i)){w=!0;break}w||((f=new sf).originalMesh=a,f.addPrimitive(b,y,m,i),g.push(f))}v=g.length}var T=[],A=[];for(s=0;s<g.length;s++)if((f=g[s]).vertices.length&&f.indices.length){var E,M,R=T.length,I=f.vertices.length,P=A.length,L=f.indices.length;for(f.partition=s,f.vertexStart=R,f.vertexCount=I,f.indexStart=P,f.indexCount=L,E=0,M=R;E<I;)T[M++]=f.vertices[E++];for(E=0,M=P;E<L;)A[M++]=f.indices[E++]+R}var D,k,O,F,B=[];for(s=0;s<g.length;s++){f=g[s];var N=[],U=[];for(r=0;r<f.boneIndices.length;r++)N.push(d.inverseBindMatrices[f.boneIndices[r]]),U.push(d.boneNames[f.boneIndices[r]]);var V={inverseBindMatrices:N,boneNames:U};B.push(V),h.push(V)}var z={};for(k in m)z[k]={components:m[k].components,data:[],type:m[k].type};for(k in m)if("blendIndices"===k){var W=z[k].data;for(s=0;s<T.length;s++){var G=T[s].boneIndices;W.push(G[0],G[1],G[2],G[3])}}else for(O=(D=m[k]).data,F=D.components,s=0;s<T.length;s++)for(o=T[s].index,r=0;r<F;r++)z[k].data.push(O[o*F+r]);for(l[l.indexOf(m)]=z,s=0;s<g.length;s++)for(f=g[s],a={aabb:{min:[0,0,0],max:[0,0,0]},vertices:z,skin:B[s],indices:A.splice(0,f.indexCount),type:"triangles",base:0,count:f.indexCount},c.push(a),r=_.length-1;r>=0;r--)_[r].mesh===f.originalMesh&&(_.push({mesh:a,node:_[r].node}),e&&e.push({material:e[r].material,path:e[r].path}));for(s=0;s<g.length;s++)for(f=g[s],r=_.length-1;r>=0;r--)_[r].mesh===f.originalMesh&&(_.splice(r,1),e&&e.splice(r,1))}!function(t){var e,i=t.vertices,n=t.skins,s=t.meshes,r=t.meshInstances;for(e=0;e<s.length;e++)s[e].vertices=i.indexOf(s[e].vertices),void 0!==s[e].skin&&(s[e].skin=n.indexOf(s[e].skin));for(e=0;e<r.length;e++)r[e].mesh=s.indexOf(r[e].mesh)}(t)}const of={points:Gs,lines:js,lineloop:Hs,linestrip:Xs,triangles:Ys,trianglestrip:qs,trianglefan:Ks},af={int8:Qr,uint8:$r,int16:Jr,uint16:to,int32:eo,uint32:io,float32:no};class lf{constructor(t,e){this._device=t,this._defaultMaterial=e}parse(t){const e=t.model;if(!e)return null;if(e.version<=1)return null;const i=this._parseNodes(t),n=this._parseSkins(t,i),s=this._parseVertexBuffers(t),r=this._parseIndexBuffers(t,s),o=this._parseMorphs(t,i,s),a=this._parseMeshes(t,n.skins,o.morphs,s,r.buffer,r.data),l=this._parseMeshInstances(t,i,a,n.skins,n.instances,o.morphs,o.instances),h=new Uu;return h.graph=i[0],h.meshInstances=l,h.skinInstances=n.instances,h.morphInstances=o.instances,h.getGraph().syncHierarchy(),h}_parseNodes(t){const e=t.model,i=[];let n;for(n=0;n<e.nodes.length;n++){const t=e.nodes[n],s=new La(t.name);s.setLocalPosition(t.position[0],t.position[1],t.position[2]),s.setLocalEulerAngles(t.rotation[0],t.rotation[1],t.rotation[2]),s.setLocalScale(t.scale[0],t.scale[1],t.scale[2]),s.scaleCompensation=!!t.scaleCompensation,i.push(s)}for(n=1;n<e.parents.length;n++)i[e.parents[n]].addChild(i[n]);return i}_parseSkins(t,e){const i=t.model,n=[],s=[];let r,o;if(!this._device.supportsBoneTextures&&i.skins.length>0){rf(i,null,this._device.getBoneLimit())}for(r=0;r<i.skins.length;r++){const t=i.skins[r],a=[];for(o=0;o<t.inverseBindMatrices.length;o++){const e=t.inverseBindMatrices[o];a[o]=(new bt).set(e)}const l=new Ju(this._device,a,t.boneNames);n.push(l);const h=new Vh(l),c=[];for(o=0;o<l.boneNames.length;o++){const t=l.boneNames[o],i=e[0].findByName(t);c.push(i)}h.bones=c,s.push(h)}return{skins:n,instances:s}}_getMorphVertexCount(t,e,i){for(let n=0;n<t.meshes.length;n++){const s=t.meshes[n];if(s.morph===e){return i[s.vertices].numVertices}}}_parseMorphs(t,e,i){const n=t.model,s=[],r=[];let o,a,l,h,c,_;if(n.morphs){const t=function(t,e,i){const n=new Float32Array(3*i);for(let i=0;i<e.length;i++){const s=3*e[i];n[s]=t[3*i],n[s+1]=t[3*i+1],n[s+2]=t[3*i+2]}return n};for(o=0;o<n.morphs.length;o++){for(h=n.morphs[o].targets,_=[],l=this._getMorphVertexCount(n,o,i),a=0;a<h.length;a++){const e=h[a].aabb,i=e.min,n=e.max,s=new Tt(new ht(.5*(n[0]+i[0]),.5*(n[1]+i[1]),.5*(n[2]+i[2])),new ht(.5*(n[0]-i[0]),.5*(n[1]-i[1]),.5*(n[2]-i[2]))),r=h[a].indices;let o=h[a].deltaPositions,u=h[a].deltaNormals;r&&(o=t(o,r,l),u=t(u,r,l)),c=new $u({deltaPositions:o,deltaNormals:u,name:h[a].name,aabb:s}),_.push(c)}const e=new Bu(_,this._device);s.push(e);const u=new Nu(e);r.push(u)}}return{morphs:s,instances:r}}_parseVertexBuffers(t){const e=t.model,i=[],n={position:Zs,normal:Qs,tangent:$s,blendWeight:Js,blendIndices:tr,color:er,texCoord0:nr,texCoord1:sr,texCoord2:rr,texCoord3:or,texCoord4:ar,texCoord5:lr,texCoord6:hr,texCoord7:cr};for(let t=0;t<e.vertices.length;t++){const s=e.vertices[t],r=[];for(const t in s){const e=s[t];r.push({semantic:n[t],components:e.components,type:af[e.type],normalize:n[t]===er})}const o=new No(this._device,r),a=s.position.data.length/s.position.components,l=new Fo(this._device,o,a),h=new uh(l);for(let t=0;t<a;t++){for(const e in s){const i=s[e];switch(i.components){case 1:h.element[n[e]].set(i.data[t]);break;case 2:h.element[n[e]].set(i.data[2*t],1-i.data[2*t+1]);break;case 3:h.element[n[e]].set(i.data[3*t],i.data[3*t+1],i.data[3*t+2]);break;case 4:h.element[n[e]].set(i.data[4*t],i.data[4*t+1],i.data[4*t+2],i.data[4*t+3])}}h.next()}h.end(),i.push(l)}return i}_parseIndexBuffers(t,e){const i=t.model;let n,s=null,r=null,o=0;for(n=0;n<i.meshes.length;n++){const t=i.meshes[n];void 0!==t.indices&&(o+=t.indices.length)}let a=0;for(n=0;n<e.length;n++)a=Math.max(a,e[n].numVertices);return o>0&&(a>65535&&this._device.extUintElement?(s=new $l(this._device,_s,o),r=new Uint32Array(s.lock())):(s=new $l(this._device,cs,o),r=new Uint16Array(s.lock()))),{buffer:s,data:r}}_parseMeshes(t,e,i,n,s,r){const o=t.model,a=[];let l=0;for(let t=0;t<o.meshes.length;t++){const h=o.meshes[t],c=h.aabb,_=c.min,u=c.max,d=new Tt(new ht(.5*(u[0]+_[0]),.5*(u[1]+_[1]),.5*(u[2]+_[2])),new ht(.5*(u[0]-_[0]),.5*(u[1]-_[1]),.5*(u[2]-_[2]))),p=void 0!==h.indices,f=new xh(this._device);f.vertexBuffer=n[h.vertices],f.indexBuffer[0]=p?s:null,f.primitive[0].type=of[h.type],f.primitive[0].base=p?h.base+l:h.base,f.primitive[0].count=h.count,f.primitive[0].indexed=p,f.skin=void 0!==h.skin?e[h.skin]:null,f.morph=void 0!==h.morph?i[h.morph]:null,f.aabb=d,p&&(r.set(h.indices,l),l+=h.indices.length),a.push(f)}return null!==s&&s.unlock(),a}_parseMeshInstances(t,e,i,n,s,r,o){const a=t.model,l=[];let h;for(h=0;h<a.meshInstances.length;h++){const t=a.meshInstances[h],c=e[t.node],_=i[t.mesh],u=new Kh(_,this._defaultMaterial,c);if(_.skin){const t=n.indexOf(_.skin);u.skinInstance=s[t]}if(_.morph){const t=r.indexOf(_.morph);u.morphInstance=o[t]}l.push(u)}return l}}class hf{constructor(t,e){this._device=t,this._parsers=[],this._defaultMaterial=e,this.maxRetries=0,this.addParser(new lf(this._device,this._defaultMaterial),(function(t,e){return".json"===T.getExtension(t)})),this.addParser(new ef(this._device,this._defaultMaterial),(function(t,e){return".glb"===T.getExtension(t)}))}load(t,e){"string"==typeof t&&(t={load:t,original:t});const i={retry:this.maxRetries>0,maxRetries:this.maxRetries};(t.load.startsWith("blob:")||t.load.startsWith("data:"))&&(".glb"===T.getExtension(t.original).toLowerCase()?i.responseType=Q.ResponseType.ARRAY_BUFFER:i.responseType=Q.ResponseType.JSON),$.get(t.load,i,(function(i,n){e&&(i?e("Error loading model: "+t.original+" ["+i+"]"):e(null,n))}))}open(t,e){for(let i=0;i<this._parsers.length;i++){const n=this._parsers[i];if(n.decider(t,e))return n.parser.parse(e)}return null}patch(t,e){if(!t.resource)return;const i=t.data,n=this;t.resource.meshInstances.forEach((function(s,r){if(i.mapping){const o=function t(i){i.resource?s.material=i.resource:(i.once("load",t),e.load(i)),i.once("remove",(function(t){s.material===t.resource&&(s.material=n._defaultMaterial)}))};if(!i.mapping[r])return void(s.material=n._defaultMaterial);const a=i.mapping[r].material,l=i.mapping[r].path;let h;if(void 0!==a)a?(h=e.get(a),h?o(h):e.once("add:"+a,o)):s.material=n._defaultMaterial;else if(l){const n=t.getAbsoluteUrl(i.mapping[r].path);h=e.getByUrl(n),h?o(h):e.once("add:url:"+n,o)}}}))}addParser(t,e){this._parsers.push({parser:t,decider:e})}}function cf(t){const e=this;if(!e.resource)return;const i=t.resource,n=i.renders&&i.renders[e.data.renderIndex];n&&(e.resource.meshes=n.resource.meshes)}function _f(t){const e=this;e.registry.off("load:"+t.id,cf,e),e.registry.on("load:"+t.id,cf,e),e.registry.off("remove:"+t.id,uf,e),e.registry.once("remove:"+t.id,uf,e),t.resource?cf.call(e,t):e.registry.load(t)}function uf(t){const e=this;e.registry.off("load:"+t.id,cf,e),e.resource&&e.resource.destroy()}class df{constructor(t){this._registry=t}load(t,e,i){}open(t,e){return new td}patch(t,e){if(!t.data.containerAsset)return;const i=e.get(t.data.containerAsset);i?_f.call(t,i):e.once("add:"+t.data.containerAsset,_f,t)}}class pf{constructor(t){this._handlers={},this._requests={},this._cache={},this._app=t}addHandler(t,e){this._handlers[t]=e,e._loader=this}removeHandler(t){delete this._handlers[t]}getHandler(t){return this._handlers[t]}load(t,e,i,n){const s=this._handlers[e];if(!s){return void i("No handler for asset type: "+e)}if(!t)return void this._loadNull(s,i,n);const r=t+e;if(void 0!==this._cache[r])i(null,this._cache[r]);else if(this._requests[r])this._requests[r].push(i);else{this._requests[r]=[i];const e=this,o=function(t,i){t?e._onFailure(r,t):s.load(i,(function(t,o,a){if(e._requests[r])if(t)e._onFailure(r,t);else try{e._onSuccess(r,s.open(i.original,o,n),a)}catch(t){e._onFailure(r,t)}}),n)},a=t.split("?")[0];if(this._app.enableBundles&&this._app.bundles.hasUrl(a)){if(!this._app.bundles.canLoadUrl(a))return void o("Bundle for "+t+" not loaded yet");this._app.bundles.loadUrl(a,(function(t,e){o(t,{load:e,original:a})}))}else o(null,{load:t,original:n&&n.file.filename||t})}}_loadNull(t,e,i){t.load(null,(function(n,s,r){if(n)e(n);else try{e(null,t.open(null,s,i),r)}catch(t){e(t)}}),i)}_onSuccess(t,e,i){this._cache[t]=e;for(let n=0;n<this._requests[t].length;n++)this._requests[t][n](null,e,i);delete this._requests[t]}_onFailure(t,e){if(console.error(e),this._requests[t]){for(let i=0;i<this._requests[t].length;i++)this._requests[t][i](e);delete this._requests[t]}}open(t,e){const i=this._handlers[t];return i?i.open(null,e):(console.warn("No resource handler found for: "+t),e)}patch(t,e){const i=this._handlers[t.type];i?i.patch&&i.patch(t,e):console.warn("No resource handler found for: "+t.type)}clearCache(t,e){delete this._cache[t+e]}getFromCache(t,e){if(this._cache[t+e])return this._cache[t+e]}enableRetry(t=5){t=Math.max(0,t)||0;for(const e in this._handlers)this._handlers[e].maxRetries=t}disableRetry(){for(const t in this._handlers)this._handlers[t].maxRetries=0}destroy(){this._handlers={},this._requests={},this._cache={}}}class ff{constructor(t){this._app=t,this.maxRetries=0}load(t,e){Hp(t,this.maxRetries,e)}open(t,e){this._app.systems.script.preloading=!0;const i=new jp(this._app,!1).parse(e),n=this._app.scene;return n.root=i,this._app.applySceneSettings(e.settings),this._app.systems.script.preloading=!1,n}patch(t,e){}}let mf=!1,gf=!1;const bf={app:null,create:function(t,e){if(!mf)return;const i=e(bf.app);i._pcScriptName=t,yf._push(i),this.fire("created",t,e)},attribute:function(t,e,i,n){},createLoadingScreen:function(t){if(gf)return;gf=!0;t(Ka())}};Object.defineProperty(bf,"legacy",{get:function(){return mf},set:function(t){mf=t}}),w.attach(bf);class yf{constructor(t){this._app=t,this._scripts={},this._cache={}}static _push(t){bf.legacy&&yf._types.length>0?console.assert("Script Ordering Error. Contact support@playcanvas.com"):yf._types.push(t)}load(t,e){"string"==typeof t&&(t={load:t,original:t});const i=this;bf.app=this._app,this._loadScript(t.load,(t,n,s)=>{if(t)e(t);else if(bf.legacy){let t=null;yf._types.length&&(t=yf._types.pop()),t?this._scripts[n]=t:t=null,e(null,t,s)}else{const t={};for(let e=0;e<yf._types.length;e++)t[yf._types[e].name]=yf._types[e];yf._types.length=0,e(null,t,s),delete i._loader._cache[n+"script"]}})}open(t,e){return e}patch(t,e){}_loadScript(t,e){const i=document.head,n=document.createElement("script");this._cache[t]=n,n.async=!1,n.addEventListener("error",(function(t){e("Script: "+t.target.src+" failed to load")}),!1);let s=!1;n.onload=n.onreadystatechange=function(){s||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(s=!0,e(null,t,n))},n.src=t,i.appendChild(n)}}yf._types=[];class vf{constructor(){this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t}),$.get(t.load,{retry:this.maxRetries>0,maxRetries:this.maxRetries},(function(i,n){i?e("Error loading shader resource: "+t.original+" ["+i+"]"):e(null,n)}))}open(t,e){return e}patch(t,e){}}const Sf=[0,0,1,0,0,1,0,0,1,0,0,1],xf=[0,1,3,2,3,1];class wf extends x{constructor(t,e){super(),this._device=t,this._pixelsPerUnit=e&&void 0!==e.pixelsPerUnit?e.pixelsPerUnit:1,this._renderMode=e&&void 0!==e.renderMode?e.renderMode:ki,this._atlas=e&&void 0!==e.atlas?e.atlas:null,this._frameKeys=e&&void 0!==e.frameKeys?e.frameKeys:null,this._meshes=[],this._updatingProperties=!1,this._meshesDirty=!1,this._atlas&&this._frameKeys&&this._createMeshes()}_createMeshes(){const t=this._meshes.length;for(let e=0;e<t;e++){const t=this._meshes[e];t&&t.destroy()}const e=this._frameKeys.length;this._meshes=new Array(e);const i=this.renderMode===Oi||this._renderMode===Fi?this._create9SliceMesh:this._createSimpleMesh;for(let t=0;t<e;t++){const e=this._atlas.frames[this._frameKeys[t]];this._meshes[t]=e?i.call(this,e):null}this.fire("set:meshes")}_createSimpleMesh(t){const e=t.rect,i=this._atlas.texture.width,n=this._atlas.texture.height,s=e.z/this._pixelsPerUnit,r=e.w/this._pixelsPerUnit,o=t.pivot.x,a=t.pivot.y,l=[-o*s,-a*r,0,(1-o)*s,-a*r,0,(1-o)*s,(1-a)*r,0,-o*s,(1-a)*r,0],h=e.x/i,c=1-e.y/n,_=(e.x+e.z)/i,u=1-(e.y+e.w)/n,d=[h,c,_,c,_,u,h,u];return Ah(this._device,l,{uvs:d,normals:Sf,indices:xf})}_create9SliceMesh(){const t=_t.ONE,e=[],i=[],n=[],s=[];let r=0;for(let o=0;o<=3;o++){const a=0===o||3===o?0:1;for(let l=0;l<=3;l++){const h=-t.x+2*t.x*(o<=1?0:3)/3,c=0,_=-(-t.y+2*t.y*(l<=1?0:3)/3),u=0===l||3===l?0:1;e.push(-h,c,_),i.push(0,1,0),n.push(a,u),o<3&&l<3&&(s.push(r+3+1,r+1,r),s.push(r+3+1,r+3+2,r+1)),r++}}const o={normals:i,uvs:n,indices:s};return Ah(this._device,e,o)}_onSetFrames(t){this._updatingProperties?this._meshesDirty=!0:this._createMeshes()}_onFrameChanged(t,e){const i=this._frameKeys.indexOf(t);i<0||(e?this.renderMode===ki&&(this._meshes[i]=this._createSimpleMesh(e)):this._meshes[i]=null,this.fire("set:meshes"))}_onFrameRemoved(t){const e=this._frameKeys.indexOf(t);e<0||(this._meshes[e]=null,this.fire("set:meshes"))}startUpdate(){this._updatingProperties=!0,this._meshesDirty=!1}endUpdate(){this._updatingProperties=!1,this._meshesDirty&&this._atlas&&this._frameKeys&&this._createMeshes(),this._meshesDirty=!1}destroy(){for(const t of this._meshes)t&&t.destroy();this._meshes.length=0}get frameKeys(){return this._frameKeys}set frameKeys(t){this._frameKeys=t,this._atlas&&this._frameKeys&&(this._updatingProperties?this._meshesDirty=!0:this._createMeshes()),this.fire("set:frameKeys",t)}get atlas(){return this._atlas}set atlas(t){t!==this._atlas&&(this._atlas&&(this._atlas.off("set:frames",this._onSetFrames,this),this._atlas.off("set:frame",this._onFrameChanged,this),this._atlas.off("remove:frame",this._onFrameRemoved,this)),this._atlas=t,this._atlas&&this._frameKeys&&(this._atlas.on("set:frames",this._onSetFrames,this),this._atlas.on("set:frame",this._onFrameChanged,this),this._atlas.on("remove:frame",this._onFrameRemoved,this),this._updatingProperties?this._meshesDirty=!0:this._createMeshes()),this.fire("set:atlas",t))}get pixelsPerUnit(){return this._pixelsPerUnit}set pixelsPerUnit(t){this._pixelsPerUnit!==t&&(this._pixelsPerUnit=t,this.fire("set:pixelsPerUnit",t),this._atlas&&this._frameKeys&&this.renderMode===ki&&(this._updatingProperties?this._meshesDirty=!0:this._createMeshes()))}get renderMode(){return this._renderMode}set renderMode(t){if(this._renderMode===t)return;const e=this._renderMode;this._renderMode=t,this.fire("set:renderMode",t),e!==ki&&t!==ki||this._atlas&&this._frameKeys&&(this._updatingProperties?this._meshesDirty=!0:this._createMeshes())}get meshes(){return this._meshes}}function Cf(t){const e=this;e.resource&&(e.resource.atlas=t.resource)}function Tf(t){this.registry.load(t)}class Af{constructor(t,e){this._assets=t,this._device=e,this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t}),".json"===T.getExtension(t.original)&&$.get(t.load,{retry:this.maxRetries>0,maxRetries:this.maxRetries},(function(t,i){t?e(t):e(null,i)}))}open(t,e){const i=new wf(this._device);return t&&(i.__data=e),i}patch(t,e){const i=t.resource;if(i.__data&&(t.data.pixelsPerUnit=i.__data.pixelsPerUnit,t.data.renderMode=i.__data.renderMode,t.data.frameKeys=i.__data.frameKeys,i.__data.textureAtlasAsset)){const n=e.getByUrl(i.__data.textureAtlasAsset);n?t.data.textureAtlasAsset=n.id:console.warn("Could not find textureatlas with url: "+i.__data.textureAtlasAsset)}i.startUpdate(),i.renderMode=t.data.renderMode,i.pixelsPerUnit=t.data.pixelsPerUnit,i.frameKeys=t.data.frameKeys,this._updateAtlas(t),i.endUpdate(),t.off("change",this._onAssetChange,this),t.on("change",this._onAssetChange,this)}_updateAtlas(t){const e=t.resource;if(!t.data.textureAtlasAsset)return void(e.atlas=null);this._assets.off("load:"+t.data.textureAtlasAsset,Cf,t),this._assets.on("load:"+t.data.textureAtlasAsset,Cf,t);const i=this._assets.get(t.data.textureAtlasAsset);i&&i.resource?e.atlas=i.resource:i?this._assets.load(i):(this._assets.off("add:"+t.data.textureAtlasAsset,Tf,t),this._assets.on("add:"+t.data.textureAtlasAsset,Tf,t))}_onAssetChange(t,e,i,n){"data"===e&&i&&i.textureAtlasAsset&&n&&i.textureAtlasAsset!==n.textureAtlasAsset&&(this._assets.off("load:"+n.textureAtlasAsset,Cf,t),this._assets.off("add:"+n.textureAtlasAsset,Tf,t))}}class Ef{constructor(t,e){this._app=t,this._data=e,this._templateRoot=null}instantiate(){return this._templateRoot||this._parseTemplate(),this._templateRoot.clone()}_parseTemplate(){const t=new jp(this._app,!0);this._templateRoot=t.parse(this._data)}}class Mf{constructor(t){this._app=t,this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t});const i={retry:this.maxRetries>0,maxRetries:this.maxRetries};$.get(t.load,i,(function(i,n){i?e("Error requesting template: "+t.original):e(i,n)}))}open(t,e){return new Ef(this._app,e)}}class Rf{constructor(){this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t}),$.get(t.load,{retry:this.maxRetries>0,maxRetries:this.maxRetries},(function(i,n){i?e("Error loading text resource: "+t.original+" ["+i+"]"):e(null,n)}))}open(t,e){return e}patch(t,e){}}class If extends x{constructor(){super(),this._texture=null,this._frames=null}setFrame(t,e){let i=this._frames[t];i?(i.rect.copy(e.rect),i.pivot.copy(e.pivot),i.border.copy(e.border)):(i={rect:e.rect.clone(),pivot:e.pivot.clone(),border:e.border.clone()},this._frames[t]=i),this.fire("set:frame",t.toString(),i)}removeFrame(t){const e=this._frames[t];e&&(delete this._frames[t],this.fire("remove:frame",t.toString(),e))}destroy(){this._texture&&this._texture.destroy()}get texture(){return this._texture}set texture(t){this._texture=t,this.fire("set:texture",t)}get frames(){return this._frames}set frames(t){this._frames=t,this.fire("set:frames",t)}}const Pf={repeat:dn,clamp:pn,mirror:fn},Lf={nearest:Kn,linear:Zn,nearest_mip_nearest:Qn,linear_mip_nearest:Jn,nearest_mip_linear:$n,linear_mip_linear:ts},Df=/^data\.frames\.(\d+)$/;class kf{constructor(t){this._loader=t,this.maxRetries=0}load(t,e){"string"==typeof t&&(t={load:t,original:t});const i=this,n=this._loader.getHandler("texture");if(".json"!==T.getExtension(t.original))return n.load(t,e);$.get(t.load,{retry:this.maxRetries>0,maxRetries:this.maxRetries},(function(n,s){if(n)e(n);else{const n=t.original.replace(".json",".png");i._loader.load(n,"texture",(function(t,i){t?e(t):e(null,{data:s,texture:i})}))}}))}open(t,e){const i=new If;if(e.texture&&e.data)i.texture=e.texture,i.__data=e.data;else{const n=this._loader.getHandler("texture").open(t,e);if(!n)return null;i.texture=n}return i}patch(t,e){t.resource.__data&&(void 0!==t.resource.__data.minfilter&&(t.data.minfilter=t.resource.__data.minfilter),void 0!==t.resource.__data.magfilter&&(t.data.magfilter=t.resource.__data.magfilter),void 0!==t.resource.__data.addressu&&(t.data.addressu=t.resource.__data.addressu),void 0!==t.resource.__data.addressv&&(t.data.addressv=t.resource.__data.addressv),void 0!==t.resource.__data.mipmaps&&(t.data.mipmaps=t.resource.__data.mipmaps),void 0!==t.resource.__data.anisotropy&&(t.data.anisotropy=t.resource.__data.anisotropy),void 0!==t.resource.__data.rgbm&&(t.data.rgbm=!!t.resource.__data.rgbm),t.data.frames=t.resource.__data.frames,delete t.resource.__data);const i=t.resource.texture;if(i&&(i.name=t.name,t.data.hasOwnProperty("minfilter")&&i.minFilter!==Lf[t.data.minfilter]&&(i.minFilter=Lf[t.data.minfilter]),t.data.hasOwnProperty("magfilter")&&i.magFilter!==Lf[t.data.magfilter]&&(i.magFilter=Lf[t.data.magfilter]),t.data.hasOwnProperty("addressu")&&i.addressU!==Pf[t.data.addressu]&&(i.addressU=Pf[t.data.addressu]),t.data.hasOwnProperty("addressv")&&i.addressV!==Pf[t.data.addressv]&&(i.addressV=Pf[t.data.addressv]),t.data.hasOwnProperty("mipmaps")&&i.mipmaps!==t.data.mipmaps&&(i.mipmaps=t.data.mipmaps),t.data.hasOwnProperty("anisotropy")&&i.anisotropy!==t.data.anisotropy&&(i.anisotropy=t.data.anisotropy),t.data.hasOwnProperty("rgbm"))){const e=t.data.rgbm?Vr:Ur;i.type!==e&&(i.type=e)}t.resource.texture=i;const n={};for(const e in t.data.frames){const i=t.data.frames[e];n[e]={rect:new ut(i.rect),pivot:new _t(i.pivot),border:new ut(i.border)}}t.resource.frames=n,t.off("change",this._onAssetChange,this),t.on("change",this._onAssetChange,this)}_onAssetChange(t,e,i){let n;if("data"===e||"data.frames"===e){const e={};for(const t in i.frames)n=i.frames[t],e[t]={rect:new ut(n.rect),pivot:new _t(n.pivot),border:new ut(n.border)};t.resource.frames=e}else{const s=e.match(Df);if(s){const e=s[1];i?(t.resource.frames[e]?(n=t.resource.frames[e],n.rect.set(i.rect[0],i.rect[1],i.rect[2],i.rect[3]),n.pivot.set(i.pivot[0],i.pivot[1]),n.border.set(i.border[0],i.border[1],i.border[2],i.border[3])):t.resource.frames[e]={rect:new ut(i.rect),pivot:new _t(i.pivot),border:new ut(i.border)},t.resource.fire("set:frame",e,t.resource.frames[e])):t.resource.frames[e]&&(delete t.resource.frames[e],t.resource.fire("remove:frame",e))}}}}function Of(){const t=0,e=1,i=2,n=3,s=8,r=9,o=10,a=11,l=12,h=13,c=14,_=16,u={astc:o,dxt:i,etc1:t,etc2:t,pvr:s,atc:a,none:c},d={astc:o,dxt:n,etc1:_,etc2:e,pvr:r,atc:l,none:_},p=21,f=22,m=23,g=8,b=10,y=26,v=27,S=28,x=29,w=30,C=7,T=3,A=5,E=(u,d)=>{switch(u){case t:return d.formats.etc1?p:f;case e:return m;case i:return g;case n:return b;case s:return y;case r:return v;case o:return S;case a:return x;case l:return w;case h:return C;case c:return T;case _:return A}},M=t=>{const e=function(t,e){const i=t*(2/255)-1,n=e*(2/255)-1,s=Math.sqrt(1-Math.min(1,i*i+n*n));return Math.max(0,Math.min(255,Math.floor(.5*(s+1)*255)))};for(let i=0;i<t.length;i+=4){const n=t[i+3],s=t[i+1];t[i+0]=n,t[i+2]=e(n,s),t[i+3]=255}return t},R=t=>t!==h&&t!==c&&t!==_,I=t=>{const e=new Uint16Array(t.length/4);for(let i=0;i<t.length;i+=4){const n=t[i+0],s=t[i+1],r=t[i+2];e[i/4]=(248&n)<<8|(252&s)<<3|r>>3}return e},P=()=>"undefined"!=typeof performance?performance.now():0;let L,D,k;const O=(t,e,i)=>{if(i){if(t.formats.astc)return"astc"}else if(e){if(t.formats.etc2)return"etc2"}else if(t.formats.etc1||t.formats.etc2)return"etc1";return(e=>{for(let i=0;i<e.length;++i){const n=e[i];if(t.formats[n])return n}return"none"})(e?k:D)},F=(t,e,i)=>i.isKTX2?((t,e,i)=>{if(!L.KTX2File)throw new Error("Basis transcoder module does not include support for KTX2.");const n=P(),o=new L.KTX2File(new Uint8Array(e)),a=o.getWidth(),l=o.getHeight(),p=o.getLevels(),f=!!o.getHasAlpha(),m=o.isUASTC&&o.isUASTC();if(!a||!l||!p)throw o.close(),o.delete(),new Error("Invalid image dimensions url="+t+" width="+a+" height="+l+" levels="+p);const g=O(i.deviceDetails,f,m),b=!!i.isGGGR&&"pvr"===g;let y,v;if(b)y=h;else{y=f?d[g]:u[g];const t=0!=(a&a-1)||0!=(l&l-1),e=a!==l;((y===s||y===r)&&(t||e)||!i.deviceDetails.webgl2&&t)&&(y=f?h:c)}if(!o.startTranscoding())throw o.close(),o.delete(),new Error("Failed to start transcoding url="+t);const S=[];for(let e=0;e<p;++e){const i=o.getImageTranscodedSizeInBytes(e,0,0,y),n=new Uint8Array(i);if(!o.transcodeImage(n,e,0,0,y,0,-1,-1))throw o.close(),o.delete(),new Error("Failed to transcode image url="+t);const s=y===c||y===_;S.push(s?new Uint16Array(n.buffer):n)}if(o.close(),o.delete(),b)for(y=c,v=0;v<S.length;++v)S[v]=I(M(S[v]));const x=R(y);return{format:E(y,i.deviceDetails),width:x?a+3&-4:a,height:x?l+3&-4:l,levels:S,cubemap:!1,transcodeTime:P()-n,url:t,unswizzledGGGR:b}})(t,e,i):((t,e,i)=>{const n=P(),o=new L.BasisFile(new Uint8Array(e)),a=o.getImageWidth(0,0),l=o.getImageHeight(0,0),p=o.getNumImages(),f=o.getNumLevels(0),m=!!o.getHasAlpha(),g=o.isUASTC&&o.isUASTC();if(!(a&&l&&p&&f))throw o.close(),o.delete(),new Error("Invalid image dimensions url="+t+" width="+a+" height="+l+" images="+p+" levels="+f);const b=O(i.deviceDetails,m,g),y=!!i.isGGGR&&"pvr"===b;let v,S;if(y)v=h;else{v=m?d[b]:u[b];const t=0!=(a&a-1)||0!=(l&l-1),e=a!==l;((v===s||v===r)&&(t||e)||!i.deviceDetails.webgl2&&t)&&(v=m?h:c)}if(!o.startTranscoding())throw o.close(),o.delete(),new Error("Failed to start transcoding url="+t);const x=[];for(let e=0;e<f;++e){const i=o.getImageTranscodedSizeInBytes(0,e,v),n=new Uint8Array(i);if(!o.transcodeImage(n,0,e,v,0,0))throw o.close(),o.delete(),new Error("Failed to transcode image url="+t);const s=v===c||v===_;x.push(s?new Uint16Array(n.buffer):n)}if(o.close(),o.delete(),y)for(v=c,S=0;S<x.length;++S)x[S]=I(M(x[S]));const w=R(v);return{format:E(v,i.deviceDetails),width:w?a+3&-4:a,height:w?l+3&-4:l,levels:x,cubemap:!1,transcodeTime:P()-n,url:t,unswizzledGGGR:y}})(t,e,i),B=(t,e,i)=>{try{const n=F(t,e,i);n.levels=n.levels.map(t=>t.buffer),self.postMessage({url:t,data:n},n.levels)}catch(e){self.postMessage({url:t,err:e},null)}},N=[];self.onmessage=t=>{const e=t.data;switch(e.type){case"init":((t,e)=>{self.importScripts(t.basisUrl);self.BASIS(t.module?{instantiateWasm:(e,i)=>(WebAssembly.instantiate(t.module,e).then(t=>{i(t)}).catch(t=>{console.error("instantiate failed + "+t)}),{})}:null).then(i=>{i.initializeBasis(),L=i,D=t.rgbPriority,k=t.rgbaPriority,e(null)})})(e.config,()=>{for(let t=0;t<N.length;++t)B(N[t].url,N[t].data,N[t].options);N.length=0});break;case"transcode":L?B(e.url,e.data,e.options):N.push(e)}}}const Ff=t=>({astc:!!t.extCompressedTextureASTC,atc:!!t.extCompressedTextureATC,dxt:!!t.extCompressedTextureS3TC,etc1:!!t.extCompressedTextureETC1,etc2:!!t.extCompressedTextureETC,pvr:!!t.extCompressedTexturePVRTC});class Bf{constructor(t,e,i){this.queue=t,this.worker=new Worker(e.workerUrl),this.worker.addEventListener("message",t=>{const e=t.data;this.queue.handleResponse(e.url,e.err,e.data),this.eager||this.queue.enqueueClient(this)}),this.worker.postMessage({type:"init",config:e}),this.eager=i}run(t){const e=[];t.data instanceof ArrayBuffer&&e.push(t.data),this.worker.postMessage({type:"transcode",url:t.url,format:t.format,data:t.data,options:t.options},e),this.eager&&this.queue.enqueueClient(this)}}const Nf=["etc1","etc2","astc","dxt","pvr","atc"],Uf=["astc","dxt","etc2","pvr","atc"],Vf=new class{constructor(){this.callbacks={},this.queue=[],this.clients=[]}enqueueJob(t,e,i,n){if(this.callbacks.hasOwnProperty(t))this.callbacks[t].push(i);else{this.callbacks[t]=[i];const s={url:t,data:e,options:n};this.clients.length>0?this.clients.shift().run(s):this.queue.push(s)}}enqueueClient(t){this.queue.length>0?t.run(this.queue.shift()):this.clients.push(t)}handleResponse(t,e,i){const n=this.callbacks[t];if(e)for(let t=0;t<n.length;++t)n[t](e);else{i.format===fs||i.format===gs?i.levels=i.levels.map((function(t){return new Uint16Array(t)})):i.levels=i.levels.map((function(t){return new Uint8Array(t)}));for(let t=0;t<n.length;++t)n[t](null,i)}delete this.callbacks[t]}};let zf=null,Wf=!1;function Gf(t){if(!Wf){if(t){if(t.lazyInit)return void(zf=t)}else t=zf||{};if(!t.glueUrl||!t.wasmUrl||!t.fallbackUrl){const e=((window.config?window.config.wasmModules:window.PRELOAD_MODULES)||[]).find((function(t){return"BASIS"===t.moduleName}));if(e){const i=window.ASSET_PREFIX||"";t.glueUrl||(t.glueUrl=i+e.glueUrl),t.wasmUrl||(t.wasmUrl=i+e.wasmUrl),t.fallbackUrl||(t.fallbackUrl=i+e.fallbackUrl)}}if(t.glueUrl||t.wasmUrl||t.fallbackUrl){Wf=!0;const e=Math.max(1,Math.min(16,t.numWorkers||1)),i=1===t.numWorkers||!t.hasOwnProperty("eagerWorkers")||t.eagerWorkers;t.rgbPriority=t.rgbPriority||Nf,t.rgbaPriority=t.rgbaPriority||Uf,((t,e)=>{const i=()=>{const t="("+Of.toString()+")()\n\n";return new File([t],"basis_worker.js",{type:"application/javascript"})},n=(n,s)=>{e(null,{workerUrl:URL.createObjectURL(i()),basisUrl:URL.createObjectURL(n),module:s,rgbPriority:t.rgbPriority,rgbaPriority:t.rgbaPriority})};if(t.glueUrl&&t.wasmUrl&&(()=>{try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){const t=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(t instanceof WebAssembly.Module)return new WebAssembly.Instance(t)instanceof WebAssembly.Instance}}catch(t){}return!1})()){let i=null,s=null;$.get(t.glueUrl,{responseType:"blob"},(t,r)=>{t?e(t):s?n(r,s):i=r});const r=fetch(t.wasmUrl),o=()=>{r.then(t=>t.arrayBuffer()).then(t=>WebAssembly.compile(t)).then(t=>{i?n(i,t):s=t}).catch(t=>{e(t,null)})};WebAssembly.compileStreaming?WebAssembly.compileStreaming(r).then(t=>{i?n(i,t):s=t}).catch(t=>{o()}):o()}else $.get(t.fallbackUrl,{responseType:"blob"},(t,i)=>{t?e(t,null):n(i,null)})})(t,(t,n)=>{if(t)console.error("failed to initialize basis worker: "+t);else for(let t=0;t<e;++t)Vf.enqueueClient(new Bf(Vf,n,i))})}}}let jf=null;function Hf(t,e,i,n,s){return Gf(),jf||(jf={webgl2:t.webgl2,formats:Ff(t)}),Vf.enqueueJob(e,i,n,{deviceDetails:jf,isGGGR:!(null==s||!s.isGGGR),isKTX2:!(null==s||!s.isKTX2)}),Wf}class Xf{constructor(t,e){this.device=e,this.maxRetries=0}load(t,e,i){const n=this.device;Od.fetchArrayBuffer(t.load,(s,r)=>{s?e(s):(s=>{var r,o,a;Hf(n,t.load,s,e,{isGGGR:0!=(8&(null==i||null==(r=i.file)||null==(o=r.variants)||null==(a=o.basis)?void 0:a.opt))})||e(`Basis module not found. Asset '${i.name}' basis texture variant will not be loaded.`)})(r)},i,this.maxRetries)}open(t,e,i){const n=new _a(i,{name:t,addressU:e.cubemap?pn:dn,addressV:e.cubemap?pn:dn,width:e.width,height:e.height,format:e.format,cubemap:e.cubemap,levels:e.levels});return n.upload(),n}}class Yf{constructor(t){this.crossOrigin=t.prefix?"anonymous":null,this.maxRetries=0,this.useImageBitmap=!1}load(t,e,i){var n;const s=!(null==i||null==(n=i.file)||!n.contents);s&&(t={load:URL.createObjectURL(new Blob([i.file.contents])),original:t.original});const r=(i,n)=>{s&&URL.revokeObjectURL(t.load),e(i,n)};let o;i&&i.options&&i.options.hasOwnProperty("crossOrigin")?o=i.options.crossOrigin:md.test(t.load)&&(o=this.crossOrigin),this.useImageBitmap?this._loadImageBitmap(t.load,t.original,o,r):this._loadImage(t.load,t.original,o,r)}open(t,e,i){const n=T.getExtension(t).toLowerCase(),s=".jpg"===n||".jpeg"===n?bs:ys,r=new _a(i,{name:t,width:e.width,height:e.height,format:s});return r.setSource(e),r}_loadImage(t,e,i,n){const s=new Image;i&&(s.crossOrigin=i);let r=0;const o=this.maxRetries;let a;s.onload=function(){n(null,s)},s.onerror=function(){if(!a)if(o>0&&++r<=o){const i=100*Math.pow(2,r);console.log("Error loading Texture from: '"+e+"' - Retrying in "+i+"ms...");const n=t.indexOf("?")>=0?"&":"?";a=setTimeout((function(){s.src=t+n+"retry="+Date.now(),a=null}),i)}else n("Error loading Texture from: '"+e+"'")},s.src=t}_loadImageBitmap(t,e,i,n){const s={cache:!0,responseType:"blob",retry:this.maxRetries>0,maxRetries:this.maxRetries};$.get(t,s,(function(t,e){t?n(t):createImageBitmap(e,{premultiplyAlpha:"none"}).then((function(t){n(null,t)})).catch((function(t){n(t)}))}))}}const qf=[1481919403,3140563232,169478669],Kf={33776:vs,33778:Ss,33779:xs,36196:Ds,37492:ks,37496:Os,35840:Ns,35841:Fs,35842:Us,35843:Bs,32849:bs,32856:ys,35905:Ps,35907:Ls,35898:Is,34843:ws,34842:Cs};class Zf{constructor(t){this.maxRetries=0}load(t,e,i){Od.fetchArrayBuffer(t.load,e,i,this.maxRetries)}open(t,e,i){const n=this.parse(e);if(!n)return null;const s=new _a(i,{name:t,addressU:n.cubemap?pn:dn,addressV:n.cubemap?pn:dn,width:n.width,height:n.height,format:n.format,cubemap:n.cubemap,levels:n.levels});return s.upload(),s}parse(t){const e=new Uint32Array(t);if(qf[0]!==e[0]||qf[1]!==e[1]||qf[2]!==e[2])return null;const i={endianness:e[3],glType:e[4],glTypeSize:e[5],glFormat:e[6],glInternalFormat:e[7],glBaseInternalFormat:e[8],pixelWidth:e[9],pixelHeight:e[10],pixelDepth:e[11],numberOfArrayElements:e[12],numberOfFaces:e[13],numberOfMipmapLevels:e[14],bytesOfKeyValueData:e[15]};if(i.pixelDepth>1)return null;if(0!==i.numberOfArrayElements)return null;const n=Kf[i.glInternalFormat];if(void 0===n)return null;let s=16+i.bytesOfKeyValueData/4;const r=i.numberOfFaces>1,o=[];for(let c=0;c<(i.numberOfMipmapLevels||1);c++){const i=e[s++];r&&o.push([]);const _=r?o[c]:o;for(let e=0;e<(r?6:1);++e)_.push((a=t,l=4*s,h=i,n===Is?new Uint32Array(a,l,h/4):new Uint8Array(a,l,h))),s+=i+3>>2}var a,l,h;return{format:n,width:i.pixelWidth,height:i.pixelHeight,levels:o,cubemap:r}}}class Qf{constructor(t){this.arraybuffer=t,this.dataView=new DataView(t),this.offset=0,this.stack=[]}get remainingBytes(){return this.dataView.byteLength-this.offset}reset(t=0){this.offset=t}skip(t){this.offset+=t}align(t){this.offset=this.offset+t-1&~(t-1)}_inc(t){return this.offset+=t,this.offset-t}readU8(){return this.dataView.getUint8(this.offset++)}readU16(){return this.dataView.getUint16(this._inc(2),!0)}readU32(){return this.dataView.getUint32(this._inc(4),!0)}readU64(){return this.readU32()+2**32*this.readU32()}readU32be(){return this.dataView.getUint32(this._inc(4),!1)}readArray(t){for(let e=0;e<t.length;++e)t[e]=this.readU8()}readLine(){const t=this.dataView;let e="";for(;!(this.offset>=t.byteLength);){const t=String.fromCharCode(this.readU8());if("\n"===t)break;e+=t}return e}}const $f=166;class Jf{constructor(t,e){this.maxRetries=0,this.device=e}load(t,e,i){Od.fetchArrayBuffer(t.load,(n,s)=>{n?e(n,s):this.parse(s,t,e,i)},i,this.maxRetries)}open(t,e,i){const n=new _a(i,{name:t,addressU:e.cubemap?pn:dn,addressV:e.cubemap?pn:dn,width:e.width,height:e.height,format:e.format,cubemap:e.cubemap,levels:e.levels});return n.upload(),n}parse(t,e,i,n){const s=new Qf(t),r=[s.readU32be(),s.readU32be(),s.readU32be()];if(2873840728!==r[0]||540160187!==r[1]||218765834!==r[2])return null;const o={vkFormat:s.readU32(),typeSize:s.readU32(),pixelWidth:s.readU32(),pixelHeight:s.readU32(),pixelDepth:s.readU32(),layerCount:s.readU32(),faceCount:s.readU32(),levelCount:s.readU32(),supercompressionScheme:s.readU32()},a={dfdByteOffset:s.readU32(),dfdByteLength:s.readU32(),kvdByteOffset:s.readU32(),kvdByteLength:s.readU32(),sgdByteOffset:s.readU64(),sgdByteLength:s.readU64()},l=[];for(let t=0;t<Math.max(1,o.levelCount);++t)l.push({byteOffset:s.readU64(),byteLength:s.readU64(),uncompressedByteLength:s.readU64()});if(s.readU32()!==a.kvdByteOffset-a.dfdByteOffset)return null;s.skip(8);const h=s.readU8();if(s.skip(a.dfdByteLength-9),s.skip(a.kvdByteLength),1===o.supercompressionScheme||h===$f){var c,_,u;Hf(this.device,e.load,t,i,{isGGGR:0!=(8&(null==n||null==(c=n.file)||null==(_=c.variants)||null==(u=_.basis)?void 0:u.opt)),isKTX2:!0})||i('Basis module not found. Asset "'+n.name+'" basis texture variant will not be loaded.')}else i("unsupported KTX2 pixel format")}}class tm{constructor(t){this.maxRetries=0}load(t,e,i){Od.fetchArrayBuffer(t.load,e,i,this.maxRetries)}open(t,e,i){const n=new Uint32Array(e,0,32),s=n[4],r=n[3],o=Math.max(n[7],1),a=4===n[20],l=n[21],h=n[22],c=65024===n[28];let _,u=!1,d=!1,p=!1,f=!1,m=!1,g=null;if(a?827611204===l?(g=vs,u=!0):894720068===l?(g=xs,u=!0):116===l?(g=As,d=!0):826496069===l?(g=Ds,u=!0,p=!0):825438800===l||825504336===l?(g=825438800===l?Fs:Bs,u=!0,f=!0):825439312!==l&&825504848!==l||(g=825439312===l?Ns:Us,u=!0,m=!0):32===h&&(g=ys),!g)return _=new _a(i,{width:4,height:4,format:bs}),_.name="dds-legacy-empty",_;_=new _a(i,{name:t,addressU:c?pn:dn,addressV:c?pn:dn,width:s,height:r,format:g,cubemap:c});let b=128;const y=c?6:1;let v;const S=827611204===l?8:16;let x,w,C;for(let t=0;t<y;t++){let i=s,n=r;for(let s=0;s<o;s++){u?p?v=Math.floor((i+3)/4)*Math.floor((n+3)/4)*8:f?v=Math.max(i,16)*Math.max(n,8)/4:m?v=Math.max(i,8)*Math.max(n,8)/2:(x=Math.floor((i+4-1)/4),w=Math.floor((n+4-1)/4),C=x*w,v=C*S):v=i*n*4;const r=d?new Float32Array(e,b,v):new Uint8Array(e,b,v);c?(_._levels[s]||(_._levels[s]=[]),_._levels[s][t]=r):_._levels[s]=r,b+=d?4*v:v,i=Math.max(.5*i,1),n=Math.max(.5*n,1)}}return _.upload(),_}}class em{constructor(t){this.maxRetries=0}load(t,e,i){Od.fetchArrayBuffer(t.load,e,i,this.maxRetries)}open(t,e,i){const n=this.parse(e);if(!n)return null;const s=new _a(i,{name:t,addressU:dn,addressV:pn,minFilter:Qn,magFilter:Kn,width:n.width,height:n.height,levels:n.levels,format:ys,type:zr,mipmaps:!1});return s.upload(),s}parse(t){const e=new Qf(t);if(!e.readLine().startsWith("#?RADIANCE"))return this._error("radiance header has invalid magic"),null;const i={};for(;;){const t=e.readLine();if(0===t.length)break;{const e=t.split("=");2===e.length&&(i[e[0]]=e[1])}}if(!i.hasOwnProperty("FORMAT"))return this._error("radiance header missing FORMAT variable"),null;const n=e.readLine().split(" ");if(4!==n.length)return this._error("radiance header has invalid resolution"),null;const s=parseInt(n[1],10),r=parseInt(n[3],10),o=this._readPixels(e,r,s,"-Y"===n[0]);return o?{width:r,height:s,levels:[o]}:null}_readPixels(t,e,i,n){if(e<8||e>32767)return this._readPixelsFlat(t,e,i);const s=[0,0,0,0];if(t.readArray(s),2!==s[0]||2!==s[1]||0!=(128&s[2]))return t.skip(-4),this._readPixelsFlat(t,e,i);const r=new ArrayBuffer(e*i*4),o=new Uint8Array(r);let a,l,h,c,_,u,d=n?0:4*e*(i-1);for(l=0;l<i;++l){if(l&&t.readArray(s),(s[2]<<8)+s[3]!==e)return this._error("radiance has invalid scanline width"),null;for(c=0;c<4;++c)for(a=0;a<e;)if(_=t.readU8(),_>128){if(_-=128,a+_>e)return this._error("radiance has invalid scanline data"),null;for(u=t.readU8(),h=0;h<_;++h)o[d+c+4*a++]=u}else{if(0===_||a+_>e)return this._error("radiance has invalid scanline data"),null;for(h=0;h<_;++h)o[d+c+4*a++]=t.readU8()}d+=4*e*(n?1:-1)}return o}_readPixelsFlat(t,e,i){return t.remainingBytes===e*i*4?new Uint8Array(t.arraybuffer,t.offset):null}_error(t){}}const im={repeat:dn,clamp:pn,mirror:fn},nm={nearest:Kn,linear:Zn,nearest_mip_nearest:Qn,linear_mip_nearest:Jn,nearest_mip_linear:$n,linear_mip_linear:ts},sm={default:Ur,rgbm:Vr,rgbe:zr,swizzleGGGR:Wr};class rm{load(t,e,i){throw new Error("not implemented")}open(t,e,i){throw new Error("not implemented")}}class om{constructor(t,e,i){this._device=t,this._assets=e,this._loader=i,this.imgParser=new Yf(e),this.parsers={dds:new tm(e),ktx:new Zf(e),ktx2:new Jf(e,t),basis:new Xf(e,t),hdr:new em(e)}}get crossOrigin(){return this.imgParser.crossOrigin}set crossOrigin(t){this.imgParser.crossOrigin=t}get maxRetries(){return this.imgParser.maxRetries}set maxRetries(t){this.imgParser.maxRetries=t;for(const e in this.parsers)this.parsers.hasOwnProperty(e)&&(this.parsers[e].maxRetries=t)}_getUrlWithoutParams(t){return t.indexOf("?")>=0?t.split("?")[0]:t}_getParser(t){const e=T.getExtension(this._getUrlWithoutParams(t)).toLowerCase().replace(".","");return this.parsers[e]||this.imgParser}load(t,e,i){"string"==typeof t&&(t={load:t,original:t}),this._getParser(t.original).load(t,e,i)}open(t,e,i){if(!t)return;let n=this._getParser(t).open(t,e,this._device);return null===n?n=new _a(this._device,{width:4,height:4,format:bs}):(!function(t){const e=Math.log2(Math.max(t._width,t._height))+1;if(t._format!==ys&&t._format!==As||t._volume||t._compressed||1===t._levels.length||t._levels.length===e||((i=t._cubemap?t._levels[0][0]:t._levels[0])instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof HTMLVideoElement))return;var i;const n=function(t,e,i){const n=Math.max(1,t>>1),s=Math.max(1,e>>1),r=new i.constructor(n*s*4),o=Math.floor(t/n),a=Math.floor(e/s),l=o*a;for(let e=0;e<s;++e)for(let s=0;s<n;++s)for(let h=0;h<4;++h){let c=0;for(let n=0;n<a;++n)for(let r=0;r<o;++r)c+=i[4*(s*o+r+(e*a+n)*t)+h];r[4*(s+e*n)+h]=c/l}return r};for(let i=t._levels.length;i<e;++i){const e=Math.max(1,t._width>>i-1),s=Math.max(1,t._height>>i-1);if(t._cubemap){const r=[];for(let o=0;o<6;++o)r.push(n(e,s,t._levels[i-1][o]));t._levels.push(r)}else t._levels.push(n(e,s,t._levels[i-1]))}t._levelsUpdated=t._cubemap?[[!0,!0,!0,!0,!0,!0]]:[!0]}(n),e.unswizzledGGGR&&(i.file.variants.basis.opt&=-9)),n}patch(t,e){const i=t.resource;if(!i)return;t.name&&t.name.length>0&&(i.name=t.name);const n=t.data;n.hasOwnProperty("minfilter")&&(i.minFilter=nm[n.minfilter]),n.hasOwnProperty("magfilter")&&(i.magFilter=nm[n.magfilter]),i.cubemap||(n.hasOwnProperty("addressu")&&(i.addressU=im[n.addressu]),n.hasOwnProperty("addressv")&&(i.addressV=im[n.addressv])),n.hasOwnProperty("mipmaps")&&(i.mipmaps=n.mipmaps),n.hasOwnProperty("anisotropy")&&(i.anisotropy=n.anisotropy),n.hasOwnProperty("flipY")&&(i.flipY=!!n.flipY),n.hasOwnProperty("type")?i.type=sm[n.type]:n.hasOwnProperty("rgbm")&&n.rgbm?i.type=Vr:t.file&&0!=(8&t.file.opt)&&(i.type=Wr)}}class am{constructor(t=null){this._index={},this._key=t}addItem(t){const e=t.tags._list;for(const i of e)this.add(i,t)}removeItem(t){const e=t.tags._list;for(const i of e)this.remove(i,t)}add(t,e){this._index[t]&&-1!==this._index[t].list.indexOf(e)||(this._index[t]||(this._index[t]={list:[]},this._key&&(this._index[t].keys={})),this._index[t].list.push(e),this._key&&(this._index[t].keys[e[this._key]]=e))}remove(t,e){if(!this._index[t])return;if(this._key&&!this._index[t].keys[e[this._key]])return;const i=this._index[t].list.indexOf(e);-1!==i&&(this._index[t].list.splice(i,1),this._key&&delete this._index[t].keys[e[this._key]],0===this._index[t].list.length&&delete this._index[t])}find(t){const e={},i=[];let n,s,r,o,a;const l=(t,e)=>this._index[t].list.length-this._index[e].list.length;for(let h=0;h<t.length;h++){if(s=t[h],s instanceof Array){if(0===s.length)continue;if(1!==s.length){a=!1;for(let t=0;t<s.length;t++)if(!this._index[s[t]]){a=!0;break}if(a)continue;r=s.slice(0).sort(l),o=r.slice(1),1===o.length&&(o=o[0]);for(let t=0;t<this._index[r[0]].list.length;t++)n=this._index[r[0]].list[t],(this._key?!e[n[this._key]]:-1===i.indexOf(n))&&n.tags.has(o)&&(this._key&&(e[n[this._key]]=!0),i.push(n));continue}s=s[0]}if(s&&"string"==typeof s&&this._index[s])for(let t=0;t<this._index[s].list.length;t++)n=this._index[s].list[t],this._key?e[n[this._key]]||(e[n[this._key]]=!0,i.push(n)):-1===i.indexOf(n)&&i.push(n)}return i}}class lm extends x{constructor(t){super(),this._loader=t,this._assets=[],this._cache={},this._names={},this._tags=new am("_id"),this._urls={},this.prefix=null}list(t){return t=t||{},this._assets.filter((function(e){var i=!0;return void 0!==t.preload&&(i=e.preload===t.preload),i}))}add(t){var e,i=this._assets.push(t)-1;this._cache[t.id]=i,this._names[t.name]||(this._names[t.name]=[]),this._names[t.name].push(i),t.file&&(e=t.file.url,this._urls[e]=i),t.registry=this,this._tags.addItem(t),t.tags.on("add",this._onTagAdd,this),t.tags.on("remove",this._onTagRemove,this),this.fire("add",t),this.fire("add:"+t.id,t),e&&this.fire("add:url:"+e,t),t.preload&&this.load(t)}remove(t){var e=this._cache[t.id],i=t.file?t.file.url:null;if(void 0!==e){this._assets.splice(e,1),delete this._cache[t.id],this._names={},this._urls=[];for(var n=0,s=this._assets.length;n<s;n++){var r=this._assets[n];this._cache[r.id]=n,this._names[r.name]||(this._names[r.name]=[]),this._names[r.name].push(n),r.file&&(this._urls[r.file.url]=n)}return this._tags.removeItem(t),t.tags.off("add",this._onTagAdd,this),t.tags.off("remove",this._onTagRemove,this),t.fire("remove",t),this.fire("remove",t),this.fire("remove:"+t.id,t),i&&this.fire("remove:url:"+i,t),!0}return!1}get(t){var e=this._cache[t];return this._assets[e]}getByUrl(t){var e=this._urls[t];return this._assets[e]}load(t){if(!t.loading&&!t.loaded){var e=this,i=t.file,n=function(n){n instanceof Array?t.resources=n:t.resource=n,e._loader.patch(t,e),e.fire("load",t),e.fire("load:"+t.id,t),i&&i.url&&e.fire("load:url:"+i.url,t),t.fire("load",t)};if(i||"cubemap"===t.type)this.fire("load:start",t),this.fire("load:"+t.id+":start",t),t.loading=!0,e._loader.load(t.getFileUrl(),t.type,(function(i,s,r){if(t.loaded=!0,t.loading=!1,i)e.fire("error",i,t),e.fire("error:"+t.id,i,t),t.fire("error",i,t);else{if(!bf.legacy&&"script"===t.type){var o=e._loader.getHandler("script");o._cache[t.id]&&o._cache[t.id].parentNode===document.head&&document.head.removeChild(o._cache[t.id]),o._cache[t.id]=r}n(s)}}),t);else{var s=e._loader.open(t.type,t.data);t.loaded=!0,n(s)}}}loadFromUrl(t,e,i){this.loadFromUrlAndFilename(t,null,e,i)}loadFromUrlAndFilename(t,e,i,n){var s=this,r=T.getBasename(e||t),o={filename:e||r,url:t},a=s.getByUrl(t);if(a){if(a.loaded)return void n(a.loadFromUrlError||null,a)}else a=new Od(r,i,o),s.add(a);var l=function(t){t.once("load",(function(t){"material"===i?s._loadTextures(t,(function(e,i){n(e,t)})):n(null,t)})),t.once("error",(function(e){e&&(this.loadFromUrlError=e),n(e,t)})),s.load(t)};a.resource?n(null,a):"model"===i?s._loadModel(a,l):l(a)}_loadModel(t,e){var i=this,n=t.getFileUrl(),s=T.getExtension(n);if(".json"===s||".glb"===s){var r=T.getDirectory(n),o=T.getBasename(n),a=T.join(r,o.replace(s,".mapping.json"));this._loader.load(a,"json",(function(n,s){n?(t.data={mapping:[]},e(t)):i._loadMaterials(t,s,(function(i,n){t.data=s,e(t)}))}))}else e(t)}_loadMaterials(t,e,i){for(var n=this,s=[],r=0,o=function(t,e){n._loadTextures(e,(function(t,n){s.push(e),s.length===r&&i(null,s)}))},a=0;a<e.mapping.length;a++){var l=e.mapping[a].path;l&&(r++,n.loadFromUrl(t.getAbsoluteUrl(l),"material",o))}0===r&&i(null,s)}_loadTextures(t,e){var i=[],n=0,s=t.data;if("path"===s.mappingFormat){for(var r=function(t,s){t&&console.error(t),i.push(s),i.length===n&&e(null,i)},o=bl,a=0;a<o.length;a++){var l=s[o[a]];l&&"string"==typeof l&&(n++,this.loadFromUrl(t.getAbsoluteUrl(l),"texture",r))}0===n&&e(null,i)}else e(null,i)}findAll(t,e){var i=this,n=this._names[t];if(n){var s=n.map((function(t){return i._assets[t]}));return e?s.filter((function(t){return t.type===e})):s}return[]}_onTagAdd(t,e){this._tags.add(t,e)}_onTagRemove(t,e){this._tags.remove(t,e)}findByTag(){return this._tags.find(arguments)}filter(t){for(var e=[],i=0,n=this._assets.length;i<n;i++)t(this._assets[i])&&e.push(this._assets[i]);return e}find(t,e){var i=this.findAll(t,e);return i.length>0?i[0]:null}}class hm{constructor(t){this._assets=t,this._bundleAssets={},this._assetsInBundles={},this._urlsInBundles={},this._fileRequests={},this._assets.on("add",this._onAssetAdded,this),this._assets.on("remove",this._onAssetRemoved,this)}_onAssetAdded(t){if("bundle"===t.type){this._bundleAssets[t.id]=t,this._registerBundleEventListeners(t.id);for(let e=0,i=t.data.assets.length;e<i;e++)this._indexAssetInBundle(t.data.assets[e],t)}else this._assetsInBundles[t.id]&&this._indexAssetFileUrls(t)}_registerBundleEventListeners(t){this._assets.on("load:"+t,this._onBundleLoaded,this),this._assets.on("error:"+t,this._onBundleError,this)}_unregisterBundleEventListeners(t){this._assets.off("load:"+t,this._onBundleLoaded,this),this._assets.off("error:"+t,this._onBundleError,this)}_indexAssetInBundle(t,e){if(this._assetsInBundles[t]){const i=this._assetsInBundles[t];-1===i.indexOf(e)&&i.push(e)}else this._assetsInBundles[t]=[e];const i=this._assets.get(t);i&&this._indexAssetFileUrls(i)}_indexAssetFileUrls(t){const e=this._getAssetFileUrls(t);if(e)for(let i=0,n=e.length;i<n;i++){const n=e[i];this._urlsInBundles[n]=this._assetsInBundles[t.id]}}_getAssetFileUrls(t){let e=t.getFileUrl();if(!e)return null;e=this._normalizeUrl(e);const i=[e];if("font"===t.type){const n=t.data.info.maps.length;for(let t=1;t<n;t++)i.push(e.replace(".png",t+".png"))}return i}_normalizeUrl(t){return t&&t.split("?")[0]}_onAssetRemoved(t){if("bundle"===t.type){delete this._bundleAssets[t.id],this._unregisterBundleEventListeners(t.id);for(const e in this._assetsInBundles){const i=this._assetsInBundles[e],n=i.indexOf(t);if(-1!==n&&(i.splice(n,1),!i.length)){delete this._assetsInBundles[e];for(const t in this._urlsInBundles)this._urlsInBundles[t]===i&&delete this._urlsInBundles[t]}}this._onBundleError(`Bundle ${t.id} was removed`,t)}else if(this._assetsInBundles[t.id]){delete this._assetsInBundles[t.id];const e=this._getAssetFileUrls(t);for(let t=0,i=e.length;t<i;t++)delete this._urlsInBundles[e[t]]}}_onBundleLoaded(t){t.resource?requestAnimationFrame(()=>{if(this._fileRequests)for(const e in this._fileRequests){const i=this._urlsInBundles[e];if(!i||-1===i.indexOf(t))continue;const n=decodeURIComponent(e);let s=null;t.resource.hasBlobUrl(n)||(s=`Bundle ${t.id} does not contain URL ${e}`);const r=this._fileRequests[e];for(let e=0,i=r.length;e<i;e++)s?r[e](s):r[e](null,t.resource.getBlobUrl(n));delete this._fileRequests[e]}}):this._onBundleError(`Bundle ${t.id} failed to load`,t)}_onBundleError(t,e){for(const e in this._fileRequests){if(!this._findLoadedOrLoadingBundleForUrl(e)){const i=this._fileRequests[e];for(let e=0,n=i.length;e<n;e++)i[e](t);delete this._fileRequests[e]}}}_findLoadedOrLoadingBundleForUrl(t){const e=this._urlsInBundles[t];if(!e)return null;const i=e.length;for(let t=0;t<i;t++)if(e[t].loaded&&e[t].resource)return e[t];for(let t=0;t<i;t++)if(e[t].loading)return e[t];return null}listBundlesForAsset(t){return this._assetsInBundles[t.id]||null}list(){const t=[];for(const e in this._bundleAssets)t.push(this._bundleAssets[e]);return t}hasUrl(t){return!!this._urlsInBundles[t]}canLoadUrl(t){return!!this._findLoadedOrLoadingBundleForUrl(t)}loadUrl(t,e){const i=this._findLoadedOrLoadingBundleForUrl(t);if(i)if(i.loaded){const n=decodeURIComponent(t);if(!i.resource.hasBlobUrl(n))return void e(`Bundle ${i.id} does not contain URL ${t}`);e(null,i.resource.getBlobUrl(n))}else this._fileRequests.hasOwnProperty(t)?this._fileRequests[t].push(e):this._fileRequests[t]=[e];else e(`URL ${t} not found in any bundles`)}destroy(){this._assets.off("add",this._onAssetAdded,this),this._assets.off("remove",this._onAssetRemoved,this);for(const t in this._bundleAssets)this._unregisterBundleEventListeners(t);this._assets=null,this._bundleAssets=null,this._assetsInBundles=null,this._urlsInBundles=null,this._fileRequests=null}}class cm extends x{constructor(t){super(),this.app=t,this._scripts={},this._list=[]}destroy(){this.app=null,this.off()}add(t){const e=t.__name;return this._scripts.hasOwnProperty(e)?(setTimeout(()=>{if(t.prototype.swap){const i=this._scripts[e],n=this._list.indexOf(i);this._list[n]=t,this._scripts[e]=t,this.fire("swap",e,t),this.fire("swap:"+e,t)}else console.warn(`script registry already has '${e}' script, define 'swap' method for new script type to enable code hot swapping`)}),!1):(this._scripts[e]=t,this._list.push(t),this.fire("add",e,t),this.fire("add:"+e,t),setTimeout(()=>{if(!this._scripts.hasOwnProperty(e))return;if(!this.app||!this.app.systems||!this.app.systems.script)return;const t=this.app.systems.script._components;let i;const n=[],s=[];for(t.loopIndex=0;t.loopIndex<t.length;t.loopIndex++){const s=t.items[t.loopIndex];if(s._scriptsIndex[e]&&s._scriptsIndex[e].awaiting){s._scriptsData&&s._scriptsData[e]&&(i=s._scriptsData[e].attributes);const t=s.create(e,{preloading:!0,ind:s._scriptsIndex[e].ind,attributes:i});t&&n.push(t)}}for(let t=0;t<n.length;t++)n[t].__initializeAttributes();for(let t=0;t<n.length;t++)n[t].enabled&&(n[t]._initialized=!0,s.push(n[t]),n[t].initialize&&n[t].initialize());for(let t=0;t<s.length;t++)s[t].enabled&&!s[t]._postInitialized&&(s[t]._postInitialized=!0,s[t].postInitialize&&s[t].postInitialize())}),!0)}remove(t){let e=t,i=t;if("string"!=typeof i?i=e.__name:e=this.get(i),this.get(i)!==e)return!1;delete this._scripts[i];const n=this._list.indexOf(e);return this._list.splice(n,1),this.fire("remove",i,e),this.fire("remove:"+i,e),!0}get(t){return this._scripts[t]||null}has(t){if("string"==typeof t)return this._scripts.hasOwnProperty(t);if(!t)return!1;const e=t.__name;return this._scripts[e]===t}list(){return this._list}}class _m{_validate(t){if(!t.header)throw new Error('pc.I18n#addData: Missing "header" field');if(!t.header.version)throw new Error('pc.I18n#addData: Missing "header.version" field');if(1!==t.header.version)throw new Error('pc.I18n#addData: Invalid "header.version" field');if(!t.data)throw new Error('pc.I18n#addData: Missing "data" field');if(!Array.isArray(t.data))throw new Error('pc.I18n#addData: "data" field must be an array');for(var e=0,i=t.data.length;e<i;e++){var n=t.data[e];if(!n.info)throw new Error('pc.I18n#addData: missing "data['+e+'].info" field');if(!n.info.locale)throw new Error('pc.I18n#addData: missing "data['+e+'].info.locale" field');if("string"!=typeof n.info.locale)throw new Error('pc.I18n#addData: "data['+e+'].info.locale" must be a string');if(!n.messages)throw new Error('pc.I18n#addData: missing "data['+e+'].messages" field')}}parse(t){return t.data}}class um extends x{constructor(t){super(),this.locale="en-US",this._translations={},this._availableLangs={},this._app=t,this._assets=[],this._parser=new _m}static findAvailableLocale(t,e){return dd(t,e)}findAvailableLocale(t){if(this._translations[t])return t;const e=ud(t);return this._findFallbackLocale(t,e)}getText(t,e){var i,n=t;e||(e=this._locale,i=this._lang);var s=this._translations[e];return s||(i||(i=ud(e)),e=this._findFallbackLocale(e,i),s=this._translations[e]),s&&s.hasOwnProperty(t)&&(n=s[t],Array.isArray(n)&&(n=n[0]),null==n&&(n=t)),n}getPluralText(t,e,i){var n,s,r=t;i?n=fd(s=ud(i)):(i=this._locale,s=this._lang,n=this._pluralFn);var o=this._translations[i];if(o||(n=fd(s=ud(i=this._findFallbackLocale(i,s))),o=this._translations[i]),o&&o[t]&&n){var a=n(e);null==(r=o[t][a])&&(r=t)}return r}addData(t){var e;try{e=this._parser.parse(t)}catch(t){return void console.error(t)}for(var i=0,n=e.length;i<n;i++){var s=e[i],r=s.info.locale,o=s.messages;if(!this._translations[r]){this._translations[r]={};var a=ud(r);this._availableLangs[a]||(this._availableLangs[a]=r)}Object.assign(this._translations[r],o),this.fire("data:add",r,o)}}removeData(t){var e,i;try{e=this._parser.parse(t)}catch(t){return void console.error(t)}for(var n=0,s=e.length;n<s;n++){var r=e[n],o=r.info.locale,a=this._translations[o];if(a){var l=r.messages;for(i in l)delete a[i];var h=!1;for(i in a){h=!0;break}h||(delete this._translations[o],delete this._availableLangs[ud(o)]),this.fire("data:remove",o,l)}}}destroy(){this._translations=null,this._availableLangs=null,this._assets=null,this._parser=null,this.off()}get locale(){return this._locale}set locale(t){if(this._locale!==t){var e=ud(t);if("in"!==e||(n=e="id",t=-1!==(s=(i=t).indexOf("-"))?n+i.substring(s):n,this._locale!==t)){var i,n,s,r=this._locale;this._locale=t,this._lang=e,this._pluralFn=fd(this._lang),this.fire("set:locale",t,r)}}}get assets(){return this._assets}set assets(t){var e,i,n,s,r={};for(e=0,i=t.length;e<i;e++)r[n=t[e]instanceof Od?t[e].id:t[e]]=!0;for(e=this._assets.length;e--;)r[n=this._assets[e]]||(this._app.assets.off("add:"+n,this._onAssetAdd,this),(s=this._app.assets.get(n))&&this._onAssetRemove(s),this._assets.splice(e,1));for(n in r)n=parseInt(n,10),-1===this._assets.indexOf(n)&&(this._assets.push(n),(s=this._app.assets.get(n))?this._onAssetAdd(s):this._app.assets.once("add:"+n,this._onAssetAdd,this))}_findFallbackLocale(t,e){var i=hd[t];return i&&this._translations[i]||(i=hd[e])&&this._translations[i]||(i=this._availableLangs[e])&&this._translations[i]?i:"en-US"}_onAssetAdd(t){t.on("load",this._onAssetLoad,this),t.on("change",this._onAssetChange,this),t.on("remove",this._onAssetRemove,this),t.on("unload",this._onAssetUnload,this),t.resource&&this._onAssetLoad(t)}_onAssetLoad(t){this.addData(t.resource)}_onAssetChange(t){t.resource&&this.addData(t.resource)}_onAssetRemove(t){t.off("load",this._onAssetLoad,this),t.off("change",this._onAssetChange,this),t.off("remove",this._onAssetRemove,this),t.off("unload",this._onAssetUnload,this),t.resource&&this.removeData(t.resource),this._app.assets.once("add:"+t.id,this._onAssetAdd,this)}_onAssetUnload(t){t.resource&&this.removeData(t.resource)}}const dm="NONE",pm="FILL_WINDOW",fm="KEEP_ASPECT",mm="AUTO",gm="FIXED";class bm extends x{constructor(t,e){super(),this._app=t,this._device=t.graphicsDevice,this.id=e.displayId,this._frameData=null,window.VRFrameData&&(this._frameData=new window.VRFrameData),this.display=e,this._camera=null,this.sitToStandInv=new bt,this.leftView=new bt,this.leftProj=new bt,this.leftViewInv=new bt,this.leftPos=new ht,this.rightView=new bt,this.rightProj=new bt,this.rightViewInv=new bt,this.rightPos=new ht,this.combinedPos=new ht,this.combinedView=new bt,this.combinedProj=new bt,this.combinedViewInv=new bt,this.combinedFov=0,this.combinedAspect=0,this.presenting=!1,this._presentChange=t=>{let e;if(e=t.display?t.display:t.detail&&t.detail.display?t.detail.display:t.detail&&t.detail.vrdisplay?t.detail.vrdisplay:this.display,e===this.display){if(this.presenting=this.display&&this.display.isPresenting,this.presenting){const t=this.display.getEyeParameters("left"),e=this.display.getEyeParameters("right"),i=2*Math.max(t.renderWidth,e.renderWidth),n=Math.max(t.renderHeight,e.renderHeight);this._app.graphicsDevice.setResolution(i,n),this._app._allowResize=!1}else this._app.setCanvasResolution(mm),this._app._allowResize=!0;this.fire("beforepresentchange",this),this.fire("presentchange",this)}},window.addEventListener("vrdisplaypresentchange",this._presentChange,!1)}destroy(){window.removeEventListener("vrdisplaypresentchange",this._presentChange),this._camera&&(this._camera.vrDisplay=null),this._camera=null}poll(){if(this.display){this.display.getFrameData(this._frameData),this.leftProj.data=this._frameData.leftProjectionMatrix,this.rightProj.data=this._frameData.rightProjectionMatrix;const t=this.display.stageParameters;t?(this.sitToStandInv.set(t.sittingToStandingTransform).invert(),this.combinedView.set(this._frameData.leftViewMatrix),this.leftView.mul2(this.combinedView,this.sitToStandInv),this.combinedView.set(this._frameData.rightViewMatrix),this.rightView.mul2(this.combinedView,this.sitToStandInv)):(this.leftView.set(this._frameData.leftViewMatrix),this.rightView.set(this._frameData.rightViewMatrix));let e=this.leftProj.data[3]+this.leftProj.data[0],i=this.leftProj.data[11]+this.leftProj.data[8],n=1/Math.sqrt(e*e+i*i);e*=n,i*=n;let s=-Math.atan2(i,e);e=this.rightProj.data[3]+this.rightProj.data[0],i=this.rightProj.data[11]+this.rightProj.data[8],n=1/Math.sqrt(e*e+i*i),e*=n,i*=n,s=Math.max(s,-Math.atan2(i,e)),s*=2,this.combinedFov=s;const r=this.rightProj.data[5]/this.rightProj.data[0];this.combinedAspect=r;const o=this.combinedView;o.copy(this.leftView),o.invert(),this.leftViewInv.copy(o);const a=this.combinedPos;a.x=this.leftPos.x=o.data[12],a.y=this.leftPos.y=o.data[13],a.z=this.leftPos.z=o.data[14],o.copy(this.rightView),o.invert(),this.rightViewInv.copy(o);const l=a.x-o.data[12],h=a.y-o.data[13],c=a.z-o.data[14],_=Math.sqrt(l*l+h*h+c*c);this.rightPos.x=o.data[12],this.rightPos.y=o.data[13],this.rightPos.z=o.data[14],a.x+=o.data[12],a.y+=o.data[13],a.z+=o.data[14],a.x*=.5,a.y*=.5,a.z*=.5;const u=.5*Math.PI,d=.5*s,p=Math.PI-(u+d),f=.5*_*Math.sin(p),m=o.data[8],g=o.data[9],b=o.data[10];o.data[12]=a.x+m*f,o.data[13]=a.y+g*f,o.data[14]=a.z+b*f,this.combinedViewInv.copy(o),o.invert(),this.combinedProj.setPerspective(s*Z.RAD_TO_DEG,r,this.display.depthNear+f,this.display.depthFar+f,!0)}}requestPresent(t){this.display?this.presenting?t&&t(new Error("VrDisplay already presenting")):this.display.requestPresent([{source:this._device.canvas}]).then((function(){t&&t()}),(function(e){t&&t(e)})):t&&t(new Error("No VrDisplay to requestPresent"))}exitPresent(t){this.display||t&&t(new Error("No VrDisplay to exitPresent")),this.presenting?this.display.exitPresent().then((function(){t&&t()}),(function(){t&&t(new Error("exitPresent failed"))})):t&&t(new Error("VrDisplay not presenting"))}requestAnimationFrame(t){this.display&&this.display.requestAnimationFrame(t)}submitFrame(){this.display&&this.display.submitFrame()}reset(){this.display&&this.display.resetPose()}setClipPlanes(t,e){this.display&&(this.display.depthNear=t,this.display.depthFar=e)}getFrameData(){if(this.display)return this._frameData}get capabilities(){return this.display?this.display.capabilities:{}}}class ym extends x{constructor(t){super(),this.isSupported=ym.isSupported,this._index={},this.displays=[],this.display=null,this._app=t,this._onDisplayConnect=this._onDisplayConnect.bind(this),this._onDisplayDisconnect=this._onDisplayDisconnect.bind(this),this._attach(),this._getDisplays((t,e)=>{if(t)this.fire("error",t);else{for(let t=0;t<e.length;t++)this._addDisplay(e[t]);this.fire("ready",this.displays)}})}_attach(){window.addEventListener("vrdisplayconnect",this._onDisplayConnect),window.addEventListener("vrdisplaydisconnect",this._onDisplayDisconnect)}_detach(){window.removeEventListener("vrdisplayconnect",this._onDisplayConnect),window.removeEventListener("vrdisplaydisconnect",this._onDisplayDisconnect)}destroy(){this._detach()}poll(){const t=this.displays.length;if(t)for(let e=0;e<t;e++)this.displays[e]._camera&&this.displays[e].poll()}_getDisplays(t){navigator.getVRDisplays?navigator.getVRDisplays().then((function(e){t&&t(null,e)})):t&&t(new Error("WebVR not supported"))}_addDisplay(t){if(this._index[t.displayId])return;const e=new bm(this._app,t);this._index[e.id]=e,this.displays.push(e),this.display||(this.display=e),this.fire("displayconnect",e)}_onDisplayConnect(t){t.detail&&t.detail.display?this._addDisplay(t.detail.display):this._addDisplay(t.display)}_onDisplayDisconnect(t){let e;e=t.detail&&t.detail.display?t.detail.display.displayId:t.display.displayId;const i=this._index[e];if(!i)return;i.destroy(),delete this._index[i.id];const n=this.displays.indexOf(i);this.displays.splice(n,1),this.display===i&&(this.displays.length?this.display=this.displays[0]:this.display=null),this.fire("displaydisconnect",i)}}ym.isSupported="undefined"!=typeof navigator&&!!navigator.getVRDisplays;const vm="inline",Sm="immersive-vr",xm="immersive-ar",wm="viewer",Cm="local",Tm="local-floor",Am="bounded-floor",Em="unbounded",Mm="gaze",Rm="screen",Im="tracked-pointer",Pm="none",Lm="left",Dm="right",km="point",Om="plane",Fm="mesh",Bm="cpu-optimized",Nm="gpu-optimized",Um="luminance-alpha",Vm="float32",zm=[],Wm=[];class Gm extends x{constructor(t,e,i){super(),this.manager=t,this._xrHitTestSource=e,this._transient=i}remove(){if(!this._xrHitTestSource)return;const t=this.manager.hitTest.sources,e=t.indexOf(this);-1!==e&&t.splice(e,1),this.onStop()}onStop(){this._xrHitTestSource.cancel(),this._xrHitTestSource=null,this.fire("remove"),this.manager.hitTest.fire("remove",this)}update(t){if(this._transient){const e=t.getHitTestResultsForTransientInput(this._xrHitTestSource);for(let t=0;t<e.length;t++){const i=e[t];let n;i.inputSource&&(n=this.manager.input._getByInputSource(i.inputSource)),this.updateHitResults(i.results,n)}}else this.updateHitResults(t.getHitTestResults(this._xrHitTestSource))}updateHitResults(t,e){for(let i=0;i<t.length;i++){const n=t[i].getPose(this.manager._referenceSpace);let s=zm.pop();s||(s=new ht),s.copy(n.transform.position);let r=Wm.pop();r||(r=new yt),r.copy(n.transform.orientation),this.fire("result",s,r,e),this.manager.hitTest.fire("result",this,s,r,e),zm.push(s),Wm.push(r)}}}class jm extends x{constructor(t){super(),this.manager=t,this._supported=B.browser&&!(!window.XRSession||!window.XRSession.prototype.requestHitTestSource),this._session=null,this.sources=[],this._supported&&(this.manager.on("start",this._onSessionStart,this),this.manager.on("end",this._onSessionEnd,this))}_onSessionStart(){this.manager.type===xm&&(this._session=this.manager.session)}_onSessionEnd(){if(this._session){this._session=null;for(let t=0;t<this.sources.length;t++)this.sources[t].onStop();this.sources=[]}}isAvailable(t,e){let i;return this._supported||(i=new Error("XR HitTest is not supported")),this._session||(i=new Error("XR Session is not started (1)")),this.manager.type!==xm&&(i=new Error("XR HitTest is available only for AR")),!i||(t&&t(i),e&&e.fire("error",i),!1)}start(t){if(t=t||{},!this.isAvailable(t.callback,this))return;let e;t.profile||t.spaceType||(t.spaceType=wm);const i=t.offsetRay;i&&(e=new XRRay(new DOMPoint(i.origin.x,i.origin.y,i.origin.z),new DOMPoint(i.direction.x,i.direction.y,i.direction.z)));const n=t.callback;t.spaceType?this._session.requestReferenceSpace(t.spaceType).then(i=>{if(!this._session){const t=new Error("XR Session is not started (2)");return n&&n(t),void this.fire("error",t)}this._session.requestHitTestSource({space:i,entityTypes:t.entityTypes||void 0,offsetRay:e}).then(t=>{this._onHitTestSource(t,!1,n)}).catch(t=>{n&&n(t),this.fire("error",t)})}).catch(t=>{n&&n(t),this.fire("error",t)}):this._session.requestHitTestSourceForTransientInput({profile:t.profile,entityTypes:t.entityTypes||void 0,offsetRay:e}).then(t=>{this._onHitTestSource(t,!0,n)}).catch(t=>{n&&n(t),this.fire("error",t)})}_onHitTestSource(t,e,i){if(!this._session){t.cancel();const e=new Error("XR Session is not started (3)");return i&&i(e),void this.fire("error",e)}const n=new Gm(this.manager,t,e);this.sources.push(n),i&&i(null,n),this.fire("add",n)}update(t){for(let e=0;e<this.sources.length;e++)this.sources[e].update(t)}get supported(){return this._supported}}class Hm{constructor(t,e){this._index=t,this._hand=e,this._hand._fingers.push(this),this._joints=[],this._tip=null}get index(){return this._index}get hand(){return this._hand}get joints(){return this._joints}get tip(){return this._tip}}const Xm=B.browser&&window.XRHand?["thumb-tip","index-finger-tip","middle-finger-tip","ring-finger-tip","pinky-finger-tip"]:[],Ym={};for(let t=0;t<Xm.length;t++)Ym[Xm[t]]=!0;class qm{constructor(t,e,i,n=null){this._index=t,this._id=e,this._hand=i,this._finger=n,this._wrist="wrist"===e,this._tip=this._finger&&!!Ym[e],this._radius=null,this._localTransform=new bt,this._worldTransform=new bt,this._localPosition=new ht,this._localRotation=new yt,this._position=new ht,this._rotation=new yt,this._dirtyLocal=!0}update(t){this._dirtyLocal=!0,this._radius=t.radius,this._localPosition.copy(t.transform.position),this._localRotation.copy(t.transform.orientation)}_updateTransforms(){this._dirtyLocal&&(this._dirtyLocal=!1,this._localTransform.setTRS(this._localPosition,this._localRotation,ht.ONE));const t=this._hand._manager.camera.parent;t?this._worldTransform.mul2(t.getWorldTransform(),this._localTransform):this._worldTransform.copy(this._localTransform)}getPosition(){return this._updateTransforms(),this._worldTransform.getTranslation(this._position),this._position}getRotation(){return this._updateTransforms(),this._rotation.setFromMat4(this._worldTransform),this._rotation}get index(){return this._index}get hand(){return this._hand}get finger(){return this._finger}get wrist(){return this._wrist}get tip(){return this._tip}get radius(){return this._radius||.005}}let Km=[];const Zm=new ht,Qm=new ht,$m=new ht;B.browser&&window.XRHand&&(Km=[["thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip"],["index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip"],["middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip"],["ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip"],["pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"]]);class Jm extends x{constructor(t){super();const e=t._xrInputSource.hand;if(this._manager=t._manager,this._inputSource=t,this._tracking=!1,this._fingers=[],this._joints=[],this._jointsById={},this._tips=[],this._wrist=null,e.get("wrist")){const t=new qm(0,"wrist",this,null);this._wrist=t,this._joints.push(t),this._jointsById.wrist=t}for(let t=0;t<Km.length;t++){const i=new Hm(t,this);for(let n=0;n<Km[t].length;n++){const s=Km[t][n];if(!e.get(s))continue;const r=new qm(n,s,this,i);this._joints.push(r),this._jointsById[s]=r,r.tip&&(this._tips.push(r),i._tip=r),i._joints.push(r)}}}update(t){const e=this._inputSource._xrInputSource;for(let i=0;i<this._joints.length;i++){const n=this._joints[i],s=e.hand.get(n._id);if(s){let e;if("hidden"!==t.session.visibilityState&&(e=t.getJointPose(s,this._manager._referenceSpace)),e)n.update(e),n.wrist&&!this._tracking&&(this._tracking=!0,this.fire("tracking"));else if(n.wrist){this._tracking&&(this._tracking=!1,this.fire("trackinglost"));break}}}const i=this._jointsById["thumb-metacarpal"],n=this._jointsById["thumb-tip"],s=this._jointsById["index-finger-phalanx-proximal"],r=this._jointsById["index-finger-tip"],o=this._jointsById["ring-finger-phalanx-proximal"],a=this._jointsById["pinky-finger-phalanx-proximal"];if(i&&n&&s&&r&&o&&a){this._inputSource._dirtyRay=!0,this._inputSource._rayLocal.origin.lerp(n._localPosition,r._localPosition,.5);let t=i,e=a;if(this._inputSource.handedness===Lm){const i=t;t=e,e=i}Zm.sub2(t._localPosition,this._wrist._localPosition),Qm.sub2(e._localPosition,this._wrist._localPosition),$m.cross(Zm,Qm).normalize(),Zm.lerp(s._localPosition,o._localPosition,.5),Zm.sub(this._wrist._localPosition).normalize(),this._inputSource._rayLocal.direction.lerp($m,Zm,.5).normalize()}this._fingerIsClosed(1)&&this._fingerIsClosed(2)&&this._fingerIsClosed(3)&&this._fingerIsClosed(4)?this._inputSource._squeezing||(this._inputSource._squeezing=!0,this._inputSource.fire("squeezestart"),this._manager.input.fire("squeezestart",this._inputSource)):this._inputSource._squeezing&&(this._inputSource._squeezing=!1,this._inputSource.fire("squeeze"),this._manager.input.fire("squeeze",this._inputSource),this._inputSource.fire("squeezeend"),this._manager.input.fire("squeezeend",this._inputSource))}_fingerIsClosed(t){const e=this._fingers[t];return Zm.sub2(e.joints[0]._localPosition,e.joints[1]._localPosition).normalize(),Qm.sub2(e.joints[2]._localPosition,e.joints[3]._localPosition).normalize(),Zm.dot(Qm)<-.8}getJointById(t){return this._jointsById[t]||null}get fingers(){return this._fingers}get joints(){return this._joints}get tips(){return this._tips}get wrist(){return this._wrist}get tracking(){return this._tracking}}const tg=new yt;let eg=0;class ig extends x{constructor(t,e){super(),this._id=++eg,this._manager=t,this._xrInputSource=e,this._ray=new rn,this._rayLocal=new rn,this._grip=!1,this._hand=null,e.hand&&(this._hand=new Jm(this)),this._localTransform=null,this._worldTransform=null,this._position=new ht,this._rotation=new yt,this._localPosition=null,this._localRotation=null,this._dirtyLocal=!0,this._selecting=!1,this._squeezing=!1,this._elementInput=!0,this._elementEntity=null,this._hitTestSources=[]}update(t){if(this._hand)this._hand.update(t);else{if(this._xrInputSource.gripSpace){const e=t.getPose(this._xrInputSource.gripSpace,this._manager._referenceSpace);e&&(this._grip||(this._grip=!0,this._localTransform=new bt,this._worldTransform=new bt,this._localPosition=new ht,this._localRotation=new yt),this._dirtyLocal=!0,this._localPosition.copy(e.transform.position),this._localRotation.copy(e.transform.orientation))}const e=t.getPose(this._xrInputSource.targetRaySpace,this._manager._referenceSpace);e&&(this._dirtyRay=!0,this._rayLocal.origin.copy(e.transform.position),this._rayLocal.direction.set(0,0,-1),tg.copy(e.transform.orientation),tg.transformVector(this._rayLocal.direction,this._rayLocal.direction))}}_updateTransforms(){this._dirtyLocal&&(this._dirtyLocal=!1,this._localTransform.setTRS(this._localPosition,this._localRotation,ht.ONE));const t=this._manager.camera.parent;t?this._worldTransform.mul2(t.getWorldTransform(),this._localTransform):this._worldTransform.copy(this._localTransform)}_updateRayTransforms(){const t=this._dirtyRay;this._dirtyRay=!1;if(this._manager.camera.parent){const t=this._manager.camera.parent.getWorldTransform();t.getTranslation(this._position),this._rotation.setFromMat4(t),this._rotation.transformVector(this._rayLocal.origin,this._ray.origin),this._ray.origin.add(this._position),this._rotation.transformVector(this._rayLocal.direction,this._ray.direction)}else t&&(this._ray.origin.copy(this._rayLocal.origin),this._ray.direction.copy(this._rayLocal.direction))}getPosition(){return this._position?(this._updateTransforms(),this._worldTransform.getTranslation(this._position),this._position):null}getLocalPosition(){return this._localPosition}getRotation(){return this._rotation?(this._updateTransforms(),this._rotation.setFromMat4(this._worldTransform),this._rotation):null}getLocalRotation(){return this._localRotation}getOrigin(){return this._updateRayTransforms(),this._ray.origin}getDirection(){return this._updateRayTransforms(),this._ray.direction}hitTestStart(t={}){t.profile=this._xrInputSource.profiles[0];const e=t.callback;t.callback=(t,i)=>{i&&this.onHitTestSourceAdd(i),e&&e(t,i)},this._manager.hitTest.start(t)}onHitTestSourceAdd(t){this._hitTestSources.push(t),this.fire("hittest:add",t),t.on("result",(function(e,i,n){n===this&&this.fire("hittest:result",t,e,i)}),this),t.once("remove",(function(){this.onHitTestSourceRemove(t),this.fire("hittest:remove",t)}),this)}onHitTestSourceRemove(t){const e=this._hitTestSources.indexOf(t);-1!==e&&this._hitTestSources.splice(e,1)}get id(){return this._id}get inputSource(){return this._xrInputSource}get targetRayMode(){return this._xrInputSource.targetRayMode}get handedness(){return this._xrInputSource.handedness}get profiles(){return this._xrInputSource.profiles}get grip(){return this._grip}get hand(){return this._hand}get gamepad(){return this._xrInputSource.gamepad||null}get selecting(){return this._selecting}get squeezing(){return this._squeezing}get elementInput(){return this._elementInput}set elementInput(t){this._elementInput!==t&&(this._elementInput=t,this._elementInput||(this._elementEntity=null))}get elementEntity(){return this._elementEntity}get hitTestSources(){return this._hitTestSources}}class ng extends x{constructor(t){super(),this.manager=t,this._session=null,this._inputSources=[],this._onInputSourcesChangeEvt=t=>{this._onInputSourcesChange(t)},this.manager.on("start",this._onSessionStart,this),this.manager.on("end",this._onSessionEnd,this)}_onSessionStart(){this._session=this.manager.session,this._session.addEventListener("inputsourceschange",this._onInputSourcesChangeEvt),this._session.addEventListener("select",t=>{const e=this._getByInputSource(t.inputSource);e.update(t.frame),e.fire("select",t),this.fire("select",e,t)}),this._session.addEventListener("selectstart",t=>{const e=this._getByInputSource(t.inputSource);e.update(t.frame),e._selecting=!0,e.fire("selectstart",t),this.fire("selectstart",e,t)}),this._session.addEventListener("selectend",t=>{const e=this._getByInputSource(t.inputSource);e.update(t.frame),e._selecting=!1,e.fire("selectend",t),this.fire("selectend",e,t)}),this._session.addEventListener("squeeze",t=>{const e=this._getByInputSource(t.inputSource);e.update(t.frame),e.fire("squeeze",t),this.fire("squeeze",e,t)}),this._session.addEventListener("squeezestart",t=>{const e=this._getByInputSource(t.inputSource);e.update(t.frame),e._squeezing=!0,e.fire("squeezestart",t),this.fire("squeezestart",e,t)}),this._session.addEventListener("squeezeend",t=>{const e=this._getByInputSource(t.inputSource);e.update(t.frame),e._squeezing=!1,e.fire("squeezeend",t),this.fire("squeezeend",e,t)});const t=this._session.inputSources;for(let e=0;e<t.length;e++)this._addInputSource(t[e])}_onSessionEnd(){let t=this._inputSources.length;for(;t--;){const e=this._inputSources[t];this._inputSources.splice(t,1),e.fire("remove"),this.fire("remove",e)}this._session.removeEventListener("inputsourceschange",this._onInputSourcesChangeEvt),this._session=null}_onInputSourcesChange(t){for(let e=0;e<t.removed.length;e++)this._removeInputSource(t.removed[e]);for(let e=0;e<t.added.length;e++)this._addInputSource(t.added[e])}_getByInputSource(t){for(let e=0;e<this._inputSources.length;e++)if(this._inputSources[e].inputSource===t)return this._inputSources[e];return null}_addInputSource(t){if(this._getByInputSource(t))return;const e=new ig(this.manager,t);this._inputSources.push(e),this.fire("add",e)}_removeInputSource(t){for(let e=0;e<this._inputSources.length;e++){if(this._inputSources[e].inputSource!==t)continue;const i=this._inputSources[e];this._inputSources.splice(e,1);let n=i.hitTestSources.length;for(;n--;)i.hitTestSources[n].remove();return i.fire("remove"),void this.fire("remove",i)}}update(t){for(let e=0;e<this._inputSources.length;e++)this._inputSources[e].update(t)}get inputSources(){return this._inputSources}}const sg=new ht,rg=new ht,og=new bt,ag=new bt;class lg extends x{constructor(t){super(),this._manager=t,this._supported=!1,this._available=!1,this._lightProbeRequested=!1,this._lightProbe=null,this._intensity=0,this._rotation=new yt,this._color=new rt,this._sphericalHarmonics=new Float32Array(27),this._manager.on("start",this._onSessionStart,this),this._manager.on("end",this._onSessionEnd,this)}_onSessionStart(){!!this._manager.session.requestLightProbe&&(this._supported=!0)}_onSessionEnd(){this._supported=!1,this._available=!1,this._lightProbeRequested=!1,this._lightProbe=null}start(){let t;this._manager.session||(t=new Error("XR session is not running")),t||this._manager.type===xm||(t=new Error("XR session type is not AR")),t||this._supported||(t=new Error("light-estimation is not supported")),(!t&&this._lightProbe||this._lightProbeRequested)&&(t=new Error("light estimation is already requested")),t?this.fire("error",t):(this._lightProbeRequested=!0,this._manager.session.requestLightProbe().then(t=>{const e=this._lightProbeRequested;this._lightProbeRequested=!1,this._manager.active?e&&(this._lightProbe=t):this.fire("error",new Error("XR session is not active"))}).catch(t=>{this._lightProbeRequested=!1,this.fire("error",t)}))}end(){this._lightProbeRequested=!1,this._lightProbe=null,this._available=!1}update(t){if(!this._lightProbe)return;const e=t.getLightEstimate(this._lightProbe);if(!e)return;this._available||(this._available=!0,this.fire("available"));const i=e.primaryLightIntensity;this._intensity=Math.max(1,Math.max(i.x,Math.max(i.y,i.z))),sg.copy(i).mulScalar(1/this._intensity),this._color.set(sg.x,sg.y,sg.z),sg.set(0,0,0),rg.copy(e.primaryLightDirection),og.setLookAt(rg,sg,ht.UP),ag.setFromAxisAngle(ht.RIGHT,90),og.mul(ag),this._rotation.setFromMat4(og),this._sphericalHarmonics.set(e.sphericalHarmonicsCoefficients)}get supported(){return this._supported}get available(){return this._available}get intensity(){return this._available?this._intensity:null}get color(){return this._available?this._color:null}get rotation(){return this._available?this._rotation:null}get sphericalHarmonics(){return this._available?this._sphericalHarmonics:null}}class hg extends x{constructor(t,e){super(),this._image=t,this._bitmap=null,this._width=e,this._measuredWidth=0,this._trackable=!1,this._tracking=!1,this._emulated=!1,this._pose=null,this._position=new ht,this._rotation=new yt}prepare(){return this._bitmap?{image:this._bitmap,widthInMeters:this._width}:createImageBitmap(this._image).then(t=>(this._bitmap=t,{image:this._bitmap,widthInMeters:this._width}))}destroy(){this._image=null,this._pose=null,this._bitmap&&(this._bitmap.close(),this._bitmap=null)}getPosition(){return this._pose&&this._position.copy(this._pose.transform.position),this._position}getRotation(){return this._pose&&this._rotation.copy(this._pose.transform.orientation),this._rotation}get image(){return this._image}get width(){return this._width}set width(t){this._width=t}get trackable(){return this._trackable}get tracking(){return this._tracking}get emulated(){return this._emulated}}class cg extends x{constructor(t){super(),this._manager=t,this._supported=B.browser&&!!window.XRImageTrackingResult,this._available=!1,this._images=[],this._supported&&(this._manager.on("start",this._onSessionStart,this),this._manager.on("end",this._onSessionEnd,this))}add(t,e){if(!this._supported||this._manager.active)return null;const i=new hg(t,e);return this._images.push(i),i}remove(t){if(this._manager.active)return;const e=this._images.indexOf(t);-1!==e&&(t.destroy(),this._images.splice(e,1))}_onSessionStart(){this._manager.session.getTrackedImageScores().then(t=>{this._available=!0;for(let e=0;e<t.length;e++)this._images[e]._trackable="trackable"===t[e]}).catch(t=>{this._available=!1,this.fire("error",t)})}_onSessionEnd(){this._available=!1;for(let t=0;t<this._images.length;t++)this._images[t]._pose=null,this._images[t]._measuredWidth=0,this._images[t]._tracking&&(this._images[t]._tracking=!1,this._images[t].fire("untracked"))}prepareImages(t){this._images.length?Promise.all(this._images.map((function(t){return t.prepare()}))).then((function(e){t(null,e)})).catch((function(e){t(e,null)})):t(null,null)}update(t){if(!this._available)return;const e=t.getImageTrackingResults(),i={};for(let n=0;n<e.length;n++){i[e[n].index]=e[n];const s=this._images[e[n].index];s._emulated="emulated"===e[n].trackingState,s._measuredWidth=e[n].measuredWidthInMeters,s._dirtyTransform=!0,s._pose=t.getPose(e[n].imageSpace,this._manager._referenceSpace)}for(let t=0;t<this._images.length;t++)this._images[t]._tracking&&!i[t]?(this._images[t]._tracking=!1,this._images[t].fire("untracked")):!this._images[t]._tracking&&i[t]&&(this._images[t]._tracking=!0,this._images[t].fire("tracked"))}get supported(){return this._supported}get available(){return this._available}get images(){return this._images}}class _g{constructor(t){this._manager=t,this._supported=B.browser&&!!window.XRDOMOverlayState,this._root=null}get supported(){return this._supported}get available(){return this._supported&&this._manager.active&&null!==this._manager._session.domOverlayState}get state(){return this._supported&&this._manager.active&&this._manager._session.domOverlayState?this._manager._session.domOverlayState.type:null}set root(t){this._supported&&!this._manager.active&&(this._root=t)}get root(){return this._root}}class ug extends x{constructor(t){super(),this._manager=t,this._available=!1,this._depthInfoCpu=null,this._depthInfoGpu=null,this._usage=null,this._dataFormat=null,this._matrixDirty=!1,this._matrix=new bt,this._emptyBuffer=new Uint8Array(32),this._depthBuffer=null,this._texture=new _a(this._manager.app.graphicsDevice,{format:ps,mipmaps:!1,addressU:pn,addressV:pn,minFilter:Zn,magFilter:Zn}),this.supported&&(this._manager.on("start",this._onSessionStart,this),this._manager.on("end",this._onSessionEnd,this))}_onSessionStart(){const t=this._manager.session;try{this._usage=t.depthUsage,this._dataFormat=t.depthDataFormat}catch(t){this._usage=null,this._dataFormat=null,this._available=!1,this.fire("error",t)}}_onSessionEnd(){this._depthInfoCpu=null,this._depthInfoGpu=null,this._usage=null,this._dataFormat=null,this._available&&(this._available=!1,this.fire("unavailable")),this._depthBuffer=null,this._texture._width=4,this._texture._height=4,this._texture._levels[0]=this._emptyBuffer,this._texture.upload()}_updateTexture(){const t=this._depthInfoCpu||this._depthInfoGpu;if(t){let e=!1;if(t.width===this._texture.width&&t.height===this._texture.height||(this._texture._width=t.width,this._texture._height=t.height,this._matrixDirty=!0,e=!0),this._depthInfoCpu){const t=this._depthInfoCpu.data;this._depthBuffer=new Uint8Array(t),this._texture._levels[0]=this._depthBuffer,this._texture.upload()}else this._depthInfoGpu&&(this._texture._levels[0]=this._depthInfoGpu.texture,this._texture.upload());e&&this.fire("resize",t.width,t.height)}else this._depthBuffer&&(this._depthBuffer=null,this._texture._width=4,this._texture._height=4,this._texture._levels[0]=this._emptyBuffer,this._texture.upload())}update(t,e){if(!this._usage)return;let i=null,n=null;if(this._usage===Bm&&e?i=t.getDepthInformation(e):this._usage===Nm&&e&&(n=t.getDepthInformation(e)),(this._depthInfoCpu&&!i||!this._depthInfoCpu&&i||this.depthInfoGpu&&!n||!this._depthInfoGpu&&n)&&(this._matrixDirty=!0),this._depthInfoCpu=i,this._depthInfoGpu=n,this._updateTexture(),this._matrixDirty){this._matrixDirty=!1;const t=this._depthInfoCpu||this._depthInfoGpu;t?this._matrix.data.set(t.normDepthBufferFromNormView.matrix):this._matrix.setIdentity()}!this._depthInfoCpu&&!this._depthInfoGpu||this._available?this._depthInfoCpu||this._depthInfoGpu||!this._available||(this._available=!1,this.fire("unavailable")):(this._available=!0,this.fire("available"))}getDepth(t,e){return this._depthInfoCpu?this._depthInfoCpu.getDepthInMeters(t,e):null}get supported(){return B.browser&&!!window.XRDepthInformation}get available(){return this._available}get usage(){return this._usage}get dataFormat(){return this._dataFormat}get width(){const t=this._depthInfoCpu||this._depthInfoGpu;return t&&t.width||0}get height(){const t=this._depthInfoCpu||this._depthInfoGpu;return t&&t.height||0}get texture(){return this._texture}get uvMatrix(){return this._matrix}get rawValueToMeters(){const t=this._depthInfoCpu||this._depthInfoGpu;return t&&t.rawValueToMeters||0}}let dg=0;class pg extends x{constructor(t,e){super(),this._id=++dg,this._planeDetection=t,this._manager=this._planeDetection._manager,this._xrPlane=e,this._lastChangedTime=this._xrPlane.lastChangedTime,this._orientation=this._xrPlane.orientation,this._position=new ht,this._rotation=new yt}destroy(){this.fire("remove")}update(t){const e=t.getPose(this._xrPlane.planeSpace,this._manager._referenceSpace);e&&(this._position.copy(e.transform.position),this._rotation.copy(e.transform.orientation)),this._lastChangedTime!==this._xrPlane.lastChangedTime&&(this._lastChangedTime=this._xrPlane.lastChangedTime,this.fire("change"))}getPosition(){return this._position}getRotation(){return this._rotation}get id(){return this.id}get orientation(){return this._orientation}get points(){return this._xrPlane.polygon}}class fg extends x{constructor(t){super(),this._manager=t,this._supported=B.browser&&!!window.XRPlane,this._available=!1,this._planesIndex=new Map,this._planes=null,this._supported&&this._manager.on("end",this._onSessionEnd,this)}_onSessionEnd(){if(this._planes)for(let t=0;t<this._planes.length;t++)this._planes[t].destroy();this._planesIndex.clear(),this._planes=null,this._available&&(this._available=!1,this.fire("unavailable"))}update(t){let e;if(this._available)e=t.detectedPlanes;else try{e=t.detectedPlanes,this._planes=[],this._available=!0,this.fire("available")}catch(t){return}for(const[t,i]of this._planesIndex)e.has(t)||(this._planesIndex.delete(t),this._planes.splice(this._planes.indexOf(i),1),i.destroy(),this.fire("remove",i));for(const i of e){let e=this._planesIndex.get(i);e?e.update(t):(e=new pg(this,i),this._planesIndex.set(i,e),this._planes.push(e),e.update(t),this.fire("add",e))}}get supported(){return this._supported}get available(){return this._available}get planes(){return this._planes}}class mg extends x{constructor(t){super(),this.app=t,this._supported=B.browser&&!!navigator.xr,this._available={},this._available[vm]=!1,this._available[Sm]=!1,this._available[xm]=!1,this._type=null,this._spaceType=null,this._session=null,this._baseLayer=null,this._referenceSpace=null,this.depthSensing=new ug(this),this.domOverlay=new _g(this),this.hitTest=new jm(this),this.imageTracking=new cg(this),this.planeDetection=new fg(this),this.input=new ng(this),this.lightEstimation=new lg(this),this._camera=null,this.views=[],this.viewsPool=[],this._localPosition=new ht,this._localRotation=new yt,this._depthNear=.1,this._depthFar=1e3,this._width=0,this._height=0,this._supported&&(navigator.xr.addEventListener("devicechange",()=>{this._deviceAvailabilityCheck()}),this._deviceAvailabilityCheck())}start(t,e,i,n){let s=n;if("object"==typeof n&&(s=n.callback),!this._available[e])return void(s&&s(new Error("XR is not available")));if(this._session)return void(s&&s(new Error("XR session is already started")));this._camera=t,this._camera.camera.xr=this,this._type=e,this._spaceType=i,this._setClipPlanes(t.nearClip,t.farClip);const r={requiredFeatures:[i],optionalFeatures:[]};if(e===xm){if(r.optionalFeatures.push("light-estimation"),r.optionalFeatures.push("hit-test"),n&&(n.imageTracking&&this.imageTracking.supported&&r.optionalFeatures.push("image-tracking"),n.planeDetection&&r.optionalFeatures.push("plane-detection")),this.domOverlay.supported&&this.domOverlay.root&&(r.optionalFeatures.push("dom-overlay"),r.domOverlay={root:this.domOverlay.root}),n&&n.depthSensing&&this.depthSensing.supported){r.optionalFeatures.push("depth-sensing");const t=[Bm],e=[Um];if(n.depthSensing.usagePreference){const e=t.indexOf(n.depthSensing.usagePreference);-1!==e&&t.splice(e,1),t.unshift(n.depthSensing.usagePreference)}if(n.depthSensing.dataFormatPreference){const t=e.indexOf(n.depthSensing.dataFormatPreference);-1!==t&&e.splice(t,1),e.unshift(n.depthSensing.dataFormatPreference)}r.depthSensing={usagePreference:t,dataFormatPreference:e}}}else e===Sm&&r.optionalFeatures.push("hand-tracking");n&&n.optionalFeatures&&(r.optionalFeatures=r.optionalFeatures.concat(n.optionalFeatures)),this.imageTracking.supported&&this.imageTracking.images.length?this.imageTracking.prepareImages((t,n)=>{if(t)return s&&s(t),void this.fire("error",t);null!==n&&(r.trackedImages=n),this._onStartOptionsReady(e,i,r,s)}):this._onStartOptionsReady(e,i,r,s)}_onStartOptionsReady(t,e,i,n){navigator.xr.requestSession(t,i).then(t=>{this._onSessionStart(t,e,n)}).catch(t=>{this._camera.camera.xr=null,this._camera=null,this._type=null,this._spaceType=null,n&&n(t),this.fire("error",t)})}end(t){this._session?(t&&this.once("end",t),this._session.end()):t&&t(new Error("XR Session is not initialized"))}isAvailable(t){return this._available[t]}_deviceAvailabilityCheck(){for(const t in this._available)this._sessionSupportCheck(t)}_sessionSupportCheck(t){navigator.xr.isSessionSupported(t).then(e=>{this._available[t]!==e&&(this._available[t]=e,this.fire("available",t,e),this.fire("available:"+t,e))}).catch(t=>{this.fire("error",t)})}_onSessionStart(t,e,i){let n=!1;this._session=t;const s=()=>{this.fire("visibility:change",t.visibilityState)},r=()=>{this._setClipPlanes(this._camera.nearClip,this._camera.farClip)},o=()=>{this._session=null,this._referenceSpace=null,this.views=[],this._width=0,this._height=0,this._type=null,this._spaceType=null,this._camera&&(this._camera.off("set_nearClip",r),this._camera.off("set_farClip",r),this._camera.camera.xr=null,this._camera=null),t.removeEventListener("end",o),t.removeEventListener("visibilitychange",s),n||this.fire("end"),this.app.tick()};t.addEventListener("end",o),t.addEventListener("visibilitychange",s),this._camera.on("set_nearClip",r),this._camera.on("set_farClip",r),this._baseLayer=new XRWebGLLayer(t,this.app.graphicsDevice.gl),t.updateRenderState({baseLayer:this._baseLayer,depthNear:this._depthNear,depthFar:this._depthFar}),t.requestReferenceSpace(e).then(t=>{this._referenceSpace=t,this.app.tick(),i&&i(null),this.fire("start")}).catch(e=>{n=!0,t.end(),i&&i(e),this.fire("error",e)})}_setClipPlanes(t,e){this._depthNear===t&&this._depthFar===e||(this._depthNear=t,this._depthFar=e,this._session&&this._session.updateRenderState({depthNear:this._depthNear,depthFar:this._depthFar}))}update(t){if(!this._session)return;const e=t.session.renderState.baseLayer.framebufferWidth,i=t.session.renderState.baseLayer.framebufferHeight;this._width===e&&this._height===i||(this._width=e,this._height=i,this.app.graphicsDevice.setResolution(e,i));const n=t.getViewerPose(this._referenceSpace),s=n?n.views.length:0;if(s>this.views.length)for(let t=0;t<=s-this.views.length;t++){let t=this.viewsPool.pop();t||(t={viewport:new ut,projMat:new bt,viewMat:new bt,viewOffMat:new bt,viewInvMat:new bt,viewInvOffMat:new bt,projViewOffMat:new bt,viewMat3:new ct,position:new Float32Array(3),rotation:new yt}),this.views.push(t)}else if(s<=this.views.length)for(let t=0;t<this.views.length-s;t++)this.viewsPool.push(this.views.pop());if(n){const e=n.transform.position,i=n.transform.orientation;this._localPosition.set(e.x,e.y,e.z),this._localRotation.set(i.x,i.y,i.z,i.w);const s=t.session.renderState.baseLayer;for(let t=0;t<n.views.length;t++){const e=n.views[t],i=this.views[t],r=s.getViewport(e);i.viewport.x=r.x,i.viewport.y=r.y,i.viewport.z=r.width,i.viewport.w=r.height,i.projMat.set(e.projectionMatrix),i.viewMat.set(e.transform.inverse.matrix),i.viewInvMat.set(e.transform.matrix)}}this._camera.camera._node.setLocalPosition(this._localPosition),this._camera.camera._node.setLocalRotation(this._localRotation),this.input.update(t),this._type===xm&&(this.hitTest.supported&&this.hitTest.update(t),this.lightEstimation.supported&&this.lightEstimation.update(t),this.depthSensing.supported&&this.depthSensing.update(t,n&&n.views[0]),this.imageTracking.supported&&this.imageTracking.update(t),this.planeDetection.supported&&this.planeDetection.update(t)),this.fire("update",t)}get supported(){return this._supported}get active(){return!!this._session}get type(){return this._type}get spaceType(){return this._spaceType}get session(){return this._session}get visibilityState(){return this._session?this._session.visibilityState:null}get camera(){return this._camera?this._camera.entity:null}}class gg extends x{constructor(t,e){super(),this.system=t,this.entity=e,this.system.schema&&!this._accessorsBuilt&&this.buildAccessors(this.system.schema),this.on("set",(function(t,e,i){this.fire("set_"+t,t,e,i)})),this.on("set_enabled",this.onSetEnabled,this)}static _buildAccessors(t,e){e.forEach((function(e){const i="object"==typeof e?e.name:e;Object.defineProperty(t,i,{get:function(){return this.data[i]},set:function(t){const e=this.data,n=e[i];e[i]=t,this.fire("set",i,n,t)},configurable:!0})})),t._accessorsBuilt=!0}buildAccessors(t){gg._buildAccessors(this,t)}onSetEnabled(t,e,i){e!==i&&this.entity.enabled&&(i?this.onEnable():this.onDisable())}onEnable(){}onDisable(){}onPostStateChange(){}get data(){const t=this.system.store[this.entity.getGuid()];return t?t.data:null}}class bg extends x{constructor(t){super(),this.app=t,this.store={},this.schema=[]}addComponent(t,e={}){const i=new this.ComponentType(this,t),n=new this.DataType;return this.store[t.getGuid()]={entity:t,data:n},t[this.id]=i,t.c[this.id]=i,this.initializeComponentData(i,e,[]),this.fire("add",t,i),i}removeComponent(t){const e=this.store[t.getGuid()],i=t.c[this.id];this.fire("beforeremove",t,i),delete this.store[t.getGuid()],delete t[this.id],delete t.c[this.id],this.fire("remove",t,e.data)}cloneComponent(t,e){const i=this.store[t.getGuid()];return this.addComponent(e,i.data)}initializeComponentData(t,e={},i){for(let n=0,s=i.length;n<s;n++){const s=i[n];let r,o;"object"==typeof s?(r=s.name,o=s.type):(r=s,o=void 0);let a=e[r];void 0!==a?(void 0!==o&&(a=yg(a,o)),t[r]=a):t[r]=t.data[r]}t.enabled&&t.entity.enabled&&t.onEnable()}getPropertiesOfType(t){const e=[];return(this.schema||[]).forEach((function(i){i&&"object"==typeof i&&i.type===t&&e.push(i)})),e}destroy(){this.off()}}function yg(t,e){if(!t)return t;switch(e){case"rgb":return t instanceof rt?t.clone():new rt(t[0],t[1],t[2]);case"rgba":return t instanceof rt?t.clone():new rt(t[0],t[1],t[2],t[3]);case"vec2":return t instanceof _t?t.clone():new _t(t[0],t[1]);case"vec3":return t instanceof ht?t.clone():new ht(t[0],t[1],t[2]);case"vec4":return t instanceof ut?t.clone():new ut(t[0],t[1],t[2],t[3]);case"boolean":case"number":case"string":case"entity":return t;default:throw new Error("Could not convert unhandled type: "+e)}}w.attach(bg);class vg{constructor(){this._left=1/0,this._right=-1/0,this._len=0,this._recip=0,this._p0=0,this._p1=0,this._t=0,this._hermite={valid:!1,p0:0,m0:0,p1:0,m1:0}}update(t,e){if(t<this._left||t>=this._right){var i=e.length;if(i)if(t<e[0])this._left=-1/0,this._right=e[0],this._len=0,this._recip=0,this._p0=this._p1=0;else if(t>=e[i-1])this._left=e[i-1],this._right=1/0,this._len=0,this._recip=0,this._p0=this._p1=i-1;else{var n=this._findKey(t,e);this._left=e[n],this._right=e[n+1],this._len=this._right-this._left;var s=1/this._len;this._recip=isFinite(s)?s:0,this._p0=n,this._p1=n+1}else this._left=-1/0,this._right=1/0,this._len=0,this._recip=0,this._p0=this._p1=0}this._t=0===this._recip?0:(t-this._left)*this._recip,this._hermite.valid=!1}_findKey(t,e){for(var i=0;t>=e[i+1];)i++;return i}eval(t,e,i){var n,s=i._data,r=i._components,o=this._p0*r;if(e===od)for(n=0;n<r;++n)t[n]=s[o+n];else{var a=this._t,l=this._p1*r;switch(e){case ad:for(n=0;n<r;++n)t[n]=Z.lerp(s[o+n],s[l+n],a);break;case ld:var h=this._hermite;if(!h.valid){var c=a*a,_=a+a,u=1-a,d=u*u;h.valid=!0,h.p0=(1+_)*d,h.m0=a*d,h.p1=c*(3-_),h.m1=c*(a-1)}var p=(3*this._p0+1)*r,f=(3*this._p0+2)*r,m=(3*this._p1+1)*r,g=(3*this._p1+0)*r;for(n=0;n<r;++n)t[n]=h.p0*s[p+n]+h.m0*s[f+n]*this._len+h.p1*s[m+n]+h.m1*s[g+n]*this._len}}}}class Sg{constructor(t){var e;for(this._name=t.name+"Snapshot",this._time=-1,this._cache=[],this._results=[],e=0;e<t._inputs.length;++e)this._cache[e]=new vg;var i=t._curves,n=t._outputs;for(e=0;e<i.length;++e){for(var s=n[i[e]._output],r=[],o=0;o<s._components;++o)r[o]=0;this._results[e]=r}}}class xg{constructor(t,e,i,n,s,r){for(this._name=t.name,this._track=t,this._snapshot=new Sg(t),this._playing=n,this._time=e,this._speed=i,this._loop=s,this._blendWeight=1,this._blendOrder=0,this._eventHandler=r,this._eventCursor=0;this._track.events[this._eventCursor]&&this._track.events[this._eventCursor].time<this.time;)this._eventCursor++}get name(){return this._name}set name(t){this._name=t}get track(){return this._track}get snapshot(){return this._snapshot}get time(){return this._time}set time(t){this._time=t}get speed(){return this._speed}set speed(t){this._speed=t}get loop(){return this._loop}set loop(t){this._loop=t}get blendWeight(){return this._blendWeight}set blendWeight(t){this._blendWeight=t}get blendOrder(){return this._blendOrder}set blendOrder(t){this._blendOrder=t}get eventCursor(){return this._eventCursor}set eventCursor(t){this._eventCursor=t}activeEventsForFrame(t,e){var i;for(0===t&&(this.eventCursor=0),e>this.track.duration&&(i=e-this.track.duration,e=this.track.duration);this.track.events[this.eventCursor]&&this.track.events[this.eventCursor].time>=t&&(e===this.track.duration?this.track.events[this.eventCursor].time<=e:this.track.events[this.eventCursor].time<e);){const t=this.track.events[this.eventCursor];this._eventHandler.fire(t.name,Zp({track:this.track},t)),this.eventCursor++}Number.isFinite(i)&&this.activeEventsForFrame(0,i)}_update(t){if(this._playing){var e=this._time,i=this._track.duration,n=this._speed,s=this._loop;this._track.events.length>0&&i>0&&this.activeEventsForFrame(e,e+n*t),e+=n*t,n>=0?e>i&&(s?e=e%i||0:(e=this._track.duration,this.pause())):e<0&&(s?e=i+(e%i||0):(e=0,this.pause())),this._time=e}this._time!==this._snapshot._time&&this._track.eval(this._time,this._snapshot)}play(){this._playing=!0,this._time=0}stop(){this._playing=!1,this._time=0}pause(){this._playing=!1}resume(){this._playing=!0}reset(){this._time=0}}const wg="NONE",Cg="PREV_STATE",Tg="NEXT_STATE",Ag="PREV_STATE_NEXT_STATE",Eg="NEXT_STATE_PREV_STATE",Mg="GREATER_THAN",Rg="LESS_THAN",Ig="GREATER_THAN_EQUAL_TO",Pg="LESS_THAN_EQUAL_TO",Lg="EQUAL_TO",Dg="NOT_EQUAL_TO",kg="INTEGER",Og="FLOAT",Fg="BOOLEAN",Bg="TRIGGER",Ng="1D",Ug="2D_DIRECTIONAL",Vg="2D_CARTESIAN",zg="DIRECT",Wg="START",Gg="END",jg="ANY",Hg=[Wg,Gg,jg],Xg="OVERWRITE",Yg="ADDITIVE";class qg{constructor(t,e){this._component=t,this.mask=new Int8Array(t.layers.length),this.weights=new Float32Array(t.layers.length),this.totalWeight=0,this.counter=0,this.layerCounter=0,this.valueType=e,this.dirty=!0,this.valueType===qg.TYPE_QUAT?(this.value=new yt,this._currentValue=new yt):(this.value=new ht,this._currentValue=new ht)}getWeight(t){return this.dirty&&this.updateWeights(),0!==this.totalWeight&&this.mask[t]?this.weights[t]/this.totalWeight:0}setMask(t,e){this.mask[t]=e,this._component.layers[t].blendType===Xg&&(this.mask=this.mask.fill(0,0,t)),this.dirty=!0}updateWeights(){this.totalWeight=0;for(let t=0;t<this.weights.length;t++)this.weights[t]=this._component.layers[t].weight,this.totalWeight+=this.mask[t]*this.weights[t];this.dirty=!1}updateValue(t,e){if(0===this.counter&&this.value.set(0,0,0,1),this.mask[t])switch(this._currentValue.set(...e),this.valueType){case qg.TYPE_QUAT:{const e=this.getWeight(t);qg._weightedQuaternion.set(this._currentValue.x*e,this._currentValue.y*e,this._currentValue.z*e,1-e+this._currentValue.w*e);const i=qg._weightedQuaternion.dot(qg._weightedQuaternion);i>0&&qg._weightedQuaternion.mulScalar(1/Math.sqrt(i)),this.value.mul(qg._weightedQuaternion);break}case qg.TYPE_VEC3:this.value.add(this._currentValue.mulScalar(this.getWeight(t)))}}}qg.TYPE_QUAT="QUATERNION",qg.TYPE_VEC3="VECTOR3",qg._weightedQuaternion=new ut;class Kg{constructor(t){this._binder=t,this._clips=[],this._inputs=[],this._outputs=[],this._targets={}}static _dot(t,e){const i=t.length;let n=0;for(let s=0;s<i;++s)n+=t[s]*e[s];return n}static _normalize(t){let e=Kg._dot(t,t);if(e>0){e=1/Math.sqrt(e);const i=t.length;for(let n=0;n<i;++n)t[n]*=e}}static _set(t,e,i){const n=t.length;let s;if("quaternion"===i){let i=Kg._dot(e,e);for(i>0&&(i=1/Math.sqrt(i)),s=0;s<n;++s)t[s]=e[s]*i}else for(s=0;s<n;++s)t[s]=e[s]}static _blendVec(t,e,i){const n=1-i,s=t.length;for(let r=0;r<s;++r)t[r]=t[r]*n+e[r]*i}static _blendQuat(t,e,i){const n=t.length,s=1-i;Kg._dot(t,e)<0&&(i=-i);for(let r=0;r<n;++r)t[r]=t[r]*s+e[r]*i;Kg._normalize(t)}static _blend(t,e,i,n){"quaternion"===n?Kg._blendQuat(t,e,i):Kg._blendVec(t,e,i)}static _stableSort(t,e){const i=t.length;for(let n=0;n<i-1;++n)for(let s=n+1;s<i;++s)if(e(t[s],t[n])){const e=t[n];t[n]=t[s],t[s]=e}}get clips(){return this._clips}addClip(t){const e=this._targets,i=this._binder,n=t.track.curves,s=t.snapshot,r=[],o=[];for(let t=0;t<n.length;++t){const a=n[t].paths;for(let n=0;n<a.length;++n){const l=a[n],h=i.resolve(l);let c=e[h&&h.targetPath||null];if(!c&&h){c={target:h,value:[],curves:0,blendCounter:0};for(let t=0;t<c.target.components;++t)c.value.push(0);if(e[h.targetPath]=c,i.animComponent){if(!i.animComponent.targets[h.targetPath]){let t;t="localRotation"===h.targetPath.substring(h.targetPath.length-13)?qg.TYPE_QUAT:qg.TYPE_VEC3,i.animComponent.targets[h.targetPath]=new qg(i.animComponent,t)}i.animComponent.targets[h.targetPath].layerCounter++,i.animComponent.targets[h.targetPath].setMask(i.layerIndex,1)}}c&&(c.curves++,r.push(s._results[t]),o.push(c))}}this._clips.push(t),this._inputs.push(r),this._outputs.push(o)}removeClip(t){const e=this._targets,i=this._binder,n=this._clips,s=n[t].track.curves;for(let t=0;t<s.length;++t){const n=s[t].paths;for(let t=0;t<n.length;++t){const s=n[t],r=this._binder.resolve(s);r&&(r.curves--,0===r.curves&&(i.unresolve(s),delete e[r.targetPath],i.animComponent&&i.animComponent.targets[r.targetPath].layerCounter--))}}n.splice(t,1),this._inputs.splice(t,1),this._outputs.splice(t,1)}removeClips(){for(;this._clips.length>0;)this.removeClip(0)}findClip(t){const e=this._clips;for(let i=0;i<e.length;++i){const n=e[i];if(n.name===t)return n}return null}rebind(){this._binder.rebind(),this._targets={};const t=[...this.clips];this.removeClips(),t.forEach(t=>{this.addClip(t)})}assignMask(t){return this._binder.assignMask(t)}update(t){const e=this._clips,i=e.map((function(t,e){return e}));let n,s;for(Kg._stableSort(i,(function(t,i){return e[t].blendOrder<e[i].blendOrder})),n=0;n<i.length;++n){const r=i[n],o=e[r],a=this._inputs[r],l=this._outputs[r],h=o.blendWeight;let c,_,u;if(h>0&&o._update(t),h>=1)for(s=0;s<a.length;++s)c=a[s],_=l[s],u=_.value,Kg._set(u,c,_.target.type),_.blendCounter++;else if(h>0)for(s=0;s<a.length;++s)c=a[s],_=l[s],u=_.value,0===_.blendCounter?Kg._set(u,c,_.target.type):Kg._blend(u,c,h,_.target.type),_.blendCounter++}const r=this._targets,o=new Array(4),a=this._binder;for(const t in r)if(r.hasOwnProperty(t)){const e=r[t];if(a.animComponent&&e.target.isTransform){const i=a.animComponent.targets[t];i.counter===i.layerCounter&&(i.counter=0),i.updateValue(a.layerIndex,e.value),o[0]=i.value.x,o[1]=i.value.y,o[2]=i.value.z,o[3]=i.value.w,e.target.func(o),i.counter++}else e.target.func(e.value);e.blendCounter=0}a.update(t)}}class Zg{constructor(t,e,i,n){this._func=t,this._type=e,this._components=i,this._targetPath=n,this._isTransform="localRotation"===this._targetPath.substring(this._targetPath.length-13)||"localPosition"===this._targetPath.substring(this._targetPath.length-13)||"localScale"===this._targetPath.substring(this._targetPath.length-10)}get func(){return this._func}get type(){return this._type}get components(){return this._components}get targetPath(){return this._targetPath}get isTransform(){return this._isTransform}}class Qg{constructor(t){if(this._isPathInMask=(t,e)=>{const i=this._mask[t];return!!i&&!!(i.children||e&&!1!==i.value)},this.graph=t,!t)return;this._mask=null;const e={};!function t(i){e[i.name]=i;for(let e=0;e<i.children.length;++e)t(i.children[e])}(t),this.nodes=e,this.targetCache={};const i=function(t){let e,i=t;for(;i&&!(i instanceof uA);)i=i.parent;return i&&(i.render?e=i.render.meshInstances:i.model&&(e=i.model.meshInstances)),e};this.nodeCounts={},this.activeNodes=[],this.handlers={localPosition:function(t){const e=t.localPosition;return Qg.createAnimTarget((function(t){e.set(...t)}),"vector",3,t,"localPosition")},localRotation:function(t){const e=t.localRotation;return Qg.createAnimTarget((function(t){e.set(...t)}),"quaternion",4,t,"localRotation")},localScale:function(t){const e=t.localScale;return Qg.createAnimTarget((function(t){e.set(...t)}),"vector",3,t,"localScale")},weights:function(t){const e=i(t);if(e){const i=[];for(let n=0;n<e.length;++n)e[n].node.name===t.name&&e[n].morphInstance&&i.push(e[n].morphInstance);if(i.length>0){const e=function(t){for(let e=0;e<t.length;++e)for(let n=0;n<i.length;n++)i[n].setWeight(e,t[e])};return Qg.createAnimTarget(e,"vector",i[0].morph._targets.length,t,"weights")}}return null},materialTexture:function(t,e){const n=i(t);if(n){let i;for(let e=0;e<n.length;++e)if(n[e].node.name===t.name){i=n[e];break}if(i){const n=function(t){const n=this.animComponent.system.app.assets.get(t[0]);n&&n.resource&&"texture"===n.type&&(i.material[e]=n.resource,i.material.update())}.bind(this);return Qg.createAnimTarget(n,"vector",1,t,"materialTexture","material")}}return null}.bind(this)}}_isPathActive(t){if(!this._mask)return!0;const e=[t.entityPath[0],this.graph.name];for(let i=0;i<e.length;++i){let n=e[i];if(this._isPathInMask(n,1===t.entityPath.length))return!0;for(let e=1;e<t.entityPath.length;e++)if(n+="/"+t.entityPath[e],this._isPathInMask(n,e===t.entityPath.length-1))return!0}return!1}findNode(t){if(!this._isPathActive(t))return null;let e;return this.graph&&(e=this.graph.findByPath(t.entityPath)),e||(e=this.nodes[t.entityPath[t.entityPath.length-1]||""]),e}static createAnimTarget(t,e,i,n,s,r){const o=rd.encode(n.path,r||"entity",s);return new Zg(t,e,i,o)}resolve(t){const e=rd.encode(t.entityPath,t.component,t.propertyPath);let i=this.targetCache[e];if(i)return i;const n=this.findNode(t);if(!n)return null;const s=this.handlers[t.propertyPath];return s?(i=s(n),i?(this.targetCache[e]=i,this.nodeCounts[n.path]?this.nodeCounts[n.path]++:(this.activeNodes.push(n),this.nodeCounts[n.path]=1),i):null):null}unresolve(t){if("graph"!==t.component)return;const e=this.nodes[t.entityPath[t.entityPath.length-1]||""];if(this.nodeCounts[e.path]--,0===this.nodeCounts[e.path]){const t=this.activeNodes,i=t.indexOf(e.node),n=t.length;i<n-1&&(t[i]=t[n-1]),t.pop()}}update(t){const e=this.activeNodes;for(let t=0;t<e.length;++t)e[t]._dirtifyLocal()}assignMask(t){return t!==this._mask&&(this._mask=t,!0)}}class $g{constructor(){this._written=!1,this._name="",this._keyFrames=[],this._quat=new yt,this._pos=new ht,this._scale=new ht,this._targetNode=null}getTarget(){return this._targetNode}setTarget(t){this._targetNode=t}}class Jg{constructor(t){this._animation=null,this._time=0,this.looping=!0,this._interpolatedKeys=[],this._interpolatedKeyDict={},this._currKeyIndices={},this.graph=null;var e=this;!function t(i){var n=new $g;n._name=i.name,e._interpolatedKeys.push(n),e._interpolatedKeyDict[i.name]=n,e._currKeyIndices[i.name]=0;for(var s=0;s<i._children.length;s++)t(i._children[s])}(t)}get animation(){return this._animation}set animation(t){this._animation=t,this.currentTime=0}get currentTime(){return this._time}set currentTime(t){this._time=t;for(var e=this._interpolatedKeys.length,i=0;i<e;i++){var n=this._interpolatedKeys[i]._name;this._currKeyIndices[n]=0}this.addTime(0),this.updateGraph()}get numNodes(){return this._interpolatedKeys.length}addTime(t){if(null!==this._animation){var e,i,n,s,r,o,a,l,h=this._animation._nodes,c=this._animation.duration;if(this._time===c&&!this.looping)return;if(this._time+=t,this._time>c)for(this._time=this.looping?0:c,e=0;e<h.length;e++)n=(i=h[e])._name,this._currKeyIndices[n]=0;else if(this._time<0)for(this._time=this.looping?c:0,e=0;e<h.length;e++)n=(i=h[e])._name,this._currKeyIndices[n]=i._keys.length-2;var _,u=t>=0?1:-1;for(e=0;e<h.length;e++)if(n=(i=h[e])._name,s=i._keys,void 0!==(r=this._interpolatedKeyDict[n])){if(_=!1,1!==s.length)for(var d=this._currKeyIndices[n];d<s.length-1&&d>=0;d+=u)if(o=s[d],a=s[d+1],o.time<=this._time&&a.time>=this._time){l=(this._time-o.time)/(a.time-o.time),r._pos.lerp(o.position,a.position,l),r._quat.slerp(o.rotation,a.rotation,l),r._scale.lerp(o.scale,a.scale,l),r._written=!0,this._currKeyIndices[n]=d,_=!0;break}(1===s.length||!_&&0===this._time&&this.looping)&&(r._pos.copy(s[0].position),r._quat.copy(s[0].rotation),r._scale.copy(s[0].scale),r._written=!0)}}}blend(t,e,i){for(var n=this._interpolatedKeys.length,s=0;s<n;s++){var r=t._interpolatedKeys[s],o=e._interpolatedKeys[s],a=this._interpolatedKeys[s];r._written&&o._written?(a._quat.slerp(r._quat,e._interpolatedKeys[s]._quat,i),a._pos.lerp(r._pos,e._interpolatedKeys[s]._pos,i),a._scale.lerp(r._scale,o._scale,i),a._written=!0):r._written?(a._quat.copy(r._quat),a._pos.copy(r._pos),a._scale.copy(r._scale),a._written=!0):o._written&&(a._quat.copy(o._quat),a._pos.copy(o._pos),a._scale.copy(o._scale),a._written=!0)}}setGraph(t){var e;if(this.graph=t,t)for(e=0;e<this._interpolatedKeys.length;e++){var i=this._interpolatedKeys[e],n=t.findByName(i._name);this._interpolatedKeys[e].setTarget(n)}else for(e=0;e<this._interpolatedKeys.length;e++)this._interpolatedKeys[e].setTarget(null)}updateGraph(){if(this.graph)for(var t=0;t<this._interpolatedKeys.length;t++){var e=this._interpolatedKeys[t];if(e._written){var i=e.getTarget();i.localPosition.copy(e._pos),i.localRotation.copy(e._quat),i.localScale.copy(e._scale),i._dirtyLocal||i._dirtifyLocal(),e._written=!1}}}}class tb extends gg{constructor(t,e){super(t,e),this.animationsIndex={},this.on("set_animations",this.onSetAnimations,this),this.on("set_assets",this.onSetAssets,this),this.on("set_loop",this.onSetLoop,this)}play(t,e){if(!this.enabled||!this.entity.enabled)return;const i=this.data;if(i.animations[t]){if(e=e||0,i.prevAnim=i.currAnim,i.currAnim=t,i.model){i.skeleton||i.animEvaluator||this._createAnimationController();const t=i.animations[i.prevAnim],n=i.animations[i.currAnim];if(i.blending=e>0&&i.prevAnim,i.blending&&(i.blend=0,i.blendSpeed=1/e),i.skeleton&&(i.blending?(i.fromSkel.animation=t,i.fromSkel.addTime(i.skeleton._time),i.toSkel.animation=n):i.skeleton.animation=n),i.animEvaluator){const t=i.animEvaluator;if(i.blending)for(;t.clips.length>1;)t.removeClip(0);else i.animEvaluator.removeClips();const e=new xg(i.animations[i.currAnim],0,1,!0,i.loop);e.name=i.currAnim,e.blendWeight=i.blending?0:1,e.reset(),i.animEvaluator.addClip(e)}}i.playing=!0}}getAnimation(t){return this.data.animations[t]}setModel(t){const e=this.data;t!==e.model&&(this._resetAnimationController(),e.model=t,e.animations&&e.currAnim&&e.animations[e.currAnim]&&this.play(e.currAnim))}_resetAnimationController(){const t=this.data;t.skeleton=null,t.fromSkel=null,t.toSkel=null,t.animEvaluator=null}_createAnimationController(){const t=this.data,e=t.model,i=t.animations;let n=!1,s=!1;for(const t in i)if(i.hasOwnProperty(t)){i[t].constructor===sd?s=!0:n=!0}const r=e.getGraph();n?(t.fromSkel=new Jg(r),t.toSkel=new Jg(r),t.skeleton=new Jg(r),t.skeleton.looping=t.loop,t.skeleton.setGraph(r)):s&&(t.animEvaluator=new Kg(new Qg(this.entity)))}loadAnimationAssets(t){if(!t||!t.length)return;const e=this,i=this.system.app.assets,n=t.length,s=function(t){if(t.resources.length>1)for(let i=0;i<t.resources.length;i++)e.animations[t.resources[i].name]=t.resources[i],e.animationsIndex[t.id]=t.resources[i].name;else e.animations[t.name]=t.resource,e.animationsIndex[t.id]=t.name;e.animations=e.animations},r=function(t){t.off("change",e.onAssetChanged,e),t.on("change",e.onAssetChanged,e),t.off("remove",e.onAssetRemoved,e),t.on("remove",e.onAssetRemoved,e),t.resource?s(t):(t.once("load",s,e),e.enabled&&e.entity.enabled&&i.load(t))};for(let e=0;e<n;e++){const n=i.get(t[e]);n?r(n):i.on("add:"+t[e],r)}}onAssetChanged(t,e,i,n){if("resource"===e||"resources"===e)if("resources"===e&&i&&0===i.length&&(i=null),i){let e=!1;if(i.length>1){if(n&&n.length>1)for(let t=0;t<n.length;t++)delete this.animations[n[t].name];else delete this.animations[t.name];e=!1;for(let t=0;t<i.length;t++)this.animations[i[t].name]=i[t],e||this.data.currAnim!==i[t].name||this.data.playing&&this.data.enabled&&this.entity.enabled&&(e=!0,this.play(i[t].name,0));e||(this._stopCurrentAnimation(),this.onSetAnimations())}else{if(n&&n.length>1)for(let t=0;t<n.length;t++)delete this.animations[n[t].name];this.animations[t.name]=i[0]||i,e=!1,this.data.currAnim===t.name&&this.data.playing&&this.data.enabled&&this.entity.enabled&&(e=!0,this.play(t.name,0)),e||(this._stopCurrentAnimation(),this.onSetAnimations())}this.animationsIndex[t.id]=t.name}else{if(n.length>1)for(let t=0;t<n.length;t++)delete this.animations[n[t].name],this.data.currAnim===n[t].name&&this._stopCurrentAnimation();else delete this.animations[t.name],this.data.currAnim===t.name&&this._stopCurrentAnimation();delete this.animationsIndex[t.id]}}onAssetRemoved(t){if(t.off("remove",this.onAssetRemoved,this),this.animations){if(t.resources.length>1)for(let e=0;e<t.resources.length;e++)delete this.animations[t.resources[e].name],this.data.currAnim===t.resources[e].name&&this._stopCurrentAnimation();else delete this.animations[t.name],this.data.currAnim===t.name&&this._stopCurrentAnimation();delete this.animationsIndex[t.id]}}_stopCurrentAnimation(){const t=this.data;if(t.currAnim=null,t.playing=!1,t.skeleton&&(t.skeleton.currentTime=0,t.skeleton.animation=null),t.animEvaluator){for(let e=0;e<t.animEvaluator.clips.length;++e)t.animEvaluator.clips[e].stop();t.animEvaluator.update(0),t.animEvaluator.removeClips()}}onSetAnimations(t,e,i){const n=this.data,s=this.entity.model;if(s){const t=s.model;t&&t!==n.model&&this.setModel(t)}if(!n.currAnim&&n.activate&&n.enabled&&this.entity.enabled)for(const t in n.animations){this.play(t,0);break}}onSetAssets(t,e,i){if(e&&e.length)for(let t=0;t<e.length;t++)if(e[t]){const i=this.system.app.assets.get(e[t]);if(i){i.off("change",this.onAssetChanged,this),i.off("remove",this.onAssetRemoved,this);const t=this.animationsIndex[i.id];this.data.currAnim===t&&this._stopCurrentAnimation(),delete this.animations[t],delete this.animationsIndex[i.id]}}const n=i.map((function(t){return t instanceof Od?t.id:t}));this.loadAnimationAssets(n)}onSetLoop(t,e,i){const n=this.data;if(n.skeleton&&(n.skeleton.looping=n.loop),n.animEvaluator)for(let t=0;t<n.animEvaluator.clips.length;++t)n.animEvaluator.clips[t].loop=n.loop}onSetCurrentTime(t,e,i){const n=this.data;if(n.skeleton){const t=n.skeleton;t.currentTime=i,t.addTime(0),t.updateGraph()}if(n.animEvaluator){const t=n.animEvaluator;for(let e=0;e<t.clips.length;++e)t.clips[e].time=i}}onEnable(){super.onEnable();const t=this.data,e=t.assets,i=this.system.app.assets;if(e)for(let t=0,n=e.length;t<n;t++){let n=e[t];n instanceof Od||(n=i.get(n)),n&&!n.resource&&i.load(n)}if(t.activate&&!t.currAnim)for(const e in t.animations){this.play(e,0);break}}onBeforeRemove(){for(let t=0;t<this.assets.length;t++){let e=this.assets[t];"number"==typeof e&&(e=this.system.app.assets.get(e)),e&&(e.off("change",this.onAssetChanged,this),e.off("remove",this.onAssetRemoved,this))}const t=this.data;delete t.animation,delete t.skeleton,delete t.fromSkel,delete t.toSkel,delete t.animEvaluator}get currentTime(){const t=this.data;if(t.skeleton)return this.data.skeleton._time;if(t.animEvaluator){const e=t.animEvaluator.clips;if(e.length>0)return e[e.length-1].time}return 0}set currentTime(t){const e=this.data;if(e.skeleton){const i=e.skeleton;i.currentTime=t,i.addTime(0),i.updateGraph()}if(e.animEvaluator){const i=e.animEvaluator;for(let e=0;e<i.clips.length;++e)i.clips[e].time=t}}get duration(){return this.data.animations[this.data.currAnim].duration}}class eb{constructor(){this.assets=[],this.speed=1,this.loop=!0,this.activate=!0,this.enabled=!0,this.animations={},this.model=null,this.prevAnim=null,this.currAnim=null,this.blending=!1,this.blend=0,this.blendSpeed=0,this.playing=!1,this.skeleton=null,this.fromSkel=null,this.toSkel=null,this.animEvaluator=null}}const ib=["enabled","assets","speed","loop","activate","animations","skeleton","model","prevAnim","currAnim","fromSkel","toSkel","blending","blendTimeRemaining","playing"];class nb extends bg{constructor(t){super(t),this.id="animation",this.ComponentType=tb,this.DataType=eb,this.schema=ib,this.on("beforeremove",this.onBeforeRemove,this),this.app.systems.on("update",this.onUpdate,this)}initializeComponentData(t,e,i){i=["activate","enabled","loop","speed","assets"],super.initializeComponentData(t,e,i)}cloneComponent(t,e){this.addComponent(e,{}),e.animation.assets=t.animation.assets.slice(),e.animation.data.speed=t.animation.speed,e.animation.data.loop=t.animation.loop,e.animation.data.activate=t.animation.activate,e.animation.data.enabled=t.animation.enabled;const i={},n=t.animation.animations;for(const t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);e.animation.animations=i;const s={},r=t.animation.animationsIndex;for(const t in r)r.hasOwnProperty(t)&&(s[t]=r[t]);e.animation.animationsIndex=s}onBeforeRemove(t,e){e.onBeforeRemove()}onUpdate(t){const e=this.store;for(const i in e)if(e.hasOwnProperty(i)){const n=e[i],s=n.data;if(s.enabled&&n.entity.enabled){if(s.blending&&(s.blend+=t*s.blendSpeed,s.blend>=1&&(s.blend=1)),s.playing){const e=s.skeleton;if(null!==e&&null!==s.model){if(s.blending)e.blend(s.fromSkel,s.toSkel,s.blend);else{const i=t*s.speed;e.addTime(i),(s.speed>0&&e._time===e._animation.duration&&!s.loop||s.speed<0&&0===e._time&&!s.loop)&&(s.playing=!1)}s.blending&&1===s.blend&&(e.animation=s.toSkel._animation),e.updateGraph()}}const e=s.animEvaluator;if(e){for(let t=0;t<e.clips.length;++t){const i=e.clips[t];i.speed=s.speed,s.playing?i.resume():i.pause()}s.blending&&e.clips.length>1&&(e.clips[1].blendWeight=s.blend),e.update(t)}s.blending&&1===s.blend&&(s.blending=!1)}}}destroy(){super.destroy(),this.app.systems.off("update",this.onUpdate,this)}}gg._buildAccessors(tb.prototype,ib);class sb{constructor(t,e,i,n,s=1){this._state=t,this._parent=e,this._name=i,Array.isArray(n)?(this._point=new _t(n[0],n[1]),this._pointLength=this._point.length()):(this._point=n,this._pointLength=n),this._speed=s,this._weightedSpeed=1,this._weight=1,this._animTrack=null}get parent(){return this._parent}get name(){return this._name}get path(){return this._parent?this._parent.path+"."+this._name:this._name}get point(){return this._point}get pointLength(){return this._pointLength}get weight(){return this._parent?this._parent.weight*this._weight:this._weight}set weight(t){this._weight=t}get normalizedWeight(){var t=this._state.totalWeight;return 0===t?0:this.weight/t}get speed(){return this._weightedSpeed*this._speed}get absoluteSpeed(){return Math.abs(this._speed)}get weightedSpeed(){return this._weightedSpeed}set weightedSpeed(t){this._weightedSpeed=t}get animTrack(){return this._animTrack}set animTrack(t){this._animTrack=t}}class rb extends sb{constructor(t,e,i,n,s,r,o,a,l){super(t,e,i,n),this._parameters=s,this._parameterValues=new Array(s.length),this._children=[],this._findParameter=l,this._syncAnimations=!1!==o,this._pointCache={};for(var h=0;h<r.length;h++){var c=r[h];c.children?this._children.push(a(c.type,this,null,i,1,c.parameter?[c.parameter]:c.parameters,c.children,a,l)):this._children.push(new sb(t,this,c.name,c.point,c.speed))}}get weight(){return this.calculateWeights(),this._parent?this._parent.weight*this._weight:this._weight}get syncAnimations(){return this._syncAnimations}getChild(t){for(var e=0;e<this._children.length;e++)if(this._children[e].name===t)return this._children[e];return null}updateParameterValues(){var t=!0;for(let i=0;i<this._parameterValues.length;i++){var e=this._findParameter(this._parameters[i]).value;this._parameterValues[i]!==e&&(this._parameterValues[i]=e,t=!1)}return t}getNodeWeightedDuration(t){return this._children[t].animTrack.duration/this._children[t].speedMultiplier*this._children[t].weight}getNodeCount(){for(var t=0,e=0;e<this._children.length;e++){this._children[e].constructor===rb?t+=this._children[e].getNodeCount():t++}return t}}class ob extends rb{constructor(t,e,i,n,s,r,o,a,l){r.sort((t,e)=>t.point-e.point),super(t,e,i,n,s,r,o,a,l)}calculateWeights(){if(!this.updateParameterValues()){var t,e=0;for(this._children[0].weight=0,t=0;t<this._children.length;t++){var i=this._children[t];if(t!==this._children.length-1){var n=this._children[t+1];if(i.point===n.point)i.weight=.5,n.weight=.5;else if(Z.between(this._parameterValues[0],i.point,n.point,!0)){var s=Math.abs(i.point-n.point),r=(s-Math.abs(i.point-this._parameterValues[0]))/s;i.weight=r,n.weight=1-r}else n.weight=0}this._syncAnimations&&(e+=i.animTrack.duration/i.absoluteSpeed*i.weight)}if(this._syncAnimations)for(t=0;t<this._children.length;t++){const i=this._children[t];i.weightedSpeed=i.animTrack.duration/i.absoluteSpeed/e}}}}class ab extends rb{pointDistanceCache(t,e){var i=`${t}${e}`;return this._pointCache[i]||(this._pointCache[i]=this._children[e].point.clone().sub(this._children[t].point)),this._pointCache[i]}calculateWeights(){if(!this.updateParameterValues()){var t,e,i,n,s,r,o,a;for(ab._p.set(...this._parameterValues),o=0,a=0,t=0;t<this._children.length;t++){const l=this._children[t];for(i=l.point,ab._pip.set(ab._p.x,ab._p.y).sub(i),s=Number.MAX_VALUE,e=0;e<this._children.length;e++)t!==e&&(n=this.pointDistanceCache(t,e),(r=Z.clamp(1-ab._pip.dot(n)/n.lengthSq(),0,1))<s&&(s=r));l.weight=s,o+=s,this._syncAnimations&&(a+=l.animTrack.duration/l.absoluteSpeed*l.weight)}for(t=0;t<this._children.length;t++){const e=this._children[t];e.weight=e._weight/o,this._syncAnimations&&(e.weightedSpeed=e.animTrack.duration/e.absoluteSpeed/a)}}}}ab._p=new _t,ab._pip=new _t;class lb extends rb{pointCache(t,e){var i=`${t}${e}`;return this._pointCache[i]||(this._pointCache[i]=new _t((this._children[e].pointLength-this._children[t].pointLength)/((this._children[e].pointLength+this._children[t].pointLength)/2),2*_t.angleRad(this._children[t].point,this._children[e].point))),this._pointCache[i]}calculateWeights(){if(!this.updateParameterValues()){var t,e,i,n,s,r,o,a;lb._p.set(...this._parameterValues);var l=lb._p.length();for(o=0,a=0,t=0;t<this._children.length;t++){const _=this._children[t];i=_.point;var h=_.pointLength;for(s=Number.MAX_VALUE,e=0;e<this._children.length;e++)if(t!==e){var c=this._children[e].pointLength;n=this.pointCache(t,e),lb._pip.set((l-h)/((c+h)/2),2*_t.angleRad(i,lb._p)),(r=Z.clamp(1-Math.abs(lb._pip.dot(n)/n.lengthSq()),0,1))<s&&(s=r)}_.weight=s,o+=s,this._syncAnimations&&(a+=_.animTrack.duration/_.absoluteSpeed*_.weight)}for(t=0;t<this._children.length;t++){const e=this._children[t];if(e.weight=e._weight/o,this._syncAnimations){const t=e.animTrack.duration/a*o;e.weightedSpeed=e.absoluteSpeed*t}}}}}lb._p=new _t,lb._pip=new _t;class hb extends rb{calculateWeights(){if(!this.updateParameterValues()){var t,e=0,i=0;for(t=0;t<this._children.length;t++)if(e+=Math.max(this._parameterValues[t],0),this._syncAnimations){const e=this._children[t];i+=e.animTrack.duration/e.absoluteSpeed*e.weight}for(t=0;t<this._children.length;t++){const n=this._children[t];n.weight=Math.max(this._parameterValues[t],0)/e,this._syncAnimations&&(n.weightedSpeed=n.animTrack.duration/n.absoluteSpeed/i)}}}}class cb{constructor(t,e,i,n,s){this._controller=t,this._name=e,this._animations={},this._animationList=[],this._speed=i||1,this._loop=void 0===n||n;var r=this._controller.findParameter.bind(this._controller);this._blendTree=s?this._createTree(s.type,this,null,e,1,s.parameter?[s.parameter]:s.parameters,s.children,s.syncAnimations,this._createTree,r):new sb(this,null,e,1,i)}_createTree(t,e,i,n,s,r,o,a,l,h){switch(t){case Ng:return new ob(e,i,n,s,r,o,a,l,h);case Vg:return new ab(e,i,n,s,r,o,a,l,h);case Ug:return new lb(e,i,n,s,r,o,a,l,h);case zg:return new hb(e,i,n,s,r,o,a,l,h)}}_getNodeFromPath(t){for(var e=this._blendTree,i=1;i<t.length;i++)e=e.getChild(t[i]);return e}addAnimation(t,e){var i=t.join("."),n=this._animationList.findIndex((function(t){return t.path===i}));if(n>=0)this._animationList[n].animTrack=e;else{var s=this._getNodeFromPath(t);s.animTrack=e,this._animationList.push(s)}}get name(){return this._name}get animations(){return this._animationList}set animations(t){this._animationList=t}get speed(){return this._speed}set speed(t){this._speed=t}get loop(){return this._loop}set loop(t){this._loop=t}get nodeCount(){return this._blendTree&&this._blendTree.constructor!==sb?this._blendTree.getNodeCount():1}get playable(){return-1!==Hg.indexOf(this.name)||this.animations.length===this.nodeCount}get looping(){if(this.animations.length>0){var t=this.name+"."+this.animations[0].animTrack.name,e=this._controller.animEvaluator.findClip(t);if(e)return e.loop}return!1}get totalWeight(){var t,e=0;for(t=0;t<this.animations.length;t++)e+=this.animations[t].weight;return e}get timelineDuration(){var t,e=0;for(t=0;t<this.animations.length;t++){var i=this.animations[t];i.animTrack.duration>e&&(e=i.animTrack.duration)}return e}}class _b{constructor({from:t,to:e,time:i=0,priority:n=0,conditions:s=[],exitTime:r=null,transitionOffset:o=null,interruptionSource:a=wg}){this._from=t,this._to=e,this._time=i,this._priority=n,this._conditions=s,this._exitTime=r,this._transitionOffset=o,this._interruptionSource=a}get from(){return this._from}get to(){return this._to}set to(t){this._to=t}get time(){return this._time}get priority(){return this._priority}get conditions(){return this._conditions}get exitTime(){return this._exitTime}get transitionOffset(){return this._transitionOffset}get interruptionSource(){return this._interruptionSource}get hasExitTime(){return!!this.exitTime}}class ub{constructor(t,e,i,n,s,r,o){this._animEvaluator=t,this._states={},this._stateNames=[],this._eventHandler=r,this._consumedTriggers=o;for(let t=0;t<e.length;t++)this._states[e[t].name]=new cb(this,e[t].name,e[t].speed,e[t].loop,e[t].blendTree),this._stateNames.push(e[t].name);this._transitions=i.map(t=>new _b(Zp({},t))),this._findTransitionsFromStateCache={},this._findTransitionsBetweenStatesCache={},this._parameters=n,this._previousStateName=null,this._activeStateName=Wg,this._playing=!1,this._activate=s,this._currTransitionTime=1,this._totalTransitionTime=1,this._isTransitioning=!1,this._transitionInterruptionSource=wg,this._transitionPreviousStates=[],this._timeInState=0,this._timeInStateBefore=0}get animEvaluator(){return this._animEvaluator}get activeState(){return this._findState(this._activeStateName)}set activeState(t){this._activeStateName=t}get activeStateName(){return this._activeStateName}get activeStateAnimations(){return this.activeState.animations}get previousState(){return this._findState(this._previousStateName)}set previousState(t){this._previousStateName=t}get previousStateName(){return this._previousStateName}get playable(){let t=!0;for(let e=0;e<this._stateNames.length;e++)this._states[this._stateNames[e]].playable||(t=!1);return t}get playing(){return this._playing}set playing(t){this._playing=t}get activeStateProgress(){return this._getActiveStateProgressForTime(this._timeInState)}get activeStateDuration(){if(this.activeStateName===Wg||this.activeStateName===Gg)return 0;let t=0;for(let e=0;e<this.activeStateAnimations.length;e++){const i=this._animEvaluator.findClip(this.activeStateAnimations[e].name);i&&(t=Math.max(t,i.track.duration))}return t}get activeStateCurrentTime(){return this._timeInState}set activeStateCurrentTime(t){this._timeInStateBefore=t,this._timeInState=t;for(let e=0;e<this.activeStateAnimations.length;e++){const i=this.animEvaluator.findClip(this.activeStateAnimations[e].name);i&&(i.time=t)}}get transitioning(){return this._isTransitioning}get transitionProgress(){return this._currTransitionTime/this._totalTransitionTime}get states(){return this._stateNames}assignMask(t){return this._animEvaluator.assignMask(t)}_findState(t){return this._states[t]}_getActiveStateProgressForTime(t){if(this.activeStateName===Wg||this.activeStateName===Gg||this.activeStateName===jg)return 1;const e=this._animEvaluator.findClip(this.activeStateAnimations[0].name);return e?t/e.track.duration:null}_findTransitionsFromState(t){let e=this._findTransitionsFromStateCache[t];return e||(e=this._transitions.filter((function(e){return e.from===t})),e.sort((function(t,e){return t.priority<e.priority})),this._findTransitionsFromStateCache[t]=e),e}_findTransitionsBetweenStates(t,e){let i=this._findTransitionsBetweenStatesCache[t+"->"+e];return i||(i=this._transitions.filter((function(i){return i.from===t&&i.to===e})),i.sort((function(t,e){return t.priority<e.priority})),this._findTransitionsBetweenStatesCache[t+"->"+e]=i),i}_transitionHasConditionsMet(t){let e=!0;for(let i=0;i<t.conditions.length;i++){const n=t.conditions[i],s=this.findParameter(n.parameterName);switch(n.predicate){case Mg:e=e&&s.value>n.value;break;case Rg:e=e&&s.value<n.value;break;case Ig:e=e&&s.value>=n.value;break;case Pg:e=e&&s.value<=n.value;break;case Lg:e=e&&s.value===n.value;break;case Dg:e=e&&s.value!==n.value}if(!e)return e}return e}_findTransition(t,e){let i=[];if(t&&e)i.concat(this._findTransitionsBetweenStates(t,e));else if(this._isTransitioning)switch(this._transitionInterruptionSource){case Cg:i=i.concat(this._findTransitionsFromState(this._previousStateName)),i=i.concat(this._findTransitionsFromState(jg));break;case Tg:i=i.concat(this._findTransitionsFromState(this._activeStateName)),i=i.concat(this._findTransitionsFromState(jg));break;case Ag:i=i.concat(this._findTransitionsFromState(this._previousStateName)),i=i.concat(this._findTransitionsFromState(this._activeStateName)),i=i.concat(this._findTransitionsFromState(jg));break;case Eg:i=i.concat(this._findTransitionsFromState(this._activeStateName)),i=i.concat(this._findTransitionsFromState(this._previousStateName)),i=i.concat(this._findTransitionsFromState(jg))}else i=i.concat(this._findTransitionsFromState(this._activeStateName)),i=i.concat(this._findTransitionsFromState(jg));if(i=i.filter(function(t){if(t.to===this.activeStateName)return!1;if(t.hasExitTime){let e=this._getActiveStateProgressForTime(this._timeInStateBefore),i=this._getActiveStateProgressForTime(this._timeInState);if(t.exitTime<1&&this.activeState.loop&&(e-=Math.floor(e),i-=Math.floor(i)),!(t.exitTime>e&&t.exitTime<=i))return null}return this._transitionHasConditionsMet(t)}.bind(this)),i.length>0){const t=i[0];if(t.to===Gg){const e=this._findTransitionsFromState(Wg)[0];t.to=e.to}return t}return null}updateStateFromTransition(t){let e,i,n;this.previousState=t.from?this.activeStateName:null,this.activeState=t.to;for(let e=0;e<t.conditions.length;e++){const i=t.conditions[e];this.findParameter(i.parameterName).type===Bg&&this._consumedTriggers.add(i.parameterName)}if(this.previousState){this._isTransitioning||(this._transitionPreviousStates=[]),this._transitionPreviousStates.push({name:this._previousStateName,weight:1});const t=Math.min(this._currTransitionTime/this._totalTransitionTime,1);for(let s=0;s<this._transitionPreviousStates.length;s++){this._isTransitioning?s!==this._transitionPreviousStates.length-1?this._transitionPreviousStates[s].weight*=1-t:this._transitionPreviousStates[s].weight=t:this._transitionPreviousStates[s].weight=1,e=this._findState(this._transitionPreviousStates[s].name);for(let t=0;t<e.animations.length;t++)i=e.animations[t],n=this._animEvaluator.findClip(i.name+".previous."+s),n||(n=this._animEvaluator.findClip(i.name),n.name=i.name+".previous."+s),s!==this._transitionPreviousStates.length-1&&n.pause()}}this._isTransitioning=!0,this._totalTransitionTime=t.time,this._currTransitionTime=0,this._transitionInterruptionSource=t.interruptionSource;const s=this.activeState,r=t.transitionOffset&&t.transitionOffset>0&&t.transitionOffset<1;let o=0,a=0;if(r){const e=s.timelineDuration*t.transitionOffset;o=e,a=e}this._timeInState=o,this._timeInStateBefore=a;for(let e=0;e<s.animations.length;e++){if(n=this._animEvaluator.findClip(s.animations[e].name),n)n.reset();else{const t=Number.isFinite(s.animations[e].speed)?s.animations[e].speed:s.speed;n=new xg(s.animations[e].animTrack,this._timeInState,t,!0,s.loop,this._eventHandler),n.name=s.animations[e].name,this._animEvaluator.addClip(n)}if(t.time>0?n.blendWeight=0:n.blendWeight=s.animations[e].normalizedWeight,n.play(),r)n.time=s.timelineDuration*t.transitionOffset;else{const t=s.speed>=0?0:this.activeStateDuration;n.time=t}}}_transitionToState(t){if(!this._findState(t))return;let e=this._findTransition(this._activeStateName,t);e||(this._animEvaluator.removeClips(),e=new _b({from:null,to:t})),this.updateStateFromTransition(e)}assignAnimation(t,e,i,n){const s=t.split(".");let r=this._findState(s[0]);r||(r=new cb(this,s[0],1),this._states[s[0]]=r,this._stateNames.push(s[0])),r.addAnimation(s,e),void 0!==i&&(r.speed=i),void 0!==n&&(r.loop=n),!this._playing&&this._activate&&this.playable&&this.play()}removeNodeAnimations(t){if(-1!==Hg.indexOf(t))return;const e=this._findState(t);return e?(e.animations=[],!0):void 0}play(t){t&&this._transitionToState(t),this._playing=!0}pause(){this._playing=!1}reset(){this._previousStateName=null,this._activeStateName=Wg,this._playing=!1,this._currTransitionTime=1,this._totalTransitionTime=1,this._isTransitioning=!1,this._timeInState=0,this._timeInStateBefore=0,this._animEvaluator.removeClips()}rebind(){this._animEvaluator.rebind()}update(t){if(!this._playing)return;let e,i,n;this._timeInStateBefore=this._timeInState,this._timeInState+=t;const s=this._findTransition(this._activeStateName);if(s&&this.updateStateFromTransition(s),this._isTransitioning)if(this._currTransitionTime+=t,this._currTransitionTime<=this._totalTransitionTime){const t=this._currTransitionTime/this._totalTransitionTime;for(let s=0;s<this._transitionPreviousStates.length;s++){e=this._findState(this._transitionPreviousStates[s].name);const r=this._transitionPreviousStates[s].weight;for(let o=0;o<e.animations.length;o++)i=e.animations[o],n=this._animEvaluator.findClip(i.name+".previous."+s),n&&(n.blendWeight=(1-t)*i.normalizedWeight*r)}e=this.activeState;for(let n=0;n<e.animations.length;n++)i=e.animations[n],this._animEvaluator.findClip(i.name).blendWeight=t*i.normalizedWeight}else{this._isTransitioning=!1;const t=this.activeStateAnimations.length,s=this._animEvaluator.clips.length;for(let e=0;e<s-t;e++)this._animEvaluator.removeClip(0);this._transitionPreviousStates=[],e=this.activeState;for(let t=0;t<e.animations.length;t++)i=e.animations[t],n=this._animEvaluator.findClip(i.name),n&&(n.blendWeight=i.normalizedWeight)}else if(this.activeState._blendTree.constructor!==sb){e=this.activeState;for(let t=0;t<e.animations.length;t++)i=e.animations[t],n=this._animEvaluator.findClip(i.name),n&&(n.blendWeight=i.normalizedWeight,i.parent.syncAnimations&&(n.speed=i.speed))}this._animEvaluator.update(t)}findParameter(t){return this._parameters[t]}}const db=new _t,pb=new ht,fb=new ut,mb=new rt,gb=new yt;class bb extends Qg{constructor(t,e,i,n,s){super(e),this.animComponent=t,this._mask=n,this.layerName=i,this.layerIndex=s}static _packFloat(t){return t[0]}static _packBoolean(t){return!!t[0]}static _packVec2(t){return db.x=t[0],db.y=t[1],db}static _packVec3(t){return pb.x=t[0],pb.y=t[1],pb.z=t[2],pb}static _packVec4(t){return fb.x=t[0],fb.y=t[1],fb.z=t[2],fb.w=t[3],fb}static _packColor(t){return mb.r=t[0],mb.g=t[1],mb.b=t[2],mb.a=t[3],mb}static _packQuat(t){return gb.x=t[0],gb.y=t[1],gb.z=t[2],gb.w=t[3],gb}resolve(t){const e=rd.encode(t.entityPath,t.component,t.propertyPath);let i,n,s,r=this.targetCache[e];if(r)return r;switch(t.component){case"entity":i=this._getEntityFromHierarchy(t.entityPath),s=rd.encode(i.path,"entity",t.propertyPath),n=i;break;case"graph":if(n=this.findNode(t),!n)return null;s=rd.encode(n.path,"graph",t.propertyPath);break;default:if(i=this._getEntityFromHierarchy(t.entityPath),n=i.findComponent(t.component),!n)return null;s=rd.encode(i.path,t.component,t.propertyPath)}return r=this._createAnimTargetForProperty(n,t.propertyPath,s),this.targetCache[e]=r,r}update(t){const e=this.activeNodes;if(e)for(let t=0;t<e.length;t++)e[t]._dirtifyLocal()}_getEntityFromHierarchy(t){if(!this.animComponent.entity.name===t[0])return null;const e=this.animComponent.entity;return 1===t.length?e:e._parent.findByPath(t)}_resolvePath(t,e,i){const n=e.length-(i?0:1);for(let i=0;i<n;i++)t=t[e[i]];return t}_setter(t,e,i){const n=this._resolvePath(t,e),s=e[e.length-1],r="set"+s.substring(0,1).toUpperCase()+s.substring(1);if(n[r]){const t=n[r].bind(n);return function(e){t(i(e))}}const o=n[s];if("object"==typeof o&&o.hasOwnProperty("copy"))return function(t){o.copy(i(t))};if(-1!==[_t,ht,ut,rt,yt].indexOf(n.constructor)&&e.length>1){const r=e.length>2?this._resolvePath(t,e.slice(0,-1)):t,o=e[e.length-2];return function(t){n[s]=i(t),r[o]=n}}return function(t){n[s]=i(t)}}_createAnimTargetForProperty(t,e,i){if(this.handlers&&"weights"===e[0])return this.handlers.weights(t);if(this.handlers&&"material"===e[0]&&2===e.length){const i=e[1];if(i.indexOf("Map")===i.length-3)return this.handlers.materialTexture(t,i)}const n=this._resolvePath(t,e,!0);if(void 0===n)return null;let s,r,o;if("number"==typeof n)s=this._setter(t,e,bb._packFloat),r="vector",o=1;else if("boolean"==typeof n)s=this._setter(t,e,bb._packBoolean),r="vector",o=1;else if("object"==typeof n)switch(n.constructor){case _t:s=this._setter(t,e,bb._packVec2),r="vector",o=2;break;case ht:s=this._setter(t,e,bb._packVec3),r="vector",o=3;break;case ut:s=this._setter(t,e,bb._packVec4),r="vector",o=4;break;case rt:s=this._setter(t,e,bb._packColor),r="vector",o=4;break;case yt:s=this._setter(t,e,bb._packQuat),r="quaternion",o=4;break;default:return null}return-1!==e.indexOf("material")?new Zg((function(e){s(e),t.material.update()}),r,o,i):new Zg(s,r,o,i)}rebind(){this.targetCache={},this.animComponent.rootBone?this.graph=this.animComponent.rootBone:this.graph=this.animComponent.entity;const t={};!function e(i){t[i.name]=i;for(let t=0;t<i.children.length;++t)e(i.children[t])}(this.graph),this.nodes=t}}class yb{constructor(t,e,i,n=1,s=Xg){this._name=t,this._controller=e,this._component=i,this._weight=n,this._blendType=s}play(t){this._controller.play(t)}pause(){this._controller.pause()}reset(){this._controller.reset()}rebind(){this._controller.rebind()}update(t){this._controller.update(t)}assignMask(t){this._controller.assignMask(t)&&this._component.rebind()}assignAnimation(t,e,i,n){e.constructor===sd&&(this._controller.assignAnimation(t,e,i,n),0===this._controller._transitions.length&&this._controller._transitions.push(new _b({from:"START",to:t})),this._component.activate&&this._component.playable&&(this._component.playing=!0))}removeNodeAnimations(t){this._controller.removeNodeAnimations(t)&&(this._component.playing=!1)}transition(t,e=0,i=null){this._controller.updateStateFromTransition(new _b({from:this._controller.activeStateName,to:t,time:e,transitionOffset:i}))}get name(){return this._name}get playing(){return this._controller.playing}set playing(t){this._controller.playing=t}get playable(){return this._controller.playable}get activeState(){return this._controller.activeStateName}get previousState(){return this._controller.previousStateName}get activeStateProgress(){return this._controller.activeStateProgress}get activeStateDuration(){return this._controller.activeStateDuration}get activeStateCurrentTime(){return this._controller.activeStateCurrentTime}set activeStateCurrentTime(t){this._controller.activeStateCurrentTime=t}get transitioning(){return this._controller.transitioning}get transitionProgress(){return this.transitioning?this._controller.transitionProgress:null}get states(){return this._controller.states}get weight(){return this._weight}set weight(t){this._weight=t,this._component.dirtifyTargets()}get blendType(){return this._blendType}set blendType(t){t!==this._blendType&&(this._blendType=t,this._component.rebind())}}class vb extends gg{constructor(t,e){super(t,e),this._onStateGraphAssetChangeEvent=t=>{this._stateGraph=new pp(t._data),this.loadStateGraph(this._stateGraph)},this._stateGraphAsset=null,this._animationAssets={},this._speed=1,this._activate=!0,this._playing=!1,this._rootBone=null,this._stateGraph=null,this._layers=[],this._layerIndices={},this._parameters={},this._targets={},this._consumedTriggers=new Set}get stateGraphAsset(){return this._stateGraphAsset}set stateGraphAsset(t){if(null===t)return void this.removeStateGraph();let e,i;this._stateGraphAsset&&this.system.app.assets.get(this._stateGraphAsset).off("change",this._onStateGraphAssetChangeEvent),t instanceof Od?(e=t.id,i=this.system.app.assets.get(e),i||(this.system.app.assets.add(t),i=this.system.app.assets.get(e))):(e=t,i=this.system.app.assets.get(e)),i&&this._stateGraphAsset!==e&&(i.resource?(this._stateGraph=i.resource,this.loadStateGraph(this._stateGraph),i.on("change",this._onStateGraphAssetChangeEvent)):(i.once("load",t=>{this._stateGraph=t.resource,this.loadStateGraph(this._stateGraph)}),i.on("change",this._onStateGraphAssetChangeEvent),this.system.app.assets.load(i)),this._stateGraphAsset=e)}get animationAssets(){return this._animationAssets}set animationAssets(t){this._animationAssets=t,this.loadAnimationAssets()}get speed(){return this._speed}set speed(t){this._speed=t}get activate(){return this._activate}set activate(t){this._activate=t}get playing(){return this._playing}set playing(t){this._playing=t}get rootBone(){return this._rootBone}set rootBone(t){if("string"==typeof t){const e=this.entity.root.findByGuid(t);this._rootBone=e}else"Entity"===(null==t?void 0:t.constructor.name)?this._rootBone=t:this._rootBone=null;this.rebind()}get stateGraph(){return this._stateGraph}set stateGraph(t){this._stateGraph=t}get layers(){return this._layers}set layers(t){this._layers=t}get layerIndicies(){return this._layerIndicies}set layerIndicies(t){this._layerIndicies=t}get parameters(){return this._parameters}set parameters(t){this._parameters=t}get targets(){return this._targets}set targets(t){this._targets=t}get playable(){for(let t=0;t<this._layers.length;t++)if(!this._layers[t].playable)return!1;return!0}get baseLayer(){return this._layers.length>0?this._layers[0]:null}dirtifyTargets(){const t=Object.values(this._targets);for(let e=0;e<t.length;e++)t[e].dirty=!0}_addLayer({name:t,states:e,transitions:i,weight:n,mask:s,blendType:r}){let o;o=this.rootBone?this.rootBone:this.entity;const a=this._layers.length,l=new bb(this,o,t,s,a),h=new Kg(l),c=new ub(h,e,i,this._parameters,this._activate,this,this._consumedTriggers);return this._layers.push(new yb(t,c,this,n,r)),this._layerIndices[t]=a,this._layers[a]}addLayer(t,e,i,n){const s=this.findAnimationLayer(t);if(s)return s;return this._addLayer({name:t,states:[{name:"START",speed:1}],transitions:[],weight:e,mask:i,blendType:n})}loadStateGraph(t){this._stateGraph=t,this._parameters={};const e=Object.keys(t.parameters);for(let i=0;i<e.length;i++){const n=e[i];this._parameters[n]={type:t.parameters[n].type,value:t.parameters[n].value}}this._layers=[];for(let e=0;e<t.layers.length;e++){const i=t.layers[e];this._addLayer.bind(this)(Zp({},i))}this.setupAnimationAssets()}setupAnimationAssets(){for(let t=0;t<this._layers.length;t++){const e=this._layers[t],i=e.name;for(let t=0;t<e.states.length;t++){const n=e.states[t];if(-1===Hg.indexOf(n)){const t=i+":"+n;this._animationAssets[t]||(this._animationAssets[t]={asset:null})}}}this.loadAnimationAssets()}loadAnimationAssets(){for(let t=0;t<this._layers.length;t++){const e=this._layers[t];for(let t=0;t<e.states.length;t++){const i=e.states[t];if(-1!==Hg.indexOf(i))continue;const n=this._animationAssets[e.name+":"+i];if(!n||!n.asset){this.removeNodeAnimations(i,e.name);continue}const s=n.asset,r=this.system.app.assets.get(s);if(r)if(r.resource){const t=r.resource;r.data.events&&(t.events=new nd(Object.values(r.data.events))),this.findAnimationLayer(e.name).assignAnimation(i,t)}else r.once("load",function(t,e){return function(i){this.findAnimationLayer(t).assignAnimation(e,i.resource)}.bind(this)}.bind(this)(e.name,i)),this.system.app.assets.load(r)}}}removeStateGraph(){this._stateGraph=null,this._stateGraphAsset=null,this._animationAssets={},this._layers=[],this._layerIndices={},this._parameters={},this._playing=!1}resetStateGraph(){if(this.stateGraphAsset){const t=this.system.app.assets.get(this.stateGraphAsset).resource;this.loadStateGraph(t)}else this.removeStateGraph()}reset(){this._parameters=Object.assign({},this._stateGraph.parameters);for(let t=0;t<this._layers.length;t++){const e=this._layers[t].playing;this._layers[t].reset(),this._layers[t].playing=e}}rebind(){this._targets={};for(let t=0;t<this._layers.length;t++)this._layers[t].rebind()}findAnimationLayer(t){const e=this._layerIndices[t];return this._layers[e]||null}addAnimationState(t,e,i=1,n=!0,s="Base"){this._stateGraph||this.loadStateGraph(new pp({layers:[{name:s,states:[{name:"START",speed:1},{name:t,speed:i,loop:n,defaultState:!0}],transitions:[{from:"START",to:t}]}],parameters:{}}));const r=this.findAnimationLayer(s);var o;r?r.assignAnimation(t,e,i,n):null==(o=this.addLayer(s))||o.assignAnimation(t,e,i,n)}assignAnimation(t,e,i,n=1,s=!0){if(!this._stateGraph)return this.loadStateGraph(new pp({layers:[{name:"Base",states:[{name:"START",speed:1},{name:t,speed:n,loop:s,defaultState:!0}],transitions:[{from:"START",to:t}]}],parameters:{}})),void this.baseLayer.assignAnimation(t,e);const r=i?this.findAnimationLayer(i):this.baseLayer;r&&r.assignAnimation(t,e,n,s)}removeNodeAnimations(t,e){const i=e?this.findAnimationLayer(e):this.baseLayer;i&&i.removeNodeAnimations(t)}getParameterValue(t,e){const i=this._parameters[t];if(i&&i.type===e)return i.value}setParameterValue(t,e,i){const n=this._parameters[t];n&&n.type===e&&(n.value=i)}getFloat(t){return this.getParameterValue(t,Og)}setFloat(t,e){this.setParameterValue(t,Og,e)}getInteger(t){return this.getParameterValue(t,kg)}setInteger(t,e){"number"==typeof e&&e%1==0&&this.setParameterValue(t,kg,e)}getBoolean(t){return this.getParameterValue(t,Fg)}setBoolean(t,e){this.setParameterValue(t,Fg,!!e)}getTrigger(t){return this.getParameterValue(t,Bg)}setTrigger(t,e=!1){this.setParameterValue(t,Bg,!0),e&&this._consumedTriggers.add(t)}resetTrigger(t){this.setParameterValue(t,Bg,!1)}onBeforeRemove(){Number.isFinite(this._stateGraphAsset)&&this.system.app.assets.get(this._stateGraphAsset).off("change",this._onStateGraphAssetChangeEvent)}update(t){for(let e=0;e<this.layers.length;e++)this.layers[e].update(t*this.speed);this._consumedTriggers.forEach(t=>{this.parameters[t].value=!1}),this._consumedTriggers.clear()}resolveDuplicatedEntityReferenceProperties(t,e){t.rootBone&&e[t.rootBone.getGuid()]?this.rootBone=e[t.rootBone.getGuid()]:this.rebind()}}class Sb{constructor(){this.enabled=!0}}const xb=["enabled"];class wb extends bg{constructor(t){super(t),this.id="anim",this.ComponentType=vb,this.DataType=Sb,this.schema=xb,this.on("beforeremove",this.onBeforeRemove,this),this.app.systems.on("animationUpdate",this.onAnimationUpdate,this)}initializeComponentData(t,e,i){super.initializeComponentData(t,e,xb);const n=["animationAssets","stateGraph","layers","masks"];Object.keys(e).forEach(i=>{n.includes(i)||(t[i]=e[i])}),e.stateGraph&&(t.stateGraph=e.stateGraph,t.loadStateGraph(t.stateGraph)),e.layers?e.layers.forEach((e,i)=>{e._controller.states.forEach(n=>{e._controller._states[n]._animationList.forEach(e=>{t.layers[i].assignAnimation(e.name,e.animTrack)})})}):e.animationAssets&&(t.animationAssets=Object.assign(t.animationAssets,e.animationAssets)),e.masks&&Object.keys(e.masks).forEach(i=>{t.layers[i]&&t.layers[i].assignMask(e.masks[i].mask)})}onAnimationUpdate(t){const e=this.store;for(const i in e)if(e.hasOwnProperty(i)){const n=e[i].entity.anim;n.data.enabled&&n.entity.enabled&&n.playing&&n.update(t)}}cloneComponent(t,e){const i={stateGraphAsset:t.anim.stateGraphAsset,animationAssets:t.anim.animationAssets,speed:t.anim.speed,activate:t.anim.activate,playing:t.anim.playing,rootBone:t.anim.rootBone,stateGraph:t.anim.stateGraph,layers:t.anim.layers,layerIndices:t.anim.layerIndices,parameters:t.anim.parameters};this.addComponent(e,i)}onBeforeRemove(t,e){e.onBeforeRemove()}destroy(){super.destroy(),this.app.systems.off("animationUpdate",this.onAnimationUpdate,this)}}gg._buildAccessors(vb.prototype,xb);class Cb extends gg{setCurrentListener(){if(this.enabled&&this.entity.audiolistener&&this.entity.enabled){this.system.current=this.entity;const t=this.system.current.getPosition();this.system.manager.listener.setPosition(t)}}onEnable(){this.setCurrentListener()}onDisable(){this.system.current===this.entity&&(this.system.current=null)}}class Tb{constructor(){this.enabled=!0}}const Ab=["enabled"];class Eb extends bg{constructor(t,e){super(t),this.id="audiolistener",this.ComponentType=Cb,this.DataType=Tb,this.schema=Ab,this.manager=e,this.current=null,this.app.systems.on("update",this.onUpdate,this)}initializeComponentData(t,e,i){i=["enabled"],super.initializeComponentData(t,e,i)}onUpdate(t){if(this.current){const t=this.current.getPosition();this.manager.listener.setPosition(t);const e=this.current.getWorldTransform();this.manager.listener.setOrientation(e)}}destroy(){super.destroy(),this.app.systems.off("update",this.onUpdate,this)}}gg._buildAccessors(Cb.prototype,Ab);class Mb extends gg{constructor(t,e){super(t,e),this.on("set_assets",this.onSetAssets,this),this.on("set_loop",this.onSetLoop,this),this.on("set_volume",this.onSetVolume,this),this.on("set_pitch",this.onSetPitch,this),this.on("set_minDistance",this.onSetMinDistance,this),this.on("set_maxDistance",this.onSetMaxDistance,this),this.on("set_rollOffFactor",this.onSetRollOffFactor,this),this.on("set_distanceModel",this.onSetDistanceModel,this),this.on("set_3d",this.onSet3d,this)}play(t){if(!this.enabled||!this.entity.enabled)return;let e;this.channel&&this.stop();const i=this.data;if(i.sources[t])if(i["3d"]){const n=this.entity.getPosition();e=this.system.manager.playSound3d(i.sources[t],n,i),i.currentSource=t,i.channel=e}else e=this.system.manager.playSound(i.sources[t],i),i.currentSource=t,i.channel=e}pause(){this.channel&&this.channel.pause()}unpause(){this.channel&&this.channel.paused&&this.channel.unpause()}stop(){this.channel&&(this.channel.stop(),this.channel=null)}onSetAssets(t,e,i){const n=[],s=i.length;if(e&&e.length)for(let t=0;t<e.length;t++)if(e[t]){const i=this.system.app.assets.get(e[t]);i&&(i.off("change",this.onAssetChanged,this),i.off("remove",this.onAssetRemoved,this),this.currentSource===i.name&&this.stop())}if(s)for(let t=0;t<s;t++)e.indexOf(i[t])<0&&(i[t]instanceof Od?n.push(i[t].id):n.push(i[t]));!this.system._inTools&&n.length&&this.loadAudioSourceAssets(n)}onAssetChanged(t,e,i,n){if("resource"===e){this.data.sources&&(this.data.sources[t.name]=i,this.data.currentSource===t.name&&this.channel&&(this.channel.paused?(this.play(t.name),this.pause()):this.play(t.name)))}}onAssetRemoved(t){t.off("remove",this.onAssetRemoved,this),this.data.sources[t.name]&&(delete this.data.sources[t.name],this.data.currentSource===t.name&&(this.stop(),this.data.currentSource=null))}onSetLoop(t,e,i){e!==i&&this.channel&&this.channel.setLoop(i)}onSetVolume(t,e,i){e!==i&&this.channel&&this.channel.setVolume(i)}onSetPitch(t,e,i){e!==i&&this.channel&&this.channel.setPitch(i)}onSetMaxDistance(t,e,i){e!==i&&this.channel instanceof Xu&&this.channel.setMaxDistance(i)}onSetMinDistance(t,e,i){e!==i&&this.channel instanceof Xu&&this.channel.setMinDistance(i)}onSetRollOffFactor(t,e,i){e!==i&&this.channel instanceof Xu&&this.channel.setRollOffFactor(i)}onSetDistanceModel(t,e,i){e!==i&&this.channel instanceof Xu&&this.channel.setDistanceModel(i)}onSet3d(t,e,i){if(e!==i&&this.system.initialized&&this.currentSource){let t=!1,e=!1;this.channel&&(t=this.channel.paused,e=this.channel.suspended),this.play(this.currentSource),this.channel&&(this.channel.paused=t,this.channel.suspended=e)}}onEnable(){const t=this.data.assets;if(t){const e=this.system.app.assets;for(let i=0,n=t.length;i<n;i++){let n=t[i];n instanceof Od||(n=e.get(n)),n&&!n.resource&&e.load(n)}}this.system.initialized&&(this.data.activate&&!this.channel?this.play(this.currentSource):this.unpause())}onDisable(){this.pause()}loadAudioSourceAssets(t){const e=t.map(t=>this.system.app.assets.get(t)),i={};let n=null,s=e.length;const r=t=>{s--},o=()=>{this.data.sources=i,this.data.currentSource=n,this.enabled&&this.activate&&n&&this.onEnable()};e.forEach((e,a)=>{e?(n=n||e.name,e.off("change",this.onAssetChanged,this),e.on("change",this.onAssetChanged,this),e.off("remove",this.onAssetRemoved,this),e.on("remove",this.onAssetRemoved,this),e.off("error",r,this),e.on("error",r,this),e.ready(t=>{i[t.name]=t.resource,s--,0===s&&o()}),!e.resource&&this.enabled&&this.entity.enabled&&this.system.app.assets.load(e)):(s--,0===s&&o(),this.system.app.assets.on("add:"+t[a],t=>{t.ready(t=>{this.data.sources[t.name]=t.resource}),t.resource||this.system.app.assets.load(t)}))})}}class Rb{constructor(){this.enabled=!0,this.assets=[],this.activate=!0,this.volume=1,this.pitch=1,this.loop=!1,this["3d"]=!0,this.minDistance=1,this.maxDistance=1e4,this.rollOffFactor=1,this.distanceModel=ju,this.paused=!0,this.sources={},this.currentSource=null,this.channel=null}}const Ib=["enabled","assets","volume","pitch","loop","activate","3d","minDistance","maxDistance","rollOffFactor","distanceModel","sources","currentSource","channel"];class Pb extends bg{constructor(t,e){super(t),this.id="audiosource",this.ComponentType=Mb,this.DataType=Rb,this.schema=Ib,this.manager=e,this.initialized=!1,this.app.systems.on("initialize",this.onInitialize,this),this.app.systems.on("update",this.onUpdate,this),this.on("remove",this.onRemove,this)}initializeComponentData(t,e,i){i=["activate","volume","pitch","loop","3d","minDistance","maxDistance","rollOffFactor","distanceModel","enabled","assets"],super.initializeComponentData(t,e,i),t.paused=!(t.enabled&&t.activate)}onInitialize(t){t.audiosource&&t.enabled&&t.audiosource.enabled&&t.audiosource.activate&&t.audiosource.play(t.audiosource.currentSource);const e=t._children;for(let t=0,i=e.length;t<i;t++)e[t]instanceof uA&&this.onInitialize(e[t]);this.initialized=!0}onUpdate(t){const e=this.store;for(const t in e)if(e.hasOwnProperty(t)){const i=e[t],n=i.entity,s=i.data;if(s.enabled&&n.enabled&&s.channel instanceof Xu){const t=n.getPosition();s.channel.setPosition(t)}}}onRemove(t,e){e.channel&&(e.channel.stop(),e.channel=null)}setVolume(t){this.manager.setVolume(t)}destroy(){super.destroy(),this.app.systems.off("initialize",this.onInitialize,this),this.app.systems.off("update",this.onUpdate,this)}}gg._buildAccessors(Mb.prototype,Ib);class Lb extends x{constructor(t,e,i){if(super(),!(t&&t instanceof gg))throw new Error("The parentComponent argument is required and must be a Component");if(!e||"string"!=typeof e)throw new Error("The propertyName argument is required and must be a string");if(i&&"object"!=typeof i)throw new Error("If provided, the eventConfig argument must be an object");this._parentComponent=t,this._entityPropertyName=e,this._entity=null,this._app=t.system.app,this._configureEventListeners(i||{},{"entity#destroy":this._onEntityDestroy}),this._toggleLifecycleListeners("on")}_configureEventListeners(t,e){const i=this._parseEventListenerConfig(t,"external",this._parentComponent),n=this._parseEventListenerConfig(e,"internal",this);this._eventListenerConfigs=i.concat(n),this._listenerStatusFlags={},this._gainListeners={},this._loseListeners={}}_parseEventListenerConfig(t,e,i){return Object.keys(t).map((function(n,s){const r=n.split("#"),o=r[0],a=r[1],l=t[n];if(2!==r.length||"string"!=typeof o||0===o.length||"string"!=typeof a||0===a.length)throw new Error("Invalid event listener description: `"+n+"`");if("function"!=typeof l)throw new Error("Invalid or missing callback for event listener `"+n+"`");return{id:e+"_"+s+"_"+n,sourceName:o,eventName:a,callback:l,scope:i}}),this)}_toggleLifecycleListeners(t){this._parentComponent[t]("set_"+this._entityPropertyName,this._onSetEntity,this),this._parentComponent.system[t]("beforeremove",this._onParentComponentRemove,this),this._app[t]("postinitialize",this._onPostInitialize,this),this._app[t]("tools:sceneloaded",this._onSceneLoaded,this);const e=[];for(let t=0;t<this._eventListenerConfigs.length;++t){const i=this._eventListenerConfigs[t],n=this._app.systems[i.sourceName];n&&(-1===e.indexOf(n)&&e.push(n),n&&"gain"===i.eventName&&(this._gainListeners[i.sourceName]=i),n&&"lose"===i.eventName&&(this._loseListeners[i.sourceName]=i))}for(let i=0;i<e.length;++i)e[i][t]("add",this._onComponentAdd,this),e[i][t]("beforeremove",this._onComponentRemove,this)}_onSetEntity(t,e,i){if(i instanceof uA)this._updateEntityReference();else{if(null!=i&&"string"!=typeof i)return void console.warn("Entity field `"+this._entityPropertyName+"` was set to unexpected type '"+typeof i+"'");e!==i&&this._updateEntityReference()}}_onPostInitialize(){this._updateEntityReference()}onParentComponentEnable(){this._entity||this._updateEntityReference()}_onSceneLoaded(){this._updateEntityReference()}_updateEntityReference(){let t,e=this._parentComponent.data[this._entityPropertyName];if(e instanceof uA)t=e,e=t.getGuid(),this._parentComponent.data[this._entityPropertyName]=e;else{const i=this._parentComponent.system.app.root;t=this._parentComponent.entity.isDescendantOf(i)&&e?i.findByGuid(e):null}this._entity!==t&&(this._entity&&this._onBeforeEntityChange(),this._entity=t,this._entity&&this._onAfterEntityChange(),this.fire("set:entity",this._entity))}_onBeforeEntityChange(){this._toggleEntityListeners("off"),this._callAllGainOrLoseListeners(this._loseListeners)}_onAfterEntityChange(){this._toggleEntityListeners("on"),this._callAllGainOrLoseListeners(this._gainListeners)}_onComponentAdd(t,e){const i=e.system.id;t===this._entity&&(this._callGainOrLoseListener(i,this._gainListeners),this._toggleComponentListeners("on",i))}_onComponentRemove(t,e){const i=e.system.id;t===this._entity&&(this._callGainOrLoseListener(i,this._loseListeners),this._toggleComponentListeners("off",i,!0))}_callAllGainOrLoseListeners(t){for(const e in this._entity.c)this._callGainOrLoseListener(e,t)}_callGainOrLoseListener(t,e){if(this._entity.c.hasOwnProperty(t)&&e[t]){const i=e[t];i.callback.call(i.scope)}}_toggleEntityListeners(t,e){if(this._entity)for(let i=0;i<this._eventListenerConfigs.length;++i)this._safeToggleListener(t,this._eventListenerConfigs[i],e)}_toggleComponentListeners(t,e,i){for(let n=0;n<this._eventListenerConfigs.length;++n){const s=this._eventListenerConfigs[n];s.sourceName===e&&this._safeToggleListener(t,s,i)}}_safeToggleListener(t,e,i){const n="on"===t;if(n&&this._listenerStatusFlags[e.id])return;const s=this._getEventSource(e.sourceName,i);s&&(s[t](e.eventName,e.callback,e.scope),this._listenerStatusFlags[e.id]=n)}_getEventSource(t,e){if("entity"===t)return this._entity;const i=this._entity[t];return i||(e||console.warn("Entity has no component with name "+t),null)}_onEntityDestroy(t){this._entity===t&&(this._toggleEntityListeners("off",!0),this._entity=null)}_onParentComponentRemove(t,e){e===this._parentComponent&&(this._toggleLifecycleListeners("off"),this._toggleEntityListeners("off",!0))}hasComponent(t){return!(!this._entity||!this._entity.c)&&!!this._entity.c[t]}get entity(){return this._entity}}const Db=0,kb=1,Ob="DEFAULT",Fb="HOVER",Bb="PRESSED",Nb="INACTIVE",Ub={};Ub[Ob]="_defaultTint",Ub[Fb]="hoverTint",Ub[Bb]="pressedTint",Ub[Nb]="inactiveTint";const Vb={};Vb[Ob]="_defaultSpriteAsset",Vb[Fb]="hoverSpriteAsset",Vb[Bb]="pressedSpriteAsset",Vb[Nb]="inactiveSpriteAsset";const zb={};zb[Ob]="_defaultSpriteFrame",zb[Fb]="hoverSpriteFrame",zb[Bb]="pressedSpriteFrame",zb[Nb]="inactiveSpriteFrame";class Wb extends gg{constructor(t,e){super(t,e),this._visualState=Ob,this._isHovering=!1,this._hoveringCounter=0,this._isPressed=!1,this._defaultTint=new rt(1,1,1,1),this._defaultSpriteAsset=null,this._defaultSpriteFrame=0,this._imageReference=new Lb(this,"imageEntity",{"element#gain":this._onImageElementGain,"element#lose":this._onImageElementLose,"element#set:color":this._onSetColor,"element#set:opacity":this._onSetOpacity,"element#set:spriteAsset":this._onSetSpriteAsset,"element#set:spriteFrame":this._onSetSpriteFrame}),this._toggleLifecycleListeners("on",t)}_toggleLifecycleListeners(t,e){this[t]("set_active",this._onSetActive,this),this[t]("set_transitionMode",this._onSetTransitionMode,this),this[t]("set_hoverTint",this._onSetTransitionValue,this),this[t]("set_pressedTint",this._onSetTransitionValue,this),this[t]("set_inactiveTint",this._onSetTransitionValue,this),this[t]("set_hoverSpriteAsset",this._onSetTransitionValue,this),this[t]("set_hoverSpriteFrame",this._onSetTransitionValue,this),this[t]("set_pressedSpriteAsset",this._onSetTransitionValue,this),this[t]("set_pressedSpriteFrame",this._onSetTransitionValue,this),this[t]("set_inactiveSpriteAsset",this._onSetTransitionValue,this),this[t]("set_inactiveSpriteFrame",this._onSetTransitionValue,this),e.app.systems.element[t]("add",this._onElementComponentAdd,this),e.app.systems.element[t]("beforeremove",this._onElementComponentRemove,this)}_onSetActive(t,e,i){e!==i&&this._updateVisualState()}_onSetTransitionMode(t,e,i){e!==i&&(this._cancelTween(),this._resetToDefaultVisualState(e),this._forceReapplyVisualState())}_onSetTransitionValue(t,e,i){e!==i&&this._forceReapplyVisualState()}_onElementComponentRemove(t){this.entity===t&&this._toggleHitElementListeners("off")}_onElementComponentAdd(t){this.entity===t&&this._toggleHitElementListeners("on")}_onImageElementLose(){this._cancelTween(),this._resetToDefaultVisualState(this.transitionMode)}_onImageElementGain(){this._storeDefaultVisualState(),this._forceReapplyVisualState()}_toggleHitElementListeners(t){if(this.entity.element){const e="on"===t;if(e&&this._hasHitElementListeners)return;this.entity.element[t]("mouseenter",this._onMouseEnter,this),this.entity.element[t]("mouseleave",this._onMouseLeave,this),this.entity.element[t]("mousedown",this._onMouseDown,this),this.entity.element[t]("mouseup",this._onMouseUp,this),this.entity.element[t]("touchstart",this._onTouchStart,this),this.entity.element[t]("touchend",this._onTouchEnd,this),this.entity.element[t]("touchleave",this._onTouchLeave,this),this.entity.element[t]("touchcancel",this._onTouchCancel,this),this.entity.element[t]("selectstart",this._onSelectStart,this),this.entity.element[t]("selectend",this._onSelectEnd,this),this.entity.element[t]("selectenter",this._onSelectEnter,this),this.entity.element[t]("selectleave",this._onSelectLeave,this),this.entity.element[t]("click",this._onClick,this),this._hasHitElementListeners=e}}_storeDefaultVisualState(){this._imageReference.hasComponent("element")&&(this._storeDefaultColor(this._imageReference.entity.element.color),this._storeDefaultOpacity(this._imageReference.entity.element.opacity),this._storeDefaultSpriteAsset(this._imageReference.entity.element.spriteAsset),this._storeDefaultSpriteFrame(this._imageReference.entity.element.spriteFrame))}_storeDefaultColor(t){this._defaultTint.r=t.r,this._defaultTint.g=t.g,this._defaultTint.b=t.b}_storeDefaultOpacity(t){this._defaultTint.a=t}_storeDefaultSpriteAsset(t){this._defaultSpriteAsset=t}_storeDefaultSpriteFrame(t){this._defaultSpriteFrame=t}_onSetColor(t){this._isApplyingTint||(this._storeDefaultColor(t),this._forceReapplyVisualState())}_onSetOpacity(t){this._isApplyingTint||(this._storeDefaultOpacity(t),this._forceReapplyVisualState())}_onSetSpriteAsset(t){this._isApplyingSprite||(this._storeDefaultSpriteAsset(t),this._forceReapplyVisualState())}_onSetSpriteFrame(t){this._isApplyingSprite||(this._storeDefaultSpriteFrame(t),this._forceReapplyVisualState())}_onMouseEnter(t){this._isHovering=!0,this._updateVisualState(),this._fireIfActive("mouseenter",t)}_onMouseLeave(t){this._isHovering=!1,this._isPressed=!1,this._updateVisualState(),this._fireIfActive("mouseleave",t)}_onMouseDown(t){this._isPressed=!0,this._updateVisualState(),this._fireIfActive("mousedown",t)}_onMouseUp(t){this._isPressed=!1,this._updateVisualState(),this._fireIfActive("mouseup",t)}_onTouchStart(t){this._isPressed=!0,this._updateVisualState(),this._fireIfActive("touchstart",t)}_onTouchEnd(t){t.event.preventDefault(),this._isPressed=!1,this._updateVisualState(),this._fireIfActive("touchend",t)}_onTouchLeave(t){this._isPressed=!1,this._updateVisualState(),this._fireIfActive("touchleave",t)}_onTouchCancel(t){this._isPressed=!1,this._updateVisualState(),this._fireIfActive("touchcancel",t)}_onSelectStart(t){this._isPressed=!0,this._updateVisualState(),this._fireIfActive("selectstart",t)}_onSelectEnd(t){this._isPressed=!1,this._updateVisualState(),this._fireIfActive("selectend",t)}_onSelectEnter(t){this._hoveringCounter++,1===this._hoveringCounter&&(this._isHovering=!0,this._updateVisualState()),this._fireIfActive("selectenter",t)}_onSelectLeave(t){this._hoveringCounter--,0===this._hoveringCounter&&(this._isHovering=!1,this._isPressed=!1,this._updateVisualState()),this._fireIfActive("selectleave",t)}_onClick(t){this._fireIfActive("click",t)}_fireIfActive(t,e){this.data.active&&this.fire(t,e)}_updateVisualState(t){const e=this._visualState,i=this._determineVisualState();if((e!==i||t)&&this.enabled)switch(this._visualState=i,e===Fb&&this._fireIfActive("hoverend"),e===Bb&&this._fireIfActive("pressedend"),i===Fb&&this._fireIfActive("hoverstart"),i===Bb&&this._fireIfActive("pressedstart"),this.transitionMode){case Db:{const t=this[Ub[this._visualState]];this._applyTint(t);break}case kb:{const t=Vb[this._visualState],e=zb[this._visualState],i=this[t],n=this[e];this._applySprite(i,n);break}}}_forceReapplyVisualState(){this._updateVisualState(!0)}_resetToDefaultVisualState(t){if(this._imageReference.hasComponent("element"))switch(t){case Db:this._cancelTween(),this._applyTintImmediately(this._defaultTint);break;case kb:this._applySprite(this._defaultSpriteAsset,this._defaultSpriteFrame)}}_determineVisualState(){return this.active?this._isPressed?Bb:this._isHovering?Fb:Ob:Nb}_applySprite(t,e){e=e||0,this._imageReference.hasComponent("element")&&(this._isApplyingSprite=!0,this._imageReference.entity.element.spriteAsset=t,this._imageReference.entity.element.spriteFrame=e,this._isApplyingSprite=!1)}_applyTint(t){this._cancelTween(),0===this.fadeDuration?this._applyTintImmediately(t):this._applyTintWithTween(t)}_applyTintImmediately(t){var e;this._imageReference.hasComponent("element")&&t&&(this._isApplyingTint=!0,this._imageReference.entity.element.color=new rt((e=t).r,e.g,e.b),this._imageReference.entity.element.opacity=t.a,this._isApplyingTint=!1)}_applyTintWithTween(t){if(this._imageReference.hasComponent("element")&&t){const e=this._imageReference.entity.element.color,i=this._imageReference.entity.element.opacity;this._tweenInfo={startTime:H(),from:new rt(e.r,e.g,e.b,i),to:t.clone(),lerpColor:new rt}}}_updateTintTween(){const t=H()-this._tweenInfo.startTime;let e=0===this.fadeDuration?1:t/this.fadeDuration;if(e=Z.clamp(e,0,1),Math.abs(e-1)>1e-5){const t=this._tweenInfo.lerpColor;t.lerp(this._tweenInfo.from,this._tweenInfo.to,e),this._applyTintImmediately(new rt(t.r,t.g,t.b,t.a))}else this._applyTintImmediately(this._tweenInfo.to),this._cancelTween()}_cancelTween(){delete this._tweenInfo}onUpdate(){this._tweenInfo&&this._updateTintTween()}onEnable(){this._isHovering=!1,this._hoveringCounter=0,this._isPressed=!1,this._imageReference.onParentComponentEnable(),this._toggleHitElementListeners("on"),this._forceReapplyVisualState()}onDisable(){this._toggleHitElementListeners("off"),this._resetToDefaultVisualState(this.transitionMode)}onRemove(){this._toggleLifecycleListeners("off",this.system),this.onDisable()}}class Gb{constructor(){this.enabled=!0,this.active=!0,this.imageEntity=null,this.hitPadding=new ut,this.transitionMode=Db,this.hoverTint=new rt(.75,.75,.75),this.pressedTint=new rt(.5,.5,.5),this.inactiveTint=new rt(.25,.25,.25),this.fadeDuration=0,this.hoverSpriteAsset=null,this.hoverSpriteFrame=0,this.pressedSpriteAsset=null,this.pressedSpriteFrame=0,this.inactiveSpriteAsset=null,this.inactiveSpriteFrame=0}}const jb=["enabled","active",{name:"imageEntity",type:"entity"},{name:"hitPadding",type:"vec4"},"transitionMode",{name:"hoverTint",type:"rgba"},{name:"pressedTint",type:"rgba"},{name:"inactiveTint",type:"rgba"},"fadeDuration","hoverSpriteAsset","hoverSpriteFrame","pressedSpriteAsset","pressedSpriteFrame","inactiveSpriteAsset","inactiveSpriteFrame"];class Hb extends bg{constructor(t){super(t),this.id="button",this.ComponentType=Wb,this.DataType=Gb,this.schema=jb,this.on("beforeremove",this._onRemoveComponent,this),this.app.systems.on("update",this.onUpdate,this)}initializeComponentData(t,e,i){super.initializeComponentData(t,e,jb)}onUpdate(t){const e=this.store;for(const t in e){const i=e[t].entity,n=i.button;n.enabled&&i.enabled&&n.onUpdate()}}_onRemoveComponent(t,e){e.onRemove()}destroy(){super.destroy(),this.app.systems.off("update",this.onUpdate,this)}}let Xb;gg._buildAccessors(Wb.prototype,jb);class Yb{constructor(t,e){this.effect=t,this.inputTarget=e,this.outputTarget=null,this.name=t.constructor.name}}class qb{constructor(t,e){this.app=t,this.camera=e,this.destinationRenderTarget=null,this.effects=[],this.enabled=!1,this.depthTarget=null,this.renderTargetScale=1,this.resizeTimeout=null,this.resizeLast=0,this._resizeTimeoutCallback=()=>{this.resizeRenderTargets()},e.on("set:rect",this.onCameraRectChanged,this)}_allocateColorBuffer(t,e){const i=this.camera.rect,n=Math.floor(i.z*this.app.graphicsDevice.width*this.renderTargetScale),s=Math.floor(i.w*this.app.graphicsDevice.height*this.renderTargetScale),r=new _a(this.app.graphicsDevice,{format:t,width:n,height:s,mipmaps:!1,minFilter:Kn,magFilter:Kn,addressU:pn,addressV:pn});return r.name=e,r}_createOffscreenTarget(t,e){const i=this.app.graphicsDevice,n=e?i.getHdrFormat():ys,s=this.camera.entity.name+"-posteffect-"+this.effects.length,r=this._allocateColorBuffer(n,s),o=this.app.graphicsDevice.supportsStencil,a=t?i.samples:1;return new Gl({colorBuffer:r,depth:t,stencil:o,samples:a})}_resizeOffscreenTarget(t){const e=t.colorBuffer.format,i=t.colorBuffer.name;t.destroyFrameBuffers(),t.destroyTextureBuffers(),t._colorBuffer=this._allocateColorBuffer(e,i)}_destroyOffscreenTarget(t){t.destroyTextureBuffers(),t.destroy()}setRenderTargetScale(t){this.renderTargetScale=t,this.resizeRenderTargets()}addEffect(t){const e=this.effects,i=0===e.length,n=this._createOffscreenTarget(i,t.hdr),s=new Yb(t,n);e.push(s),this._sourceTarget=s.inputTarget,e.length>1&&(e[e.length-2].outputTarget=s.inputTarget),this._newPostEffect=t,t.needsDepthBuffer&&this._requestDepthMap(),this.enable(),this._newPostEffect=void 0}removeEffect(t){let e=-1;for(let i=0,n=this.effects.length;i<n;i++)if(this.effects[i].effect===t){e=i;break}e>=0&&(e>0?this.effects[e-1].outputTarget=e+1<this.effects.length?this.effects[e+1].inputTarget:null:this.effects.length>1&&(this.effects[1].inputTarget._depth||(this._destroyOffscreenTarget(this.effects[1].inputTarget),this.effects[1].inputTarget=this._createOffscreenTarget(!0,this.effects[1].hdr),this._sourceTarget=this.effects[1].inputTarget),this.camera.renderTarget=this.effects[1].inputTarget),this._destroyOffscreenTarget(this.effects[e].inputTarget),this.effects.splice(e,1)),this.enabled&&t.needsDepthBuffer&&this._releaseDepthMap(),0===this.effects.length&&this.disable()}_requestDepthMaps(){for(let t=0,e=this.effects.length;t<e;t++){const e=this.effects[t].effect;this._newPostEffect!==e&&(e.needsDepthBuffer&&this._requestDepthMap())}}_releaseDepthMaps(){for(let t=0,e=this.effects.length;t<e;t++){this.effects[t].effect.needsDepthBuffer&&this._releaseDepthMap()}}_requestDepthMap(){Xb||(Xb=this.app.scene.layers.getLayerById(Qt)),Xb&&Xb.incrementCounter()}_releaseDepthMap(){Xb&&Xb.decrementCounter()}destroy(){for(let t=0,e=this.effects.length;t<e;t++)this.effects[t].inputTarget.destroy();this.effects.length=0,this.disable()}enable(){!this.enabled&&this.effects.length&&(this.enabled=!0,this._requestDepthMaps(),this.app.graphicsDevice.on("resizecanvas",this._onCanvasResized,this),this.destinationRenderTarget=this.camera.renderTarget,this.camera.renderTarget=this.effects[0].inputTarget,this.camera.onPostprocessing=t=>{if(this.enabled){let t=null;const e=this.effects.length;if(e)for(let i=0;i<e;i++){const n=this.effects[i];let s=n.outputTarget;i===e-1&&(t=this.camera.rect,this.destinationRenderTarget&&(s=this.destinationRenderTarget)),n.effect.render(n.inputTarget,s,t)}}})}disable(){this.enabled&&(this.enabled=!1,this.app.graphicsDevice.off("resizecanvas",this._onCanvasResized,this),this._releaseDepthMaps(),this._destroyOffscreenTarget(this._sourceTarget),this.camera.renderTarget=null,this.camera.onPostprocessing=null)}_onCanvasResized(t,e){const i=this.camera.rect,n=this.app.graphicsDevice;this.camera.camera.aspectRatio=n.width*i.z/(n.height*i.w),this.resizeTimeout||(H()-this.resizeLast>100?this.resizeRenderTargets():this.resizeTimeout=setTimeout(this._resizeTimeoutCallback,100))}resizeRenderTargets(){this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),this.resizeLast=H();const t=this.camera.rect,e=Math.floor(t.z*this.app.graphicsDevice.width*this.renderTargetScale),i=Math.floor(t.w*this.app.graphicsDevice.height*this.renderTargetScale),n=this.effects;for(let t=0,s=n.length;t<s;t++){const s=n[t];s.inputTarget.width===e&&s.inputTarget.height===i||this._resizeOffscreenTarget(s.inputTarget)}}onCameraRectChanged(t,e,i){this.enabled&&this.resizeRenderTargets()}}const Kb=[{name:"aspectRatio",readonly:!1},{name:"aspectRatioMode",readonly:!1},{name:"calculateProjection",readonly:!1},{name:"calculateTransform",readonly:!1},{name:"clearColor",readonly:!1},{name:"cullFaces",readonly:!1},{name:"farClip",readonly:!1},{name:"flipFaces",readonly:!1},{name:"fov",readonly:!1},{name:"frustum",readonly:!0},{name:"frustumCulling",readonly:!1},{name:"horizontalFov",readonly:!1},{name:"nearClip",readonly:!1},{name:"orthoHeight",readonly:!1},{name:"projection",readonly:!1},{name:"projectionMatrix",readonly:!0},{name:"scissorRect",readonly:!1},{name:"viewMatrix",readonly:!0},{name:"vrDisplay",readonly:!1}];class Zb extends gg{constructor(t,e){super(t,e),this._camera=new ma,this._camera.node=e,this._priority=0,this.onPostprocessing=null,this._disablePostEffectsLayer=te,this._postEffects=new qb(t.app,this)}get camera(){return this._camera}dirtyLayerCompositionCameras(){this.system.app.scene.layers._dirtyCameras=!0}get disablePostEffectsLayer(){return this._disablePostEffectsLayer}set disablePostEffectsLayer(t){this._disablePostEffectsLayer=t,this.dirtyLayerCompositionCameras()}get postEffectsEnabled(){return this._postEffects.enabled}get layers(){return this._camera.layers}set layers(t){const e=this._camera.layers;for(let t=0;t<e.length;t++){const i=this.system.app.scene.layers.getLayerById(e[t]);i&&i.removeCamera(this)}if(this._camera.layers=t,this.enabled&&this.entity.enabled)for(let e=0;e<t.length;e++){const i=this.system.app.scene.layers.getLayerById(t[e]);i&&i.addCamera(this)}}get postEffects(){return this._postEffects}get priority(){return this._priority}set priority(t){this._priority=t,this.dirtyLayerCompositionCameras()}get rect(){return this._camera.rect}set rect(t){this._camera.rect=t,this.fire("set:rect",this._camera.rect)}get clearColorBuffer(){return this._camera.clearColorBuffer}set clearColorBuffer(t){this._camera.clearColorBuffer=t,this.dirtyLayerCompositionCameras()}get clearDepthBuffer(){return this._camera.clearDepthBuffer}set clearDepthBuffer(t){this._camera.clearDepthBuffer=t,this.dirtyLayerCompositionCameras()}get clearStencilBuffer(){return this._camera.clearStencilBuffer}set clearStencilBuffer(t){this._camera.clearStencilBuffer=t,this.dirtyLayerCompositionCameras()}get renderTarget(){return this._camera.renderTarget}set renderTarget(t){this._camera.renderTarget=t,this.dirtyLayerCompositionCameras()}screenToWorld(t,e,i,n){const s=this.system.app.graphicsDevice,r=s.clientRect.width,o=s.clientRect.height;return this._camera.screenToWorld(t,e,i,r,o,n)}worldToScreen(t,e){const i=this.system.app.graphicsDevice,n=i.clientRect.width,s=i.clientRect.height;return this._camera.worldToScreen(t,n,s,e)}onAppPrerender(){this._camera._viewMatDirty=!0,this._camera._viewProjMatDirty=!0}addCameraToLayers(){const t=this.layers;for(let e=0;e<t.length;e++){const i=this.system.app.scene.layers.getLayerById(t[e]);i&&i.addCamera(this)}}removeCameraFromLayers(){const t=this.layers;for(let e=0;e<t.length;e++){const i=this.system.app.scene.layers.getLayerById(t[e]);i&&i.removeCamera(this)}}onLayersChanged(t,e){this.addCameraToLayers(),t.off("add",this.onLayerAdded,this),t.off("remove",this.onLayerRemoved,this),e.on("add",this.onLayerAdded,this),e.on("remove",this.onLayerRemoved,this)}onLayerAdded(t){this.layers.indexOf(t.id)<0||t.addCamera(this)}onLayerRemoved(t){this.layers.indexOf(t.id)<0||t.removeCamera(this)}onEnable(){const t=this.system,e=t.app.scene,i=e.layers;t.addCamera(this),e.on("set:layers",this.onLayersChanged,this),i&&(i.on("add",this.onLayerAdded,this),i.on("remove",this.onLayerRemoved,this)),this.enabled&&this.entity.enabled&&this.addCameraToLayers(),this.postEffects.enable()}onDisable(){const t=this.system,e=t.app.scene,i=e.layers;this.postEffects.disable(),this.removeCameraFromLayers(),e.off("set:layers",this.onLayersChanged,this),i&&(i.off("add",this.onLayerAdded,this),i.off("remove",this.onLayerRemoved,this)),t.removeCamera(this)}onRemove(){this.onDisable(),this.off()}calculateAspectRatio(t){const e=t||this.system.app.graphicsDevice,i=this.rect;return e.width*i.z/(e.height*i.w)}frameBegin(t){this.aspectRatioMode===$i&&(this.aspectRatio=this.calculateAspectRatio(t))}frameEnd(){}enterVr(t,e){if(t instanceof Function&&!e&&(e=t,t=null),this.system.app.vr)if(t||(t=this.system.app.vr.display),t){const i=this;t.capabilities.canPresent?t.requestPresent((function(n){n||(i.vrDisplay=t,i.vrDisplay.once("beforepresentchange",(function(t){t.presenting||(i.vrDisplay=null)}))),e(n)})):(i.vrDisplay=t,e())}else e("No pc.VrDisplay to present");else e("VrManager not created. Enable VR in project settings.")}exitVr(t){if(this.vrDisplay)if(this.vrDisplay.capabilities.canPresent){const e=this.vrDisplay;this.vrDisplay=null,e.exitPresent(t)}else this.vrDisplay=null,t();else t("Not presenting VR")}startXr(t,e,i){this.system.app.xr.start(this,t,e,i)}endXr(t){this._camera.xr?this._camera.xr.end(t):t&&t(new Error("Camera is not in XR"))}copy(t){Kb.forEach(e=>{if(!e.readonly){const i=e.name;this[i]=t[i]}}),this.clearColorBuffer=t.clearColorBuffer,this.clearDepthBuffer=t.clearDepthBuffer,this.clearStencilBuffer=t.clearStencilBuffer,this.disablePostEffectsLayer=t.disablePostEffectsLayer,this.layers=t.layers,this.priority=t.priority,this.renderTarget=t.renderTarget,this.rect=t.rect}}Kb.forEach((function(t){const e=t.name,i={get:function(){return this._camera[e]}};t.readonly||(i.set=function(t){this._camera[e]=t}),Object.defineProperty(Zb.prototype,e,i)}));class Qb{constructor(){this.enabled=!0}}const $b=["enabled"];class Jb extends bg{constructor(t){super(t),this.id="camera",this.ComponentType=Zb,this.DataType=Qb,this.schema=$b,this.cameras=[],this.on("beforeremove",this.onBeforeRemove,this),this.app.on("prerender",this.onAppPrerender,this),this.app.systems.on("update",this.onUpdate,this)}initializeComponentData(t,e,i){i=["aspectRatio","aspectRatioMode","calculateProjection","calculateTransform","clearColor","clearColorBuffer","clearDepthBuffer","clearStencilBuffer","cullFaces","farClip","flipFaces","fov","frustumCulling","horizontalFov","layers","renderTarget","nearClip","orthoHeight","projection","priority","rect","scissorRect"];for(let n=0;n<i.length;n++){const s=i[n];if(e.hasOwnProperty(s)){const i=e[s];switch(s){case"rect":case"scissorRect":Array.isArray(i)?t[s]=new ut(i[0],i[1],i[2],i[3]):t[s]=i;break;case"clearColor":Array.isArray(i)?t[s]=new rt(i[0],i[1],i[2],i[3]):t[s]=i;break;default:t[s]=i}}}super.initializeComponentData(t,e,["enabled"])}cloneComponent(t,e){const i=t.camera;this.addComponent(e,{aspectRatio:i.aspectRatio,aspectRatioMode:i.aspectRatioMode,calculateProjection:i.calculateProjection,calculateTransform:i.calculateTransform,clearColor:i.clearColor,clearColorBuffer:i.clearColorBuffer,clearDepthBuffer:i.clearDepthBuffer,clearStencilBuffer:i.clearStencilBuffer,cullFaces:i.cullFaces,enabled:i.enabled,farClip:i.farClip,flipFaces:i.flipFaces,fov:i.fov,frustumCulling:i.frustumCulling,horizontalFov:i.horizontalFov,layers:i.layers,renderTarget:i.renderTarget,nearClip:i.nearClip,orthoHeight:i.orthoHeight,projection:i.projection,priority:i.priority,rect:i.rect,scissorRect:i.scissorRect})}onBeforeRemove(t,e){this.removeCamera(e)}onUpdate(t){if(this.app.vr){const t=this.store;for(const e in t){const i=t[e];if(i.data.enabled&&i.entity.enabled){const t=i.entity.camera,e=t.vrDisplay;e&&(e.setClipPlanes(t.nearClip,t.farClip),i.entity&&(i.entity.localTransform.copy(e.combinedViewInv),i.entity._dirtyLocal=!1,i.entity._dirtifyWorld()))}}}}onAppPrerender(){for(let t=0,e=this.cameras.length;t<e;t++)this.cameras[t].onAppPrerender()}addCamera(t){this.cameras.push(t),this.sortCamerasByPriority()}removeCamera(t){const e=this.cameras.indexOf(t);e>=0&&(this.cameras.splice(e,1),this.sortCamerasByPriority())}sortCamerasByPriority(){this.cameras.sort((function(t,e){return t.priority-e.priority}))}destroy(){super.destroy(),this.app.systems.off("update",this.onUpdate,this)}}gg._buildAccessors(Zb.prototype,$b);class ty extends gg{constructor(t,e){super(t,e),this._compoundParent=null,this.entity.on("insert",this._onInsert,this),this.on("set_type",this.onSetType,this),this.on("set_halfExtents",this.onSetHalfExtents,this),this.on("set_radius",this.onSetRadius,this),this.on("set_height",this.onSetHeight,this),this.on("set_axis",this.onSetAxis,this),this.on("set_asset",this.onSetAsset,this),this.on("set_renderAsset",this.onSetRenderAsset,this),this.on("set_model",this.onSetModel,this),this.on("set_render",this.onSetRender,this)}onSetType(t,e,i){e!==i&&this.system.changeType(this,e,i)}onSetHalfExtents(t,e,i){const n=this.data.type;this.data.initialized&&"box"===n&&this.system.recreatePhysicalShapes(this)}onSetRadius(t,e,i){const n=this.data.type;!this.data.initialized||"sphere"!==n&&"capsule"!==n&&"cylinder"!==n&&"cone"!==n||this.system.recreatePhysicalShapes(this)}onSetHeight(t,e,i){const n=this.data.type;!this.data.initialized||"capsule"!==n&&"cylinder"!==n&&"cone"!==n||this.system.recreatePhysicalShapes(this)}onSetAxis(t,e,i){const n=this.data.type;!this.data.initialized||"capsule"!==n&&"cylinder"!==n&&"cone"!==n||this.system.recreatePhysicalShapes(this)}onSetAsset(t,e,i){const n=this.system.app.assets;if(e){const t=n.get(e);t&&t.off("remove",this.onAssetRemoved,this)}if(i){i instanceof Od&&(this.data.asset=i.id);const t=n.get(this.data.asset);t&&(t.off("remove",this.onAssetRemoved,this),t.on("remove",this.onAssetRemoved,this))}this.data.initialized&&"mesh"===this.data.type&&(i||(this.data.model=null),this.system.recreatePhysicalShapes(this))}onSetRenderAsset(t,e,i){const n=this.system.app.assets;if(e){const t=n.get(e);t&&t.off("remove",this.onRenderAssetRemoved,this)}if(i){i instanceof Od&&(this.data.renderAsset=i.id);const t=n.get(this.data.renderAsset);t&&(t.off("remove",this.onRenderAssetRemoved,this),t.on("remove",this.onRenderAssetRemoved,this))}this.data.initialized&&"mesh"===this.data.type&&(i||(this.data.render=null),this.system.recreatePhysicalShapes(this))}onSetModel(t,e,i){this.data.initialized&&"mesh"===this.data.type&&this.system.implementations.mesh.doRecreatePhysicalShape(this)}onSetRender(t,e,i){this.onSetModel(t,e,i)}onAssetRemoved(t){t.off("remove",this.onAssetRemoved,this),this.data.asset===t.id&&(this.asset=null)}onRenderAssetRemoved(t){t.off("remove",this.onRenderAssetRemoved,this),this.data.renderAsset===t.id&&(this.renderAsset=null)}_getCompoundChildShapeIndex(t){const e=this.data.shape,i=e.getNumChildShapes();for(let n=0;n<i;n++){if(e.getChildShape(n).ptr===t.ptr)return n}return null}_onInsert(t){if("undefined"!=typeof Ammo)if(this._compoundParent)this.system.recreatePhysicalShapes(this);else if(!this.entity.rigidbody){let t=this.entity.parent;for(;t;){if(t.collision&&"compound"===t.collision.type){0===t.collision.shape.getNumChildShapes()?this.system.recreatePhysicalShapes(t.collision):this.system.recreatePhysicalShapes(this);break}t=t.parent}}}_updateCompound(){const t=this.entity;if(t._dirtyWorld){let e=t._dirtyLocal,i=t;for(;i&&!e&&(!i.collision||i.collision!==this._compoundParent);)i._dirtyLocal&&(e=!0),i=i.parent;if(e){t.forEach(this.system.implementations.compound._updateEachDescendantTransform,t);const e=this._compoundParent.entity.rigidbody;e&&e.activate()}}}onEnable(){if("mesh"===this.data.type&&(this.data.asset||this.data.renderAsset)&&this.data.initialized){const t=this.system.app.assets.get(this.data.asset||this.data.renderAsset);if(t&&(!t.resource||!this.data.shape))return void this.system.recreatePhysicalShapes(this)}if(this.entity.rigidbody)this.entity.rigidbody.enabled&&this.entity.rigidbody.enableSimulation();else if(this._compoundParent&&this!==this._compoundParent)if(0===this._compoundParent.shape.getNumChildShapes())this.system.recreatePhysicalShapes(this._compoundParent);else{const t=this.system._getNodeTransform(this.entity,this._compoundParent.entity);this._compoundParent.shape.addChildShape(t,this.data.shape),Ammo.destroy(t),this._compoundParent.entity.rigidbody&&this._compoundParent.entity.rigidbody.activate()}else this.entity.trigger&&this.entity.trigger.enable()}onDisable(){this.entity.rigidbody?this.entity.rigidbody.disableSimulation():this._compoundParent&&this!==this._compoundParent?this._compoundParent.entity._destroying||(this.system._removeCompoundChild(this._compoundParent,this.data.shape),this._compoundParent.entity.rigidbody&&this._compoundParent.entity.rigidbody.activate()):this.entity.trigger&&this.entity.trigger.disable()}onBeforeRemove(){this.asset&&(this.asset=null),this.renderAsset&&(this.renderAsset=null),this.entity.off("insert",this._onInsert,this),this.off()}}class ey{constructor(){this.enabled=!0,this.type="box",this.halfExtents=new ht(.5,.5,.5),this.radius=.5,this.axis=1,this.height=2,this.asset=null,this.renderAsset=null,this.shape=null,this.model=null,this.render=null,this.initialized=!1}}const iy="static",ny="dynamic",sy="kinematic",ry=1,oy=2,ay=4,ly=1,hy=2,cy=3,_y=4,uy=5,dy=0,py=1,fy=1,my=2,gy=4,by=8,yy=16,vy=32,Sy=64,xy=128,wy=256,Cy=512,Ty=1024,Ay=2048,Ey=4096,My=8192,Ry=16384,Iy=0,Py=65535,Ly=2,Dy=65533,ky=65529;let Oy,Fy,By;class Ny{constructor(t,e,i){this.entity=e.entity,this.component=e,this.app=t,"undefined"==typeof Ammo||Oy||(Oy=new Ammo.btVector3,Fy=new Ammo.btQuaternion,By=new Ammo.btTransform),this.initialize(i)}initialize(t){const e=this.entity,i=t.shape;if(i&&"undefined"!=typeof Ammo){e.trigger&&e.trigger.destroy();const t=1,n=e.getPosition(),s=e.getRotation();Oy.setValue(n.x,n.y,n.z),Fy.setValue(s.x,s.y,s.z,s.w),By.setOrigin(Oy),By.setRotation(Fy);const r=this.app.systems.rigidbody.createBody(t,i,By);r.setRestitution(0),r.setFriction(0),r.setDamping(0,0),Oy.setValue(0,0,0),r.setLinearFactor(Oy),r.setAngularFactor(Oy),r.setCollisionFlags(r.getCollisionFlags()|ay),r.entity=e,this.body=r,this.component.enabled&&e.enabled&&this.enable()}}destroy(){const t=this.body;t&&(this.disable(),this.app.systems.rigidbody.destroyBody(t))}_getEntityTransform(t){const e=this.entity.getPosition(),i=this.entity.getRotation();Oy.setValue(e.x,e.y,e.z),Fy.setValue(i.x,i.y,i.z,i.w),t.setOrigin(Oy),t.setRotation(Fy)}updateTransform(){this._getEntityTransform(By);const t=this.body;t.setWorldTransform(By),t.activate()}enable(){const t=this.body;if(!t)return;const e=this.app.systems;e.rigidbody.addBody(t,yy,Dy^yy),e.rigidbody._triggers.push(this),t.forceActivationState(ly),this.updateTransform()}disable(){const t=this.body;if(!t)return;const e=this.app.systems,i=e.rigidbody._triggers.indexOf(this);i>-1&&e.rigidbody._triggers.splice(i,1),e.rigidbody.removeBody(t),t.forceActivationState(uy)}}const Uy=new bt,Vy=new ht,zy=new yt,Wy=new La,Gy=["enabled","type","halfExtents","radius","axis","height","asset","renderAsset","shape","model","render"];class jy{constructor(t){this.system=t}beforeInitialize(t,e){e.shape=null,e.model=new Uu,e.model.graph=new La}afterInitialize(t,e){this.recreatePhysicalShapes(t),t.data.initialized=!0}reset(t,e){this.beforeInitialize(t,e),this.afterInitialize(t,e)}recreatePhysicalShapes(t){const e=t.entity,i=t.data;if("undefined"!=typeof Ammo){e.trigger&&(e.trigger.destroy(),delete e.trigger),i.shape&&(t._compoundParent&&(this.system._removeCompoundChild(t._compoundParent,i.shape),t._compoundParent.entity.rigidbody&&t._compoundParent.entity.rigidbody.activate()),Ammo.destroy(i.shape),i.shape=null),i.shape=this.createPhysicalShape(t.entity,i);const n=!t._compoundParent;if("compound"!==i.type||t._compoundParent&&t!==t._compoundParent){if("compound"!==i.type&&(t._compoundParent&&t===t._compoundParent&&e.forEach(this.system.implementations.compound._updateEachDescendant,t),!t.rigidbody)){t._compoundParent=null;let i=e.parent;for(;i;){if(i.collision&&"compound"===i.collision.type){t._compoundParent=i.collision;break}i=i.parent}}}else t._compoundParent=t,e.forEach(this._addEachDescendant,t);t._compoundParent&&t!==t._compoundParent&&(n&&0===t._compoundParent.shape.getNumChildShapes()?this.system.recreatePhysicalShapes(t._compoundParent):(this.system.updateCompoundChildTransform(e),t._compoundParent.entity.rigidbody&&t._compoundParent.entity.rigidbody.activate())),e.rigidbody?(e.rigidbody.disableSimulation(),e.rigidbody.createBody(),e.enabled&&e.rigidbody.enabled&&e.rigidbody.enableSimulation()):t._compoundParent||(e.trigger?e.trigger.initialize(i):e.trigger=new Ny(this.system.app,t,i))}}createPhysicalShape(t,e){}updateTransform(t,e,i,n){t.entity.trigger&&t.entity.trigger.updateTransform()}beforeRemove(t,e){e.data.shape&&(e._compoundParent&&!e._compoundParent.entity._destroying&&(this.system._removeCompoundChild(e._compoundParent,e.data.shape),e._compoundParent.entity.rigidbody&&e._compoundParent.entity.rigidbody.activate()),e._compoundParent=null,Ammo.destroy(e.data.shape),e.data.shape=null)}remove(t,e){const i=this.system.app;t.rigidbody&&t.rigidbody.body&&t.rigidbody.disableSimulation(),t.trigger&&(t.trigger.destroy(),delete t.trigger),i.scene.containsModel(e.model)&&(i.root.removeChild(e.model.graph),i.scene.removeModel(e.model))}clone(t,e){const i=this.system.store[t.getGuid()],n={enabled:i.data.enabled,type:i.data.type,halfExtents:[i.data.halfExtents.x,i.data.halfExtents.y,i.data.halfExtents.z],radius:i.data.radius,axis:i.data.axis,height:i.data.height,asset:i.data.asset,renderAsset:i.data.renderAsset,model:i.data.model,render:i.data.render};return this.system.addComponent(e,n)}}class Hy extends jy{createPhysicalShape(t,e){if("undefined"!=typeof Ammo){const t=e.halfExtents,i=new Ammo.btVector3(t?t.x:.5,t?t.y:.5,t?t.z:.5),n=new Ammo.btBoxShape(i);return Ammo.destroy(i),n}}}class Xy extends jy{createPhysicalShape(t,e){if("undefined"!=typeof Ammo)return new Ammo.btSphereShape(e.radius)}}class Yy extends jy{createPhysicalShape(t,e){const i=void 0!==e.axis?e.axis:1,n=e.radius||.5,s=Math.max((e.height||2)-2*n,0);let r=null;if("undefined"!=typeof Ammo)switch(i){case 0:r=new Ammo.btCapsuleShapeX(n,s);break;case 1:r=new Ammo.btCapsuleShape(n,s);break;case 2:r=new Ammo.btCapsuleShapeZ(n,s)}return r}}class qy extends jy{createPhysicalShape(t,e){const i=void 0!==e.axis?e.axis:1,n=void 0!==e.radius?e.radius:.5,s=void 0!==e.height?e.height:1;let r=null,o=null;if("undefined"!=typeof Ammo)switch(i){case 0:r=new Ammo.btVector3(.5*s,n,n),o=new Ammo.btCylinderShapeX(r);break;case 1:r=new Ammo.btVector3(n,.5*s,n),o=new Ammo.btCylinderShape(r);break;case 2:r=new Ammo.btVector3(n,n,.5*s),o=new Ammo.btCylinderShapeZ(r)}return r&&Ammo.destroy(r),o}}class Ky extends jy{createPhysicalShape(t,e){const i=void 0!==e.axis?e.axis:1,n=void 0!==e.radius?e.radius:.5,s=void 0!==e.height?e.height:1;let r=null;if("undefined"!=typeof Ammo)switch(i){case 0:r=new Ammo.btConeShapeX(n,s);break;case 1:r=new Ammo.btConeShape(n,s);break;case 2:r=new Ammo.btConeShapeZ(n,s)}return r}}class Zy extends jy{beforeInitialize(t,e){}createAmmoMesh(t,e,i){let n;if(this.system._triMeshCache[t.id])n=this.system._triMeshCache[t.id];else{const e=t.vertexBuffer,i=e.getFormat();let s,r;for(let t=0;t<i.elements.length;t++){const n=i.elements[t];if(n.name===Zs){r=new Float32Array(e.lock(),n.offset),s=n.stride/4;break}}const o=[];t.getIndices(o);const a=t.primitive[0].count/3,l=new Ammo.btVector3,h=new Ammo.btVector3,c=new Ammo.btVector3;let _,u,d;const p=t.primitive[0].base;n=new Ammo.btTriangleMesh,this.system._triMeshCache[t.id]=n;for(let t=0;t<a;t++)_=o[p+3*t]*s,u=o[p+3*t+1]*s,d=o[p+3*t+2]*s,l.setValue(r[_],r[_+1],r[_+2]),h.setValue(r[u],r[u+1],r[u+2]),c.setValue(r[d],r[d+1],r[d+2]),n.addTriangle(l,h,c,!0);Ammo.destroy(l),Ammo.destroy(h),Ammo.destroy(c)}const s=new Ammo.btBvhTriangleMeshShape(n,!0),r=this.system._getNodeScaling(e);s.setLocalScaling(r),Ammo.destroy(r);const o=this.system._getNodeTransform(e);i.addChildShape(o,s),Ammo.destroy(o)}createPhysicalShape(t,e){if("undefined"!=typeof Ammo&&(e.model||e.render)){const i=new Ammo.btCompoundShape;if(e.model){const t=e.model.meshInstances;for(let e=0;e<t.length;e++)this.createAmmoMesh(t[e].mesh,t[e].node,i)}else if(e.render){const t=e.render.meshes;for(let e=0;e<t.length;e++)this.createAmmoMesh(t[e],Wy,i)}const n=t.getWorldTransform().getScale(),s=new Ammo.btVector3(n.x,n.y,n.z);return i.setLocalScaling(s),Ammo.destroy(s),i}}recreatePhysicalShapes(t){const e=t.data;(e.renderAsset||e.asset)&&t.enabled&&t.entity.enabled?this.loadAsset(t,e.renderAsset||e.asset,e.renderAsset?"render":"model"):this.doRecreatePhysicalShape(t)}loadAsset(t,e,i){const n=t.data,s=this.system.app.assets,r=s.get(e);r?(r.ready(e=>{n[i]=e.resource,this.doRecreatePhysicalShape(t)}),s.load(r)):s.once("add:"+e,e=>{e.ready(e=>{n[i]=e.resource,this.doRecreatePhysicalShape(t)}),s.load(e)})}doRecreatePhysicalShape(t){const e=t.entity,i=t.data;i.model||i.render?(this.destroyShape(i),i.shape=this.createPhysicalShape(e,i),e.rigidbody?(e.rigidbody.disableSimulation(),e.rigidbody.createBody(),e.enabled&&e.rigidbody.enabled&&e.rigidbody.enableSimulation()):e.trigger?e.trigger.initialize(i):e.trigger=new Ny(this.system.app,t,i)):(this.beforeRemove(e,t),this.remove(e,i))}updateTransform(t,e,i,n){if(t.shape){const e=t.entity.getWorldTransform().getScale(),i=t.shape.getLocalScaling();e.x===i.x()&&e.y===i.y()&&e.z===i.z()||this.doRecreatePhysicalShape(t)}super.updateTransform(t,e,i,n)}destroyShape(t){if(!t.shape)return;const e=t.shape.getNumChildShapes();for(let i=0;i<e;i++){const e=t.shape.getChildShape(i);Ammo.destroy(e)}Ammo.destroy(t.shape),t.shape=null}remove(t,e){this.destroyShape(e),super.remove(t,e)}}class Qy extends jy{createPhysicalShape(t,e){if("undefined"!=typeof Ammo)return new Ammo.btCompoundShape}_addEachDescendant(t){t.collision&&!t.rigidbody&&(t.collision._compoundParent=this,t!==this.entity&&t.collision.system.recreatePhysicalShapes(t.collision))}_updateEachDescendant(t){t.collision&&t.collision._compoundParent===this&&(t.collision._compoundParent=null,t===this.entity||t.rigidbody||t.collision.system.recreatePhysicalShapes(t.collision))}_updateEachDescendantTransform(t){t.collision&&t.collision._compoundParent===this.collision._compoundParent&&this.collision.system.updateCompoundChildTransform(t)}}class $y extends bg{constructor(t){super(t),this.id="collision",this.ComponentType=ty,this.DataType=ey,this.schema=Gy,this.implementations={},this._triMeshCache={},this.on("beforeremove",this.onBeforeRemove,this),this.on("remove",this.onRemove,this)}initializeComponentData(t,e,i){const n={};for(let t=0,s=(i=["type","halfExtents","radius","axis","height","shape","model","asset","render","renderAsset","enabled"]).length;t<s;t++){const s=i[t];n[s]=e[s]}let s;e.hasOwnProperty("asset")?(s=i.indexOf("model"),-1!==s&&i.splice(s,1),s=i.indexOf("render"),-1!==s&&i.splice(s,1)):e.hasOwnProperty("model")&&(s=i.indexOf("asset"),-1!==s&&i.splice(s,1)),n.type||(n.type=t.data.type),t.data.type=n.type,n.halfExtents&&Array.isArray(n.halfExtents)&&(n.halfExtents=new ht(n.halfExtents[0],n.halfExtents[1],n.halfExtents[2]));const r=this._createImplementation(n.type);r.beforeInitialize(t,n),super.initializeComponentData(t,n,i),r.afterInitialize(t,n)}_createImplementation(t){if(void 0===this.implementations[t]){let e;switch(t){case"box":e=new Hy(this);break;case"sphere":e=new Xy(this);break;case"capsule":e=new Yy(this);break;case"cylinder":e=new qy(this);break;case"cone":e=new Ky(this);break;case"mesh":e=new Zy(this);break;case"compound":e=new Qy(this)}this.implementations[t]=e}return this.implementations[t]}_getImplementation(t){return this.implementations[t.collision.data.type]}cloneComponent(t,e){return this._getImplementation(t).clone(t,e)}onBeforeRemove(t,e){this.implementations[e.data.type].beforeRemove(t,e),e.onBeforeRemove()}onRemove(t,e){this.implementations[e.type].remove(t,e)}updateCompoundChildTransform(t){if(this._removeCompoundChild(t.collision._compoundParent,t.collision.data.shape),t.enabled&&t.collision.enabled){const e=this._getNodeTransform(t,t.collision._compoundParent.entity);t.collision._compoundParent.shape.addChildShape(e,t.collision.data.shape),Ammo.destroy(e)}}_removeCompoundChild(t,e){if(t.shape.removeChildShape)t.shape.removeChildShape(e);else{const i=t._getCompoundChildShapeIndex(e);null!==i&&t.shape.removeChildShapeByIndex(i)}}onTransformChanged(t,e,i,n){this.implementations[t.data.type].updateTransform(t,e,i,n)}changeType(t,e,i){this.implementations[e].beforeRemove(t.entity,t),this.implementations[e].remove(t.entity,t.data),this._createImplementation(i).reset(t,t.data)}recreatePhysicalShapes(t){this.implementations[t.data.type].recreatePhysicalShapes(t)}_calculateNodeRelativeTransform(t,e){if(t===e){const e=t.getWorldTransform().getScale();Uy.setScale(e.x,e.y,e.z)}else this._calculateNodeRelativeTransform(t.parent,e),Uy.mul(t.getLocalTransform())}_getNodeScaling(t){const e=t.getWorldTransform().getScale();return new Ammo.btVector3(e.x,e.y,e.z)}_getNodeTransform(t,e){let i,n;e?(this._calculateNodeRelativeTransform(t,e),i=Vy,n=zy,Uy.getTranslation(i),n.setFromMat4(Uy)):(i=t.getPosition(),n=t.getRotation());const s=new Ammo.btTransform;s.setIdentity();const r=s.getOrigin();r.setValue(i.x,i.y,i.z);const o=new Ammo.btQuaternion;return o.setValue(n.x,n.y,n.z,n.w),s.setRotation(o),Ammo.destroy(o),Ammo.destroy(r),s}destroy(){for(const t in this._triMeshCache)Ammo.destroy(this._triMeshCache[t]);this._triMeshCache=null,super.destroy()}}gg._buildAccessors(ty.prototype,Gy);class Jy extends x{constructor(){super(),this.list=[]}add(t){const e=t.id;if(this[e])throw new Error(`ComponentSystem name '${e}' already registered or not allowed`);this[e]=t,this.list.push(t)}remove(t){const e=t.id;if(!this[e])throw new Error(`No ComponentSystem named '${e}' registered`);delete this[e];const i=this.list.indexOf(this[e]);-1!==i&&this.list.splice(i,1)}destroy(){this.off();for(let t=0;t<this.list.length;t++)this.list[t].destroy()}}const tv="group",ev="image",iv="text";class nv{constructor(t){this.func=void 0===t.func?ls:t.func,this.ref=t.ref||0,this.readMask=void 0===t.readMask?255:t.readMask,this.writeMask=void 0===t.writeMask?255:t.writeMask,this.fail=t.fail||Rr,this.zfail=t.zfail||Rr,this.zpass=t.zpass||Rr}clone(){return new nv({func:this.func,ref:this.ref,readMask:this.readMask,writeMask:this.writeMask,fail:this.fail,zfail:this.zfail,zpass:this.zpass})}}class sv{constructor(t,e,i){this._entity=t,this._element=t.element,this.model=new Uu,this.node=new La,this.model.graph=this.node,this.mesh=e,this.meshInstance=new Kh(this.mesh,i,this.node),this.meshInstance.name="ImageElement: "+t.name,this.meshInstance.castShadow=!1,this.meshInstance.receiveShadow=!1,this._meshDirty=!1,this.model.meshInstances.push(this.meshInstance),this._entity.addChild(this.model.graph),this.model._entity=this._entity,this.unmaskMeshInstance=null}destroy(){this.setMaterial(null),this._element.removeModelFromLayers(this.model),this.model.destroy(),this.model=null,this.node=null,this.mesh=null,this.meshInstance=null,this._entity=null,this._element=null}setMesh(t){this.meshInstance&&(this.mesh=t,this.meshInstance.mesh=t,this.meshInstance.visible=!!t,this.unmaskMeshInstance&&(this.unmaskMeshInstance.mesh=t),this.forceUpdateAabb())}setMask(t){if(this.meshInstance){if(t){this.unmaskMeshInstance=new Kh(this.mesh,this.meshInstance.material,this.node),this.unmaskMeshInstance.name="Unmask: "+this._entity.name,this.unmaskMeshInstance.castShadow=!1,this.unmaskMeshInstance.receiveShadow=!1,this.unmaskMeshInstance.pick=!1,this.model.meshInstances.push(this.unmaskMeshInstance);for(const t in this.meshInstance.parameters)this.unmaskMeshInstance.setParameter(t,this.meshInstance.parameters[t].data)}else{const t=this.model.meshInstances.indexOf(this.unmaskMeshInstance);t>=0&&this.model.meshInstances.splice(t,1),this.unmaskMeshInstance=null}this._entity.enabled&&this._element.enabled&&(this._element.removeModelFromLayers(this.model),this._element.addModelToLayers(this.model))}}setMaterial(t){this.meshInstance&&(this.meshInstance.material=t,this.unmaskMeshInstance&&(this.unmaskMeshInstance.material=t))}setParameter(t,e){this.meshInstance&&(this.meshInstance.setParameter(t,e),this.unmaskMeshInstance&&this.unmaskMeshInstance.setParameter(t,e))}deleteParameter(t){this.meshInstance&&(this.meshInstance.deleteParameter(t),this.unmaskMeshInstance&&this.unmaskMeshInstance.deleteParameter(t))}setUnmaskDrawOrder(){if(!this.meshInstance)return;if(this.unmaskMeshInstance){const t=function t(e){let i;const n=e.children,s=n.length;if(s){for(let t=0;t<s;t++)n[t].element&&(i=n[t]);if(!i)return null;const e=t(i);return e||i}return null}(this._entity);t&&t.element?this.unmaskMeshInstance.drawOrder=t.element.drawOrder+t.element.getMaskOffset():this.unmaskMeshInstance.drawOrder=this.meshInstance.drawOrder+this._element.getMaskOffset()}}setDrawOrder(t){this.meshInstance&&(this.meshInstance.drawOrder=t)}setCull(t){if(!this.meshInstance)return;const e=this._element;let i=null;t&&e._isScreenCulled()&&(i=function(t){return e.isVisibleForCamera(t)}),this.meshInstance.cull=t,this.meshInstance.isVisibleFunc=i,this.unmaskMeshInstance&&(this.unmaskMeshInstance.cull=t,this.unmaskMeshInstance.isVisibleFunc=i)}setScreenSpace(t){this.meshInstance&&(this.meshInstance.screenSpace=t,this.unmaskMeshInstance&&(this.unmaskMeshInstance.screenSpace=t))}setLayer(t){this.meshInstance&&(this.meshInstance.layer=t,this.unmaskMeshInstance&&(this.unmaskMeshInstance.layer=t))}forceUpdateAabb(t){this.meshInstance&&(this.meshInstance._aabbVer=-1,this.unmaskMeshInstance&&(this.unmaskMeshInstance._aabbVer=-1))}setAabbFunc(t){this.meshInstance&&(this.meshInstance._updateAabbFunc=t,this.unmaskMeshInstance&&(this.unmaskMeshInstance._updateAabbFunc=t))}}class rv{constructor(t){this._element=t,this._entity=t.entity,this._system=t.system,this._textureAsset=null,this._texture=null,this._materialAsset=null,this._material=null,this._spriteAsset=null,this._sprite=null,this._spriteFrame=0,this._pixelsPerUnit=null,this._rect=new ut(0,0,1,1),this._mask=!1,this._maskRef=0,this._outerScale=new _t,this._outerScaleUniform=new Float32Array(2),this._innerOffset=new ut,this._innerOffsetUniform=new Float32Array(4),this._atlasRect=new ut,this._atlasRectUniform=new Float32Array(4),this._defaultMesh=this._createMesh(),this._renderable=new sv(this._entity,this._defaultMesh,this._material),this._color=new rt(1,1,1,1),this._colorUniform=new Float32Array([1,1,1]),this._renderable.setParameter("material_emissive",this._colorUniform),this._renderable.setParameter("material_opacity",1),this._updateAabbFunc=this._updateAabb.bind(this),this._onScreenChange(this._element.screen),this._element.on("resize",this._onParentResizeOrPivotChange,this),this._element.on("set:pivot",this._onParentResizeOrPivotChange,this),this._element.on("screen:set:screenspace",this._onScreenSpaceChange,this),this._element.on("set:screen",this._onScreenChange,this),this._element.on("set:draworder",this._onDrawOrderChange,this),this._element.on("screen:set:resolution",this._onResolutionChange,this)}destroy(){this.textureAsset=null,this.spriteAsset=null,this.materialAsset=null,this._renderable.setMesh(this._defaultMesh),this._renderable.destroy(),this._defaultMesh=null,this._element.off("resize",this._onParentResizeOrPivotChange,this),this._element.off("set:pivot",this._onParentResizeOrPivotChange,this),this._element.off("screen:set:screenspace",this._onScreenSpaceChange,this),this._element.off("set:screen",this._onScreenChange,this),this._element.off("set:draworder",this._onDrawOrderChange,this),this._element.off("screen:set:resolution",this._onResolutionChange,this)}_onResolutionChange(t){}_onParentResizeOrPivotChange(){this._renderable.mesh&&this._updateMesh(this._renderable.mesh)}_onScreenSpaceChange(t){this._updateMaterial(t)}_onScreenChange(t,e){t?this._updateMaterial(t.screen.screenSpace):this._updateMaterial(!1)}_onDrawOrderChange(t){this._renderable.setDrawOrder(t),this.mask&&this._element.screen&&this._element.screen.screen.once("syncdraworder",(function(){this._renderable.setUnmaskDrawOrder()}),this)}_hasUserMaterial(){return!!this._materialAsset||!!this._material&&-1===this._system.defaultImageMaterials.indexOf(this._material)}_use9Slicing(){return this.sprite&&(this.sprite.renderMode===Oi||this.sprite.renderMode===Fi)}_updateMaterial(t){const e=!!this._mask,i=!(!this.sprite||this.sprite.renderMode!==Oi),n=!(!this.sprite||this.sprite.renderMode!==Fi);this._hasUserMaterial()||(this._material=this._system.getImageElementMaterial(t,e,i,n)),this._renderable&&(this._renderable.setCull(!0),this._renderable.setMaterial(this._material),this._renderable.setScreenSpace(t),this._renderable.setLayer(t?Xt:Kt))}_createMesh(){const t=this._element,e=t.calculatedWidth,i=t.calculatedHeight,n=this._rect,s=new ArrayBuffer(128),r=new Float32Array(s);r[5]=1,r[6]=n.x,r[7]=1-n.y,r[8]=e,r[13]=1,r[14]=n.x+n.z,r[15]=1-n.y,r[16]=e,r[17]=i,r[21]=1,r[22]=n.x+n.z,r[23]=1-(n.y+n.w),r[25]=i,r[29]=1,r[30]=n.x,r[31]=1-(n.y+n.w);const o=[{semantic:Zs,components:3,type:no},{semantic:Qs,components:3,type:no},{semantic:nr,components:2,type:no}],a=this._system.app.graphicsDevice,l=new No(a,o),h=new Fo(a,l,4,Ln,s),c=new xh(a);return c.vertexBuffer=h,c.primitive[0].type=Ks,c.primitive[0].base=0,c.primitive[0].count=4,c.primitive[0].indexed=!1,c.aabb.setMinMax(ht.ZERO,new ht(e,i,0)),this._updateMesh(c),c}_updateMesh(t){const e=this._element,i=e.calculatedWidth,n=e.calculatedHeight,s=e._isScreenSpace();if(this._updateMaterial(s),this._renderable&&this._renderable.forceUpdateAabb(),!this.sprite||this.sprite.renderMode!==Oi&&this.sprite.renderMode!==Fi){const s=t.vertexBuffer,r=new Float32Array(s.lock()),o=e.pivot.x,a=e.pivot.y;r[0]=0-o*i,r[1]=0-a*n,r[8]=i-o*i,r[9]=0-a*n,r[16]=i-o*i,r[17]=n-a*n,r[24]=0-o*i,r[25]=n-a*n;let l=1,h=1,c=this._rect;if(this._sprite&&this._sprite.frameKeys[this._spriteFrame]&&this._sprite.atlas){const t=this._sprite.atlas.frames[this._sprite.frameKeys[this._spriteFrame]];t&&(c=t.rect,l=this._sprite.atlas.texture.width,h=this._sprite.atlas.texture.height)}r[6]=c.x/l,r[7]=1-c.y/h,r[14]=(c.x+c.z)/l,r[15]=1-c.y/h,r[22]=(c.x+c.z)/l,r[23]=1-(c.y+c.w)/h,r[30]=c.x/l,r[31]=1-(c.y+c.w)/h,s.unlock();const _=new ht(0-o*i,0-a*n,0),u=new ht(i-o*i,n-a*n,0);t.aabb.setMinMax(_,u),this._renderable&&(this._renderable.node.setLocalScale(1,1,1),this._renderable.node.setLocalPosition(0,0,0),this._renderable.setAabbFunc(null))}else{const t=this._sprite.atlas.frames[this._sprite.frameKeys[this._spriteFrame]],s=2/t.rect.z,r=2/t.rect.w;this._innerOffset.set(t.border.x*s,t.border.y*r,t.border.z*s,t.border.w*r);const o=this.sprite.atlas.texture;this._atlasRect.set(t.rect.x/o.width,t.rect.y/o.height,t.rect.z/o.width,t.rect.w/o.height);const a=null!==this._pixelsPerUnit?this._pixelsPerUnit:this.sprite.pixelsPerUnit,l=t.rect.z/a,h=t.rect.w/a;this._outerScale.set(Math.max(i,this._innerOffset.x*l),Math.max(n,this._innerOffset.y*h));let c=l,_=h;this._outerScale.x/=l,this._outerScale.y/=h,c*=Z.clamp(i/(this._innerOffset.x*l),1e-4,1),_*=Z.clamp(n/(this._innerOffset.y*h),1e-4,1),this._renderable&&(this._innerOffsetUniform[0]=this._innerOffset.x,this._innerOffsetUniform[1]=this._innerOffset.y,this._innerOffsetUniform[2]=this._innerOffset.z,this._innerOffsetUniform[3]=this._innerOffset.w,this._renderable.setParameter("innerOffset",this._innerOffsetUniform),this._atlasRectUniform[0]=this._atlasRect.x,this._atlasRectUniform[1]=this._atlasRect.y,this._atlasRectUniform[2]=this._atlasRect.z,this._atlasRectUniform[3]=this._atlasRect.w,this._renderable.setParameter("atlasRect",this._atlasRectUniform),this._outerScaleUniform[0]=this._outerScale.x,this._outerScaleUniform[1]=this._outerScale.y,this._renderable.setParameter("outerScale",this._outerScaleUniform),this._renderable.setAabbFunc(this._updateAabbFunc),this._renderable.node.setLocalScale(c,_,1),this._renderable.node.setLocalPosition((.5-e.pivot.x)*i,(.5-e.pivot.y)*n,0))}this._meshDirty=!1}_updateSprite(){let t=!1,e=null;this._sprite&&this._sprite.atlas&&(e=this._sprite.meshes[this.spriteFrame],t=this._sprite.renderMode===Oi||this._sprite.renderMode===Fi),this.mesh=t?e:this._defaultMesh,this.mesh&&(this._element._beingInitialized?this._meshDirty=!0:this._updateMesh(this.mesh))}_updateAabb(t){return t.center.set(0,0,0),t.halfExtents.set(.5*this._outerScale.x,.5*this._outerScale.y,.001),t.setFromTransformedAabb(t,this._renderable.node.getWorldTransform()),t}_toggleMask(){this._element._dirtifyMask();const t=this._element._isScreenSpace();this._updateMaterial(t),this._renderable.setMask(!!this._mask)}_onMaterialLoad(t){this.material=t.resource}_onMaterialAdded(t){this._system.app.assets.off("add:"+t.id,this._onMaterialAdded,this),this._materialAsset===t.id&&this._bindMaterialAsset(t)}_bindMaterialAsset(t){this._entity.enabled&&(t.on("load",this._onMaterialLoad,this),t.on("change",this._onMaterialChange,this),t.on("remove",this._onMaterialRemove,this),t.resource?this._onMaterialLoad(t):this._system.app.assets.load(t))}_unbindMaterialAsset(t){t.off("load",this._onMaterialLoad,this),t.off("change",this._onMaterialChange,this),t.off("remove",this._onMaterialRemove,this)}_onMaterialChange(){}_onMaterialRemove(){}_onTextureAdded(t){this._system.app.assets.off("add:"+t.id,this._onTextureAdded,this),this._textureAsset===t.id&&this._bindTextureAsset(t)}_bindTextureAsset(t){this._entity.enabled&&(t.on("load",this._onTextureLoad,this),t.on("change",this._onTextureChange,this),t.on("remove",this._onTextureRemove,this),t.resource?this._onTextureLoad(t):this._system.app.assets.load(t))}_unbindTextureAsset(t){t.off("load",this._onTextureLoad,this),t.off("change",this._onTextureChange,this),t.off("remove",this._onTextureRemove,this)}_onTextureLoad(t){this.texture=t.resource}_onTextureChange(t){}_onTextureRemove(t){}_onSpriteAssetAdded(t){this._system.app.assets.off("add:"+t.id,this._onSpriteAssetAdded,this),this._spriteAsset===t.id&&this._bindSpriteAsset(t)}_bindSpriteAsset(t){this._entity.enabled&&(t.on("load",this._onSpriteAssetLoad,this),t.on("change",this._onSpriteAssetChange,this),t.on("remove",this._onSpriteAssetRemove,this),t.resource?this._onSpriteAssetLoad(t):this._system.app.assets.load(t))}_unbindSpriteAsset(t){t.off("load",this._onSpriteAssetLoad,this),t.off("change",this._onSpriteAssetChange,this),t.off("remove",this._onSpriteAssetRemove,this),t.data.textureAtlasAsset&&this._system.app.assets.off("load:"+t.data.textureAtlasAsset,this._onTextureAtlasLoad,this)}_onSpriteAssetLoad(t){if(t&&t.resource)if(t.resource.atlas)this.sprite=t.resource;else{const e=t.data.textureAtlasAsset;if(e){const t=this._system.app.assets;t.off("load:"+e,this._onTextureAtlasLoad,this),t.once("load:"+e,this._onTextureAtlasLoad,this)}}else this.sprite=null}_onSpriteAssetChange(t){this._onSpriteAssetLoad(t)}_onSpriteAssetRemove(t){}_bindSprite(t){t.on("set:meshes",this._onSpriteMeshesChange,this),t.on("set:pixelsPerUnit",this._onSpritePpuChange,this),t.on("set:atlas",this._onAtlasTextureChange,this),t.atlas&&t.atlas.on("set:texture",this._onAtlasTextureChange,this)}_unbindSprite(t){t.off("set:meshes",this._onSpriteMeshesChange,this),t.off("set:pixelsPerUnit",this._onSpritePpuChange,this),t.off("set:atlas",this._onAtlasTextureChange,this),t.atlas&&t.atlas.off("set:texture",this._onAtlasTextureChange,this)}_onSpriteMeshesChange(){this._sprite&&(this._spriteFrame=Z.clamp(this._spriteFrame,0,this._sprite.frameKeys.length-1)),this._updateSprite()}_onSpritePpuChange(){this.sprite.renderMode!==ki&&null===this._pixelsPerUnit&&this._updateSprite()}_onAtlasTextureChange(){this.sprite&&this.sprite.atlas&&this.sprite.atlas.texture?(this._renderable.setParameter("texture_emissiveMap",this._sprite.atlas.texture),this._renderable.setParameter("texture_opacityMap",this._sprite.atlas.texture)):(this._renderable.deleteParameter("texture_emissiveMap"),this._renderable.deleteParameter("texture_opacityMap"))}_onTextureAtlasLoad(t){const e=this._spriteAsset;e instanceof Od?this._onSpriteAssetLoad(e):this._onSpriteAssetLoad(this._system.app.assets.get(e))}onEnable(){if(this._materialAsset){const t=this._system.app.assets.get(this._materialAsset);t&&t.resource!==this._material&&this._bindMaterialAsset(t)}if(this._textureAsset){const t=this._system.app.assets.get(this._textureAsset);t&&t.resource!==this._texture&&this._bindTextureAsset(t)}if(this._spriteAsset){const t=this._system.app.assets.get(this._spriteAsset);t&&t.resource!==this._sprite&&this._bindSpriteAsset(t)}this._element.addModelToLayers(this._renderable.model)}onDisable(){this._element.removeModelFromLayers(this._renderable.model)}_setStencil(t){this._renderable.meshInstance.stencilFront=t,this._renderable.meshInstance.stencilBack=t;let e=0;if(this._element.maskedBy&&(e=this._element.maskedBy.element._image._maskRef),this._renderable.unmaskMeshInstance){const t=new nv({ref:e+1,func:ns,zpass:kr});this._renderable.unmaskMeshInstance.stencilFront=t,this._renderable.unmaskMeshInstance.stencilBack=t}}get color(){return this._color}set color(t){const e=t.r,i=t.g,n=t.b;this._color.r===e&&this._color.g===i&&this._color.b===n||(this._color.r=e,this._color.g=i,this._color.b=n,this._colorUniform[0]=e,this._colorUniform[1]=i,this._colorUniform[2]=n,this._renderable.setParameter("material_emissive",this._colorUniform),this._element&&this._element.fire("set:color",this._color))}get opacity(){return this._color.a}set opacity(t){t!==this._color.a&&(this._color.a=t,this._renderable.setParameter("material_opacity",t),this._element&&this._element.fire("set:opacity",t))}get rect(){return this._rect}set rect(t){let e,i,n,s;t instanceof ut?(e=t.x,i=t.y,n=t.z,s=t.w):(e=t[0],i=t[1],n=t[2],s=t[3]),e===this._rect.x&&i===this._rect.y&&n===this._rect.z&&s===this._rect.w||(this._rect.set(e,i,n,s),this._renderable.mesh&&(this._element._beingInitialized?this._meshDirty=!0:this._updateMesh(this._renderable.mesh)))}get material(){return this._material}set material(t){if(this._material!==t){if(!t){const e=this._element._isScreenSpace();t=this.mask?e?this._system.defaultScreenSpaceImageMaskMaterial:this._system.defaultImageMaskMaterial:e?this._system.defaultScreenSpaceImageMaterial:this._system.defaultImageMaterial}this._material=t,t&&(this._renderable.setMaterial(t),this._hasUserMaterial()?(this._renderable.deleteParameter("material_opacity"),this._renderable.deleteParameter("material_emissive")):(this._colorUniform[0]=this._color.r,this._colorUniform[1]=this._color.g,this._colorUniform[2]=this._color.b,this._renderable.setParameter("material_emissive",this._colorUniform),this._renderable.setParameter("material_opacity",this._color.a)))}}get materialAsset(){return this._materialAsset}set materialAsset(t){const e=this._system.app.assets;let i=t;if(t instanceof Od&&(i=t.id),this._materialAsset!==i){if(this._materialAsset){e.off("add:"+this._materialAsset,this._onMaterialAdded,this);const t=e.get(this._materialAsset);t&&(t.off("load",this._onMaterialLoad,this),t.off("change",this._onMaterialChange,this),t.off("remove",this._onMaterialRemove,this))}if(this._materialAsset=i,this._materialAsset){const t=e.get(this._materialAsset);t?this._bindMaterialAsset(t):(this.material=null,e.on("add:"+this._materialAsset,this._onMaterialAdded,this))}else this.material=null}}get texture(){return this._texture}set texture(t){if(this._texture!==t){if(this._textureAsset){const e=this._system.app.assets.get(this._textureAsset);e&&e.resource!==t&&(this.textureAsset=null)}this._texture=t,t?(this._spriteAsset&&(this.spriteAsset=null),this._renderable.setParameter("texture_emissiveMap",this._texture),this._renderable.setParameter("texture_opacityMap",this._texture),this._colorUniform[0]=this._color.r,this._colorUniform[1]=this._color.g,this._colorUniform[2]=this._color.b,this._renderable.setParameter("material_emissive",this._colorUniform),this._renderable.setParameter("material_opacity",this._color.a)):(this._renderable.deleteParameter("texture_emissiveMap"),this._renderable.deleteParameter("texture_opacityMap"))}}get textureAsset(){return this._textureAsset}set textureAsset(t){const e=this._system.app.assets;let i=t;if(t instanceof Od&&(i=t.id),this._textureAsset!==i){if(this._textureAsset){e.off("add:"+this._textureAsset,this._onTextureAdded,this);const t=e.get(this._textureAsset);t&&(t.off("load",this._onTextureLoad,this),t.off("change",this._onTextureChange,this),t.off("remove",this._onTextureRemove,this))}if(this._textureAsset=i,this._textureAsset){const t=e.get(this._textureAsset);t?this._bindTextureAsset(t):(this.texture=null,e.on("add:"+this._textureAsset,this._onTextureAdded,this))}else this.texture=null}}get spriteAsset(){return this._spriteAsset}set spriteAsset(t){const e=this._system.app.assets;let i=t;if(t instanceof Od&&(i=t.id),this._spriteAsset!==i){if(this._spriteAsset){e.off("add:"+this._spriteAsset,this._onSpriteAssetAdded,this);const t=e.get(this._spriteAsset);t&&this._unbindSpriteAsset(t)}if(this._spriteAsset=i,this._spriteAsset){const t=e.get(this._spriteAsset);t?this._bindSpriteAsset(t):(this.sprite=null,e.on("add:"+this._spriteAsset,this._onSpriteAssetAdded,this))}else this.sprite=null;this._element&&this._element.fire("set:spriteAsset",i)}}get sprite(){return this._sprite}set sprite(t){if(this._sprite!==t){if(this._sprite&&this._unbindSprite(this._sprite),this._spriteAsset){const e=this._system.app.assets.get(this._spriteAsset);e&&e.resource!==t&&(this.spriteAsset=null)}this._sprite=t,this._sprite&&(this._bindSprite(this._sprite),this._textureAsset&&(this.textureAsset=null)),this._sprite&&this._sprite.atlas&&this._sprite.atlas.texture?(this._renderable.setParameter("texture_emissiveMap",this._sprite.atlas.texture),this._renderable.setParameter("texture_opacityMap",this._sprite.atlas.texture)):(this._renderable.deleteParameter("texture_emissiveMap"),this._renderable.deleteParameter("texture_opacityMap")),this._sprite&&(this._spriteFrame=Z.clamp(this._spriteFrame,0,this._sprite.frameKeys.length-1)),this._updateSprite()}}get spriteFrame(){return this._spriteFrame}set spriteFrame(t){const e=this._spriteFrame;this._sprite?this._spriteFrame=Z.clamp(t,0,this._sprite.frameKeys.length-1):this._spriteFrame=t,this._spriteFrame!==e&&(this._updateSprite(),this._element&&this._element.fire("set:spriteFrame",t))}get mesh(){return this._renderable.mesh}set mesh(t){this._renderable.setMesh(t),this._defaultMesh===t?this._renderable.setAabbFunc(null):this._renderable.setAabbFunc(this._updateAabbFunc)}get mask(){return this._mask}set mask(t){this._mask!==t&&(this._mask=t,this._toggleMask())}get pixelsPerUnit(){return this._pixelsPerUnit}set pixelsPerUnit(t){this._pixelsPerUnit!==t&&(this._pixelsPerUnit=t,!this._sprite||this._sprite.renderMode!==Oi&&this._sprite.renderMode!==Fi||this._updateSprite())}get aabb(){return this._renderable.meshInstance?this._renderable.meshInstance.aabb:null}}class ov extends x{constructor(t){super(),this._app=t,t.i18n.on("set:locale",this._onSetLocale,this),this._autoLoad=!1,this._disableLocalization=!1,this._defaultAsset=null,this._localizedAsset=null}_bindDefaultAsset(){var t=this._app.assets.get(this._defaultAsset);t?this._onDefaultAssetAdd(t):this._app.assets.once("add:"+this._defaultAsset,this._onDefaultAssetAdd,this)}_unbindDefaultAsset(){if(this._defaultAsset){this._app.assets.off("add:"+this._defaultAsset,this._onDefaultAssetAdd,this);var t=this._app.assets.get(this._defaultAsset);t&&(t.off("add:localized",this._onLocaleAdd,this),t.off("remove:localized",this._onLocaleRemove,this),t.off("remove",this._onDefaultAssetRemove,this))}}_onDefaultAssetAdd(t){this._defaultAsset===t.id&&(t.on("add:localized",this._onLocaleAdd,this),t.on("remove:localized",this._onLocaleRemove,this),t.once("remove",this._onDefaultAssetRemove,this))}_onDefaultAssetRemove(t){this._defaultAsset===t.id&&(t.off("add:localized",this._onLocaleAdd,this),t.off("remove:localized",this._onLocaleAdd,this),this._app.assets.once("add:"+this._defaultAsset,this._onDefaultAssetAdd,this))}_bindLocalizedAsset(){if(this._autoLoad){var t=this._app.assets.get(this._localizedAsset);t&&(t.on("load",this._onLocalizedAssetLoad,this),t.on("change",this._onLocalizedAssetChange,this),t.on("remove",this._onLocalizedAssetRemove,this),t.resource?this._onLocalizedAssetLoad(t):this._app.assets.load(t))}}_unbindLocalizedAsset(){var t=this._app.assets.get(this._localizedAsset);t&&(t.off("load",this._onLocalizedAssetLoad,this),t.off("change",this._onLocalizedAssetChange,this),t.off("remove",this._onLocalizedAssetRemove,this))}_onLocalizedAssetAdd(t){this._localizedAsset===t.id&&this._bindLocalizedAsset()}_onLocalizedAssetLoad(t){this.fire("load",t)}_onLocalizedAssetChange(t,e,i,n){this.fire("change",t,e,i,n)}_onLocalizedAssetRemove(t){this._localizedAsset===t.id&&(this.localizedAsset=this._defaultAsset),this.fire("remove",t)}_onLocaleAdd(t,e){this._app.i18n.locale===t&&this._onSetLocale(t)}_onLocaleRemove(t,e){this._app.i18n.locale===t&&this._onSetLocale(t)}_onSetLocale(t){if(this._defaultAsset){var e=this._app.assets.get(this._defaultAsset);if(e&&!this._disableLocalization){var i=e.getLocalizedAssetId(t);this.localizedAsset=i||this._defaultAsset}else this.localizedAsset=this._defaultAsset}else this.localizedAsset=null}destroy(){this.defaultAsset=null,this._app.i18n.off("set:locale",this._onSetLocale,this),this.off()}get defaultAsset(){return this._defaultAsset}set defaultAsset(t){var e=t instanceof Od?t.id:t;this._defaultAsset!==e&&(this._defaultAsset&&this._unbindDefaultAsset(),this._defaultAsset=e,this._defaultAsset&&this._bindDefaultAsset(),this._onSetLocale(this._app.i18n.locale))}get localizedAsset(){return this._localizedAsset}set localizedAsset(t){var e=t instanceof Od?t.id:t;this._localizedAsset!==e&&(this._localizedAsset&&(this._app.assets.off("add:"+this._localizedAsset,this._onLocalizedAssetAdd,this),this._unbindLocalizedAsset(),this._localizedAsset=null),this._localizedAsset=e,this._localizedAsset&&(this._app.assets.get(this._localizedAsset)?this._bindLocalizedAsset():this._app.assets.once("add:"+this._localizedAsset,this._onLocalizedAssetAdd,this)))}get autoLoad(){return this._autoLoad}set autoLoad(t){this._autoLoad!==t&&(this._autoLoad=t,this._autoLoad&&this._localizedAsset&&(this._unbindLocalizedAsset(),this._bindLocalizedAsset()))}get disableLocalization(){return this._disableLocalization}set disableLocalization(t){this._disableLocalization!==t&&(this._disableLocalization=t,this._onSetLocale(this._app.i18n.locale))}}const av=/[A-Z|a-z|0-9|_|-|/]/;class lv{constructor(t){this._symbols=t,this._index=0,this._last=0,this._cur=this._symbols.length>0?this._symbols[0]:null,this._buf=[],this._mode="text",this._error=null}read(){let t=this._read();for(;8===t;)t=this._read();return 0!==t&&1!==t&&(this._last=this._index),t}buf(){return this._buf}last(){return this._last}error(){return this._error}debugPrint(){const t=["EOF","ERROR","TEXT","OPEN_BRACKET","CLOSE_BRACKET","EQUALS","STRING","IDENTIFIER","WHITESPACE"];let e=this.read(),i="";for(;i+=(i.length>0?"\n":"")+t[e]+" '"+this.buf().join("")+"'",0!==e&&1!==e;)e=this.read();return i}_read(){return this._buf=[],this._eof()?0:"text"===this._mode?this._text():this._tag()}_text(){for(;;)switch(this._cur){case null:return this._buf.length>0?2:0;case"[":return this._mode="tag",this._buf.length>0?2:this._tag();case"\\":switch(this._next(),this._cur){case"[":this._store();break;default:this._output("\\")}break;default:this._store()}}_tag(){for(;;)switch(this._cur){case null:return this._error="unexpected end of input reading tag",1;case"[":return this._store(),3;case"]":return this._store(),this._mode="text",4;case"=":return this._store(),5;case" ":case"\t":case"\n":case"\r":case"\v":case"\f":return this._whitespace();case'"':return this._string();default:return this._isIdentifierSymbol(this._cur)?this._identifier():(this._error="unrecognized character",1)}}_whitespace(){for(this._store();-1!==" \t\n\r\v\f".indexOf(this._cur);)this._store();return 8}_string(){for(this._next();;)switch(this._cur){case null:return this._error="unexpected end of input reading string",1;case'"':return this._next(),6;default:this._store()}}_identifier(){for(this._store();null!==this._cur&&this._isIdentifierSymbol(this._cur);)this._store();return 7}_isIdentifierSymbol(t){return 1===t.length&&null!==t.match(av)}_eof(){return null===this._cur}_next(){return this._eof()||(this._index++,this._cur=this._index<this._symbols.length?this._symbols[this._index]:null),this._cur}_store(){return this._buf.push(this._cur),this._next()}_output(t){this._buf.push(t)}}class hv{constructor(t){this._scanner=new lv(t),this._error=null}parse(t,e){for(;;){switch(this._scanner.read()){case 0:return!0;case 1:return!1;case 2:Array.prototype.push.apply(t,this._scanner.buf());break;case 3:if(!this._parseTag(t,e))return!1;break;default:return!1}}}error(){return"Error evaluating markup at #"+this._scanner.last().toString()+" ("+(this._scanner.error()||this._error)+")"}_parseTag(t,e){let i=this._scanner.read();if(7!==i)return this._error="expected identifier",!1;const n=this._scanner.buf().join("");if("/"===n[0]){for(let s=e.length-1;s>=0;--s)if(n==="/"+e[s].name&&null===e[s].end)return e[s].end=t.length,i=this._scanner.read(),4===i||(this._error="expected close bracket",!1);return this._error="failed to find matching tag",!1}const s={name:n,value:null,attributes:{},start:t.length,end:null};if(i=this._scanner.read(),5===i){if(i=this._scanner.read(),6!==i)return this._error="expected string",!1;s.value=this._scanner.buf().join(""),i=this._scanner.read()}for(;;){switch(i){case 4:return e.push(s),!0;case 7:{const t=this._scanner.buf().join("");if(i=this._scanner.read(),5!==i)return this._error="expected equals",!1;if(i=this._scanner.read(),6!==i)return this._error="expected string",!1;const e=this._scanner.buf().join("");s.attributes[t]=e;break}default:return this._error="expected close bracket or identifier",!1}i=this._scanner.read()}}}function cv(t,e){for(const i in e){if(!e.hasOwnProperty(i))continue;const n=e[i];n instanceof Object?(t.hasOwnProperty(i)||(t[i]={}),cv(t[i],e[i])):t[i]=n}}function _v(t){if(0===t.length)return null;const e={};for(let i=0;i<t.length;++i){const n=t[i],s={};s[n.name]={value:n.value,attributes:n.attributes},cv(e,s)}return e}function uv(t){const e=new hv(t),i=[],n=[];if(!e.parse(i,n))return console.warn(e.error()),{symbols:t,tags:null};const s=n.find((function(t){return null===t.end}));if(s)return console.warn("Markup error: found unclosed tag='"+s.name+"'"),{symbols:t,tags:null};return{symbols:i,tags:function(t,e){if(0===t.length)return null;const i={};for(let e=0;e<t.length;++e){const n=t[e];i.hasOwnProperty(n.start)?null===i[n.start].open?i[n.start].open=[n]:i[n.start].open.push(n):i[n.start]={open:[n],close:null},i.hasOwnProperty(n.end)?null===i[n.end].close?i[n.end].close=[n]:i[n.end].close.push(n):i[n.end]={open:null,close:[n]}}let n=[];function s(t){n=n.filter((function(e){return void 0===t.find((function(t){return t===e}))}))}function r(t){for(let e=0;e<t.length;++e)n.push(t[e])}const o=Object.keys(i).sort((function(t,e){return t-e})),a=[];for(let t=0;t<o.length;++t){const e=i[o[t]];null!==e.close&&s(e.close),null!==e.open&&r(e.open),a.push({start:o[t],tags:_v(n)})}const l=[];let h=null;for(let t=0;t<a.length;++t){const e=a[t];for(;l.length<e.start;)l.push(h?h.tags:null);h=e}for(;l.length<e;)l.push(null);return l}(n,i.length)}}class dv{constructor(){this.count=0,this.quad=0,this.lines={},this.positions=[],this.normals=[],this.uvs=[],this.colors=[],this.indices=[],this.meshInstance=null}}const pv=/^[\r\n]$/,fv=/^[ \t]$/,mv=/^[ \t\-]|[\u200b]$/,gv=/^[a-z0-9]$/i,bv=/^[\u1100-\u11ff]|[\u3000-\u9fff]|[\ua960-\ua97f]|[\uac00-\ud7ff]$/,yv=/^[〕〉》」』】〙〗〟ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻]$/,vv=["​","؜","‎","‏","‪","‫","‬","‭","‮","⁦","⁧","⁨","⁩"],Sv={width:0,height:0,xadvance:0,xoffset:0,yoffset:0};class xv{constructor(t){this._element=t,this._system=t.system,this._entity=t.entity,this._text="",this._symbols=[],this._colorPalette=[],this._symbolColors=null,this._i18nKey=null,this._fontAsset=new ov(this._system.app),this._fontAsset.disableLocalization=!0,this._fontAsset.on("load",this._onFontLoad,this),this._fontAsset.on("change",this._onFontChange,this),this._fontAsset.on("remove",this._onFontRemove,this),this._font=null,this._color=new rt(1,1,1,1),this._colorUniform=new Float32Array(3),this._spacing=1,this._fontSize=32,this._fontMinY=0,this._fontMaxY=0,this._originalFontSize=32,this._maxFontSize=32,this._minFontSize=8,this._autoFitWidth=!1,this._autoFitHeight=!1,this._maxLines=-1,this._lineHeight=32,this._scaledLineHeight=32,this._wrapLines=!1,this._drawOrder=0,this._alignment=new _t(.5,.5),this._autoWidth=!0,this._autoHeight=!0,this.width=0,this.height=0,this._node=new La,this._model=new Uu,this._model.graph=this._node,this._entity.addChild(this._node),this._meshInfo=[],this._material=null,this._aabbDirty=!0,this._aabb=new Tt,this._noResize=!1,this._currentMaterialType=null,this._maskedMaterialSrc=null,this._rtlReorder=!1,this._unicodeConverter=!1,this._rtl=!1,this._outlineColor=new rt(0,0,0,1),this._outlineColorUniform=new Float32Array(4),this._outlineThicknessScale=.2,this._outlineThickness=0,this._shadowColor=new rt(0,0,0,1),this._shadowColorUniform=new Float32Array(4),this._shadowOffsetScale=.005,this._shadowOffset=new _t(0,0),this._shadowOffsetUniform=new Float32Array(2),this._enableMarkup=!1,this._onScreenChange(this._element.screen),t.on("resize",this._onParentResize,this),t.on("set:screen",this._onScreenChange,this),t.on("screen:set:screenspace",this._onScreenSpaceChange,this),t.on("set:draworder",this._onDrawOrderChange,this),t.on("set:pivot",this._onPivotChange,this),this._system.app.i18n.on("set:locale",this._onLocaleSet,this),this._system.app.i18n.on("data:add",this._onLocalizationData,this),this._system.app.i18n.on("data:remove",this._onLocalizationData,this),this._rangeStart=0,this._rangeEnd=0}destroy(){this._setMaterial(null),this._model&&(this._element.removeModelFromLayers(this._model),this._model.destroy(),this._model=null),this._fontAsset.destroy(),this.font=null,this._element.off("resize",this._onParentResize,this),this._element.off("set:screen",this._onScreenChange,this),this._element.off("screen:set:screenspace",this._onScreenSpaceChange,this),this._element.off("set:draworder",this._onDrawOrderChange,this),this._element.off("set:pivot",this._onPivotChange,this),this._system.app.i18n.off("set:locale",this._onLocaleSet,this),this._system.app.i18n.off("data:add",this._onLocalizationData,this),this._system.app.i18n.off("data:remove",this._onLocalizationData,this)}_onParentResize(t,e){this._noResize||this._font&&this._updateText()}_onScreenChange(t){t?this._updateMaterial(t.screen.screenSpace):this._updateMaterial(!1)}_onScreenSpaceChange(t){this._updateMaterial(t)}_onDrawOrderChange(t){if(this._drawOrder=t,this._model)for(let e=0,i=this._model.meshInstances.length;e<i;e++)this._model.meshInstances[e].drawOrder=t}_onPivotChange(t){this._font&&this._updateText()}_onLocaleSet(t){if(this._i18nKey){if(this.fontAsset){const t=this._system.app.assets.get(this.fontAsset);t&&t.resource&&t.resource===this._font||(this.font=null)}this._resetLocalizedText()}}_onLocalizationData(t,e){this._i18nKey&&e[this._i18nKey]&&this._resetLocalizedText()}_resetLocalizedText(){this._setText(this._system.app.i18n.getText(this._i18nKey))}_setText(t){if(this.unicodeConverter){const e=this._system.getUnicodeConverter();e?t=e(t):console.warn("Element created with unicodeConverter option but no unicodeConverter function registered")}this._text!==t&&(this._font&&this._updateText(t),this._text=t)}_updateText(t){let e;if(void 0===t&&(t=this._text),this._symbols=z.getSymbols(t.normalize?t.normalize("NFC"):t),0===this._symbols.length&&(this._symbols=[" "]),this._enableMarkup){const t=class{static evaluate(t){return uv(t)}}.evaluate(this._symbols);this._symbols=t.symbols,e=t.tags}if(this._rtlReorder){const t=this._system.app.systems.element.getRtlReorder();if(t){const i=t(this._symbols);this._rtl=i.rtl,this._symbols=i.mapping.map((function(t){return this._symbols[t]}),this),e&&(e=i.mapping.map((function(t){return e[t]})))}else console.warn("Element created with rtlReorder option but no rtlReorder function registered")}else this._rtl=!1;if(e){const t={};this._colorPalette=[Math.round(255*this._color.r),Math.round(255*this._color.g),Math.round(255*this._color.b)],this._symbolColors=[],t[this._color.toString(!1).toLowerCase()]=0;for(let i=0,n=this._symbols.length;i<n;++i){const n=e[i];let s=0;if(n&&n.color&&n.color.value){const e=n.color.value;if(7===e.length&&"#"===e[0]){const i=e.substring(1).toLowerCase();t.hasOwnProperty(i)?s=t[i]:/^([0-9a-f]{2}){3}$/.test(i)&&(s=this._colorPalette.length/3,t[i]=s,this._colorPalette.push(parseInt(i.substring(0,2),16)),this._colorPalette.push(parseInt(i.substring(2,4),16)),this._colorPalette.push(parseInt(i.substring(4,6),16)))}}this._symbolColors.push(s)}}else this._colorPalette=[],this._symbolColors=null;const i=this._calculateCharsPerTexture();let n=!1;const s=this._element,r=s._isScreenSpace(),o=s._isScreenCulled(),a=function(t){return s.isVisibleForCamera(t)};for(let t=0,e=this._meshInfo.length;t<e;t++){const e=i[t]||0,l=this._meshInfo[t];if(l.count!==e){if(n||(s.removeModelFromLayers(this._model),n=!0),l.count=e,l.positions.length=l.normals.length=3*e*4,l.indices.length=3*e*2,l.uvs.length=2*e*4,l.colors.length=4*e*4,l.meshInstance&&this._removeMeshInstance(l.meshInstance),0===e){l.meshInstance=null;continue}for(let t=0;t<e;t++)l.indices[3*t*2+0]=4*t,l.indices[3*t*2+1]=4*t+1,l.indices[3*t*2+2]=4*t+3,l.indices[3*t*2+3]=4*t+2,l.indices[3*t*2+4]=4*t+3,l.indices[3*t*2+5]=4*t+1,l.normals[4*t*3+0]=0,l.normals[4*t*3+1]=0,l.normals[4*t*3+2]=-1,l.normals[4*t*3+3]=0,l.normals[4*t*3+4]=0,l.normals[4*t*3+5]=-1,l.normals[4*t*3+6]=0,l.normals[4*t*3+7]=0,l.normals[4*t*3+8]=-1,l.normals[4*t*3+9]=0,l.normals[4*t*3+10]=0,l.normals[4*t*3+11]=-1;const i=Ah(this._system.app.graphicsDevice,l.positions,{uvs:l.uvs,normals:l.normals,colors:l.colors,indices:l.indices}),h=new Kh(i,this._material,this._node);h.name="Text Element: "+this._entity.name,h.castShadow=!1,h.receiveShadow=!1,h.cull=!r,h.screenSpace=r,h.drawOrder=this._drawOrder,o&&(h.cull=!0,h.isVisibleFunc=a),this._setTextureParams(h,this._font.textures[t]),this._symbolColors?(this._colorUniform[0]=1,this._colorUniform[1]=1,this._colorUniform[2]=1):(this._colorUniform[0]=this._color.r,this._colorUniform[1]=this._color.g,this._colorUniform[2]=this._color.b),h.setParameter("material_emissive",this._colorUniform),h.setParameter("material_opacity",this._color.a),h.setParameter("font_sdfIntensity",this._font.intensity),h.setParameter("font_pxrange",this._getPxRange(this._font)),h.setParameter("font_textureWidth",this._font.data.info.maps[t].width),this._outlineColorUniform[0]=this._outlineColor.r,this._outlineColorUniform[1]=this._outlineColor.g,this._outlineColorUniform[2]=this._outlineColor.b,this._outlineColorUniform[3]=this._outlineColor.a,h.setParameter("outline_color",this._outlineColorUniform),h.setParameter("outline_thickness",this._outlineThicknessScale*this._outlineThickness),this._shadowColorUniform[0]=this._shadowColor.r,this._shadowColorUniform[1]=this._shadowColor.g,this._shadowColorUniform[2]=this._shadowColor.b,this._shadowColorUniform[3]=this._shadowColor.a,h.setParameter("shadow_color",this._shadowColorUniform);const c=-this._font.data.info.maps[t].width/this._font.data.info.maps[t].height;this._shadowOffsetUniform[0]=this._shadowOffsetScale*this._shadowOffset.x,this._shadowOffsetUniform[1]=c*this._shadowOffsetScale*this._shadowOffset.y,h.setParameter("shadow_offset",this._shadowOffsetUniform),l.meshInstance=h,this._model.meshInstances.push(h)}}this._element.maskedBy&&this._element._setMaskedBy(this._element.maskedBy),n&&this._element.enabled&&this._entity.enabled&&this._element.addModelToLayers(this._model),this._updateMeshes(),this._rangeStart=0,this._rangeEnd=this._symbols.length,this._updateRenderRange()}_removeMeshInstance(t){t.material=null;const e=t.mesh;e&&e.destroy();const i=this._model.meshInstances.indexOf(t);-1!==i&&this._model.meshInstances.splice(i,1)}_setMaterial(t){if(this._material=t,this._model)for(let e=0,i=this._model.meshInstances.length;e<i;e++){this._model.meshInstances[e].material=t}}_updateMaterial(t){const e=this._element,i=e._isScreenCulled(),n=function(t){return e.isVisibleForCamera(t)},s=this._font&&this._font.type===Op;if(this._material=this._system.getTextElementMaterial(t,s),this._model)for(let e=0,s=this._model.meshInstances.length;e<s;e++){const s=this._model.meshInstances[e];s.cull=!t,s.material=this._material,s.screenSpace=t,i?(s.cull=!0,s.isVisibleFunc=n):s.isVisibleFunc=null}}_isWordBoundary(t){return mv.test(t)}_isValidNextChar(t){return null!==t&&!yv.test(t)}_isNextCJKBoundary(t,e){return bv.test(t)&&(mv.test(e)||gv.test(e))}_isNextCJKWholeWord(t){return bv.test(t)}_updateMeshes(){const t=this._font.data,e=this,i=Math.min(this._minFontSize,this._maxFontSize),n=this._maxFontSize,s=this._shouldAutoFit();s&&(this._fontSize=this._maxFontSize);const r=this._symbols.length;let o=0,a=0,l=0,h=0,c=1,_=0,u=0,d=0,p=0,f=0,m=0;const g=Math.abs(this._element.anchor.x-this._element.anchor.z)>=1e-4;let b=this._element.calculatedWidth;(this.autoWidth&&!g||!this._wrapLines)&&(b=Number.POSITIVE_INFINITY);let y,v,S,x,w=0,C=0,T=1;function A(t,i,n){e._lineWidths.push(Math.abs(n));const s=d>i?i+1:d,r=d>i?d+1:i,l=t.slice(s,r);if(m){let t=l.length;for(;t--&&m>0;)pv.test(l[t])&&(l.splice(t,1),m--)}e._lineContents.push(l.join("")),o=0,a-=e._scaledLineHeight,c++,p=0,f=0,m=0,_=0,d=i}let E=!0;for(;E;){E=!1,this._scaledLineHeight=s?this._lineHeight*this._fontSize/(this._maxFontSize||1e-4):this._lineHeight,this.width=0,this.height=0,this._lineWidths=[],this._lineContents=[],o=0,a=0,l=0,h=0,c=1,_=0,u=0,d=0,p=0,f=0,m=0,T=this._fontSize/32,w=this._fontMinY*T,C=this._fontMaxY*T;for(let t=0;t<this._meshInfo.length;t++)this._meshInfo[t].quad=0,this._meshInfo[t].lines={};let e=255,g=255,M=255;for(let s=0;s<r;s++){y=this._symbols[s],x=s+1>=r?null:this._symbols[s+1];if(pv.test(y)){m++,(!this._wrapLines||this._maxLines<0||c<this._maxLines)&&(A(this._symbols,s,h),u=s+1,d=s+1);continue}let R,I,P=0,L=0,D=0,k=1;if(v=t.chars[y],!v)if(-1!==vv.indexOf(y))v=Sv;else if(t.chars[" "])v=t.chars[" "];else for(const e in t.chars){v=t.chars[e];break}if(v){let t=0;if(f>0){const e=this._font.data.kerning;if(e){const i=e[z.getCodePoint(this._symbols[s-1])||0];i&&(t=i[z.getCodePoint(this._symbols[s])||0]||0)}}R=v.scale||1,I=(v.width+v.height)/2,k=T*I/R,D=(v.xadvance+t)*T,P=(v.xoffset-t)*T,L=v.yoffset*T}else console.error("Couldn't substitute missing character: '"+y+"'");const O=fv.test(y),F=this._meshInfo[v&&v.map||0],B=o+this._spacing*D;if(B>b&&f>0&&!O&&(this._maxLines<0||c<this._maxLines)){if(0!==p){const e=Math.max(s-u,0);if(this._meshInfo.length<=1)F.lines[c-1]-=e,F.quad-=e;else{const e=s;for(let i=u;i<e;i++){const e=this._symbols[i],n=t.chars[e],s=this._meshInfo[n&&n.map||0];s.lines[c-1]-=1,s.quad-=1}}s-=e+1,A(this._symbols,u,_);continue}u=s,A(this._symbols,s,h)}S=F.quad,F.lines[c-1]=S;let N=o-P,U=N+k;const V=a-L,W=V+k;if(this._rtl){const t=k-P-this._spacing*D-P;N-=t,U-=t}let G;if(F.positions[4*S*3+0]=N,F.positions[4*S*3+1]=V,F.positions[4*S*3+2]=l,F.positions[4*S*3+3]=U,F.positions[4*S*3+4]=V,F.positions[4*S*3+5]=l,F.positions[4*S*3+6]=U,F.positions[4*S*3+7]=W,F.positions[4*S*3+8]=l,F.positions[4*S*3+9]=N,F.positions[4*S*3+10]=W,F.positions[4*S*3+11]=l,this.width=Math.max(this.width,B),this._shouldAutoFitWidth()&&this.width>this._element.calculatedWidth&&(G=Math.floor(this._element.fontSize*this._element.calculatedWidth/(this.width||1e-4)),G=Z.clamp(G,i,n),G!==this._element.fontSize)){this._fontSize=G,E=!0;break}if(this.height=Math.max(this.height,C-(a+w)),this._shouldAutoFitHeight()&&this.height>this._element.calculatedHeight&&(G=Z.clamp(this._fontSize-1,i,n),G!==this._element.fontSize)){this._fontSize=G,E=!0;break}o+=this._spacing*D,O||(h=o),(this._isWordBoundary(y)||this._isValidNextChar(x)&&(this._isNextCJKBoundary(y,x)||this._isNextCJKWholeWord(x)))&&(p++,_=h,u=s+1),f++;const j=this._getUv(y);if(F.uvs[4*S*2+0]=j[0],F.uvs[4*S*2+1]=1-j[1],F.uvs[4*S*2+2]=j[2],F.uvs[4*S*2+3]=1-j[1],F.uvs[4*S*2+4]=j[2],F.uvs[4*S*2+5]=1-j[3],F.uvs[4*S*2+6]=j[0],F.uvs[4*S*2+7]=1-j[3],this._symbolColors){const t=3*this._symbolColors[s];e=this._colorPalette[t],g=this._colorPalette[t+1],M=this._colorPalette[t+2]}F.colors[4*S*4+0]=e,F.colors[4*S*4+1]=g,F.colors[4*S*4+2]=M,F.colors[4*S*4+3]=255,F.colors[4*S*4+4]=e,F.colors[4*S*4+5]=g,F.colors[4*S*4+6]=M,F.colors[4*S*4+7]=255,F.colors[4*S*4+8]=e,F.colors[4*S*4+9]=g,F.colors[4*S*4+10]=M,F.colors[4*S*4+11]=255,F.colors[4*S*4+12]=e,F.colors[4*S*4+13]=g,F.colors[4*S*4+14]=M,F.colors[4*S*4+15]=255,F.quad++}E||d<r&&A(this._symbols,r,o)}this._noResize=!0,this.autoWidth=this._autoWidth,this.autoHeight=this._autoHeight,this._noResize=!1;const M=this._element.pivot.x,R=this._element.pivot.y,I=this._alignment.x,P=this._alignment.y;for(let t=0;t<this._meshInfo.length;t++){if(0===this._meshInfo[t].count)continue;let e=0;for(const i in this._meshInfo[t].lines){const n=this._meshInfo[t].lines[i],s=this._lineWidths[parseInt(i,10)],r=-M*this._element.calculatedWidth+I*(this._element.calculatedWidth-s)*(this._rtl?-1:1),o=(1-R)*this._element.calculatedHeight-C-(1-P)*(this._element.calculatedHeight-this.height);for(let i=e;i<=n;i++)this._meshInfo[t].positions[4*i*3]+=r,this._meshInfo[t].positions[4*i*3+3]+=r,this._meshInfo[t].positions[4*i*3+6]+=r,this._meshInfo[t].positions[4*i*3+9]+=r,this._meshInfo[t].positions[4*i*3+1]+=o,this._meshInfo[t].positions[4*i*3+4]+=o,this._meshInfo[t].positions[4*i*3+7]+=o,this._meshInfo[t].positions[4*i*3+10]+=o;if(this._rtl)for(let i=e;i<=n;i++){const e=4*i*3;for(let i=0;i<4;++i)this._meshInfo[t].positions[e+3*i]=this._element.calculatedWidth-this._meshInfo[t].positions[e+3*i]+2*r;const n=this._meshInfo[t].positions[e+3],s=this._meshInfo[t].positions[e+6];this._meshInfo[t].positions[e+3]=this._meshInfo[t].positions[e+0],this._meshInfo[t].positions[e+6]=this._meshInfo[t].positions[e+9],this._meshInfo[t].positions[e+0]=n,this._meshInfo[t].positions[e+9]=s}e=n+1}const i=4*this._meshInfo[t].count,n=4*this._meshInfo[t].quad,s=new uh(this._meshInfo[t].meshInstance.mesh.vertexBuffer);for(let e=0;e<i;e++)e>=n?(s.element[Zs].set(0,0,0),s.element[nr].set(0,0),s.element[er].set(0,0,0,0)):(s.element[Zs].set(this._meshInfo[t].positions[3*e+0],this._meshInfo[t].positions[3*e+1],this._meshInfo[t].positions[3*e+2]),s.element[nr].set(this._meshInfo[t].uvs[2*e+0],this._meshInfo[t].uvs[2*e+1]),s.element[er].set(this._meshInfo[t].colors[4*e+0],this._meshInfo[t].colors[4*e+1],this._meshInfo[t].colors[4*e+2],this._meshInfo[t].colors[4*e+3])),s.next();s.end(),this._meshInfo[t].meshInstance.mesh.aabb.compute(this._meshInfo[t].positions),this._meshInfo[t].meshInstance._aabbVer=-1}this._aabbDirty=!0}_onFontRender(){this.font=this._font}_onFontLoad(t){this.font!==t.resource&&(this.font=t.resource)}_onFontChange(t,e,i,n){if("data"===e){this._font.data=i;const t=this._font.data.info.maps.length;for(let e=0;e<t;e++){if(!this._meshInfo[e])continue;const t=this._meshInfo[e].meshInstance;t&&(t.setParameter("font_sdfIntensity",this._font.intensity),t.setParameter("font_pxrange",this._getPxRange(this._font)),t.setParameter("font_textureWidth",this._font.data.info.maps[e].width))}}}_onFontRemove(t){}_setTextureParams(t,e){this._font&&(this._font.type===Op?(t.deleteParameter("texture_emissiveMap"),t.deleteParameter("texture_opacityMap"),t.setParameter("texture_msdfMap",e)):this._font.type===Fp&&(t.deleteParameter("texture_msdfMap"),t.setParameter("texture_emissiveMap",e),t.setParameter("texture_opacityMap",e)))}_getPxRange(t){const e=Object.keys(this._font.data.chars);for(let t=0;t<e.length;t++){const i=this._font.data.chars[e[t]];if(i.range)return(i.scale||1)*i.range}return 2}_getUv(t){const e=this._font.data;if(!e.chars[t]){const t=" ";return e.chars[t]?this._getUv(t):[0,0,0,0]}const i=e.chars[t].map,n=e.info.maps[i].width,s=e.info.maps[i].height,r=e.chars[t].x,o=e.chars[t].y,a=r,l=o,h=r+e.chars[t].width,c=o-e.chars[t].height,_=1-e.chars[t].height/s;return[a/n,_-l/s,h/n,_-c/s]}onEnable(){this._fontAsset.autoLoad=!0,this._model&&this._element.addModelToLayers(this._model)}onDisable(){this._fontAsset.autoLoad=!1,this._model&&this._element.removeModelFromLayers(this._model)}_setStencil(t){if(this._model){const e=this._model.meshInstances;for(let i=0;i<e.length;i++)e[i].stencilFront=t,e[i].stencilBack=t}}_shouldAutoFitWidth(){return this._autoFitWidth&&!this._autoWidth}_shouldAutoFitHeight(){return this._autoFitHeight&&!this._autoHeight}_shouldAutoFit(){return this._autoFitWidth&&!this._autoWidth||this._autoFitHeight&&!this._autoHeight}_calculateCharsPerTexture(t){const e={};void 0===t&&(t=this._symbols.length);for(let i=0,n=t;i<n;i++){const t=this._symbols[i];let n=this._font.data.chars[t];n||(n=this._font.data.chars[" "],n||(n=this._font.data.chars[Object.keys(this._font.data.chars)[0]]));const s=n.map;e[s]?e[s]++:e[s]=1}return e}_updateRenderRange(){const t=0===this._rangeStart?0:this._calculateCharsPerTexture(this._rangeStart),e=0===this._rangeEnd?0:this._calculateCharsPerTexture(this._rangeEnd);for(let i=0,n=this._meshInfo.length;i<n;i++){const n=t[i]||0,s=e[i]||0,r=this._meshInfo[i].meshInstance;if(r){const t=r.mesh;t&&(t.primitive[0].base=3*n*2,t.primitive[0].count=3*(s-n)*2)}}}get text(){return this._text}set text(t){this._i18nKey=null;const e=null!=t&&t.toString()||"";this._setText(e)}get key(){return this._i18nKey}set key(t){const e=null!==t?t.toString():null;this._i18nKey!==e&&(this._i18nKey=e,e?(this._fontAsset.disableLocalization=!1,this._resetLocalizedText()):this._fontAsset.disableLocalization=!0)}get color(){return this._color}set color(t){const e=t.r,i=t.g,n=t.b;if(this._color.r!==e||this._color.g!==i||this._color.b!==n)if(this._color.r=e,this._color.g=i,this._color.b=n,this._symbolColors)this._font&&this._updateText();else{this._colorUniform[0]=this._color.r,this._colorUniform[1]=this._color.g,this._colorUniform[2]=this._color.b;for(let t=0,e=this._model.meshInstances.length;t<e;t++){this._model.meshInstances[t].setParameter("material_emissive",this._colorUniform)}}}get opacity(){return this._color.a}set opacity(t){if(this._color.a!==t&&(this._color.a=t,this._model))for(let e=0,i=this._model.meshInstances.length;e<i;e++){this._model.meshInstances[e].setParameter("material_opacity",t)}}get lineHeight(){return this._lineHeight}set lineHeight(t){const e=this._lineHeight;this._lineHeight=t,this._scaledLineHeight=t,e!==t&&this._font&&this._updateText()}get wrapLines(){return this._wrapLines}set wrapLines(t){const e=this._wrapLines;this._wrapLines=t,e!==t&&this._font&&this._updateText()}get lines(){return this._lineContents}get spacing(){return this._spacing}set spacing(t){const e=this._spacing;this._spacing=t,e!==t&&this._font&&this._updateText()}get fontSize(){return this._fontSize}set fontSize(t){const e=this._fontSize;this._fontSize=t,this._originalFontSize=t,e!==t&&this._font&&this._updateText()}get fontAsset(){return this._fontAsset.localizedAsset}set fontAsset(t){this._fontAsset.defaultAsset=t}get font(){return this._font}set font(t){let e;if(this._font&&(e=this._font.type,this._font.off&&this._font.off("render",this._onFontRender,this)),this._font=t,this._fontMinY=0,this._fontMaxY=0,!t)return;const i=this._font.data;for(const t in i.chars){const e=i.chars[t];e.bounds&&(this._fontMinY=Math.min(this._fontMinY,e.bounds[1]),this._fontMaxY=Math.max(this._fontMaxY,e.bounds[3]))}if(this._font.on&&this._font.on("render",this._onFontRender,this),this._fontAsset.localizedAsset){this._system.app.assets.get(this._fontAsset.localizedAsset).resource!==this._font&&(this._fontAsset.defaultAsset=null)}if(t.type!==e){const t=this._element._isScreenSpace();this._updateMaterial(t)}for(let t=0,e=this._font.textures.length;t<e;t++)if(this._meshInfo[t]){const e=this._meshInfo[t].meshInstance;e&&(e.setParameter("font_sdfIntensity",this._font.intensity),e.setParameter("font_pxrange",this._getPxRange(this._font)),e.setParameter("font_textureWidth",this._font.data.info.maps[t].width),this._setTextureParams(e,this._font.textures[t]))}else this._meshInfo[t]=new dv;let n=!1;for(let t=this._font.textures.length;t<this._meshInfo.length;t++)this._meshInfo[t].meshInstance&&(n||(this._element.removeModelFromLayers(this._model),n=!0),this._removeMeshInstance(this._meshInfo[t].meshInstance));this._meshInfo.length>this._font.textures.length&&(this._meshInfo.length=this._font.textures.length),this._updateText()}get alignment(){return this._alignment}set alignment(t){t instanceof _t?this._alignment.set(t.x,t.y):this._alignment.set(t[0],t[1]),this._font&&this._updateText()}get autoWidth(){return this._autoWidth}set autoWidth(t){const e=this._autoWidth;if(this._autoWidth=t,t&&Math.abs(this._element.anchor.x-this._element.anchor.z)<1e-4&&(this._element.width=this.width),e!==t){const t=this._shouldAutoFit()?this._maxFontSize:this._originalFontSize;t!==this._fontSize&&(this._fontSize=t,this._font&&this._updateText())}}get autoHeight(){return this._autoHeight}set autoHeight(t){const e=this._autoHeight;if(this._autoHeight=t,t&&Math.abs(this._element.anchor.y-this._element.anchor.w)<1e-4&&(this._element.height=this.height),e!==t){const t=this._shouldAutoFit()?this._maxFontSize:this._originalFontSize;t!==this._fontSize&&(this._fontSize=t,this._font&&this._updateText())}}get rtlReorder(){return this._rtlReorder}set rtlReorder(t){this._rtlReorder!==t&&(this._rtlReorder=t,this._font&&this._updateText())}get unicodeConverter(){return this._unicodeConverter}set unicodeConverter(t){this._unicodeConverter!==t&&(this._unicodeConverter=t,this._setText(this._text))}get aabb(){if(this._aabbDirty){let t=!1;for(let e=0;e<this._meshInfo.length;e++)this._meshInfo[e].meshInstance&&(t?this._aabb.add(this._meshInfo[e].meshInstance.aabb):(this._aabb.copy(this._meshInfo[e].meshInstance.aabb),t=!0));this._aabbDirty=!1}return this._aabb}get outlineColor(){return this._outlineColor}set outlineColor(t){const e=t instanceof rt?t.r:t[0],i=t instanceof rt?t.g:t[1],n=t instanceof rt?t.b:t[2],s=t instanceof rt?t.a:t[3];if((this._outlineColor.r!==e||this._outlineColor.g!==i||this._outlineColor.b!==n||this._outlineColor.a!==s)&&(this._outlineColor.r=e,this._outlineColor.g=i,this._outlineColor.b=n,this._outlineColor.a=s,this._model)){this._outlineColorUniform[0]=this._outlineColor.r,this._outlineColorUniform[1]=this._outlineColor.g,this._outlineColorUniform[2]=this._outlineColor.b,this._outlineColorUniform[3]=this._outlineColor.a;for(let t=0,e=this._model.meshInstances.length;t<e;t++){this._model.meshInstances[t].setParameter("outline_color",this._outlineColorUniform)}}}get outlineThickness(){return this._outlineThickness}set outlineThickness(t){const e=this._outlineThickness;if(this._outlineThickness=t,e!==t&&this._font&&this._model)for(let t=0,e=this._model.meshInstances.length;t<e;t++){this._model.meshInstances[t].setParameter("outline_thickness",this._outlineThicknessScale*this._outlineThickness)}}get shadowColor(){return this._shadowColor}set shadowColor(t){const e=t instanceof rt?t.r:t[0],i=t instanceof rt?t.g:t[1],n=t instanceof rt?t.b:t[2],s=t instanceof rt?t.a:t[3];if((this._shadowColor.r!==e||this._shadowColor.g!==i||this._shadowColor.b!==n||this._shadowColor.a!==s)&&(this._shadowColor.r=e,this._shadowColor.g=i,this._shadowColor.b=n,this._shadowColor.a=s,this._model)){this._shadowColorUniform[0]=this._shadowColor.r,this._shadowColorUniform[1]=this._shadowColor.g,this._shadowColorUniform[2]=this._shadowColor.b,this._shadowColorUniform[3]=this._shadowColor.a;for(let t=0,e=this._model.meshInstances.length;t<e;t++){this._model.meshInstances[t].setParameter("shadow_color",this._shadowColorUniform)}}}get shadowOffset(){return this._shadowOffset}set shadowOffset(t){const e=t instanceof _t?t.x:t[0],i=t instanceof _t?t.y:t[1];if((this._shadowOffset.x!==e||this._shadowOffset.y!==i)&&(this._shadowOffset.set(e,i),this._font&&this._model))for(let t=0,e=this._model.meshInstances.length;t<e;t++){const e=-this._font.data.info.maps[t].width/this._font.data.info.maps[t].height;this._shadowOffsetUniform[0]=this._shadowOffsetScale*this._shadowOffset.x,this._shadowOffsetUniform[1]=e*this._shadowOffsetScale*this._shadowOffset.y;this._model.meshInstances[t].setParameter("shadow_offset",this._shadowOffsetUniform)}}get minFontSize(){return this._minFontSize}set minFontSize(t){this._minFontSize!==t&&(this._minFontSize=t,this.font&&this._shouldAutoFit()&&this._updateText())}get maxFontSize(){return this._maxFontSize}set maxFontSize(t){this._maxFontSize!==t&&(this._maxFontSize=t,this.font&&this._shouldAutoFit()&&this._updateText())}get autoFitWidth(){return this._autoFitWidth}set autoFitWidth(t){this._autoFitWidth!==t&&(this._autoFitWidth=t,this._fontSize=this._shouldAutoFit()?this._maxFontSize:this._originalFontSize,this.font&&this._updateText())}get autoFitHeight(){return this._autoFitHeight}set autoFitHeight(t){this._autoFitHeight!==t&&(this._autoFitHeight=t,this._fontSize=this._shouldAutoFit()?this._maxFontSize:this._originalFontSize,this.font&&this._updateText())}get maxLines(){return this._maxLines}set maxLines(t){this._maxLines!==t&&(null===t&&-1===this._maxLines||(this._maxLines=null===t?-1:t,this.font&&this._wrapLines&&this._updateText()))}get enableMarkup(){return this._enableMarkup}set enableMarkup(t){t=!!t,this._enableMarkup!==t&&(this._enableMarkup=t,this.font&&this._updateText())}get symbols(){return this._symbols}get symbolColors(){return null===this._symbolColors?null:this._symbolColors.map((function(t){return this._colorPalette.slice(3*t,3*t+3)}),this)}get rtl(){return this._rtl}get rangeStart(){return this._rangeStart}set rangeStart(t){(t=Math.max(0,Math.min(t,this._symbols.length)))!==this._rangeStart&&(this._rangeStart=t,this._updateRenderRange())}get rangeEnd(){return this._rangeEnd}set rangeEnd(t){(t=Math.max(this._rangeStart,Math.min(t,this._symbols.length)))!==this._rangeEnd&&(this._rangeEnd=t,this._updateRenderRange())}}const wv=new ht,Cv=new bt,Tv=new ht,Av=new ht,Ev=new bt,Mv=new bt,Rv=new bt,Iv=new bt;class Pv extends gg{constructor(t,e){super(t,e),this._beingInitialized=!1,this._anchor=new ut,this._localAnchor=new ut,this._pivot=new _t,this._width=this._calculatedWidth=32,this._height=this._calculatedHeight=32,this._margin=new ut(0,0,-32,-32),this._modelTransform=new bt,this._screenToWorld=new bt,this._anchorTransform=new bt,this._anchorDirty=!0,this._parentWorldTransform=new bt,this._screenTransform=new bt,this._screenCorners=[new ht,new ht,new ht,new ht],this._canvasCorners=[new _t,new _t,new _t,new _t],this._worldCorners=[new ht,new ht,new ht,new ht],this._cornersDirty=!0,this._canvasCornersDirty=!0,this._worldCornersDirty=!0,this.entity.on("insert",this._onInsert,this),this._patch(),this.screen=null,this._type=tv,this._image=null,this._text=null,this._group=null,this._drawOrder=0,this._useInput=!1,this._layers=[te],this._addedModels=[],this._batchGroupId=-1,this._offsetReadAt=0,this._maskOffset=.5,this._maskedBy=null}_patch(){this.entity._sync=this._sync,this.entity.setPosition=this._setPosition,this.entity.setLocalPosition=this._setLocalPosition}_unpatch(){this.entity._sync=uA.prototype._sync,this.entity.setPosition=uA.prototype.setPosition,this.entity.setLocalPosition=uA.prototype.setLocalPosition}_setPosition(t,e,i){if(!this.element.screen)return uA.prototype.setPosition.call(this,t,e,i);t instanceof ht?wv.copy(t):wv.set(t,e,i),this.getWorldTransform(),Cv.copy(this.element._screenToWorld).invert(),Cv.transformPoint(wv,this.localPosition),this._dirtyLocal||this._dirtifyLocal()}_setLocalPosition(t,e,i){t instanceof ht?this.localPosition.copy(t):this.localPosition.set(t,e,i);const n=this.element,s=this.localPosition,r=n._pivot;n._margin.x=s.x-n._calculatedWidth*r.x,n._margin.z=n._localAnchor.z-n._localAnchor.x-n._calculatedWidth-n._margin.x,n._margin.y=s.y-n._calculatedHeight*r.y,n._margin.w=n._localAnchor.w-n._localAnchor.y-n._calculatedHeight-n._margin.y,this._dirtyLocal||this._dirtifyLocal()}_sync(){const t=this.element,e=t.screen;if(e){if(t._anchorDirty){let i=0,n=0,s=0,r=1;if(this._parent&&this._parent.element)i=this._parent.element.calculatedWidth,n=this._parent.element.calculatedHeight,s=this._parent.element.pivot.x,r=this._parent.element.pivot.y;else{const t=e.screen.resolution;i=t.x/e.screen.scale,n=t.y/e.screen.scale}t._anchorTransform.setTranslate(i*(t.anchor.x-s),-n*(r-t.anchor.y),0),t._anchorDirty=!1,t._calculateLocalAnchors()}t._sizeDirty&&t._calculateSize(!1,!1)}if(this._dirtyLocal){this.localTransform.setTRS(this.localPosition,this.localRotation,this.localScale);const e=this.localPosition,i=t._pivot;t._margin.x=e.x-t._calculatedWidth*i.x,t._margin.z=t._localAnchor.z-t._localAnchor.x-t._calculatedWidth-t._margin.x,t._margin.y=e.y-t._calculatedHeight*i.y,t._margin.w=t._localAnchor.w-t._localAnchor.y-t._calculatedHeight-t._margin.y,this._dirtyLocal=!1}if(!e)return this._dirtyWorld&&(t._cornersDirty=!0,t._canvasCornersDirty=!0,t._worldCornersDirty=!0),uA.prototype._sync.call(this);if(this._dirtyWorld){if(null===this._parent)this.worldTransform.copy(this.localTransform);else if(this._parent.element?t._screenToWorld.mul2(this._parent.element._modelTransform,t._anchorTransform):t._screenToWorld.copy(t._anchorTransform),t._modelTransform.mul2(t._screenToWorld,this.localTransform),e){t._screenToWorld.mul2(e.screen._screenMatrix,t._screenToWorld),e.screen.screenSpace||t._screenToWorld.mul2(e.worldTransform,t._screenToWorld),this.worldTransform.mul2(t._screenToWorld,this.localTransform);const i=t._parentWorldTransform;i.setIdentity();const n=this._parent;n&&n.element&&n!==e&&(Ev.setTRS(ht.ZERO,n.getLocalRotation(),n.getLocalScale()),i.mul2(n.element._parentWorldTransform,Ev));const s=Tv;s.set(0,0,this.localPosition.z);const r=Av;r.set(t._absLeft+t._pivot.x*t.calculatedWidth,t._absBottom+t._pivot.y*t.calculatedHeight,0),Ev.setTranslate(-r.x,-r.y,-r.z),Mv.setTRS(s,this.getLocalRotation(),this.getLocalScale()),Rv.setTranslate(r.x,r.y,r.z),t._screenTransform.mul2(t._parentWorldTransform,Rv).mul(Mv).mul(Ev),t._cornersDirty=!0,t._canvasCornersDirty=!0,t._worldCornersDirty=!0}else this.worldTransform.copy(t._modelTransform);this._dirtyWorld=!1}}_onInsert(t){const e=this._parseUpToScreen();this.entity._dirtifyWorld(),this._updateScreen(e.screen),this._dirtifyMask()}_dirtifyMask(){let t=this.entity;for(;t;){const e=t.parent;if((null===e||e.screen)&&t.element){this.system._prerender&&this.system._prerender.length||(this.system._prerender=[],this.system.app.once("prerender",this._onPrerender,this));const e=this.system._prerender.indexOf(this.entity);e>=0&&this.system._prerender.splice(e,1);this.system._prerender.indexOf(t)<0&&this.system._prerender.push(t)}t=e}}_onPrerender(){for(let t=0;t<this.system._prerender.length;t++){const e=this.system._prerender[t];if(e.element){const t=1;e.element.syncMask(t)}}this.system._prerender.length=0}_bindScreen(t){t._bindElement(this)}_unbindScreen(t){t._unbindElement(this)}_updateScreen(t){this.screen&&this.screen!==t&&this._unbindScreen(this.screen.screen);const e=this.screen;this.screen=t,this.screen&&this._bindScreen(this.screen.screen),this._calculateSize(this._hasSplitAnchorsX,this._hasSplitAnchorsY),this.fire("set:screen",this.screen,e),this._anchorDirty=!0;const i=this.entity.children;for(let e=0,n=i.length;e<n;e++)i[e].element&&i[e].element._updateScreen(t);this.screen&&this.screen.screen.syncDrawOrder()}syncMask(t){const e=this._parseUpToScreen();this._updateMask(e.mask,t)}_setMaskedBy(t){const e=this._image||this._text;if(t){const i=t.element._image._maskRef,n=new nv({ref:i,func:ns});e&&e._setStencil&&e._setStencil(n),this._maskedBy=t}else e&&e._setStencil&&e._setStencil(null),this._maskedBy=null}_updateMask(t,e){if(t){if(this._setMaskedBy(t),this.mask){const i=t.element._image._maskRef,n=new nv({ref:i,func:ns,zpass:Lr});this._image._setStencil(n),this._image._maskRef=e,e++,t=this.entity}const i=this.entity.children;for(let n=0,s=i.length;n<s;n++)i[n].element&&i[n].element._updateMask(t,e);this.mask&&e--}else{if(this._setMaskedBy(null),this.mask){const i=new nv({ref:e,func:ls,zpass:Pr});this._image._setStencil(i),this._image._maskRef=e,e++,t=this.entity}const i=this.entity.children;for(let n=0,s=i.length;n<s;n++)i[n].element&&i[n].element._updateMask(t,e);this.mask&&e--}}_parseUpToScreen(){const t={screen:null,mask:null};let e=this.entity._parent;for(;e&&!e.screen;)e.element&&e.element.mask&&(t.mask||(t.mask=e)),e=e.parent;return e&&e.screen&&(t.screen=e),t}_onScreenResize(t){this._anchorDirty=!0,this._cornersDirty=!0,this._worldCornersDirty=!0,this._calculateSize(this._hasSplitAnchorsX,this._hasSplitAnchorsY),this.fire("screen:set:resolution",t)}_onScreenSpaceChange(){this.fire("screen:set:screenspace",this.screen.screen.screenSpace)}_onScreenRemove(){this.screen&&(this.screen._destroying?this.screen=null:this._updateScreen(null))}_calculateLocalAnchors(){let t=1e3,e=1e3;const i=this.entity._parent;if(i&&i.element)t=i.element.calculatedWidth,e=i.element.calculatedHeight;else if(this.screen){const i=this.screen.screen.resolution,n=this.screen.screen.scale;t=i.x/n,e=i.y/n}this._localAnchor.set(this._anchor.x*t,this._anchor.y*e,this._anchor.z*t,this._anchor.w*e)}getOffsetPosition(t,e){const i=this.entity.getLocalPosition().clone();return i.x+=t,i.y+=e,this._screenToWorld.transformPoint(i,i),i}onLayersChanged(t,e){this.addModelToLayers(this._image?this._image._renderable.model:this._text._model),t.off("add",this.onLayerAdded,this),t.off("remove",this.onLayerRemoved,this),e.on("add",this.onLayerAdded,this),e.on("remove",this.onLayerRemoved,this)}onLayerAdded(t){this.layers.indexOf(t.id)<0||(this._image?t.addMeshInstances(this._image._renderable.model.meshInstances):this._text&&t.addMeshInstances(this._text._model.meshInstances))}onLayerRemoved(t){this.layers.indexOf(t.id)<0||(this._image?t.removeMeshInstances(this._image._renderable.model.meshInstances):this._text&&t.removeMeshInstances(this._text._model.meshInstances))}onEnable(){this._image&&this._image.onEnable(),this._text&&this._text.onEnable(),this._group&&this._group.onEnable(),this.useInput&&this.system.app.elementInput&&this.system.app.elementInput.addElement(this),this.system.app.scene.on("set:layers",this.onLayersChanged,this),this.system.app.scene.layers&&(this.system.app.scene.layers.on("add",this.onLayerAdded,this),this.system.app.scene.layers.on("remove",this.onLayerRemoved,this)),this._batchGroupId>=0&&this.system.app.batcher.insert(Nh.ELEMENT,this.batchGroupId,this.entity),this.fire("enableelement")}onDisable(){this.system.app.scene.off("set:layers",this.onLayersChanged,this),this.system.app.scene.layers&&(this.system.app.scene.layers.off("add",this.onLayerAdded,this),this.system.app.scene.layers.off("remove",this.onLayerRemoved,this)),this._image&&this._image.onDisable(),this._text&&this._text.onDisable(),this._group&&this._group.onDisable(),this.system.app.elementInput&&this.useInput&&this.system.app.elementInput.removeElement(this),this._batchGroupId>=0&&this.system.app.batcher.remove(Nh.ELEMENT,this.batchGroupId,this.entity),this.fire("disableelement")}onRemove(){this.entity.off("insert",this._onInsert,this),this._unpatch(),this._image&&this._image.destroy(),this._text&&this._text.destroy(),this.system.app.elementInput&&this.useInput&&this.system.app.elementInput.removeElement(this),this.screen&&this.screen.screen&&(this._unbindScreen(this.screen.screen),this.screen.screen.syncDrawOrder()),this.off()}_calculateSize(t,e){if(!this.entity._parent&&!this.screen)return;this._calculateLocalAnchors();const i=this._absRight-this._absLeft,n=this._absTop-this._absBottom;t?this._setWidth(i):this._setCalculatedWidth(i,!1),e?this._setHeight(n):this._setCalculatedHeight(n,!1);const s=this.entity.getLocalPosition();s.x=this._margin.x+this._calculatedWidth*this._pivot.x,s.y=this._margin.y+this._calculatedHeight*this._pivot.y,this.entity.setLocalPosition(s),this._sizeDirty=!1}_setWidth(t){this._width=t,this._setCalculatedWidth(t,!1),this.fire("set:width",this._width)}_setHeight(t){this._height=t,this._setCalculatedHeight(t,!1),this.fire("set:height",this._height)}_setCalculatedWidth(t,e){if(!(Math.abs(t-this._calculatedWidth)<=1e-4)){if(this._calculatedWidth=t,this.entity._dirtifyLocal(),e){const t=this.entity.getLocalPosition(),e=this._pivot;this._margin.x=t.x-this._calculatedWidth*e.x,this._margin.z=this._localAnchor.z-this._localAnchor.x-this._calculatedWidth-this._margin.x}this._flagChildrenAsDirty(),this.fire("set:calculatedWidth",this._calculatedWidth),this.fire("resize",this._calculatedWidth,this._calculatedHeight)}}_setCalculatedHeight(t,e){if(!(Math.abs(t-this._calculatedHeight)<=1e-4)){if(this._calculatedHeight=t,this.entity._dirtifyLocal(),e){const t=this.entity.getLocalPosition(),e=this._pivot;this._margin.y=t.y-this._calculatedHeight*e.y,this._margin.w=this._localAnchor.w-this._localAnchor.y-this._calculatedHeight-this._margin.y}this._flagChildrenAsDirty(),this.fire("set:calculatedHeight",this._calculatedHeight),this.fire("resize",this._calculatedWidth,this._calculatedHeight)}}_flagChildrenAsDirty(){const t=this.entity._children;for(let e=0,i=t.length;e<i;e++)t[e].element&&(t[e].element._anchorDirty=!0,t[e].element._sizeDirty=!0)}addModelToLayers(t){this._addedModels.push(t);for(let e=0;e<this.layers.length;e++){const i=this.system.app.scene.layers.getLayerById(this.layers[e]);i&&i.addMeshInstances(t.meshInstances)}}removeModelFromLayers(t){const e=this._addedModels.indexOf(t);e>=0&&this._addedModels.splice(e,1);for(let e=0;e<this.layers.length;e++){const i=this.system.app.scene.layers.getLayerById(this.layers[e]);i&&i.removeMeshInstances(t.meshInstances)}}getMaskOffset(){const t=this.system.app.frame;this._offsetReadAt!==t&&(this._maskOffset=.5,this._offsetReadAt=t);const e=this._maskOffset;return this._maskOffset-=.001,e}isVisibleForCamera(t){let e,i,n,s;if(this.maskedBy){const t=this.maskedBy.element.screenCorners;e=Math.min(Math.min(t[0].x,t[1].x),Math.min(t[2].x,t[3].x)),i=Math.max(Math.max(t[0].x,t[1].x),Math.max(t[2].x,t[3].x)),s=Math.min(Math.min(t[0].y,t[1].y),Math.min(t[2].y,t[3].y)),n=Math.max(Math.max(t[0].y,t[1].y),Math.max(t[2].y,t[3].y))}else{const r=this.system.app.graphicsDevice.width,o=this.system.app.graphicsDevice.height,a=t._rect.z*r,l=t._rect.w*o;e=t._rect.x*r,i=e+a,n=(1-t._rect.y)*o,s=n-l}const r=this.screenCorners,o=Math.min(Math.min(r[0].x,r[1].x),Math.min(r[2].x,r[3].x)),a=Math.max(Math.max(r[0].x,r[1].x),Math.max(r[2].x,r[3].x)),l=Math.min(Math.min(r[0].y,r[1].y),Math.min(r[2].y,r[3].y)),h=Math.max(Math.max(r[0].y,r[1].y),Math.max(r[2].y,r[3].y));return!(a<e||o>i||l>n||h<s)}_isScreenSpace(){return!(!this.screen||!this.screen.screen)&&this.screen.screen.screenSpace}_isScreenCulled(){return!(!this.screen||!this.screen.screen)&&this.screen.screen.cull}}function Lv(t){Object.defineProperty(Pv.prototype,t,{get:function(){return this._text?this._text[t]:this._image?this._image[t]:null},set:function(e){this._text?this._text[t]=e:this._image&&(this._image[t]=e)}})}Object.defineProperty(Pv.prototype,"type",{get:function(){return this._type},set:function(t){t!==this._type&&(this._type=t,this._image&&(this._image.destroy(),this._image=null),this._text&&(this._text.destroy(),this._text=null),t===ev?this._image=new rv(this):t===iv&&(this._text=new xv(this)))}}),Object.defineProperty(Pv.prototype,"layers",{get:function(){return this._layers},set:function(t){if(this._addedModels.length)for(let t=0;t<this._layers.length;t++){const e=this.system.app.scene.layers.getLayerById(this._layers[t]);if(e)for(let t=0;t<this._addedModels.length;t++)e.removeMeshInstances(this._addedModels[t].meshInstances)}if(this._layers=t,this.enabled&&this.entity.enabled&&this._addedModels.length)for(let t=0;t<this._layers.length;t++){const e=this.system.app.scene.layers.getLayerById(this._layers[t]);if(e)for(let t=0;t<this._addedModels.length;t++)e.addMeshInstances(this._addedModels[t].meshInstances)}}}),Object.defineProperty(Pv.prototype,"drawOrder",{get:function(){return this._drawOrder},set:function(t){let e=0;this.screen&&(e=this.screen.screen.priority),t>16777215&&(t=16777215),this._drawOrder=(e<<24)+t,this.fire("set:draworder",this._drawOrder)}}),Object.defineProperty(Pv.prototype,"_absLeft",{get:function(){return this._localAnchor.x+this._margin.x}}),Object.defineProperty(Pv.prototype,"_absRight",{get:function(){return this._localAnchor.z-this._margin.z}}),Object.defineProperty(Pv.prototype,"_absTop",{get:function(){return this._localAnchor.w-this._margin.w}}),Object.defineProperty(Pv.prototype,"_absBottom",{get:function(){return this._localAnchor.y+this._margin.y}}),Object.defineProperty(Pv.prototype,"margin",{get:function(){return this._margin},set:function(t){this._margin.copy(t),this._calculateSize(!0,!0),this.fire("set:margin",this._margin)}}),Object.defineProperty(Pv.prototype,"left",{get:function(){return this._margin.x},set:function(t){this._margin.x=t;const e=this.entity.getLocalPosition(),i=this._absRight,n=this._localAnchor.x+t;this._setWidth(i-n),e.x=t+this._calculatedWidth*this._pivot.x,this.entity.setLocalPosition(e)}}),Object.defineProperty(Pv.prototype,"right",{get:function(){return this._margin.z},set:function(t){this._margin.z=t;const e=this.entity.getLocalPosition(),i=this._absLeft,n=this._localAnchor.z-t;this._setWidth(n-i),e.x=this._localAnchor.z-this._localAnchor.x-t-this._calculatedWidth*(1-this._pivot.x),this.entity.setLocalPosition(e)}}),Object.defineProperty(Pv.prototype,"top",{get:function(){return this._margin.w},set:function(t){this._margin.w=t;const e=this.entity.getLocalPosition(),i=this._absBottom,n=this._localAnchor.w-t;this._setHeight(n-i),e.y=this._localAnchor.w-this._localAnchor.y-t-this._calculatedHeight*(1-this._pivot.y),this.entity.setLocalPosition(e)}}),Object.defineProperty(Pv.prototype,"bottom",{get:function(){return this._margin.y},set:function(t){this._margin.y=t;const e=this.entity.getLocalPosition(),i=this._absTop,n=this._localAnchor.y+t;this._setHeight(i-n),e.y=t+this._calculatedHeight*this._pivot.y,this.entity.setLocalPosition(e)}}),Object.defineProperty(Pv.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._hasSplitAnchorsX||this._setCalculatedWidth(t,!0),this.fire("set:width",this._width)}}),Object.defineProperty(Pv.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._hasSplitAnchorsY||this._setCalculatedHeight(t,!0),this.fire("set:height",this._height)}}),Object.defineProperty(Pv.prototype,"calculatedWidth",{get:function(){return this._calculatedWidth},set:function(t){this._setCalculatedWidth(t,!0)}}),Object.defineProperty(Pv.prototype,"calculatedHeight",{get:function(){return this._calculatedHeight},set:function(t){this._setCalculatedHeight(t,!0)}}),Object.defineProperty(Pv.prototype,"pivot",{get:function(){return this._pivot},set:function(t){const e=this._pivot.x,i=this._pivot.y;t instanceof _t?this._pivot.set(t.x,t.y):this._pivot.set(t[0],t[1]);const n=this._margin.x+this._margin.z,s=this._pivot.x-e;this._margin.x+=n*s,this._margin.z-=n*s;const r=this._margin.y+this._margin.w,o=this._pivot.y-i;this._margin.y+=r*o,this._margin.w-=r*o,this._anchorDirty=!0,this._cornersDirty=!0,this._worldCornersDirty=!0,this._calculateSize(!1,!1),this._flagChildrenAsDirty(),this.fire("set:pivot",this._pivot)}}),Object.defineProperty(Pv.prototype,"anchor",{get:function(){return this._anchor},set:function(t){t instanceof ut?this._anchor.set(t.x,t.y,t.z,t.w):this._anchor.set(t[0],t[1],t[2],t[3]),this.entity._parent||this.screen?this._calculateSize(this._hasSplitAnchorsX,this._hasSplitAnchorsY):this._calculateLocalAnchors(),this._anchorDirty=!0,this.entity._dirtyLocal||this.entity._dirtifyLocal(),this.fire("set:anchor",this._anchor)}}),Object.defineProperty(Pv.prototype,"_hasSplitAnchorsX",{get:function(){return Math.abs(this._anchor.x-this._anchor.z)>.001}}),Object.defineProperty(Pv.prototype,"_hasSplitAnchorsY",{get:function(){return Math.abs(this._anchor.y-this._anchor.w)>.001}}),Object.defineProperty(Pv.prototype,"aabb",{get:function(){return this._image?this._image.aabb:this._text?this._text.aabb:null}}),Object.defineProperty(Pv.prototype,"screenCorners",{get:function(){if(!this._cornersDirty||!this.screen)return this._screenCorners;const t=this.entity.parent&&this.entity.parent.element&&this.entity.parent.element.screenCorners[0];this._screenCorners[0].set(this._absLeft,this._absBottom,0),this._screenCorners[1].set(this._absRight,this._absBottom,0),this._screenCorners[2].set(this._absRight,this._absTop,0),this._screenCorners[3].set(this._absLeft,this._absTop,0);const e=this.screen.screen.screenSpace;for(let i=0;i<4;i++)this._screenTransform.transformPoint(this._screenCorners[i],this._screenCorners[i]),e&&this._screenCorners[i].mulScalar(this.screen.screen.scale),t&&this._screenCorners[i].add(t);return this._cornersDirty=!1,this._canvasCornersDirty=!0,this._worldCornersDirty=!0,this._screenCorners}}),Object.defineProperty(Pv.prototype,"canvasCorners",{get:function(){if(!this._canvasCornersDirty||!this.screen||!this.screen.screen.screenSpace)return this._canvasCorners;const t=this.system.app.graphicsDevice,e=this.screenCorners,i=t.canvas.clientWidth/t.width,n=t.canvas.clientHeight/t.height;for(let s=0;s<4;s++)this._canvasCorners[s].set(e[s].x*i,(t.height-e[s].y)*n);return this._canvasCornersDirty=!1,this._canvasCorners}}),Object.defineProperty(Pv.prototype,"worldCorners",{get:function(){if(!this._worldCornersDirty)return this._worldCorners;if(this.screen){const t=this.screenCorners;if(!this.screen.screen.screenSpace){Ev.copy(this.screen.screen._screenMatrix),Ev.data[13]=-Ev.data[13],Ev.mul2(this.screen.getWorldTransform(),Ev);for(let e=0;e<4;e++)Ev.transformPoint(t[e],this._worldCorners[e])}}else{const t=this.entity.getLocalPosition();Ev.setTranslate(-t.x,-t.y,-t.z),Mv.setTRS(ht.ZERO,this.entity.getLocalRotation(),this.entity.getLocalScale()),Rv.setTranslate(t.x,t.y,t.z);const e=this.entity.parent?this.entity.parent:this.entity;Iv.copy(e.getWorldTransform()),Iv.mul(Rv).mul(Mv).mul(Ev),Tv.set(t.x-this.pivot.x*this.calculatedWidth,t.y-this.pivot.y*this.calculatedHeight,t.z),Iv.transformPoint(Tv,this._worldCorners[0]),Tv.set(t.x+(1-this.pivot.x)*this.calculatedWidth,t.y-this.pivot.y*this.calculatedHeight,t.z),Iv.transformPoint(Tv,this._worldCorners[1]),Tv.set(t.x+(1-this.pivot.x)*this.calculatedWidth,t.y+(1-this.pivot.y)*this.calculatedHeight,t.z),Iv.transformPoint(Tv,this._worldCorners[2]),Tv.set(t.x-this.pivot.x*this.calculatedWidth,t.y+(1-this.pivot.y)*this.calculatedHeight,t.z),Iv.transformPoint(Tv,this._worldCorners[3])}return this._worldCornersDirty=!1,this._worldCorners}}),Object.defineProperty(Pv.prototype,"textWidth",{get:function(){return this._text?this._text.width:0}}),Object.defineProperty(Pv.prototype,"textHeight",{get:function(){return this._text?this._text.height:0}}),Object.defineProperty(Pv.prototype,"useInput",{get:function(){return this._useInput},set:function(t){this._useInput!==t&&(this._useInput=t,this.system.app.elementInput?t?this.enabled&&this.entity.enabled&&this.system.app.elementInput.addElement(this):this.system.app.elementInput.removeElement(this):!0===this._useInput&&console.warn("Elements will not get any input events because this.system.app.elementInput is not created"),this.fire("set:useInput",t))}}),Object.defineProperty(Pv.prototype,"batchGroupId",{get:function(){return this._batchGroupId},set:function(t){this._batchGroupId!==t&&(this.entity.enabled&&this._batchGroupId>=0&&this.system.app.batcher.remove(Nh.ELEMENT,this.batchGroupId,this.entity),this.entity.enabled&&t>=0&&this.system.app.batcher.insert(Nh.ELEMENT,t,this.entity),t<0&&this._batchGroupId>=0&&this.enabled&&this.entity.enabled&&(this._image&&this._image._renderable.model?this.addModelToLayers(this._image._renderable.model):this._text&&this._text._model&&this.addModelToLayers(this._text._model)),this._batchGroupId=t)}}),Object.defineProperty(Pv.prototype,"maskedBy",{get:function(){return this._maskedBy}}),Lv("fontSize"),Lv("minFontSize"),Lv("maxFontSize"),Lv("maxLines"),Lv("autoFitWidth"),Lv("autoFitHeight"),Lv("color"),Lv("font"),Lv("fontAsset"),Lv("spacing"),Lv("lineHeight"),Lv("wrapLines"),Lv("lines"),Lv("alignment"),Lv("autoWidth"),Lv("autoHeight"),Lv("rtlReorder"),Lv("unicodeConverter"),Lv("text"),Lv("key"),Lv("texture"),Lv("textureAsset"),Lv("material"),Lv("materialAsset"),Lv("sprite"),Lv("spriteAsset"),Lv("spriteFrame"),Lv("pixelsPerUnit"),Lv("opacity"),Lv("rect"),Lv("mask"),Lv("outlineColor"),Lv("outlineThickness"),Lv("shadowColor"),Lv("shadowOffset"),Lv("enableMarkup"),Lv("rangeStart"),Lv("rangeEnd");class Dv{constructor(){this.enabled=!0}}const kv=["enabled"];class Ov extends bg{constructor(t){super(t),this.id="element",this.ComponentType=Pv,this.DataType=Dv,this.schema=kv,this._unicodeConverter=null,this._rtlReorder=null,this._defaultTexture=new _a(t.graphicsDevice,{width:1,height:1,format:ys}),this._defaultTexture.name="element-system";const e=this._defaultTexture.lock(),i=new Uint8Array(4);i[0]=255,i[1]=255,i[2]=255,i[3]=255,e.set(i),this._defaultTexture.unlock(),this.defaultImageMaterial=null,this.defaultImage9SlicedMaterial=null,this.defaultImage9TiledMaterial=null,this.defaultImageMaskMaterial=null,this.defaultImage9SlicedMaskMaterial=null,this.defaultImage9TiledMaskMaterial=null,this.defaultScreenSpaceImageMaterial=null,this.defaultScreenSpaceImage9SlicedMaterial=null,this.defaultScreenSpaceImage9TiledMaterial=null,this.defaultScreenSpaceImageMask9SlicedMaterial=null,this.defaultScreenSpaceImageMask9TiledMaterial=null,this.defaultScreenSpaceImageMaskMaterial=null,this.defaultTextMaterial=null,this.defaultBitmapTextMaterial=null,this.defaultScreenSpaceTextMaterial=null,this.defaultScreenSpaceBitmapTextMaterial=null,this.defaultImageMaterials=[],this.on("beforeremove",this.onRemoveComponent,this)}destroy(){super.destroy(),this._defaultTexture.destroy()}initializeComponentData(t,e,i){t._beingInitialized=!0,void 0!==e.anchor&&(e.anchor instanceof ut?t.anchor.copy(e.anchor):t.anchor.set(e.anchor[0],e.anchor[1],e.anchor[2],e.anchor[3])),void 0!==e.pivot&&(e.pivot instanceof _t?t.pivot.copy(e.pivot):t.pivot.set(e.pivot[0],e.pivot[1]));const n=Math.abs(t.anchor.x-t.anchor.z)>.001,s=Math.abs(t.anchor.y-t.anchor.w)>.001;let r,o=!1;void 0!==e.margin&&(e.margin instanceof ut?t.margin.copy(e.margin):t._margin.set(e.margin[0],e.margin[1],e.margin[2],e.margin[3]),o=!0),void 0!==e.left&&(t._margin.x=e.left,o=!0),void 0!==e.bottom&&(t._margin.y=e.bottom,o=!0),void 0!==e.right&&(t._margin.z=e.right,o=!0),void 0!==e.top&&(t._margin.w=e.top,o=!0),o&&(t.margin=t._margin);let a=!1;void 0===e.width||n?n&&(a=!0):t.width=e.width,void 0===e.height||s?s&&(a=!0):t.height=e.height,a&&(t.anchor=t.anchor),void 0!==e.enabled&&(t.enabled=e.enabled),void 0!==e.useInput&&(t.useInput=e.useInput),t.batchGroupId=void 0===e.batchGroupId||null===e.batchGroupId?-1:e.batchGroupId,e.layers&&Array.isArray(e.layers)&&(t.layers=e.layers.slice(0)),void 0!==e.type&&(t.type=e.type),t.type===ev?(void 0!==e.rect&&(t.rect=e.rect),void 0!==e.color&&(r=e.color,r instanceof rt||(r=new rt(e.color[0],e.color[1],e.color[2])),t.color=r),void 0!==e.opacity&&(t.opacity=e.opacity),void 0!==e.textureAsset&&(t.textureAsset=e.textureAsset),e.texture&&(t.texture=e.texture),void 0!==e.spriteAsset&&(t.spriteAsset=e.spriteAsset),e.sprite&&(t.sprite=e.sprite),void 0!==e.spriteFrame&&(t.spriteFrame=e.spriteFrame),void 0!==e.pixelsPerUnit&&null!==e.pixelsPerUnit&&(t.pixelsPerUnit=e.pixelsPerUnit),void 0!==e.materialAsset&&(t.materialAsset=e.materialAsset),e.material&&(t.material=e.material),void 0!==e.mask&&(t.mask=e.mask)):t.type===iv&&(void 0!==e.autoWidth&&(t.autoWidth=e.autoWidth),void 0!==e.autoHeight&&(t.autoHeight=e.autoHeight),void 0!==e.rtlReorder&&(t.rtlReorder=e.rtlReorder),void 0!==e.unicodeConverter&&(t.unicodeConverter=e.unicodeConverter),null!==e.text&&void 0!==e.text?t.text=e.text:null!==e.key&&void 0!==e.key&&(t.key=e.key),void 0!==e.color&&(r=e.color,r instanceof rt||(r=new rt(r[0],r[1],r[2])),t.color=r),void 0!==e.opacity&&(t.opacity=e.opacity),void 0!==e.spacing&&(t.spacing=e.spacing),void 0!==e.fontSize&&(t.fontSize=e.fontSize,e.lineHeight||(t.lineHeight=e.fontSize)),void 0!==e.lineHeight&&(t.lineHeight=e.lineHeight),void 0!==e.maxLines&&(t.maxLines=e.maxLines),void 0!==e.wrapLines&&(t.wrapLines=e.wrapLines),void 0!==e.minFontSize&&(t.minFontSize=e.minFontSize),void 0!==e.maxFontSize&&(t.maxFontSize=e.maxFontSize),e.autoFitWidth&&(t.autoFitWidth=e.autoFitWidth),e.autoFitHeight&&(t.autoFitHeight=e.autoFitHeight),void 0!==e.fontAsset&&(t.fontAsset=e.fontAsset),void 0!==e.font&&(t.font=e.font),void 0!==e.alignment&&(t.alignment=e.alignment),void 0!==e.outlineColor&&(t.outlineColor=e.outlineColor),void 0!==e.outlineThickness&&(t.outlineThickness=e.outlineThickness),void 0!==e.shadowColor&&(t.shadowColor=e.shadowColor),void 0!==e.shadowOffset&&(t.shadowOffset=e.shadowOffset),void 0!==e.enableMarkup&&(t.enableMarkup=e.enableMarkup));const l=t._parseUpToScreen();l.screen&&t._updateScreen(l.screen),super.initializeComponentData(t,e,i),t._beingInitialized=!1,t.type===ev&&t._image._meshDirty&&t._image._updateMesh(t._image.mesh)}onRemoveComponent(t,e){e.onRemove()}cloneComponent(t,e){const i=t.element,n={enabled:i.enabled,width:i.width,height:i.height,anchor:i.anchor.clone(),pivot:i.pivot.clone(),margin:i.margin.clone(),alignment:i.alignment&&i.alignment.clone()||i.alignment,autoWidth:i.autoWidth,autoHeight:i.autoHeight,type:i.type,rect:i.rect&&i.rect.clone()||i.rect,rtlReorder:i.rtlReorder,unicodeConverter:i.unicodeConverter,materialAsset:i.materialAsset,material:i.material,color:i.color&&i.color.clone()||i.color,opacity:i.opacity,textureAsset:i.textureAsset,texture:i.texture,spriteAsset:i.spriteAsset,sprite:i.sprite,spriteFrame:i.spriteFrame,pixelsPerUnit:i.pixelsPerUnit,spacing:i.spacing,lineHeight:i.lineHeight,wrapLines:i.wrapLines,layers:i.layers,fontSize:i.fontSize,minFontSize:i.minFontSize,maxFontSize:i.maxFontSize,autoFitWidth:i.autoFitWidth,autoFitHeight:i.autoFitHeight,maxLines:i.maxLines,fontAsset:i.fontAsset,font:i.font,useInput:i.useInput,batchGroupId:i.batchGroupId,mask:i.mask,outlineColor:i.outlineColor&&i.outlineColor.clone()||i.outlineColor,outlineThickness:i.outlineThickness,shadowColor:i.shadowColor&&i.shadowColor.clone()||i.shadowColor,shadowOffset:i.shadowOffset&&i.shadowOffset.clone()||i.shadowOffset,enableMarkup:i.enableMarkup};return void 0!==i.key&&null!==i.key?n.key=i.key:n.text=i.text,this.addComponent(e,n)}getTextElementMaterial(t,e){return t?e?(this.defaultScreenSpaceTextMaterial||(this.defaultScreenSpaceTextMaterial=new wl,this.defaultScreenSpaceTextMaterial.name="defaultScreenSpaceTextMaterial",this.defaultScreenSpaceTextMaterial.msdfMap=this._defaultTexture,this.defaultScreenSpaceTextMaterial.useLighting=!1,this.defaultScreenSpaceTextMaterial.useGammaTonemap=!1,this.defaultScreenSpaceTextMaterial.useFog=!1,this.defaultScreenSpaceTextMaterial.useSkybox=!1,this.defaultScreenSpaceTextMaterial.diffuse.set(0,0,0),this.defaultScreenSpaceTextMaterial.emissive.set(1,1,1),this.defaultScreenSpaceTextMaterial.opacity=.5,this.defaultScreenSpaceTextMaterial.blendType=Dt,this.defaultScreenSpaceTextMaterial.depthWrite=!1,this.defaultScreenSpaceTextMaterial.depthTest=!1,this.defaultScreenSpaceTextMaterial.emissiveVertexColor=!0,this.defaultScreenSpaceTextMaterial.update()),this.defaultScreenSpaceTextMaterial):(this.defaultScreenSpaceBitmapTextMaterial||(this.defaultScreenSpaceBitmapTextMaterial=new wl,this.defaultScreenSpaceBitmapTextMaterial.name="defaultScreenSpaceBitmapTextMaterial",this.defaultScreenSpaceBitmapTextMaterial.emissive.set(.5,.5,.5),this.defaultScreenSpaceBitmapTextMaterial.emissiveMap=this._defaultTexture,this.defaultScreenSpaceBitmapTextMaterial.emissiveTint=!0,this.defaultScreenSpaceBitmapTextMaterial.opacity=.5,this.defaultScreenSpaceBitmapTextMaterial.opacityMap=this._defaultTexture,this.defaultScreenSpaceBitmapTextMaterial.opacityMapChannel="a",this.defaultScreenSpaceBitmapTextMaterial.useLighting=!1,this.defaultScreenSpaceBitmapTextMaterial.useGammaTonemap=!1,this.defaultScreenSpaceBitmapTextMaterial.useFog=!1,this.defaultScreenSpaceBitmapTextMaterial.useSkybox=!1,this.defaultScreenSpaceBitmapTextMaterial.diffuse.set(0,0,0),this.defaultScreenSpaceBitmapTextMaterial.blendType=Dt,this.defaultScreenSpaceBitmapTextMaterial.depthWrite=!1,this.defaultScreenSpaceBitmapTextMaterial.depthTest=!1,this.defaultScreenSpaceBitmapTextMaterial.emissiveVertexColor=!0,this.defaultScreenSpaceBitmapTextMaterial.update()),this.defaultScreenSpaceBitmapTextMaterial):e?(this.defaultTextMaterial||(this.defaultTextMaterial=new wl,this.defaultTextMaterial.name="defaultTextMaterial",this.defaultTextMaterial.msdfMap=this._defaultTexture,this.defaultTextMaterial.useLighting=!1,this.defaultTextMaterial.useGammaTonemap=!1,this.defaultTextMaterial.useFog=!1,this.defaultTextMaterial.useSkybox=!1,this.defaultTextMaterial.diffuse.set(0,0,0),this.defaultTextMaterial.emissive.set(1,1,1),this.defaultTextMaterial.opacity=.5,this.defaultTextMaterial.blendType=Dt,this.defaultTextMaterial.depthWrite=!1,this.defaultTextMaterial.emissiveVertexColor=!0,this.defaultTextMaterial.update()),this.defaultTextMaterial):(this.defaultBitmapTextMaterial||(this.defaultBitmapTextMaterial=new wl,this.defaultBitmapTextMaterial.name="defaultBitmapTextMaterial",this.defaultBitmapTextMaterial.emissive.set(.5,.5,.5),this.defaultBitmapTextMaterial.emissiveTint=!0,this.defaultBitmapTextMaterial.emissiveMap=this._defaultTexture,this.defaultBitmapTextMaterial.opacity=.5,this.defaultBitmapTextMaterial.opacityMap=this._defaultTexture,this.defaultBitmapTextMaterial.opacityMapChannel="a",this.defaultBitmapTextMaterial.useLighting=!1,this.defaultBitmapTextMaterial.useGammaTonemap=!1,this.defaultBitmapTextMaterial.useFog=!1,this.defaultBitmapTextMaterial.useSkybox=!1,this.defaultBitmapTextMaterial.diffuse.set(0,0,0),this.defaultBitmapTextMaterial.blendType=Dt,this.defaultBitmapTextMaterial.depthWrite=!1,this.defaultBitmapTextMaterial.emissiveVertexColor=!0,this.defaultBitmapTextMaterial.update()),this.defaultBitmapTextMaterial)}_createBaseImageMaterial(){const t=new wl;return t.diffuse.set(0,0,0),t.emissive.set(.5,.5,.5),t.emissiveMap=this._defaultTexture,t.emissiveTint=!0,t.opacityMap=this._defaultTexture,t.opacityMapChannel="a",t.opacityTint=!0,t.opacity=0,t.useLighting=!1,t.useGammaTonemap=!1,t.useFog=!1,t.useSkybox=!1,t.blendType=Dt,t.depthWrite=!1,t}getImageElementMaterial(t,e,i,n){return t?e?i?(this.defaultScreenSpaceImageMask9SlicedMaterial||(this.defaultScreenSpaceImageMask9SlicedMaterial=this._createBaseImageMaterial(),this.defaultScreenSpaceImageMask9SlicedMaterial.name="defaultScreenSpaceImageMask9SlicedMaterial",this.defaultScreenSpaceImageMask9SlicedMaterial.nineSlicedMode=Oi,this.defaultScreenSpaceImageMask9SlicedMaterial.depthTest=!1,this.defaultScreenSpaceImageMask9SlicedMaterial.alphaTest=1,this.defaultScreenSpaceImageMask9SlicedMaterial.redWrite=!1,this.defaultScreenSpaceImageMask9SlicedMaterial.greenWrite=!1,this.defaultScreenSpaceImageMask9SlicedMaterial.blueWrite=!1,this.defaultScreenSpaceImageMask9SlicedMaterial.alphaWrite=!1,this.defaultScreenSpaceImageMask9SlicedMaterial.update(),this.defaultImageMaterials.push(this.defaultScreenSpaceImageMask9SlicedMaterial)),this.defaultScreenSpaceImageMask9SlicedMaterial):n?(this.defaultScreenSpaceImageMask9TiledMaterial||(this.defaultScreenSpaceImageMask9TiledMaterial=this.defaultScreenSpaceImage9TiledMaterial.clone(),this.defaultScreenSpaceImageMask9TiledMaterial.name="defaultScreenSpaceImageMask9TiledMaterial",this.defaultScreenSpaceImageMask9TiledMaterial.nineSlicedMode=Fi,this.defaultScreenSpaceImageMask9TiledMaterial.depthTest=!1,this.defaultScreenSpaceImageMask9TiledMaterial.alphaTest=1,this.defaultScreenSpaceImageMask9TiledMaterial.redWrite=!1,this.defaultScreenSpaceImageMask9TiledMaterial.greenWrite=!1,this.defaultScreenSpaceImageMask9TiledMaterial.blueWrite=!1,this.defaultScreenSpaceImageMask9TiledMaterial.alphaWrite=!1,this.defaultScreenSpaceImageMask9TiledMaterial.update(),this.defaultImageMaterials.push(this.defaultScreenSpaceImageMask9TiledMaterial)),this.defaultScreenSpaceImageMask9TiledMaterial):(this.defaultScreenSpaceImageMaskMaterial||(this.defaultScreenSpaceImageMaskMaterial=this._createBaseImageMaterial(),this.defaultScreenSpaceImageMaskMaterial.name="defaultScreenSpaceImageMaskMaterial",this.defaultScreenSpaceImageMaskMaterial.depthTest=!1,this.defaultScreenSpaceImageMaskMaterial.alphaTest=1,this.defaultScreenSpaceImageMaskMaterial.redWrite=!1,this.defaultScreenSpaceImageMaskMaterial.greenWrite=!1,this.defaultScreenSpaceImageMaskMaterial.blueWrite=!1,this.defaultScreenSpaceImageMaskMaterial.alphaWrite=!1,this.defaultScreenSpaceImageMaskMaterial.update(),this.defaultImageMaterials.push(this.defaultScreenSpaceImageMaskMaterial)),this.defaultScreenSpaceImageMaskMaterial):i?(this.defaultScreenSpaceImage9SlicedMaterial||(this.defaultScreenSpaceImage9SlicedMaterial=this._createBaseImageMaterial(),this.defaultScreenSpaceImage9SlicedMaterial.name="defaultScreenSpaceImage9SlicedMaterial",this.defaultScreenSpaceImage9SlicedMaterial.nineSlicedMode=Oi,this.defaultScreenSpaceImage9SlicedMaterial.depthTest=!1,this.defaultScreenSpaceImage9SlicedMaterial.update(),this.defaultImageMaterials.push(this.defaultScreenSpaceImage9SlicedMaterial)),this.defaultScreenSpaceImage9SlicedMaterial):n?(this.defaultScreenSpaceImage9TiledMaterial||(this.defaultScreenSpaceImage9TiledMaterial=this._createBaseImageMaterial(),this.defaultScreenSpaceImage9TiledMaterial.name="defaultScreenSpaceImage9TiledMaterial",this.defaultScreenSpaceImage9TiledMaterial.nineSlicedMode=Fi,this.defaultScreenSpaceImage9TiledMaterial.depthTest=!1,this.defaultScreenSpaceImage9TiledMaterial.update(),this.defaultImageMaterials.push(this.defaultScreenSpaceImage9TiledMaterial)),this.defaultScreenSpaceImage9TiledMaterial):(this.defaultScreenSpaceImageMaterial||(this.defaultScreenSpaceImageMaterial=this._createBaseImageMaterial(),this.defaultScreenSpaceImageMaterial.name="defaultScreenSpaceImageMaterial",this.defaultScreenSpaceImageMaterial.depthTest=!1,this.defaultScreenSpaceImageMaterial.update(),this.defaultImageMaterials.push(this.defaultScreenSpaceImageMaterial)),this.defaultScreenSpaceImageMaterial):e?i?(this.defaultImage9SlicedMaskMaterial||(this.defaultImage9SlicedMaskMaterial=this._createBaseImageMaterial(),this.defaultImage9SlicedMaskMaterial.name="defaultImage9SlicedMaskMaterial",this.defaultImage9SlicedMaskMaterial.nineSlicedMode=Oi,this.defaultImage9SlicedMaskMaterial.alphaTest=1,this.defaultImage9SlicedMaskMaterial.redWrite=!1,this.defaultImage9SlicedMaskMaterial.greenWrite=!1,this.defaultImage9SlicedMaskMaterial.blueWrite=!1,this.defaultImage9SlicedMaskMaterial.alphaWrite=!1,this.defaultImage9SlicedMaskMaterial.update(),this.defaultImageMaterials.push(this.defaultImage9SlicedMaskMaterial)),this.defaultImage9SlicedMaskMaterial):n?(this.defaultImage9TiledMaskMaterial||(this.defaultImage9TiledMaskMaterial=this._createBaseImageMaterial(),this.defaultImage9TiledMaskMaterial.name="defaultImage9TiledMaskMaterial",this.defaultImage9TiledMaskMaterial.nineSlicedMode=Fi,this.defaultImage9TiledMaskMaterial.alphaTest=1,this.defaultImage9TiledMaskMaterial.redWrite=!1,this.defaultImage9TiledMaskMaterial.greenWrite=!1,this.defaultImage9TiledMaskMaterial.blueWrite=!1,this.defaultImage9TiledMaskMaterial.alphaWrite=!1,this.defaultImage9TiledMaskMaterial.update(),this.defaultImageMaterials.push(this.defaultImage9TiledMaskMaterial)),this.defaultImage9TiledMaskMaterial):(this.defaultImageMaskMaterial||(this.defaultImageMaskMaterial=this._createBaseImageMaterial(),this.defaultImageMaskMaterial.name="defaultImageMaskMaterial",this.defaultImageMaskMaterial.alphaTest=1,this.defaultImageMaskMaterial.redWrite=!1,this.defaultImageMaskMaterial.greenWrite=!1,this.defaultImageMaskMaterial.blueWrite=!1,this.defaultImageMaskMaterial.alphaWrite=!1,this.defaultImageMaskMaterial.update(),this.defaultImageMaterials.push(this.defaultImageMaskMaterial)),this.defaultImageMaskMaterial):i?(this.defaultImage9SlicedMaterial||(this.defaultImage9SlicedMaterial=this._createBaseImageMaterial(),this.defaultImage9SlicedMaterial.name="defaultImage9SlicedMaterial",this.defaultImage9SlicedMaterial.nineSlicedMode=Oi,this.defaultImage9SlicedMaterial.update(),this.defaultImageMaterials.push(this.defaultImage9SlicedMaterial)),this.defaultImage9SlicedMaterial):n?(this.defaultImage9TiledMaterial||(this.defaultImage9TiledMaterial=this._createBaseImageMaterial(),this.defaultImage9TiledMaterial.name="defaultImage9TiledMaterial",this.defaultImage9TiledMaterial.nineSlicedMode=Fi,this.defaultImage9TiledMaterial.update(),this.defaultImageMaterials.push(this.defaultImage9TiledMaterial)),this.defaultImage9TiledMaterial):(this.defaultImageMaterial||(this.defaultImageMaterial=this._createBaseImageMaterial(),this.defaultImageMaterial.name="defaultImageMaterial",this.defaultImageMaterial.update(),this.defaultImageMaterials.push(this.defaultImageMaterial)),this.defaultImageMaterial)}registerUnicodeConverter(t){this._unicodeConverter=t}registerRtlReorder(t){this._rtlReorder=t}getUnicodeConverter(){return this._unicodeConverter}getRtlReorder(){return this._rtlReorder}}gg._buildAccessors(Pv.prototype,kv);const Fv="free",Bv="limited",Nv="locked",Uv=["angularDampingX","angularDampingY","angularDampingZ","angularEquilibriumX","angularEquilibriumY","angularEquilibriumZ","angularLimitsX","angularLimitsY","angularLimitsZ","angularMotionX","angularMotionY","angularMotionZ","angularSpringX","angularSpringY","angularSpringZ","angularStiffnessX","angularStiffnessY","angularStiffnessZ","breakForce","enableCollision","enabled","entityA","entityB","linearDampingX","linearDampingY","linearDampingZ","linearEquilibriumX","linearEquilibriumY","linearEquilibriumZ","linearLimitsX","linearLimitsY","linearLimitsZ","linearMotionX","linearMotionY","linearMotionZ","linearSpringX","linearSpringY","linearSpringZ","linearStiffnessX","linearStiffnessY","linearStiffnessZ"];class Vv extends gg{constructor(t,e){super(t,e),this._constraint=null,this._entityA=null,this._entityB=null,this._breakForce=34e37,this._enableCollision=!0,this._linearMotionX=Nv,this._linearLimitsX=new _t(0,0),this._linearSpringX=!1,this._linearStiffnessX=0,this._linearDampingX=1,this._linearEquilibriumX=0,this._linearMotionY=Nv,this._linearLimitsY=new _t(0,0),this._linearSpringY=!1,this._linearStiffnessY=0,this._linearDampingY=1,this._linearEquilibriumY=0,this._linearMotionZ=Nv,this._linearLimitsZ=new _t(0,0),this._linearSpringZ=!1,this._linearStiffnessZ=0,this._linearDampingZ=1,this._linearEquilibriumZ=0,this._angularMotionX=Nv,this._angularLimitsX=new _t(0,0),this._angularSpringX=!1,this._angularStiffnessX=0,this._angularDampingX=1,this._angularEquilibriumX=0,this._angularMotionY=Nv,this._angularLimitsY=new _t(0,0),this._angularSpringY=!1,this._angularStiffnessY=0,this._angularDampingY=1,this._angularEquilibriumY=0,this._angularMotionZ=Nv,this._angularLimitsZ=new _t(0,0),this._angularSpringZ=!1,this._angularEquilibriumZ=0,this._angularDampingZ=1,this._angularStiffnessZ=0,this.on("set_enabled",this._onSetEnabled,this)}set entityA(t){this._destroyConstraint(),this._entityA=t,this._createConstraint()}get entityA(){return this._entityA}set entityB(t){this._destroyConstraint(),this._entityB=t,this._createConstraint()}get entityB(){return this._entityB}set breakForce(t){this._constraint&&this._breakForce!==t&&(this._constraint.setBreakingImpulseThreshold(t),this._breakForce=t)}get breakForce(){return this._breakForce}set enableCollision(t){this._destroyConstraint(),this._enableCollision=t,this._createConstraint()}get enableCollision(){return this._enableCollision}set angularLimitsX(t){this._angularLimitsX.equals(t)||(this._angularLimitsX.copy(t),this._updateAngularLimits())}get angularLimitsX(){return this._angularLimitsX}set angularMotionX(t){this._angularMotionX!==t&&(this._angularMotionX=t,this._updateAngularLimits())}get angularMotionX(){return this._angularMotionX}set angularLimitsY(t){this._angularLimitsY.equals(t)||(this._angularLimitsY.copy(t),this._updateAngularLimits())}get angularLimitsY(){return this._angularLimitsY}set angularMotionY(t){this._angularMotionY!==t&&(this._angularMotionY=t,this._updateAngularLimits())}get angularMotionY(){return this._angularMotionY}set angularLimitsZ(t){this._angularLimitsZ.equals(t)||(this._angularLimitsZ.copy(t),this._updateAngularLimits())}get angularLimitsZ(){return this._angularLimitsZ}set angularMotionZ(t){this._angularMotionZ!==t&&(this._angularMotionZ=t,this._updateAngularLimits())}get angularMotionZ(){return this._angularMotionZ}set linearLimitsX(t){this._linearLimitsX.equals(t)||(this._linearLimitsX.copy(t),this._updateLinearLimits())}get linearLimitsX(){return this._linearLimitsX}set linearMotionX(t){this._linearMotionX!==t&&(this._linearMotionX=t,this._updateLinearLimits())}get linearMotionX(){return this._linearMotionX}set linearLimitsY(t){this._linearLimitsY.equals(t)||(this._linearLimitsY.copy(t),this._updateLinearLimits())}get linearLimitsY(){return this._linearLimitsY}set linearMotionY(t){this._linearMotionY!==t&&(this._linearMotionY=t,this._updateLinearLimits())}get linearMotionY(){return this._linearMotionY}set linearLimitsZ(t){this._linearLimitsZ.equals(t)||(this._linearLimitsZ.copy(t),this._updateLinearLimits())}get linearLimitsZ(){return this._linearLimitsZ}set linearMotionZ(t){this._linearMotionZ!==t&&(this._linearMotionZ=t,this._updateLinearLimits())}get linearMotionZ(){return this._linearMotionZ}_convertTransform(t,e){const i=t.getTranslation(),n=new yt;n.setFromMat4(t);const s=new Ammo.btVector3(i.x,i.y,i.z),r=new Ammo.btQuaternion(n.x,n.y,n.z,n.w);e.setOrigin(s),e.setRotation(r),Ammo.destroy(s),Ammo.destroy(r)}_updateAngularLimits(){const t=this._constraint;if(t){let e,i,n,s,r,o;this._angularMotionX===Bv?(e=this._angularLimitsX.x*Z.DEG_TO_RAD,s=this._angularLimitsX.y*Z.DEG_TO_RAD):this._angularMotionX===Fv?(e=1,s=0):e=s=0,this._angularMotionY===Bv?(i=this._angularLimitsY.x*Z.DEG_TO_RAD,r=this._angularLimitsY.y*Z.DEG_TO_RAD):this._angularMotionY===Fv?(i=1,r=0):i=r=0,this._angularMotionZ===Bv?(n=this._angularLimitsZ.x*Z.DEG_TO_RAD,o=this._angularLimitsZ.y*Z.DEG_TO_RAD):this._angularMotionZ===Fv?(n=1,o=0):n=o=0;const a=new Ammo.btVector3(e,i,n);t.setAngularLowerLimit(a),a.setValue(s,r,o),t.setAngularUpperLimit(a),Ammo.destroy(a)}}_updateLinearLimits(){const t=this._constraint;if(t){let e,i,n,s,r,o;this._linearMotionX===Bv?(e=this._linearLimitsX.x,s=this._linearLimitsX.y):this._linearMotionX===Fv?(e=1,s=0):e=s=0,this._linearMotionY===Bv?(i=this._linearLimitsY.x,r=this._linearLimitsY.y):this._linearMotionY===Fv?(i=1,r=0):i=r=0,this._linearMotionZ===Bv?(n=this._linearLimitsZ.x,o=this._linearLimitsZ.y):this._linearMotionZ===Fv?(n=1,o=0):n=o=0;const a=new Ammo.btVector3(e,i,n);t.setLinearLowerLimit(a),a.setValue(s,r,o),t.setLinearUpperLimit(a),Ammo.destroy(a)}}_createConstraint(){if(this._entityA&&this._entityA.rigidbody){this._destroyConstraint();const t=new bt,e=this._entityA.rigidbody.body;e.activate();const i=this.entity.getWorldTransform(),n=this._entityA.getWorldTransform().clone().invert();t.mul2(n,i);const s=new Ammo.btTransform;if(this._convertTransform(t,s),this._entityB&&this._entityB.rigidbody){const n=this._entityB.rigidbody.body;n.activate();const r=this._entityB.getWorldTransform().clone().invert();t.mul2(r,i);const o=new Ammo.btTransform;this._convertTransform(t,o),this._constraint=new Ammo.btGeneric6DofSpringConstraint(e,n,s,o,!this._enableCollision),Ammo.destroy(o)}else this._constraint=new Ammo.btGeneric6DofSpringConstraint(e,s,!this._enableCollision);Ammo.destroy(s);const r=["X","Y","Z","X","Y","Z"];for(let t=0;t<6;t++){const e=t<3?"_linear":"_angular";this._constraint.enableSpring(t,this[e+"Spring"+r[t]]),this._constraint.setDamping(t,this[e+"Damping"+r[t]]),this._constraint.setEquilibriumPoint(t,this[e+"Equilibrium"+r[t]]),this._constraint.setStiffness(t,this[e+"Stiffness"+r[t]])}this._constraint.setBreakingImpulseThreshold(this._breakForce),this._updateLinearLimits(),this._updateAngularLimits();this.system.app.systems.rigidbody.dynamicsWorld.addConstraint(this._constraint,!this._enableCollision)}}_destroyConstraint(){if(this._constraint){this.system.app.systems.rigidbody.dynamicsWorld.removeConstraint(this._constraint),Ammo.destroy(this._constraint),this._constraint=null}}initFromData(t){for(const e of Uv)t.hasOwnProperty(e)&&(t[e]instanceof _t?this["_"+e].copy(t[e]):this["_"+e]=t[e]);this._createConstraint()}onEnable(){this._createConstraint()}onDisable(){this._destroyConstraint()}_onSetEnabled(t,e,i){}_onBeforeRemove(){this.fire("remove")}}const zv={Damping:"setDamping",Equilibrium:"setEquilibriumPoint",Spring:"enableSpring",Stiffness:"setStiffness"};["linear","angular"].forEach(t=>{["Damping","Equilibrium","Spring","Stiffness"].forEach(e=>{["X","Y","Z"].forEach(i=>{const n=t+e+i,s="_"+n;let r="linear"===t?0:3;"Y"===i&&(r+=1),"Z"===i&&(r+=2),Object.defineProperty(Vv.prototype,n,{get:function(){return this[s]},set:function(t){this[s]!==t&&(this[s]=t,this._constraint[zv[e]](r,t))}})})})});class Wv{constructor(){this.enabled=!0}}const Gv=["enabled"];class jv extends bg{constructor(t){super(t),this.id="joint",this.app=t,this.ComponentType=Vv,this.DataType=Wv,this.schema=Gv}initializeComponentData(t,e,i){t.initFromData(e)}}gg._buildAccessors(Vv.prototype,Gv);class Hv extends gg{constructor(t,e){super(t,e),this._minWidth=0,this._minHeight=0,this._maxWidth=null,this._maxHeight=null,this._fitWidthProportion=0,this._fitHeightProportion=0,this._excludeFromLayout=!1}}function Xv(t){const e="_"+t;Object.defineProperty(Hv.prototype,t,{get:function(){return this[e]},set:function(t){this[e]!==t&&(this[e]=t,this.fire("resize"))}})}Xv("minWidth"),Xv("minHeight"),Xv("maxWidth"),Xv("maxHeight"),Xv("fitWidthProportion"),Xv("fitHeightProportion"),Xv("excludeFromLayout");class Yv{constructor(){this.enabled=!0}}const qv=["enabled"];class Kv extends bg{constructor(t){super(t),this.id="layoutchild",this.ComponentType=Hv,this.DataType=Yv,this.schema=qv}initializeComponentData(t,e,i){void 0!==e.enabled&&(t.enabled=e.enabled),void 0!==e.minWidth&&(t.minWidth=e.minWidth),void 0!==e.minHeight&&(t.minHeight=e.minHeight),void 0!==e.maxWidth&&(t.maxWidth=e.maxWidth),void 0!==e.maxHeight&&(t.maxHeight=e.maxHeight),void 0!==e.fitWidthProportion&&(t.fitWidthProportion=e.fitWidthProportion),void 0!==e.fitHeightProportion&&(t.fitHeightProportion=e.fitHeightProportion),void 0!==e.excludeFromLayout&&(t.excludeFromLayout=e.excludeFromLayout),super.initializeComponentData(t,e,i)}cloneComponent(t,e){const i=t.layoutchild;return this.addComponent(e,{enabled:i.enabled,minWidth:i.minWidth,minHeight:i.minHeight,maxWidth:i.maxWidth,maxHeight:i.maxHeight,fitWidthProportion:i.fitWidthProportion,fitHeightProportion:i.fitHeightProportion,excludeFromLayout:i.excludeFromLayout})}}gg._buildAccessors(Hv.prototype,qv);const Zv=0,Qv=1,$v=2,Jv=3,tS={};tS[tn]={axis:"x",size:"width",calculatedSize:"calculatedWidth",minSize:"minWidth",maxSize:"maxWidth",fitting:"widthFitting",fittingProportion:"fitWidthProportion"},tS[en]={axis:"y",size:"height",calculatedSize:"calculatedHeight",minSize:"minHeight",maxSize:"maxHeight",fitting:"heightFitting",fittingProportion:"fitHeightProportion"};const eS={};eS[tn]=en,eS[en]=tn;const iS={minWidth:0,minHeight:0,maxWidth:Number.POSITIVE_INFINITY,maxHeight:Number.POSITIVE_INFINITY,width:null,height:null,fitWidthProportion:0,fitHeightProportion:0},nS="NONE",sS="APPLY_STRETCHING",rS="APPLY_SHRINKING",oS=new _t;function aS(t){let e;const i=tS[t],n=tS[eS[t]];function s(t,e){return-e[i.size]*t.pivot[i.axis]}function r(t,e){return-e[n.size]*t.pivot[n.axis]}function o(t,e){return e[i.size]*(1-t.pivot[i.axis])}function a(t){const e=t.entity.layoutchild;return!e||!e.enabled||!e.excludeFromLayout}function l(t,e,i){switch(t){case Zv:return nS;case Qv:return e<i?sS:nS;case $v:return e>=i?rS:nS;case Jv:return e<i?sS:e>=i?rS:nS;default:throw new Error("Unrecognized fitting mode: "+t)}}function h(t,i){return m(t,i.size)+(t.length-1)*e.spacing[i.axis]}function c(t,e,i){const n=b(t,i.maxSize),s=g(t,i.fittingProportion),r=S(s,n);let o=oS[i.axis]-e;for(let e=0;e<t.length;++e){const a=n[e],l=u(a,o,s,r),h=t[a][i.size]+l,c=t[a][i.maxSize],_=Math.min(h,c);t[a][i.size]=_;o-=l-Math.max(h-_,0)}}function _(t,e,i){const n=b(t,i.minSize,!0),s=function(t){if(1===t.length)return[1];const e=[],i=t.length;for(let n=0;n<i;++n)e.push((1-t[n])/(i-1));return e}(g(t,i.fittingProportion)),r=S(s,n);let o=e-oS[i.axis];for(let e=0;e<t.length;++e){const a=n[e],l=u(a,o,s,r),h=t[a][i.size]-l,c=t[a][i.minSize],_=Math.max(h,c);t[a][i.size]=_;o-=l-Math.max(_-h,0)}}function u(t,e,i,n){const s=i[t],r=n[t];return Math.abs(s)<1e-5&&Math.abs(r)<1e-5?e:e*s/r}function d(t){const e=[];for(let i=0;i<t.length;++i){const n=t[i],s=Math.max(p(n,"minWidth"),0),r=Math.max(p(n,"minHeight"),0),o=Math.max(p(n,"maxWidth"),s),a=Math.max(p(n,"maxHeight"),r),l=f(p(n,"width"),s,o),h=f(p(n,"height"),r,a),c=p(n,"fitWidthProportion"),_=p(n,"fitHeightProportion");e.push({minWidth:s,minHeight:r,maxWidth:o,maxHeight:a,width:l,height:h,fitWidthProportion:c,fitHeightProportion:_})}return e}function p(t,e){const i=t.entity.layoutchild;return i&&i.enabled&&void 0!==i[e]&&null!==i[e]?i[e]:void 0!==t[e]?t[e]:iS[e]}function f(t,e,i){return Math.min(Math.max(t,e),i)}function m(t,e){return t.reduce((function(t,i){return t+i[e]}),0)}function g(t,e){const i=m(t,e),n=[],s=t.length;if(0===i)for(let t=0;t<s;++t)n.push(1/s);else for(let r=0;r<s;++r)n.push(t[r][e]/i);return n}function b(t,e,i){return t.forEach(y),t.slice().sort((function(t,n){return i?n[e]-t[e]:t[e]-n[e]})).map(v)}function y(t,e){t.index=e}function v(t){return t.index}function S(t,e){const i=[];i[e[t.length-1]]=t[e[t.length-1]];for(let n=t.length-2;n>=0;--n)i[e[n]]=i[e[n+1]]+t[e[n]];return i}return function(t,u){t=t.filter(a),e=u,oS.x=e.containerSize.x-e.padding.x-e.padding.z,oS.y=e.containerSize.y-e.padding.y-e.padding.w,function(t){for(let e=0;e<t.length;++e){const i=t[e],n=i.anchor;0===n.x&&0===n.y&&0===n.z&&0===n.w||(i.anchor=ut.ZERO)}}(t);const p=function(t){const i=e.orientation===tn&&e.reverseX||e.orientation===en&&e.reverseY,n=e.orientation===tn&&e.reverseY||e.orientation===en&&e.reverseX;if(i)for(let e=0;e<t.length;++e)i&&t[e].reverse();n&&t.reverse();return t}(function(t){if(!e.wrap)return[t];const n=[[]],s=d(t);let r=0;const o=e[i.fitting]===$v;for(let a=0;a<t.length;++a){n[n.length-1].length>0&&(r+=e.spacing[i.axis]);const l=s[a][i.size];r+=l,!o&&r>oS[i.axis]&&0!==n[n.length-1].length&&(r=l,n.push([])),n[n.length-1].push(t[a]),o&&r>oS[i.axis]&&a!==t.length-1&&(r=0,n.push([]))}return n}(t)),f=function(t,i){const s=[],r=[];for(let e=0;e<t.length;++e){const o=t[e];o.largestElement=null,o.largestSize={width:Number.NEGATIVE_INFINITY,height:Number.NEGATIVE_INFINITY};for(let t=0;t<o.length;++t){const s=i[e][t];s[n.size]>o.largestSize[n.size]&&(o.largestElement=o[t],o.largestSize=s)}s.push(o.largestElement),r.push(o.largestSize)}const o=h(r,n),a=l(e[n.fitting],o,oS[n.axis]);a===sS?c(r,o,n):a===rS&&_(r,o,n);for(let s=0;s<t.length;++s){const r=t[s];for(let o=0;o<r.length;++o){const a=i[s][o],h=a[n.size],c=1===t.length?oS[n.axis]:r.largestSize[n.size],_=l(e[n.fitting],h,c);_===sS?a[n.size]=Math.min(c,a[n.maxSize]):_===rS&&(a[n.size]=Math.max(c,a[n.minSize]))}}return i}(p,function(t){const n=[];for(let s=0;s<t.length;++s){const r=d(t[s]),o=h(r,i),a=l(e[i.fitting],o,oS[i.axis]);a===sS?c(r,o,i):a===rS&&_(r,o,i),n.push(r)}return n}(p)),m=function(t,a){const l={};l[i.axis]=0,l[n.axis]=0,t[i.size]=Number.NEGATIVE_INFINITY;const h=[];for(let c=0;c<t.length;++c){const _=t[c];if(0===_.length)return;const u=[],d=a[c];for(let t=0;t<_.length;++t){const a=_[t],h=d[t];l[n.axis]-=r(a,h),l[i.axis]-=s(a,h),u[t]={},u[t][i.axis]=l[i.axis],u[t][n.axis]=l[n.axis],l[n.axis]+=r(a,h),l[i.axis]+=o(a,h)+e.spacing[i.axis]}_[i.size]=l[i.axis]-e.spacing[i.axis],_[n.size]=_.largestSize[n.size],t[i.size]=Math.max(t[i.size],_[i.size]),l[i.axis]=0,l[n.axis]+=_[n.size]+e.spacing[n.axis],h.push(u)}return t[n.size]=l[n.axis]-e.spacing[n.axis],h}(p,f);return function(t,s,r){const o=e.alignment[i.axis],a=e.alignment[n.axis],l=e.padding[i.axis],h=e.padding[n.axis];for(let c=0;c<t.length;++c){const _=t[c],u=s[c],d=r[c],p=(oS[i.axis]-_[i.size])*o+l,f=(oS[n.axis]-t[n.size])*a+h;for(let t=0;t<_.length;++t){const s=(_[n.size]-u[t][n.size])*e.alignment[n.axis];d[t][i.axis]+=p,d[t][n.axis]+=f+s}}}(p,f,m),function(t,s,r){for(let o=0;o<t.length;++o){const a=t[o],l=s[o],h=r[o];for(let t=0;t<a.length;++t){const s=a[t];s[i.calculatedSize]=l[t][i.size],s[n.calculatedSize]=l[t][n.size],e.orientation===tn?s.entity.setLocalPosition(h[t][i.axis],h[t][n.axis],s.entity.getLocalPosition().z):s.entity.setLocalPosition(h[t][n.axis],h[t][i.axis],s.entity.getLocalPosition().z)}}}(p,f,m),function(t){const i=t.width,n=t.height,s=(oS.x-i)*e.alignment.x+e.padding.x,r=(oS.y-n)*e.alignment.y+e.padding.y;return{bounds:new ut(s,r,i,n)}}(p)}}const lS={};lS[tn]=aS(tn),lS[en]=aS(en);class hS{calculateLayout(t,e){const i=lS[e.orientation];if(i)return i(t,e);throw new Error("Unrecognized orientation value: "+e.orientation)}}function cS(t){return t.element}function _S(t){return t.enabled&&t.element&&t.element.enabled}class uS extends gg{constructor(t,e){super(t,e),this._orientation=tn,this._reverseX=!1,this._reverseY=!0,this._alignment=new _t(0,1),this._padding=new ut,this._spacing=new _t,this._widthFitting=Zv,this._heightFitting=Zv,this._wrap=!1,this._layoutCalculator=new hS,this._listenForReflowEvents(this.entity,"on"),this.entity.children.forEach(t=>{this._listenForReflowEvents(t,"on")}),this.entity.on("childinsert",this._onChildInsert,this),this.entity.on("childremove",this._onChildRemove,this),t.app.systems.element.on("add",this._onElementOrLayoutComponentAdd,this),t.app.systems.element.on("beforeremove",this._onElementOrLayoutComponentRemove,this),t.app.systems.layoutchild.on("add",this._onElementOrLayoutComponentAdd,this),t.app.systems.layoutchild.on("beforeremove",this._onElementOrLayoutComponentRemove,this)}_isSelfOrChild(t){return t===this.entity||-1!==this.entity.children.indexOf(t)}_listenForReflowEvents(t,e){t.element&&(t.element[e]("enableelement",this._scheduleReflow,this),t.element[e]("disableelement",this._scheduleReflow,this),t.element[e]("resize",this._scheduleReflow,this),t.element[e]("set:pivot",this._scheduleReflow,this)),t.layoutchild&&(t.layoutchild[e]("set_enabled",this._scheduleReflow,this),t.layoutchild[e]("resize",this._scheduleReflow,this))}_onElementOrLayoutComponentAdd(t){this._isSelfOrChild(t)&&(this._listenForReflowEvents(t,"on"),this._scheduleReflow())}_onElementOrLayoutComponentRemove(t){this._isSelfOrChild(t)&&(this._listenForReflowEvents(t,"off"),this._scheduleReflow())}_onChildInsert(t){this._listenForReflowEvents(t,"on"),this._scheduleReflow()}_onChildRemove(t){this._listenForReflowEvents(t,"off"),this._scheduleReflow()}_scheduleReflow(){this.enabled&&this.entity&&this.entity.enabled&&!this._isPerformingReflow&&this.system.scheduleReflow(this)}reflow(){const t=cS(this.entity),e=this.entity.children.filter(_S).map(cS);if(!t||0===e.length)return;const i=Math.max(t.calculatedWidth,0),n=Math.max(t.calculatedHeight,0),s={orientation:this._orientation,reverseX:this._reverseX,reverseY:this._reverseY,alignment:this._alignment,padding:this._padding,spacing:this._spacing,widthFitting:this._widthFitting,heightFitting:this._heightFitting,wrap:this._wrap,containerSize:new _t(i,n)};this._isPerformingReflow=!0;const r=this._layoutCalculator.calculateLayout(e,s);this._isPerformingReflow=!1,this.fire("reflow",r)}onEnable(){this._scheduleReflow()}onRemove(){this.entity.off("childinsert",this._onChildInsert,this),this.entity.off("childremove",this._onChildRemove,this),this._listenForReflowEvents(this.entity,"off"),this.entity.children.forEach(t=>{this._listenForReflowEvents(t,"off")}),this.system.app.systems.element.off("add",this._onElementOrLayoutComponentAdd,this),this.system.app.systems.element.off("beforeremove",this._onElementOrLayoutComponentRemove,this),this.system.app.systems.layoutchild.off("add",this._onElementOrLayoutComponentAdd,this),this.system.app.systems.layoutchild.off("beforeremove",this._onElementOrLayoutComponentRemove,this)}}function dS(t){const e="_"+t;Object.defineProperty(uS.prototype,t,{get:function(){return this[e]},set:function(t){this[e]!==t&&(this[e]=t,this._scheduleReflow())}})}dS("orientation"),dS("reverseX"),dS("reverseY"),dS("alignment"),dS("padding"),dS("spacing"),dS("widthFitting"),dS("heightFitting"),dS("wrap");class pS{constructor(){this.enabled=!0}}const fS=["enabled"];class mS extends bg{constructor(t){super(t),this.id="layoutgroup",this.ComponentType=uS,this.DataType=pS,this.schema=fS,this._reflowQueue=[],this.on("beforeremove",this._onRemoveComponent,this),this.app.systems.on("postUpdate",this._onPostUpdate,this)}initializeComponentData(t,e,i){void 0!==e.enabled&&(t.enabled=e.enabled),void 0!==e.orientation&&(t.orientation=e.orientation),void 0!==e.reverseX&&(t.reverseX=e.reverseX),void 0!==e.reverseY&&(t.reverseY=e.reverseY),void 0!==e.alignment&&(e.alignment instanceof _t?t.alignment.copy(e.alignment):t.alignment.set(e.alignment[0],e.alignment[1]),t.alignment=t.alignment),void 0!==e.padding&&(e.padding instanceof ut?t.padding.copy(e.padding):t.padding.set(e.padding[0],e.padding[1],e.padding[2],e.padding[3]),t.padding=t.padding),void 0!==e.spacing&&(e.spacing instanceof _t?t.spacing.copy(e.spacing):t.spacing.set(e.spacing[0],e.spacing[1]),t.spacing=t.spacing),void 0!==e.widthFitting&&(t.widthFitting=e.widthFitting),void 0!==e.heightFitting&&(t.heightFitting=e.heightFitting),void 0!==e.wrap&&(t.wrap=e.wrap),super.initializeComponentData(t,e,i)}cloneComponent(t,e){const i=t.layoutgroup;return this.addComponent(e,{enabled:i.enabled,orientation:i.orientation,reverseX:i.reverseX,reverseY:i.reverseY,alignment:i.alignment,padding:i.padding,spacing:i.spacing,widthFitting:i.widthFitting,heightFitting:i.heightFitting,wrap:i.wrap})}scheduleReflow(t){-1===this._reflowQueue.indexOf(t)&&this._reflowQueue.push(t)}_onPostUpdate(){this._processReflowQueue()}_processReflowQueue(){if(0===this._reflowQueue.length)return;let t=0;for(;this._reflowQueue.length>0;){const e=this._reflowQueue.slice();this._reflowQueue.length=0,e.sort((function(t,e){return t.entity.graphDepth-e.entity.graphDepth}));for(let t=0;t<e.length;++t)e[t].reflow();if(++t>=100){console.warn("Max reflow iterations limit reached, bailing.");break}}}_onRemoveComponent(t,e){e.onRemove()}destroy(){super.destroy(),this.app.systems.off("postUpdate",this._onPostUpdate,this)}}gg._buildAccessors(uS.prototype,fS);const gS=[],bS=[];class yS extends gg{constructor(t,e){super(t,e),this._cookieAsset=null,this._cookieAssetId=null,this._cookieAssetAdd=!1,this._cookieMatrix=null}addLightToLayers(){for(let t=0;t<this.layers.length;t++){const e=this.system.app.scene.layers.getLayerById(this.layers[t]);e&&e.addLight(this)}}removeLightFromLayers(){for(let t=0;t<this.layers.length;t++){const e=this.system.app.scene.layers.getLayerById(this.layers[t]);e&&e.removeLight(this)}}onLayersChanged(t,e){this.enabled&&this.entity.enabled&&this.addLightToLayers(),t.off("add",this.onLayerAdded,this),t.off("remove",this.onLayerRemoved,this),e.on("add",this.onLayerAdded,this),e.on("remove",this.onLayerRemoved,this)}onLayerAdded(t){this.layers.indexOf(t.id)>=0&&this.enabled&&this.entity.enabled&&t.addLight(this)}onLayerRemoved(t){this.layers.indexOf(t.id)>=0&&t.removeLight(this)}refreshProperties(){for(let t=0;t<gS.length;t++){const e=gS[t];this[e]=this[e]}this.enabled&&this.entity.enabled&&this.onEnable()}updateShadow(){this.light.updateShadow()}onCookieAssetSet(){let t=!1;"cubemap"!==this._cookieAsset.type||this._cookieAsset.loadFaces||(this._cookieAsset.loadFaces=!0,t=!0),this._cookieAsset.resource&&!t||this.system.app.assets.load(this._cookieAsset),this._cookieAsset.resource&&this.onCookieAssetLoad()}onCookieAssetAdd(t){this._cookieAssetId===t.id&&(this._cookieAsset=t,this.light.enabled&&this.onCookieAssetSet(),this._cookieAsset.on("load",this.onCookieAssetLoad,this),this._cookieAsset.on("remove",this.onCookieAssetRemove,this))}onCookieAssetLoad(){this._cookieAsset&&this._cookieAsset.resource&&(this.cookie=this._cookieAsset.resource)}onCookieAssetRemove(){this._cookieAssetId&&(this._cookieAssetAdd&&(this.system.app.assets.off("add:"+this._cookieAssetId,this.onCookieAssetAdd,this),this._cookieAssetAdd=!1),this._cookieAsset&&(this._cookieAsset.off("load",this.onCookieAssetLoad,this),this._cookieAsset.off("remove",this.onCookieAssetRemove,this),this._cookieAsset=null),this.cookie=null)}onEnable(){this.light.enabled=!0,this.system.app.scene.on("set:layers",this.onLayersChanged,this),this.system.app.scene.layers&&(this.system.app.scene.layers.on("add",this.onLayerAdded,this),this.system.app.scene.layers.on("remove",this.onLayerRemoved,this)),this.enabled&&this.entity.enabled&&this.addLightToLayers(),this._cookieAsset&&!this.cookie&&this.onCookieAssetSet()}onDisable(){this.light.enabled=!1,this.system.app.scene.off("set:layers",this.onLayersChanged,this),this.system.app.scene.layers&&(this.system.app.scene.layers.off("add",this.onLayerAdded,this),this.system.app.scene.layers.off("remove",this.onLayerRemoved,this)),this.removeLightFromLayers()}onRemove(){this.onDisable(),this.light.destroy(),this.cookieAsset=null}}function vS(t,e,i,n){const s=yS.prototype;gS.push(t),bS.push(e),Object.defineProperty(s,t,{get:function(){return this.data[t]},set:function(e){const s=this.data,r=s[t];(n||r!==e)&&(s[t]=e,i&&i.call(this,e,r))},configurable:!0})}vS("enabled",!0,(function(t,e){this.onSetEnabled(null,e,t)})),vS("light",null),vS("type","directional",(function(t,e){this.system.changeType(this,e,t),this.refreshProperties()})),vS("color",new rt(1,1,1),(function(t,e){this.light.setColor(t)}),!0),vS("intensity",1,(function(t,e){this.light.intensity=t})),vS("shape",re,(function(t,e){this.light.shape=t})),vS("castShadows",!1,(function(t,e){this.light.castShadows=t})),vS("shadowDistance",40,(function(t,e){this.light.shadowDistance=t})),vS("shadowResolution",1024,(function(t,e){this.light.shadowResolution=t})),vS("shadowBias",.05,(function(t,e){this.light.shadowBias=-.01*Z.clamp(t,0,1)})),vS("numCascades",1,(function(t,e){this.light.numCascades=Z.clamp(Math.floor(t),1,4)})),vS("bakeNumSamples",1,(function(t,e){this.light.bakeNumSamples=Z.clamp(Math.floor(t),1,255)})),vS("bakeArea",0,(function(t,e){this.light.bakeArea=Z.clamp(t,0,180)})),vS("cascadeDistribution",.5,(function(t,e){this.light.cascadeDistribution=Z.clamp(t,0,1)})),vS("normalOffsetBias",0,(function(t,e){this.light.normalOffsetBias=Z.clamp(t,0,1)})),vS("range",10,(function(t,e){this.light.attenuationEnd=t})),vS("innerConeAngle",40,(function(t,e){this.light.innerConeAngle=t})),vS("outerConeAngle",45,(function(t,e){this.light.outerConeAngle=t})),vS("falloffMode",he,(function(t,e){this.light.falloffMode=t})),vS("shadowType",_e,(function(t,e){this.light.shadowType=t})),vS("vsmBlurSize",11,(function(t,e){this.light.vsmBlurSize=t})),vS("vsmBlurMode",ye,(function(t,e){this.light.vsmBlurMode=t})),vS("vsmBias",.0025,(function(t,e){this.light.vsmBias=Z.clamp(t,0,1)})),vS("cookieAsset",null,(function(t,e){if(!this._cookieAssetId||!(t instanceof Od&&t.id===this._cookieAssetId||t===this._cookieAssetId))if(this.onCookieAssetRemove(),this._cookieAssetId=null,t instanceof Od)this.data.cookieAsset=t.id,this._cookieAssetId=t.id,this.onCookieAssetAdd(t);else if("number"==typeof t){this._cookieAssetId=t;const e=this.system.app.assets.get(t);e?this.onCookieAssetAdd(e):(this._cookieAssetAdd=!0,this.system.app.assets.on("add:"+this._cookieAssetId,this.onCookieAssetAdd,this))}})),vS("cookie",null,(function(t,e){this.light.cookie=t})),vS("cookieIntensity",1,(function(t,e){this.light.cookieIntensity=Z.clamp(t,0,1)})),vS("cookieFalloff",!0,(function(t,e){this.light.cookieFalloff=t})),vS("cookieChannel","rgb",(function(t,e){this.light.cookieChannel=t})),vS("cookieAngle",0,(function(t,e){if(0!==t||null!==this.cookieScale){this._cookieMatrix||(this._cookieMatrix=new ut);let e=1,i=1;this.cookieScale&&(e=this.cookieScale.x,i=this.cookieScale.y);const n=Math.cos(t*Z.DEG_TO_RAD),s=Math.sin(t*Z.DEG_TO_RAD);this._cookieMatrix.set(n/e,-s/e,s/i,n/i),this.light.cookieTransform=this._cookieMatrix}else this.light.cookieTransform=null})),vS("cookieScale",null,(function(t,e){if(null!==t||0!==this.cookieAngle){this._cookieMatrix||(this._cookieMatrix=new ut);const e=t.x,i=t.y,n=Math.cos(this.cookieAngle*Z.DEG_TO_RAD),s=Math.sin(this.cookieAngle*Z.DEG_TO_RAD);this._cookieMatrix.set(n/e,-s/e,s/i,n/i),this.light.cookieTransform=this._cookieMatrix}else this.light.cookieTransform=null}),!0),vS("cookieOffset",null,(function(t,e){this.light.cookieOffset=t}),!0),vS("shadowUpdateMode",wi,(function(t,e){this.light.shadowUpdateMode=t}),!0),vS("mask",1,(function(t,e){this.light.mask=t})),vS("affectDynamic",!0,(function(t,e){t?this.light.mask|=Ai:this.light.mask&=~Ai,this.light.layersDirty()})),vS("affectLightmapped",!1,(function(t,e){t?(this.light.mask|=Ei,this.bake&&(this.light.mask&=~Mi)):(this.light.mask&=~Ei,this.bake&&(this.light.mask|=Mi))})),vS("bake",!1,(function(t,e){t?(this.light.mask|=Mi,this.affectLightmapped&&(this.light.mask&=~Ei)):(this.light.mask&=~Mi,this.affectLightmapped&&(this.light.mask|=Ei)),this.light.layersDirty()})),vS("bakeDir",!0,(function(t,e){this.light.bakeDir=t})),vS("isStatic",!1,(function(t,e){this.light.isStatic=t})),vS("layers",[Zt],(function(t,e){for(let t=0;t<e.length;t++){const i=this.system.app.scene.layers.getLayerById(e[t]);i&&i.removeLight(this)}for(let e=0;e<t.length;e++){const i=this.system.app.scene.layers.getLayerById(t[e]);i&&this.enabled&&this.entity.enabled&&i.addLight(this)}}));class SS{constructor(){const t=gS,e=bS;for(let i=0;i<t.length;i++){const n=e[i];n&&n.clone?this[t[i]]=n.clone():this[t[i]]=n}}}const xS={directional:ee,omni:ie,point:ie,spot:se};class wS extends bg{constructor(t){super(t),this.id="light",this.ComponentType=yS,this.DataType=SS,this.on("beforeremove",this._onRemoveComponent,this)}initializeComponentData(t,e){const i=gS,n={};for(let t=0,s=i.length;t<s;t++){const s=i[t];n[s]=e[s]}n.type||(n.type=t.data.type),t.data.type=n.type,n.layers&&Array.isArray(n.layers)&&(n.layers=n.layers.slice(0)),n.color&&Array.isArray(n.color)&&(n.color=new rt(n.color[0],n.color[1],n.color[2])),n.cookieOffset&&n.cookieOffset instanceof Array&&(n.cookieOffset=new _t(n.cookieOffset[0],n.cookieOffset[1])),n.cookieScale&&n.cookieScale instanceof Array&&(n.cookieScale=new _t(n.cookieScale[0],n.cookieScale[1])),n.enable&&(console.warn("WARNING: enable: Property is deprecated. Set enabled property instead."),n.enabled=n.enable),n.shape||(n.shape=re);const s=new P_(this.app.graphicsDevice);s.type=xS[n.type],s._node=t.entity,s._scene=this.app.scene,t.data.light=s,super.initializeComponentData(t,n,i)}_onRemoveComponent(t,e){e.onRemove()}cloneComponent(t,e){const i=t.light,n=[];let s;const r=gS;for(let t=0;t<r.length;t++)s=r[t],"light"!==s&&(i[s]&&i[s].clone?n[s]=i[s].clone():n[s]=i[s]);this.addComponent(e,n)}changeType(t,e,i){e!==i&&(t.light.type=xS[i])}}class CS extends gg{constructor(t,e){super(t,e),this._type="asset",this._asset=null,this._model=null,this._mapping={},this._castShadows=!0,this._receiveShadows=!0,this._materialAsset=null,this._material=t.defaultMaterial,this._castShadowsLightmap=!0,this._lightmapped=!1,this._lightmapSizeMultiplier=1,this._isStatic=!1,this._layers=[Zt],this._batchGroupId=-1,this._customAabb=null,this._area=null,this._assetOld=0,this._materialEvents=null,this._dirtyModelAsset=!1,this._dirtyMaterialAsset=!1,this._clonedModel=!1,e.on("remove",this.onRemoveChild,this),e.on("removehierarchy",this.onRemoveChild,this),e.on("insert",this.onInsertChild,this),e.on("inserthierarchy",this.onInsertChild,this)}addModelToLayers(){const t=this.system.app.scene.layers;for(let e=0;e<this._layers.length;e++){const i=t.getLayerById(this._layers[e]);i&&i.addMeshInstances(this.meshInstances)}}removeModelFromLayers(){const t=this.system.app.scene.layers;for(let e=0;e<this._layers.length;e++){const i=t.getLayerById(this._layers[e]);i&&i.removeMeshInstances(this.meshInstances)}}onRemoveChild(){this._model&&this.removeModelFromLayers()}onInsertChild(){this._model&&this.enabled&&this.entity.enabled&&this.addModelToLayers()}onRemove(){this.asset=null,this.model=null,this.materialAsset=null,this._unsetMaterialEvents(),this.entity.off("remove",this.onRemoveChild,this),this.entity.off("insert",this.onInsertChild,this)}onLayersChanged(t,e){this.addModelToLayers(),t.off("add",this.onLayerAdded,this),t.off("remove",this.onLayerRemoved,this),e.on("add",this.onLayerAdded,this),e.on("remove",this.onLayerRemoved,this)}onLayerAdded(t){this.layers.indexOf(t.id)<0||t.addMeshInstances(this.meshInstances)}onLayerRemoved(t){this.layers.indexOf(t.id)<0||t.removeMeshInstances(this.meshInstances)}_setMaterialEvent(t,e,i,n){const s=e+":"+i;this.system.app.assets.on(s,n,this),this._materialEvents||(this._materialEvents=[]),this._materialEvents[t]||(this._materialEvents[t]={}),this._materialEvents[t][s]={id:i,handler:n}}_unsetMaterialEvents(){const t=this.system.app.assets,e=this._materialEvents;if(e){for(let i=0,n=e.length;i<n;i++){if(!e[i])continue;const n=e[i];for(const e in n)t.off(e,n[e].handler,this)}this._materialEvents=null}}_getAssetByIdOrPath(t){let e=null;if(isNaN(parseInt(t,10))){if(this.asset){const i=this._getMaterialAssetUrl(t);i&&(e=this.system.app.assets.getByUrl(i))}}else e=this.system.app.assets.get(t);return e}_getMaterialAssetUrl(t){if(!this.asset)return null;const e=this.system.app.assets.get(this.asset);return e?e.getAbsoluteUrl(t):null}_loadAndSetMeshInstanceMaterial(t,e,i){const n=this.system.app.assets;t&&(t.resource?(e.material=t.resource,this._setMaterialEvent(i,"remove",t.id,(function(){e.material=this.system.defaultMaterial}))):(this._setMaterialEvent(i,"load",t.id,(function(n){e.material=n.resource,this._setMaterialEvent(i,"remove",t.id,(function(){e.material=this.system.defaultMaterial}))})),this.enabled&&this.entity.enabled&&n.load(t)))}onEnable(){const t=this.system.app,e=t.scene;e.on("set:layers",this.onLayersChanged,this),e.layers&&(e.layers.on("add",this.onLayerAdded,this),e.layers.on("remove",this.onLayerRemoved,this));const i="asset"===this._type;let n;if(this._model?this.addModelToLayers():i&&this._asset&&(n=t.assets.get(this._asset),n&&n.resource!==this._model&&this._bindModelAsset(n)),this._materialAsset&&(n=t.assets.get(this._materialAsset),n&&n.resource!==this._material&&this._bindMaterialAsset(n)),i&&this._mapping)for(const e in this._mapping)this._mapping[e]&&(n=this._getAssetByIdOrPath(this._mapping[e]),n&&!n.resource&&t.assets.load(n));this._batchGroupId>=0&&t.batcher.insert(Nh.MODEL,this.batchGroupId,this.entity)}onDisable(){const t=this.system.app,e=t.scene;e.off("set:layers",this.onLayersChanged,this),e.layers&&(e.layers.off("add",this.onLayerAdded,this),e.layers.off("remove",this.onLayerRemoved,this)),this._batchGroupId>=0&&t.batcher.remove(Nh.MODEL,this.batchGroupId,this.entity),this._model&&this.removeModelFromLayers()}hide(){if(this._model){const t=this._model.meshInstances;for(let e=0,i=t.length;e<i;e++)t[e].visible=!1}}show(){if(this._model){const t=this._model.meshInstances;for(let e=0,i=t.length;e<i;e++)t[e].visible=!0}}_bindMaterialAsset(t){if(t.on("load",this._onMaterialAssetLoad,this),t.on("unload",this._onMaterialAssetUnload,this),t.on("remove",this._onMaterialAssetRemove,this),t.on("change",this._onMaterialAssetChange,this),t.resource)this._onMaterialAssetLoad(t);else{if(!this.enabled||!this.entity.enabled)return;this.system.app.assets.load(t)}}_unbindMaterialAsset(t){t.off("load",this._onMaterialAssetLoad,this),t.off("unload",this._onMaterialAssetUnload,this),t.off("remove",this._onMaterialAssetRemove,this),t.off("change",this._onMaterialAssetChange,this)}_onMaterialAssetAdd(t){this.system.app.assets.off("add:"+t.id,this._onMaterialAssetAdd,this),this._materialAsset===t.id&&this._bindMaterialAsset(t)}_onMaterialAssetLoad(t){this._setMaterial(t.resource)}_onMaterialAssetUnload(t){this._setMaterial(this.system.defaultMaterial)}_onMaterialAssetRemove(t){this._onMaterialAssetUnload(t)}_onMaterialAssetChange(t){}_bindModelAsset(t){if(this._unbindModelAsset(t),t.on("load",this._onModelAssetLoad,this),t.on("unload",this._onModelAssetUnload,this),t.on("change",this._onModelAssetChange,this),t.on("remove",this._onModelAssetRemove,this),t.resource)this._onModelAssetLoad(t);else{if(!this.enabled||!this.entity.enabled)return;this.system.app.assets.load(t)}}_unbindModelAsset(t){t.off("load",this._onModelAssetLoad,this),t.off("unload",this._onModelAssetUnload,this),t.off("change",this._onModelAssetChange,this),t.off("remove",this._onModelAssetRemove,this)}_onModelAssetAdded(t){this.system.app.assets.off("add:"+t.id,this._onModelAssetAdded,this),t.id===this._asset&&this._bindModelAsset(t)}_onModelAssetLoad(t){this.model=t.resource.clone(),this._clonedModel=!0}_onModelAssetUnload(t){this.model=null}_onModelAssetChange(t,e,i,n){"data"===e&&(this.mapping=this._mapping)}_onModelAssetRemove(t){this.model=null}_setMaterial(t){if(this._material===t)return;this._material=t;const e=this._model;if(e&&"asset"!==this._type){const i=e.meshInstances;for(let e=0,n=i.length;e<n;e++)i[e].material=t}}get meshInstances(){return this._model?this._model.meshInstances:null}set meshInstances(t){this._model&&(this._model.meshInstances=t)}get customAabb(){return this._customAabb}set customAabb(t){if(this._customAabb=t,this._model){const t=this._model.meshInstances;if(t)for(let e=0;e<t.length;e++)t[e].setCustomAabb(this._customAabb)}}get type(){return this._type}set type(t){if(this._type!==t)if(this._area=null,this._type=t,"asset"===t)null!==this._asset?this._bindModelAsset(this._asset):this.model=null;else{const e=Oh(this.system.app.graphicsDevice,t);this._area=e.area;const i=e.mesh,n=new La,s=new Uu;s.graph=n,s.meshInstances=[new Kh(i,this._material,n)],this.model=s,this._asset=null}}get asset(){return this._asset}set asset(t){const e=this.system.app.assets;let i=t;if(t instanceof Od&&(i=t.id),this._asset!==i){if(this._asset){e.off("add:"+this._asset,this._onModelAssetAdded,this);const t=e.get(this._asset);t&&this._unbindModelAsset(t)}if(this._asset=i,this._asset){const t=e.get(this._asset);t?this._bindModelAsset(t):(this.model=null,e.on("add:"+this._asset,this._onModelAssetAdded,this))}else this.model=null}}get model(){return this._model}set model(t){if(this._model!==t&&(!t||!t._immutable)&&(this._model&&(this._model._immutable=!1,this.removeModelFromLayers(),this.entity.removeChild(this._model.getGraph()),delete this._model._entity,this._clonedModel&&(this._model.destroy(),this._clonedModel=!1)),this._model=t,this._model)){this._model._immutable=!0;const t=this._model.meshInstances;for(let e=0;e<t.length;e++)t[e].castShadow=this._castShadows,t[e].receiveShadow=this._receiveShadows,t[e].isStatic=this._isStatic,t[e].setCustomAabb(this._customAabb);this.lightmapped=this._lightmapped,this.entity.addChild(this._model.graph),this.enabled&&this.entity.enabled&&this.addModelToLayers(),this._model._entity=this.entity,this.entity.animation&&this.entity.animation.setModel(this._model),this.entity.anim&&(this.entity.anim.playing?this.entity.anim.rebind():this.entity.anim.resetStateGraph()),"asset"===this.type?this.mapping=this._mapping:this._unsetMaterialEvents()}}get lightmapped(){return this._lightmapped}set lightmapped(t){if(t!==this._lightmapped&&(this._lightmapped=t,this._model)){const e=this._model.meshInstances;for(let i=0;i<e.length;i++)e[i].setLightmapped(t)}}get castShadows(){return this._castShadows}set castShadows(t){if(this._castShadows===t)return;const e=this._model;if(e){const i=this.layers,n=this.system.app.scene;if(this._castShadows&&!t)for(let t=0;t<i.length;t++){const i=this.system.app.scene.layers.getLayerById(this.layers[t]);i&&i.removeShadowCasters(e.meshInstances)}const s=e.meshInstances;for(let e=0;e<s.length;e++)s[e].castShadow=t;if(!this._castShadows&&t)for(let t=0;t<i.length;t++){const s=n.layers.getLayerById(i[t]);s&&s.addShadowCasters(e.meshInstances)}}this._castShadows=t}get receiveShadows(){return this._receiveShadows}set receiveShadows(t){if(this._receiveShadows!==t&&(this._receiveShadows=t,this._model)){const e=this._model.meshInstances;for(let i=0,n=e.length;i<n;i++)e[i].receiveShadow=t}}get castShadowsLightmap(){return this._castShadowsLightmap}set castShadowsLightmap(t){this._castShadowsLightmap=t}get lightmapSizeMultiplier(){return this._lightmapSizeMultiplier}set lightmapSizeMultiplier(t){this._lightmapSizeMultiplier=t}get isStatic(){return this._isStatic}set isStatic(t){if(this._isStatic!==t&&(this._isStatic=t,this._model)){const e=this._model.meshInstances;for(let i=0;i<e.length;i++){e[i].isStatic=t}}}get layers(){return this._layers}set layers(t){const e=this.system.app.scene.layers;if(this.meshInstances)for(let t=0;t<this._layers.length;t++){const i=e.getLayerById(this._layers[t]);i&&i.removeMeshInstances(this.meshInstances)}this._layers.length=0;for(let e=0;e<t.length;e++)this._layers[e]=t[e];if(this.enabled&&this.entity.enabled&&this.meshInstances)for(let t=0;t<this._layers.length;t++){const i=e.getLayerById(this._layers[t]);i&&i.addMeshInstances(this.meshInstances)}}get batchGroupId(){return this._batchGroupId}set batchGroupId(t){if(this._batchGroupId===t)return;const e=this.system.app.batcher;this.entity.enabled&&this._batchGroupId>=0&&e.remove(Nh.MODEL,this.batchGroupId,this.entity),this.entity.enabled&&t>=0&&e.insert(Nh.MODEL,t,this.entity),t<0&&this._batchGroupId>=0&&this.enabled&&this.entity.enabled&&this.addModelToLayers(),this._batchGroupId=t}get materialAsset(){return this._materialAsset}set materialAsset(t){let e=t;t instanceof Od&&(e=t.id);const i=this.system.app.assets;if(e!==this._materialAsset){if(this._materialAsset){i.off("add:"+this._materialAsset,this._onMaterialAssetAdd,this);const t=i.get(this._materialAsset);t&&this._unbindMaterialAsset(t)}if(this._materialAsset=e,this._materialAsset){const t=i.get(this._materialAsset);t?this._bindMaterialAsset(t):(this._setMaterial(this.system.defaultMaterial),i.on("add:"+this._materialAsset,this._onMaterialAssetAdd,this))}else this._setMaterial(this.system.defaultMaterial)}}get material(){return this._material}set material(t){this._material!==t&&(this.materialAsset=null,this._setMaterial(t))}get mapping(){return this._mapping}set mapping(t){if("asset"!==this._type)return;if(this._unsetMaterialEvents(),t||(t={}),this._mapping=t,!this._model)return;const e=this._model.meshInstances,i=this.asset?this.system.app.assets.get(this.asset):null,n=i?i.data.mapping:null;let s=null;for(let i=0,r=e.length;i<r;i++)if(void 0!==t[i])t[i]?(s=this.system.app.assets.get(t[i]),this._loadAndSetMeshInstanceMaterial(s,e[i],i)):e[i].material=this.system.defaultMaterial;else if(n)if(n[i]&&(n[i].material||n[i].path)){if(void 0!==n[i].material)s=this.system.app.assets.get(n[i].material);else if(void 0!==n[i].path){const t=this._getMaterialAssetUrl(n[i].path);t&&(s=this.system.app.assets.getByUrl(t))}this._loadAndSetMeshInstanceMaterial(s,e[i],i)}else e[i].material=this.system.defaultMaterial}}class TS{constructor(){this.enabled=!0}}const AS=["enabled"];class ES extends bg{constructor(t){super(t),this.id="model",this.ComponentType=CS,this.DataType=TS,this.schema=AS,this.defaultMaterial=t.scene.defaultMaterial,this.on("beforeremove",this.onRemove,this)}initializeComponentData(t,e,i){i=["material","materialAsset","asset","castShadows","receiveShadows","castShadowsLightmap","lightmapped","lightmapSizeMultiplier","type","mapping","layers","isStatic","batchGroupId"],null!==e.batchGroupId&&void 0!==e.batchGroupId||(e.batchGroupId=-1),e.layers&&e.layers.length&&(e.layers=e.layers.slice(0));for(let n=0;n<i.length;n++)e.hasOwnProperty(i[n])&&(t[i[n]]=e[i[n]]);e.aabbCenter&&e.aabbHalfExtents&&(t.customAabb=new Tt(new ht(e.aabbCenter),new ht(e.aabbHalfExtents))),super.initializeComponentData(t,e,["enabled"])}cloneComponent(t,e){const i={type:t.model.type,asset:t.model.asset,castShadows:t.model.castShadows,receiveShadows:t.model.receiveShadows,castShadowsLightmap:t.model.castShadowsLightmap,lightmapped:t.model.lightmapped,lightmapSizeMultiplier:t.model.lightmapSizeMultiplier,isStatic:t.model.isStatic,enabled:t.model.enabled,layers:t.model.layers,batchGroupId:t.model.batchGroupId,mapping:f({},t.model.mapping)};let n=t.model.materialAsset;n instanceof Od||null==n||(n=this.app.assets.get(n));const s=t.model.material;s&&s!==this.defaultMaterial&&n&&s!==n.resource||(i.materialAsset=n);const r=this.addComponent(e,i);if(t.model.model&&"asset"===t.model.type&&!t.model.asset&&(r.model=t.model.model.clone(),r._clonedModel=!0),i.materialAsset||(r.material=s),t.model.model){const e=t.model.model.meshInstances,i=r.model.meshInstances;for(let t=0;t<e.length;t++)i[t].mask=e[t].mask,i[t].material=e[t].material,i[t].layer=e[t].layer,i[t].receiveShadow=e[t].receiveShadow}t.model.customAabb&&(r.customAabb=t.model.customAabb.clone())}onRemove(t,e){e.onRemove()}}gg._buildAccessors(CS.prototype,AS);class MS extends gg{constructor(t,e){super(t,e),this._type="asset",this._castShadows=!0,this._receiveShadows=!0,this._castShadowsLightmap=!0,this._lightmapped=!1,this._lightmapSizeMultiplier=1,this._isStatic=!1,this._batchGroupId=-1,this._meshInstances=[],this._layers=[Zt],this._renderStyle=De,this._customAabb=null,this._area=null,this._rootBone=new Lb(this,"rootBone"),this._rootBone.on("set:entity",this._onSetRootBone,this),this._assetReference=new Kp("asset",this,t.app.assets,{add:this._onRenderAssetAdded,load:this._onRenderAssetLoad,remove:this._onRenderAssetRemove,unload:this._onRenderAssetUnload},this),this._material=t.defaultMaterial,this._materialReferences=[],e.on("remove",this.onRemoveChild,this),e.on("removehierarchy",this.onRemoveChild,this),e.on("insert",this.onInsertChild,this),e.on("inserthierarchy",this.onInsertChild,this)}_onSetRootBone(t){t&&this._onRootBoneChanged()}_onRootBoneChanged(){this._clearSkinInstances(),this.enabled&&this.entity.enabled&&this._cloneSkinInstances()}destroyMeshInstances(){const t=this._meshInstances;if(t){this.removeFromLayers(),this._clearSkinInstances();for(let e=0;e<t.length;e++)t[e].destroy();this._meshInstances.length=0}}addToLayers(){const t=this.system.app.scene.layers;for(let e=0;e<this._layers.length;e++){const i=t.getLayerById(this._layers[e]);i&&i.addMeshInstances(this._meshInstances)}}removeFromLayers(){if(this._meshInstances&&this._meshInstances.length){const t=this.system.app.scene.layers;for(let e=0;e<this._layers.length;e++){const i=t.getLayerById(this._layers[e]);i&&i.removeMeshInstances(this._meshInstances)}}}onRemoveChild(){this.removeFromLayers()}onInsertChild(){this._meshInstances&&this.enabled&&this.entity.enabled&&this.addToLayers()}onRemove(){this.destroyMeshInstances(),this.asset=null,this.materialAsset=null,this.entity.off("remove",this.onRemoveChild,this),this.entity.off("insert",this.onInsertChild,this)}onLayersChanged(t,e){this.addToLayers(),t.off("add",this.onLayerAdded,this),t.off("remove",this.onLayerRemoved,this),e.on("add",this.onLayerAdded,this),e.on("remove",this.onLayerRemoved,this)}onLayerAdded(t){this.layers.indexOf(t.id)<0||t.addMeshInstances(this._meshInstances)}onLayerRemoved(t){this.layers.indexOf(t.id)<0||t.removeMeshInstances(this._meshInstances)}onEnable(){const t=this.system.app,e=t.scene;this._rootBone.onParentComponentEnable(),this._cloneSkinInstances(),e.on("set:layers",this.onLayersChanged,this),e.layers&&(e.layers.on("add",this.onLayerAdded,this),e.layers.on("remove",this.onLayerRemoved,this));const i="asset"===this._type;this._meshInstances&&this._meshInstances.length?this.addToLayers():i&&this.asset&&this._onRenderAssetAdded();for(let t=0;t<this._materialReferences.length;t++)this._materialReferences[t].asset&&this.system.app.assets.load(this._materialReferences[t].asset);this._batchGroupId>=0&&t.batcher.insert(Nh.RENDER,this.batchGroupId,this.entity)}onDisable(){const t=this.system.app,e=t.scene;e.off("set:layers",this.onLayersChanged,this),e.layers&&(e.layers.off("add",this.onLayerAdded,this),e.layers.off("remove",this.onLayerRemoved,this)),this._batchGroupId>=0&&t.batcher.remove(Nh.RENDER,this.batchGroupId,this.entity),this.removeFromLayers()}hide(){if(this._meshInstances)for(let t=0;t<this._meshInstances.length;t++)this._meshInstances[t].visible=!1}show(){if(this._meshInstances)for(let t=0;t<this._meshInstances.length;t++)this._meshInstances[t].visible=!0}_onRenderAssetAdded(){this._assetReference.asset&&(this._assetReference.asset.resource?this._onRenderAssetLoad():this.enabled&&this.entity.enabled&&this.system.app.assets.load(this._assetReference.asset))}_onRenderAssetLoad(){if(this.destroyMeshInstances(),this._assetReference.asset){const t=this._assetReference.asset.resource;t.off("set:meshes",this._onSetMeshes,this),t.on("set:meshes",this._onSetMeshes,this),t.meshes&&this._onSetMeshes(t.meshes)}}_onSetMeshes(t){this._cloneMeshes(t)}_clearSkinInstances(){for(let t=0;t<this._meshInstances.length;t++){const e=this._meshInstances[t];Mp.removeCachedSkinInstance(e.skinInstance),e.skinInstance=null}}_cloneSkinInstances(){if(this._meshInstances.length&&this._rootBone.entity instanceof La)for(let t=0;t<this._meshInstances.length;t++){const e=this._meshInstances[t],i=e.mesh;i.skin&&!i.skinInstance&&(e.skinInstance=Mp.createCachedSkinedInstance(i.skin,this._rootBone.entity,this.entity))}}_cloneMeshes(t){if(t&&t.length){const e=[];for(let i=0;i<t.length;i++){const n=t[i],s=this._materialReferences[i]&&this._materialReferences[i].asset&&this._materialReferences[i].asset.resource,r=new Kh(n,s||this.system.defaultMaterial,this.entity);e.push(r),n.morph&&(r.morphInstance=new Nu(n.morph))}this.meshInstances=e,this._cloneSkinInstances()}}_onRenderAssetUnload(){"asset"===this._type&&this.destroyMeshInstances()}_onRenderAssetRemove(){this._assetReference.asset&&this._assetReference.asset.resource&&this._assetReference.asset.resource.off("set:meshes",this._onSetMeshes,this),this._onRenderAssetUnload()}_onMaterialAdded(t,e,i){i.resource?this._onMaterialLoad(t,e,i):this.enabled&&this.entity.enabled&&this.system.app.assets.load(i)}_onMaterialLoad(t,e,i){this._meshInstances[t]&&(this._meshInstances[t].material=i.resource)}_onMaterialRemove(t,e,i){this._meshInstances[t]&&(this._meshInstances[t].material=this.system.defaultMaterial)}_onMaterialUnload(t,e,i){this._meshInstances[t]&&(this._meshInstances[t].material=this.system.defaultMaterial)}get renderStyle(){return this._renderStyle}set renderStyle(t){this._renderStyle!==t&&(this._renderStyle=t,Kh._prepareRenderStyleForArray(this._meshInstances,t))}get customAabb(){return this._customAabb}set customAabb(t){this._customAabb=t;const e=this._meshInstances;if(e)for(let t=0;t<e.length;t++)e[t].setCustomAabb(this._customAabb)}get type(){return this._type}set type(t){if(this._type!==t&&(this._area=null,this._type=t,this.destroyMeshInstances(),"asset"!==t)){let e=this._material;e&&e!==this.system.defaultMaterial||(e=this._materialReferences[0]&&this._materialReferences[0].asset&&this._materialReferences[0].asset.resource);const i=Oh(this.system.app.graphicsDevice,t);this._area=i.area,this.meshInstances=[new Kh(i.mesh,e||this.system.defaultMaterial,this.entity)]}}get meshInstances(){return this._meshInstances}set meshInstances(t){if(this.destroyMeshInstances(),this._meshInstances=t,this._meshInstances){const t=this._meshInstances;for(let e=0;e<t.length;e++)t[e].node||(t[e].node=this.entity),t[e].castShadow=this._castShadows,t[e].receiveShadow=this._receiveShadows,t[e].isStatic=this._isStatic,t[e].renderStyle=this._renderStyle,t[e].setLightmapped(this._lightmapped),t[e].setCustomAabb(this._customAabb);this.enabled&&this.entity.enabled&&this.addToLayers()}}get lightmapped(){return this._lightmapped}set lightmapped(t){if(t!==this._lightmapped){this._lightmapped=t;const e=this._meshInstances;if(e)for(let i=0;i<e.length;i++)e[i].setLightmapped(t)}}get castShadows(){return this._castShadows}set castShadows(t){if(this._castShadows!==t){const e=this._meshInstances;if(e){const i=this.layers,n=this.system.app.scene;if(this._castShadows&&!t)for(let t=0;t<i.length;t++){const i=n.layers.getLayerById(this.layers[t]);i&&i.removeShadowCasters(e)}for(let i=0;i<e.length;i++)e[i].castShadow=t;if(!this._castShadows&&t)for(let t=0;t<i.length;t++){const s=n.layers.getLayerById(i[t]);s&&s.addShadowCasters(e)}}this._castShadows=t}}get receiveShadows(){return this._receiveShadows}set receiveShadows(t){if(this._receiveShadows!==t){this._receiveShadows=t;const e=this._meshInstances;if(e)for(let i=0;i<e.length;i++)e[i].receiveShadow=t}}get castShadowsLightmap(){return this._castShadowsLightmap}set castShadowsLightmap(t){this._castShadowsLightmap=t}get lightmapSizeMultiplier(){return this._lightmapSizeMultiplier}set lightmapSizeMultiplier(t){this._lightmapSizeMultiplier=t}get isStatic(){return this._isStatic}set isStatic(t){if(this._isStatic!==t){this._isStatic=t;const e=this._meshInstances;if(e)for(let i=0;i<e.length;i++)e[i].isStatic=t}}get layers(){return this._layers}set layers(t){const e=this.system.app.scene.layers;let i;if(this._meshInstances)for(let t=0;t<this._layers.length;t++)i=e.getLayerById(this._layers[t]),i&&i.removeMeshInstances(this._meshInstances);this._layers.length=0;for(let e=0;e<t.length;e++)this._layers[e]=t[e];if(this.enabled&&this.entity.enabled&&this._meshInstances)for(let t=0;t<this._layers.length;t++)i=e.getLayerById(this._layers[t]),i&&i.addMeshInstances(this._meshInstances)}get batchGroupId(){return this._batchGroupId}set batchGroupId(t){if(this._batchGroupId!==t){const e=this.system.app.batcher;this.entity.enabled&&this._batchGroupId>=0&&e.remove(Nh.RENDER,this.batchGroupId,this.entity),this.entity.enabled&&t>=0&&e.insert(Nh.RENDER,t,this.entity),t<0&&this._batchGroupId>=0&&this.enabled&&this.entity.enabled&&this.addToLayers(),this._batchGroupId=t}}get material(){return this._material}set material(t){if(this._material!==t&&(this._material=t,this._meshInstances&&"asset"!==this._type))for(let e=0;e<this._meshInstances.length;e++)this._meshInstances[e].material=t}get materialAssets(){return this._materialReferences.map((function(t){return t.id}))}set materialAssets(t=[]){if(this._materialReferences.length>t.length){for(let e=t.length;e<this._materialReferences.length;e++)this._materialReferences[e].id=null;this._materialReferences.length=t.length}for(let e=0;e<t.length;e++)if(this._materialReferences[e]||this._materialReferences.push(new Kp(e,this,this.system.app.assets,{add:this._onMaterialAdded,load:this._onMaterialLoad,remove:this._onMaterialRemove,unload:this._onMaterialUnload},this)),t[e]){const i=t[e]instanceof Od?t[e].id:t[e];this._materialReferences[e].id!==i&&(this._materialReferences[e].id=i),this._materialReferences[e].asset&&this._onMaterialAdded(e,this,this._materialReferences[e].asset)}else this._materialReferences[e].id=null,this._meshInstances[e]&&(this._meshInstances[e].material=this.system.defaultMaterial)}get asset(){return this._assetReference.id}set asset(t){const e=t instanceof Od?t.id:t;this._assetReference.id!==e&&(this._assetReference.asset&&this._assetReference.asset.resource&&this._onRenderAssetRemove(),this._assetReference.id=e,this._assetReference.asset&&this._onRenderAssetAdded())}resolveDuplicatedEntityReferenceProperties(t,e){t.rootBone&&e[t.rootBone]&&(this.rootBone=e[t.rootBone]),this._clearSkinInstances()}}class RS{constructor(){this.enabled=!0,this.rootBone=null}}const IS=[{name:"rootBone",type:"entity"},"enabled"],PS=["material","meshInstances","asset","materialAssets","castShadows","receiveShadows","castShadowsLightmap","lightmapped","lightmapSizeMultiplier","renderStyle","type","layers","isStatic","batchGroupId"];class LS extends bg{constructor(t){super(t),this.id="render",this.ComponentType=MS,this.DataType=RS,this.schema=IS,this.defaultMaterial=t.scene.defaultMaterial,this.on("beforeremove",this.onRemove,this)}initializeComponentData(t,e,i){null!==e.batchGroupId&&void 0!==e.batchGroupId||(e.batchGroupId=-1),e.layers&&e.layers.length&&(e.layers=e.layers.slice(0));for(let i=0;i<PS.length;i++)e.hasOwnProperty(PS[i])&&(t[PS[i]]=e[PS[i]]);e.aabbCenter&&e.aabbHalfExtents&&(t.customAabb=new Tt(new ht(e.aabbCenter),new ht(e.aabbHalfExtents))),super.initializeComponentData(t,e,IS)}cloneComponent(t,e){const i={};for(let e=0;e<PS.length;e++)i[PS[e]]=t.render[PS[e]];delete i.meshInstances;const n=this.addComponent(e,i),s=t.render.meshInstances,r=s.map(t=>t.mesh);n._onSetMeshes(r);for(let t=0;t<s.length;t++)n.meshInstances[t].material=s[t].material;t.render.customAabb&&(n.customAabb=t.render.customAabb.clone())}onRemove(t,e){e.onRemove()}}gg._buildAccessors(MS.prototype,IS);const DS=["emitterExtents","emitterRadius","emitterExtentsInner","emitterRadiusInner","loop","initialVelocity","animSpeed","normalMap","particleNormal"],kS=["numParticles","lifetime","rate","rate2","startAngle","startAngle2","lighting","halfLambert","intensity","wrap","wrapBounds","depthWrite","noFog","sort","stretch","alignToMotion","preWarm","emitterShape","animTilesX","animTilesY","animStartFrame","animNumFrames","animNumAnimations","animIndex","randomizeAnimIndex","animLoop","colorMap","localSpace","screenSpace","orientation"],OS=["scaleGraph","scaleGraph2","colorGraph","colorGraph2","alphaGraph","alphaGraph2","velocityGraph","velocityGraph2","localVelocityGraph","localVelocityGraph2","rotationSpeedGraph","rotationSpeedGraph2","radialSpeedGraph","radialSpeedGraph2"],FS=["colorMapAsset","normalMapAsset","meshAsset","renderAsset"];let BS;class NS extends gg{constructor(t,e){super(t,e),this.on("set_colorMapAsset",this.onSetColorMapAsset,this),this.on("set_normalMapAsset",this.onSetNormalMapAsset,this),this.on("set_meshAsset",this.onSetMeshAsset,this),this.on("set_mesh",this.onSetMesh,this),this.on("set_renderAsset",this.onSetRenderAsset,this),this.on("set_loop",this.onSetLoop,this),this.on("set_blendType",this.onSetBlendType,this),this.on("set_depthSoftening",this.onSetDepthSoftening,this),this.on("set_layers",this.onSetLayers,this),DS.forEach(t=>{this.on("set_"+t,this.onSetSimpleProperty,this)}),kS.forEach(t=>{this.on("set_"+t,this.onSetComplexProperty,this)}),OS.forEach(t=>{this.on("set_"+t,this.onSetGraphProperty,this)}),this._requestedDepth=!1,this._drawOrder=0}get drawOrder(){return this._drawOrder}set drawOrder(t){this._drawOrder=t,this.emitter&&(this.emitter.drawOrder=t)}addModelToLayers(){if(this.data.model)for(let t=0;t<this.layers.length;t++){const e=this.system.app.scene.layers.getLayerById(this.layers[t]);e&&(e.addMeshInstances(this.data.model.meshInstances),this.emitter._layer=e)}}removeModelFromLayers(t){if(this.data.model)for(let t=0;t<this.layers.length;t++){const e=this.system.app.scene.layers.getLayerById(this.layers[t]);e&&e.removeMeshInstances(this.data.model.meshInstances)}}onSetLayers(t,e,i){if(this.data.model){for(let t=0;t<e.length;t++){const i=this.system.app.scene.layers.getLayerById(e[t]);i&&i.removeMeshInstances(this.data.model.meshInstances)}if(this.enabled&&this.entity.enabled)for(let t=0;t<i.length;t++){const e=this.system.app.scene.layers.getLayerById(i[t]);e&&e.addMeshInstances(this.data.model.meshInstances)}}}onLayersChanged(t,e){this.addModelToLayers(),t.off("add",this.onLayerAdded,this),t.off("remove",this.onLayerRemoved,this),e.on("add",this.onLayerAdded,this),e.on("remove",this.onLayerRemoved,this)}onLayerAdded(t){if(!this.data.model)return;this.layers.indexOf(t.id)<0||t.addMeshInstances(this.data.model.meshInstances)}onLayerRemoved(t){if(!this.data.model)return;this.layers.indexOf(t.id)<0||t.removeMeshInstances(this.data.model.meshInstances)}_bindColorMapAsset(t){if(t.on("load",this._onColorMapAssetLoad,this),t.on("unload",this._onColorMapAssetUnload,this),t.on("remove",this._onColorMapAssetRemove,this),t.on("change",this._onColorMapAssetChange,this),t.resource)this._onColorMapAssetLoad(t);else{if(!this.enabled||!this.entity.enabled)return;this.system.app.assets.load(t)}}_unbindColorMapAsset(t){t.off("load",this._onColorMapAssetLoad,this),t.off("unload",this._onColorMapAssetUnload,this),t.off("remove",this._onColorMapAssetRemove,this),t.off("change",this._onColorMapAssetChange,this)}_onColorMapAssetLoad(t){this.colorMap=t.resource}_onColorMapAssetUnload(t){this.colorMap=null}_onColorMapAssetRemove(t){this._onColorMapAssetUnload(t)}_onColorMapAssetChange(t){}onSetColorMapAsset(t,e,i){const n=this.system.app.assets;if(e){const t=n.get(e);t&&this._unbindColorMapAsset(t)}if(i){i instanceof Od&&(this.data.colorMapAsset=i.id,i=i.id);const t=n.get(i);t?this._bindColorMapAsset(t):n.once("add:"+i,t=>{this._bindColorMapAsset(t)})}else this.colorMap=null}_bindNormalMapAsset(t){if(t.on("load",this._onNormalMapAssetLoad,this),t.on("unload",this._onNormalMapAssetUnload,this),t.on("remove",this._onNormalMapAssetRemove,this),t.on("change",this._onNormalMapAssetChange,this),t.resource)this._onNormalMapAssetLoad(t);else{if(!this.enabled||!this.entity.enabled)return;this.system.app.assets.load(t)}}_unbindNormalMapAsset(t){t.off("load",this._onNormalMapAssetLoad,this),t.off("unload",this._onNormalMapAssetUnload,this),t.off("remove",this._onNormalMapAssetRemove,this),t.off("change",this._onNormalMapAssetChange,this)}_onNormalMapAssetLoad(t){this.normalMap=t.resource}_onNormalMapAssetUnload(t){this.normalMap=null}_onNormalMapAssetRemove(t){this._onNormalMapAssetUnload(t)}_onNormalMapAssetChange(t){}onSetNormalMapAsset(t,e,i){const n=this.system.app.assets;if(e){const t=n.get(e);t&&this._unbindNormalMapAsset(t)}if(i){i instanceof Od&&(this.data.normalMapAsset=i.id,i=i.id);const t=n.get(i);t?this._bindNormalMapAsset(t):n.once("add:"+i,t=>{this._bindNormalMapAsset(t)})}else this.normalMap=null}_bindMeshAsset(t){if(t.on("load",this._onMeshAssetLoad,this),t.on("unload",this._onMeshAssetUnload,this),t.on("remove",this._onMeshAssetRemove,this),t.on("change",this._onMeshAssetChange,this),t.resource)this._onMeshAssetLoad(t);else{if(!this.enabled||!this.entity.enabled)return;this.system.app.assets.load(t)}}_unbindMeshAsset(t){t.off("load",this._onMeshAssetLoad,this),t.off("unload",this._onMeshAssetUnload,this),t.off("remove",this._onMeshAssetRemove,this),t.off("change",this._onMeshAssetChange,this)}_onMeshAssetLoad(t){this._onMeshChanged(t.resource)}_onMeshAssetUnload(t){this.mesh=null}_onMeshAssetRemove(t){this._onMeshAssetUnload(t)}_onMeshAssetChange(t){}onSetMeshAsset(t,e,i){const n=this.system.app.assets;if(e){const t=n.get(e);t&&this._unbindMeshAsset(t)}if(i){i instanceof Od&&(this.data.meshAsset=i.id,i=i.id);const t=n.get(i);t&&this._bindMeshAsset(t)}else this._onMeshChanged(null)}onSetMesh(t,e,i){!i||i instanceof Od||"number"==typeof i?this.meshAsset=i:this._onMeshChanged(i)}_onMeshChanged(t){!t||t instanceof xh||(t=t.meshInstances[0]?t.meshInstances[0].mesh:null),this.data.mesh=t,this.emitter&&(this.emitter.mesh=t,this.emitter.resetMaterial(),this.rebuild())}onSetRenderAsset(t,e,i){const n=this.system.app.assets;if(e){const t=n.get(e);t&&this._unbindRenderAsset(t)}if(i){i instanceof Od&&(this.data.renderAsset=i.id,i=i.id);const t=n.get(i);t&&this._bindRenderAsset(t)}else this._onRenderChanged(null)}_bindRenderAsset(t){if(t.on("load",this._onRenderAssetLoad,this),t.on("unload",this._onRenderAssetUnload,this),t.on("remove",this._onRenderAssetRemove,this),t.resource)this._onRenderAssetLoad(t);else{if(!this.enabled||!this.entity.enabled)return;this.system.app.assets.load(t)}}_unbindRenderAsset(t){t.off("load",this._onRenderAssetLoad,this),t.off("unload",this._onRenderAssetUnload,this),t.off("remove",this._onRenderAssetRemove,this),t.resource&&t.resource.off("set:meshes",this._onRenderSetMeshes,this)}_onRenderAssetLoad(t){this._onRenderChanged(t.resource)}_onRenderAssetUnload(t){this._onRenderChanged(null)}_onRenderAssetRemove(t){this._onRenderAssetUnload(t)}_onRenderChanged(t){t?(t.off("set:meshes",this._onRenderSetMeshes,this),t.on("set:meshes",this._onRenderSetMeshes,this),t.meshes&&this._onRenderSetMeshes(t.meshes)):this._onMeshChanged(null)}_onRenderSetMeshes(t){this._onMeshChanged(t&&t[0])}onSetLoop(t,e,i){this.emitter&&(this.emitter[t]=i,this.emitter.resetTime())}onSetBlendType(t,e,i){this.emitter&&(this.emitter[t]=i,this.emitter.material.blendType=i,this.emitter.resetMaterial(),this.rebuild())}_requestDepth(){this._requestedDepth||(BS||(BS=this.system.app.scene.layers.getLayerById(Qt)),BS&&(BS.incrementCounter(),this._requestedDepth=!0))}_releaseDepth(){this._requestedDepth&&BS&&(BS.decrementCounter(),this._requestedDepth=!1)}onSetDepthSoftening(t,e,i){e!==i&&(i?(this.enabled&&this.entity.enabled&&this._requestDepth(),this.emitter&&(this.emitter[t]=i)):(this.enabled&&this.entity.enabled&&this._releaseDepth(),this.emitter&&(this.emitter[t]=i)),this.emitter&&(this.reset(),this.emitter.resetMaterial(),this.rebuild()))}onSetSimpleProperty(t,e,i){this.emitter&&(this.emitter[t]=i,this.emitter.resetMaterial())}onSetComplexProperty(t,e,i){this.emitter&&(this.emitter[t]=i,this.emitter.resetMaterial(),this.rebuild(),this.reset())}onSetGraphProperty(t,e,i){this.emitter&&(this.emitter[t]=i,this.emitter.rebuildGraphs(),this.emitter.resetMaterial())}onEnable(){const t=this.data;for(let e=0,i=FS.length;e<i;e++){let i=t[FS[e]];if(i){if(!(i instanceof Od)){if(!(parseInt(i,10)>=0))continue;i=this.system.app.assets.get(i)}i&&!i.resource&&this.system.app.assets.load(i)}}if(!this.emitter){let e=t.mesh;e instanceof xh||(e=null),this.emitter=new Fu(this.system.app.graphicsDevice,{numParticles:t.numParticles,emitterExtents:t.emitterExtents,emitterExtentsInner:t.emitterExtentsInner,emitterRadius:t.emitterRadius,emitterRadiusInner:t.emitterRadiusInner,emitterShape:t.emitterShape,initialVelocity:t.initialVelocity,wrap:t.wrap,localSpace:t.localSpace,screenSpace:t.screenSpace,wrapBounds:t.wrapBounds,lifetime:t.lifetime,rate:t.rate,rate2:t.rate2,orientation:t.orientation,particleNormal:t.particleNormal,animTilesX:t.animTilesX,animTilesY:t.animTilesY,animStartFrame:t.animStartFrame,animNumFrames:t.animNumFrames,animNumAnimations:t.animNumAnimations,animIndex:t.animIndex,randomizeAnimIndex:t.randomizeAnimIndex,animSpeed:t.animSpeed,animLoop:t.animLoop,startAngle:t.startAngle,startAngle2:t.startAngle2,scaleGraph:t.scaleGraph,scaleGraph2:t.scaleGraph2,colorGraph:t.colorGraph,colorGraph2:t.colorGraph2,alphaGraph:t.alphaGraph,alphaGraph2:t.alphaGraph2,localVelocityGraph:t.localVelocityGraph,localVelocityGraph2:t.localVelocityGraph2,velocityGraph:t.velocityGraph,velocityGraph2:t.velocityGraph2,rotationSpeedGraph:t.rotationSpeedGraph,rotationSpeedGraph2:t.rotationSpeedGraph2,radialSpeedGraph:t.radialSpeedGraph,radialSpeedGraph2:t.radialSpeedGraph2,colorMap:t.colorMap,normalMap:t.normalMap,loop:t.loop,preWarm:t.preWarm,sort:t.sort,stretch:t.stretch,alignToMotion:t.alignToMotion,lighting:t.lighting,halfLambert:t.halfLambert,intensity:t.intensity,depthSoftening:t.depthSoftening,scene:this.system.app.scene,mesh:e,depthWrite:t.depthWrite,noFog:t.noFog,node:this.entity,blendType:t.blendType}),this.emitter.meshInstance.node=this.entity,this.emitter.drawOrder=this.drawOrder,this.psys=new Uu,this.psys.graph=this.entity,this.psys.emitter=this.emitter,this.psys.meshInstances=[this.emitter.meshInstance],t.model=this.psys,this.emitter.psys=this.psys,t.autoPlay||(this.pause(),this.emitter.meshInstance.visible=!1)}t.model&&this.emitter.colorMap&&this.addModelToLayers(),this.system.app.scene.on("set:layers",this.onLayersChanged,this),this.system.app.scene.layers&&(this.system.app.scene.layers.on("add",this.onLayerAdded,this),this.system.app.scene.layers.on("remove",this.onLayerRemoved,this)),this.enabled&&this.entity.enabled&&t.depthSoftening&&this._requestDepth()}onDisable(){this.system.app.scene.off("set:layers",this.onLayersChanged,this),this.system.app.scene.layers&&(this.system.app.scene.layers.off("add",this.onLayerAdded,this),this.system.app.scene.layers.off("remove",this.onLayerRemoved,this)),this.data.model&&(this.removeModelFromLayers(),this.data.depthSoftening&&this._releaseDepth()),this.emitter&&(this.emitter.camera=null)}onBeforeRemove(){this.enabled&&(this.enabled=!1);const t=this.data;t.model&&(this.entity.removeChild(t.model.getGraph()),t.model.destroy(),t.model=null),this.emitter&&(this.emitter.destroy(),this.emitter=null);for(let e=0;e<FS.length;e++){const i=FS[e];t[i]&&(this[i]=null)}this.off()}reset(){this.emitter&&this.emitter.reset()}stop(){this.emitter&&(this.emitter.loop=!1,this.emitter.resetTime(),this.emitter.addTime(0,!0))}pause(){this.data.paused=!0}unpause(){this.data.paused=!1}play(){this.data.paused=!1,this.emitter&&(this.emitter.meshInstance.visible=!0,this.emitter.loop=this.data.loop,this.emitter.resetTime())}isPlaying(){return!this.data.paused&&(!(!this.emitter||!this.emitter.loop)||Date.now()<=this.emitter.endTime)}rebuild(){const t=this.enabled;this.enabled=!1,this.emitter&&(this.emitter.rebuild(),this.emitter.meshInstance.node=this.entity,this.data.model.meshInstances=[this.emitter.meshInstance]),this.enabled=t}}class US{constructor(){this.numParticles=1,this.rate=1,this.rate2=null,this.startAngle=0,this.startAngle2=null,this.lifetime=50,this.emitterExtents=new ht,this.emitterExtentsInner=new ht,this.emitterRadius=0,this.emitterRadiusInner=0,this.emitterShape=Ae,this.initialVelocity=0,this.wrapBounds=new ht,this.localSpace=!1,this.screenSpace=!1,this.colorMap=null,this.colorMapAsset=null,this.normalMap=null,this.normalMapAsset=null,this.loop=!0,this.preWarm=!1,this.sort=0,this.mode=Ce,this.scene=null,this.lighting=!1,this.halfLambert=!1,this.intensity=1,this.stretch=0,this.alignToMotion=!1,this.depthSoftening=0,this.meshAsset=null,this.mesh=null,this.depthWrite=!1,this.noFog=!1,this.orientation=Me,this.particleNormal=new ht(0,1,0),this.animTilesX=1,this.animTilesY=1,this.animStartFrame=0,this.animNumFrames=1,this.animNumAnimations=1,this.animIndex=0,this.randomizeAnimIndex=!1,this.animSpeed=1,this.animLoop=!0,this.scaleGraph=null,this.scaleGraph2=null,this.colorGraph=null,this.colorGraph2=null,this.alphaGraph=null,this.alphaGraph2=null,this.localVelocityGraph=null,this.localVelocityGraph2=null,this.velocityGraph=null,this.velocityGraph2=null,this.rotationSpeedGraph=null,this.rotationSpeedGraph2=null,this.radialSpeedGraph=null,this.radialSpeedGraph2=null,this.blendType=Pt,this.model=null,this.enabled=!0,this.paused=!1,this.autoPlay=!0,this.layers=[Zt]}}const VS=["enabled","autoPlay","numParticles","lifetime","rate","rate2","startAngle","startAngle2","loop","preWarm","lighting","halfLambert","intensity","depthWrite","noFog","depthSoftening","sort","blendType","stretch","alignToMotion","emitterShape","emitterExtents","emitterExtentsInner","emitterRadius","emitterRadiusInner","initialVelocity","wrap","wrapBounds","localSpace","screenSpace","colorMapAsset","normalMapAsset","mesh","meshAsset","renderAsset","orientation","particleNormal","localVelocityGraph","localVelocityGraph2","velocityGraph","velocityGraph2","rotationSpeedGraph","rotationSpeedGraph2","radialSpeedGraph","radialSpeedGraph2","scaleGraph","scaleGraph2","colorGraph","colorGraph2","alphaGraph","alphaGraph2","colorMap","normalMap","animTilesX","animTilesY","animStartFrame","animNumFrames","animNumAnimations","animIndex","randomizeAnimIndex","animSpeed","animLoop","layers"];class zS extends bg{constructor(t){super(t),this.id="particlesystem",this.ComponentType=NS,this.DataType=US,this.schema=VS,this.propertyTypes={emitterExtents:"vec3",emitterExtentsInner:"vec3",particleNormal:"vec3",wrapBounds:"vec3",localVelocityGraph:"curveset",localVelocityGraph2:"curveset",velocityGraph:"curveset",velocityGraph2:"curveset",colorGraph:"curveset",colorGraph2:"curveset",alphaGraph:"curve",alphaGraph2:"curve",rotationSpeedGraph:"curve",rotationSpeedGraph2:"curve",radialSpeedGraph:"curve",radialSpeedGraph2:"curve",scaleGraph:"curve",scaleGraph2:"curve"},this.on("beforeremove",this.onBeforeRemove,this),this.app.systems.on("update",this.onUpdate,this)}initializeComponentData(t,e,i){const n={};i=[];const s=this.propertyTypes;(e.mesh instanceof Od||"number"==typeof e.mesh)&&(e.meshAsset=e.mesh,delete e.mesh);for(const t in e){if(e.hasOwnProperty(t)&&(i.push(t),n[t]=e[t]),"vec3"===s[t])Array.isArray(n[t])&&(n[t]=new ht(n[t][0],n[t][1],n[t][2]));else if("curve"===s[t]){if(!(n[t]instanceof at)){const e=n[t].type;n[t]=new at(n[t].keys),n[t].type=e}}else if("curveset"===s[t]&&!(n[t]instanceof lt)){const e=n[t].type;n[t]=new lt(n[t].keys),n[t].type=e}n.layers&&Array.isArray(n.layers)&&(n.layers=n.layers.slice(0))}super.initializeComponentData(t,n,i)}cloneComponent(t,e){const i=t.particlesystem.data,n=this.schema,s={};for(let t=0,e=n.length;t<e;t++){const e=n[t];let r=i[e];r instanceof ht||r instanceof at||r instanceof lt?(r=r.clone(),s[e]=r):"layers"===e?s.layers=i.layers.slice(0):null!=r&&(s[e]=r)}return this.addComponent(e,s)}onUpdate(t){const e=this.store;let i;const n=this.app.stats.particles;for(const s in e)if(e.hasOwnProperty(s)){const r=e[s],o=r.entity,a=r.data;if(a.enabled&&o.enabled){const e=a.model.emitter;if(!e.meshInstance.visible)continue;if(e.lighting){const t=a.layers;for(let i=0;i<t.length;i++){const n=this.app.scene.layers.getLayerById(t[i]);if(!n)continue;n._lightCube||(n._lightCube=new Float32Array(18));const s=n._lightCube;for(let t=0;t<6;t++)s[3*t]=this.app.scene.ambientLight.r,s[3*t+1]=this.app.scene.ambientLight.g,s[3*t+2]=this.app.scene.ambientLight.b;const r=n._splitLights[ee];for(let t=0;t<r.length;t++)for(let i=0;i<6;i++){const n=Math.max(e.lightCubeDir[i].dot(r[t]._direction),0)*r[t]._intensity;s[3*i]+=r[t]._color.r*n,s[3*i+1]+=r[t]._color.g*n,s[3*i+2]+=r[t]._color.b*n}}e.constantLightCube.setValue(lightCube)}if(!a.paused){if(e.simTime+=t,e.simTime>e.fixedTimeStep&&(i=Math.floor(e.simTime/e.fixedTimeStep),e.simTime-=i*e.fixedTimeStep),i){i=Math.min(i,e.maxSubSteps);for(let t=0;t<i;t++)e.addTime(e.fixedTimeStep,!1);n._updatesPerFrame+=i,n._frameTime+=e._addTimeTime,e._addTimeTime=0}e.finishFrame()}}}}onBeforeRemove(t,e){e.onBeforeRemove()}destroy(){super.destroy(),this.app.systems.off("update",this.onUpdate,this)}}gg._buildAccessors(NS.prototype,VS);class WS{constructor(t,e){this._constructor=t,this._pool=[],this._count=0,this._resize(e)}_resize(t){if(t>this._pool.length)for(let e=this._pool.length;e<t;e++)this._pool[e]=new this._constructor}allocate(){return this._count>=this._pool.length&&this._resize(2*this._pool.length),this._pool[this._count++]}freeAll(){this._count=0}}let GS,jS,HS,XS,YS,qS,KS;class ZS extends gg{constructor(t,e){super(t,e),"undefined"==typeof Ammo||GS||(GS=new Ammo.btTransform,jS=new Ammo.btVector3,HS=new Ammo.btVector3,XS=new Ammo.btQuaternion,YS=new Ammo.btVector3(0,0,0)),this._angularDamping=0,this._angularFactor=new ht(1,1,1),this._angularVelocity=new ht,this._body=null,this._friction=.5,this._group=my,this._linearDamping=0,this._linearFactor=new ht(1,1,1),this._linearVelocity=new ht,this._mask=Dy,this._mass=1,this._restitution=0,this._rollingFriction=0,this._simulationEnabled=!1,this._type=iy}get angularDamping(){return this._angularDamping}set angularDamping(t){this._angularDamping!==t&&(this._angularDamping=t,this._body&&this._body.setDamping(this._linearDamping,t))}get angularFactor(){return this._angularFactor}set angularFactor(t){this._angularFactor.equals(t)||(this._angularFactor.copy(t),this._body&&this._type===ny&&(jS.setValue(t.x,t.y,t.z),this._body.setAngularFactor(jS)))}get angularVelocity(){if(this._body&&this._type===ny){const t=this._body.getAngularVelocity();this._angularVelocity.set(t.x(),t.y(),t.z())}return this._angularVelocity}set angularVelocity(t){this._body&&this._type===ny&&(this._body.activate(),jS.setValue(t.x,t.y,t.z),this._body.setAngularVelocity(jS),this._angularVelocity.copy(t))}get body(){return this._body}set body(t){this._body!==t&&(this._body=t,t&&this._simulationEnabled&&t.activate())}get friction(){return this._friction}set friction(t){this._friction!==t&&(this._friction=t,this._body&&this._body.setFriction(t))}get group(){return this._group}set group(t){this._group!==t&&(this._group=t,this.enabled&&this.entity.enabled&&(this.disableSimulation(),this.enableSimulation()))}get linearDamping(){return this._linearDamping}set linearDamping(t){this._linearDamping!==t&&(this._linearDamping=t,this._body&&this._body.setDamping(t,this._angularDamping))}get linearFactor(){return this._linearFactor}set linearFactor(t){this._linearFactor.equals(t)||(this._linearFactor.copy(t),this._body&&this._type===ny&&(jS.setValue(t.x,t.y,t.z),this._body.setLinearFactor(jS)))}get linearVelocity(){if(this._body&&this._type===ny){const t=this._body.getLinearVelocity();this._linearVelocity.set(t.x(),t.y(),t.z())}return this._linearVelocity}set linearVelocity(t){this._body&&this._type===ny&&(this._body.activate(),jS.setValue(t.x,t.y,t.z),this._body.setLinearVelocity(jS),this._linearVelocity.copy(t))}get mask(){return this._mask}set mask(t){this._mask!==t&&(this._mask=t,this.enabled&&this.entity.enabled&&(this.disableSimulation(),this.enableSimulation()))}get mass(){return this._mass}set mass(t){if(this._mass!==t&&(this._mass=t,this._body&&this._type===ny)){const e=this.enabled&&this.entity.enabled;e&&this.disableSimulation(),this._body.getCollisionShape().calculateLocalInertia(t,jS),this._body.setMassProps(t,jS),this._body.updateInertiaTensor(),e&&this.enableSimulation()}}get restitution(){return this._restitution}set restitution(t){this._restitution!==t&&(this._restitution=t,this._body&&this._body.setRestitution(t))}get rollingFriction(){return this._rollingFriction}set rollingFriction(t){this._rollingFriction!==t&&(this._rollingFriction=t,this._body&&this._body.setRollingFriction(t))}get type(){return this._type}set type(t){if(this._type!==t){switch(this._type=t,this.disableSimulation(),t){case ny:this._group=fy,this._mask=Py;break;case sy:this._group=gy,this._mask=Py;break;case iy:default:this._group=my,this._mask=Dy}this.createBody()}}createBody(){const t=this.entity;let e;if(t.collision&&(e=t.collision.shape,t.trigger&&(t.trigger.destroy(),delete t.trigger)),e){this._body&&this.system.onRemove(t,this);const i=this._type===ny?this._mass:0;this._getEntityTransform(GS);const n=this.system.createBody(i,e,GS);if(n.setRestitution(this._restitution),n.setFriction(this._friction),n.setRollingFriction(this._rollingFriction),n.setDamping(this._linearDamping,this._angularDamping),this._type===ny){const t=this._linearFactor;jS.setValue(t.x,t.y,t.z),n.setLinearFactor(jS);const e=this._angularFactor;jS.setValue(e.x,e.y,e.z),n.setAngularFactor(jS)}else this._type===sy&&(n.setCollisionFlags(n.getCollisionFlags()|oy),n.setActivationState(_y));n.entity=t,this.body=n,this.enabled&&t.enabled&&this.enableSimulation()}}isActive(){return!!this._body&&this._body.isActive()}activate(){this._body&&this._body.activate()}enableSimulation(){const t=this.entity;if(t.collision&&t.collision.enabled&&!this._simulationEnabled){const e=this._body;if(e){switch(this.system.addBody(e,this._group,this._mask),this._type){case ny:this.system._dynamic.push(this),e.forceActivationState(ly),this.syncEntityToBody();break;case sy:this.system._kinematic.push(this),e.forceActivationState(_y);break;case iy:e.forceActivationState(ly),this.syncEntityToBody()}"compound"===t.collision.type&&this.system._compounds.push(t.collision),e.activate(),this._simulationEnabled=!0}}}disableSimulation(){const t=this._body;if(t&&this._simulationEnabled){const e=this.system;let i=e._compounds.indexOf(this.entity.collision);i>-1&&e._compounds.splice(i,1),i=e._dynamic.indexOf(this),i>-1&&e._dynamic.splice(i,1),i=e._kinematic.indexOf(this),i>-1&&e._kinematic.splice(i,1),e.removeBody(t),t.forceActivationState(uy),this._simulationEnabled=!1}}applyForce(){let t,e,i,n,s,r;switch(arguments.length){case 1:t=arguments[0].x,e=arguments[0].y,i=arguments[0].z;break;case 2:t=arguments[0].x,e=arguments[0].y,i=arguments[0].z,n=arguments[1].x,s=arguments[1].y,r=arguments[1].z;break;case 3:t=arguments[0],e=arguments[1],i=arguments[2];break;case 6:t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3],s=arguments[4],r=arguments[5]}const o=this._body;o&&(o.activate(),jS.setValue(t,e,i),void 0!==n?(HS.setValue(n,s,r),o.applyForce(jS,HS)):o.applyForce(jS,YS))}applyTorque(){let t,e,i;switch(arguments.length){case 1:t=arguments[0].x,e=arguments[0].y,i=arguments[0].z;break;case 3:t=arguments[0],e=arguments[1],i=arguments[2];break;default:return}const n=this._body;n&&(n.activate(),jS.setValue(t,e,i),n.applyTorque(jS))}applyImpulse(){let t,e,i,n,s,r;switch(arguments.length){case 1:t=arguments[0].x,e=arguments[0].y,i=arguments[0].z;break;case 2:t=arguments[0].x,e=arguments[0].y,i=arguments[0].z,n=arguments[1].x,s=arguments[1].y,r=arguments[1].z;break;case 3:t=arguments[0],e=arguments[1],i=arguments[2];break;case 6:t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3],s=arguments[4],r=arguments[5];break;default:return}const o=this._body;o&&(o.activate(),jS.setValue(t,e,i),void 0!==n?(HS.setValue(n,s,r),o.applyImpulse(jS,HS)):o.applyImpulse(jS,YS))}applyTorqueImpulse(){let t,e,i;switch(arguments.length){case 1:t=arguments[0].x,e=arguments[0].y,i=arguments[0].z;break;case 3:t=arguments[0],e=arguments[1],i=arguments[2];break;default:return}const n=this._body;n&&(n.activate(),jS.setValue(t,e,i),n.applyTorqueImpulse(jS))}isStatic(){return this._type===iy}isStaticOrKinematic(){return this._type===iy||this._type===sy}isKinematic(){return this._type===sy}_getEntityTransform(t){const e=this.entity,i=e.getPosition(),n=e.getRotation();jS.setValue(i.x,i.y,i.z),XS.setValue(n.x,n.y,n.z,n.w),t.setOrigin(jS),t.setRotation(XS)}syncEntityToBody(){const t=this._body;if(t){if(this._getEntityTransform(GS),t.setWorldTransform(GS),this._type===sy){const e=t.getMotionState();e&&e.setWorldTransform(GS)}t.activate()}}_updateDynamic(){const t=this._body;if(t.isActive()){const e=t.getMotionState();if(e){e.getWorldTransform(GS);const t=GS.getOrigin(),i=GS.getRotation();this.entity.setPosition(t.x(),t.y(),t.z()),this.entity.setRotation(i.x(),i.y(),i.z(),i.w())}}}_updateKinematic(){const t=this._body.getMotionState();t&&(this._getEntityTransform(GS),t.setWorldTransform(GS))}teleport(){arguments.length<3?(arguments[0]&&this.entity.setPosition(arguments[0]),arguments[1]&&(arguments[1]instanceof yt?this.entity.setRotation(arguments[1]):this.entity.setEulerAngles(arguments[1]))):(6===arguments.length&&this.entity.setEulerAngles(arguments[3],arguments[4],arguments[5]),this.entity.setPosition(arguments[0],arguments[1],arguments[2])),this.syncEntityToBody()}onEnable(){this._body||this.createBody(),this.enableSimulation()}onDisable(){this.disableSimulation()}}class QS{constructor(){this.enabled=!0}}const $S={};let JS={};class tx{constructor(t,e,i){this.entity=t,this.point=e,this.normal=i}}class ex{constructor(t,e,i){0===arguments.length?(this.a=null,this.b=null,this.localPointA=new ht,this.localPointB=new ht,this.pointA=new ht,this.pointB=new ht,this.normal=new ht):(this.a=t,this.b=e,this.localPointA=i.localPoint,this.localPointB=i.localPointOther,this.pointA=i.point,this.pointB=i.pointOther,this.normal=i.normal)}}class ix{constructor(t=new ht,e=new ht,i=new ht,n=new ht,s=new ht){this.localPoint=t,this.localPointOther=e,this.point=i,this.pointOther=n,this.normal=s}}class nx{constructor(t,e){this.other=t,this.contacts=e}}const sx=["enabled"];class rx extends bg{constructor(t){super(t),this.id="rigidbody",this._stats=t.stats.frame,this.ComponentType=ZS,this.DataType=QS,this.contactPointPool=null,this.contactResultPool=null,this.singleContactResultPool=null,this.schema=sx,this.maxSubSteps=10,this.fixedTimeStep=1/60,this.gravity=new ht(0,-9.81,0),this._dynamic=[],this._kinematic=[],this._triggers=[],this._compounds=[],this.on("beforeremove",this.onBeforeRemove,this),this.on("remove",this.onRemove,this)}onLibraryLoaded(){if("undefined"!=typeof Ammo){if(this.collisionConfiguration=new Ammo.btDefaultCollisionConfiguration,this.dispatcher=new Ammo.btCollisionDispatcher(this.collisionConfiguration),this.overlappingPairCache=new Ammo.btDbvtBroadphase,this.solver=new Ammo.btSequentialImpulseConstraintSolver,this.dynamicsWorld=new Ammo.btDiscreteDynamicsWorld(this.dispatcher,this.overlappingPairCache,this.solver,this.collisionConfiguration),this.dynamicsWorld.setInternalTickCallback){const t=Ammo.addFunction(this._checkForCollisions.bind(this),"vif");this.dynamicsWorld.setInternalTickCallback(t)}qS=new Ammo.btVector3,KS=new Ammo.btVector3,this.contactPointPool=new WS(ix,1),this.contactResultPool=new WS(nx,1),this.singleContactResultPool=new WS(ex,1),this.app.systems.on("update",this.onUpdate,this)}else this.app.systems.off("update",this.onUpdate,this)}initializeComponentData(t,e,i){const n=["mass","linearDamping","angularDamping","linearFactor","angularFactor","friction","rollingFriction","restitution","type","group","mask"];for(const i of n)if(e.hasOwnProperty(i)){const n=e[i];Array.isArray(n)?t[i]=new ht(n[0],n[1],n[2]):t[i]=n}super.initializeComponentData(t,e,["enabled"])}cloneComponent(t,e){const i=t.rigidbody,n={enabled:i.enabled,mass:i.mass,linearDamping:i.linearDamping,angularDamping:i.angularDamping,linearFactor:[i.linearFactor.x,i.linearFactor.y,i.linearFactor.z],angularFactor:[i.angularFactor.x,i.angularFactor.y,i.angularFactor.z],friction:i.friction,rollingFriction:i.rollingFriction,restitution:i.restitution,type:i.type,group:i.group,mask:i.mask};this.addComponent(e,n)}onBeforeRemove(t,e){e.enabled&&(e.enabled=!1)}onRemove(t,e){const i=e.body;i&&(this.removeBody(i),this.destroyBody(i),e.body=null)}addBody(t,e,i){void 0!==e&&void 0!==i?this.dynamicsWorld.addRigidBody(t,e,i):this.dynamicsWorld.addRigidBody(t)}removeBody(t){this.dynamicsWorld.removeRigidBody(t)}createBody(t,e,i){const n=new Ammo.btVector3(0,0,0);0!==t&&e.calculateLocalInertia(t,n);const s=new Ammo.btDefaultMotionState(i),r=new Ammo.btRigidBodyConstructionInfo(t,s,e,n),o=new Ammo.btRigidBody(r);return Ammo.destroy(r),Ammo.destroy(n),o}destroyBody(t){const e=t.getMotionState();e&&Ammo.destroy(e),Ammo.destroy(t)}raycastFirst(t,e){let i=null;qS.setValue(t.x,t.y,t.z),KS.setValue(e.x,e.y,e.z);const n=new Ammo.ClosestRayResultCallback(qS,KS);if(this.dynamicsWorld.rayTest(qS,KS,n),n.hasHit()){const t=n.get_m_collisionObject(),e=Ammo.castObject(t,Ammo.btRigidBody);if(e){const t=n.get_m_hitPointWorld(),s=n.get_m_hitNormalWorld();if(i=new tx(e.entity,new ht(t.x(),t.y(),t.z()),new ht(s.x(),s.y(),s.z())),arguments.length>2){(0,arguments[2])(i)}}}return Ammo.destroy(n),i}raycastAll(t,e){const i=[];qS.setValue(t.x,t.y,t.z),KS.setValue(e.x,e.y,e.z);const n=new Ammo.AllHitsRayResultCallback(qS,KS);if(this.dynamicsWorld.rayTest(qS,KS,n),n.hasHit()){const t=n.get_m_collisionObjects(),e=n.get_m_hitPointWorld(),s=n.get_m_hitNormalWorld(),r=t.size();for(let n=0;n<r;n++){const r=Ammo.castObject(t.at(n),Ammo.btRigidBody);if(r){const t=e.at(n),o=s.at(n),a=new tx(r.entity,new ht(t.x(),t.y(),t.z()),new ht(o.x(),o.y(),o.z()));i.push(a)}}}return Ammo.destroy(n),i}_storeCollision(t,e){let i=!1;const n=t.getGuid();return $S[n]=$S[n]||{others:[],entity:t},$S[n].others.indexOf(e)<0&&($S[n].others.push(e),i=!0),JS[n]=JS[n]||{others:[],entity:t},JS[n].others.push(e),i}_createContactPointFromAmmo(t){const e=t.get_m_localPointA(),i=t.get_m_localPointB(),n=t.getPositionWorldOnA(),s=t.getPositionWorldOnB(),r=t.get_m_normalWorldOnB(),o=this.contactPointPool.allocate();return o.localPoint.set(e.x(),e.y(),e.z()),o.localPointOther.set(i.x(),i.y(),i.z()),o.point.set(n.x(),n.y(),n.z()),o.pointOther.set(s.x(),s.y(),s.z()),o.normal.set(r.x(),r.y(),r.z()),o}_createReverseContactPointFromAmmo(t){const e=t.get_m_localPointA(),i=t.get_m_localPointB(),n=t.getPositionWorldOnA(),s=t.getPositionWorldOnB(),r=t.get_m_normalWorldOnB(),o=this.contactPointPool.allocate();return o.localPointOther.set(e.x(),e.y(),e.z()),o.localPoint.set(i.x(),i.y(),i.z()),o.pointOther.set(n.x(),n.y(),n.z()),o.point.set(s.x(),s.y(),s.z()),o.normal.set(r.x(),r.y(),r.z()),o}_createSingleContactResult(t,e,i){const n=this.singleContactResultPool.allocate();return n.a=t,n.b=e,n.localPointA=i.localPoint,n.localPointB=i.localPointOther,n.pointA=i.point,n.pointB=i.pointOther,n.normal=i.normal,n}_createContactResult(t,e){const i=this.contactResultPool.allocate();return i.other=t,i.contacts=e,i}_cleanOldCollisions(){for(const t in $S)if($S.hasOwnProperty(t)){const e=JS[t],i=$S[t],n=i.entity,s=n.collision,r=n.rigidbody,o=i.others;let a=o.length;for(;a--;){const t=o[a];(!e||e.others.indexOf(t)<0)&&(o.splice(a,1),n.trigger?(s&&s.fire("triggerleave",t),t.rigidbody&&t.rigidbody.fire("triggerleave",n)):t.trigger||(r&&r.fire("collisionend",t),s&&s.fire("collisionend",t)))}0===o.length&&delete $S[t]}}_hasContactEvent(t){const e=t.collision;if(e&&(e.hasEvent("collisionstart")||e.hasEvent("collisionend")||e.hasEvent("contact")))return!0;const i=t.rigidbody;return i&&(i.hasEvent("collisionstart")||i.hasEvent("collisionend")||i.hasEvent("contact"))}_checkForCollisions(t,e){const i=Ammo.wrapPointer(t,Ammo.btDynamicsWorld).getDispatcher(),n=i.getNumManifolds();JS={};for(let t=0;t<n;t++){const e=i.getManifoldByIndexInternal(t),n=e.getBody0(),s=e.getBody1(),r=Ammo.castObject(n,Ammo.btRigidBody),o=Ammo.castObject(s,Ammo.btRigidBody),a=r.entity,l=o.entity;if(!a||!l)continue;const h=r.getCollisionFlags(),c=o.getCollisionFlags(),_=e.getNumContacts(),u=[],d=[];let p;if(_>0)if(h&ay||c&ay){const t=a.collision&&(a.collision.hasEvent("triggerenter")||a.collision.hasEvent("triggerleave")),e=l.collision&&(l.collision.hasEvent("triggerenter")||l.collision.hasEvent("triggerleave")),i=a.rigidbody&&(a.rigidbody.hasEvent("triggerenter")||a.rigidbody.hasEvent("triggerleave")),n=l.rigidbody&&(l.rigidbody.hasEvent("triggerenter")||l.rigidbody.hasEvent("triggerleave"));t&&(p=this._storeCollision(a,l),!p||c&ay||a.collision.fire("triggerenter",l)),e&&(p=this._storeCollision(l,a),!p||h&ay||l.collision.fire("triggerenter",a)),i&&(p||(p=this._storeCollision(l,a)),p&&a.rigidbody.fire("triggerenter",l)),n&&(p||(p=this._storeCollision(a,l)),p&&l.rigidbody.fire("triggerenter",a))}else{const t=this._hasContactEvent(a),i=this._hasContactEvent(l),n=this.hasEvent("contact");if(n||t||i){for(let s=0;s<_;s++){const r=e.getContactPoint(s),o=this._createContactPointFromAmmo(r);if(t||i){u.push(o);const t=this._createReverseContactPointFromAmmo(r);d.push(t)}if(n){const t=this._createSingleContactResult(a,l,o);this.fire("contact",t)}}if(t){const t=this._createContactResult(l,u);p=this._storeCollision(a,l),a.collision&&(a.collision.fire("contact",t),p&&a.collision.fire("collisionstart",t)),a.rigidbody&&(a.rigidbody.fire("contact",t),p&&a.rigidbody.fire("collisionstart",t))}if(i){const t=this._createContactResult(a,d);p=this._storeCollision(l,a),l.collision&&(l.collision.fire("contact",t),p&&l.collision.fire("collisionstart",t)),l.rigidbody&&(l.rigidbody.fire("contact",t),p&&l.rigidbody.fire("collisionstart",t))}}}}this._cleanOldCollisions(),this.contactPointPool.freeAll(),this.contactResultPool.freeAll(),this.singleContactResultPool.freeAll()}onUpdate(t){let e,i;const n=this.dynamicsWorld.getGravity();n.x()===this.gravity.x&&n.y()===this.gravity.y&&n.z()===this.gravity.z||(n.setValue(this.gravity.x,this.gravity.y,this.gravity.z),this.dynamicsWorld.setGravity(n));const s=this._triggers;for(e=0,i=s.length;e<i;e++)s[e].updateTransform();const r=this._compounds;for(e=0,i=r.length;e<i;e++)r[e]._updateCompound();const o=this._kinematic;for(e=0,i=o.length;e<i;e++)o[e]._updateKinematic();this.dynamicsWorld.stepSimulation(t,this.maxSubSteps,this.fixedTimeStep);const a=this._dynamic;for(e=0,i=a.length;e<i;e++)a[e]._updateDynamic();this.dynamicsWorld.setInternalTickCallback||this._checkForCollisions(Ammo.getPointer(this.dynamicsWorld),t)}destroy(){super.destroy(),this.app.systems.off("update",this.onUpdate,this),"undefined"!=typeof Ammo&&(Ammo.destroy(this.dynamicsWorld),Ammo.destroy(this.solver),Ammo.destroy(this.overlappingPairCache),Ammo.destroy(this.dispatcher),Ammo.destroy(this.collisionConfiguration),this.dynamicsWorld=null,this.solver=null,this.overlappingPairCache=null,this.dispatcher=null,this.collisionConfiguration=null)}}gg._buildAccessors(ZS.prototype,sx);const ox="none",ax="blend",lx=new bt;class hx extends gg{constructor(t,e){super(t,e),this._resolution=new _t(640,320),this._referenceResolution=new _t(640,320),this._scaleMode=ox,this.scale=1,this._scaleBlend=.5,this._priority=0,this._screenSpace=!1,this.cull=this._screenSpace,this._screenMatrix=new bt,this._elements=new Set,t.app.graphicsDevice.on("resizecanvas",this._onResize,this)}syncDrawOrder(){this.system.queueDrawOrderSync(this.entity.getGuid(),this._processDrawOrderSync,this)}_recurseDrawOrderSync(t,e){if(!(t instanceof uA))return e;if(t.element){const i=t.element.drawOrder;t.element.drawOrder=e++,t.element._batchGroupId>=0&&i!==t.element.drawOrder&&this.system.app.batcher.markGroupDirty(t.element._batchGroupId)}t.particlesystem&&(t.particlesystem.drawOrder=e++);const i=t.children;for(let t=0;t<i.length;t++)e=this._recurseDrawOrderSync(i[t],e);return e}_processDrawOrderSync(){this._recurseDrawOrderSync(this.entity,1),this.fire("syncdraworder")}_calcProjectionMatrix(){const t=this._resolution.x/this.scale,e=this._resolution.y/this.scale,i=t,n=-e;this._screenMatrix.setOrtho(0,i,n,0,1,-1),this._screenSpace||(lx.setScale(.5*t,.5*e,1),this._screenMatrix.mul2(lx,this._screenMatrix))}_updateScale(){this.scale=this._calcScale(this._resolution,this.referenceResolution)}_calcScale(t,e){const i=Math.log2(t.x/e.x),n=Math.log2(t.y/e.y);return Math.pow(2,i*(1-this._scaleBlend)+n*this._scaleBlend)}_onResize(t,e){this._screenSpace&&(this._resolution.set(t,e),this.resolution=this._resolution)}_bindElement(t){this._elements.add(t)}_unbindElement(t){this._elements.delete(t)}onRemove(){this.system.app.graphicsDevice.off("resizecanvas",this._onResize,this),this.fire("remove"),this._elements.forEach(t=>t._onScreenRemove()),this._elements.clear(),this.off()}set resolution(t){this._screenSpace?this._resolution.set(this.system.app.graphicsDevice.width,this.system.app.graphicsDevice.height):this._resolution.set(t.x,t.y),this._updateScale(),this._calcProjectionMatrix(),this.entity._dirtyLocal||this.entity._dirtifyLocal(),this.fire("set:resolution",this._resolution),this._elements.forEach(t=>t._onScreenResize(this._resolution))}get resolution(){return this._resolution}set referenceResolution(t){this._referenceResolution.set(t.x,t.y),this._updateScale(),this._calcProjectionMatrix(),this.entity._dirtyLocal||this.entity._dirtifyLocal(),this.fire("set:referenceresolution",this._resolution),this._elements.forEach(t=>t._onScreenResize(this._resolution))}get referenceResolution(){return this._scaleMode===ox?this._resolution:this._referenceResolution}set screenSpace(t){this._screenSpace=t,this._screenSpace&&this._resolution.set(this.system.app.graphicsDevice.width,this.system.app.graphicsDevice.height),this.resolution=this._resolution,this.entity._dirtyLocal||this.entity._dirtifyLocal(),this.fire("set:screenspace",this._screenSpace),this._elements.forEach(t=>t._onScreenSpaceChange())}get screenSpace(){return this._screenSpace}set scaleMode(t){t!==ox&&t!==ax&&(t=ox),this._screenSpace||t===ox||(t=ox),this._scaleMode=t,this.resolution=this._resolution,this.fire("set:scalemode",this._scaleMode)}get scaleMode(){return this._scaleMode}set scaleBlend(t){this._scaleBlend=t,this._updateScale(),this._calcProjectionMatrix(),this.entity._dirtyLocal||this.entity._dirtifyLocal(),this.fire("set:scaleblend",this._scaleBlend),this._elements.forEach(t=>t._onScreenResize(this._resolution))}get scaleBlend(){return this._scaleBlend}get priority(){return this._priority}set priority(t){t>255&&(t=255),this._priority=t}}class cx{constructor(){this.enabled=!0}}const _x=["enabled"];class ux extends bg{constructor(t){super(t),this.id="screen",this.ComponentType=hx,this.DataType=cx,this.schema=_x,this.windowResolution=new _t,this._drawOrderSyncQueue=new W,this.app.graphicsDevice.on("resizecanvas",this._onResize,this),this.app.systems.on("update",this._onUpdate,this),this.on("beforeremove",this.onRemoveComponent,this)}initializeComponentData(t,e,i){void 0!==e.priority&&(t.priority=e.priority),void 0!==e.screenSpace&&(t.screenSpace=e.screenSpace),t.cull=t.screenSpace,void 0!==e.scaleMode&&(t.scaleMode=e.scaleMode),void 0!==e.scaleBlend&&(t.scaleBlend=e.scaleBlend),void 0!==e.resolution&&(e.resolution instanceof _t?t._resolution.copy(e.resolution):t._resolution.set(e.resolution[0],e.resolution[1]),t.resolution=t._resolution),void 0!==e.referenceResolution&&(e.referenceResolution instanceof _t?t._referenceResolution.copy(e.referenceResolution):t._referenceResolution.set(e.referenceResolution[0],e.referenceResolution[1]),t.referenceResolution=t._referenceResolution),t.syncDrawOrder(),super.initializeComponentData(t,e,i)}destroy(){super.destroy(),this.app.graphicsDevice.off("resizecanvas",this._onResize,this),this.app.systems.off("update",this._onUpdate,this)}_onUpdate(t){const e=this.store;for(const i in e)e[i].entity.screen.update&&e[i].entity.screen.update(t)}_onResize(t,e){this.windowResolution.x=t,this.windowResolution.y=e}cloneComponent(t,e){const i=t.screen;return this.addComponent(e,{enabled:i.enabled,screenSpace:i.screenSpace,scaleMode:i.scaleMode,resolution:i.resolution.clone(),referenceResolution:i.referenceResolution.clone()})}onRemoveComponent(t,e){e.onRemove()}processDrawOrderSyncQueue(){const t=this._drawOrderSyncQueue.list();for(let e=0;e<t.length;e++){const i=t[e];i.callback.call(i.scope)}this._drawOrderSyncQueue.clear()}queueDrawOrderSync(t,e,i){this._drawOrderSyncQueue.list().length||this.app.once("prerender",this.processDrawOrderSyncQueue,this),this._drawOrderSyncQueue.has(t)||this._drawOrderSyncQueue.push(t,{callback:e,scope:i})}}gg._buildAccessors(hx.prototype,_x);const dx=["x","y","z","w"],px=[void 0,void 0,_t,ht,ut];function fx(t,e,i,n){var s,r;switch(e.type){case"boolean":return!!i;case"number":if("number"==typeof i)return i;if("string"==typeof i){var o=parseInt(i,10);return isNaN(o)?null:o}return"boolean"==typeof i?0+i:null;case"json":var a={};if(Array.isArray(e.schema))for(i&&"object"==typeof i||(i={}),s=0;s<e.schema.length;s++){var l=e.schema[s];if(l.name)if(l.array){a[l.name]=[];var h=Array.isArray(i[l.name])?i[l.name]:[];for(r=0;r<h.length;r++)a[l.name].push(fx(t,l,h[r]))}else{var c=i.hasOwnProperty(l.name)?i[l.name]:l.default;a[l.name]=fx(t,l,c)}}return a;case"asset":return i instanceof Od?i:"number"==typeof i?t.assets.get(i)||null:"string"==typeof i&&t.assets.get(parseInt(i,10))||null;case"entity":return i instanceof La?i:"string"==typeof i?t.getEntityFromIndex(i):null;case"rgb":case"rgba":if(i instanceof rt)return n instanceof rt?(n.copy(i),n):i.clone();if(i instanceof Array&&i.length>=3&&i.length<=4){for(s=0;s<i.length;s++)if("number"!=typeof i[s])return null;return n||(n=new rt),n.r=i[0],n.g=i[1],n.b=i[2],n.a=3===i.length?1:i[3],n}return"string"==typeof i&&/#([0-9abcdef]{2}){3,4}/i.test(i)?(n||(n=new rt),n.fromString(i),n):null;case"vec2":case"vec3":case"vec4":var _=parseInt(e.type.slice(3),10),u=px[_];if(i instanceof u)return n instanceof u?(n.copy(i),n):i.clone();if(i instanceof Array&&i.length===_){for(s=0;s<i.length;s++)if("number"!=typeof i[s])return null;for(n||(n=new u),s=0;s<_;s++)n[dx[s]]=i[s];return n}return null;case"curve":if(i){var d;if(i instanceof at||i instanceof lt)d=i.clone();else(d=new(i.keys[0]instanceof Array?lt:at)(i.keys)).type=i.type;return d}}return i}class mx{constructor(t){this.scriptType=t,this.index={}}add(t,e){this.index[t]||mx.reservedNames.has(t)||(this.index[t]=e,Object.defineProperty(this.scriptType.prototype,t,{get:function(){return this.__attributes[t]},set:function(i){const n="attr:"+t,s=this.__attributes[t];let r=s;if(s&&"json"!==e.type&&s.clone&&(this._callbacks.attr||this._callbacks[n])&&(r=s.clone()),e.array){if(this.__attributes[t]=[],i)for(let n=0,r=i.length;n<r;n++)this.__attributes[t].push(fx(this.app,e,i[n],s?s[n]:null))}else this.__attributes[t]=fx(this.app,e,i,s);this.fire("attr",t,this.__attributes[t],r),this.fire(n,this.__attributes[t],r)}}))}remove(t){return!!this.index[t]&&(delete this.index[t],delete this.scriptType.prototype[t],!0)}has(t){return!!this.index[t]}get(t){return this.index[t]||null}}mx.reservedNames=new Set(["app","entity","enabled","_enabled","_enabledOld","_destroyed","__attributes","__attributesRaw","__scriptType","__executionOrder","_callbacks","has","get","on","off","fire","once","hasEvent"]);class gx extends gg{constructor(t,e){super(t,e),this._scripts=[],this._updateList=new G({sortBy:"__executionOrder"}),this._postUpdateList=new G({sortBy:"__executionOrder"}),this._scriptsIndex={},this._destroyedScripts=[],this._destroyed=!1,this._scriptsData=null,this._oldState=!0,this._enabled=!0,this._beingEnabled=!1,this._isLoopingThroughScripts=!1,this._executionOrder=-1,this.on("set_enabled",this._onSetEnabled,this)}onEnable(){this._beingEnabled=!0,this._checkState(),this.entity._beingEnabled||this.onPostStateChange(),this._beingEnabled=!1}onDisable(){this._checkState()}onPostStateChange(){const t=this._beginLooping();for(let t=0,e=this.scripts.length;t<e;t++){const e=this.scripts[t];e._initialized&&!e._postInitialized&&e.enabled&&(e._postInitialized=!0,e.postInitialize&&this._scriptMethod(e,gx.scriptMethods.postInitialize))}this._endLooping(t)}_beginLooping(){const t=this._isLoopingThroughScripts;return this._isLoopingThroughScripts=!0,t}_endLooping(t){this._isLoopingThroughScripts=t,this._isLoopingThroughScripts||this._removeDestroyedScripts()}_onSetEnabled(t,e,i){this._beingEnabled=!0,this._checkState(),this._beingEnabled=!1}_checkState(){const t=this.enabled&&this.entity.enabled;if(t===this._oldState)return;this._oldState=t,this.fire(t?"enable":"disable"),this.fire("state",t),t?this.system._addComponentToEnabled(this):this.system._removeComponentFromEnabled(this);const e=this._beginLooping();for(let t=0,e=this.scripts.length;t<e;t++){const e=this.scripts[t];e.enabled=e._enabled}this._endLooping(e)}_onBeforeRemove(){this.fire("remove");const t=this._beginLooping();for(let t=0;t<this.scripts.length;t++){const e=this.scripts[t];e&&this.destroy(e.__scriptType.__name)}this._endLooping(t)}_removeDestroyedScripts(){const t=this._destroyedScripts.length;if(t){for(let e=0;e<t;e++){const t=this._destroyedScripts[e];this._removeScriptInstance(t)}this._destroyedScripts.length=0,this._resetExecutionOrder(0,this._scripts.length)}}_onInitializeAttributes(){for(let t=0,e=this.scripts.length;t<e;t++)this.scripts[t].__initializeAttributes()}_scriptMethod(t,e,i){t[e](i)}_onInitialize(){const t=this._scripts,e=this._beginLooping();for(let e=0,i=t.length;e<i;e++){const i=t[e];!i._initialized&&i.enabled&&(i._initialized=!0,i.initialize&&this._scriptMethod(i,gx.scriptMethods.initialize))}this._endLooping(e)}_onPostInitialize(){this.onPostStateChange()}_onUpdate(t){const e=this._updateList;if(!e.length)return;const i=this._beginLooping();for(e.loopIndex=0;e.loopIndex<e.length;e.loopIndex++){const i=e.items[e.loopIndex];i.enabled&&this._scriptMethod(i,gx.scriptMethods.update,t)}this._endLooping(i)}_onPostUpdate(t){const e=this._postUpdateList;if(!e.length)return;const i=this._beginLooping();for(e.loopIndex=0;e.loopIndex<e.length;e.loopIndex++){const i=e.items[e.loopIndex];i.enabled&&this._scriptMethod(i,gx.scriptMethods.postUpdate,t)}this._endLooping(i)}_insertScriptInstance(t,e,i){-1===e?(this._scripts.push(t),t.__executionOrder=i,t.update&&this._updateList.append(t),t.postUpdate&&this._postUpdateList.append(t)):(this._scripts.splice(e,0,t),t.__executionOrder=e,this._resetExecutionOrder(e+1,i+1),t.update&&this._updateList.insert(t),t.postUpdate&&this._postUpdateList.insert(t))}_removeScriptInstance(t){const e=this._scripts.indexOf(t);return-1===e||(this._scripts.splice(e,1),t.update&&this._updateList.remove(t),t.postUpdate&&this._postUpdateList.remove(t)),e}_resetExecutionOrder(t,e){for(let i=t;i<e;i++)this._scripts[i].__executionOrder=i}_resolveEntityScriptAttribute(t,e,i,n,s,r){if(t.array){const t=i.length;if(!t)return;const o=i.slice();for(let e=0;e<t;e++){const t=o[e]instanceof uA?o[e].getGuid():o[e];r[t]&&(o[e]=n?r[t].getGuid():r[t])}s[e]=o}else{if(i instanceof uA)i=i.getGuid();else if("string"!=typeof i)return;r[i]&&(s[e]=r[i])}}has(t){if("string"==typeof t)return!!this._scriptsIndex[t];if(!t)return!1;const e=t,i=e.__name,n=this._scriptsIndex[i];return(n&&n.instance)instanceof e}get(t){if("string"==typeof t){const e=this._scriptsIndex[t];return e?e.instance:null}if(!t)return null;const e=t,i=e.__name,n=this._scriptsIndex[i],s=n&&n.instance;return s instanceof e?s:null}create(t,e={}){const i=this;let n=t,s=t;if("string"==typeof n?n=this.system.app.scripts.get(n):n&&(s=n.__name),n){if(!this._scriptsIndex[s]||!this._scriptsIndex[s].instance){const t=new n({app:this.system.app,entity:this.entity,enabled:!e.hasOwnProperty("enabled")||e.enabled,attributes:e.attributes}),r=this._scripts.length;let o=-1;return"number"==typeof e.ind&&-1!==e.ind&&r>e.ind&&(o=e.ind),this._insertScriptInstance(t,o,r),this._scriptsIndex[s]={instance:t,onSwap:function(){i.swap(s)}},this[s]=t,e.preloading||t.__initializeAttributes(),this.fire("create",s,t),this.fire("create:"+s,t),this.system.app.scripts.on("swap:"+s,this._scriptsIndex[s].onSwap),e.preloading||(t.enabled&&!t._initialized&&(t._initialized=!0,t.initialize&&this._scriptMethod(t,gx.scriptMethods.initialize)),t.enabled&&!t._postInitialized&&(t._postInitialized=!0,t.postInitialize&&this._scriptMethod(t,gx.scriptMethods.postInitialize))),t}console.warn(`script '${s}' is already added to entity '${this.entity.name}'`)}else this._scriptsIndex[s]={awaiting:!0,ind:this._scripts.length},console.warn(`script '${s}' is not found, awaiting it to be added to registry`);return null}destroy(t){let e=t,i=t;"string"==typeof i?i=this.system.app.scripts.get(i):i&&(e=i.__name);const n=this._scriptsIndex[e];if(delete this._scriptsIndex[e],!n)return!1;const s=n.instance;if(s&&!s._destroyed)if(s.enabled=!1,s._destroyed=!0,this._isLoopingThroughScripts)this._destroyedScripts.push(s);else{const t=this._removeScriptInstance(s);t>=0&&this._resetExecutionOrder(t,this._scripts.length)}return this.system.app.scripts.off("swap:"+e,n.onSwap),delete this[e],this.fire("destroy",e,s||null),this.fire("destroy:"+e,s||null),s&&s.fire("destroy"),!0}swap(t){let e=t,i=t;"string"==typeof i?i=this.system.app.scripts.get(i):i&&(e=i.__name);const n=this._scriptsIndex[e];if(!n||!n.instance)return!1;const s=n.instance,r=this._scripts.indexOf(s),o=new i({app:this.system.app,entity:this.entity,enabled:s.enabled,attributes:s.__attributes});return!!o.swap&&(o.__initializeAttributes(),this._scripts[r]=o,this._scriptsIndex[e].instance=o,this[e]=o,o.__executionOrder=r,s.update&&this._updateList.remove(s),s.postUpdate&&this._postUpdateList.remove(s),o.update&&this._updateList.insert(o),o.postUpdate&&this._postUpdateList.insert(o),this._scriptMethod(o,gx.scriptMethods.swap,s),this.fire("swap",e,o),this.fire("swap:"+e,o),!0)}resolveDuplicatedEntityReferenceProperties(t,e){const i=this.entity.script;for(const n in t._scriptsIndex){const s=this.system.app.scripts.get(n);if(!s)continue;const r=t._scriptsIndex[n];if(!r||!r.instance)continue;const o=i[n].__attributesRaw,a=i[n].__attributes;if(!o&&!a)continue;const l=!!o,h=r.instance.__attributes;for(const t in h){if(!h[t])continue;const i=s.attributes.get(t);if(i)if("entity"===i.type)this._resolveEntityScriptAttribute(i,t,h[t],l,o||a,e);else if("json"===i.type&&Array.isArray(i.schema)){const n=h[t],s=o?o[t]:a[t];for(let t=0;t<i.schema.length;t++){const r=i.schema[t];if("entity"===r.type)if(i.array)for(let t=0;t<n.length;t++)this._resolveEntityScriptAttribute(r,r.name,n[t][r.name],l,s[t],e);else this._resolveEntityScriptAttribute(r,r.name,n[r.name],l,s,e)}}}}}move(t,e){const i=this._scripts.length;if(e>=i||e<0)return!1;let n=t,s=t;"string"!=typeof s?s=t.__name:n=null;const r=this._scriptsIndex[s];if(!r||!r.instance)return!1;const o=r.instance;if(n&&!(o instanceof n))return!1;const a=this._scripts.indexOf(o);return-1!==a&&a!==e&&(this._scripts.splice(e,0,this._scripts.splice(a,1)[0]),this._resetExecutionOrder(0,i),this._updateList.sort(),this._postUpdateList.sort(),this.fire("move",s,o,e,a),this.fire("move:"+s,o,e,a),!0)}get enabled(){return this._enabled}set enabled(t){const e=this._enabled;this._enabled=t,this.fire("set","enabled",e,t)}get scripts(){return this._scripts}set scripts(t){this._scriptsData=t;for(const e in t){if(!t.hasOwnProperty(e))continue;const i=this._scriptsIndex[e];if(i){if("boolean"==typeof t[e].enabled&&(i.enabled=!!t[e].enabled),"object"==typeof t[e].attributes)for(const n in t[e].attributes)if(!mx.reservedNames.has(n)){if(!i.__attributes.hasOwnProperty(n)){const t=this.system.app.scripts.get(e);t&&t.attributes.add(n,{})}i[n]=t[e].attributes[n]}}else console.log(this.order)}}}gx.scriptMethods={initialize:"initialize",postInitialize:"postInitialize",update:"update",postUpdate:"postUpdate",swap:"swap"};class bx{constructor(){this.enabled=!0}}let yx=0;class vx extends bg{constructor(t){super(t),this.id="script",this.ComponentType=gx,this.DataType=bx,this._components=new G({sortBy:"_executionOrder"}),this._enabledComponents=new G({sortBy:"_executionOrder"}),this.preloading=!0,this.on("beforeremove",this._onBeforeRemove,this),this.app.systems.on("initialize",this._onInitialize,this),this.app.systems.on("postInitialize",this._onPostInitialize,this),this.app.systems.on("update",this._onUpdate,this),this.app.systems.on("postUpdate",this._onPostUpdate,this)}initializeComponentData(t,e){if(t._executionOrder=yx++,this._components.append(t),yx>Number.MAX_SAFE_INTEGER&&this._resetExecutionOrder(),t.enabled=!e.hasOwnProperty("enabled")||!!e.enabled,t.enabled&&t.entity.enabled&&this._enabledComponents.append(t),e.hasOwnProperty("order")&&e.hasOwnProperty("scripts")){t._scriptsData=e.scripts;for(let i=0;i<e.order.length;i++)t.create(e.order[i],{enabled:e.scripts[e.order[i]].enabled,attributes:e.scripts[e.order[i]].attributes,preloading:this.preloading})}}cloneComponent(t,e){const i=[],n={};for(let e=0;e<t.script._scripts.length;e++){const s=t.script._scripts[e],r=s.__scriptType.__name;i.push(r);const o={};for(const t in s.__attributes)o[t]=s.__attributes[t];n[r]={enabled:s._enabled,attributes:o}}for(const e in t.script._scriptsIndex)e.awaiting&&i.splice(e.ind,0,e);const s={enabled:t.script.enabled,order:i,scripts:n};return this.addComponent(e,s)}_resetExecutionOrder(){yx=0;for(let t=0,e=this._components.length;t<e;t++)this._components.items[t]._executionOrder=yx++}_callComponentMethod(t,e,i){for(t.loopIndex=0;t.loopIndex<t.length;t.loopIndex++)t.items[t.loopIndex][e](i)}_onInitialize(){this.preloading=!1,this._callComponentMethod(this._components,"_onInitializeAttributes"),this._callComponentMethod(this._enabledComponents,"_onInitialize")}_onPostInitialize(){this._callComponentMethod(this._enabledComponents,"_onPostInitialize")}_onUpdate(t){this._callComponentMethod(this._enabledComponents,"_onUpdate",t)}_onPostUpdate(t){this._callComponentMethod(this._enabledComponents,"_onPostUpdate",t)}_addComponentToEnabled(t){this._enabledComponents.insert(t)}_removeComponentFromEnabled(t){this._enabledComponents.remove(t)}_onBeforeRemove(t,e){this._components.items.indexOf(e)>=0&&e._onBeforeRemove(),this._removeComponentFromEnabled(e),this._components.remove(e)}destroy(){super.destroy(),this.app.systems.off("initialize",this._onInitialize,this),this.app.systems.off("postInitialize",this._onPostInitialize,this),this.app.systems.off("update",this._onUpdate,this),this.app.systems.off("postUpdate",this._onPostUpdate,this)}}class Sx extends gg{constructor(t,e){super(t,e),this.on("set_scripts",this.onSetScripts,this)}send(t,e){const i=Array.prototype.slice.call(arguments,2),n=this.entity.script.instances;let s;if(n&&n[t]&&(s=n[t].instance[e],s))return s.apply(n[t].instance,i)}onEnable(){this.data.areScriptsLoaded&&!this.system.preloading&&(this.data.initialized?this.system._enableScriptComponent(this):this.system._initializeScriptComponent(this),this.data.postInitialized||this.system._postInitializeScriptComponent(this))}onDisable(){this.system._disableScriptComponent(this)}onSetScripts(t,e,i){if(!this.system._inTools||this.runInTools){if(this._updateScriptAttributes(e,i))return;this.enabled&&this.system._disableScriptComponent(this),this.system._destroyScriptComponent(this),this.data.areScriptsLoaded=!1;const t=i.map((function(t){return t.url}));if(this._loadFromCache(t))return;this._loadScripts(t)}}_updateScriptAttributes(t,e){let i=!0;if(t.length!==e.length)i=!1;else for(let n=0,s=e.length;n<s;n++)if(t[n].url!==e[n].url){i=!1;break}if(i)for(const t in this.instances)this.instances.hasOwnProperty(t)&&this.system._updateAccessors(this.entity,this.instances[t]);return i}_loadFromCache(t){const e=[],i=this.system.app._scriptPrefix||"",n=/^http(s)?:\/\//i;for(let s=0,r=t.length;s<r;s++){let r=t[s];n.test(r)||(r=T.join(i,r));const o=this.system.app.loader.getFromCache(r,"script");if(!o)return!1;e.push(o)}for(let i=0,n=e.length;i<n;i++){const n=e[i];if(!0!==n&&(n&&this.entity.script&&!this.entity.script.instances[n._pcScriptName])){const e=new n(this.entity);this.system._preRegisterInstance(this.entity,t[i],n._pcScriptName,e)}}return this.data&&(this.data.areScriptsLoaded=!0),this.system.preloading||(this.system.onInitialize(this.entity),this.system.onPostInitialize(this.entity)),!0}_loadScripts(t){let e=t.length;const i=this.system.app._scriptPrefix||"";t.forEach(t=>{let n=null,s=null;t.toLowerCase().startsWith("http://")||t.toLowerCase().startsWith("https://")?(s=t,n=t):(s=t,n=T.join(i,t)),this.system.app.loader.load(n,"script",(t,i)=>{if(e--,t)console.error(t);else if(i&&this.entity.script&&!this.entity.script.instances[i._pcScriptName]){const t=new i(this.entity);this.system._preRegisterInstance(this.entity,s,i._pcScriptName,t)}0===e&&(this.data.areScriptsLoaded=!0,this.system.preloading||(this.system.onInitialize(this.entity),this.system.onPostInitialize(this.entity)))})})}}class xx{constructor(){this.scripts=[],this.enabled=!0,this.instances={},this._instances={},this.runInTools=!1,this.attributes={},this.initialized=!1,this.postInitialized=!1,this.areScriptsLoaded=!1}}const wx=["enabled","scripts","instances","runInTools"];class Cx extends bg{constructor(t){super(t),this.id="script",this.ComponentType=Sx,this.DataType=xx,this.schema=wx,this.preloading=!1,this.instancesWithUpdate=[],this.instancesWithFixedUpdate=[],this.instancesWithPostUpdate=[],this.instancesWithToolsUpdate=[],this.on("beforeremove",this.onBeforeRemove,this),this.app.systems.on("initialize",this.onInitialize,this),this.app.systems.on("postInitialize",this.onPostInitialize,this),this.app.systems.on("update",this.onUpdate,this),this.app.systems.on("fixedUpdate",this.onFixedUpdate,this),this.app.systems.on("postUpdate",this.onPostUpdate,this),this.app.systems.on("toolsUpdate",this.onToolsUpdate,this)}initializeComponentData(t,e,i){i=["runInTools","enabled","scripts"],e.scripts&&e.scripts.length&&e.scripts.forEach((function(t){if(t.attributes&&Array.isArray(t.attributes)){const e={};for(let i=0;i<t.attributes.length;i++)e[t.attributes[i].name]=t.attributes[i];t.attributes=e}})),super.initializeComponentData(t,e,i)}cloneComponent(t,e){const i=this.store[t.getGuid()],n={runInTools:i.data.runInTools,scripts:[],enabled:i.data.enabled},s=i.data.scripts;for(let t=0,e=s.length;t<e;t++){const e=s[t].attributes;e&&delete s[t].attributes,n.scripts.push(f({},s[t])),e&&(n.scripts[t].attributes=this._cloneAttributes(e),s[t].attributes=e)}return this.addComponent(e,n)}onBeforeRemove(t,e){e.enabled&&this._disableScriptComponent(e),this._destroyScriptComponent(e)}onInitialize(t){if(this._registerInstances(t),t.enabled){t.script&&t.script.enabled&&this._initializeScriptComponent(t.script);const e=t._children;for(let t=0,i=e.length;t<i;t++)e[t]instanceof uA&&this.onInitialize(e[t])}}onPostInitialize(t){if(t.enabled){t.script&&t.script.enabled&&this._postInitializeScriptComponent(t.script);const e=t._children;for(let t=0,i=e.length;t<i;t++)e[t]instanceof uA&&this.onPostInitialize(e[t])}}_callInstancesMethod(t,e){const i=t.data.instances;for(const t in i)if(i.hasOwnProperty(t)){const n=i[t].instance;n[e]&&n[e]()}}_initializeScriptComponent(t){this._callInstancesMethod(t,"initialize"),t.data.initialized=!0,t.enabled&&t.entity.enabled&&this._enableScriptComponent(t)}_enableScriptComponent(t){this._callInstancesMethod(t,"onEnable")}_disableScriptComponent(t){this._callInstancesMethod(t,"onDisable")}_destroyScriptComponent(t){const e=t.data.instances;for(const i in e)if(e.hasOwnProperty(i)){const n=e[i].instance;if(n.destroy&&n.destroy(),n.update){const t=this.instancesWithUpdate.indexOf(n);t>=0&&this.instancesWithUpdate.splice(t,1)}if(n.fixedUpdate){const t=this.instancesWithFixedUpdate.indexOf(n);t>=0&&this.instancesWithFixedUpdate.splice(t,1)}if(n.postUpdate){const t=this.instancesWithPostUpdate.indexOf(n);t>=0&&this.instancesWithPostUpdate.splice(t,1)}if(n.toolsUpdate){const t=this.instancesWithToolsUpdate.indexOf(n);t>=0&&this.instancesWithToolsUpdate.splice(t,1)}t.instances[i].instance===t[i]&&delete t[i],delete t.instances[i]}}_postInitializeScriptComponent(t){this._callInstancesMethod(t,"postInitialize"),t.data.postInitialized=!0}_updateInstances(t,e,i){for(let n=0,s=e.length;n<s;n++){const s=e[n];s&&s.entity&&s.entity.enabled&&s.entity.script.enabled&&s[t](i)}}onUpdate(t){this._updateInstances("update",this.instancesWithUpdate,t)}onFixedUpdate(t){this._updateInstances("fixedUpdate",this.instancesWithFixedUpdate,t)}onPostUpdate(t){this._updateInstances("postUpdate",this.instancesWithPostUpdate,t)}onToolsUpdate(t){this._updateInstances("toolsUpdate",this.instancesWithToolsUpdate,t)}broadcast(t,e){const i=Array.prototype.slice.call(arguments,2),n=this.store;for(const s in n)if(n.hasOwnProperty(s)){const r=n[s].data;if(r.instances[t]){const n=r.instances[t].instance[e];n&&n.apply(r.instances[t].instance,i)}}}_preRegisterInstance(t,e,i,n){if(t.script){if(t.script.data._instances=t.script.data._instances||{},t.script.data._instances[i])throw Error("Script name collision '"+i+"'. Scripts from '"+e+"' and '"+t.script.data._instances[i].url+"' {"+t.getGuid()+"}");t.script.data._instances[i]={url:e,name:i,instance:n}}}_registerInstances(t){if(t.script&&t.script.data._instances){t.script.instances=t.script.data._instances;for(const e in t.script.instances){const i=t.script.instances[e],n=i.instance;if(w.attach(n),n.update&&this.instancesWithUpdate.push(n),n.fixedUpdate&&this.instancesWithFixedUpdate.push(n),n.postUpdate&&this.instancesWithPostUpdate.push(n),n.toolsUpdate&&this.instancesWithToolsUpdate.push(n),t.script.scripts&&this._createAccessors(t,i),t.script[e])throw Error("Script with name '"+e+"' is already attached to Script Component");t.script[e]=n}delete t.script.data._instances}const e=t._children;for(let t=0,i=e.length;t<i;t++)e[t]instanceof uA&&this._registerInstances(e[t])}_cloneAttributes(t){const e={};for(const i in t)if(t.hasOwnProperty(i))if("entity"!==t[i].type)e[i]=f({},t[i]);else{const n=t[i].value;delete t[i].value,e[i]=f({},t[i]),e[i].value=n,t[i].value=n}return e}_createAccessors(t,e){const i=t.script.scripts.length,n=e.url;for(let s=0;s<i;s++){const i=t.script.scripts[s];if(i.url===n){const n=i.attributes;if(i.name&&n){for(const t in n)n.hasOwnProperty(t)&&this._createAccessor(n[t],e);t.script.data.attributes[i.name]=this._cloneAttributes(n)}break}}}_createAccessor(t,e){const i=this;t={name:t.name,value:t.value,type:t.type},this._convertAttributeValue(t),Object.defineProperty(e.instance,t.name,{get:function(){return t.value},set:function(n){const s=t.value;t.value=n,i._convertAttributeValue(t),e.instance.fire("set",t.name,s,t.value)},configurable:!0})}_updateAccessors(t,e){const i=t.script.scripts.length,n=e.url;for(let s=0;s<i;s++){const i=t.script,r=i.scripts[s];if(r.url===n){const t=r.name,n=r.attributes;if(t){if(n)for(const t in n)n.hasOwnProperty(t)&&this._createAccessor(n[t],e);const s=i.data.attributes[t];if(s)for(const t in s){const i=s[t];t in n?n[t].value!==i.value&&e.instance.onAttributeChanged&&e.instance.onAttributeChanged(i.name,i.value,n[t].value):delete e.instance[i.name]}n?i.data.attributes[t]=this._cloneAttributes(n):delete i.data.attributes[t]}break}}}_convertAttributeValue(t){if("rgb"===t.type||"rgba"===t.type)Array.isArray(t.value)&&(t.value=3===t.value.length?new rt(t.value[0],t.value[1],t.value[2]):new rt(t.value[0],t.value[1],t.value[2],t.value[3]));else if("vec2"===t.type)Array.isArray(t.value)&&(t.value=new _t(t.value[0],t.value[1]));else if("vec3"===t.type||"vector"===t.type)Array.isArray(t.value)&&(t.value=new ht(t.value[0],t.value[1],t.value[2]));else if("vec4"===t.type)Array.isArray(t.value)&&(t.value=new ut(t.value[0],t.value[1],t.value[2],t.value[3]));else if("entity"===t.type)null!==t.value&&"string"==typeof t.value&&(t.value=this.app.root.findByGuid(t.value));else if("curve"===t.type||"colorcurve"===t.type){const e=t.value.keys[0]instanceof Array?lt:at;t.value=new e(t.value.keys),t.value.type=t.value.type}}destroy(){super.destroy(),this.app.systems.off("initialize",this.onInitialize,this),this.app.systems.off("postInitialize",this.onPostInitialize,this),this.app.systems.off("update",this.onUpdate,this),this.app.systems.off("fixedUpdate",this.onFixedUpdate,this),this.app.systems.off("postUpdate",this.onPostUpdate,this),this.app.systems.off("toolsUpdate",this.onToolsUpdate,this)}}gg._buildAccessors(Sx.prototype,wx);const Tx=new _t,Ax=new ht,Ex=new ht,Mx=new ht,Rx=new ht,Ix=new ht,Px=new yt,Lx={x:"y",y:"x"};class Dx extends x{constructor(t,e){if(super(),!(t&&t instanceof Pv))throw new Error("Element was null or not an ElementComponent");if(e&&"x"!==e&&"y"!==e)throw new Error("Unrecognized axis: "+e);this._element=t,this._app=t.system.app,this._axis=e||null,this._enabled=!0,this._dragScale=new ht,this._dragStartMousePosition=new ht,this._dragStartHandlePosition=new ht,this._deltaMousePosition=new ht,this._deltaHandlePosition=new ht,this._isDragging=!1,this._toggleLifecycleListeners("on")}_toggleLifecycleListeners(t){this._element[t]("mousedown",this._onMouseDownOrTouchStart,this),this._element[t]("touchstart",this._onMouseDownOrTouchStart,this)}_toggleDragListeners(t){const e="on"===t,i=e?"addEventListener":"removeEventListener";this._hasDragListeners&&e||(this._handleMouseUpOrTouchEnd||(this._handleMouseUpOrTouchEnd=this._onMouseUpOrTouchEnd.bind(this)),this._app.mouse&&(this._app.mouse[t]("mousemove",this._onMove,this),window[i]("mouseup",this._handleMouseUpOrTouchEnd,!1)),B.touch&&(this._app.touch[t]("touchmove",this._onMove,this),window[i]("touchend",this._handleMouseUpOrTouchEnd,!1),window[i]("touchcancel",this._handleMouseUpOrTouchEnd,!1)),this._hasDragListeners=e)}_onMouseDownOrTouchStart(t){if(this._element&&!this._isDragging&&this.enabled){this._dragCamera=t.camera,this._calculateDragScale();const e=this._screenToLocal(t);e&&(this._toggleDragListeners("on"),this._isDragging=!0,this._dragStartMousePosition.copy(e),this._dragStartHandlePosition.copy(this._element.entity.getLocalPosition()),this.fire("drag:start"))}}_onMouseUpOrTouchEnd(){this._isDragging&&(this._isDragging=!1,this._toggleDragListeners("off"),this.fire("drag:end"))}_screenToLocal(t){this._determineInputPosition(t),this._chooseRayOriginAndDirection(),Rx.copy(this._element.entity.getPosition()),Ix.copy(this._element.entity.forward).mulScalar(-1);const e=Ix.dot(Mx);if(Math.abs(e)>0){const t=Rx.sub(Ex).dot(Ix)/e,i=Ex.add(Mx.mulScalar(t));return Px.copy(this._element.entity.getRotation()).invert().transformVector(i,i),i.mul(this._dragScale),i}return null}_determineInputPosition(t){const e=this._app.graphicsDevice.maxPixelRatio;void 0!==t.x&&void 0!==t.y?(Tx.x=t.x*e,Tx.y=t.y*e):t.changedTouches?(Tx.x=t.changedTouches[0].x*e,Tx.y=t.changedTouches[0].y*e):console.warn("Could not determine position from input event")}_chooseRayOriginAndDirection(){this._element.screen&&this._element.screen.screen.screenSpace?(Ex.set(Tx.x,-Tx.y,0),Mx.set(0,0,-1)):(Ax.copy(this._dragCamera.screenToWorld(Tx.x,Tx.y,1)),Ex.copy(this._dragCamera.entity.getPosition()),Mx.copy(Ax).sub(Ex).normalize())}_calculateDragScale(){let t=this._element.entity.parent;const e=this._element.screen&&this._element.screen.screen,i=e&&e.screenSpace,n=i?e.scale:1,s=this._dragScale;for(s.set(n,n,n);t&&(s.mul(t.getLocalScale()),t=t.parent,!i||!t.screen););s.x=1/s.x,s.y=1/s.y,s.z=1/s.z}_onMove(t){if(this._element&&this._isDragging&&this.enabled&&this._element.enabled&&this._element.entity.enabled){const e=this._screenToLocal(t);if(this._dragStartMousePosition&&e){if(this._deltaMousePosition.copy(e).sub(this._dragStartMousePosition),this._deltaHandlePosition.copy(this._dragStartHandlePosition).add(this._deltaMousePosition),this._axis){const t=this._element.entity.getLocalPosition(),e=Lx[this._axis];this._deltaHandlePosition[e]=t[e]}this._element.entity.setLocalPosition(this._deltaHandlePosition),this.fire("drag:move",this._deltaHandlePosition)}}}destroy(){this._toggleLifecycleListeners("off"),this._toggleDragListeners("off")}get enabled(){return this._enabled}set enabled(t){this._enabled=t}get isDragging(){return this._isDragging}}const kx=0,Ox=1,Fx=2,Bx=0,Nx=1,Ux="mouse",Vx="keyboard",zx="gamepad",Wx="mousex",Gx="mousey",jx="padlx",Hx="padly",Xx="padrx",Yx="padry",qx="key",Kx="keydown",Zx="keyup",Qx="mousedown",$x="mousemove",Jx="mouseup",tw="mousewheel",ew="touchstart",iw="touchend",nw="touchmove",sw="touchcancel",rw="select",ow="selectstart",aw="selectend",lw=8,hw=9,cw=13,_w=13,uw=16,dw=17,pw=18,fw=19,mw=20,gw=27,bw=32,yw=33,vw=34,Sw=35,xw=36,ww=37,Cw=38,Tw=39,Aw=40,Ew=44,Mw=45,Rw=46,Iw=48,Pw=49,Lw=50,Dw=51,kw=52,Ow=53,Fw=54,Bw=55,Nw=56,Uw=57,Vw=59,zw=61,Ww=65,Gw=66,jw=67,Hw=68,Xw=69,Yw=70,qw=71,Kw=72,Zw=73,Qw=74,$w=75,Jw=76,tC=77,eC=78,iC=79,nC=80,sC=81,rC=82,oC=83,aC=84,lC=85,hC=86,cC=87,_C=88,uC=89,dC=90,pC=91,fC=93,mC=96,gC=97,bC=98,yC=99,vC=100,SC=101,xC=102,wC=103,CC=104,TC=105,AC=106,EC=107,MC=108,RC=109,IC=110,PC=111,LC=112,DC=113,kC=114,OC=115,FC=116,BC=117,NC=118,UC=119,VC=120,zC=121,WC=122,GC=123,jC=188,HC=190,XC=191,YC=219,qC=220,KC=221,ZC=224,QC=-1,$C=0,JC=1,tT=2,eT=0,iT=1,nT=2,sT=3,rT=0,oT=1,aT=2,lT=3,hT=4,cT=5,_T=6,uT=7,dT=8,pT=9,fT=10,mT=11,gT=12,bT=13,yT=14,vT=15,ST=16,xT=0,wT=1,CT=2,TT=3,AT=new _t;class ET extends gg{constructor(t,e){super(t,e),this._viewportReference=new Lb(this,"viewportEntity",{"element#gain":this._onViewportElementGain,"element#resize":this._onSetContentOrViewportSize}),this._contentReference=new Lb(this,"contentEntity",{"element#gain":this._onContentElementGain,"element#lose":this._onContentElementLose,"element#resize":this._onSetContentOrViewportSize}),this._scrollbarUpdateFlags={},this._scrollbarReferences={},this._scrollbarReferences[tn]=new Lb(this,"horizontalScrollbarEntity",{"scrollbar#set:value":this._onSetHorizontalScrollbarValue,"scrollbar#gain":this._onHorizontalScrollbarGain}),this._scrollbarReferences[en]=new Lb(this,"verticalScrollbarEntity",{"scrollbar#set:value":this._onSetVerticalScrollbarValue,"scrollbar#gain":this._onVerticalScrollbarGain}),this._prevContentSizes={},this._prevContentSizes[tn]=null,this._prevContentSizes[en]=null,this._scroll=new _t,this._velocity=new ht,this._dragStartPosition=new ht,this._disabledContentInput=!1,this._disabledContentInputEntities=[],this._toggleLifecycleListeners("on",t),this._toggleElementListeners("on")}_toggleLifecycleListeners(t,e){this[t]("set_horizontal",this._onSetHorizontalScrollingEnabled,this),this[t]("set_vertical",this._onSetVerticalScrollingEnabled,this),e.app.systems.element[t]("add",this._onElementComponentAdd,this),e.app.systems.element[t]("beforeremove",this._onElementComponentRemove,this)}_toggleElementListeners(t){if(this.entity.element){if("on"===t&&this._hasElementListeners)return;this.entity.element[t]("resize",this._onSetContentOrViewportSize,this),this.entity.element[t](tw,this._onMouseWheel,this),this._hasElementListeners="on"===t}}_onElementComponentAdd(t){this.entity===t&&this._toggleElementListeners("on")}_onElementComponentRemove(t){this.entity===t&&this._toggleElementListeners("off")}_onViewportElementGain(){this._syncAll()}_onContentElementGain(){this._destroyDragHelper(),this._contentDragHelper=new Dx(this._contentReference.entity.element),this._contentDragHelper.on("drag:start",this._onContentDragStart,this),this._contentDragHelper.on("drag:end",this._onContentDragEnd,this),this._contentDragHelper.on("drag:move",this._onContentDragMove,this),this._prevContentSizes[tn]=null,this._prevContentSizes[en]=null,this._syncAll()}_onContentElementLose(){this._destroyDragHelper()}_onContentDragStart(){this._contentReference.entity&&this.enabled&&this.entity.enabled&&this._dragStartPosition.copy(this._contentReference.entity.getLocalPosition())}_onContentDragEnd(){this._prevContentDragPosition=null,this._enableContentInput()}_onContentDragMove(t){if(this._contentReference.entity&&this.enabled&&this.entity.enabled&&(this._wasDragged=!0,this._setScrollFromContentPosition(t),this._setVelocityFromContentPositionDelta(t),!this._disabledContentInput)){const e=t.x-this._dragStartPosition.x,i=t.y-this._dragStartPosition.y;(Math.abs(e)>this.dragThreshold||Math.abs(i)>this.dragThreshold)&&this._disableContentInput()}}_onSetContentOrViewportSize(){this._syncAll()}_onSetHorizontalScrollbarValue(t){!this._scrollbarUpdateFlags[tn]&&this.enabled&&this.entity.enabled&&this._onSetScroll(t,null)}_onSetVerticalScrollbarValue(t){!this._scrollbarUpdateFlags[en]&&this.enabled&&this.entity.enabled&&this._onSetScroll(null,t)}_onSetHorizontalScrollingEnabled(){this._syncScrollbarEnabledState(tn)}_onSetVerticalScrollingEnabled(){this._syncScrollbarEnabledState(en)}_onHorizontalScrollbarGain(){this._syncScrollbarEnabledState(tn),this._syncScrollbarPosition(tn)}_onVerticalScrollbarGain(){this._syncScrollbarEnabledState(en),this._syncScrollbarPosition(en)}_onSetScroll(t,e,i){!1!==i&&this._velocity.set(0,0,0);let n=!1;n|=this._updateAxis(t,"x",tn),n|=this._updateAxis(e,"y",en),n&&this.fire("set:scroll",this._scroll)}_updateAxis(t,e,i){const n=null!==t&&Math.abs(t-this._scroll[e])>1e-5;return(n||this._isDragging()||0===t)&&(this._scroll[e]=this._determineNewScrollValue(t,e,i),this._syncContentPosition(i),this._syncScrollbarPosition(i)),n}_determineNewScrollValue(t,e,i){if(!this._getScrollingEnabled(i))return this._scroll[e];switch(this.scrollMode){case kx:return Z.clamp(t,0,this._getMaxScrollValue(i));case Ox:return this._setVelocityFromOvershoot(t,e,i),t;case Fx:return t;default:return console.warn("Unhandled scroll mode:"+this.scrollMode),t}}_syncAll(){this._syncContentPosition(tn),this._syncContentPosition(en),this._syncScrollbarPosition(tn),this._syncScrollbarPosition(en),this._syncScrollbarEnabledState(tn),this._syncScrollbarEnabledState(en)}_syncContentPosition(t){const e=this._getAxis(t),i=this._getSign(t),n=this._contentReference.entity;if(n){const s=this._prevContentSizes[t],r=this._getContentSize(t);if(null!==s&&Math.abs(s-r)>1e-4){const i=this._getMaxOffset(t,s),n=this._getMaxOffset(t,r);this._scroll[e]=0===n?1:Z.clamp(this._scroll[e]*i/n,0,1)}const o=this._scroll[e]*this._getMaxOffset(t),a=n.getLocalPosition();a[e]=o*i,n.setLocalPosition(a),this._prevContentSizes[t]=r}}_syncScrollbarPosition(t){const e=this._getAxis(t),i=this._scrollbarReferences[t].entity;i&&i.scrollbar&&(this._scrollbarUpdateFlags[t]=!0,i.scrollbar.value=this._scroll[e],i.scrollbar.handleSize=this._getScrollbarHandleSize(e,t),this._scrollbarUpdateFlags[t]=!1)}_syncScrollbarEnabledState(t){const e=this._scrollbarReferences[t].entity;if(e){const i=this._getScrollingEnabled(t),n=this._getScrollbarVisibility(t);switch(n){case Bx:return void(e.enabled=i);case Nx:return void(e.enabled=i&&this._contentIsLargerThanViewport(t));default:console.warn("Unhandled scrollbar visibility:"+n),e.enabled=i}}}_contentIsLargerThanViewport(t){return this._getContentSize(t)>this._getViewportSize(t)}_contentPositionToScrollValue(t){const e=this._getMaxOffset(tn),i=this._getMaxOffset(en);return AT.x=0===e?0:t.x/e,AT.y=0===i?0:t.y/-i,AT}_getMaxOffset(t,e){e=void 0===e?this._getContentSize(t):e;const i=this._getViewportSize(t);return e<i?-this._getViewportSize(t):i-e}_getMaxScrollValue(t){return this._contentIsLargerThanViewport(t)?1:0}_getScrollbarHandleSize(t,e){const i=this._getViewportSize(e),n=this._getContentSize(e);if(Math.abs(n)<.001)return 1;const s=Math.min(i/n,1),r=this._toOvershoot(this._scroll[t],e);return 0===r?s:s/(1+Math.abs(r))}_getViewportSize(t){return this._getSize(t,this._viewportReference)}_getContentSize(t){return this._getSize(t,this._contentReference)}_getSize(t,e){return e.entity&&e.entity.element?e.entity.element[this._getCalculatedDimension(t)]:0}_getScrollingEnabled(t){return t===tn?this.horizontal:t===en?this.vertical:void console.warn("Unrecognized orientation: "+t)}_getScrollbarVisibility(t){return t===tn?this.horizontalScrollbarVisibility:t===en?this.verticalScrollbarVisibility:void console.warn("Unrecognized orientation: "+t)}_getSign(t){return t===tn?1:-1}_getAxis(t){return t===tn?"x":"y"}_getCalculatedDimension(t){return t===tn?"calculatedWidth":"calculatedHeight"}_destroyDragHelper(){this._contentDragHelper&&this._contentDragHelper.destroy()}onUpdate(){this._contentReference.entity&&(this._updateVelocity(),this._syncScrollbarEnabledState(tn),this._syncScrollbarEnabledState(en))}_updateVelocity(){if(!this._isDragging()){if(this.scrollMode===Ox&&(this._hasOvershoot("x",tn)&&this._setVelocityFromOvershoot(this.scroll.x,"x",tn),this._hasOvershoot("y",en)&&this._setVelocityFromOvershoot(this.scroll.y,"y",en)),Math.abs(this._velocity.x)>1e-4||Math.abs(this._velocity.y)>1e-4){const t=this._contentReference.entity.getLocalPosition();t.x+=this._velocity.x,t.y+=this._velocity.y,this._contentReference.entity.setLocalPosition(t),this._setScrollFromContentPosition(t)}this._velocity.x*=1-this.friction,this._velocity.y*=1-this.friction}}_hasOvershoot(t,e){return Math.abs(this._toOvershoot(this.scroll[t],e))>.001}_toOvershoot(t,e){const i=this._getMaxScrollValue(e);return t<0?t:t>i?t-i:0}_setVelocityFromOvershoot(t,e,i){const n=this._toOvershoot(t,i)*this._getMaxOffset(i)*this._getSign(i);Math.abs(n)>0&&(this._velocity[e]=-n/(50*this.bounceAmount+1))}_setVelocityFromContentPositionDelta(t){this._prevContentDragPosition?(this._velocity.sub2(t,this._prevContentDragPosition),this._prevContentDragPosition.copy(t)):(this._velocity.set(0,0,0),this._prevContentDragPosition=t.clone())}_setScrollFromContentPosition(t){let e=this._contentPositionToScrollValue(t);this._isDragging()&&(e=this._applyScrollValueTension(e)),this._onSetScroll(e.x,e.y,!1)}_applyScrollValueTension(t){let e=this._getMaxScrollValue(tn),i=this._toOvershoot(t.x,tn);return i>0?t.x=e+1*Math.log10(1+i):i<0&&(t.x=-1*Math.log10(1-i)),e=this._getMaxScrollValue(en),i=this._toOvershoot(t.y,en),i>0?t.y=e+1*Math.log10(1+i):i<0&&(t.y=-1*Math.log10(1-i)),t}_isDragging(){return this._contentDragHelper&&this._contentDragHelper.isDragging}_setScrollbarComponentsEnabled(t){this._scrollbarReferences[tn].hasComponent("scrollbar")&&(this._scrollbarReferences[tn].entity.scrollbar.enabled=t),this._scrollbarReferences[en].hasComponent("scrollbar")&&(this._scrollbarReferences[en].entity.scrollbar.enabled=t)}_setContentDraggingEnabled(t){this._contentDragHelper&&(this._contentDragHelper.enabled=t)}_onMouseWheel(t){if(this.useMouseWheel){const e=t.event,i=e.deltaX/this._contentReference.entity.element.calculatedWidth*this.mouseWheelSensitivity.x,n=e.deltaY/this._contentReference.entity.element.calculatedHeight*this.mouseWheelSensitivity.y,s=Z.clamp(this._scroll.x+i,0,this._getMaxScrollValue(tn)),r=Z.clamp(this._scroll.y+n,0,this._getMaxScrollValue(en));this.scroll=new _t(s,r)}}_enableContentInput(){for(;this._disabledContentInputEntities.length;){const t=this._disabledContentInputEntities.pop();t.element&&(t.element.useInput=!0)}this._disabledContentInput=!1}_disableContentInput(){const t=e=>{e.element&&e.element.useInput&&(this._disabledContentInputEntities.push(e),e.element.useInput=!1);const i=e.children;for(let e=0,n=i.length;e<n;e++)t(i[e])},e=this._contentReference.entity;if(e){const i=e.children;for(let e=0,n=i.length;e<n;e++)t(i[e])}this._disabledContentInput=!0}onEnable(){this._viewportReference.onParentComponentEnable(),this._contentReference.onParentComponentEnable(),this._scrollbarReferences[tn].onParentComponentEnable(),this._scrollbarReferences[en].onParentComponentEnable(),this._setScrollbarComponentsEnabled(!0),this._setContentDraggingEnabled(!0),this._syncAll()}onDisable(){this._setScrollbarComponentsEnabled(!1),this._setContentDraggingEnabled(!1)}onRemove(){this._toggleLifecycleListeners("off",this.system),this._toggleElementListeners("off"),this._destroyDragHelper()}get scroll(){return this._scroll}set scroll(t){this._onSetScroll(t.x,t.y)}}class MT{constructor(){this.enabled=!0}}const RT=[{name:"enabled",type:"boolean"},{name:"horizontal",type:"boolean"},{name:"vertical",type:"boolean"},{name:"scrollMode",type:"number"},{name:"bounceAmount",type:"number"},{name:"friction",type:"number"},{name:"dragThreshold",type:"number"},{name:"useMouseWheel",type:"boolean"},{name:"mouseWheelSensitivity",type:"vec2"},{name:"horizontalScrollbarVisibility",type:"number"},{name:"verticalScrollbarVisibility",type:"number"},{name:"viewportEntity",type:"entity"},{name:"contentEntity",type:"entity"},{name:"horizontalScrollbarEntity",type:"entity"},{name:"verticalScrollbarEntity",type:"entity"}];class IT extends bg{constructor(t){super(t),this.id="scrollview",this.ComponentType=ET,this.DataType=MT,this.schema=RT,this.on("beforeremove",this._onRemoveComponent,this),this.app.systems.on("update",this.onUpdate,this)}initializeComponentData(t,e,i){void 0===e.dragThreshold&&(e.dragThreshold=10),void 0===e.useMouseWheel&&(e.useMouseWheel=!0),void 0===e.mouseWheelSensitivity&&(e.mouseWheelSensitivity=new _t(1,1)),super.initializeComponentData(t,e,RT)}onUpdate(t){const e=this.store;for(const t in e){const i=e[t].entity,n=i.scrollview;n.enabled&&i.enabled&&n.onUpdate()}}_onRemoveComponent(t,e){e.onRemove()}destroy(){super.destroy(),this.app.systems.off("update",this.onUpdate,this)}}gg._buildAccessors(ET.prototype,RT);class PT extends gg{constructor(t,e){super(t,e),this._app=t.app,this._handleReference=new Lb(this,"handleEntity",{"element#gain":this._onHandleElementGain,"element#lose":this._onHandleElementLose,"element#set:anchor":this._onSetHandleAlignment,"element#set:margin":this._onSetHandleAlignment,"element#set:pivot":this._onSetHandleAlignment}),this._toggleLifecycleListeners("on")}_toggleLifecycleListeners(t){this[t]("set_value",this._onSetValue,this),this[t]("set_handleSize",this._onSetHandleSize,this),this[t]("set_orientation",this._onSetOrientation,this)}_onHandleElementGain(){this._destroyDragHelper(),this._handleDragHelper=new Dx(this._handleReference.entity.element,this._getAxis()),this._handleDragHelper.on("drag:move",this._onHandleDrag,this),this._updateHandlePositionAndSize()}_onHandleElementLose(){this._destroyDragHelper()}_onHandleDrag(t){this._handleReference.entity&&this.enabled&&this.entity.enabled&&(this.value=this._handlePositionToScrollValue(t[this._getAxis()]))}_onSetValue(t,e,i){Math.abs(i-e)>1e-5&&(this.data.value=Z.clamp(i,0,1),this._updateHandlePositionAndSize(),this.fire("set:value",this.data.value))}_onSetHandleSize(t,e,i){Math.abs(i-e)>1e-5&&(this.data.handleSize=Z.clamp(i,0,1),this._updateHandlePositionAndSize())}_onSetHandleAlignment(){this._updateHandlePositionAndSize()}_onSetOrientation(t,e,i){i!==e&&this._handleReference.hasComponent("element")&&(this._handleReference.entity.element[this._getOppositeDimension()]=0)}_updateHandlePositionAndSize(){const t=this._handleReference.entity,e=t&&t.element;if(t){const e=t.getLocalPosition();e[this._getAxis()]=this._getHandlePosition(),this._handleReference.entity.setLocalPosition(e)}e&&(e[this._getDimension()]=this._getHandleLength())}_handlePositionToScrollValue(t){return t*this._getSign()/this._getUsableTrackLength()}_scrollValueToHandlePosition(t){return t*this._getSign()*this._getUsableTrackLength()}_getUsableTrackLength(){return Math.max(this._getTrackLength()-this._getHandleLength(),.001)}_getTrackLength(){return this.entity.element?this.orientation===tn?this.entity.element.calculatedWidth:this.entity.element.calculatedHeight:0}_getHandleLength(){return this._getTrackLength()*this.handleSize}_getHandlePosition(){return this._scrollValueToHandlePosition(this.value)}_getSign(){return this.orientation===tn?1:-1}_getAxis(){return this.orientation===tn?"x":"y"}_getDimension(){return this.orientation===tn?"width":"height"}_getOppositeDimension(){return this.orientation===tn?"height":"width"}_destroyDragHelper(){this._handleDragHelper&&this._handleDragHelper.destroy()}_setHandleDraggingEnabled(t){this._handleDragHelper&&(this._handleDragHelper.enabled=t)}onEnable(){this._handleReference.onParentComponentEnable(),this._setHandleDraggingEnabled(!0)}onDisable(){this._setHandleDraggingEnabled(!1)}onRemove(){this._destroyDragHelper(),this._toggleLifecycleListeners("off")}}class LT{constructor(){this.enabled=!0}}const DT=[{name:"enabled",type:"boolean"},{name:"orientation",type:"number"},{name:"value",type:"number"},{name:"handleSize",type:"number"},{name:"handleEntity",type:"entity"}];class kT extends bg{constructor(t){super(t),this.id="scrollbar",this.ComponentType=PT,this.DataType=LT,this.schema=DT,this.on("beforeremove",this._onRemoveComponent,this)}initializeComponentData(t,e,i){super.initializeComponentData(t,e,DT)}_onRemoveComponent(t,e){e.onRemove()}}gg._buildAccessors(PT.prototype,DT);function OT(t,e){return t%e||0}class FT extends x{constructor(t,e,i){super(),this._manager=t,this._volume=void 0!==i.volume?Z.clamp(Number(i.volume)||0,0,1):1,this._pitch=void 0!==i.pitch?Math.max(.01,Number(i.pitch)||0):1,this._loop=!(void 0===i.loop||!i.loop),this._sound=e,this._state=2,this._suspended=!1,this._suspendEndEvent=!1,this._suspendInstanceEvents=!1,this._playWhenLoaded=!0,this._startTime=Math.max(0,Number(i.startTime)||0),this._duration=Math.max(0,Number(i.duration)||0),this._startOffset=null,this.source=null,this._onPlayCallback=i.onPlay,this._onPauseCallback=i.onPause,this._onResumeCallback=i.onResume,this._onStopCallback=i.onStop,this._onEndCallback=i.onEnd,zu()?(this._startedAt=0,this._currentTime=0,this._currentOffset=0,this._inputNode=null,this._connectorNode=null,this._firstNode=null,this._lastNode=null,this._initializeNodes(),this._endedHandler=this._onEnded.bind(this)):(this._isReady=!1,this._loadedMetadataHandler=this._onLoadedMetadata.bind(this),this._timeUpdateHandler=this._onTimeUpdate.bind(this),this._endedHandler=this._onEnded.bind(this),this._createSource())}_onPlay(){this.fire("play"),this._onPlayCallback&&this._onPlayCallback(this)}_onPause(){this.fire("pause"),this._onPauseCallback&&this._onPauseCallback(this)}_onResume(){this.fire("resume"),this._onResumeCallback&&this._onResumeCallback(this)}_onStop(){this.fire("stop"),this._onStopCallback&&this._onStopCallback(this)}_onEnded(){this._suspendEndEvent?this._suspendEndEvent=!1:(this.fire("end"),this._onEndCallback&&this._onEndCallback(this),this.stop())}_onManagerVolumeChange(){this.volume=this._volume}_onManagerSuspend(){0!==this._state||this._suspended||(this._suspended=!0,this.pause())}_onManagerResume(){this._suspended&&(this._suspended=!1,this.resume())}get loop(){return this._loop}set loop(t){this._loop=!!t,this.source&&(this.source.loop=this._loop)}get startTime(){return this._startTime}set startTime(t){this._startTime=Math.max(0,Number(t)||0);const e=0===this._state;this.stop(),e&&this.play()}get duration(){return this._sound?this._duration?OT(this._duration,this._sound.duration):this._sound.duration:0}set duration(t){this._duration=Math.max(0,Number(t)||0);const e=0===this._state;this.stop(),e&&this.play()}get isPlaying(){return 0===this._state}get isPaused(){return 1===this._state}get isStopped(){return 2===this._state}get isSuspended(){return this._suspended}}zu()?(Object.assign(FT.prototype,{_initializeNodes:function(){this.gain=this._manager.context.createGain(),this._inputNode=this.gain,this._connectorNode=this.gain,this._connectorNode.connect(this._manager.context.destination)},play:function(){2!==this._state&&this.stop(),this.source||this._createSource();let t=OT(this._startOffset,this.duration);return t=OT(this._startTime+t,this._sound.duration),this._startOffset=null,this._duration?this.source.start(0,t,this._duration):this.source.start(0,t),this._startedAt=this._manager.context.currentTime,this._currentTime=0,this._currentOffset=t,this._state=0,this._playWhenLoaded=!1,this.volume=this._volume,this.loop=this._loop,this.pitch=this._pitch,this._manager.on("volumechange",this._onManagerVolumeChange,this),this._manager.on("suspend",this._onManagerSuspend,this),this._manager.on("resume",this._onManagerResume,this),this._manager.on("destroy",this._onManagerDestroy,this),this._manager.suspended&&this._onManagerSuspend(),this._suspendInstanceEvents||this._onPlay(),!0},pause:function(){return this._playWhenLoaded=!1,!(0!==this._state||!this.source)&&(this._updateCurrentTime(),this._state=1,this._suspendEndEvent=!0,this.source.stop(0),this.source=null,this._startOffset=null,this._suspendInstanceEvents||this._onPause(),!0)},resume:function(){if(1!==this._state)return!1;this.source||this._createSource();let t=this.currentTime;return null!==this._startOffset&&(t=OT(this._startOffset,this.duration),t=OT(this._startTime+t,this._sound.duration),this._startOffset=null),this._duration?this.source.start(0,t,this._duration):this.source.start(0,t),this._state=0,this._startedAt=this._manager.context.currentTime,this._currentOffset=t,this.volume=this._volume,this.loop=this._loop,this.pitch=this._pitch,this._playWhenLoaded=!1,this._suspendInstanceEvents||this._onResume(),!0},stop:function(){return this._playWhenLoaded=!1,!(2===this._state||!this.source)&&(this._manager.off("volumechange",this._onManagerVolumeChange,this),this._manager.off("suspend",this._onManagerSuspend,this),this._manager.off("resume",this._onManagerResume,this),this._manager.off("destroy",this._onManagerDestroy,this),this._startedAt=0,this._currentTime=0,this._currentOffset=0,this._startOffset=null,this._suspendEndEvent=!0,0===this._state&&this.source.stop(0),this.source=null,this._state=2,this._suspendInstanceEvents||this._onStop(),!0)},setExternalNodes:function(t,e){if(!t)return void console.error("The firstNode must be a valid Audio Node");e||(e=t);const i=this._manager.context.destination;this._firstNode!==t&&(this._firstNode?this._connectorNode.disconnect(this._firstNode):this._connectorNode.disconnect(i),this._firstNode=t,this._connectorNode.connect(t)),this._lastNode!==e&&(this._lastNode&&this._lastNode.disconnect(i),this._lastNode=e,this._lastNode.connect(i))},clearExternalNodes:function(){const t=this._manager.context.destination;this._firstNode&&(this._connectorNode.disconnect(this._firstNode),this._firstNode=null),this._lastNode&&(this._lastNode.disconnect(t),this._lastNode=null),this._connectorNode.connect(t)},getExternalNodes:function(){return[this._firstNode,this._lastNode]},_createSource:function(){if(!this._sound)return null;const t=this._manager.context;return this._sound.buffer&&(this.source=t.createBufferSource(),this.source.buffer=this._sound.buffer,this.source.connect(this._inputNode),this.source.onended=this._endedHandler,this.source.loopStart=OT(this._startTime,this.source.buffer.duration),this._duration&&(this.source.loopEnd=Math.max(this.source.loopStart,OT(this._startTime+this._duration,this.source.buffer.duration)))),this.source},_updateCurrentTime:function(){this._currentTime=OT((this._manager.context.currentTime-this._startedAt)*this._pitch+this._currentOffset,this.duration)},_onManagerDestroy:function(){this.source&&0===this._state&&(this.source.stop(0),this.source=null)}}),Object.defineProperty(FT.prototype,"volume",{get:function(){return this._volume},set:function(t){t=Z.clamp(t,0,1),this._volume=t,this.gain&&(this.gain.gain.value=t*this._manager.volume)}}),Object.defineProperty(FT.prototype,"pitch",{get:function(){return this._pitch},set:function(t){this._currentOffset=this.currentTime,this._startedAt=this._manager.context.currentTime,this._pitch=Math.max(Number(t)||0,.01),this.source&&(this.source.playbackRate.value=this._pitch)}}),Object.defineProperty(FT.prototype,"sound",{get:function(){return this._sound},set:function(t){this._sound=t,2!==this._state?this.stop():this._createSource()}}),Object.defineProperty(FT.prototype,"currentTime",{get:function(){return null!==this._startOffset?this._startOffset:1===this._state?this._currentTime:2!==this._state&&this.source?(this._updateCurrentTime(),this._currentTime):0},set:function(t){if(!(t<0))if(0===this._state){const e=this._suspendInstanceEvents;this._suspendInstanceEvents=!0,this.stop(),this._startOffset=t,this.play(),this._suspendInstanceEvents=e}else this._startOffset=t,this._currentTime=t}})):(Object.assign(FT.prototype,{play:function(){return 2!==this._state&&this.stop(),!(!this.source&&!this._createSource())&&(this.volume=this._volume,this.pitch=this._pitch,this.loop=this._loop,this.source.play(),this._state=0,this._playWhenLoaded=!1,this._manager.on("volumechange",this._onManagerVolumeChange,this),this._manager.on("suspend",this._onManagerSuspend,this),this._manager.on("resume",this._onManagerResume,this),this._manager.on("destroy",this._onManagerDestroy,this),this._manager.suspended&&this._onManagerSuspend(),this._suspendInstanceEvents||this._onPlay(),!0)},pause:function(){return!(!this.source||0!==this._state)&&(this._suspendEndEvent=!0,this.source.pause(),this._playWhenLoaded=!1,this._state=1,this._startOffset=null,this._suspendInstanceEvents||this._onPause(),!0)},resume:function(){return!(!this.source||1!==this._state)&&(this._state=0,this._playWhenLoaded=!1,this.source.paused&&(this.source.play(),this._suspendInstanceEvents||this._onResume()),!0)},stop:function(){return!(!this.source||2===this._state)&&(this._manager.off("volumechange",this._onManagerVolumeChange,this),this._manager.off("suspend",this._onManagerSuspend,this),this._manager.off("resume",this._onManagerResume,this),this._manager.off("destroy",this._onManagerDestroy,this),this._suspendEndEvent=!0,this.source.pause(),this._playWhenLoaded=!1,this._state=2,this._startOffset=null,this._suspendInstanceEvents||this._onStop(),!0)},setExternalNodes:function(){},clearExternalNodes:function(){},getExternalNodes:function(){return[null,null]},_onLoadedMetadata:function(){this.source.removeEventListener("loadedmetadata",this._loadedMetadataHandler),this._isReady=!0;let t=OT(this._startOffset,this.duration);t=OT(this._startTime+t,this._sound.duration),this._startOffset=null,this.source.currentTime=t},_createSource:function(){return this._sound&&this._sound.audio&&(this._isReady=!1,this.source=this._sound.audio.cloneNode(!0),this.source.addEventListener("loadedmetadata",this._loadedMetadataHandler),this.source.addEventListener("timeupdate",this._timeUpdateHandler),this.source.onended=this._endedHandler),this.source},_onTimeUpdate:function(){this._duration&&this.source.currentTime>OT(this._startTime+this._duration,this.source.duration)&&(this.loop?this.source.currentTime=OT(this._startTime,this.source.duration):(this.source.removeEventListener("timeupdate",this._timeUpdateHandler),this.source.pause(),this._onEnded()))},_onManagerDestroy:function(){this.source&&this.source.pause()}}),Object.defineProperty(FT.prototype,"volume",{get:function(){return this._volume},set:function(t){t=Z.clamp(t,0,1),this._volume=t,this.source&&(this.source.volume=t*this._manager.volume)}}),Object.defineProperty(FT.prototype,"pitch",{get:function(){return this._pitch},set:function(t){this._pitch=Math.max(Number(t)||0,.01),this.source&&(this.source.playbackRate=this._pitch)}}),Object.defineProperty(FT.prototype,"sound",{get:function(){return this._sound},set:function(t){this.stop(),this._sound=t}}),Object.defineProperty(FT.prototype,"currentTime",{get:function(){return null!==this._startOffset?this._startOffset:2!==this._state&&this.source?this.source.currentTime-this._startTime:0},set:function(t){t<0||(this._startOffset=t,this.source&&this._isReady&&(this.source.currentTime=OT(this._startTime+OT(t,this.duration),this._sound.duration),this._startOffset=null))}}));class BT extends FT{constructor(t,e,i){super(t,e,i),i=i||{},this._position=new ht,i.position&&(this.position=i.position),this._velocity=new ht,i.velocity&&(this.velocity=i.velocity),this.maxDistance=void 0!==i.maxDistance?Number(i.maxDistance):1e4,this.refDistance=void 0!==i.refDistance?Number(i.refDistance):1,this.rollOffFactor=void 0!==i.rollOffFactor?Number(i.rollOffFactor):1,this.distanceModel=void 0!==i.distanceModel?i.distanceModel:Gu}}if(zu())Object.assign(BT.prototype,{_initializeNodes:function(){this.gain=this._manager.context.createGain(),this.panner=this._manager.context.createPanner(),this.panner.connect(this.gain),this._inputNode=this.panner,this._connectorNode=this.gain,this._connectorNode.connect(this._manager.context.destination)}}),Object.defineProperty(BT.prototype,"position",{get:function(){return this._position},set:function(t){this._position.copy(t),this.panner.setPosition(t.x,t.y,t.z)}}),Object.defineProperty(BT.prototype,"velocity",{get:function(){return this._velocity},set:function(t){this._velocity.copy(t),this.panner.setVelocity(t.x,t.y,t.z)}}),Object.defineProperty(BT.prototype,"maxDistance",{get:function(){return this.panner.maxDistance},set:function(t){this.panner.maxDistance=t}}),Object.defineProperty(BT.prototype,"refDistance",{get:function(){return this.panner.refDistance},set:function(t){this.panner.refDistance=t}}),Object.defineProperty(BT.prototype,"rollOffFactor",{get:function(){return this.panner.rolloffFactor},set:function(t){this.panner.rolloffFactor=t}}),Object.defineProperty(BT.prototype,"distanceModel",{get:function(){return this.panner.distanceModel},set:function(t){this.panner.distanceModel=t}});else{let t=new ht;const e=function(e,i,n,s,r,o){t=t.sub2(e,i);const a=t.length();if(a<n)return 1;if(a>s)return 0;let l=0;return o===Gu?l=1-r*(a-n)/(s-n):o===ju?l=n/(n+r*(a-n)):o===Hu&&(l=Math.pow(a/n,-r)),Z.clamp(l,0,1)};Object.defineProperty(BT.prototype,"position",{get:function(){return this._position},set:function(t){if(this._position.copy(t),this.source){const t=this._manager.listener.getPosition(),i=e(t,this._position,this.refDistance,this.maxDistance,this.rollOffFactor,this.distanceModel),n=this.volume;this.source.volume=n*i*this._manager.volume}}}),Object.defineProperty(BT.prototype,"velocity",{get:function(){return this._velocity},set:function(t){this._velocity.copy(t)}}),Object.defineProperty(BT.prototype,"maxDistance",{get:function(){return this._maxDistance},set:function(t){this._maxDistance=t}}),Object.defineProperty(BT.prototype,"refDistance",{get:function(){return this._refDistance},set:function(t){this._refDistance=t}}),Object.defineProperty(BT.prototype,"rollOffFactor",{get:function(){return this._rollOffFactor},set:function(t){this._rollOffFactor=t}}),Object.defineProperty(BT.prototype,"distanceModel",{get:function(){return this._distanceModel},set:function(t){this._distanceModel=t}})}const NT={volume:0,pitch:0,loop:!1,startTime:0,duration:0,position:new ht,maxDistance:0,refDistance:0,rollOffFactor:0,distanceModel:0,onPlay:null,onPause:null,onResume:null,onStop:null,onEnd:null};class UT extends x{constructor(t,e="Untitled",i={}){super(),this._component=t,this._assets=t.system.app.assets,this._manager=t.system.manager,this.name=e,this._volume=void 0!==i.volume?Z.clamp(Number(i.volume)||0,0,1):1,this._pitch=void 0!==i.pitch?Math.max(.01,Number(i.pitch)||0):1,this._loop=!(void 0===i.loop||!i.loop),this._duration=i.duration>0?i.duration:null,this._startTime=Math.max(0,Number(i.startTime)||0),this._overlap=!!i.overlap,this._autoPlay=!!i.autoPlay,this._firstNode=null,this._lastNode=null,this._asset=i.asset,this._asset instanceof Od&&(this._asset=this._asset.id),this._onInstancePlayHandler=this._onInstancePlay.bind(this),this._onInstancePauseHandler=this._onInstancePause.bind(this),this._onInstanceResumeHandler=this._onInstanceResume.bind(this),this._onInstanceStopHandler=this._onInstanceStop.bind(this),this._onInstanceEndHandler=this._onInstanceEnd.bind(this),this.instances=[]}play(){if(this.overlap||this.stop(),!this.isLoaded&&!this._hasAsset())return;const t=this._createInstance();if(this.instances.push(t),this.isLoaded)t.play();else{const e=function(e){const i=t._playWhenLoaded;t.sound=e,i&&t.play()};this.off("load",e),this.once("load",e),this.load()}return t}pause(){let t=!1;const e=this.instances;for(let i=0,n=e.length;i<n;i++)e[i].pause()&&(t=!0);return t}resume(){let t=!1;const e=this.instances;for(let i=0,n=e.length;i<n;i++)e[i].resume()&&(t=!0);return t}stop(){let t=!1;const e=this.instances;let i=e.length;for(;i--;)e[i].stop(),t=!0;return e.length=0,t}load(){if(!this._hasAsset())return;const t=this._assets.get(this._asset);return t?(t.off("remove",this._onAssetRemoved,this),t.on("remove",this._onAssetRemoved,this),t.resource?void this.fire("load",t.resource):(t.off("load",this._onAssetLoad,this),t.once("load",this._onAssetLoad,this),void this._assets.load(t))):(this._assets.off("add:"+this._asset,this._onAssetAdd,this),void this._assets.once("add:"+this._asset,this._onAssetAdd,this))}setExternalNodes(t,e){if(t){if(e||(e=t),this._firstNode=t,this._lastNode=e,!this._overlap){const i=this.instances;for(let n=0,s=i.length;n<s;n++)i[n].setExternalNodes(t,e)}}else console.error("The firstNode must have a valid AudioNode")}clearExternalNodes(){if(this._firstNode=null,this._lastNode=null,!this._overlap){const t=this.instances;for(let e=0,i=t.length;e<i;e++)t[e].clearExternalNodes()}}getExternalNodes(){return[this._firstNode,this._lastNode]}_hasAsset(){return null!=this._asset}_createInstance(){let t=null;const e=this._component;let i=null;if(this._hasAsset()){const t=this._assets.get(this._asset);t&&(i=t.resource)}const n=NT;return n.volume=this._volume*e.volume,n.pitch=this._pitch*e.pitch,n.loop=this._loop,n.startTime=this._startTime,n.duration=this._duration,n.onPlay=this._onInstancePlayHandler,n.onPause=this._onInstancePauseHandler,n.onResume=this._onInstanceResumeHandler,n.onStop=this._onInstanceStopHandler,n.onEnd=this._onInstanceEndHandler,e.positional?(n.position.copy(e.entity.getPosition()),n.maxDistance=e.maxDistance,n.refDistance=e.refDistance,n.rollOffFactor=e.rollOffFactor,n.distanceModel=e.distanceModel,t=new BT(this._manager,i,n)):t=new FT(this._manager,i,n),this._firstNode&&t.setExternalNodes(this._firstNode,this._lastNode),t}_onInstancePlay(t){this.fire("play",t),this._component.fire("play",this,t)}_onInstancePause(t){this.fire("pause",t),this._component.fire("pause",this,t)}_onInstanceResume(t){this.fire("resume",t),this._component.fire("resume",this,t)}_onInstanceStop(t){const e=this.instances.indexOf(t);-1!==e&&this.instances.splice(e,1),this.fire("stop",t),this._component.fire("stop",this,t)}_onInstanceEnd(t){const e=this.instances.indexOf(t);-1!==e&&this.instances.splice(e,1),this.fire("end",t),this._component.fire("end",this,t)}_onAssetAdd(t){this.load()}_onAssetLoad(t){this.load()}_onAssetRemoved(t){t.off("remove",this._onAssetRemoved,this),this._assets.off("add:"+t.id,this._onAssetAdd,this),this.stop()}updatePosition(t){const e=this.instances;for(let i=0,n=e.length;i<n;i++)e[i].position=t}get volume(){return this._volume}set volume(t){if(this._volume=Z.clamp(Number(t)||0,0,1),!this._overlap){const t=this.instances;for(let e=0,i=t.length;e<i;e++)t[e].volume=this._volume*this._component.volume}}get pitch(){return this._pitch}set pitch(t){if(this._pitch=Math.max(Number(t)||0,.01),!this._overlap){const t=this.instances;for(let e=0,i=t.length;e<i;e++)t[e].pitch=this.pitch*this._component.pitch}}get loop(){return this._loop}set loop(t){this._loop=!!t;const e=this.instances;for(let t=0,i=e.length;t<i;t++)e[t].loop=this._loop}get autoPlay(){return this._autoPlay}set autoPlay(t){this._autoPlay=!!t}get overlap(){return this._overlap}set overlap(t){this._overlap=!!t}get startTime(){return this._startTime}set startTime(t){if(this._startTime=Math.max(0,Number(t)||0),!this._overlap){const t=this.instances;for(let e=0,i=t.length;e<i;e++)t[e].startTime=this._startTime}}get duration(){let t=0;if(this._hasAsset()){const e=this._assets.get(this._asset);t=e.resource?e.resource.duration:0}return null!=this._duration?this._duration%(t||1):t}set duration(t){if(this._duration=Math.max(0,Number(t)||0)||null,!this._overlap){const t=this.instances;for(let e=0,i=t.length;e<i;e++)t[e].duration=this._duration}}get asset(){return this._asset}set asset(t){const e=this._asset;if(e){this._assets.off("add:"+e,this._onAssetAdd,this);const t=this._assets.get(e);t&&t.off("remove",this._onAssetRemoved,this)}this._asset=t,this._asset instanceof Od&&(this._asset=this._asset.id),this._hasAsset()&&this._component.enabled&&this._component.entity.enabled&&this.load()}get isLoaded(){if(this._hasAsset()){const t=this._assets.get(this._asset);if(t)return!!t.resource}return!1}get isPlaying(){const t=this.instances;for(let e=0,i=t.length;e<i;e++)if(t[e].isPlaying)return!0;return!1}get isPaused(){const t=this.instances,e=t.length;if(0===e)return!1;for(let i=0;i<e;i++)if(!t[i].isPaused)return!1;return!0}get isStopped(){const t=this.instances;for(let e=0,i=t.length;e<i;e++)if(!t[e].isStopped)return!1;return!0}}class VT extends gg{constructor(t,e){super(t,e),this._volume=1,this._pitch=1,this._positional=!0,this._refDistance=1,this._maxDistance=1e4,this._rollOffFactor=1,this._distanceModel=Gu,this._slots={},this._playingBeforeDisable={}}get positional(){return this._positional}set positional(t){this._positional=t;const e=this._slots;for(const t in e){const i=e[t];if(!i.overlap){const t=i.instances;for(let e=t.length-1;e>=0;e--){const n=t[e].isPlaying||t[e].isSuspended,s=t[e].currentTime;n&&t[e].stop();const r=i._createInstance();n&&(r.play(),r.currentTime=s),t.push(r)}}}}get slots(){return this._slots}set slots(t){const e=this._slots;if(e)for(const t in e)e[t].stop();const i={};for(const e in t)t[e]instanceof UT?i[t[e].name]=t[e]:t[e].name&&(i[t[e].name]=new UT(this,t[e].name,t[e]));this._slots=i,this.enabled&&this.entity.enabled&&this.onEnable()}onEnable(){if(this.system._inTools)return;const t=this._slots,e=this._playingBeforeDisable;for(const i in t){const n=t[i];n.autoPlay&&n.isStopped?n.play():e[i]?n.resume():n.isLoaded||n.load()}}onDisable(){const t=this._slots,e={};for(const i in t)t[i].overlap||t[i].isPlaying&&(t[i].pause(),e[i]=!0);this._playingBeforeDisable=e}onRemove(){this.off()}addSlot(t,e){const i=this._slots;if(i[t])return null;const n=new UT(this,t,e);return i[t]=n,n.autoPlay&&this.enabled&&this.entity.enabled&&n.play(),n}removeSlot(t){const e=this._slots;e[t]&&(e[t].stop(),delete e[t])}slot(t){return this._slots[t]}play(t){if(!this.enabled||!this.entity.enabled)return null;const e=this._slots[t];return e?e.play():null}pause(t){const e=this._slots;if(t){const i=e[t];if(!i)return;i.pause()}else for(const t in e)e[t].pause()}resume(t){const e=this._slots;if(t){const i=e[t];if(!i)return;i.isPaused&&i.resume()}else for(const t in e)e[t].resume()}stop(t){const e=this._slots;if(t){const i=e[t];if(!i)return;i.stop()}else for(const t in e)e[t].stop()}}function zT(t,e){Object.defineProperty(VT.prototype,t,{get:function(){return this[e]},set:function(i){this[e]=i;const n=this._slots;for(const e in n){const s=n[e];if(!s.overlap){const e=s.instances;for(let n=0,s=e.length;n<s;n++)e[n][t]=i}}}})}function WT(t,e){Object.defineProperty(VT.prototype,t,{get:function(){return this[e]},set:function(i){this[e]=i;const n=this._slots;for(const e in n){const s=n[e];if(!s.overlap){const e=s.instances;for(let n=0,r=e.length;n<r;n++)e[n][t]=s[t]*i}}}})}WT("pitch","_pitch"),WT("volume","_volume"),zT("refDistance","_refDistance"),zT("maxDistance","_maxDistance"),zT("rollOffFactor","_rollOffFactor"),zT("distanceModel","_distanceModel");class GT{constructor(){this.enabled=!0}}const jT=["enabled"];class HT extends bg{constructor(t,e){super(t),this.id="sound",this.ComponentType=VT,this.DataType=GT,this.schema=jT,this.manager=e,this.app.systems.on("update",this.onUpdate,this),this.on("beforeremove",this.onBeforeRemove,this)}initializeComponentData(t,e,i){i=["volume","pitch","positional","refDistance","maxDistance","rollOffFactor","distanceModel","slots"];for(let n=0;n<i.length;n++)e.hasOwnProperty(i[n])&&(t[i[n]]=e[i[n]]);super.initializeComponentData(t,e,["enabled"])}cloneComponent(t,e){const i=t.sound,n=i.slots,s={};for(const t in n){const e=n[t];s[t]={name:e.name,volume:e.volume,pitch:e.pitch,loop:e.loop,duration:e.duration,startTime:e.startTime,overlap:e.overlap,autoPlay:e.autoPlay,asset:e.asset}}const r={distanceModel:i.distanceModel,enabled:i.enabled,maxDistance:i.maxDistance,pitch:i.pitch,positional:i.positional,refDistance:i.refDistance,rollOffFactor:i.rollOffFactor,slots:s,volume:i.volume};return this.addComponent(e,r)}onUpdate(t){const e=this.store;for(const t in e)if(e.hasOwnProperty(t)){const i=e[t].entity;if(i.enabled){const t=i.sound;if(t.enabled&&t.positional){const e=i.getPosition(),n=t.slots;for(const t in n)n[t].updatePosition(e)}}}}onBeforeRemove(t,e){const i=e.slots;for(const t in i)i[t].overlap||i[t].stop();e.onRemove()}destroy(){super.destroy(),this.app.systems.off("update",this.onUpdate,this)}get volume(){return this.manager.volume}set volume(t){this.manager.volume=t}get context(){return zu()?this.manager.context:null}}gg._buildAccessors(VT.prototype,jT);const XT="simple",YT="animated";class qT extends x{constructor(t,e){super(),this._component=t,this._frame=0,this._sprite=null,this._spriteAsset=null,this.spriteAsset=e.spriteAsset,this.name=e.name,this.fps=e.fps||0,this.loop=e.loop||!1,this._playing=!1,this._paused=!1,this._time=0}_onSpriteAssetAdded(t){this._component.system.app.assets.off("add:"+t.id,this._onSpriteAssetAdded,this),this._spriteAsset===t.id&&this._bindSpriteAsset(t)}_bindSpriteAsset(t){t.on("load",this._onSpriteAssetLoad,this),t.on("remove",this._onSpriteAssetRemove,this),t.resource?this._onSpriteAssetLoad(t):this._component.system.app.assets.load(t)}_unbindSpriteAsset(t){t.off("load",this._onSpriteAssetLoad,this),t.off("remove",this._onSpriteAssetRemove,this),t.resource&&t.resource.atlas&&this._component.system.app.assets.off("load:"+t.data.textureAtlasAsset,this._onTextureAtlasLoad,this)}_onSpriteAssetLoad(t){if(t.resource)if(t.resource.atlas)this.sprite=t.resource;else{const e=t.data.textureAtlasAsset,i=this._component.system.app.assets;i.off("load:"+e,this._onTextureAtlasLoad,this),i.once("load:"+e,this._onTextureAtlasLoad,this)}else this.sprite=null}_onTextureAtlasLoad(t){const e=this._spriteAsset;e instanceof Od?this._onSpriteAssetLoad(e):this._onSpriteAssetLoad(this._component.system.app.assets.get(e))}_onSpriteAssetRemove(t){this.sprite=null}_onSpriteMeshesChange(){this._component.currentClip===this&&this._component._showFrame(this.frame)}_onSpritePpuChanged(){this._component.currentClip===this&&this.sprite.renderMode!==ki&&this._component._showFrame(this.frame)}_update(t){if(0===this.fps)return;if(!this._playing||this._paused||!this._sprite)return;const e=this.fps<0?-1:1,i=this._time+t*this._component.speed*e,n=this.duration,s=i>n||i<0;this._setTime(i);let r=this.frame;r=this._sprite?Math.floor(this._sprite.frameKeys.length*this._time/n):0,r!==this._frame&&this._setFrame(r),s&&(this.loop?(this.fire("loop"),this._component.fire("loop",this)):(this._playing=!1,this._paused=!1,this.fire("end"),this._component.fire("end",this)))}_setTime(t){this._time=t;const e=this.duration;this._time<0?this.loop?this._time=this._time%e+e:this._time=0:this._time>e&&(this.loop?this._time%=e:this._time=e)}_setFrame(t){this._sprite?this._frame=Z.clamp(t,0,this._sprite.frameKeys.length-1):this._frame=t,this._component.currentClip===this&&this._component._showFrame(this._frame)}_destroy(){this._sprite&&(this.sprite=null),this._spriteAsset&&(this.spriteAsset=null)}play(){this._playing||(this._playing=!0,this._paused=!1,this.frame=0,this.fire("play"),this._component.fire("play",this))}pause(){this._playing&&!this._paused&&(this._paused=!0,this.fire("pause"),this._component.fire("pause",this))}resume(){this._paused&&(this._paused=!1,this.fire("resume"),this._component.fire("resume",this))}stop(){this._playing&&(this._playing=!1,this._paused=!1,this._time=0,this.frame=0,this.fire("stop"),this._component.fire("stop",this))}get spriteAsset(){return this._spriteAsset}set spriteAsset(t){const e=this._component.system.app.assets;let i=t;if(t instanceof Od&&(i=t.id),this._spriteAsset!==i){if(this._spriteAsset){const t=e.get(this._spriteAsset);t&&this._unbindSpriteAsset(t)}if(this._spriteAsset=i,this._spriteAsset){const t=e.get(this._spriteAsset);t?this._bindSpriteAsset(t):(this.sprite=null,e.on("add:"+this._spriteAsset,this._onSpriteAssetAdded,this))}else this.sprite=null}}get sprite(){return this._sprite}set sprite(t){if(this._sprite&&(this._sprite.off("set:meshes",this._onSpriteMeshesChange,this),this._sprite.off("set:pixelsPerUnit",this._onSpritePpuChanged,this),this._sprite.off("set:atlas",this._onSpriteMeshesChange,this),this._sprite.atlas&&this._sprite.atlas.off("set:texture",this._onSpriteMeshesChange,this)),this._sprite=t,this._sprite&&(this._sprite.on("set:meshes",this._onSpriteMeshesChange,this),this._sprite.on("set:pixelsPerUnit",this._onSpritePpuChanged,this),this._sprite.on("set:atlas",this._onSpriteMeshesChange,this),this._sprite.atlas&&this._sprite.atlas.on("set:texture",this._onSpriteMeshesChange,this)),this._component.currentClip===this){let e;t&&t.atlas?(t.atlas.texture&&(e=this._component._meshInstance,e&&(e.setParameter("texture_emissiveMap",t.atlas.texture),e.setParameter("texture_opacityMap",t.atlas.texture)),this._component.enabled&&this._component.entity.enabled&&this._component._showModel()),this.time&&this.fps?this.time=this.time:this.frame=this.frame):(e=this._component._meshInstance,e&&(e.deleteParameter("texture_emissiveMap"),e.deleteParameter("texture_opacityMap")),this._component._hideModel())}}get frame(){return this._frame}set frame(t){this._setFrame(t);const e=this.fps||Number.MIN_VALUE;this._setTime(this._frame/e)}get isPlaying(){return this._playing}get isPaused(){return this._paused}get duration(){if(this._sprite){const t=this.fps||Number.MIN_VALUE;return this._sprite.frameKeys.length/Math.abs(t)}return 0}get time(){return this._time}set time(t){this._setTime(t),this._sprite?this.frame=Math.min(this._sprite.frameKeys.length-1,Math.floor(this._time*Math.abs(this.fps))):this.frame=0}}class KT extends gg{constructor(t,e){super(t,e),this._type=XT,this._material=t.defaultMaterial,this._color=new rt(1,1,1,1),this._colorUniform=new Float32Array(3),this._speed=1,this._flipX=!1,this._flipY=!1,this._width=1,this._height=1,this._drawOrder=0,this._layers=[Zt],this._outerScale=new _t(1,1),this._outerScaleUniform=new Float32Array(2),this._innerOffset=new ut,this._innerOffsetUniform=new Float32Array(4),this._atlasRect=new ut,this._atlasRectUniform=new Float32Array(4),this._batchGroupId=-1,this._batchGroup=null,this._node=new La,this._model=new Uu,this._model.graph=this._node,this._meshInstance=null,e.addChild(this._model.graph),this._model._entity=e,this._updateAabbFunc=this._updateAabb.bind(this),this._addedModel=!1,this._autoPlayClip=null,this._clips={},this._defaultClip=new qT(this,{name:this.entity.name,fps:0,loop:!1,spriteAsset:null}),this._currentClip=this._defaultClip}onEnable(){const t=this.system.app,e=t.scene;e.on("set:layers",this._onLayersChanged,this),e.layers&&(e.layers.on("add",this._onLayerAdded,this),e.layers.on("remove",this._onLayerRemoved,this)),this._showModel(),this._autoPlayClip&&this._tryAutoPlay(),this._batchGroupId>=0&&t.batcher.insert(Nh.SPRITE,this._batchGroupId,this.entity)}onDisable(){const t=this.system.app,e=t.scene;e.off("set:layers",this._onLayersChanged,this),e.layers&&(e.layers.off("add",this._onLayerAdded,this),e.layers.off("remove",this._onLayerRemoved,this)),this.stop(),this._hideModel(),this._batchGroupId>=0&&t.batcher.remove(Nh.SPRITE,this._batchGroupId,this.entity)}onDestroy(){this._currentClip=null,this._defaultClip&&(this._defaultClip._destroy(),this._defaultClip=null);for(const t in this._clips)this._clips[t]._destroy();this._clips=null,this._hideModel(),this._model=null,this._node&&(this._node.parent&&this._node.parent.removeChild(this._node),this._node=null),this._meshInstance&&(this._meshInstance.material=null,this._meshInstance.mesh=null,this._meshInstance=null)}_showModel(){if(this._addedModel)return;if(!this._meshInstance)return;const t=[this._meshInstance];for(let e=0,i=this._layers.length;e<i;e++){const i=this.system.app.scene.layers.getLayerById(this._layers[e]);i&&i.addMeshInstances(t)}this._addedModel=!0}_hideModel(){if(!this._addedModel||!this._meshInstance)return;const t=[this._meshInstance];for(let e=0,i=this._layers.length;e<i;e++){const i=this.system.app.scene.layers.getLayerById(this._layers[e]);i&&i.removeMeshInstances(t)}this._addedModel=!1}_showFrame(t){if(!this.sprite)return;const e=this.sprite.meshes[t];if(!e)return void(this._meshInstance&&(this._meshInstance.mesh=null,this._meshInstance.visible=!1));let i;if(i=this.sprite.renderMode===Oi?this.system.default9SlicedMaterialSlicedMode:this.sprite.renderMode===Fi?this.system.default9SlicedMaterialTiledMode:this.system.defaultMaterial,this._meshInstance||(this._meshInstance=new Kh(e,this._material,this._node),this._meshInstance.castShadow=!1,this._meshInstance.receiveShadow=!1,this._meshInstance.drawOrder=this._drawOrder,this._model.meshInstances.push(this._meshInstance),this._colorUniform[0]=this._color.r,this._colorUniform[1]=this._color.g,this._colorUniform[2]=this._color.b,this._meshInstance.setParameter("material_emissive",this._colorUniform),this._meshInstance.setParameter("material_opacity",this._color.a),this.enabled&&this.entity.enabled&&this._showModel()),this._meshInstance.material!==i&&(this._meshInstance.material=i),this._meshInstance.mesh!==e&&(this._meshInstance.mesh=e,this._meshInstance.visible=!0,this._meshInstance._aabbVer=-1),this.sprite.atlas&&this.sprite.atlas.texture?(this._meshInstance.setParameter("texture_emissiveMap",this.sprite.atlas.texture),this._meshInstance.setParameter("texture_opacityMap",this.sprite.atlas.texture)):(this._meshInstance.deleteParameter("texture_emissiveMap"),this._meshInstance.deleteParameter("texture_opacityMap")),!this.sprite.atlas||this.sprite.renderMode!==Oi&&this.sprite.renderMode!==Fi)this._meshInstance._updateAabbFunc=null;else{this._meshInstance._updateAabbFunc=this._updateAabbFunc;const e=this.sprite.atlas.frames[this.sprite.frameKeys[t]];if(e){const t=2/e.rect.z,i=2/e.rect.w;this._innerOffset.set(e.border.x*t,e.border.y*i,e.border.z*t,e.border.w*i);const n=this.sprite.atlas.texture;this._atlasRect.set(e.rect.x/n.width,e.rect.y/n.height,e.rect.z/n.width,e.rect.w/n.height)}else this._innerOffset.set(0,0,0,0);this._innerOffsetUniform[0]=this._innerOffset.x,this._innerOffsetUniform[1]=this._innerOffset.y,this._innerOffsetUniform[2]=this._innerOffset.z,this._innerOffsetUniform[3]=this._innerOffset.w,this._meshInstance.setParameter("innerOffset",this._innerOffsetUniform),this._atlasRectUniform[0]=this._atlasRect.x,this._atlasRectUniform[1]=this._atlasRect.y,this._atlasRectUniform[2]=this._atlasRect.z,this._atlasRectUniform[3]=this._atlasRect.w,this._meshInstance.setParameter("atlasRect",this._atlasRectUniform)}this._updateTransform()}_updateTransform(){let t=this.flipX?-1:1,e=this.flipY?-1:1,i=0,n=0;if(this.sprite&&(this.sprite.renderMode===Oi||this.sprite.renderMode===Fi)){let s=1,r=1;if(this.sprite.atlas){const t=this.sprite.atlas.frames[this.sprite.frameKeys[this.frame]];t&&(s=t.rect.z,r=t.rect.w,i=(.5-t.pivot.x)*this._width,n=(.5-t.pivot.y)*this._height)}const o=s/this.sprite.pixelsPerUnit,a=r/this.sprite.pixelsPerUnit;this._outerScale.set(Math.max(this._width,this._innerOffset.x*o),Math.max(this._height,this._innerOffset.y*a)),t*=o,e*=a,this._outerScale.x/=o,this._outerScale.y/=a,t*=Z.clamp(this._width/(this._innerOffset.x*o),1e-4,1),e*=Z.clamp(this._height/(this._innerOffset.y*a),1e-4,1),this._meshInstance&&(this._outerScaleUniform[0]=this._outerScale.x,this._outerScaleUniform[1]=this._outerScale.y,this._meshInstance.setParameter("outerScale",this._outerScaleUniform))}this._node.setLocalScale(t,e,1),this._node.setLocalPosition(i,n,0)}_updateAabb(t){return t.center.set(0,0,0),t.halfExtents.set(.5*this._outerScale.x,.5*this._outerScale.y,.001),t.setFromTransformedAabb(t,this._node.getWorldTransform()),t}_tryAutoPlay(){if(!this._autoPlayClip)return;if(this.type!==YT)return;const t=this._clips[this._autoPlayClip];!t||t.isPlaying||this._currentClip&&this._currentClip.isPlaying||this.enabled&&this.entity.enabled&&this.play(t.name)}_onLayersChanged(t,e){t.off("add",this.onLayerAdded,this),t.off("remove",this.onLayerRemoved,this),e.on("add",this.onLayerAdded,this),e.on("remove",this.onLayerRemoved,this),this.enabled&&this.entity.enabled&&this._showModel()}_onLayerAdded(t){this.layers.indexOf(t.id)<0||this._addedModel&&this.enabled&&this.entity.enabled&&this._meshInstance&&t.addMeshInstances([this._meshInstance])}_onLayerRemoved(t){if(!this._meshInstance)return;this.layers.indexOf(t.id)<0||t.removeMeshInstances([this._meshInstance])}removeModelFromLayers(){for(let t=0;t<this.layers.length;t++){const e=this.system.app.scene.layers.getLayerById(this.layers[t]);e&&e.removeMeshInstances([this._meshInstance])}}addClip(t){const e=new qT(this,{name:t.name,fps:t.fps,loop:t.loop,spriteAsset:t.spriteAsset});return this._clips[t.name]=e,e.name&&e.name===this._autoPlayClip&&this._tryAutoPlay(),e}removeClip(t){delete this._clips[t]}clip(t){return this._clips[t]}play(t){const e=this._clips[t],i=this._currentClip;return i&&i!==e&&(i._playing=!1),this._currentClip=e,this._currentClip&&(this._currentClip=e,this._currentClip.play()),e}pause(){this._currentClip!==this._defaultClip&&this._currentClip.isPlaying&&this._currentClip.pause()}resume(){this._currentClip!==this._defaultClip&&this._currentClip.isPaused&&this._currentClip.resume()}stop(){this._currentClip!==this._defaultClip&&this._currentClip.stop()}get type(){return this._type}set type(t){this._type!==t&&(this._type=t,this._type===XT?(this.stop(),this._currentClip=this._defaultClip,this.enabled&&this.entity.enabled&&(this._currentClip.frame=this.frame,this._currentClip.sprite?this._showModel():this._hideModel())):this._type===YT&&(this.stop(),this._autoPlayClip&&this._tryAutoPlay(),this._currentClip&&this._currentClip.isPlaying&&this.enabled&&this.entity.enabled?this._showModel():this._hideModel()))}get frame(){return this._currentClip.frame}set frame(t){this._currentClip.frame=t}get spriteAsset(){return this._defaultClip._spriteAsset}set spriteAsset(t){this._defaultClip.spriteAsset=t}get sprite(){return this._currentClip.sprite}set sprite(t){this._currentClip.sprite=t}get material(){return this._material}set material(t){this._material=t,this._meshInstance&&(this._meshInstance.material=t)}get color(){return this._color}set color(t){this._color.r=t.r,this._color.g=t.g,this._color.b=t.b,this._meshInstance&&(this._colorUniform[0]=this._color.r,this._colorUniform[1]=this._color.g,this._colorUniform[2]=this._color.b,this._meshInstance.setParameter("material_emissive",this._colorUniform))}get opacity(){return this._color.a}set opacity(t){this._color.a=t,this._meshInstance&&this._meshInstance.setParameter("material_opacity",t)}get clips(){return this._clips}set clips(t){if(t){for(const e in this._clips){let i=!1;for(const n in t)if(t[n].name===e){i=!0,this._clips[e].fps=t[n].fps,this._clips[e].loop=t[n].loop,t[n].hasOwnProperty("sprite")?this._clips[e].sprite=t[n].sprite:t[n].hasOwnProperty("spriteAsset")&&(this._clips[e].spriteAsset=t[n].spriteAsset);break}i||this.removeClip(e)}for(const e in t)this._clips[t[e].name]||this.addClip(t[e]);this._autoPlayClip&&this._tryAutoPlay(),this._currentClip&&this._currentClip.sprite||this._hideModel()}else for(const t in this._clips)this.removeClip(t)}get currentClip(){return this._currentClip}get speed(){return this._speed}set speed(t){this._speed=t}get flipX(){return this._flipX}set flipX(t){this._flipX!==t&&(this._flipX=t,this._updateTransform())}get flipY(){return this._flipY}set flipY(t){this._flipY!==t&&(this._flipY=t,this._updateTransform())}get width(){return this._width}set width(t){t!==this._width&&(this._width=t,this._outerScale.x=this._width,!this.sprite||this.sprite.renderMode!==Fi&&this.sprite.renderMode!==Oi||this._updateTransform())}get height(){return this._height}set height(t){t!==this._height&&(this._height=t,this._outerScale.y=this.height,!this.sprite||this.sprite.renderMode!==Fi&&this.sprite.renderMode!==Oi||this._updateTransform())}get batchGroupId(){return this._batchGroupId}set batchGroupId(t){if(this._batchGroupId===t)return;const e=this._batchGroupId;this._batchGroupId=t,this.entity.enabled&&e>=0&&this.system.app.batcher.remove(Nh.SPRITE,e,this.entity),this.entity.enabled&&t>=0?this.system.app.batcher.insert(Nh.SPRITE,t,this.entity):e>=0&&this._currentClip&&this._currentClip.sprite&&this.enabled&&this.entity.enabled&&this._showModel()}get autoPlayClip(){return this._autoPlayClip}set autoPlayClip(t){this._autoPlayClip=t instanceof qT?t.name:t,this._tryAutoPlay()}get drawOrder(){return this._drawOrder}set drawOrder(t){this._drawOrder=t,this._meshInstance&&(this._meshInstance.drawOrder=t)}get layers(){return this._layers}set layers(t){this._addedModel&&this._hideModel(),this._layers=t,this._meshInstance&&this.enabled&&this.entity.enabled&&this._showModel()}get aabb(){return this._meshInstance?this._meshInstance.aabb:null}}class ZT{constructor(){this.enabled=!0}}const QT=["enabled"];class $T extends bg{constructor(t){super(t),this.id="sprite",this.ComponentType=KT,this.DataType=ZT,this.schema=QT,this._defaultTexture=null,this._defaultMaterial=null,this._default9SlicedMaterialSlicedMode=null,this._default9SlicedMaterialTiledMode=null,this.app.systems.on("update",this.onUpdate,this),this.on("beforeremove",this.onBeforeRemove,this)}get defaultMaterial(){if(!this._defaultMaterial){const t=new _a(this.app.graphicsDevice,{width:1,height:1,format:ys}),e=new Uint8Array(t.lock());e[0]=e[1]=e[2]=e[3]=255,t.name="sprite",t.unlock();const i=new wl;i.diffuse.set(0,0,0),i.emissive.set(.5,.5,.5),i.emissiveMap=t,i.emissiveMapTint=!0,i.opacityMap=t,i.opacityMapChannel="a",i.opacityTint=!0,i.opacity=0,i.useLighting=!1,i.useGammaTonemap=!1,i.useFog=!1,i.useSkybox=!1,i.blendType=Dt,i.depthWrite=!1,i.pixelSnap=!1,i.cull=Hn,i.update(),this._defaultTexture=t,this._defaultMaterial=i}return this._defaultMaterial}set defaultMaterial(t){this._defaultMaterial=t}get default9SlicedMaterialSlicedMode(){if(!this._default9SlicedMaterialSlicedMode){const t=this.defaultMaterial.clone();t.nineSlicedMode=Oi,t.update(),this._default9SlicedMaterialSlicedMode=t}return this._default9SlicedMaterialSlicedMode}set default9SlicedMaterialSlicedMode(t){this._default9SlicedMaterialSlicedMode=t}get default9SlicedMaterialTiledMode(){if(!this._default9SlicedMaterialTiledMode){const t=this.defaultMaterial.clone();t.nineSlicedMode=Fi,t.update(),this._default9SlicedMaterialTiledMode=t}return this._default9SlicedMaterialTiledMode}set default9SlicedMaterialTiledMode(t){this._default9SlicedMaterialTiledMode=t}destroy(){super.destroy(),this.app.systems.off("update",this.onUpdate,this),this._defaultTexture&&(this._defaultTexture.destroy(),this._defaultTexture=null)}initializeComponentData(t,e,i){if(void 0!==e.enabled&&(t.enabled=e.enabled),t.type=e.type,e.layers&&Array.isArray(e.layers)&&(t.layers=e.layers.slice(0)),void 0!==e.drawOrder&&(t.drawOrder=e.drawOrder),void 0!==e.color&&(e.color instanceof rt?t.color.set(e.color.r,e.color.g,e.color.b,void 0!==e.opacity?e.opacity:1):t.color.set(e.color[0],e.color[1],e.color[2],void 0!==e.opacity?e.opacity:1),t.color=t.color),void 0!==e.opacity&&(t.opacity=e.opacity),void 0!==e.flipX&&(t.flipX=e.flipX),void 0!==e.flipY&&(t.flipY=e.flipY),void 0!==e.width&&(t.width=e.width),void 0!==e.height&&(t.height=e.height),void 0!==e.spriteAsset&&(t.spriteAsset=e.spriteAsset),e.sprite&&(t.sprite=e.sprite),void 0!==e.frame&&(t.frame=e.frame),e.clips)for(const i in e.clips)t.addClip(e.clips[i]);void 0!==e.speed&&(t.speed=e.speed),e.autoPlayClip&&(t.autoPlayClip=e.autoPlayClip),t.batchGroupId=void 0===e.batchGroupId||null===e.batchGroupId?-1:e.batchGroupId,super.initializeComponentData(t,e,i)}cloneComponent(t,e){const i=t.sprite;return this.addComponent(e,{enabled:i.enabled,type:i.type,spriteAsset:i.spriteAsset,sprite:i.sprite,frame:i.frame,color:i.color.clone(),opacity:i.opacity,flipX:i.flipX,flipY:i.flipY,speed:i.speed,clips:i.clips,autoPlayClip:i.autoPlayClip,batchGroupId:i.batchGroupId,drawOrder:i.drawOrder,layers:i.layers.slice(0)})}onUpdate(t){const e=this.store;for(const i in e)if(e.hasOwnProperty(i)){const n=e[i];if(n.data.enabled&&n.entity.enabled){const e=n.entity.sprite;e._currentClip&&e._currentClip._update(t)}}}onBeforeRemove(t,e){e.onDestroy()}}gg._buildAccessors(KT.prototype,QT);class JT extends gg{constructor(t,e){super(t,e),this._oldState=!0,this._size=new ht,this.on("set_enabled",this._onSetEnabled,this)}onEnable(){this._checkState()}onDisable(){this._checkState()}_onSetEnabled(t,e,i){this._checkState()}_checkState(){const t=this.enabled&&this.entity.enabled;t!==this._oldState&&(this._oldState=t,this.fire("enable"),this.fire("state",this.enabled))}_onBeforeRemove(){this.fire("remove")}set size(t){t instanceof ht?this._size.copy(t):t instanceof Array&&t.length>=3&&this.size.set(t[0],t[1],t[2])}get size(){return this._size}}class tA{constructor(){this.enabled=!0}}const eA=["enabled"];class iA extends bg{constructor(t){super(t),this.id="zone",this.ComponentType=JT,this.DataType=tA,this.schema=eA,this.on("beforeremove",this._onBeforeRemove,this)}initializeComponentData(t,e,i){t.enabled=!e.hasOwnProperty("enabled")||!!e.enabled,e.size&&(e.size instanceof ht?t.size.copy(e.size):e.size instanceof Array&&e.size.length>=3&&t.size.set(e.size[0],e.size[1],e.size[2]))}cloneComponent(t,e){const i={size:t.zone.size};return this.addComponent(e,i)}_onBeforeRemove(t,e){e._onBeforeRemove()}}gg._buildAccessors(JT.prototype,eA);class nA{constructor(t){this.frame={fps:0,ms:0,dt:0,updateStart:0,updateTime:0,renderStart:0,renderTime:0,physicsStart:0,physicsTime:0,cullTime:0,sortTime:0,skinTime:0,morphTime:0,instancingTime:0,triangles:0,otherPrimitives:0,shaders:0,materials:0,cameras:0,shadowMapUpdates:0,shadowMapTime:0,depthMapTime:0,forwardTime:0,lightClustersTime:0,lightClusters:0,_timeToCountFrames:0,_fpsAccum:0},this.drawCalls={forward:0,depth:0,shadow:0,immediate:0,misc:0,total:0,skinned:0,instanced:0,removedByInstancing:0},this.misc={renderTargetCreationTime:0},this.particles={updatesPerFrame:0,_updatesPerFrame:0,frameTime:0,_frameTime:0},this.shaders=t._shaderStats,this.vram=t._vram,Object.defineProperty(this.vram,"totalUsed",{get:function(){return this.tex+this.vb+this.ib}}),Object.defineProperty(this.vram,"geom",{get:function(){return this.vb+this.ib}})}get scene(){return Ka().scene._stats}get lightmapper(){return Ka().lightmapper._stats}get batcher(){return Ka().batcher._stats}}class sA{constructor(t,e){this.name=t,this.url=e,this.data=null,this._loading=!1,this._onLoadedCallbacks=[]}get loaded(){return!!this.data}get loading(){return this._loading}}class rA{constructor(t){this._app=t,this._list=[],this._index={},this._urlIndex={}}destroy(){this._app=null}list(){return this._list}add(t,e){if(this._index.hasOwnProperty(t))return!1;const i=new sA(t,e),n=this._list.push(i);return this._index[i.name]=n-1,this._urlIndex[i.url]=n-1,!0}find(t){return this._index.hasOwnProperty(t)?this._list[this._index[t]]:null}findByUrl(t){return this._urlIndex.hasOwnProperty(t)?this._list[this._urlIndex[t]]:null}remove(t){if(this._index.hasOwnProperty(t)){const e=this._index[t];let i=this._list[e];delete this._urlIndex[i.url],delete this._index[t],this._list.splice(e,1);for(let t=0;t<this._list.length;t++)i=this._list[t],this._index[i.name]=t,this._urlIndex[i.url]=t}}_loadSceneData(t,e,i){let n=t;if(t instanceof sA?n=t.url:(t=this.findByUrl(n))||(t=new sA("Untitled",n)),!t.url)return void i("URL or SceneRegistryItem is null when loading a scene");if(t.loaded)return void i(null,t);const s=this._app.loader.getHandler("hierarchy");this._app.assets&&this._app.assets.prefix&&!md.test(n)&&(n=T.join(this._app.assets.prefix,n)),t._onLoadedCallbacks.push(i),t._loading||s.load(n,(function(i,n){t.data=n,t._loading=!1;for(let e=0;e<t._onLoadedCallbacks.length;e++)t._onLoadedCallbacks[e](i,t);e||(t.data=null),t._onLoadedCallbacks.length=0})),t._loading=!0}loadSceneData(t,e){this._loadSceneData(t,!0,e)}unloadSceneData(t){"string"==typeof t&&(t=this.findByUrl(t)),t&&(t.data=null)}loadSceneHierarchy(t,e){const i=this,n=this._app.loader.getHandler("hierarchy");this._loadSceneData(t,!1,(function(t,s){if(t)return void(e&&e(t));const r=s.url,o=s.data;i._app._preloadScripts(o,(function(){i._app.systems.script.preloading=!0;const s=n.open(r,o);i._app.systems.script.preloading=!1,i._app.loader.clearCache(r,"hierarchy"),i._app.root.addChild(s),i._app.systems.fire("initialize",s),i._app.systems.fire("postInitialize",s),e&&e(t,s)}))}))}loadSceneSettings(t,e){const i=this;this._loadSceneData(t,!1,(function(t,n){t?e&&e(t):(i._app.applySceneSettings(n.data.settings),e&&e(null))}))}loadScene(t,e){const i=this,n=this._app.loader.getHandler("scene");this._app.assets&&this._app.assets.prefix&&!md.test(t)&&(t=T.join(this._app.assets.prefix,t)),n.load(t,(function(s,r){if(s)e&&e(s);else{const s=function(){i._app.systems.script.preloading=!0;const s=n.open(t,r),o=i.findByUrl(t);o&&!o.loaded&&(o.data=r),i._app.systems.script.preloading=!1,i._app.loader.clearCache(t,"scene"),i._app.loader.patch({resource:s,type:"scene"},i._app.assets),i._app.root.addChild(s.root),i._app.systems.rigidbody&&"undefined"!=typeof Ammo&&i._app.systems.rigidbody.gravity.set(s._gravity.x,s._gravity.y,s._gravity.z),e&&e(null,s)};i._app._preloadScripts(r,s)}}))}}class oA{constructor(t){this.application=t,this.device=t.graphicsDevice,this.clearOptions=null,this.layer=null,this.init()}allocateTexture(t,e,i){const n=new _a(t,{format:i,width:t.width,height:t.height,mipmaps:!1,minFilter:Kn,magFilter:Kn,addressU:pn,addressV:pn});return n.name=e,t.scope.resolve("uDepthMap").setValue(n),n}allocateRenderTarget(t,e,i,n,s){const r=this.allocateTexture(e,i,n);return t?(t.destroyFrameBuffers(),s?t._depthBuffer=r:t._colorBuffer=r):t=new Gl({colorBuffer:s?null:r,depthBuffer:s?r:null,depth:!s,stencil:e.supportsStencil,autoResolve:!1}),t}releaseRenderTarget(t){t&&(t.destroyTextureBuffers(),t.destroy())}initWebGl2(){const t=this.application,e=this;this.clearOptions={flags:0},this.layer=new w_({enabled:!1,name:"Depth",id:Qt,onEnable:function(){e.releaseRenderTarget(this.renderTarget),this.renderTarget=e.allocateRenderTarget(this.renderTarget,t.graphicsDevice,"rt-depth2",Rs,!0)},onDisable:function(){e.releaseRenderTarget(this.renderTarget),this.renderTarget=null},onPreRenderOpaque:function(i){const n=t.graphicsDevice.gl;this.srcFbo=n.getParameter(n.FRAMEBUFFER_BINDING),this.renderTarget.width===t.graphicsDevice.width&&this.renderTarget.height===t.graphicsDevice.height||this.onEnable(),this.oldClear=this.cameras[i].camera._clearOptions,this.cameras[i].camera._clearOptions=e.clearOptions},onPostRenderOpaque:function(e){if(this.renderTarget){this.cameras[e].camera._clearOptions=this.oldClear,t.graphicsDevice.setRenderTarget(this.renderTarget),t.graphicsDevice.updateBegin();const i=t.graphicsDevice.gl;i.bindFramebuffer(i.READ_FRAMEBUFFER,this.srcFbo),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,this.renderTarget._glFrameBuffer),i.blitFramebuffer(0,0,this.renderTarget.width,this.renderTarget.height,0,0,this.renderTarget.width,this.renderTarget.height,i.DEPTH_BUFFER_BIT,i.NEAREST)}}})}initWebGl1(){const t=this.application,e=this;this.clearOptions={color:[254/255,254/255,254/255,254/255],depth:1,flags:Fn|Bn},this.layer=new w_({enabled:!1,name:"Depth",id:Qt,shaderPass:Pi,onEnable:function(){e.releaseRenderTarget(this.renderTarget),this.renderTarget=e.allocateRenderTarget(this.renderTarget,t.graphicsDevice,"rt-depth1",ys,!1)},onDisable:function(){e.releaseRenderTarget(this.renderTarget),this.renderTarget=null},onPostCull:function(e){const i=this.instances.visibleOpaque[e],n=i.list,s=t.scene.layers,r=s.subLayerEnabled,o=s.subLayerList,a=t.scene.layers.getLayerById(Zt).renderTarget,l=this.cameras[e];let h=0;const c=s.layerList;for(let t=0;t<c.length;t++){const e=c[t];if(e===this)break;if(e.renderTarget!==a||!e.enabled||!r[t])continue;const i=e.cameras.indexOf(l);if(i<0)continue;let s=o[t]?e.instances.visibleTransparent[i]:e.instances.visibleOpaque[i];const _=s.length;s=s.list;for(let t=0;t<_;t++){const e=s[t];e.material&&e.material.depthWrite&&!e._noDepthDrawGl1&&(n[h]=e,h++)}}i.length=h},onPreRenderOpaque:function(i){this.renderTarget.width===t.graphicsDevice.width&&this.renderTarget.height===t.graphicsDevice.height||this.onEnable(),this.oldClear=this.cameras[i].camera._clearOptions,this.cameras[i].camera._clearOptions=e.clearOptions},onDrawCall:function(){t.graphicsDevice.setColorWrite(!0,!0,!0,!0)},onPostRenderOpaque:function(t){this.renderTarget&&(this.cameras[t].camera._clearOptions=this.oldClear)}})}init(){this.device.webgl2?this.initWebGl2():this.initWebGl1()}patch(t){t.onEnable=this.layer.onEnable,t.onDisable=this.layer.onDisable,t.onPreRenderOpaque=this.layer.onPreRenderOpaque,t.onPostRenderOpaque=this.layer.onPostRenderOpaque,t.shaderPass=this.layer.shaderPass,t.onPostCull=this.layer.onPostCull,t.onDrawCall=this.layer.onDrawCall}}class aA{constructor(t){this.length=t,this.count=0}inc(){this.count++}done(){return this.count===this.length}}let lA=null;class hA extends x{constructor(t,e={}){super(),hA._applications[t.id]=this,Za(this),lA=this,this._destroyRequested=!1,this._inFrameUpdate=!1,this._time=0,this.timeScale=1,this.maxDeltaTime=.1,this.frame=0,this.autoRender=!0,this.renderNextFrame=!1,this.useLegacyScriptAttributeCloning=bf.legacy,this._librariesLoaded=!1,this._fillMode=fm,this._resolutionMode=gm,this._allowResize=!0,this.context=this,e.graphicsDeviceOptions||(e.graphicsDeviceOptions={}),B.browser&&navigator.xr&&(e.graphicsDeviceOptions.xrCompatible=!0),e.graphicsDeviceOptions.alpha=e.graphicsDeviceOptions.alpha||!1,this.graphicsDevice=new zl(t,e.graphicsDeviceOptions),this.stats=new nA(this.graphicsDevice),this._soundManager=new qu(e),this.loader=new pf(this),ja.init(this.graphicsDevice),this._entityIndex={},this.scene=new Vu,this.root=new uA(this),this.root._enabledInHierarchy=!0,this._enableList=[],this._enableList.size=0,this.assets=new lm(this.loader),e.assetPrefix&&(this.assets.prefix=e.assetPrefix),this.bundles=new hm(this.assets),this.enableBundles="undefined"!=typeof TextDecoder,this.scriptsOrder=e.scriptsOrder||[],this.scripts=new cm(this),this.i18n=new um(this),this.scenes=new rA(this);const i=this;this.defaultLayerWorld=new w_({name:"World",id:Zt}),this.sceneDepth=new oA(this),this.defaultLayerDepth=this.sceneDepth.layer,this.defaultLayerSkybox=new w_({enabled:!0,name:"Skybox",id:$t,opaqueSortMode:Wi}),this.defaultLayerUi=new w_({enabled:!0,name:"UI",id:te,transparentSortMode:Gi,passThrough:!1}),this.defaultLayerImmediate=new w_({enabled:!0,name:"Immediate",id:Jt,opaqueSortMode:Wi,passThrough:!0});const n=new Ja(this.graphicsDevice,"default");n.pushOpaque(this.defaultLayerWorld),n.pushOpaque(this.defaultLayerDepth),n.pushOpaque(this.defaultLayerSkybox),n.pushTransparent(this.defaultLayerWorld),n.pushOpaque(this.defaultLayerImmediate),n.pushTransparent(this.defaultLayerImmediate),n.pushTransparent(this.defaultLayerUi),this.scene.layers=n,this._immediateLayer=this.defaultLayerImmediate,this.scene.on("set:layers",(function(t,e){const n=e.layerList;let s;for(let t=0;t<n.length;t++)switch(s=n[t],s.id){case Qt:i.sceneDepth.patch(s);break;case te:s.passThrough=i.defaultLayerUi.passThrough;break;case Jt:s.passThrough=i.defaultLayerImmediate.passThrough}})),G_.createPlaceholder(this.graphicsDevice),this.renderer=new d_(this.graphicsDevice),this.renderer.scene=this.scene,this.lightmapper=new bA(this.graphicsDevice,this.root,this.scene,this.renderer,this.assets),this.once("prerender",this._firstBake,this),this.batcher=new rc(this.graphicsDevice,this.root,this.scene),this.once("prerender",this._firstBatch,this),this.keyboard=e.keyboard||null,this.mouse=e.mouse||null,this.touch=e.touch||null,this.gamepads=e.gamepads||null,this.elementInput=e.elementInput||null,this.elementInput&&(this.elementInput.app=this),this.vr=null,this.xr=new mg(this),this.elementInput&&this.elementInput.attachSelectEvents(),this._inTools=!1,this._skyboxLast=0,this._scriptPrefix=e.scriptPrefix||"",this.enableBundles&&this.loader.addHandler("bundle",new Ap(this.assets)),this.loader.addHandler("animation",new up),this.loader.addHandler("animclip",new dp),this.loader.addHandler("animstategraph",new fp),this.loader.addHandler("model",new hf(this.graphicsDevice,this.scene.defaultMaterial)),this.loader.addHandler("render",new df(this.assets)),this.loader.addHandler("material",new tf(this)),this.loader.addHandler("texture",new om(this.graphicsDevice,this.assets,this.loader)),this.loader.addHandler("text",new Rf),this.loader.addHandler("json",new qp),this.loader.addHandler("audio",new yp(this._soundManager)),this.loader.addHandler("script",new yf(this)),this.loader.addHandler("scene",new ff(this)),this.loader.addHandler("cubemap",new Dp(this.graphicsDevice,this.assets,this.loader)),this.loader.addHandler("html",new Yp),this.loader.addHandler("css",new Pp),this.loader.addHandler("shader",new vf),this.loader.addHandler("hierarchy",new Xp(this)),this.loader.addHandler("folder",new kp),this.loader.addHandler("font",new Up(this.loader)),this.loader.addHandler("binary",new vp),this.loader.addHandler("textureatlas",new kf(this.loader)),this.loader.addHandler("sprite",new Af(this.assets,this.graphicsDevice)),this.loader.addHandler("template",new Mf(this)),this.loader.addHandler("container",new Ip(this.graphicsDevice,this.scene.defaultMaterial)),this.systems=new Jy,this.systems.add(new rx(this)),this.systems.add(new $y(this)),this.systems.add(new jv(this)),this.systems.add(new nb(this)),this.systems.add(new wb(this)),this.systems.add(new ES(this)),this.systems.add(new LS(this)),this.systems.add(new Jb(this)),this.systems.add(new wS(this)),bf.legacy?this.systems.add(new Cx(this)):this.systems.add(new vx(this)),this.systems.add(new Pb(this,this._soundManager)),this.systems.add(new HT(this,this._soundManager)),this.systems.add(new Eb(this,this._soundManager)),this.systems.add(new zS(this)),this.systems.add(new ux(this)),this.systems.add(new Ov(this)),this.systems.add(new Hb(this)),this.systems.add(new IT(this)),this.systems.add(new kT(this)),this.systems.add(new $T(this)),this.systems.add(new mS(this)),this.systems.add(new Kv(this)),this.systems.add(new iA(this)),this._visibilityChangeHandler=this.onVisibilityChange.bind(this),"undefined"!=typeof document&&(void 0!==document.hidden?(this._hiddenAttr="hidden",document.addEventListener("visibilitychange",this._visibilityChangeHandler,!1)):void 0!==document.mozHidden?(this._hiddenAttr="mozHidden",document.addEventListener("mozvisibilitychange",this._visibilityChangeHandler,!1)):void 0!==document.msHidden?(this._hiddenAttr="msHidden",document.addEventListener("msvisibilitychange",this._visibilityChangeHandler,!1)):void 0!==document.webkitHidden&&(this._hiddenAttr="webkitHidden",document.addEventListener("webkitvisibilitychange",this._visibilityChangeHandler,!1))),this._immediate=new W_(this.graphicsDevice,this),this.tick=_A(this)}static getApplication(t){return t?hA._applications[t]:Ka()}get fillMode(){return this._fillMode}get resolutionMode(){return this._resolutionMode}configure(t,e){$.get(t,(t,i)=>{if(t)return void e(t);const n=i.application_properties,s=i.scenes,r=i.assets;this._parseApplicationProperties(n,t=>{this._parseScenes(s),this._parseAssets(r),e(t||null)})})}preload(t){this.fire("preload:start");const e=this.assets.list({preload:!0}),i=new aA(e.length);let n=!1;const s=()=>{this.graphicsDevice&&!n&&i.done()&&(n=!0,this.fire("preload:end"),t())},r=e.length;if(i.length){const t=t=>{i.inc(),this.fire("preload:progress",i.count/r),i.done()&&s()},n=(t,e)=>{i.inc(),this.fire("preload:progress",i.count/r),i.done()&&s()};for(let o=0;o<e.length;o++)e[o].loaded?(i.inc(),this.fire("preload:progress",i.count/r),i.done()&&s()):(e[o].once("load",t),e[o].once("error",n),this.assets.load(e[o]))}else s()}_preloadScripts(t,e){if(!bf.legacy)return void e();this.systems.script.preloading=!0;const i=this._getScriptReferences(t),n=i.length,s=new aA(n),r=/^http(s)?:\/\//;if(n){const t=(t,i)=>{t&&console.error(t),s.inc(),s.done()&&(this.systems.script.preloading=!1,e())};for(let e=0;e<n;e++){let n=i[e];!r.test(n.toLowerCase())&&this._scriptPrefix&&(n=T.join(self._scriptPrefix,i[e])),this.loader.load(n,"script",t)}}else this.systems.script.preloading=!1,e()}_handleAreaLightDataProperty(t){const e=this.assets.get(t);e?this.setAreaLightLuts(e):this.assets.once("add:"+t,this.setAreaLightLuts,this)}_parseApplicationProperties(t,e){if("number"==typeof t.maxAssetRetries&&t.maxAssetRetries>0&&this.loader.enableRetry(t.maxAssetRetries),t.useDevicePixelRatio||(t.useDevicePixelRatio=t.use_device_pixel_ratio),t.resolutionMode||(t.resolutionMode=t.resolution_mode),t.fillMode||(t.fillMode=t.fill_mode),this._width=t.width,this._height=t.height,t.useDevicePixelRatio&&(this.graphicsDevice.maxPixelRatio=window.devicePixelRatio),this.setCanvasResolution(t.resolutionMode,this._width,this._height),this.setCanvasFillMode(t.fillMode,this._width,this._height),t.layers&&t.layerOrder){const e=new Ja(this.graphicsDevice,"application"),i={};for(const e in t.layers){const n=t.layers[e];n.id=parseInt(e,10),n.enabled=n.id!==Qt,i[e]=new w_(n)}for(let n=0,s=t.layerOrder.length;n<s;n++){const s=t.layerOrder[n],r=i[s.layer];r&&(s.transparent?e.pushTransparent(r):e.pushOpaque(r),e.subLayerEnabled[n]=s.enabled)}this.scene.layers=e}if(t.batchGroups)for(let e=0,i=t.batchGroups.length;e<i;e++){const i=t.batchGroups[e];this.batcher.addGroup(i.name,i.dynamic,i.maxAabbSize,i.id,i.layers)}t.i18nAssets&&(this.i18n.assets=t.i18nAssets),t.areaLightDataAsset&&this._handleAreaLightDataProperty(t.areaLightDataAsset),this._loadLibraries(t.libraries,e)}_loadLibraries(t,e){const i=t.length;let n=i;const s=/^http(s)?:\/\//;if(i){const r=(t,i)=>{n--,t?e(t):0===n&&(this.onLibrariesLoaded(),e(null))};for(let e=0;e<i;++e){let i=t[e];!s.test(i.toLowerCase())&&this._scriptPrefix&&(i=T.join(this._scriptPrefix,i)),this.loader.load(i,"script",r)}}else this.onLibrariesLoaded(),e(null)}_parseScenes(t){if(t)for(let e=0;e<t.length;e++)this.scenes.add(t[e].name,t[e].url)}_parseAssets(t){const e=[],i={},n={};if(bf.legacy){if(this.enableBundles)for(const i in t)"bundle"===t[i].type&&(n[i]=!0,e.push(t[i]));for(const i in t)n[i]||e.push(t[i])}else{for(let n=0;n<this.scriptsOrder.length;n++){const s=this.scriptsOrder[n];t[s]&&(i[s]=!0,e.push(t[s]))}if(this.enableBundles)for(const i in t)"bundle"===t[i].type&&(n[i]=!0,e.push(t[i]));for(const s in t)i[s]||n[s]||e.push(t[s])}for(let t=0;t<e.length;t++){const i=e[t],n=new Od(i.name,i.type,i.file,i.data);if(n.id=parseInt(i.id,10),n.preload=!!i.preload&&i.preload,n.loaded="script"===i.type&&i.data&&i.data.loadingType>0,n.tags.add(i.tags),i.i18n)for(const t in i.i18n)n.addLocalizedAssetId(t,i.i18n[t]);this.assets.add(n)}}_getScriptReferences(t){let e=[];t.settings.priority_scripts&&(e=t.settings.priority_scripts);const i=[],n={};for(let t=0;t<e.length;t++)i.push(e[t]),n[e[t]]=!0;const s=t.entities;for(const t in s){if(!s[t].components.script)continue;const e=s[t].components.script.scripts;for(let t=0;t<e.length;t++)n[e[t].url]||(i.push(e[t].url),n[e[t].url]=!0)}return i}start(){this.frame=0,this.fire("start",{timestamp:H(),target:this}),this._librariesLoaded||this.onLibrariesLoaded(),this.systems.fire("initialize",this.root),this.fire("initialize"),this.systems.fire("postInitialize",this.root),this.fire("postinitialize"),this.tick()}inputUpdate(t){this.controller&&this.controller.update(t),this.mouse&&this.mouse.update(t),this.keyboard&&this.keyboard.update(t),this.gamepads&&this.gamepads.update(t)}update(t){this.frame++,this.graphicsDevice.updateClientRect(),this.vr&&this.vr.poll(),bf.legacy&&this.systems.fire("fixedUpdate",1/60),this.systems.fire(this._inTools?"toolsUpdate":"update",t),this.systems.fire("animationUpdate",t),this.systems.fire("postUpdate",t),this.fire("update",t),this.inputUpdate(t)}render(){this.fire("prerender"),this.root.syncHierarchy(),this.batcher.updateAll(),this.renderer.renderComposition(this.scene.layers),this.fire("postrender")}_fillFrameStatsBasic(t,e,i){const n=this.stats.frame;n.dt=e,n.ms=i,t>n._timeToCountFrames?(n.fps=n._fpsAccum,n._fpsAccum=0,n._timeToCountFrames=t+1e3):n._fpsAccum++,this.stats.drawCalls.total=this.graphicsDevice._drawCallsPerFrame,this.graphicsDevice._drawCallsPerFrame=0}_fillFrameStats(){let t=this.stats.frame;t.cameras=this.renderer._camerasRendered,t.materials=this.renderer._materialSwitches,t.shaders=this.graphicsDevice._shaderSwitchesPerFrame,t.shadowMapUpdates=this.renderer._shadowMapUpdates,t.shadowMapTime=this.renderer._shadowMapTime,t.depthMapTime=this.renderer._depthMapTime,t.forwardTime=this.renderer._forwardTime;const e=this.graphicsDevice._primsPerFrame;t.triangles=e[Ys]/3+Math.max(e[qs]-2,0)+Math.max(e[Ks]-2,0),t.cullTime=this.renderer._cullTime,t.sortTime=this.renderer._sortTime,t.skinTime=this.renderer._skinTime,t.morphTime=this.renderer._morphTime,t.instancingTime=this.renderer._instancingTime,t.lightClusters=this.renderer._lightClusters,t.lightClustersTime=this.renderer._lightClustersTime,t.otherPrimitives=0;for(let i=0;i<e.length;i++)i<Ys&&(t.otherPrimitives+=e[i]),e[i]=0;this.renderer._camerasRendered=0,this.renderer._materialSwitches=0,this.renderer._shadowMapUpdates=0,this.graphicsDevice._shaderSwitchesPerFrame=0,this.renderer._cullTime=0,this.renderer._layerCompositionUpdateTime=0,this.renderer._lightClustersTime=0,this.renderer._sortTime=0,this.renderer._skinTime=0,this.renderer._morphTime=0,this.renderer._instancingTime=0,this.renderer._shadowMapTime=0,this.renderer._depthMapTime=0,this.renderer._forwardTime=0,t=this.stats.drawCalls,t.forward=this.renderer._forwardDrawCalls,t.culled=this.renderer._numDrawCallsCulled,t.depth=0,t.shadow=this.renderer._shadowDrawCalls,t.skinned=this.renderer._skinDrawCalls,t.immediate=0,t.instanced=0,t.removedByInstancing=0,t.misc=t.total-(t.forward+t.shadow),this.renderer._depthDrawCalls=0,this.renderer._shadowDrawCalls=0,this.renderer._forwardDrawCalls=0,this.renderer._numDrawCallsCulled=0,this.renderer._skinDrawCalls=0,this.renderer._immediateRendered=0,this.renderer._instancedDrawCalls=0,this.renderer._removedByInstancing=0,this.stats.misc.renderTargetCreationTime=this.graphicsDevice.renderTargetCreationTime,t=this.stats.particles,t.updatesPerFrame=t._updatesPerFrame,t.frameTime=t._frameTime,t._updatesPerFrame=0,t._frameTime=0}setCanvasFillMode(t,e,i){this._fillMode=t,this.resizeCanvas(e,i)}setCanvasResolution(t,e,i){this._resolutionMode=t,t===mm&&void 0===e&&(e=this.graphicsDevice.canvas.clientWidth,i=this.graphicsDevice.canvas.clientHeight),this.graphicsDevice.resizeCanvas(e,i)}isHidden(){return document[this._hiddenAttr]}onVisibilityChange(){this.isHidden()?this._soundManager.suspend():this._soundManager.resume()}resizeCanvas(t,e){if(!this._allowResize)return;if(this.xr&&this.xr.session)return;const i=window.innerWidth,n=window.innerHeight;if(this._fillMode===fm){const s=this.graphicsDevice.canvas.width/this.graphicsDevice.canvas.height;s>i/n?e=(t=i)/s:t=(e=n)*s}else this._fillMode===pm&&(t=i,e=n);return this.graphicsDevice.canvas.style.width=t+"px",this.graphicsDevice.canvas.style.height=e+"px",this.updateCanvasSize(),{width:t,height:e}}updateCanvasSize(){if(this._allowResize&&!this.xr.active&&this._resolutionMode===mm){const t=this.graphicsDevice.canvas;this.graphicsDevice.resizeCanvas(t.clientWidth,t.clientHeight)}}onLibrariesLoaded(){this._librariesLoaded=!0,this.systems.rigidbody.onLibraryLoaded()}applySceneSettings(t){let e;if(this.systems.rigidbody&&"undefined"!=typeof Ammo){const e=t.physics.gravity;this.systems.rigidbody.gravity.set(e[0],e[1],e[2])}this.scene.applySettings(t),t.render.hasOwnProperty("skybox")&&(t.render.skybox?(e=this.assets.get(t.render.skybox),e?this.setSkybox(e):this.assets.once("add:"+t.render.skybox,this.setSkybox,this)):this.setSkybox(null))}setAreaLightLuts(t){if(t){const e=this.graphicsDevice;t.ready(t=>{G_.set(e,t.resource)}),this.assets.load(t)}}setSkybox(t){if(t){if(this._skyboxLast===t.id)return void(0!==this.scene.skyboxMip||t.loadFaces?this._onSkyboxChange(t):this._skyboxLoad(t));this._skyboxLast&&(this.assets.off("add:"+this._skyboxLast,this.setSkybox,this),this.assets.off("load:"+this._skyboxLast,this._onSkyboxChange,this),this.assets.off("remove:"+this._skyboxLast,this._skyboxRemove,this)),this._skyboxLast=t.id,this.assets.on("load:"+t.id,this._onSkyboxChange,this),this.assets.once("remove:"+t.id,this._skyboxRemove,this),t.resource&&this.scene.setSkybox(t.resources),this._skyboxLoad(t)}else{if(!this._skyboxLast)return;this._skyboxRemove({id:this._skyboxLast})}}enableVr(){this.vr||(this.vr=new ym(this))}disableVr(){this.vr&&(this.vr.destroy(),this.vr=null)}_onSkyboxChange(t){this.scene.setSkybox(t.resources)}_skyboxLoad(t){0===this.scene.skyboxMip&&(t.loadFaces=!0),this.assets.load(t),this._onSkyboxChange(t)}_skyboxRemove(t){this._skyboxLast&&(this.assets.off("add:"+t.id,this.setSkybox,this),this.assets.off("load:"+t.id,this._onSkyboxChange,this),this.assets.off("remove:"+t.id,this._skyboxRemove,this),this.scene.setSkybox(null),this._skyboxLast=null)}_firstBake(){this.lightmapper.bake(null,this.scene.lightmapMode)}_firstBatch(){this.batcher.generate()}_processTimestamp(t){return t}_getDefaultDrawLayer(){return this.scene.layers.getLayerById(Jt)}drawLine(t,e,i=rt.WHITE,n=!0,s=this._getDefaultDrawLayer()){this._immediate.getBatch(s,n).addLines([t,e],[i,i])}drawLines(t,e,i=!0,n=this._getDefaultDrawLayer()){this._immediate.getBatch(n,i).addLines(t,e)}drawLineArrays(t,e,i=!0,n=this._getDefaultDrawLayer()){this._immediate.getBatch(n,i).addLinesArrays(t,e)}drawWireSphere(t,e,i=rt.WHITE,n=20,s=!0,r=this._getDefaultDrawLayer()){this._immediate.drawWireSphere(t,e,i,n,s,r)}drawWireAlignedBox(t,e,i=rt.WHITE,n=!0,s=this._getDefaultDrawLayer()){this._immediate.drawWireAlignedBox(t,e,i,n,s)}drawMeshInstance(t,e=this._getDefaultDrawLayer()){this._immediate.drawMesh(null,null,null,t,e)}drawMesh(t,e,i,n=this._getDefaultDrawLayer()){this._immediate.drawMesh(e,i,t,null,n)}drawQuad(t,e,i=this._getDefaultDrawLayer()){this._immediate.drawMesh(e,t,this._immediate.getQuadMesh(),null,i)}drawTexture(t,e,i,n,s,r,o=this._getDefaultDrawLayer()){const a=new bt;a.setTRS(new ht(t,e,0),yt.IDENTITY,new ht(i,n,0)),r||((r=new pl).setParameter("colorMap",s),r.shader=this._immediate.getTextureShader(),r.update()),this.drawQuad(a,r,o)}drawDepthTexture(t,e,i,n,s=this._getDefaultDrawLayer()){const r=new pl;r.shader=this._immediate.getDepthTextureShader(),r.update(),this.drawTexture(t,e,i,n,null,r,s)}destroy(){if(this._inFrameUpdate)return void(this._destroyRequested=!0);const t=this.graphicsDevice.canvas.id;this.off("librariesloaded"),"undefined"!=typeof document&&(document.removeEventListener("visibilitychange",this._visibilityChangeHandler,!1),document.removeEventListener("mozvisibilitychange",this._visibilityChangeHandler,!1),document.removeEventListener("msvisibilitychange",this._visibilityChangeHandler,!1),document.removeEventListener("webkitvisibilitychange",this._visibilityChangeHandler,!1)),this._visibilityChangeHandler=null,this.root.destroy(),this.root=null,this.mouse&&(this.mouse.off(),this.mouse.detach(),this.mouse=null),this.keyboard&&(this.keyboard.off(),this.keyboard.detach(),this.keyboard=null),this.touch&&(this.touch.off(),this.touch.detach(),this.touch=null),this.elementInput&&(this.elementInput.detach(),this.elementInput=null),this.controller&&(this.controller=null),this.systems.destroy(),this.scene.layers&&this.scene.layers.destroy();const e=this.assets.list();for(let t=0;t<e.length;t++)e[t].unload(),e[t].off();this.assets.off(),this.bundles.destroy(),this.bundles=null,this.i18n.destroy(),this.i18n=null;for(const t in this.loader.getHandler("script")._cache){const e=this.loader.getHandler("script")._cache[t],i=e.parentNode;i&&i.removeChild(e)}this.loader.getHandler("script")._cache={},this.loader.destroy(),this.loader=null,this.scene.destroy(),this.scene=null,this.systems=null,this.context=null,this.scripts.destroy(),this.scripts=null,this.scenes.destroy(),this.scenes=null,this.lightmapper.destroy(),this.lightmapper=null,this.batcher.destroy(),this.batcher=null,this._entityIndex={},this.defaultLayerDepth.onPreRenderOpaque=null,this.defaultLayerDepth.onPostRenderOpaque=null,this.defaultLayerDepth.onDisable=null,this.defaultLayerDepth.onEnable=null,this.defaultLayerDepth=null,this.defaultLayerWorld=null,Uo&&(Uo.destroy(),Uo=null),this.vr&&(this.vr.destroy(),this.vr=null),this.xr.end(),Fu.staticDestroy(),this.renderer.destroy(),this.renderer=null,this.graphicsDevice.destroy(),this.graphicsDevice=null,this.tick=null,this.off(),this._soundManager&&(this._soundManager.destroy(),this._soundManager=null),bf.app=null,hA._applications[t]=null,Ka()===this&&Za(null)}getEntityFromIndex(t){return this._entityIndex[t]}}hA._applications={};const cA={},_A=function(t){const e=t;let i;return function(t,n){if(!e.graphicsDevice)return;Za(e),i&&(window.cancelAnimationFrame(i),i=null),lA=e;const s=e._processTimestamp(t)||H(),r=s-(e._time||s);let o=r/1e3;o=Z.clamp(o,0,e.maxDeltaTime),o*=e.timeScale,e._time=s,i=e.vr&&e.vr.display?e.vr.display.requestAnimationFrame(e.tick):e.xr.session?e.xr.session.requestAnimationFrame(e.tick):B.browser?window.requestAnimationFrame(e.tick):null,e.graphicsDevice.contextLost||(e._fillFrameStatsBasic(s,o,r),e._inFrameUpdate=!0,e.fire("frameupdate",r),n?(e.xr.update(n),e.graphicsDevice.defaultFramebuffer=n.session.renderState.baseLayer.framebuffer):e.graphicsDevice.defaultFramebuffer=null,e.update(o),e.fire("framerender"),(e.autoRender||e.renderNextFrame)&&(e.updateCanvasSize(),e.render(),e.renderNextFrame=!1),cA.timestamp=H(),cA.target=e,e.fire("frameend",cA),e.fire("frameEnd",cA),e.vr&&e.vr.display&&e.vr.display.presenting&&e.vr.display.submitFrame(),e._inFrameUpdate=!1,e._destroyRequested&&e.destroy())}};class uA extends La{constructor(t,e){if(super(t),t instanceof hA&&(e=t),this._batchHandle=null,this.c={},this._app=e,!e&&(this._app=hA.getApplication(),!this._app))throw new Error("Couldn't find current application");this._guid=null,this._destroying=!1,this._template=!1}addComponent(t,e){const i=this._app.systems[t];return i?this.c[t]?null:i.addComponent(this,e):null}removeComponent(t){const e=this._app.systems[t];e&&this.c[t]&&e.removeComponent(this)}findComponent(t){const e=this.findOne((function(e){return e.c&&e.c[t]}));return e&&e.c[t]}findComponents(t){return this.find((function(e){return e.c&&e.c[t]})).map((function(e){return e.c[t]}))}getGuid(){return this._guid||this.setGuid(C.create()),this._guid}setGuid(t){const e=this._app._entityIndex;this._guid&&delete e[this._guid],this._guid=t,e[this._guid]=this}_notifyHierarchyStateChanged(t,e){let i=!1;t===this&&0===this._app._enableList.length&&(i=!0),t._beingEnabled=!0,t._onHierarchyStateChanged(e),t._onHierarchyStatePostChanged&&this._app._enableList.push(t);const n=t._children;for(let t=0,i=n.length;t<i;t++)n[t]._enabled&&this._notifyHierarchyStateChanged(n[t],e);if(t._beingEnabled=!1,i){for(let t=0;t<this._app._enableList.length;t++)this._app._enableList[t]._onHierarchyStatePostChanged();this._app._enableList.length=0}}_onHierarchyStateChanged(t){super._onHierarchyStateChanged(t);const e=this.c;for(const i in e)if(e.hasOwnProperty(i)){const n=e[i];n.enabled&&(t?n.onEnable():n.onDisable())}}_onHierarchyStatePostChanged(){const t=this.c;for(const e in t)t.hasOwnProperty(e)&&t[e].onPostStateChange()}findByGuid(t){if(this._guid===t)return this;const e=this._app._entityIndex[t];return e&&(e===this||e.isDescendantOf(this))?e:null}destroy(){this._destroying=!0;for(const t in this.c)this.c[t].enabled=!1;for(const t in this.c)this.c[t].system.removeComponent(this);this._parent&&this._parent.removeChild(this);const t=this._children;let e=t.shift();for(;e;)e instanceof uA&&e.destroy(),e._parent=null,e=t.shift();this.fire("destroy",this),this.off(),this._guid&&delete this._app._entityIndex[this._guid],this._destroying=!1}clone(){const t={},e=this._cloneRecursively(t);return t[this.getGuid()]=e,function t(e,i,n,s){if(i instanceof uA){const r=i.c;for(const t in r){const i=r[t],o=i.system.getPropertiesOfType("entity");for(let r=0,a=o.length;r<a;r++){const a=o[r].name,l=i[a];if(!!e.findByGuid(l)){const e=s[l].getGuid();e?n.c[t][a]=e:console.warn("Could not find corresponding entity id when resolving duplicated entity references")}}}r.script&&!n._app.useLegacyScriptAttributeCloning&&n.script.resolveDuplicatedEntityReferenceProperties(r.script,s),r.render&&n.render.resolveDuplicatedEntityReferenceProperties(r.render,s),r.anim&&n.anim.resolveDuplicatedEntityReferenceProperties(r.anim,s);const o=i.children.filter((function(t){return t instanceof uA})),a=n.children.filter((function(t){return t instanceof uA}));for(let i=0,n=o.length;i<n;i++)t(e,o[i],a[i],s)}}(this,this,e,t),e}_cloneRecursively(t){const e=new uA(this._app);super._cloneInternal(e);for(const t in this.c){this.c[t].system.cloneComponent(this,e)}for(let i=0;i<this._children.length;i++){const n=this._children[i];if(n instanceof uA){const i=n._cloneRecursively(t);e.addChild(i),t[n.getGuid()]=i}}return e}}const dA=new ht;class pA extends O_{constructor(t){const e=new uA("AmbientLight");e.addComponent("light",{type:"directional",affectDynamic:!0,affectLightmapped:!1,bake:!0,bakeNumSamples:t.ambientBakeNumSamples,castShadows:!0,normalOffsetBias:.05,shadowBias:.2,shadowDistance:1,shadowResolution:2048,shadowType:_e,color:rt.WHITE,intensity:1}),super(t,e.light.light)}get numVirtualLights(){return this.light.bakeNumSamples}prepareVirtualLight(t,e){D_(dA,t,e,0,this.scene.ambientBakeSpherePart),this.light._node.lookAt(dA.mulScalar(-1)),this.light._node.rotateLocal(90,0,0);const i=this.scene.gammaCorrection?2.2:1,n=2*Math.PI*this.scene.ambientBakeSpherePart,s=Math.pow(n,i);this.light.intensity=Math.pow(s/e,1/i)}}class fA{constructor(t,e=null){this.node=t,this.component=t.render||t.model,e=e||this.component.meshInstances,this.store(),this.meshInstances=e,this.bounds=null,this.renderTargets=[]}store(){this.castShadows=this.component.castShadows}restore(){this.component.castShadows=this.castShadows}}class mA{constructor(t){this.device=t,this.shaderDilate=ia(t,jo.fullscreenQuadVS,jo.dilatePS,"lmDilate"),this.constantTexSource=t.scope.resolve("source"),this.constantPixelOffset=t.scope.resolve("pixelOffset"),this.pixelOffset=new Float32Array(2),this.shaderDenoise=null,this.sigmas=null,this.constantSigmas=null,this.kernel=null}setSourceTexture(t){this.constantTexSource.setValue(t)}prepare(t,e){this.pixelOffset[0]=1/t,this.pixelOffset[1]=1/e,this.constantPixelOffset.setValue(this.pixelOffset)}prepareDenoise(t,e){this.shaderDenoise||(this.shaderDenoise=ia(this.device,jo.fullscreenQuadVS,jo.bilateralDeNoisePS,"lmBilateralDeNoise"),this.sigmas=new Float32Array(2),this.constantSigmas=this.device.scope.resolve("sigmas"),this.constantKernel=this.device.scope.resolve("kernel[0]"),this.bZnorm=this.device.scope.resolve("bZnorm")),this.sigmas[0]=t,this.sigmas[1]=e,this.constantSigmas.setValue(this.sigmas),this.evaluateDenoiseUniforms(t,e)}evaluateDenoiseUniforms(t,e){function i(t,e){return.39894*Math.exp(-.5*t*t/(e*e))/e}this.kernel=this.kernel||new Float32Array(15);const n=this.kernel,s=Math.floor(7);for(let e=0;e<=s;++e){const r=i(e,t);n[s+e]=r,n[s-e]=r}this.constantKernel.setValue(this.kernel);const r=1/i(0,e);this.bZnorm.setValue(r)}}const gA=new ht;class bA{constructor(t,e,i,n,s){this.device=t,this.root=e,this.scene=i,this.renderer=n,this.assets=s,this.shadowMapCache=n._shadowRenderer.shadowMapCache,this._tempSet=new Set,this._initCalled=!1,this.passMaterials=[],this.ambientAOMaterial=null,this.fog="",this.ambientLight=new rt,this.renderTargets=new Map,this.stats={renderPasses:0,lightmapCount:0,totalRenderTime:0,forwardTime:0,fboTime:0,shadowMapTime:0,compileTime:0,shadersLinked:0}}destroy(){Wh.decRef(this.blackTex),this.blackTex=null,Wh.destroy(),this.device=null,this.root=null,this.scene=null,this.renderer=null,this.assets=null}initBake(t){if(!this._initCalled){this._initCalled=!0,this.lightmapFilters=new mA(t),this.constantBakeDir=t.scope.resolve("bakeDir"),this.materials=[],this.blackTex=new _a(this.device,{width:4,height:4,format:ys,type:Vr}),this.blackTex.name="lightmapBlack",Wh.incRef(this.blackTex);const e=new ma;e.clearColor.set(0,0,0,0),e.clearColorBuffer=!0,e.clearDepthBuffer=!1,e.clearStencilBuffer=!1,e.frustumCulling=!1,e.projection=Le,e.aspectRatio=1,e.node=new La,this.camera=e}}finishBake(t){function e(t){Wh.decRef(t.colorBuffer),t.destroy()}this.materials=[],this.renderTargets.forEach(t=>{e(t)}),this.renderTargets.clear(),t.forEach(t=>{t.renderTargets.forEach(t=>{e(t)}),t.renderTargets.length=0}),this.ambientAOMaterial=null}createMaterialForPass(t,e,i,n){const s=new wl;if(s.name=`lmMaterial-pass:${i}-ambient:${n}`,s.chunks.transformVS="#define UV1LAYOUT\n"+jo.transformVS,0===i){let t=jo.bakeLmEndPS;n?t=`\n\t\t\t\t\t\t\t\t\t\tdDiffuseLight = ((dDiffuseLight - 0.5) * max(${e.ambientBakeOcclusionContrast.toFixed(1)} + 1.0, 0.0)) + 0.5;\n\t\t\t\t\t\t\t\t\t\tdDiffuseLight += vec3(${e.ambientBakeOcclusionBrightness.toFixed(1)});\n\t\t\t\t\t\t\t\t\t\tdDiffuseLight = saturate(dDiffuseLight);\n\t\t\t\t\t\t\t\t\t\tdDiffuseLight *= dAmbientLight;\n\t\t\t\t\t\t\t\t`+t:(s.ambient=new rt(0,0,0),s.ambientTint=!0),s.chunks.endPS=t,s.lightMap=this.blackTex}else s.chunks.basePS=jo.basePS+"\nuniform sampler2D texture_dirLightMap;\nuniform float bakeDir;\n",s.chunks.endPS=jo.bakeDirLmEndPS;return s.chunks.outputAlphaPS="\n",s.chunks.outputAlphaOpaquePS="\n",s.chunks.outputAlphaPremulPS="\n",s.cull=Hn,s.forceUv1=!0,s.update(),s.updateShader(t,e),s}createMaterials(t,e,i){for(let n=0;n<i;n++)this.passMaterials[n]||(this.passMaterials[n]=this.createMaterialForPass(t,e,n,!1));this.ambientAOMaterial||(this.ambientAOMaterial=this.createMaterialForPass(t,e,0,!0),this.ambientAOMaterial.onUpdateShader=function(t){return t.lightMapWithoutAmbient=!0,t.separateAmbient=!0,t})}createTexture(t,e,i){const n=new _a(this.device,{width:t,height:t,format:ys,mipmaps:!1,type:e,minFilter:Kn,magFilter:Kn,addressU:pn,addressV:pn});return n.name=i,n}collectModels(t,e,i){var n,s,r;if(!t.enabled)return;let o;if(null!=(n=t.model)&&n.model&&null!=(s=t.model)&&s.enabled&&(i&&i.push(new fA(t)),t.model.lightmapped&&e&&(o=t.model.model.meshInstances)),null!=(r=t.render)&&r.enabled&&(i&&i.push(new fA(t)),t.render.lightmapped&&e&&(o=t.render.meshInstances)),o){let i=!0;for(let t=0;t<o.length;t++)if(!o[t].mesh.vertexBuffer.format.hasUv1){i=!1;break}if(i){const i=[];for(let n=0;n<o.length;n++){const s=o[n].mesh;this._tempSet.has(s)?e.push(new fA(t,[o[n]])):i.push(o[n]),this._tempSet.add(s)}this._tempSet.clear(),i.length>0&&e.push(new fA(t,i))}}for(let n=0;n<t._children.length;n++)this.collectModels(t._children[n],e,i)}prepareShadowCasters(t){const e=[];for(let i=0;i<t.length;i++){const n=t[i].component;if(n.castShadows=n.castShadowsLightmap,n.castShadowsLightmap){const n=t[i].meshInstances;for(let t=0;t<n.length;t++)n[t].visibleThisFrame=!0,e.push(n[t])}}return e}updateTransforms(t){for(let e=0;e<t.length;e++){const i=t[e].meshInstances;for(let t=0;t<i.length;t++)i[t].node.getWorldTransform()}}calculateLightmapSize(t){let e;const i=this.scene.lightmapSizeMultiplier||16,n=gA;let s,r;t.model?(r=t.model.lightmapSizeMultiplier,t.model.asset?(e=this.assets.get(t.model.asset).data,e.area&&(s=e.area)):t.model._area&&(e=t.model,e._area&&(s=e._area))):t.render&&(r=t.render.lightmapSizeMultiplier,"asset"!==t.render.type&&t.render._area&&(e=t.render,e._area&&(s=e._area)));const o={x:1,y:1,z:1,uv:1};s&&(o.x=s.x,o.y=s.y,o.z=s.z,o.uv=s.uv);const a=r||1;o.x*=a,o.y*=a,o.z*=a;const l=t.render||t.model,h=this.computeNodeBounds(l.meshInstances);n.copy(h.halfExtents);let c=o.x*n.y*n.z+o.y*n.x*n.z+o.z*n.x*n.y;c/=o.uv,c=Math.sqrt(c);return Math.min(Z.nextPowerOfTwo(c*i),this.scene.lightmapMaxResolution||2048)}setLightmaping(t,e,i,n){for(let s=0;s<t.length;s++){const r=t[s],o=r.meshInstances;for(let t=0;t<o.length;t++){const s=o[t];if(s.setLightmapped(e),e){n&&(s._shaderDefs|=n),s.mask=Ei;for(let t=0;t<i;t++){const e=r.renderTargets[t].colorBuffer;e.minFilter=Zn,e.magFilter=Zn,s.setRealtimeLightmap(Kh.lightmapParamNames[t],e)}}}}}bake(t,e=Ni){const i=this.device,n=H();this.scene._updateSkybox(i),this.stats.renderPasses=0,this.stats.shadowMapTime=0,this.stats.forwardTime=0;const s=i._shaderStats.linked,r=i._renderTargetCreationTime,o=i._shaderStats.compileTime,a=[],l=[];if(t){for(let e=0;e<t.length;e++)this.collectModels(t[e],a,null);this.collectModels(this.root,null,l)}else this.collectModels(this.root,a,l);if(a.length>0){const t=e===Ni?2:1;this.setLightmaping(a,!1,t),this.initBake(i),this.bakeInternal(t,a,l);let n=ci;e===Ni&&(n|=_i),this.scene.ambientBake&&(n|=gi),this.setLightmaping(a,!0,t,n),this.finishBake(a)}const h=H();this.stats.totalRenderTime=h-n,this.stats.shadersLinked=i._shaderStats.linked-s,this.stats.compileTime=i._shaderStats.compileTime-o,this.stats.fboTime=i._renderTargetCreationTime-r,this.stats.lightmapCount=a.length}allocateTextures(t,e){for(let i=0;i<t.length;i++){const n=t[i],s=this.calculateLightmapSize(n.node);for(let t=0;t<e;t++){const e=this.createTexture(s,Ur,"lightmapper_lightmap_"+i);Wh.incRef(e),n.renderTargets[t]=new Gl({colorBuffer:e,depth:!1})}if(!this.renderTargets.has(s)){const t=this.createTexture(s,Ur,"lightmapper_temp_lightmap_"+s);Wh.incRef(t),this.renderTargets.set(s,new Gl({colorBuffer:t,depth:!1}))}}}prepareLightsToBake(t,e,i){if(this.scene.ambientBake){const t=new pA(this.scene);i.push(t)}const n=t._lights;for(let t=0;t<n.length;t++){const s=n[t],r=new B_(this.scene,s);e.push(r),s.enabled&&0!=(s.mask&Mi)&&(s.isStatic=!1,s.mask=4294967295,s.shadowUpdateMode=s.type===ee?wi:xi,i.push(r))}i.sort()}restoreLights(t){for(let e=0;e<t.length;e++)t[e].restore()}setupScene(){this.revertStatic=!1,this.scene._needsStaticPrepare&&(this.scene._needsStaticPrepare=!1,this.revertStatic=!0),this.fog=this.scene.fog,this.ambientLight.copy(this.scene.ambientLight),this.scene.fog=Vt,this.scene.ambientBake||this.scene.ambientLight.set(0,0,0),this.renderer.setSceneConstants()}restoreScene(){this.scene.fog=this.fog,this.scene.ambientLight.copy(this.ambientLight),this.revertStatic&&(this.scene._needsStaticPrepare=!0)}computeNodeBounds(t){const e=new Tt;if(t.length>0){e.copy(t[0].aabb);for(let i=1;i<t.length;i++)e.add(t[i].aabb)}return e}computeNodesBounds(t){for(let e=0;e<t.length;e++){const i=t[e].meshInstances;t[e].bounds=this.computeNodeBounds(i)}}computeBounds(t){const e=new Tt;for(let i=0;i<t.length;i++){e.copy(t[0].aabb);for(let i=1;i<t.length;i++)e.add(t[i].aabb)}return e}backupMaterials(t){for(let e=0;e<t.length;e++)this.materials[e]=t[e].material}restoreMaterials(t){for(let e=0;e<t.length;e++)t[e].material=this.materials[e]}lightCameraPrepare(t,e){const i=e.light;let n;if(i.type===se){n=i.getRenderData(null,0).shadowCamera,n._node.setPosition(i._node.getPosition()),n._node.setRotation(i._node.getRotation()),n._node.rotateLocal(-90,0,0),n.projection=Pe,n.nearClip=i.attenuationEnd/1e3,n.farClip=i.attenuationEnd,n.aspectRatio=1,n.fov=2*i._outerConeAngle,this.renderer.updateCameraFrustum(n)}return n}lightCameraPrepareAndCull(t,e,i,n){const s=t.light;let r=!0;if(s.type===ee){gA.copy(n.center),gA.y+=n.halfExtents.y,this.camera.node.setPosition(gA),this.camera.node.setEulerAngles(-90,0,0),this.camera.nearClip=0,this.camera.farClip=2*n.halfExtents.y;const t=Math.max(n.halfExtents.x,n.halfExtents.z);this.camera.orthoHeight=t}else t.lightBounds.intersects(e.bounds)||(r=!1);if(s.type===se){let t=!1;const n=e.meshInstances;for(let e=0;e<n.length;e++)if(n[e]._isVisible(i)){t=!0;break}t||(r=!1)}return r}setupLightArray(t,e){t[ee].length=0,t[ie].length=0,t[se].length=0,t[e.type][0]=e}renderShadowMap(t,e,i,n){const s=n.light;return!t&&s.castShadows&&(s.shadowMap=this.shadowMapCache.get(this.device,s),s.type===ee?this.renderer._shadowRenderer.cullDirectional(s,e,this.camera):this.renderer._shadowRenderer.cullLocal(s,e),this.renderer.renderShadows(i[s.type],this.camera)),!0}postprocessTextures(t,e,i){const n=this.lightmapFilters.shaderDilate,s=this.scene.lightmapFilterEnabled;s&&this.lightmapFilters.prepareDenoise(this.scene.lightmapFilterRange,this.scene.lightmapFilterSmoothness);for(let r=0;r<e.length;r++){const o=e[r];for(let e=0;e<i;e++){const i=o.renderTargets[e],r=i.colorBuffer,a=this.renderTargets.get(r.width),l=a.colorBuffer;this.lightmapFilters.prepare(r.width,r.height);for(let o=0;o<1;o++){this.lightmapFilters.setSourceTexture(r);zo(t,a,s&&0===e&&0===o?this.lightmapFilters.shaderDenoise:n),this.lightmapFilters.setSourceTexture(l),zo(t,i,n)}}}}bakeInternal(t,e,i){const n=this.scene,s=this.device;this.createMaterials(s,n,t),this.setupScene(),n.layers._update(),this.computeNodesBounds(e),this.allocateTextures(e,t);const r=[],o=[];this.prepareLightsToBake(n.layers,r,o),this.updateTransforms(i);const a=this.prepareShadowCasters(i);this.renderer.updateCpuSkinMatrices(a),this.renderer.gpuUpdate(a);const l=this.computeBounds(a);let h,c,_,u;for(h=0;h<e.length;h++){for(_=e[h].meshInstances,c=0;c<_.length;c++)u=_[c],u.setLightmapped(!1),u.mask=Mi,u.setRealtimeLightmap(Kh.lightmapParamNames[0],u.material.lightMap?u.material.lightMap:this.blackTex),u.setRealtimeLightmap(Kh.lightmapParamNames[1],this.blackTex)}for(c=0;c<o.length;c++)o[c].light.enabled=!1;const d=[[],[],[]];let p,f,m=!1;for(h=0;h<o.length;h++){const i=o[h],r=i instanceof pA;let g=i.numVirtualLights;t>1&&g>1&&(g=1);for(let o=0;o<g;o++){g>1&&i.prepareVirtualLight(o,g),i.startBake();let h=!1;const b=this.lightCameraPrepare(s,i);for(f=0;f<e.length;f++){const s=e[f];_=s.meshInstances;if(this.lightCameraPrepareAndCull(i,s,b,l)){for(this.setupLightArray(d,i.light),h=this.renderShadowMap(h,a,d,i),this.backupMaterials(_),p=0;p<t&&!(p>0&&o>0)&&!(r&&p>0);p++){const t=s.renderTargets[p],e=s.renderTargets[p].colorBuffer.width,a=this.renderTargets.get(e),l=a.colorBuffer;0===p?m=n.updateShaders:m&&(n.updateShaders=!0);let h=this.passMaterials[p];if(r){o+1===g&&0===p&&(h=this.ambientAOMaterial)}for(c=0;c<_.length;c++)_[c].material=h;for(this.renderer.updateShaders(_),this.renderer.setCamera(this.camera,a,!0),1===p&&this.constantBakeDir.setValue(i.light.bakeDir?1:0),this.renderer._forwardTime=0,this.renderer._shadowMapTime=0,this.renderer.renderForward(this.camera,_,_.length,d,Ii),s.renderTargets[p]=a,this.renderTargets.set(e,t),c=0;c<_.length;c++)u=_[c],u.setRealtimeLightmap(Kh.lightmapParamNames[p],l),u._shaderDefs|=ci}this.restoreMaterials(_)}}i.endBake()}}for(this.postprocessTextures(s,e,t),f=0;f<i.length;f++)i[f].restore();this.restoreLights(r),this.restoreScene()}}const yA=new Set,vA={depth:1,flags:Bn};class SA{constructor(t,e,i){t instanceof zl&&(t=Ka()),this.app=t,this.device=t.graphicsDevice,this.pickColor=new Float32Array(4),this.pickColor[3]=1,this.mapping=[],this.cameraEntity=null,this.layer=null,this.layerComp=null,this.initLayerComposition(),this._renderTarget=null;const n=this.device;this.clearDepthCommand=new qh(0,0,(function(){n.clear(vA)})),this.width=0,this.height=0,this.resize(e,i)}getSelection(t,e,i,n){const s=this.device;if("object"==typeof t){const s=t;t=s.x,e=s.y,i=s.width,n=s.height}else e=this.renderTarget.height-(e+(n||1));t=Math.floor(t),e=Math.floor(e),i=Math.floor(Math.max(i||1,1)),n=Math.floor(Math.max(n||1,1));const r=s.renderTarget;s.setRenderTarget(this.renderTarget),s.updateBegin();const o=new Uint8Array(4*i*n);s.readPixels(t,e,i,n,o),s.updateEnd(),s.setRenderTarget(r);const a=this.mapping;for(let t=0;t<i*n;t++){const e=o[4*t+0]<<16|o[4*t+1]<<8|o[4*t+2];16777215!==e&&yA.add(a[e])}const l=[];return yA.forEach(t=>l.push(t)),yA.clear(),l}allocateRenderTarget(){const t=new _a(this.device,{format:ys,width:this.width,height:this.height,mipmaps:!1,minFilter:Kn,magFilter:Kn,addressU:pn,addressV:pn});t.name="pick",this.renderTarget=new Gl({colorBuffer:t,depth:!0})}releaseRenderTarget(){this.cameraEntity.camera.renderTarget=null,this._renderTarget&&(this._renderTarget._colorBuffer.destroy(),this._renderTarget.destroy(),this._renderTarget=null)}initLayerComposition(){const t=this.device,e=this,i=t.scope.resolve("uColor");this.cameraEntity=new uA,this.cameraEntity.addComponent("camera"),this.layer=new w_({name:"Picker",shaderPass:Di,opaqueSortMode:Wi,onDrawCall:function(n,s){e.pickColor[0]=(s>>16&255)/255,e.pickColor[1]=(s>>8&255)/255,e.pickColor[2]=(255&s)/255,i.setValue(e.pickColor),t.setBlending(!1),e.mapping[s]=n}}),this.layer.addCamera(this.cameraEntity.camera),this.layerComp=new Ja("picker"),this.layerComp.pushOpaque(this.layer)}prepare(t,e,i){t instanceof ma&&(t=t.node.camera),i instanceof w_&&(i=[i]),this.layer.clearMeshInstances();const n=this.layer.opaqueMeshInstances,s=e.layers.layerList,r=e.layers.subLayerEnabled,o=e.layers.subLayerList;for(let e=0;e<s.length;e++){const a=s[e];if(!(i&&i.indexOf(a)<0)&&(a.enabled&&r[e])){if(a.cameras.indexOf(t)>=0){a._clearDepthBuffer&&n.push(this.clearDepthCommand);const t=o[e]?a.instances.transparentMeshInstances:a.instances.opaqueMeshInstances;for(let e=0;e<t.length;e++){const i=t[e];i.pick&&n.push(i)}}}}this.renderTarget&&this.width===this.renderTarget.width&&this.height===this.renderTarget.height||(this.releaseRenderTarget(),this.allocateRenderTarget()),this.updateCamera(t),this.mapping.length=0,this.app.renderer.renderComposition(this.layerComp)}updateCamera(t){this.cameraEntity.copy(t.entity),this.cameraEntity.name="PickerCamera";const e=this.cameraEntity.camera;e.copy(t),e.clearColorBuffer=!0,e.clearDepthBuffer=!0,e.clearStencilBuffer=!0,e.clearColor=rt.WHITE,e.renderTarget=this.renderTarget,this.layer.clearCameras(),this.layer.addCamera(e),e.layers=[this.layer.id]}resize(t,e){this.width=Math.floor(t),this.height=Math.floor(e)}}class xA extends x{constructor(t,e={}){super(),this.type="bitmap",this.app=t,this.intensity=0,this.fontWeight=e.fontWeight||"normal",this.fontSize=parseInt(e.fontSize,10),this.glyphSize=this.fontSize,this.fontName=e.fontName||"Arial",this.color=e.color||new rt(1,1,1),this.padding=e.padding||0;const i=e.width>4096?4096:e.width||512,n=e.height>4096?4096:e.height||512,s=document.createElement("canvas");s.height=n,s.width=i;const r=new _a(this.app.graphicsDevice,{format:ys,mipmaps:!0});r.name="font",r.setSource(s),r.minFilter=ts,r.magFilter=Zn,r.addressU=pn,r.addressV=pn,this.textures=[r],this.chars="",this.data={}}createTextures(t){const e=this._normalizeCharsSet(t);if(e.length===this.chars.length){for(let t=0;t<e.length;t++)if(e[t]!==this.chars[t])return void this._renderAtlas(e)}else this._renderAtlas(e)}updateTextures(t){const e=this._normalizeCharsSet(t),i=[];for(let t=0;t<e.length;t++){const n=e[t];this.data.chars[n]||i.push(n)}i.length>0&&this._renderAtlas(this.chars.concat(i))}destroy(){for(let t=0;t<this.textures.length;t++)this.textures[t].destroy();this.chars=null,this.color=null,this.data=null,this.fontName=null,this.fontSize=null,this.glyphSize=null,this.intensity=null,this.textures=null,this.type=null,this.fontWeight=null}_getAndClearContext(t,e){const i=t.width,n=t.height,s=t.getContext("2d",{alpha:!0});return s.clearRect(0,0,i,n),s.fillStyle=e,s.fillRect(0,0,i,n),s}_colorToRgbString(t,e){let i;const n=Math.round(255*t.r),s=Math.round(255*t.g),r=Math.round(255*t.b);return i=e?"rgba("+n+", "+s+", "+r+", "+t.a+")":"rgb("+n+", "+s+", "+r+")",i}renderCharacter(t,e,i,n,s){t.fillStyle=s,t.fillText(e,i,n)}_renderAtlas(t){this.chars=t;let e=1,i=this.textures[e-1].getSource();const n=i.width,s=i.height,r=this._colorToRgbString(this.color,!1),o=this.color.a;this.color.a=1/255;const a=this._colorToRgbString(this.color,!0);this.color.a=o;let l=this._getAndClearContext(i,a);l.font=this.fontWeight+" "+this.fontSize.toString()+"px "+this.fontName,l.textAlign="center",l.textBaseline="alphabetic",this.data=this._createJson(this.chars,this.fontName,n,s);const h=z.getSymbols(this.chars.join("")),c=this.textures.length;let _=0,u=0;const d={};for(let t=0;t<h.length;t++){const e=h[t];d[e]=this._getTextMetrics(e),_=Math.max(_,d[e].height),u=Math.max(u,d[e].descent)}this.glyphSize=Math.max(this.glyphSize,_);const p=this.glyphSize+2*this.padding,f=this.glyphSize+2*this.padding,m=this.glyphSize/2+this.padding,g=f-u-this.padding;let b=0,y=0;for(let t=0;t<h.length;t++){const o=h[t],_=z.getCodePoint(h[t]);let v=this.fontSize;l.font=this.fontWeight+" "+v.toString()+"px "+this.fontName,l.textAlign="center",l.textBaseline="alphabetic";let S=l.measureText(o).width;S>v&&(v=this.fontSize*this.fontSize/S,l.font=this.fontWeight+" "+v.toString()+"px "+this.fontName,S=this.fontSize),this.renderCharacter(l,o,b+m,y+g,r);const x=this.padding+(this.glyphSize-S)/2,w=-this.padding+d[o].descent-u,C=S;if(this._addChar(this.data,o,_,b,y,p,f,x,w,C,e-1,n,s),b+=p,b+p>n&&(b=0,y+=f,y+f>s))if(this.textures[e-1].upload(),e++,y=0,e>c){i=document.createElement("canvas"),i.height=s,i.width=n,l=this._getAndClearContext(i,a);const t=new _a(this.app.graphicsDevice,{format:ys,mipmaps:!0});t.name="font-atlas",t.setSource(i),t.minFilter=ts,t.magFilter=Zn,t.addressU=pn,t.addressV=pn,this.textures.push(t)}else i=this.textures[e-1].getSource(),l=this._getAndClearContext(i,a)}if(this.textures[e-1].upload(),e<c){for(let t=e;t<c;t++)this.textures[t].destroy();this.textures.splice(e)}this.fire("render")}_createJson(t,e,i,n){return{version:3,intensity:this.intensity,info:{face:e,width:i,height:n,maps:[{width:i,height:n}]},chars:{}}}_addChar(t,e,i,n,s,r,o,a,l,h,c,_,u){t.info.maps.length<c+1&&t.info.maps.push({width:_,height:u});const d=this.fontSize/32;t.chars[e]={id:i,letter:e,x:n,y:s,width:r,height:o,xadvance:h/d,xoffset:a/d,yoffset:(l+this.padding)/d,scale:d,range:1,map:c,bounds:[0,0,r/d,o/d]}}_normalizeCharsSet(t){const e=this.app.systems.element.getUnicodeConverter();e&&(t=e(t));const i={},n=z.getSymbols(t);for(let t=0;t<n.length;t++){const e=n[t];i[e]||(i[e]=e)}return Object.keys(i).sort()}_getTextMetrics(t){const e=document.createElement("span");e.id="content-span",e.innerHTML=t;const i=document.createElement("div");i.id="content-block",i.style.display="inline-block",i.style.width="1px",i.style.height="0px";const n=document.createElement("div");n.appendChild(e),n.appendChild(i),n.style.font=this.fontSize+"px "+this.fontName;document.body.appendChild(n);let s=-1,r=-1,o=-1;try{i.style["vertical-align"]="baseline",s=i.offsetTop-e.offsetTop,i.style["vertical-align"]="bottom",o=i.offsetTop-e.offsetTop,r=o-s}finally{document.body.removeChild(n)}return{ascent:s,descent:r,height:o}}}class wA{load(t,e,i){throw new Error("not implemented")}open(t,e,i){throw new Error("not implemented")}patch(t,e){}}class CA{constructor(t){this._app=t,this.maxRetries=0}load(t,e){Hp(t,this.maxRetries,e)}open(t,e){return e.settings}}const TA=new RegExp("^\\s*function(?:\\s|\\s*\\/\\*.*\\*\\/\\s*)+([^\\(\\s\\/]*)\\s*");class AA extends x{constructor(t){super(),this.initScriptType(t)}initScriptType(t){const e=this.constructor;this.app=t.app,this.entity=t.entity,this._enabled="boolean"!=typeof t.enabled||t.enabled,this._enabledOld=this.enabled,this.__destroyed=!1,this.__attributes={},this.__attributesRaw=t.attributes||{},this.__scriptType=e,this.__executionOrder=-1}static __getScriptName(t){if("function"!=typeof t)return;if("name"in Function.prototype)return t.name;if(t===Function||t===Function.prototype.constructor)return"Function";const e=(""+t).match(TA);return e?e[1]:void 0}static get scriptName(){return this.__name}static get attributes(){return this.hasOwnProperty("__attributes")||(this.__attributes=new mx(this)),this.__attributes}__initializeAttributes(t){if(t||this.__attributesRaw){for(const t in this.__scriptType.attributes.index)this.__attributesRaw&&this.__attributesRaw.hasOwnProperty(t)?this[t]=this.__attributesRaw[t]:this.__attributes.hasOwnProperty(t)||(this.__scriptType.attributes.index[t].hasOwnProperty("default")?this[t]=this.__scriptType.attributes.index[t].default:this[t]=null);this.__attributesRaw=null}}static extend(t){for(const e in t)t.hasOwnProperty(e)&&(this.prototype[e]=t[e])}get enabled(){return this._enabled&&!this._destroyed&&this.entity.script.enabled&&this.entity.enabled}set enabled(t){this._enabled=!!t,this.enabled!==this._enabledOld&&(this._enabledOld=this.enabled,this.fire(this.enabled?"enable":"disable"),this.fire("state",this.enabled),!this._initialized&&this.enabled&&(this._initialized=!0,this.__initializeAttributes(!0),this.initialize&&this.entity.script._scriptMethod(this,gx.scriptMethods.initialize)),this._initialized&&!this._postInitialized&&this.enabled&&!this.entity.script._beingEnabled&&(this._postInitialized=!0,this.postInitialize&&this.entity.script._scriptMethod(this,gx.scriptMethods.postInitialize)))}}AA.__name=null;const EA=new Set(["system","entity","create","destroy","swap","move","scripts","_scripts","_scriptsIndex","_scriptsData","enabled","_oldState","onEnable","onDisable","onPostStateChange","_onSetEnabled","_checkState","_onBeforeRemove","_onInitializeAttributes","_onInitialize","_onPostInitialize","_onUpdate","_onPostUpdate","_callbacks","has","get","on","off","fire","once","hasEvent"]);function MA(t,e){if(bf.legacy)return null;if(EA.has(t))throw new Error("script name: '"+t+"' is reserved, please change script name");const i=function(t){x.prototype.initEventHandler.call(this),AA.prototype.initScriptType.call(this,t)};return(i.prototype=Object.create(AA.prototype)).constructor=i,i.extend=AA.extend,i.attributes=new mx(i),IA(i,t,e),i}const RA={};function IA(t,e,i){if(t.legacy)return;if("function"!=typeof t)throw new Error("script class: '"+t+"' must be a constructor function (i.e. class).");if(!(t.prototype instanceof AA))throw new Error("script class: '"+AA.__getScriptName(t)+"' does not extend pc.ScriptType.");if(e=e||t.__name||AA.__getScriptName(t),EA.has(e))throw new Error("script name: '"+e+"' is reserved, please change script name");t.__name=e;(i?i.scripts:hA.getApplication().scripts).add(t),yf._push(t)}mx.reservedNames.forEach((t,e,i)=>{RA[t]=1}),MA.reservedAttributes=RA;class PA{constructor(t,e){e?(this.key=e.keyCode,this.element=e.target,this.event=e):(this.key=null,this.element=null,this.event=null)}}const LA=new PA;function DA(t){return LA.key=t.keyCode,LA.element=t.target,LA.event=t,LA}function kA(t){return"string"==typeof t?t.toUpperCase().charCodeAt(0):t}const OA={9:"Tab",13:"Enter",16:"Shift",17:"Control",18:"Alt",27:"Escape",37:"Left",38:"Up",39:"Right",40:"Down",46:"Delete",91:"Win"};class FA extends x{constructor(t,e={}){super(),this._element=null,this._keyDownHandler=this._handleKeyDown.bind(this),this._keyUpHandler=this._handleKeyUp.bind(this),this._keyPressHandler=this._handleKeyPress.bind(this),this._visibilityChangeHandler=this._handleVisibilityChange.bind(this),this._windowBlurHandler=this._handleWindowBlur.bind(this),this._keymap={},this._lastmap={},t&&this.attach(t),this.preventDefault=e.preventDefault||!1,this.stopPropagation=e.stopPropagation||!1}attach(t){this._element&&this.detach(),this._element=t,this._element.addEventListener("keydown",this._keyDownHandler,!1),this._element.addEventListener("keypress",this._keyPressHandler,!1),this._element.addEventListener("keyup",this._keyUpHandler,!1),document.addEventListener("visibilitychange",this._visibilityChangeHandler,!1),window.addEventListener("blur",this._windowBlurHandler,!1)}detach(){this._element.removeEventListener("keydown",this._keyDownHandler),this._element.removeEventListener("keypress",this._keyPressHandler),this._element.removeEventListener("keyup",this._keyUpHandler),this._element=null,document.removeEventListener("visibilitychange",this._visibilityChangeHandler,!1),window.removeEventListener("blur",this._windowBlurHandler,!1)}toKeyIdentifier(t){var e,i,n;t=kA(t);var s=OA[t.toString()];if(s)return s;for(n=(i=t.toString(16).toUpperCase()).length,e=0;e<4-n;e++)i="0"+i;return"U+"+i}_handleKeyDown(t){var e=t.keyCode||t.charCode;if(void 0!==e){var i=this.toKeyIdentifier(e);this._keymap[i]=!0,this.fire("keydown",DA(t)),this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation()}}_handleKeyUp(t){var e=t.keyCode||t.charCode;if(void 0!==e){var i=this.toKeyIdentifier(e);delete this._keymap[i],this.fire("keyup",DA(t)),this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation()}}_handleKeyPress(t){this.fire("keypress",DA(t)),this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation()}_handleVisibilityChange(){"hidden"===document.visibilityState&&this._handleWindowBlur()}_handleWindowBlur(){this._keymap={},this._lastmap={}}update(){var t;for(t in this._lastmap)delete this._lastmap[t];for(t in this._keymap)this._keymap.hasOwnProperty(t)&&(this._lastmap[t]=this._keymap[t])}isPressed(t){var e=kA(t),i=this.toKeyIdentifier(e);return!!this._keymap[i]}wasPressed(t){var e=kA(t),i=this.toKeyIdentifier(e);return!!this._keymap[i]&&!this._lastmap[i]}wasReleased(t){var e=kA(t),i=this.toKeyIdentifier(e);return!this._keymap[i]&&!!this._lastmap[i]}}function BA(){return!!(document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement)}class NA{constructor(t,e){var i={x:0,y:0};if(e){if(e instanceof NA)throw Error("Expected MouseEvent");i=t._getTargetCoords(e)}else e={};if(i)this.x=i.x,this.y=i.y;else{if(!BA())return;this.x=0,this.y=0}this.wheelDelta=0,"wheel"===e.type&&(e.deltaY>0?this.wheelDelta=1:e.deltaY<0&&(this.wheelDelta=-1)),BA()?(this.dx=e.movementX||e.webkitMovementX||e.mozMovementX||0,this.dy=e.movementY||e.webkitMovementY||e.mozMovementY||0):(this.dx=this.x-t._lastX,this.dy=this.y-t._lastY),"mousedown"===e.type||"mouseup"===e.type?this.button=e.button:this.button=QC,this.buttons=t._buttons.slice(0),this.element=e.target,this.ctrlKey=e.ctrlKey||!1,this.altKey=e.altKey||!1,this.shiftKey=e.shiftKey||!1,this.metaKey=e.metaKey||!1,this.event=e}}class UA extends x{constructor(t){super(),this._lastX=0,this._lastY=0,this._buttons=[!1,!1,!1],this._lastbuttons=[!1,!1,!1],this._upHandler=this._handleUp.bind(this),this._downHandler=this._handleDown.bind(this),this._moveHandler=this._handleMove.bind(this),this._wheelHandler=this._handleWheel.bind(this),this._contextMenuHandler=function(t){t.preventDefault()},this._target=null,this._attached=!1,this.attach(t)}static isPointerLocked(){return BA()}attach(t){if(this._target=t,!this._attached){this._attached=!0;var e=!!B.passiveEvents&&{passive:!1};window.addEventListener("mouseup",this._upHandler,e),window.addEventListener("mousedown",this._downHandler,e),window.addEventListener("mousemove",this._moveHandler,e),window.addEventListener("wheel",this._wheelHandler,e)}}detach(){if(this._attached){this._attached=!1,this._target=null;var t=!!B.passiveEvents&&{passive:!1};window.removeEventListener("mouseup",this._upHandler,t),window.removeEventListener("mousedown",this._downHandler,t),window.removeEventListener("mousemove",this._moveHandler,t),window.removeEventListener("wheel",this._wheelHandler,t)}}disableContextMenu(){this._target&&this._target.addEventListener("contextmenu",this._contextMenuHandler)}enableContextMenu(){this._target&&this._target.removeEventListener("contextmenu",this._contextMenuHandler)}enablePointerLock(t,e){if(document.body.requestPointerLock){t&&document.addEventListener("pointerlockchange",(function e(){t(),document.removeEventListener("pointerlockchange",e)}),!1),e&&document.addEventListener("pointerlockerror",(function t(){e(),document.removeEventListener("pointerlockerror",t)}),!1),document.body.requestPointerLock()}else e&&e()}disablePointerLock(t){if(document.exitPointerLock){t&&document.addEventListener("pointerlockchange",(function e(){t(),document.removeEventListener("pointerlockchange",e)}),!1),document.exitPointerLock()}}update(){this._lastbuttons[0]=this._buttons[0],this._lastbuttons[1]=this._buttons[1],this._lastbuttons[2]=this._buttons[2]}isPressed(t){return this._buttons[t]}wasPressed(t){return this._buttons[t]&&!this._lastbuttons[t]}wasReleased(t){return!this._buttons[t]&&this._lastbuttons[t]}_handleUp(t){this._buttons[t.button]=!1;var e=new NA(this,t);e.event&&this.fire(Jx,e)}_handleDown(t){this._buttons[t.button]=!0;var e=new NA(this,t);e.event&&this.fire(Qx,e)}_handleMove(t){var e=new NA(this,t);e.event&&(this.fire($x,e),this._lastX=e.x,this._lastY=e.y)}_handleWheel(t){var e=new NA(this,t);e.event&&this.fire(tw,e)}_getTargetCoords(t){var e=this._target.getBoundingClientRect(),i=Math.floor(e.left),n=Math.floor(e.top);return t.clientX<i||t.clientX>=i+this._target.clientWidth||t.clientY<n||t.clientY>=n+this._target.clientHeight?null:{x:t.clientX-i,y:t.clientY-n}}}class VA{constructor(t,e={}){this._keyboard=e.keyboard||null,this._mouse=e.mouse||null,this._gamepads=e.gamepads||null,this._element=null,this._actions={},this._axes={},this._axesValues={},t&&this.attach(t)}attach(t){this._element=t,this._keyboard&&this._keyboard.attach(t),this._mouse&&this._mouse.attach(t)}detach(){this._keyboard&&this._keyboard.detach(),this._mouse&&this._mouse.detach(),this._element=null}disableContextMenu(){this._mouse||this._enableMouse(),this._mouse.disableContextMenu()}enableContextMenu(){this._mouse||this._enableMouse(),this._mouse.enableContextMenu()}update(t){for(var e in this._keyboard&&this._keyboard.update(t),this._mouse&&this._mouse.update(t),this._gamepads&&this._gamepads.update(t),this._axesValues={},this._axes)this._axesValues[e]=[]}registerKeys(t,e){if(this._keyboard||this._enableKeyboard(),this._actions[t])throw new Error("Action: "+t+" already registered");if(void 0===e)throw new Error("Invalid button");e.length||(e=[e]),this._actions[t]?this._actions[t].push({type:Vx,keys:e}):this._actions[t]=[{type:Vx,keys:e}]}registerMouse(t,e){if(this._mouse||this._enableMouse(),void 0===e)throw new Error("Invalid button");this._actions[t]?this._actions[t].push({type:Ux,button:e}):this._actions[t]=[{type:Ux,button:-e}]}registerPadButton(t,e,i){if(void 0===i)throw new Error("Invalid button");this._actions[t]?this._actions[t].push({type:zx,button:i,pad:e}):this._actions[t]=[{type:zx,button:i,pad:e}]}registerAxis(t){var e=t.name;this._axes[e]||(this._axes[e]=[]);var i=this._axes[e].push(e);(t=t||{}).pad=t.pad||eT;var n=function(n,s,r,o){switch(s){case"mousex":n._mouse.on($x,(function(t){n._axesValues[e][i]=t.dx/10}));break;case"mousey":n._mouse.on($x,(function(t){n._axesValues[e][i]=t.dy/10}));break;case"key":n._axes[e].push((function(){return n._keyboard.isPressed(o)?r:0}));break;case"padrx":n._axes[e].push((function(){return n._gamepads.getAxis(t.pad,CT)}));break;case"padry":n._axes[e].push((function(){return n._gamepads.getAxis(t.pad,TT)}));break;case"padlx":n._axes[e].push((function(){return n._gamepads.getAxis(t.pad,xT)}));break;case"padly":n._axes[e].push((function(){return n._gamepads.getAxis(t.pad,wT)}));break;default:throw new Error("Unknown axis")}};n(this,t.positive,1,t.positiveKey),(t.negativeKey||t.negative!==t.positive)&&n(this,t.negative,-1,t.negativeKey)}isPressed(t){if(!this._actions[t])return!1;var e,i=0,n=this._actions[t].length;for(i=0;i<n;++i)switch((e=this._actions[t][i]).type){case Vx:if(this._keyboard){var s,r=e.keys.length;for(s=0;s<r;s++)if(this._keyboard.isPressed(e.keys[s]))return!0}break;case Ux:if(this._mouse&&this._mouse.isPressed(e.button))return!0;break;case zx:if(this._gamepads&&this._gamepads.isPressed(e.pad,e.button))return!0}return!1}wasPressed(t){if(!this._actions[t])return!1;var e=0,i=this._actions[t].length;for(e=0;e<i;++e){var n=this._actions[t][e];switch(n.type){case Vx:if(this._keyboard){var s,r=n.keys.length;for(s=0;s<r;s++)if(this._keyboard.wasPressed(n.keys[s]))return!0}break;case Ux:if(this._mouse&&this._mouse.wasPressed(n.button))return!0;break;case zx:if(this._gamepads&&this._gamepads.wasPressed(n.pad,n.button))return!0}}return!1}getAxis(t){var e=0;if(this._axes[t]){var i,n=this._axes[t].length;for(i=0;i<n;i++)if("function"===p(this._axes[t][i])){var s=this._axes[t][i]();Math.abs(s)>Math.abs(e)&&(e=s)}else this._axesValues[t]&&Math.abs(this._axesValues[t][i])>Math.abs(e)&&(e=this._axesValues[t][i])}return e}_enableMouse(){if(this._mouse=new UA,!this._element)throw new Error("Controller must be attached to an Element");this._mouse.attach(this._element)}_enableKeyboard(){if(this._keyboard=new FA,!this._element)throw new Error("Controller must be attached to an Element");this._keyboard.attach(this._element)}}var zA,WA,GA=new ht,jA=new ht,HA=new rn,XA=new rn,YA=new rn;HA.end=new ht,XA.end=new ht,YA.end=new ht;var qA=new ht,KA=new ht,ZA=new ht,QA=new ht,$A=new ht,JA=new ht,tE=new ht,eE=new ht,iE=new ht,nE=new ht,sE=new ht,rE=new ht,oE=new ht,aE=new ht,lE=new ht,hE=new ht,cE=new ht,_E=new ht,uE=new ht,dE=new ht,pE=new ut;function fE(t,e,i){return sE.cross(t,e).dot(i)}class mE{constructor(t,e,i){this.event=t,this.element=e,this.camera=i,this._stopPropagation=!1}stopPropagation(){this._stopPropagation=!0,this.event&&(this.event.stopImmediatePropagation(),this.event.stopPropagation())}}class gE extends mE{constructor(t,e,i,n,s,r,o){super(t,e,i),this.x=n,this.y=s,this.ctrlKey=t.ctrlKey||!1,this.altKey=t.altKey||!1,this.shiftKey=t.shiftKey||!1,this.metaKey=t.metaKey||!1,this.button=t.button,UA.isPointerLocked()?(this.dx=t.movementX||t.webkitMovementX||t.mozMovementX||0,this.dy=t.movementY||t.webkitMovementY||t.mozMovementY||0):(this.dx=n-r,this.dy=s-o),this.wheelDelta=0,"wheel"===t.type&&(t.deltaY>0?this.wheelDelta=1:t.deltaY<0&&(this.wheelDelta=-1))}}class bE extends mE{constructor(t,e,i,n,s,r){super(t,e,i),this.touches=t.touches,this.changedTouches=t.changedTouches,this.x=n,this.y=s,this.touch=r}}class yE extends mE{constructor(t,e,i,n){super(t,e,i),this.inputSource=n}}class vE{constructor(t,e){this._app=null,this._attached=!1,this._target=null,this._enabled=!0,this._lastX=0,this._lastY=0,this._upHandler=this._handleUp.bind(this),this._downHandler=this._handleDown.bind(this),this._moveHandler=this._handleMove.bind(this),this._wheelHandler=this._handleWheel.bind(this),this._touchstartHandler=this._handleTouchStart.bind(this),this._touchendHandler=this._handleTouchEnd.bind(this),this._touchcancelHandler=this._touchendHandler,this._touchmoveHandler=this._handleTouchMove.bind(this),this._sortHandler=this._sortElements.bind(this),this._elements=[],this._hoveredElement=null,this._pressedElement=null,this._touchedElements={},this._touchesForWhichTouchLeaveHasFired={},this._selectedElements={},this._selectedPressedElements={},this._useMouse=!e||!1!==e.useMouse,this._useTouch=!e||!1!==e.useTouch,this._useXr=!e||!1!==e.useXr,this._selectEventsAttached=!1,B.touch&&(this._clickedEntities={}),this.attach(t)}attach(t){this._attached&&(this._attached=!1,this.detach()),this._target=t,this._attached=!0;var e=!!B.passiveEvents&&{passive:!0};this._useMouse&&(window.addEventListener("mouseup",this._upHandler,e),window.addEventListener("mousedown",this._downHandler,e),window.addEventListener("mousemove",this._moveHandler,e),window.addEventListener("wheel",this._wheelHandler,e)),this._useTouch&&B.touch&&(this._target.addEventListener("touchstart",this._touchstartHandler,e),this._target.addEventListener("touchend",this._touchendHandler,!1),this._target.addEventListener("touchmove",this._touchmoveHandler,!1),this._target.addEventListener("touchcancel",this._touchcancelHandler,!1)),this.attachSelectEvents()}attachSelectEvents(){!this._selectEventsAttached&&this._useXr&&this.app&&this.app.xr&&this.app.xr.supported&&(this._clickedEntities||(this._clickedEntities={}),this._selectEventsAttached=!0,this.app.xr.on("start",this._onXrStart,this))}detach(){if(this._attached){this._attached=!1;var t=!!B.passiveEvents&&{passive:!0};this._useMouse&&(window.removeEventListener("mouseup",this._upHandler,t),window.removeEventListener("mousedown",this._downHandler,t),window.removeEventListener("mousemove",this._moveHandler,t),window.removeEventListener("wheel",this._wheelHandler,t)),this._useTouch&&(this._target.removeEventListener("touchstart",this._touchstartHandler,t),this._target.removeEventListener("touchend",this._touchendHandler,!1),this._target.removeEventListener("touchmove",this._touchmoveHandler,!1),this._target.removeEventListener("touchcancel",this._touchcancelHandler,!1)),this._selectEventsAttached&&(this._selectEventsAttached=!1,this.app.xr.off("start",this._onXrStart,this),this.app.xr.off("end",this._onXrEnd,this),this.app.xr.off("update",this._onXrUpdate,this),this.app.xr.input.off("selectstart",this._onSelectStart,this),this.app.xr.input.off("selectend",this._onSelectEnd,this),this.app.xr.input.off("remove",this._onXrInputRemove,this)),this._target=null}}addElement(t){-1===this._elements.indexOf(t)&&this._elements.push(t)}removeElement(t){var e=this._elements.indexOf(t);-1!==e&&this._elements.splice(e,1)}_handleUp(t){this._enabled&&(UA.isPointerLocked()||(this._calcMouseCoords(t),null!==zA&&this._onElementMouseEvent("mouseup",t)))}_handleDown(t){this._enabled&&(UA.isPointerLocked()||(this._calcMouseCoords(t),null!==zA&&this._onElementMouseEvent("mousedown",t)))}_handleMove(t){this._enabled&&(this._calcMouseCoords(t),null!==zA&&(this._onElementMouseEvent("mousemove",t),this._lastX=zA,this._lastY=WA))}_handleWheel(t){this._enabled&&(this._calcMouseCoords(t),null!==zA&&this._onElementMouseEvent("mousewheel",t))}_determineTouchedElements(t){var e,i,n,s={},r=this.app.systems.camera.cameras;for(e=r.length-1;e>=0;e--){var o=r[e],a=0;for(i=0,n=t.changedTouches.length;i<n;i++)if(s[t.changedTouches[i].identifier])a++;else{var l=this._calcTouchCoords(t.changedTouches[i]),h=this._getTargetElement(o,l.x,l.y);h&&(a++,s[t.changedTouches[i].identifier]={element:h,camera:o,x:l.x,y:l.y})}if(a===n)break}return s}_handleTouchStart(t){if(this._enabled){for(var e=this._determineTouchedElements(t),i=0,n=t.changedTouches.length;i<n;i++){var s=t.changedTouches[i],r=e[s.identifier],o=this._touchedElements[s.identifier];!r||o&&r.element===o.element||(this._fireEvent(t.type,new bE(t,r.element,r.camera,r.x,r.y,s)),this._touchesForWhichTouchLeaveHasFired[s.identifier]=!1)}for(var a in e)this._touchedElements[a]=e[a]}}_handleTouchEnd(t){if(this._enabled){var e=this.app.systems.camera.cameras;for(var i in this._clickedEntities)delete this._clickedEntities[i];for(var n=0,s=t.changedTouches.length;n<s;n++){var r=t.changedTouches[n],o=this._touchedElements[r.identifier];if(o){var a=o.element,l=o.camera,h=o.x,c=o.y;if(delete this._touchedElements[r.identifier],delete this._touchesForWhichTouchLeaveHasFired[r.identifier],this._fireEvent(t.type,new bE(t,a,l,h,c,r)),0===t.touches.length)for(var _=this._calcTouchCoords(r),u=e.length-1;u>=0;u--){this._getTargetElement(e[u],_.x,_.y)===a&&(this._clickedEntities[a.entity.getGuid()]||(this._fireEvent("click",new bE(t,a,l,h,c,r)),this._clickedEntities[a.entity.getGuid()]=!0))}}}}}_handleTouchMove(t){if(t.preventDefault(),this._enabled)for(var e=this._determineTouchedElements(t),i=0,n=t.changedTouches.length;i<n;i++){var s=t.changedTouches[i],r=e[s.identifier],o=this._touchedElements[s.identifier];if(o){var a=this._calcTouchCoords(s);r&&r.element===o.element||this._touchesForWhichTouchLeaveHasFired[s.identifier]||(this._fireEvent("touchleave",new bE(t,o.element,o.camera,a.x,a.y,s)),this._touchesForWhichTouchLeaveHasFired[s.identifier]=!0),this._fireEvent("touchmove",new bE(t,o.element,o.camera,a.x,a.y,s))}}}_onElementMouseEvent(t,e){var i,n=this._hoveredElement;this._hoveredElement=null;for(var s,r=this.app.systems.camera.cameras,o=r.length-1;o>=0&&(s=r[o],!(i=this._getTargetElement(s,zA,WA)));o--);i&&(this._fireEvent(t,new gE(e,i,s,zA,WA,this._lastX,this._lastY)),this._hoveredElement=i,"mousedown"===t&&(this._pressedElement=i)),n!==this._hoveredElement&&(n&&this._fireEvent("mouseleave",new gE(e,n,s,zA,WA,this._lastX,this._lastY)),this._hoveredElement&&this._fireEvent("mouseenter",new gE(e,this._hoveredElement,s,zA,WA,this._lastX,this._lastY))),"mouseup"===t&&this._pressedElement&&(this._pressedElement===this._hoveredElement?(this._pressedElement=null,this._clickedEntities&&this._clickedEntities[this._hoveredElement.entity.getGuid()]||this._fireEvent("click",new gE(e,this._hoveredElement,s,zA,WA,this._lastX,this._lastY))):this._pressedElement=null)}_onXrStart(){this.app.xr.on("end",this._onXrEnd,this),this.app.xr.on("update",this._onXrUpdate,this),this.app.xr.input.on("selectstart",this._onSelectStart,this),this.app.xr.input.on("selectend",this._onSelectEnd,this),this.app.xr.input.on("remove",this._onXrInputRemove,this)}_onXrEnd(){this.app.xr.off("update",this._onXrUpdate,this),this.app.xr.input.off("selectstart",this._onSelectStart,this),this.app.xr.input.off("selectend",this._onSelectEnd,this),this.app.xr.input.off("remove",this._onXrInputRemove,this)}_onXrUpdate(){if(this._enabled)for(var t=this.app.xr.input.inputSources,e=0;e<t.length;e++)this._onElementSelectEvent("selectmove",t[e],null)}_onXrInputRemove(t){var e=this._selectedElements[t.id];e&&(t._elementEntity=null,this._fireEvent("selectleave",new yE(null,e,null,t))),delete this._selectedElements[t.id],delete this._selectedPressedElements[t.id]}_onSelectStart(t,e){this._enabled&&this._onElementSelectEvent("selectstart",t,e)}_onSelectEnd(t,e){this._enabled&&this._onElementSelectEvent("selectend",t,e)}_onElementSelectEvent(t,e,i){var n,s,r,o=this._selectedElements[e.id],a=this.app.systems.camera.cameras;if(e.elementInput){YA.set(e.getOrigin(),e.getDirection());for(var l=a.length-1;l>=0&&(r=a[l],!(n=this._getTargetElementByRay(YA,r)));l--);}e._elementEntity=n||null,n?(this._selectedElements[e.id]=n,s=n):delete this._selectedElements[e.id],o!==s&&(o&&this._fireEvent("selectleave",new yE(i,o,r,e)),s&&this._fireEvent("selectenter",new yE(i,s,r,e))),"selectstart"===t&&(this._selectedPressedElements[e.id]=s,s&&this._fireEvent("selectstart",new yE(i,s,r,e)));var h=this._selectedPressedElements[e.id];!e.elementInput&&h&&(delete this._selectedPressedElements[e.id],o&&this._fireEvent("selectend",new yE(i,o,r,e))),"selectend"===t&&e.elementInput&&(delete this._selectedPressedElements[e.id],o&&this._fireEvent("selectend",new yE(i,o,r,e)),h&&h===o&&this._fireEvent("click",new yE(i,h,r,e)))}_fireEvent(t,e){for(var i=e.element;i.fire(t,e),!e._stopPropagation&&i.entity.parent&&(i=i.entity.parent.element););}_calcMouseCoords(t){var e=this._target.getBoundingClientRect(),i=Math.floor(e.left),n=Math.floor(e.top);t.clientX<i||t.clientX>=i+this._target.clientWidth||t.clientY<n||t.clientY>=n+this._target.clientHeight?(zA=null,WA=null):(zA=t.clientX-i,WA=t.clientY-n)}_calcTouchCoords(t){for(var e=0,i=0,n=t.target;!(n instanceof HTMLElement);)n=n.parentNode;var s=n;do{e+=s.offsetLeft-s.scrollLeft,i+=s.offsetTop-s.scrollTop,s=s.offsetParent}while(s);return{x:t.pageX-e,y:t.pageY-i}}_sortElements(t,e){var i=this.app.scene.layers.sortTransparentLayers(t.layers,e.layers);return 0!==i?i:t.screen&&!e.screen?-1:!t.screen&&e.screen?1:t.screen||e.screen?t.screen.screen.screenSpace&&!e.screen.screen.screenSpace?-1:e.screen.screen.screenSpace&&!t.screen.screen.screenSpace?1:e.drawOrder-t.drawOrder:0}_getTargetElement(t,e,i){var n=null;let s=1/0;var r,o;this._elements.sort(this._sortHandler);for(var a=0,l=this._elements.length;a<l;a++){var h=this._elements[a];if(h.screen&&h.screen.screen.screenSpace){if(void 0===r&&(r=this._calculateRayScreen(e,i,t,HA)?HA:null),!r)continue;if(this._checkElement(r,h,!0)>=0){n=h;break}}else{if(void 0===o&&(o=this._calculateRay3d(e,i,t,XA)?XA:null),!o)continue;const r=this._checkElement(o,h,!1);if(r>=0&&(r<s&&(n=h,s=r),h.screen)){n=h;break}}}return n}_getTargetElementByRay(t,e){var i=null;HA.origin.copy(t.origin),HA.direction.copy(t.direction),HA.end.copy(HA.direction).mulScalar(2*e.farClip).add(HA.origin),this._elements.sort(this._sortHandler);for(var n=0,s=this._elements.length;n<s;n++){var r=this._elements[n];if((!r.screen||!r.screen.screen.screenSpace)&&this._checkElement(HA,r,!1)>=0){i=r;break}}return i}_buildHitCorners(t,e,i,n,s){var r=e;if(t.entity&&t.entity.button){var o=t.entity.button.hitPadding||pE;oE.copy(t.entity.up),aE.copy(oE).mulScalar(-1),hE.copy(t.entity.right),lE.copy(hE).mulScalar(-1),oE.mulScalar(o.w*n),aE.mulScalar(o.y*n),hE.mulScalar(o.z*i),lE.mulScalar(o.x*i),cE.copy(r[0]).add(aE).add(lE),_E.copy(r[1]).add(aE).add(hE),uE.copy(r[2]).add(oE).add(hE),dE.copy(r[3]).add(oE).add(lE),r=[cE,_E,uE,dE]}if(i<0){const t=r[2].x,e=r[0].x;r[0].x=t,r[1].x=e,r[2].x=e,r[3].x=t}if(n<0){const t=r[2].y,e=r[0].y;r[0].y=t,r[1].y=t,r[2].y=e,r[3].y=e}if(s<0){const t=r[2].x,e=r[2].y,i=r[2].z;r[2].x=r[0].x,r[2].y=r[0].y,r[2].z=r[0].z,r[0].x=t,r[0].y=e,r[0].z=i}return r}_calculateScaleToScreen(t){var e=t.entity,i=t.screen.screen.scale;for(rE.set(i,i,i);e&&!e.screen;)rE.mul(e.getLocalScale()),e=e.parent;return rE}_calculateScaleToWorld(t){var e=t.entity;for(rE.set(1,1,1);e;)rE.mul(e.getLocalScale()),e=e.parent;return rE}_calculateRayScreen(t,e,i,n){var s=this.app.graphicsDevice.width,r=this.app.graphicsDevice.height,o=i.rect.z*s,a=i.rect.w*r,l=i.rect.x*s,h=l+o,c=(1-i.rect.y)*r,_=c-a,u=t*s/this._target.clientWidth,d=e*r/this._target.clientHeight;return u>=l&&u<=h&&d<=c&&d>=_&&(u=s*(u-l)/o,d=r-(d=r*(d-_)/a),n.origin.set(u,d,1),n.direction.set(0,0,-1),n.end.copy(n.direction).mulScalar(2).add(n.origin),!0)}_calculateRay3d(t,e,i,n){var s=this._target.clientWidth,r=this._target.clientHeight,o=i.rect.z*s,a=i.rect.w*r,l=i.rect.x*s,h=l+o,c=(1-i.rect.y)*r,_=c-a,u=t,d=e;return t>=l&&t<=h&&e<=c&&d>=_&&(u=s*(u-l)/o,d=r*(d-_)/a,i.screenToWorld(u,d,i.nearClip,GA),i.screenToWorld(u,d,i.farClip,jA),n.origin.copy(GA),n.direction.set(0,0,-1),n.end.copy(jA),!0)}_checkElement(t,e,i){if(e.maskedBy&&this._checkElement(t,e.maskedBy.element,i)<0)return-1;var n;n=i?this._calculateScaleToScreen(e):this._calculateScaleToWorld(e);var s=this._buildHitCorners(e,i?e.screenCorners:e.worldCorners,n.x,n.y,n.z);return function(t,e,i){qA.sub2(e,t),KA.sub2(i[0],t),ZA.sub2(i[1],t),QA.sub2(i[2],t),JA.cross(QA,qA);let n,s,r=KA.dot(JA);if(r>=0){if(n=-ZA.dot(JA),n<0)return-1;if(s=fE(qA,ZA,KA),s<0)return-1;const t=1/(n+r+s);tE.copy(i[0]).mulScalar(n*t),eE.copy(i[1]).mulScalar(r*t),iE.copy(i[2]).mulScalar(s*t),nE.copy(tE).add(eE).add(iE)}else{if($A.sub2(i[3],t),n=$A.dot(JA),n<0)return-1;if(s=fE(qA,KA,$A),s<0)return-1;r=-r;const e=1/(n+r+s);tE.copy(i[0]).mulScalar(n*e),eE.copy(i[3]).mulScalar(r*e),iE.copy(i[2]).mulScalar(s*e),nE.copy(tE).add(eE).add(iE)}return qA.sub2(i[0],i[2]).lengthSq()<1e-8||qA.sub2(i[1],i[3]).lengthSq()<1e-8?-1:nE.sub(t).lengthSq()}(t.origin,t.end,s)}get enabled(){return this._enabled}set enabled(t){this._enabled=t}get app(){return this._app||Ka()}set app(t){this._app=t}}const SE={DEFAULT:{buttons:["PAD_FACE_1","PAD_FACE_2","PAD_FACE_3","PAD_FACE_4","PAD_L_SHOULDER_1","PAD_R_SHOULDER_1","PAD_L_SHOULDER_2","PAD_R_SHOULDER_2","PAD_SELECT","PAD_START","PAD_L_STICK_BUTTON","PAD_R_STICK_BUTTON","PAD_UP","PAD_DOWN","PAD_LEFT","PAD_RIGHT","PAD_VENDOR"],axes:["PAD_L_STICK_X","PAD_L_STICK_Y","PAD_R_STICK_X","PAD_R_STICK_Y"]},PS3:{buttons:["PAD_FACE_1","PAD_FACE_2","PAD_FACE_4","PAD_FACE_3","PAD_L_SHOULDER_1","PAD_R_SHOULDER_1","PAD_L_SHOULDER_2","PAD_R_SHOULDER_2","PAD_SELECT","PAD_START","PAD_L_STICK_BUTTON","PAD_R_STICK_BUTTON","PAD_UP","PAD_DOWN","PAD_LEFT","PAD_RIGHT","PAD_VENDOR"],axes:["PAD_L_STICK_X","PAD_L_STICK_Y","PAD_R_STICK_X","PAD_R_STICK_Y"]}},xE={"Product: 0268":"PS3"};class wE{constructor(){this.gamepadsSupported=!!navigator.getGamepads||!!navigator.webkitGetGamepads,this.current=[],this.previous=[],this.deadZone=.25}update(){var t,e,i,n,s;for(t=0,i=this.current.length;t<i;t++)for(s=(n=this.current[t].pad.buttons).length,e=0;e<s;e++)void 0===this.previous[t]&&(this.previous[t]=[]),this.previous[t][e]=n[e].pressed;this.poll(this.current)}poll(t=[]){if(t.length>0&&(t.length=0),this.gamepadsSupported){var e,i=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads(),n=i.length;for(e=0;e<n;e++)i[e]&&t.push({map:this.getMap(i[e]),pad:i[e]})}return t}getMap(t){for(var e in xE)if(t.id.indexOf(e)>=0)return SE[xE[e]];return SE.DEFAULT}isPressed(t,e){if(!this.current[t])return!1;var i=this.current[t].map.buttons[e];return this.current[t].pad.buttons[pc[i]].pressed}wasPressed(t,e){if(!this.current[t])return!1;var i=this.current[t].map.buttons[e],n=pc[i];return this.current[t].pad.buttons[n].pressed&&!(this.previous[t]&&this.previous[t][n])}wasReleased(t,e){if(!this.current[t])return!1;var i=this.current[t].map.buttons[e],n=pc[i];return!this.current[t].pad.buttons[n].pressed&&this.previous[t]&&this.previous[t][n]}getAxis(t,e){if(!this.current[t])return 0;var i=this.current[t].map.axes[e],n=this.current[t].pad.axes[pc[i]];return Math.abs(n)<this.deadZone&&(n=0),n}}function CE(t){for(var e=0,i=0,n=t.target;!(n instanceof HTMLElement);)n=n.parentNode;var s=n;do{e+=s.offsetLeft-s.scrollLeft,i+=s.offsetTop-s.scrollTop,s=s.offsetParent}while(s);return{x:t.pageX-e,y:t.pageY-i}}class TE{constructor(t){var e=CE(t);this.id=t.identifier,this.x=e.x,this.y=e.y,this.target=t.target,this.touch=t}}class AE{constructor(t,e){if(this.element=e.target,this.event=e,this.touches=[],this.changedTouches=[],e){var i,n=e.touches.length;for(i=0;i<n;i++)this.touches.push(new TE(e.touches[i]));for(n=e.changedTouches.length,i=0;i<n;i++)this.changedTouches.push(new TE(e.changedTouches[i]))}}getTouchById(t,e){var i,n=e.length;for(i=0;i<n;i++)if(e[i].id===t)return e[i];return null}}class EE extends x{constructor(t){super(),this._element=null,this._startHandler=this._handleTouchStart.bind(this),this._endHandler=this._handleTouchEnd.bind(this),this._moveHandler=this._handleTouchMove.bind(this),this._cancelHandler=this._handleTouchCancel.bind(this),this.attach(t)}attach(t){this._element&&this.detach(),this._element=t,this._element.addEventListener("touchstart",this._startHandler,!1),this._element.addEventListener("touchend",this._endHandler,!1),this._element.addEventListener("touchmove",this._moveHandler,!1),this._element.addEventListener("touchcancel",this._cancelHandler,!1)}detach(){this._element&&(this._element.removeEventListener("touchstart",this._startHandler,!1),this._element.removeEventListener("touchend",this._endHandler,!1),this._element.removeEventListener("touchmove",this._moveHandler,!1),this._element.removeEventListener("touchcancel",this._cancelHandler,!1)),this._element=null}_handleTouchStart(t){this.fire("touchstart",new AE(this,t))}_handleTouchEnd(t){this.fire("touchend",new AE(this,t))}_handleTouchMove(t){t.preventDefault(),this.fire("touchmove",new AE(this,t))}_handleTouchCancel(t){this.fire("touchcancel",new AE(this,t))}}const ME={write:function(t){console.log(t)},open:function(){ME.write("Powered by PlayCanvas "+l+" "+h)},info:function(t){console.info("INFO:\t\t"+t)},debug:function(t){console.debug("DEBUG:\t "+t)},error:function(t){console.error("ERROR:\t "+t)},warning:function(t){console.warn("WARNING: "+t)},alert:function(t){ME.write("ALERT:\t "+t),alert(t)},assert:function(t,e){!1===t&&ME.write("ASSERT:\t"+e)}};z.endsWith=function(t,e){return t.endsWith(e)},z.startsWith=function(t,e){return t.startsWith(e)};const RE={now:H,Timer:X};function IE(t,e){const i=function(){},n=function(i,n,s,r,o,a,l,h){e.call(this,i,n,s,r,o,a,l,h),t.call(this,i,n,s,r,o,a,l,h)};return n._super=e.prototype,i.prototype=e.prototype,n.prototype=new i,n}function PE(t){return Array.prototype.slice.call(t)}Object.defineProperty(rt.prototype,"data",{get:function(){return this._data||(this._data=new Float32Array(4)),this._data[0]=this.r,this._data[1]=this.g,this._data[2]=this.b,this._data[3]=this.a,this._data}}),Object.defineProperty(rt.prototype,"data3",{get:function(){return this._data3||(this._data3=new Float32Array(3)),this._data3[0]=this.r,this._data3[1]=this.g,this._data3[2]=this.b,this._data3}}),Z.INV_LOG2=Math.LOG2E,Z.intToBytes=Z.intToBytes32,Z.bytesToInt=Z.bytesToInt32,Object.defineProperty(_t.prototype,"data",{get:function(){return this._data||(this._data=new Float32Array(2)),this._data[0]=this.x,this._data[1]=this.y,this._data}}),_t.prototype.scale=_t.prototype.mulScalar,Object.defineProperty(ht.prototype,"data",{get:function(){return this._data||(this._data=new Float32Array(3)),this._data[0]=this.x,this._data[1]=this.y,this._data[2]=this.z,this._data}}),ht.prototype.scale=ht.prototype.mulScalar,Object.defineProperty(ut.prototype,"data",{get:function(){return this._data||(this._data=new Float32Array(4)),this._data[0]=this.x,this._data[1]=this.y,this._data[2]=this.z,this._data[3]=this.w,this._data}}),ut.prototype.scale=ut.prototype.mulScalar;const LE={Aabb:Tt,Sphere:Mt,Plane:un};Mt.prototype.intersectRay=Mt.prototype.intersectsRay,sn.prototype.update=function(t,e){const i=new bt;i.mul2(t,e),this.setFromMat4(i)};const DE=Qr,kE=$r,OE=Jr,FE=to,BE=eo,NE=io,UE=no;function VE(t){this.name="UnsupportedBrowserError",this.message=t||""}function zE(t){this.name="ContextCreationError",this.message=t||""}VE.prototype=Error.prototype,zE.prototype=Error.prototype;const WE={ADDRESS_CLAMP_TO_EDGE:pn,ADDRESS_MIRRORED_REPEAT:fn,ADDRESS_REPEAT:dn,BLENDMODE_ZERO:mn,BLENDMODE_ONE:gn,BLENDMODE_SRC_COLOR:bn,BLENDMODE_ONE_MINUS_SRC_COLOR:yn,BLENDMODE_DST_COLOR:vn,BLENDMODE_ONE_MINUS_DST_COLOR:Sn,BLENDMODE_SRC_ALPHA:xn,BLENDMODE_SRC_ALPHA_SATURATE:wn,BLENDMODE_ONE_MINUS_SRC_ALPHA:Cn,BLENDMODE_DST_ALPHA:Tn,BLENDMODE_ONE_MINUS_DST_ALPHA:An,BUFFER_STATIC:Ln,BUFFER_DYNAMIC:Dn,BUFFER_STREAM:kn,CULLFACE_NONE:Hn,CULLFACE_BACK:Xn,CULLFACE_FRONT:Yn,CULLFACE_FRONTANDBACK:qn,ELEMENTTYPE_INT8:Qr,ELEMENTTYPE_UINT8:$r,ELEMENTTYPE_INT16:Jr,ELEMENTTYPE_UINT16:to,ELEMENTTYPE_INT32:eo,ELEMENTTYPE_UINT32:io,ELEMENTTYPE_FLOAT32:no,FILTER_NEAREST:Kn,FILTER_LINEAR:Zn,FILTER_NEAREST_MIPMAP_NEAREST:Qn,FILTER_NEAREST_MIPMAP_LINEAR:$n,FILTER_LINEAR_MIPMAP_NEAREST:Jn,FILTER_LINEAR_MIPMAP_LINEAR:ts,INDEXFORMAT_UINT8:hs,INDEXFORMAT_UINT16:cs,INDEXFORMAT_UINT32:_s,PIXELFORMAT_R5_G6_B5:fs,PIXELFORMAT_R8_G8_B8:bs,PIXELFORMAT_R8_G8_B8_A8:ys,PRIMITIVE_POINTS:Gs,PRIMITIVE_LINES:js,PRIMITIVE_LINELOOP:Hs,PRIMITIVE_LINESTRIP:Xs,PRIMITIVE_TRIANGLES:Ys,PRIMITIVE_TRISTRIP:qs,PRIMITIVE_TRIFAN:Ks,SEMANTIC_POSITION:Zs,SEMANTIC_NORMAL:Qs,SEMANTIC_COLOR:er,SEMANTIC_TEXCOORD:ir,SEMANTIC_TEXCOORD0:nr,SEMANTIC_TEXCOORD1:sr,SEMANTIC_ATTR0:ur,SEMANTIC_ATTR1:dr,SEMANTIC_ATTR2:pr,SEMANTIC_ATTR3:fr,TEXTURELOCK_READ:Br,TEXTURELOCK_WRITE:Nr,drawQuadWithShader:zo,programlib:cl,shaderChunks:jo,ContextCreationError:zE,Device:zl,IndexBuffer:$l,ProgramLibrary:Ll,RenderTarget:Gl,ScopeId:Fl,Shader:Go,ShaderInput:Nl,Texture:_a,UnsupportedBrowserError:VE,VertexBuffer:Fo,VertexFormat:No,VertexIterator:uh},GE={createFullscreenQuad:fh,drawFullscreenQuad:mh,PostEffect:ph,PostEffectQueue:qb};Object.defineProperty(jo,"transformSkinnedVS",{get:function(){return"#define SKIN\n"+jo.transformVS}}),Object.defineProperties(_a.prototype,{rgbm:{get:function(){return this.type===Vr},set:function(t){this.type=t?Vr:Ur}},swizzleGGGR:{get:function(){return this.type===Wr},set:function(t){this.type=t?Wr:Ur}}});const jE=wl,HE={partitionSkin:rf,procedural:{calculateTangents:Th,createMesh:Ah,createTorus:Eh,createCylinder:Rh,createCapsule:Ih,createCone:Ph,createSphere:Lh,createPlane:Dh,createBox:kh},BasicMaterial:Fh,Command:qh,DepthMaterial:oc,ForwardRenderer:d_,GraphNode:La,Material:pl,Mesh:xh,MeshInstance:Kh,Model:Uu,ParticleEmitter:Fu,PhongMaterial:wl,Picker:SA,Projection:{ORTHOGRAPHIC:Le,PERSPECTIVE:Pe},Scene:Vu,Skin:Ju,SkinInstance:Vh};Object.defineProperty(Bh.prototype,"model",{get:function(){return null}}),Bu.prototype.getTarget=function(t){return this.targets[t]},La.prototype._dirtify=function(t){t?this._dirtifyLocal():this._dirtifyWorld()},La.prototype.addLabel=function(t){this._labels[t]=!0},La.prototype.getLabels=function(){return Object.keys(this._labels)},La.prototype.hasLabel=function(t){return!!this._labels[t]},La.prototype.removeLabel=function(t){delete this._labels[t]},La.prototype.findByLabel=function(t,e=[]){this.hasLabel(t)&&e.push(this);for(let i=0;i<this._children.length;++i)e=this._children[i].findByLabel(t,e);return e},La.prototype.getChildren=function(){return this.children},La.prototype.getName=function(){return this.name},La.prototype.getPath=function(){return this.path},La.prototype.getRoot=function(){return this.root},La.prototype.getParent=function(){return this.parent},La.prototype.setName=function(t){this.name=t},pl.prototype.getName=function(){return this.name},pl.prototype.setName=function(t){this.name=t},pl.prototype.getShader=function(){return this.shader},pl.prototype.setShader=function(t){this.shader=t};const XE={Animation:Qu,Key:Ku,Node:Zu,Skeleton:Jg};Qu.prototype.getDuration=function(){return this.duration},Qu.prototype.getName=function(){return this.name},Qu.prototype.getNodes=function(){return this.nodes},Qu.prototype.setDuration=function(t){this.duration=t},Qu.prototype.setName=function(t){this.name=t},Jg.prototype.getAnimation=function(){return this.animation},Jg.prototype.getCurrentTime=function(){return this.currentTime},Jg.prototype.getLooping=function(){return this.looping},Jg.prototype.getNumNodes=function(){return this.numNodes},Jg.prototype.setAnimation=function(t){this.animation=t},Jg.prototype.setCurrentTime=function(t){this.currentTime=t},Jg.prototype.setLooping=function(t){this.looping=t};const YE={AudioManager:qu,Channel:Wu,Channel3d:Xu,Listener:Yu,Sound:mp};qu.prototype.getListener=function(){return this.listener},qu.prototype.getVolume=function(){return this.volume},qu.prototype.setVolume=function(t){this.volume=t};const qE={ASSET_ANIMATION:"animation",ASSET_AUDIO:"audio",ASSET_IMAGE:"image",ASSET_JSON:"json",ASSET_MODEL:"model",ASSET_MATERIAL:"material",ASSET_TEXT:"text",ASSET_TEXTURE:"texture",ASSET_CUBEMAP:"cubemap",ASSET_SCRIPT:"script"};lm.prototype.getAssetById=function(t){return this.get(t)},Object.defineProperty(ig.prototype,"ray",{get:function(){return this._rayLocal}}),Object.defineProperty(ig.prototype,"position",{get:function(){return this._localPosition}}),Object.defineProperty(ig.prototype,"rotation",{get:function(){return this._localRotation}});const KE={getTouchTargetCoords:CE,Controller:VA,GamePads:wE,Keyboard:FA,KeyboardEvent:PA,Mouse:UA,MouseEvent:NA,Touch:TE,TouchDevice:EE,TouchEvent:AE};Object.defineProperty(vE.prototype,"wheel",{get:function(){return-2*this.wheelDelta}}),Object.defineProperty(NA.prototype,"wheel",{get:function(){return-2*this.wheelDelta}});const ZE=iy,QE=ny,$E=sy,JE=ry,tM=oy,eM=ay,iM=ly,nM=hy,sM=cy,rM=_y,oM=uy,aM={Application:hA,Component:gg,ComponentSystem:bg,Entity:uA,FillMode:{NONE:dm,FILL_WINDOW:pm,KEEP_ASPECT:fm},ResolutionMode:{AUTO:mm,FIXED:gm}};function lM(t,e,i){Gf({glueUrl:t,wasmUrl:e,fallbackUrl:i,lazyInit:!0})}hA.prototype.isFullscreen=function(){return!!document.fullscreenElement},hA.prototype.enableFullscreen=function(t,e,i){t=t||this.graphicsDevice.canvas;const n=function t(){e(),document.removeEventListener("fullscreenchange",t)},s=function t(){i(),document.removeEventListener("fullscreenerror",t)};e&&document.addEventListener("fullscreenchange",n,!1),i&&document.addEventListener("fullscreenerror",s,!1),t.requestFullscreen?t.requestFullscreen(Element.ALLOW_KEYBOARD_INPUT):i()},hA.prototype.disableFullscreen=function(t){const e=function e(){t(),document.removeEventListener("fullscreenchange",e)};t&&document.addEventListener("fullscreenchange",e,!1),document.exitFullscreen()},hA.prototype.getSceneUrl=function(t){const e=this.scenes.find(t);return e?e.url:null},hA.prototype.loadScene=function(t,e){this.scenes.loadScene(t,e)},hA.prototype.loadSceneHierarchy=function(t,e){this.scenes.loadSceneHierarchy(t,e)},hA.prototype.loadSceneSettings=function(t,e){this.scenes.loadSceneSettings(t,e)},hA.prototype.renderMeshInstance=function(t,e){const i=null!=e&&e.layer?e.layer:this._getDefaultDrawLayer();this._immediate.drawMesh(null,null,null,t,i)},hA.prototype.renderMesh=function(t,e,i,n){const s=null!=n&&n.layer?n.layer:this._getDefaultDrawLayer();this._immediate.drawMesh(e,i,t,null,s)},hA.prototype._addLines=function(t,e,i){const n=i&&i.layer?i.layer:this.scene.layers.getLayerById(Jt),s=!i||void 0===i.depthTest||i.depthTest;this._immediate.getBatch(n,s).addLines(t,e)},hA.prototype.renderLine=function(t,e,i){let n,s=i;const r=arguments[3],o=arguments[4];r instanceof rt?(s=r,n="number"==typeof o?o===yi?{layer:this.scene.layers.getLayerById(Jt),depthTest:!1}:{layer:this.scene.layers.getLayerById(Jt),depthTest:!0}:o):"number"==typeof r?(s=i,n=r===yi?{layer:this.scene.layers.getLayerById(Jt),depthTest:!1}:{layer:this.scene.layers.getLayerById(Jt),depthTest:!0}):r&&(n=r),this._addLines([t,e],[i,s],n)},hA.prototype.renderLines=function(t,e,i){i?"number"==typeof i&&(i=i===yi?{layer:this.scene.layers.getLayerById(Jt),depthTest:!1}:{layer:this.scene.layers.getLayerById(Jt),depthTest:!0}):i={layer:this.scene.layers.getLayerById(Jt),depthTest:!0};!e.length||t.length===e.length?t.length%2==0?this._addLines(t,e,i):console.error("renderLines: array length is not divisible by 2"):console.error("renderLines: position/color arrays have different lengths")},Object.defineProperty(Zb.prototype,"node",{get:function(){return this.entity}}),Object.defineProperty(yS.prototype,"enable",{get:function(){return this.enabled},set:function(t){this.enabled=t}}),CS.prototype.setVisible=function(t){this.enabled=t},Object.defineProperty(CS.prototype,"aabb",{get:function(){return null},set:function(t){}}),Object.defineProperty(MS.prototype,"aabb",{get:function(){return null},set:function(t){}}),Object.defineProperty(ZS.prototype,"bodyType",{get:function(){return this.type},set:function(t){this.type=t}}),ZS.prototype.syncBodyToEntity=function(){this._updateDynamic()},rx.prototype.setGravity=function(){1===arguments.length?this.gravity.copy(arguments[0]):this.gravity.set(arguments[0],arguments[1],arguments[2])};class hM extends x{constructor(t,e){if(super(),this._assets=[],this._registry=e,this._loaded=!1,this._count=0,this._total=0,this._failed=[],this._waitingAssets=[],t.length&&t[0]instanceof Od)this._assets=t;else for(var i=0;i<t.length;i++){var n=e.get(t[i]);n?this._assets.push(n):(this._waitForAsset(t[i]),this._total++)}}destroy(){var t=this;this._registry.off("load",this._onLoad),this._registry.off("error",this._onError),this._waitingAssets.forEach((function(e){t._registry.off("add:"+e,this._onAddAsset)})),this.off("progress"),this.off("load")}load(t,e){var i,n=0,s=this._assets.length;for(this._count=0,this._failed=[],this._callback=t,this._scope=e,this._registry.on("load",this._onLoad,this),this._registry.on("error",this._onError,this),n=0;n<s;n++)(i=this._assets[n]).loading||i.loaded||(this._registry.load(i),this._total++)}ready(t,e){e=e||this,this._loaded?t.call(e,this._assets):this.once("load",(function(i){t.call(e,i)}))}_loadingComplete(){this._loaded=!0,this._registry.off("load",this._onLoad,this),this._registry.off("error",this._onError,this),this._failed&&this._failed.length?(this._callback&&this._callback.call(this._scope,"Failed to load some assets",this._failed),this.fire("error",this._failed)):(this._callback&&this._callback.call(this._scope),this.fire("load",this._assets))}_onLoad(t){var e=this;this._assets.indexOf(t)>=0&&(this._count++,this.fire("progress",t)),this._count===this._total&&setTimeout((function(){e._loadingComplete(e._failed)}),0)}_onError(t,e){var i=this;this._assets.indexOf(e)>=0&&(this._count++,this._failed.push(e)),this._count===this._total&&setTimeout((function(){i._loadingComplete(i._failed)}),0)}_onAddAsset(t){var e,i=this._waitingAssets.indexOf(t);i>=0&&this._waitingAssets.splice(i,1),this._assets.push(t);var n=this._assets.length;for(e=0;e<n;e++)(t=this._assets[e]).loading||t.loaded||this._registry.load(t)}_waitForAsset(t){this._waitingAssets.push(t),this._registry.once("add:"+t,this._onAddAsset,this)}}},function(t,e){t.exports={Linkable:class{constructor(t){this._=t,this._references=[],this._refCount=0,this._pendingDelete=!1,this._binding=0}_link(t){return this._references.push(t),t._refCount+=1,!0}_unlink(t){let e=this._references.indexOf(t);if(e<0)return!1;for(;e>=0;)this._references[e]=this._references[this._references.length-1],this._references.pop(),t._refCount-=1,t._checkDelete(),e=this._references.indexOf(t);return!0}_linked(t){return this._references.indexOf(t)>=0}_checkDelete(){if(this._refCount<=0&&this._pendingDelete&&0!==this._){for(;this._references.length>0;)this._unlink(this._references[0]);this._performDelete(),this._=0}}_performDelete(){}}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n=i(5),s=i(1),r=i(3);class o extends s.Emitter{constructor(t){super(),this.writable=!1,Object(r.a)(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e){const i=new Error(t);return i.type="TransportError",i.description=e,super.emit("error",i),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emit("open")}onData(t){const e=Object(n.a)(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emit("packet",t)}onClose(){this.readyState="closed",super.emit("close")}}},function(t,e){e.encode=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e},e.decode=function(t){for(var e={},i=t.split("&"),n=0,s=i.length;n<s;n++){var r=i[n].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e}},function(t,e){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,s=t.indexOf("["),r=t.indexOf("]");-1!=s&&-1!=r&&(t=t.substring(0,s)+t.substring(s,r).replace(/:/g,";")+t.substring(r,t.length));for(var o,a,l=i.exec(t||""),h={},c=14;c--;)h[n[c]]=l[c]||"";return-1!=s&&-1!=r&&(h.source=e,h.host=h.host.substring(1,h.host.length-1).replace(/;/g,":"),h.authority=h.authority.replace("[","").replace("]","").replace(/;/g,":"),h.ipv6uri=!0),h.pathNames=function(t,e){var i=e.replace(/\/{2,9}/g,"/").split("/");"/"!=e.substr(0,1)&&0!==e.length||i.splice(0,1);"/"==e.substr(e.length-1,1)&&i.splice(i.length-1,1);return i}(0,h.path),h.queryKey=(o=h.query,a={},o.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,i){e&&(a[e]=i)})),a),h}},,function(t,e){var i,n,s=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===r||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:r}catch(t){i=r}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var l,h=[],c=!1,_=-1;function u(){c&&l&&(c=!1,l.length?h=l.concat(h):_=-1,h.length&&d())}function d(){if(!c){var t=a(u);c=!0;for(var e=h.length;e;){for(l=h,h=[];++_<e;)l&&l[_].run();_=-1,e=h.length}l=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function f(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];h.push(new p(t,e)),1!==h.length||c||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=f,s.addListener=f,s.once=f,s.off=f,s.removeListener=f,s.removeAllListeners=f,s.emit=f,s.prependListener=f,s.prependOnceListener=f,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e,i){"use strict";var n,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),r={},o=0,a=0;function l(t){var e="";do{e=s[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function h(){var t=l(+new Date);return t!==n?(o=0,n=t):t+"."+l(o++)}for(;a<64;a++)r[s[a]]=a;h.encode=l,h.decode=function(t){var e=0;for(a=0;a<t.length;a++)e=64*e+r[t.charAt(a)];return e},t.exports=h},function(t,e,i){(function(t){function i(t,e){for(var i=0,n=t.length-1;n>=0;n--){var s=t[n];"."===s?t.splice(n,1):".."===s?(t.splice(n,1),i++):i&&(t.splice(n,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}function n(t,e){if(t.filter)return t.filter(e);for(var i=[],n=0;n<t.length;n++)e(t[n],n,t)&&i.push(t[n]);return i}e.resolve=function(){for(var e="",s=!1,r=arguments.length-1;r>=-1&&!s;r--){var o=r>=0?arguments[r]:t.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(e=o+"/"+e,s="/"===o.charAt(0))}return(s?"/":"")+(e=i(n(e.split("/"),(function(t){return!!t})),!s).join("/"))||"."},e.normalize=function(t){var r=e.isAbsolute(t),o="/"===s(t,-1);return(t=i(n(t.split("/"),(function(t){return!!t})),!r).join("/"))||r||(t="."),t&&o&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(n(t,(function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,i){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}t=e.resolve(t).substr(1),i=e.resolve(i).substr(1);for(var s=n(t.split("/")),r=n(i.split("/")),o=Math.min(s.length,r.length),a=o,l=0;l<o;l++)if(s[l]!==r[l]){a=l;break}var h=[];for(l=a;l<s.length;l++)h.push("..");return(h=h.concat(r.slice(a))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),i=47===e,n=-1,s=!0,r=t.length-1;r>=1;--r)if(47===(e=t.charCodeAt(r))){if(!s){n=r;break}}else s=!1;return-1===n?i?"/":".":i&&1===n?"/":t.slice(0,n)},e.basename=function(t,e){var i=function(t){"string"!=typeof t&&(t+="");var e,i=0,n=-1,s=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!s){i=e+1;break}}else-1===n&&(s=!1,n=e+1);return-1===n?"":t.slice(i,n)}(t);return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},e.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,i=0,n=-1,s=!0,r=0,o=t.length-1;o>=0;--o){var a=t.charCodeAt(o);if(47!==a)-1===n&&(s=!1,n=o+1),46===a?-1===e?e=o:1!==r&&(r=1):-1!==e&&(r=-1);else if(!s){i=o+1;break}}return-1===e||-1===n||0===r||1===r&&e===n-1&&e===i+1?"":t.slice(e,n)};var s="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return e<0&&(e=t.length+e),t.substr(e,i)}}).call(this,i(12))},function(t,e,i){const n=i(51);e.parseFont=n,e.createCanvas=function(t,e){return Object.assign(document.createElement("canvas"),{width:t,height:e})},e.createImageData=function(t,e,i){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(t);case 2:return new ImageData(t,e);default:return new ImageData(t,e,i)}},e.loadImage=function(t,e){return new Promise((function(i,n){const s=Object.assign(document.createElement("img"),e);function r(){s.onload=null,s.onerror=null}s.onload=function(){r(),i(s)},s.onerror=function(){r(),n(new Error('Failed to load the image "'+t+'"'))},s.src=t}))}},function(t,e,i){const n=i(24),s=i(52),r=i(57).version,{gl:o,NativeWebGLRenderingContext:a,NativeWebGL:l}=i(0),{getANGLEInstancedArrays:h}=i(60),{getOESElementIndexUint:c}=i(64),{getOESStandardDerivatives:_}=i(65),{getOESTextureFloat:u}=i(66),{getOESTextureFloatLinear:d}=i(67),{getSTACKGLDestroyContext:p}=i(68),{getSTACKGLResizeDrawingBuffer:f}=i(69),{getWebGLDrawBuffers:m}=i(70),{getEXTBlendMinMax:g}=i(71),{getEXTTextureFilterAnisotropic:b}=i(72),{getOESVertexArrayObject:y}=i(73),{bindPublics:v,checkObject:S,checkUniform:x,formatSize:w,isValidString:C,typeSize:T,uniformTypeSize:A,extractImageData:E,vertexCount:M,isTypedArray:R,unpackTypedArray:I,convertPixels:P,checkFormat:L,validCubeTarget:D}=i(17),{WebGLActiveInfo:k}=i(74),{WebGLFramebuffer:O}=i(75),{WebGLBuffer:F}=i(31),{WebGLDrawingBufferWrapper:B}=i(76),{WebGLProgram:N}=i(77),{WebGLRenderbuffer:U}=i(78),{WebGLShader:V}=i(79),{WebGLShaderPrecisionFormat:z}=i(80),{WebGLTexture:W}=i(81),{WebGLUniformLocation:G}=i(29),j=[o.COLOR_ATTACHMENT0,o.DEPTH_ATTACHMENT,o.STENCIL_ATTACHMENT,o.DEPTH_STENCIL_ATTACHMENT],H=[o.COLOR_ATTACHMENT0],X={angle_instanced_arrays:h,oes_element_index_uint:c,oes_texture_float:u,oes_texture_float_linear:d,oes_standard_derivatives:_,oes_vertex_array_object:y,stackgl_destroy_context:p,stackgl_resize_drawingbuffer:f,webgl_draw_buffers:m,ext_blend_minmax:g,ext_texture_filter_anisotropic:b},Y=["resize","destroy"];class q extends a{_checkDimensions(t,e,i,n){if(n<0||e<0||i<0)return this.setError(o.INVALID_VALUE),!1;if(t===o.TEXTURE_2D){if(e>this._maxTextureSize||i>this._maxTextureSize||n>this._maxTextureLevel)return this.setError(o.INVALID_VALUE),!1}else{if(!this._validCubeTarget(t))return this.setError(o.INVALID_ENUM),!1;if(e>this._maxCubeMapSize||i>this._maxCubeMapSize||n>this._maxCubeMapLevel)return this.setError(o.INVALID_VALUE),!1}return!0}_checkLocation(t){return t instanceof G?t._program._ctx===this&&t._linkCount===t._program._linkCount||(this.setError(o.INVALID_OPERATION),!1):(this.setError(o.INVALID_VALUE),!1)}_checkLocationActive(t){return!!t&&(!!this._checkLocation(t)&&(t._program===this._activeProgram||(this.setError(o.INVALID_OPERATION),!1)))}_checkOwns(t){return"object"==typeof t&&t._ctx===this}_checkShaderSource(t){const e=t._source,i=s(e);let n=!1;const r=[];for(let t=0;t<i.length;++t){const e=i[t];switch(e.type){case"ident":this._validGLSLIdentifier(e.data)||(n=!0,r.push(e.line+":"+e.column+" invalid identifier - "+e.data));break;case"preprocessor":{const t=s(e.data.match(/^\s*#\s*(.*)$/)[1]);for(let i=0;i<t.length;++i){const s=t[i];"ident"!==s.type&&void 0!==s.type||this._validGLSLIdentifier(s.data)||(n=!0,r.push(e.line+":"+s.column+" invalid identifier - "+s.data))}break}case"keyword":switch(e.data){case"do":n=!0,r.push(e.line+":"+e.column+" do not supported")}break;case"builtin":switch(e.data){case"dFdx":case"dFdy":case"fwidth":this._extensions.oes_standard_derivatives||(n=!0,r.push(e.line+":"+e.column+" "+e.data+" not supported"))}}}return n&&(t._compileInfo=r.join("\n")),!n}_checkStencilState(){return this._checkStencil?(this._checkStencil=!1,this._stencilState=!0,this.getParameter(o.STENCIL_WRITEMASK)===this.getParameter(o.STENCIL_BACK_WRITEMASK)&&this.getParameter(o.STENCIL_VALUE_MASK)===this.getParameter(o.STENCIL_BACK_VALUE_MASK)&&this.getParameter(o.STENCIL_REF)===this.getParameter(o.STENCIL_BACK_REF)||(this.setError(o.INVALID_OPERATION),this._stencilState=!1),this._stencilState):this._stencilState}_checkTextureTarget(t){const e=this._getActiveTextureUnit();let i=null;if(t===o.TEXTURE_2D)i=e._bind2D;else{if(t!==o.TEXTURE_CUBE_MAP)return this.setError(o.INVALID_ENUM),!1;i=e._bindCube}return!!i||(this.setError(o.INVALID_OPERATION),!1)}_checkWrapper(t,e){return this._checkValid(t,e)?!!this._checkOwns(t)||(this.setError(o.INVALID_OPERATION),!1):(this.setError(o.INVALID_VALUE),!1)}_checkValid(t,e){return t instanceof e&&0!==t._}_checkVertexAttribState(t){const e=this._activeProgram;if(!e)return this.setError(o.INVALID_OPERATION),!1;const i=this._vertexObjectState._attribs;for(let n=0;n<i.length;++n){const s=i[n];if(s._isPointer){const i=s._pointerBuffer;if(!i)return this.setError(o.INVALID_OPERATION),!1;if(e._attributes.indexOf(n)>=0){let e=0;if(e=s._divisor?s._pointerSize+s._pointerOffset:s._pointerStride*t+s._pointerSize+s._pointerOffset,e>i._size)return this.setError(o.INVALID_OPERATION),!1}}}return!0}_checkVertexIndex(t){return!(t<0||t>=this._vertexObjectState._attribs.length)||(this.setError(o.INVALID_VALUE),!1)}_computePixelSize(t,e){const i=w(e);if(0===i)return this.setError(o.INVALID_ENUM),0;switch(t){case o.UNSIGNED_BYTE:return i;case o.UNSIGNED_SHORT_5_6_5:if(e!==o.RGB){this.setError(o.INVALID_OPERATION);break}return 2;case o.UNSIGNED_SHORT_4_4_4_4:case o.UNSIGNED_SHORT_5_5_5_1:if(e!==o.RGBA){this.setError(o.INVALID_OPERATION);break}return 2;case o.FLOAT:return 1}return this.setError(o.INVALID_ENUM),0}_computeRowStride(t,e){let i=t*e;return i%this._unpackAlignment&&(i+=this._unpackAlignment-i%this._unpackAlignment),i}_fixupLink(t){if(!super.getProgramParameter(t._,o.LINK_STATUS))return t._linkInfoLog=super.getProgramInfoLog(t),!1;const e=this.getProgramParameter(t,o.ACTIVE_ATTRIBUTES),i=new Array(e);t._attributes.length=e;for(let n=0;n<e;++n)i[n]=this.getActiveAttrib(t,n).name,t._attributes[n]=0|this.getAttribLocation(t,i[n]);for(let e=0;e<i.length;++e)if(i[e].length>256)return t._linkInfoLog="attribute "+i[e]+" is too long",!1;for(let n=0;n<e;++n)super.bindAttribLocation(0|t._,t._attributes[n],i[n]);super.linkProgram(0|t._);const n=this.getProgramParameter(t,o.ACTIVE_UNIFORMS);t._uniforms.length=n;for(let e=0;e<n;++e)t._uniforms[e]=this.getActiveUniform(t,e);for(let e=0;e<t._uniforms.length;++e)if(t._uniforms[e].name.length>256)return t._linkInfoLog="uniform "+t._uniforms[e].name+" is too long",!1;return t._linkInfoLog="",!0}_framebufferOk(){const t=this._activeFramebuffer;return!t||this._preCheckFramebufferStatus(t)===o.FRAMEBUFFER_COMPLETE||(this.setError(o.INVALID_FRAMEBUFFER_OPERATION),!1)}_getActiveBuffer(t){return t===o.ARRAY_BUFFER?this._vertexGlobalState._arrayBufferBinding:t===o.ELEMENT_ARRAY_BUFFER?this._vertexObjectState._elementArrayBufferBinding:null}_getActiveTextureUnit(){return this._textureUnits[this._activeTextureUnit]}_getActiveTexture(t){const e=this._getActiveTextureUnit();return t===o.TEXTURE_2D?e._bind2D:t===o.TEXTURE_CUBE_MAP?e._bindCube:null}_getAttachments(){return this._extensions.webgl_draw_buffers?this._extensions.webgl_draw_buffers._ALL_ATTACHMENTS:j}_getColorAttachments(){return this._extensions.webgl_draw_buffers?this._extensions.webgl_draw_buffers._ALL_COLOR_ATTACHMENTS:H}_getParameterDirect(t){return super.getParameter(t)}_getTexImage(t){const e=this._getActiveTextureUnit();return t===o.TEXTURE_2D?e._bind2D:D(t)?e._bindCube:(this.setError(o.INVALID_ENUM),null)}_preCheckFramebufferStatus(t){const e=t._attachments,i=[],n=[],s=e[o.DEPTH_ATTACHMENT],r=e[o.DEPTH_STENCIL_ATTACHMENT],a=e[o.STENCIL_ATTACHMENT];if(r&&(a||s)||a&&s)return o.FRAMEBUFFER_UNSUPPORTED;const l=this._getColorAttachments();let h=0;for(const t in e)e[t]&&-1!==l.indexOf(1*t)&&h++;if(0===h)return o.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT;if(r instanceof W)return o.FRAMEBUFFER_UNSUPPORTED;if(r instanceof U){if(r._format!==o.DEPTH_STENCIL)return o.FRAMEBUFFER_INCOMPLETE_ATTACHMENT;i.push(r._width),n.push(r._height)}if(s instanceof W)return o.FRAMEBUFFER_UNSUPPORTED;if(s instanceof U){if(s._format!==o.DEPTH_COMPONENT16)return o.FRAMEBUFFER_INCOMPLETE_ATTACHMENT;i.push(s._width),n.push(s._height)}if(a instanceof W)return o.FRAMEBUFFER_UNSUPPORTED;if(a instanceof U){if(a._format!==o.STENCIL_INDEX8)return o.FRAMEBUFFER_INCOMPLETE_ATTACHMENT;i.push(a._width),n.push(a._height)}let c=!1;for(let s=0;s<l.length;++s){const r=e[l[s]];if(r instanceof W){if(r._format!==o.RGBA||r._type!==o.UNSIGNED_BYTE&&r._type!==o.FLOAT)return o.FRAMEBUFFER_INCOMPLETE_ATTACHMENT;c=!0;const e=t._attachmentLevel[o.COLOR_ATTACHMENT0];i.push(r._levelWidth[e]),n.push(r._levelHeight[e])}else if(r instanceof U){const t=r._format;if(t!==o.RGBA4&&t!==o.RGB565&&t!==o.RGB5_A1)return o.FRAMEBUFFER_INCOMPLETE_ATTACHMENT;c=!0,i.push(r._width),n.push(r._height)}}if(!(c||a||s||r))return o.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT;if(i.length<=0||n.length<=0)return o.FRAMEBUFFER_INCOMPLETE_ATTACHMENT;for(let t=1;t<i.length;++t)if(i[t-1]!==i[t]||n[t-1]!==n[t])return o.FRAMEBUFFER_INCOMPLETE_DIMENSIONS;return 0===i[0]||0===n[0]?o.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:(t._width=i[0],t._height=n[0],o.FRAMEBUFFER_COMPLETE)}_isConstantBlendFunc(t){return t===o.CONSTANT_COLOR||t===o.ONE_MINUS_CONSTANT_COLOR||t===o.CONSTANT_ALPHA||t===o.ONE_MINUS_CONSTANT_ALPHA}_isObject(t,e,i){if(null!=t&&!(t instanceof i))throw new TypeError(e+"("+i.name+")");return!(!this._checkValid(t,i)||!this._checkOwns(t))}_resizeDrawingBuffer(t,e){const i=this._activeFramebuffer,n=this._getActiveTexture(o.TEXTURE_2D),s=this._activeRenderbuffer,r=this._contextAttributes,a=this._drawingBuffer;super.bindFramebuffer(o.FRAMEBUFFER,a._framebuffer);const l=this._getAttachments();for(let t=0;t<l.length;++t)super.framebufferTexture2D(o.FRAMEBUFFER,l[t],o.TEXTURE_2D,0,0);super.bindTexture(o.TEXTURE_2D,a._color);const h=r.alpha?o.RGBA:o.RGB;super.texImage2D(o.TEXTURE_2D,0,h,t,e,0,h,o.UNSIGNED_BYTE,null),super.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),super.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),super.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,a._color,0);let c=0,_=0;r.depth&&r.stencil?(c=o.DEPTH_STENCIL,_=o.DEPTH_STENCIL_ATTACHMENT):r.depth?(c=33191,_=o.DEPTH_ATTACHMENT):r.stencil&&(c=o.STENCIL_INDEX8,_=o.STENCIL_ATTACHMENT),c&&(super.bindRenderbuffer(o.RENDERBUFFER,a._depthStencil),super.renderbufferStorage(o.RENDERBUFFER,c,t,e),super.framebufferRenderbuffer(o.FRAMEBUFFER,_,o.RENDERBUFFER,a._depthStencil)),this.bindFramebuffer(o.FRAMEBUFFER,i),this.bindTexture(o.TEXTURE_2D,n),this.bindRenderbuffer(o.RENDERBUFFER,s)}_restoreError(t){const e=this._errorStack.pop();e===o.NO_ERROR?this.setError(t):this.setError(e)}_saveError(){this._errorStack.push(this.getError())}_switchActiveProgram(t){t&&(t._refCount-=1,t._checkDelete())}_tryDetachFramebuffer(t,e){if(t&&t._linked(e)){const i=this._getAttachments(),n=Object.keys(t._attachments);for(let s=0;s<n.length;++s)t._attachments[i[s]]===e&&this.framebufferTexture2D(o.FRAMEBUFFER,0|i[s],o.TEXTURE_2D,null)}}_updateFramebufferAttachments(t){const e=t._status,i=this._getAttachments();if(t._status=this._preCheckFramebufferStatus(t),t._status===o.FRAMEBUFFER_COMPLETE){for(let e=0;e<i.length;++e){const n=i[e];super.framebufferTexture2D(o.FRAMEBUFFER,n,t._attachmentFace[n],0,t._attachmentLevel[n])}for(let e=0;e<i.length;++e){const n=i[e],s=t._attachments[n];s instanceof W?super.framebufferTexture2D(o.FRAMEBUFFER,n,t._attachmentFace[n],0|s._,t._attachmentLevel[n]):s instanceof U&&super.framebufferRenderbuffer(o.FRAMEBUFFER,n,o.RENDERBUFFER,0|s._)}}else if(e===o.FRAMEBUFFER_COMPLETE)for(let e=0;e<i.length;++e){const n=i[e];super.framebufferTexture2D(o.FRAMEBUFFER,n,t._attachmentFace[n],0,t._attachmentLevel[n])}}_validBlendFunc(t){return t===o.ZERO||t===o.ONE||t===o.SRC_COLOR||t===o.ONE_MINUS_SRC_COLOR||t===o.DST_COLOR||t===o.ONE_MINUS_DST_COLOR||t===o.SRC_ALPHA||t===o.ONE_MINUS_SRC_ALPHA||t===o.DST_ALPHA||t===o.ONE_MINUS_DST_ALPHA||t===o.SRC_ALPHA_SATURATE||t===o.CONSTANT_COLOR||t===o.ONE_MINUS_CONSTANT_COLOR||t===o.CONSTANT_ALPHA||t===o.ONE_MINUS_CONSTANT_ALPHA}_validBlendMode(t){return t===o.FUNC_ADD||t===o.FUNC_SUBTRACT||t===o.FUNC_REVERSE_SUBTRACT||this._extensions.ext_blend_minmax&&(t===this._extensions.ext_blend_minmax.MIN_EXT||t===this._extensions.ext_blend_minmax.MAX_EXT)}_validCubeTarget(t){return t===o.TEXTURE_CUBE_MAP_POSITIVE_X||t===o.TEXTURE_CUBE_MAP_NEGATIVE_X||t===o.TEXTURE_CUBE_MAP_POSITIVE_Y||t===o.TEXTURE_CUBE_MAP_NEGATIVE_Y||t===o.TEXTURE_CUBE_MAP_POSITIVE_Z||t===o.TEXTURE_CUBE_MAP_NEGATIVE_Z}_validFramebufferAttachment(t){switch(t){case o.DEPTH_ATTACHMENT:case o.STENCIL_ATTACHMENT:case o.DEPTH_STENCIL_ATTACHMENT:case o.COLOR_ATTACHMENT0:return!0}if(this._extensions.webgl_draw_buffers){const{webgl_draw_buffers:e}=this._extensions;return t<e.COLOR_ATTACHMENT0_WEBGL+e._maxDrawBuffers}return!1}_validGLSLIdentifier(t){return!(0===t.indexOf("webgl_")||0===t.indexOf("_webgl_")||t.length>256)}_validTextureTarget(t){return t===o.TEXTURE_2D||t===o.TEXTURE_CUBE_MAP}_verifyTextureCompleteness(t,e,i){const n=this._getActiveTextureUnit();let s=null;if(t===o.TEXTURE_2D?s=n._bind2D:this._validCubeTarget(t)&&(s=n._bindCube),this._extensions.oes_texture_float&&!this._extensions.oes_texture_float_linear&&s&&s._type===o.FLOAT&&(e===o.TEXTURE_MAG_FILTER||e===o.TEXTURE_MIN_FILTER)&&(i===o.LINEAR||i===o.LINEAR_MIPMAP_NEAREST||i===o.NEAREST_MIPMAP_LINEAR||i===o.LINEAR_MIPMAP_LINEAR))return s._complete=!1,void this.bindTexture(t,s);s&&!1===s._complete&&(s._complete=!0,this.bindTexture(t,s))}_wrapShader(t,e){return!this._extensions.oes_standard_derivatives&&/#ifdef\s+GL_OES_standard_derivatives/.test(e)&&(e="#undef GL_OES_standard_derivatives\n"+e),this._extensions.webgl_draw_buffers?e:"#define gl_MaxDrawBuffers 1\n"+e}_beginAttrib0Hack(){super.bindBuffer(o.ARRAY_BUFFER,this._attrib0Buffer._),super.bufferData(o.ARRAY_BUFFER,this._vertexGlobalState._attribs[0]._data,o.STREAM_DRAW),super.enableVertexAttribArray(0),super.vertexAttribPointer(0,4,o.FLOAT,!1,0,0),super._vertexAttribDivisor(0,1)}_endAttrib0Hack(){const t=this._vertexObjectState._attribs[0];t._pointerBuffer?super.bindBuffer(o.ARRAY_BUFFER,t._pointerBuffer._):super.bindBuffer(o.ARRAY_BUFFER,0),super.vertexAttribPointer(0,t._inputSize,t._pointerType,t._pointerNormal,t._inputStride,t._pointerOffset),super._vertexAttribDivisor(0,t._divisor),super.disableVertexAttribArray(0),this._vertexGlobalState._arrayBufferBinding?super.bindBuffer(o.ARRAY_BUFFER,this._vertexGlobalState._arrayBufferBinding._):super.bindBuffer(o.ARRAY_BUFFER,0)}activeTexture(t){const e=(t|=0)-o.TEXTURE0;if(e>=0&&e<this._textureUnits.length)return this._activeTextureUnit=e,super.activeTexture(t);this.setError(o.INVALID_ENUM)}attachShader(t,e){if(!S(t)||!S(e))throw new TypeError("attachShader(WebGLProgram, WebGLShader)");if(t&&e){if(t instanceof N&&e instanceof V&&this._checkOwns(t)&&this._checkOwns(e)&&!t._linked(e)){this._saveError(),super.attachShader(0|t._,0|e._);const i=this.getError();return this._restoreError(i),void(i===o.NO_ERROR&&t._link(e))}this.setError(o.INVALID_OPERATION)}else this.setError(o.INVALID_VALUE)}bindAttribLocation(t,e,i){if(!S(t)||"string"!=typeof i)throw new TypeError("bindAttribLocation(WebGLProgram, GLint, String)");if(!C(i+="")||i.length>256)this.setError(o.INVALID_VALUE);else if(/^_?webgl_a/.test(i))this.setError(o.INVALID_OPERATION);else if(this._checkWrapper(t,N))return super.bindAttribLocation(0|t._,0|e,i)}bindFramebuffer(t,e){if(!S(e))throw new TypeError("bindFramebuffer(GLenum, WebGLFramebuffer)");if(t!==o.FRAMEBUFFER)return void this.setError(o.INVALID_ENUM);if(e){if(e._pendingDelete)return;if(!this._checkWrapper(e,O))return;super.bindFramebuffer(o.FRAMEBUFFER,0|e._)}else super.bindFramebuffer(o.FRAMEBUFFER,this._drawingBuffer._framebuffer);const i=this._activeFramebuffer;i!==e&&(i&&(i._refCount-=1,i._checkDelete()),e&&(e._refCount+=1)),this._activeFramebuffer=e,e&&this._updateFramebufferAttachments(e)}bindBuffer(t,e){if(t|=0,!S(e))throw new TypeError("bindBuffer(GLenum, WebGLBuffer)");if(t===o.ARRAY_BUFFER||t===o.ELEMENT_ARRAY_BUFFER){if(e){if(e._pendingDelete)return;if(!this._checkWrapper(e,F))return;if(e._binding&&e._binding!==t)return void this.setError(o.INVALID_OPERATION);e._binding=0|t,super.bindBuffer(t,0|e._)}else e=null,super.bindBuffer(t,0);t===o.ARRAY_BUFFER?this._vertexGlobalState.setArrayBuffer(e):this._vertexObjectState.setElementArrayBuffer(e)}else this.setError(o.INVALID_ENUM)}bindRenderbuffer(t,e){if(!S(e))throw new TypeError("bindRenderbuffer(GLenum, WebGLRenderbuffer)");if(t!==o.RENDERBUFFER)return void this.setError(o.INVALID_ENUM);if(e){if(e._pendingDelete)return;if(!this._checkWrapper(e,U))return;super.bindRenderbuffer(0|t,0|e._)}else super.bindRenderbuffer(0|t,0);const i=this._activeRenderbuffer;i!==e&&(i&&(i._refCount-=1,i._checkDelete()),e&&(e._refCount+=1)),this._activeRenderbuffer=e}bindTexture(t,e){if(t|=0,!S(e))throw new TypeError("bindTexture(GLenum, WebGLTexture)");if(!this._validTextureTarget(t))return void this.setError(o.INVALID_ENUM);let i=0;if(e){if(e instanceof W&&e._pendingDelete)return;if(!this._checkWrapper(e,W))return;if(e._binding&&e._binding!==t)return void this.setError(o.INVALID_OPERATION);e._binding=t,e._complete&&(i=0|e._)}else e=null;this._saveError(),super.bindTexture(t,i);const n=this.getError();if(this._restoreError(n),n!==o.NO_ERROR)return;const s=this._getActiveTextureUnit(),r=this._getActiveTexture(t);r!==e&&(r&&(r._refCount-=1,r._checkDelete()),e&&(e._refCount+=1)),t===o.TEXTURE_2D?s._bind2D=e:t===o.TEXTURE_CUBE_MAP&&(s._bindCube=e)}blendColor(t,e,i,n){return super.blendColor(+t,+e,+i,+n)}blendEquation(t){if(t|=0,this._validBlendMode(t))return super.blendEquation(t);this.setError(o.INVALID_ENUM)}blendEquationSeparate(t,e){if(t|=0,e|=0,this._validBlendMode(t)&&this._validBlendMode(e))return super.blendEquationSeparate(t,e);this.setError(o.INVALID_ENUM)}createBuffer(){const t=super.createBuffer();if(t<=0)return null;const e=new F(t,this);return this._buffers[t]=e,e}createFramebuffer(){const t=super.createFramebuffer();if(t<=0)return null;const e=new O(t,this);return this._framebuffers[t]=e,e}createProgram(){const t=super.createProgram();if(t<=0)return null;const e=new N(t,this);return this._programs[t]=e,e}createRenderbuffer(){const t=super.createRenderbuffer();if(t<=0)return null;const e=new U(t,this);return this._renderbuffers[t]=e,e}createTexture(){const t=super.createTexture();if(t<=0)return null;const e=new W(t,this);return this._textures[t]=e,e}getContextAttributes(){return this._contextAttributes}getExtension(t){const e=t.toLowerCase();if(e in this._extensions)return this._extensions[e];const i=X[e]?X[e](this):null;return i&&(this._extensions[e]=i),i}getSupportedExtensions(){const t=["ANGLE_instanced_arrays","STACKGL_resize_drawingbuffer","STACKGL_destroy_context"],e=super.getSupportedExtensions();return e.indexOf("GL_OES_element_index_uint")>=0&&t.push("OES_element_index_uint"),e.indexOf("GL_OES_standard_derivatives")>=0&&t.push("OES_standard_derivatives"),e.indexOf("GL_OES_texture_float")>=0&&t.push("OES_texture_float"),e.indexOf("GL_OES_texture_float_linear")>=0&&t.push("OES_texture_float_linear"),e.indexOf("EXT_draw_buffers")>=0&&t.push("WEBGL_draw_buffers"),e.indexOf("EXT_blend_minmax")>=0&&t.push("EXT_blend_minmax"),e.indexOf("EXT_texture_filter_anisotropic")>=0&&t.push("EXT_texture_filter_anisotropic"),e.indexOf("GL_OES_vertex_array_object")>=0&&t.push("OES_vertex_array_object"),t}setError(t){l.setError.call(this,0|t)}blendFunc(t,e){t|=0,e|=0,this._validBlendFunc(t)&&this._validBlendFunc(e)?this._isConstantBlendFunc(t)&&this._isConstantBlendFunc(e)?this.setError(o.INVALID_OPERATION):super.blendFunc(t,e):this.setError(o.INVALID_ENUM)}blendFuncSeparate(t,e,i,n){t|=0,e|=0,i|=0,n|=0,this._validBlendFunc(t)&&this._validBlendFunc(e)&&this._validBlendFunc(i)&&this._validBlendFunc(n)?this._isConstantBlendFunc(t)&&this._isConstantBlendFunc(e)||this._isConstantBlendFunc(i)&&this._isConstantBlendFunc(n)?this.setError(o.INVALID_OPERATION):super.blendFuncSeparate(t,e,i,n):this.setError(o.INVALID_ENUM)}bufferData(t,e,i){if(t|=0,(i|=0)!==o.STREAM_DRAW&&i!==o.STATIC_DRAW&&i!==o.DYNAMIC_DRAW)return void this.setError(o.INVALID_ENUM);if(t!==o.ARRAY_BUFFER&&t!==o.ELEMENT_ARRAY_BUFFER)return void this.setError(o.INVALID_ENUM);const n=this._getActiveBuffer(t);if(n)if("object"==typeof e){let s=null;if(R(e))s=I(e);else{if(!(e instanceof ArrayBuffer))return void this.setError(o.INVALID_VALUE);s=new Uint8Array(e)}this._saveError(),super.bufferData(t,s,i);const r=this.getError();if(this._restoreError(r),r!==o.NO_ERROR)return;n._size=s.length,t===o.ELEMENT_ARRAY_BUFFER&&(n._elements=new Uint8Array(s))}else if("number"==typeof e){const s=0|e;if(s<0)return void this.setError(o.INVALID_VALUE);this._saveError(),super.bufferData(t,s,i);const r=this.getError();if(this._restoreError(r),r!==o.NO_ERROR)return;n._size=s,t===o.ELEMENT_ARRAY_BUFFER&&(n._elements=new Uint8Array(s))}else this.setError(o.INVALID_VALUE);else this.setError(o.INVALID_OPERATION)}bufferSubData(t,e,i){if(e|=0,(t|=0)!==o.ARRAY_BUFFER&&t!==o.ELEMENT_ARRAY_BUFFER)return void this.setError(o.INVALID_ENUM);if(null===i)return;if(!i||"object"!=typeof i)return void this.setError(o.INVALID_VALUE);const n=this._getActiveBuffer(t);if(!n)return void this.setError(o.INVALID_OPERATION);if(e<0||e>=n._size)return void this.setError(o.INVALID_VALUE);let s=null;if(R(i))s=I(i);else{if(!(i instanceof ArrayBuffer))return void this.setError(o.INVALID_VALUE);s=new Uint8Array(i)}e+s.length>n._size?this.setError(o.INVALID_VALUE):(t===o.ELEMENT_ARRAY_BUFFER&&n._elements.set(s,e),super.bufferSubData(t,e,s))}checkFramebufferStatus(t){if(t!==o.FRAMEBUFFER)return this.setError(o.INVALID_ENUM),0;const e=this._activeFramebuffer;return e?this._preCheckFramebufferStatus(e):o.FRAMEBUFFER_COMPLETE}clear(t){if(this._framebufferOk())return super.clear(0|t)}clearColor(t,e,i,n){return super.clearColor(+t,+e,+i,+n)}clearDepth(t){return super.clearDepth(+t)}clearStencil(t){return this._checkStencil=!1,super.clearStencil(0|t)}colorMask(t,e,i,n){return super.colorMask(!!t,!!e,!!i,!!n)}compileShader(t){if(!S(t))throw new TypeError("compileShader(WebGLShader)");if(this._checkWrapper(t,V)&&this._checkShaderSource(t)){const e=this.getError();super.compileShader(0|t._);const i=this.getError();t._compileStatus=!!super.getShaderParameter(0|t._,o.COMPILE_STATUS),t._compileInfo=super.getShaderInfoLog(0|t._),this.getError(),this.setError(e||i)}}copyTexImage2D(t,e,i,s,r,a,l,h){t|=0,e|=0,i|=0,s|=0,r|=0,a|=0,l|=0,h|=0;const c=this._getTexImage(t);if(!c)return void this.setError(o.INVALID_OPERATION);if(i!==o.RGBA&&i!==o.RGB&&i!==o.ALPHA&&i!==o.LUMINANCE&&i!==o.LUMINANCE_ALPHA)return void this.setError(o.INVALID_ENUM);if(e<0||a<0||l<0||0!==h)return void this.setError(o.INVALID_VALUE);if(e>0&&(!n.isPow2(a)||!n.isPow2(l)))return void this.setError(o.INVALID_VALUE);this._saveError(),super.copyTexImage2D(t,e,i,s,r,a,l,h);const _=this.getError();this._restoreError(_),_===o.NO_ERROR&&(c._levelWidth[e]=a,c._levelHeight[e]=l,c._format=o.RGBA,c._type=o.UNSIGNED_BYTE)}copyTexSubImage2D(t,e,i,n,s,r,a,l){t|=0,e|=0,i|=0,n|=0,s|=0,r|=0,a|=0,l|=0;this._getTexImage(t)?a<0||l<0||i<0||n<0||e<0?this.setError(o.INVALID_VALUE):super.copyTexSubImage2D(t,e,i,n,s,r,a,l):this.setError(o.INVALID_OPERATION)}cullFace(t){return super.cullFace(0|t)}createShader(t){if((t|=0)!==o.FRAGMENT_SHADER&&t!==o.VERTEX_SHADER)return this.setError(o.INVALID_ENUM),null;const e=super.createShader(t);if(e<0)return null;const i=new V(e,this,t);return this._shaders[e]=i,i}deleteProgram(t){return this._deleteLinkable("deleteProgram",t,N)}deleteShader(t){return this._deleteLinkable("deleteShader",t,V)}_deleteLinkable(t,e,i){if(!S(e))throw new TypeError(t+"("+i.name+")");if(e instanceof i&&this._checkOwns(e))return e._pendingDelete=!0,void e._checkDelete();this.setError(o.INVALID_OPERATION)}deleteBuffer(t){if(!S(t)||null!==t&&!(t instanceof F))throw new TypeError("deleteBuffer(WebGLBuffer)");t instanceof F&&this._checkOwns(t)?(this._vertexGlobalState._arrayBufferBinding===t&&this.bindBuffer(o.ARRAY_BUFFER,null),this._vertexObjectState._elementArrayBufferBinding===t&&this.bindBuffer(o.ELEMENT_ARRAY_BUFFER,null),this._vertexObjectState===this._defaultVertexObjectState&&this._vertexObjectState.releaseArrayBuffer(t),t._pendingDelete=!0,t._checkDelete()):this.setError(o.INVALID_OPERATION)}deleteFramebuffer(t){if(!S(t))throw new TypeError("deleteFramebuffer(WebGLFramebuffer)");t instanceof O&&this._checkOwns(t)?(this._activeFramebuffer===t&&this.bindFramebuffer(o.FRAMEBUFFER,null),t._pendingDelete=!0,t._checkDelete()):this.setError(o.INVALID_OPERATION)}deleteRenderbuffer(t){if(!S(t))throw new TypeError("deleteRenderbuffer(WebGLRenderbuffer)");if(!(t instanceof U&&this._checkOwns(t)))return void this.setError(o.INVALID_OPERATION);this._activeRenderbuffer===t&&this.bindRenderbuffer(o.RENDERBUFFER,null);const e=this._activeFramebuffer;this._tryDetachFramebuffer(e,t),t._pendingDelete=!0,t._checkDelete()}deleteTexture(t){if(!S(t))throw new TypeError("deleteTexture(WebGLTexture)");if(!(t instanceof W))return;if(!this._checkOwns(t))return void this.setError(o.INVALID_OPERATION);const e=this._activeTextureUnit;for(let e=0;e<this._textureUnits.length;++e){const i=this._textureUnits[e];i._bind2D===t?(this.activeTexture(o.TEXTURE0+e),this.bindTexture(o.TEXTURE_2D,null)):i._bindCube===t&&(this.activeTexture(o.TEXTURE0+e),this.bindTexture(o.TEXTURE_CUBE_MAP,null))}this.activeTexture(o.TEXTURE0+e);const i=this;!function(e){if(e&&e._linked(t)){const n=i._getAttachments();for(let s=0;s<n.length;++s){const r=n[s];e._attachments[r]===t&&i.framebufferTexture2D(o.FRAMEBUFFER,r,o.TEXTURE_2D,null)}}}(this._activeFramebuffer),t._pendingDelete=!0,t._checkDelete()}depthFunc(t){switch(t|=0){case o.NEVER:case o.LESS:case o.EQUAL:case o.LEQUAL:case o.GREATER:case o.NOTEQUAL:case o.GEQUAL:case o.ALWAYS:return super.depthFunc(t);default:this.setError(o.INVALID_ENUM)}}depthMask(t){return super.depthMask(!!t)}depthRange(t,e){if((t=+t)<=(e=+e))return super.depthRange(t,e);this.setError(o.INVALID_OPERATION)}destroy(){super.destroy()}detachShader(t,e){if(!S(t)||!S(e))throw new TypeError("detachShader(WebGLProgram, WebGLShader)");this._checkWrapper(t,N)&&this._checkWrapper(e,V)&&(t._linked(e)?(super.detachShader(t._,e._),t._unlink(e)):this.setError(o.INVALID_OPERATION))}disable(t){if(t|=0,super.disable(t),t===o.TEXTURE_2D||t===o.TEXTURE_CUBE_MAP){const e=this._getActiveTextureUnit();e._mode===t&&(e._mode=0)}}disableVertexAttribArray(t){(t|=0)<0||t>=this._vertexObjectState._attribs.length?this.setError(o.INVALID_VALUE):(super.disableVertexAttribArray(t),this._vertexObjectState._attribs[t]._isPointer=!1)}drawArrays(t,e,i){if(t|=0,i|=0,(e|=0)<0||i<0)return void this.setError(o.INVALID_VALUE);if(!this._checkStencilState())return;const n=M(t,i);if(n<0)return void this.setError(o.INVALID_ENUM);if(!this._framebufferOk())return;if(0===i)return;let s=e;if(i>0&&(s=i+e-1>>>0),this._checkVertexAttribState(s)){if(this._vertexObjectState._attribs[0]._isPointer||this._extensions.webgl_draw_buffers&&this._extensions.webgl_draw_buffers._buffersState&&this._extensions.webgl_draw_buffers._buffersState.length>0)return super.drawArrays(t,e,n);this._beginAttrib0Hack(),super._drawArraysInstanced(t,e,n,1),this._endAttrib0Hack()}}drawElements(t,e,i,n){if(t|=0,i|=0,n|=0,(e|=0)<0||n<0)return void this.setError(o.INVALID_VALUE);if(!this._checkStencilState())return;const s=this._vertexObjectState._elementArrayBufferBinding;if(!s)return void this.setError(o.INVALID_OPERATION);let r=null,a=n;if(i===o.UNSIGNED_SHORT){if(a%2)return void this.setError(o.INVALID_OPERATION);a>>=1,r=new Uint16Array(s._elements.buffer)}else if(this._extensions.oes_element_index_uint&&i===o.UNSIGNED_INT){if(a%4)return void this.setError(o.INVALID_OPERATION);a>>=2,r=new Uint32Array(s._elements.buffer)}else{if(i!==o.UNSIGNED_BYTE)return void this.setError(o.INVALID_ENUM);r=s._elements}let l=e;switch(t){case o.TRIANGLES:e%3&&(l-=e%3);break;case o.LINES:e%2&&(l-=e%2);break;case o.POINTS:break;case o.LINE_LOOP:case o.LINE_STRIP:if(e<2)return void this.setError(o.INVALID_OPERATION);break;case o.TRIANGLE_FAN:case o.TRIANGLE_STRIP:if(e<3)return void this.setError(o.INVALID_OPERATION);break;default:return void this.setError(o.INVALID_ENUM)}if(!this._framebufferOk())return;if(0===e)return void this._checkVertexAttribState(0);if(e+a>>>0>r.length)return void this.setError(o.INVALID_OPERATION);let h=-1;for(let t=a;t<a+e;++t)h=Math.max(h,r[t]);if(h<0)this._checkVertexAttribState(0);else if(this._checkVertexAttribState(h)&&l>0){if(this._vertexObjectState._attribs[0]._isPointer)return super.drawElements(t,l,i,n);this._beginAttrib0Hack(),super._drawElementsInstanced(t,l,i,n,1),this._endAttrib0Hack()}}enable(t){t|=0,super.enable(t)}enableVertexAttribArray(t){(t|=0)<0||t>=this._vertexObjectState._attribs.length?this.setError(o.INVALID_VALUE):(super.enableVertexAttribArray(t),this._vertexObjectState._attribs[t]._isPointer=!0)}finish(){return super.finish()}flush(){return super.flush()}framebufferRenderbuffer(t,e,i,n){if(t|=0,e|=0,i|=0,!S(n))throw new TypeError("framebufferRenderbuffer(GLenum, GLenum, GLenum, WebGLRenderbuffer)");if(t!==o.FRAMEBUFFER||!this._validFramebufferAttachment(e)||i!==o.RENDERBUFFER)return void this.setError(o.INVALID_ENUM);const s=this._activeFramebuffer;s?n&&!this._checkWrapper(n,U)||(s._setAttachment(n,e),this._updateFramebufferAttachments(s)):this.setError(o.INVALID_OPERATION)}framebufferTexture2D(t,e,i,n,s){if(t|=0,e|=0,i|=0,s|=0,!S(n))throw new TypeError("framebufferTexture2D(GLenum, GLenum, GLenum, WebGLTexture, GLint)");if(t!==o.FRAMEBUFFER||!this._validFramebufferAttachment(e))return void this.setError(o.INVALID_ENUM);if(0!==s)return void this.setError(o.INVALID_VALUE);if(n&&!this._checkWrapper(n,W))return;if(i===o.TEXTURE_2D){if(n&&n._binding!==o.TEXTURE_2D)return void this.setError(o.INVALID_OPERATION)}else{if(!this._validCubeTarget(i))return void this.setError(o.INVALID_ENUM);if(n&&n._binding!==o.TEXTURE_CUBE_MAP)return void this.setError(o.INVALID_OPERATION)}const r=this._activeFramebuffer;r?(r._attachmentLevel[e]=s,r._attachmentFace[e]=i,r._setAttachment(n,e),this._updateFramebufferAttachments(r)):this.setError(o.INVALID_OPERATION)}frontFace(t){return super.frontFace(0|t)}generateMipmap(t){return 0|super.generateMipmap(0|t)}getActiveAttrib(t,e){if(!S(t))throw new TypeError("getActiveAttrib(WebGLProgram)");if(t){if(this._checkWrapper(t,N)){const i=super.getActiveAttrib(0|t._,0|e);if(i)return new k(i)}}else this.setError(o.INVALID_VALUE);return null}getActiveUniform(t,e){if(!S(t))throw new TypeError("getActiveUniform(WebGLProgram, GLint)");if(t){if(this._checkWrapper(t,N)){const i=super.getActiveUniform(0|t._,0|e);if(i)return new k(i)}}else this.setError(o.INVALID_VALUE);return null}getAttachedShaders(t){if(!S(t)||"object"==typeof t&&null!==t&&!(t instanceof N))throw new TypeError("getAttachedShaders(WebGLProgram)");if(t){if(this._checkWrapper(t,N)){const e=super.getAttachedShaders(0|t._);if(!e)return null;const i=new Array(e.length);for(let t=0;t<e.length;++t)i[t]=this._shaders[e[t]];return i}}else this.setError(o.INVALID_VALUE);return null}getAttribLocation(t,e){if(!S(t))throw new TypeError("getAttribLocation(WebGLProgram, String)");if(!C(e+="")||e.length>256)this.setError(o.INVALID_VALUE);else if(this._checkWrapper(t,N))return super.getAttribLocation(0|t._,e+"");return-1}getParameter(t){switch(t|=0){case o.ARRAY_BUFFER_BINDING:return this._vertexGlobalState._arrayBufferBinding;case o.ELEMENT_ARRAY_BUFFER_BINDING:return this._vertexObjectState._elementArrayBufferBinding;case o.CURRENT_PROGRAM:return this._activeProgram;case o.FRAMEBUFFER_BINDING:return this._activeFramebuffer;case o.RENDERBUFFER_BINDING:return this._activeRenderbuffer;case o.TEXTURE_BINDING_2D:return this._getActiveTextureUnit()._bind2D;case o.TEXTURE_BINDING_CUBE_MAP:return this._getActiveTextureUnit()._bindCube;case o.VERSION:return"WebGL 1.0 stack-gl "+r;case o.VENDOR:return"stack-gl";case o.RENDERER:return"ANGLE";case o.SHADING_LANGUAGE_VERSION:return"WebGL GLSL ES 1.0 stack-gl";case o.COMPRESSED_TEXTURE_FORMATS:return new Uint32Array(0);case o.MAX_VIEWPORT_DIMS:case o.SCISSOR_BOX:case o.VIEWPORT:return new Int32Array(super.getParameter(t));case o.ALIASED_LINE_WIDTH_RANGE:case o.ALIASED_POINT_SIZE_RANGE:case o.DEPTH_RANGE:case o.BLEND_COLOR:case o.COLOR_CLEAR_VALUE:return new Float32Array(super.getParameter(t));case o.COLOR_WRITEMASK:return super.getParameter(t);case o.DEPTH_CLEAR_VALUE:case o.LINE_WIDTH:case o.POLYGON_OFFSET_FACTOR:case o.POLYGON_OFFSET_UNITS:case o.SAMPLE_COVERAGE_VALUE:return+super.getParameter(t);case o.BLEND:case o.CULL_FACE:case o.DEPTH_TEST:case o.DEPTH_WRITEMASK:case o.DITHER:case o.POLYGON_OFFSET_FILL:case o.SAMPLE_COVERAGE_INVERT:case o.SCISSOR_TEST:case o.STENCIL_TEST:case o.UNPACK_FLIP_Y_WEBGL:case o.UNPACK_PREMULTIPLY_ALPHA_WEBGL:return!!super.getParameter(t);case o.ACTIVE_TEXTURE:case o.ALPHA_BITS:case o.BLEND_DST_ALPHA:case o.BLEND_DST_RGB:case o.BLEND_EQUATION_ALPHA:case o.BLEND_EQUATION_RGB:case o.BLEND_SRC_ALPHA:case o.BLEND_SRC_RGB:case o.BLUE_BITS:case o.CULL_FACE_MODE:case o.DEPTH_BITS:case o.DEPTH_FUNC:case o.FRONT_FACE:case o.GENERATE_MIPMAP_HINT:case o.GREEN_BITS:case o.MAX_COMBINED_TEXTURE_IMAGE_UNITS:case o.MAX_CUBE_MAP_TEXTURE_SIZE:case o.MAX_FRAGMENT_UNIFORM_VECTORS:case o.MAX_RENDERBUFFER_SIZE:case o.MAX_TEXTURE_IMAGE_UNITS:case o.MAX_TEXTURE_SIZE:case o.MAX_VARYING_VECTORS:case o.MAX_VERTEX_ATTRIBS:case o.MAX_VERTEX_TEXTURE_IMAGE_UNITS:case o.MAX_VERTEX_UNIFORM_VECTORS:case o.PACK_ALIGNMENT:case o.RED_BITS:case o.SAMPLE_BUFFERS:case o.SAMPLES:case o.STENCIL_BACK_FAIL:case o.STENCIL_BACK_FUNC:case o.STENCIL_BACK_PASS_DEPTH_FAIL:case o.STENCIL_BACK_PASS_DEPTH_PASS:case o.STENCIL_BACK_REF:case o.STENCIL_BACK_VALUE_MASK:case o.STENCIL_BACK_WRITEMASK:case o.STENCIL_BITS:case o.STENCIL_CLEAR_VALUE:case o.STENCIL_FAIL:case o.STENCIL_FUNC:case o.STENCIL_PASS_DEPTH_FAIL:case o.STENCIL_PASS_DEPTH_PASS:case o.STENCIL_REF:case o.STENCIL_VALUE_MASK:case o.STENCIL_WRITEMASK:case o.SUBPIXEL_BITS:case o.UNPACK_ALIGNMENT:case o.UNPACK_COLORSPACE_CONVERSION_WEBGL:return 0|super.getParameter(t);case o.IMPLEMENTATION_COLOR_READ_FORMAT:case o.IMPLEMENTATION_COLOR_READ_TYPE:return super.getParameter(t);default:if(this._extensions.webgl_draw_buffers){const e=this._extensions.webgl_draw_buffers;switch(t){case e.DRAW_BUFFER0_WEBGL:case e.DRAW_BUFFER1_WEBGL:case e.DRAW_BUFFER2_WEBGL:case e.DRAW_BUFFER3_WEBGL:case e.DRAW_BUFFER4_WEBGL:case e.DRAW_BUFFER5_WEBGL:case e.DRAW_BUFFER6_WEBGL:case e.DRAW_BUFFER7_WEBGL:case e.DRAW_BUFFER8_WEBGL:case e.DRAW_BUFFER9_WEBGL:case e.DRAW_BUFFER10_WEBGL:case e.DRAW_BUFFER11_WEBGL:case e.DRAW_BUFFER12_WEBGL:case e.DRAW_BUFFER13_WEBGL:case e.DRAW_BUFFER14_WEBGL:case e.DRAW_BUFFER15_WEBGL:return 1===e._buffersState.length&&e._buffersState[0]===o.BACK?o.BACK:super.getParameter(t);case e.MAX_DRAW_BUFFERS_WEBGL:case e.MAX_COLOR_ATTACHMENTS_WEBGL:return super.getParameter(t)}}return this._extensions.oes_standard_derivatives&&t===this._extensions.oes_standard_derivatives.FRAGMENT_SHADER_DERIVATIVE_HINT_OES||this._extensions.ext_texture_filter_anisotropic&&t===this._extensions.ext_texture_filter_anisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT?super.getParameter(t):this._extensions.oes_vertex_array_object&&t===this._extensions.oes_vertex_array_object.VERTEX_ARRAY_BINDING_OES?this._extensions.oes_vertex_array_object._activeVertexArrayObject:(this.setError(o.INVALID_ENUM),null)}}getShaderPrecisionFormat(t,e){if(e|=0,(t|=0)!==o.FRAGMENT_SHADER&&t!==o.VERTEX_SHADER||e!==o.LOW_FLOAT&&e!==o.MEDIUM_FLOAT&&e!==o.HIGH_FLOAT&&e!==o.LOW_INT&&e!==o.MEDIUM_INT&&e!==o.HIGH_INT)return void this.setError(o.INVALID_ENUM);const i=super.getShaderPrecisionFormat(t,e);return i?new z(i):null}getBufferParameter(t,e){if(e|=0,(t|=0)!==o.ARRAY_BUFFER&&t!==o.ELEMENT_ARRAY_BUFFER)return this.setError(o.INVALID_ENUM),null;switch(e){case o.BUFFER_SIZE:case o.BUFFER_USAGE:return super.getBufferParameter(0|t,0|e);default:return this.setError(o.INVALID_ENUM),null}}getError(){return super.getError()}getFramebufferAttachmentParameter(t,e,i){if(e|=0,i|=0,(t|=0)!==o.FRAMEBUFFER||!this._validFramebufferAttachment(e))return this.setError(o.INVALID_ENUM),null;const n=this._activeFramebuffer;if(!n)return this.setError(o.INVALID_OPERATION),null;const s=n._attachments[e];if(null===s){if(i===o.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE)return o.NONE}else if(s instanceof W)switch(i){case o.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:return s;case o.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:return o.TEXTURE;case o.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:return n._attachmentLevel[e];case o.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:{const t=n._attachmentFace[e];return t===o.TEXTURE_2D?0:t}}else if(s instanceof U)switch(i){case o.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:return s;case o.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:return o.RENDERBUFFER}return this.setError(o.INVALID_ENUM),null}getProgramParameter(t,e){if(e|=0,!S(t))throw new TypeError("getProgramParameter(WebGLProgram, GLenum)");if(this._checkWrapper(t,N)){switch(e){case o.DELETE_STATUS:return t._pendingDelete;case o.LINK_STATUS:return t._linkStatus;case o.VALIDATE_STATUS:return!!super.getProgramParameter(t._,e);case o.ATTACHED_SHADERS:case o.ACTIVE_ATTRIBUTES:case o.ACTIVE_UNIFORMS:return super.getProgramParameter(t._,e)}this.setError(o.INVALID_ENUM)}return null}getProgramInfoLog(t){if(!S(t))throw new TypeError("getProgramInfoLog(WebGLProgram)");return this._checkWrapper(t,N)?t._linkInfoLog:null}getRenderbufferParameter(t,e){if(e|=0,(t|=0)!==o.RENDERBUFFER)return this.setError(o.INVALID_ENUM),null;const i=this._activeRenderbuffer;if(!i)return this.setError(o.INVALID_OPERATION),null;switch(e){case o.RENDERBUFFER_INTERNAL_FORMAT:return i._format;case o.RENDERBUFFER_WIDTH:return i._width;case o.RENDERBUFFER_HEIGHT:return i._height;case o.RENDERBUFFER_SIZE:case o.RENDERBUFFER_RED_SIZE:case o.RENDERBUFFER_GREEN_SIZE:case o.RENDERBUFFER_BLUE_SIZE:case o.RENDERBUFFER_ALPHA_SIZE:case o.RENDERBUFFER_DEPTH_SIZE:case o.RENDERBUFFER_STENCIL_SIZE:return super.getRenderbufferParameter(t,e)}return this.setError(o.INVALID_ENUM),null}getShaderParameter(t,e){if(e|=0,!S(t))throw new TypeError("getShaderParameter(WebGLShader, GLenum)");if(this._checkWrapper(t,V)){switch(e){case o.DELETE_STATUS:return t._pendingDelete;case o.COMPILE_STATUS:return t._compileStatus;case o.SHADER_TYPE:return t._type}this.setError(o.INVALID_ENUM)}return null}getShaderInfoLog(t){if(!S(t))throw new TypeError("getShaderInfoLog(WebGLShader)");return this._checkWrapper(t,V)?t._compileInfo:null}getShaderSource(t){if(!S(t))throw new TypeError("Input to getShaderSource must be an object");return this._checkWrapper(t,V)?t._source:null}getTexParameter(t,e){if(t|=0,e|=0,!this._checkTextureTarget(t))return null;const i=this._getActiveTextureUnit();if(t===o.TEXTURE_2D&&!i._bind2D||t===o.TEXTURE_CUBE_MAP&&!i._bindCube)return this.setError(o.INVALID_OPERATION),null;switch(e){case o.TEXTURE_MAG_FILTER:case o.TEXTURE_MIN_FILTER:case o.TEXTURE_WRAP_S:case o.TEXTURE_WRAP_T:return super.getTexParameter(t,e)}return this._extensions.ext_texture_filter_anisotropic&&e===this._extensions.ext_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT?super.getTexParameter(t,e):(this.setError(o.INVALID_ENUM),null)}getUniform(t,e){if(!S(t)||!S(e))throw new TypeError("getUniform(WebGLProgram, WebGLUniformLocation)");if(!t)return this.setError(o.INVALID_VALUE),null;if(!e)return null;if(this._checkWrapper(t,N)){if(!x(t,e))return this.setError(o.INVALID_OPERATION),null;const i=super.getUniform(0|t._,0|e._);if(!i)return null;switch(e._activeInfo.type){case o.FLOAT:return i[0];case o.FLOAT_VEC2:return new Float32Array(i.slice(0,2));case o.FLOAT_VEC3:return new Float32Array(i.slice(0,3));case o.FLOAT_VEC4:return new Float32Array(i.slice(0,4));case o.INT:return 0|i[0];case o.INT_VEC2:return new Int32Array(i.slice(0,2));case o.INT_VEC3:return new Int32Array(i.slice(0,3));case o.INT_VEC4:return new Int32Array(i.slice(0,4));case o.BOOL:return!!i[0];case o.BOOL_VEC2:return[!!i[0],!!i[1]];case o.BOOL_VEC3:return[!!i[0],!!i[1],!!i[2]];case o.BOOL_VEC4:return[!!i[0],!!i[1],!!i[2],!!i[3]];case o.FLOAT_MAT2:return new Float32Array(i.slice(0,4));case o.FLOAT_MAT3:return new Float32Array(i.slice(0,9));case o.FLOAT_MAT4:return new Float32Array(i.slice(0,16));case o.SAMPLER_2D:case o.SAMPLER_CUBE:return 0|i[0];default:return null}}return null}getUniformLocation(t,e){if(!S(t))throw new TypeError("getUniformLocation(WebGLProgram, String)");if(C(e+="")){if(this._checkWrapper(t,N)){const i=super.getUniformLocation(0|t._,e);if(i>=0){let n=e;/\[\d+\]$/.test(e)&&(n=e.replace(/\[\d+\]$/,"[0]"));let s=null;for(let e=0;e<t._uniforms.length;++e){const i=t._uniforms[e];i.name===n&&(s={size:i.size,type:i.type,name:i.name})}if(!s)return null;const r=new G(i,t,s);if(/\[0\]$/.test(e)){const i=e.replace(/\[0\]$/,""),n=[];this._saveError();for(let e=0;this.getError()===o.NO_ERROR;++e){const s=super.getUniformLocation(0|t._,i+"["+e+"]");if(this.getError()!==o.NO_ERROR||s<0)break;n.push(s)}this._restoreError(o.NO_ERROR),r._array=n}else if(/\[(\d+)\]$/.test(e)){const t=+/\[(\d+)\]$/.exec(e)[1];if(t<0||t>=s.size)return null}return r}}return null}this.setError(o.INVALID_VALUE)}getVertexAttrib(t,e){if(e|=0,(t|=0)<0||t>=this._vertexObjectState._attribs.length)return this.setError(o.INVALID_VALUE),null;const i=this._vertexObjectState._attribs[t],n=this._vertexGlobalState._attribs[t]._data,s=this._extensions.angle_instanced_arrays;if(s&&e===s.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)return i._divisor;switch(e){case o.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:return i._pointerBuffer;case o.VERTEX_ATTRIB_ARRAY_ENABLED:return i._isPointer;case o.VERTEX_ATTRIB_ARRAY_SIZE:return i._inputSize;case o.VERTEX_ATTRIB_ARRAY_STRIDE:return i._inputStride;case o.VERTEX_ATTRIB_ARRAY_TYPE:return i._pointerType;case o.VERTEX_ATTRIB_ARRAY_NORMALIZED:return i._pointerNormal;case o.CURRENT_VERTEX_ATTRIB:return new Float32Array(n);default:return this.setError(o.INVALID_ENUM),null}}getVertexAttribOffset(t,e){return e|=0,(t|=0)<0||t>=this._vertexObjectState._attribs.length?(this.setError(o.INVALID_VALUE),null):e===o.VERTEX_ATTRIB_ARRAY_POINTER?this._vertexObjectState._attribs[t]._pointerOffset:(this.setError(o.INVALID_ENUM),null)}hint(t,e){if(e|=0,(t|=0)===o.GENERATE_MIPMAP_HINT||this._extensions.oes_standard_derivatives&&t===this._extensions.oes_standard_derivatives.FRAGMENT_SHADER_DERIVATIVE_HINT_OES){if(e===o.FASTEST||e===o.NICEST||e===o.DONT_CARE)return super.hint(t,e);this.setError(o.INVALID_ENUM)}else this.setError(o.INVALID_ENUM)}isBuffer(t){return!!this._isObject(t,"isBuffer",F)&&super.isBuffer(0|t._)}isFramebuffer(t){return!!this._isObject(t,"isFramebuffer",O)&&super.isFramebuffer(0|t._)}isProgram(t){return!!this._isObject(t,"isProgram",N)&&super.isProgram(0|t._)}isRenderbuffer(t){return!!this._isObject(t,"isRenderbuffer",U)&&super.isRenderbuffer(0|t._)}isShader(t){return!!this._isObject(t,"isShader",V)&&super.isShader(0|t._)}isTexture(t){return!!this._isObject(t,"isTexture",W)&&super.isTexture(0|t._)}isEnabled(t){return super.isEnabled(0|t)}lineWidth(t){if(!isNaN(t))return super.lineWidth(+t);this.setError(o.INVALID_VALUE)}linkProgram(t){if(!S(t))throw new TypeError("linkProgram(WebGLProgram)");if(this._checkWrapper(t,N)){t._linkCount+=1,t._attributes=[];const e=this.getError();super.linkProgram(0|t._);const i=this.getError();i===o.NO_ERROR&&(t._linkStatus=this._fixupLink(t)),this.getError(),this.setError(e||i)}}pixelStorei(t,e){if(e|=0,(t|=0)===o.UNPACK_ALIGNMENT){if(1!==e&&2!==e&&4!==e&&8!==e)return void this.setError(o.INVALID_VALUE);this._unpackAlignment=e}else if(t===o.PACK_ALIGNMENT){if(1!==e&&2!==e&&4!==e&&8!==e)return void this.setError(o.INVALID_VALUE);this._packAlignment=e}else if(t===o.UNPACK_COLORSPACE_CONVERSION_WEBGL&&e!==o.NONE&&e!==o.BROWSER_DEFAULT_WEBGL)return void this.setError(o.INVALID_VALUE);return super.pixelStorei(t,e)}polygonOffset(t,e){return super.polygonOffset(+t,+e)}readPixels(t,e,i,n,s,r,a){if(t|=0,e|=0,i|=0,n|=0,this._extensions.oes_texture_float&&r===o.FLOAT&&s===o.RGBA);else{if(s===o.RGB||s===o.ALPHA||r!==o.UNSIGNED_BYTE)return void this.setError(o.INVALID_OPERATION);if(s!==o.RGBA)return void this.setError(o.INVALID_ENUM);if(i<0||n<0||!(a instanceof Uint8Array))return void this.setError(o.INVALID_VALUE)}if(!this._framebufferOk())return;let l=4*i;l%this._packAlignment!=0&&(l+=this._packAlignment-l%this._packAlignment);const h=l*(n-1)+4*i;if(h<=0)return;if(a.length<h)return void this.setError(o.INVALID_VALUE);let c=this.drawingBufferWidth,_=this.drawingBufferHeight;this._activeFramebuffer&&(c=this._activeFramebuffer._width,_=this._activeFramebuffer._height);const u=I(a);if(t>=c||t+i<=0||e>=_||e+n<=0)for(let t=0;t<u.length;++t)u[t]=0;else if(t<0||t+i>c||e<0||e+n>_){for(let t=0;t<u.length;++t)u[t]=0;let o=t,a=i;t<0&&(a+=t,o=0),o+i>c&&(a=c-o);let h=e,d=n;e<0&&(d+=e,h=0),h+n>_&&(d=_-h);let p=4*a;if(p%this._packAlignment!=0&&(p+=this._packAlignment-p%this._packAlignment),a>0&&d>0){const i=new Uint8Array(p*d);super.readPixels(o,h,a,d,s,r,i);const n=4*(o-t)+(h-e)*l;for(let t=0;t<d;++t)for(let e=0;e<a;++e)for(let s=0;s<4;++s)u[n+t*l+4*e+s]=i[t*p+4*e+s]}}else super.readPixels(t,e,i,n,s,r,u)}renderbufferStorage(t,e,i,n){if(e|=0,i|=0,n|=0,(t|=0)!==o.RENDERBUFFER)return void this.setError(o.INVALID_ENUM);const s=this._activeRenderbuffer;if(!s)return void this.setError(o.INVALID_OPERATION);if(e!==o.RGBA4&&e!==o.RGB565&&e!==o.RGB5_A1&&e!==o.DEPTH_COMPONENT16&&e!==o.STENCIL_INDEX&&e!==o.STENCIL_INDEX8&&e!==o.DEPTH_STENCIL)return void this.setError(o.INVALID_ENUM);this._saveError(),super.renderbufferStorage(t,e,i,n);const r=this.getError();if(this._restoreError(r),r!==o.NO_ERROR)return;s._width=i,s._height=n,s._format=e;const a=this._activeFramebuffer;if(a){let t=!1;const e=this._getAttachments();for(let i=0;i<e.length;++i)if(a._attachments[e[i]]===s){t=!0;break}t&&this._updateFramebufferAttachments(this._activeFramebuffer)}}resize(t,e){if(e|=0,!((t|=0)>0&&e>0))throw new Error("Invalid surface dimensions");t===this.drawingBufferWidth&&e===this.drawingBufferHeight||(this._resizeDrawingBuffer(t,e),this.drawingBufferWidth=t,this.drawingBufferHeight=e)}sampleCoverage(t,e){return super.sampleCoverage(+t,!!e)}scissor(t,e,i,n){return super.scissor(0|t,0|e,0|i,0|n)}shaderSource(t,e){if(!S(t))throw new TypeError("shaderSource(WebGLShader, String)");t&&(e||"string"==typeof e)&&C(e+="")?this._checkWrapper(t,V)&&(super.shaderSource(0|t._,this._wrapShader(t._type,e)),t._source=e):this.setError(o.INVALID_VALUE)}stencilFunc(t,e,i){return this._checkStencil=!0,super.stencilFunc(0|t,0|e,0|i)}stencilFuncSeparate(t,e,i,n){return this._checkStencil=!0,super.stencilFuncSeparate(0|t,0|e,0|i,0|n)}stencilMask(t){return this._checkStencil=!0,super.stencilMask(0|t)}stencilMaskSeparate(t,e){return this._checkStencil=!0,super.stencilMaskSeparate(0|t,0|e)}stencilOp(t,e,i){return this._checkStencil=!0,super.stencilOp(0|t,0|e,0|i)}stencilOpSeparate(t,e,i,n){return this._checkStencil=!0,super.stencilOpSeparate(0|t,0|e,0|i,0|n)}texImage2D(t,e,i,n,s,r,a,l,h){if(6===arguments.length){if(l=s,a=n,null==(h=E(h=r)))throw new TypeError("texImage2D(GLenum, GLint, GLenum, GLint, GLenum, GLenum, ImageData | HTMLImageElement | HTMLCanvasElement | HTMLVideoElement)");n=h.width,s=h.height,h=h.data}if(t|=0,e|=0,i|=0,n|=0,s|=0,r|=0,a|=0,l|=0,"object"!=typeof h&&void 0!==h)throw new TypeError("texImage2D(GLenum, GLint, GLenum, GLint, GLint, GLint, GLenum, GLenum, Uint8Array)");if(!L(a)||!L(i))return void this.setError(o.INVALID_ENUM);if(l===o.FLOAT&&!this._extensions.oes_texture_float)return void this.setError(o.INVALID_ENUM);const c=this._getTexImage(t);if(!c||a!==i)return void this.setError(o.INVALID_OPERATION);const _=this._computePixelSize(l,a);if(0===_)return;if(!this._checkDimensions(t,n,s,e))return;const u=P(h),d=this._computeRowStride(n,_)*s;if(u&&u.length<d)return void this.setError(o.INVALID_OPERATION);if(0!==r||D(t)&&n!==s)return void this.setError(o.INVALID_VALUE);this._saveError(),super.texImage2D(t,e,i,n,s,r,a,l,u);const p=this.getError();if(this._restoreError(p),p!==o.NO_ERROR)return;c._levelWidth[e]=n,c._levelHeight[e]=s,c._format=a,c._type=l;const f=this._activeFramebuffer;if(f){let t=!1;const e=this._getAttachments();for(let i=0;i<e.length;++i)if(f._attachments[e[i]]===c){t=!0;break}t&&this._updateFramebufferAttachments(this._activeFramebuffer)}}texSubImage2D(t,e,i,n,s,r,a,l,h){if(7===arguments.length){if(h=a,l=r,a=s,null==(h=E(h)))throw new TypeError("texSubImage2D(GLenum, GLint, GLint, GLint, GLenum, GLenum, ImageData | HTMLImageElement | HTMLCanvasElement | HTMLVideoElement)");s=h.width,r=h.height,h=h.data}if("object"!=typeof h)throw new TypeError("texSubImage2D(GLenum, GLint, GLint, GLint, GLint, GLint, GLenum, GLenum, Uint8Array)");t|=0,e|=0,i|=0,n|=0,s|=0,r|=0,a|=0,l|=0;if(!this._getTexImage(t))return void this.setError(o.INVALID_OPERATION);if(l===o.FLOAT&&!this._extensions.oes_texture_float)return void this.setError(o.INVALID_ENUM);const c=this._computePixelSize(l,a);if(0===c)return;if(!this._checkDimensions(t,s,r,e))return;if(i<0||n<0)return void this.setError(o.INVALID_VALUE);const _=P(h),u=this._computeRowStride(s,c)*r;!_||_.length<u?this.setError(o.INVALID_OPERATION):super.texSubImage2D(t,e,i,n,s,r,a,l,_)}texParameterf(t,e,i){if(t|=0,e|=0,i=+i,this._checkTextureTarget(t)){switch(this._verifyTextureCompleteness(t,e,i),e){case o.TEXTURE_MIN_FILTER:case o.TEXTURE_MAG_FILTER:case o.TEXTURE_WRAP_S:case o.TEXTURE_WRAP_T:return super.texParameterf(t,e,i)}if(this._extensions.ext_texture_filter_anisotropic&&e===this._extensions.ext_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT)return super.texParameterf(t,e,i);this.setError(o.INVALID_ENUM)}}texParameteri(t,e,i){if(t|=0,e|=0,i|=0,this._checkTextureTarget(t)){switch(this._verifyTextureCompleteness(t,e,i),e){case o.TEXTURE_MIN_FILTER:case o.TEXTURE_MAG_FILTER:case o.TEXTURE_WRAP_S:case o.TEXTURE_WRAP_T:return super.texParameteri(t,e,i)}if(this._extensions.ext_texture_filter_anisotropic&&e===this._extensions.ext_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT)return super.texParameteri(t,e,i);this.setError(o.INVALID_ENUM)}}useProgram(t){if(!S(t))throw new TypeError("useProgram(WebGLProgram)");return t?this._checkWrapper(t,N)?(this._activeProgram!==t&&(this._switchActiveProgram(this._activeProgram),this._activeProgram=t,t._refCount+=1),super.useProgram(0|t._)):void 0:(this._switchActiveProgram(this._activeProgram),this._activeProgram=null,super.useProgram(0))}validateProgram(t){if(this._checkWrapper(t,N)){super.validateProgram(0|t._);const e=this.getError();e===o.NO_ERROR&&(t._linkInfoLog=super.getProgramInfoLog(0|t._)),this.getError(),this.setError(e)}}vertexAttribPointer(t,e,i,n,s,r){if(s<0||r<0)return void this.setError(o.INVALID_VALUE);if(t|=0,e|=0,i|=0,n=!!n,r|=0,(s|=0)<0||r<0||t<0||t>=this._vertexObjectState._attribs.length||1!==e&&2!==e&&3!==e&&4!==e)return void this.setError(o.INVALID_VALUE);if(null===this._vertexGlobalState._arrayBufferBinding)return void this.setError(o.INVALID_OPERATION);const a=T(i);0!==a&&i!==o.INT&&i!==o.UNSIGNED_INT?s>255||s<0?this.setError(o.INVALID_VALUE):s%a==0&&r%a==0?(super.vertexAttribPointer(t,e,i,n,s,r),this._vertexObjectState.setVertexAttribPointer(this._vertexGlobalState._arrayBufferBinding,t,e*a,r,s||e*a,i,n,s,e)):this.setError(o.INVALID_OPERATION):this.setError(o.INVALID_ENUM)}viewport(t,e,i,n){return super.viewport(0|t,0|e,0|i,0|n)}_allocateDrawingBuffer(t,e){this._drawingBuffer=new B(super.createFramebuffer(),super.createTexture(),super.createRenderbuffer()),this._resizeDrawingBuffer(t,e)}isContextLost(){return!1}compressedTexImage2D(){}compressedTexSubImage2D(){}_checkUniformValid(t,e,i,n,s){if(!S(t))throw new TypeError(i+"(WebGLUniformLocation, ...)");if(!t)return!1;if(this._checkLocationActive(t)){const i=t._activeInfo.type;if(i===o.SAMPLER_2D||i===o.SAMPLER_CUBE){if(1!==n)return void this.setError(o.INVALID_VALUE);if("i"!==s)return void this.setError(o.INVALID_OPERATION);if(e<0||e>=this._textureUnits.length)return this.setError(o.INVALID_VALUE),!1}return!(A(i)>n)||(this.setError(o.INVALID_OPERATION),!1)}return!1}_checkUniformValueValid(t,e,i,n,s){if(!S(t)||!S(e))throw new TypeError(i+"v(WebGLUniformLocation, Array)");if(!t)return!1;if(!this._checkLocationActive(t))return!1;if("object"!=typeof e||!e||"number"!=typeof e.length)throw new TypeError(`Second argument to ${i} must be array`);return A(t._activeInfo.type)>n?(this.setError(o.INVALID_OPERATION),!1):e.length>=n&&e.length%n==0?!!t._array||(e.length===n||(this.setError(o.INVALID_OPERATION),!1)):(this.setError(o.INVALID_VALUE),!1)}uniform1f(t,e){this._checkUniformValid(t,e,"uniform1f",1,"f")&&super.uniform1f(0|t._,e)}uniform1fv(t,e){if(this._checkUniformValueValid(t,e,"uniform1fv",1,"f"))if(t._array){const i=t._array;for(let t=0;t<i.length&&t<e.length;++t){const n=i[t];super.uniform1f(n,e[t])}}else super.uniform1f(0|t._,e[0])}uniform1i(t,e){this._checkUniformValid(t,e,"uniform1i",1,"i")&&super.uniform1i(0|t._,e)}uniform1iv(t,e){if(this._checkUniformValueValid(t,e,"uniform1iv",1,"i"))if(t._array){const i=t._array;for(let t=0;t<i.length&&t<e.length;++t){const n=i[t];super.uniform1i(n,e[t])}}else this.uniform1i(t,e[0])}uniform2f(t,e,i){this._checkUniformValid(t,e,"uniform2f",2,"f")&&super.uniform2f(0|t._,e,i)}uniform2fv(t,e){if(this._checkUniformValueValid(t,e,"uniform2fv",2,"f"))if(t._array){const i=t._array;for(let t=0;t<i.length&&2*t<e.length;++t){const n=i[t];super.uniform2f(n,e[2*t],e[2*t+1])}}else super.uniform2f(0|t._,e[0],e[1])}uniform2i(t,e,i){this._checkUniformValid(t,e,"uniform2i",2,"i")&&super.uniform2i(0|t._,e,i)}uniform2iv(t,e){if(this._checkUniformValueValid(t,e,"uniform2iv",2,"i"))if(t._array){const i=t._array;for(let t=0;t<i.length&&2*t<e.length;++t){const n=i[t];super.uniform2i(n,e[2*t],e[2*t+1])}}else this.uniform2i(t,e[0],e[1])}uniform3f(t,e,i,n){this._checkUniformValid(t,e,"uniform3f",3,"f")&&super.uniform3f(0|t._,e,i,n)}uniform3fv(t,e){if(this._checkUniformValueValid(t,e,"uniform3fv",3,"f"))if(t._array){const i=t._array;for(let t=0;t<i.length&&3*t<e.length;++t){const n=i[t];super.uniform3f(n,e[3*t],e[3*t+1],e[3*t+2])}}else super.uniform3f(0|t._,e[0],e[1],e[2])}uniform3i(t,e,i,n){this._checkUniformValid(t,e,"uniform3i",3,"i")&&super.uniform3i(0|t._,e,i,n)}uniform3iv(t,e){if(this._checkUniformValueValid(t,e,"uniform3iv",3,"i"))if(t._array){const i=t._array;for(let t=0;t<i.length&&3*t<e.length;++t){const n=i[t];super.uniform3i(n,e[3*t],e[3*t+1],e[3*t+2])}}else this.uniform3i(t,e[0],e[1],e[2])}uniform4f(t,e,i,n,s){this._checkUniformValid(t,e,"uniform4f",4,"f")&&super.uniform4f(0|t._,e,i,n,s)}uniform4fv(t,e){if(this._checkUniformValueValid(t,e,"uniform4fv",4,"f"))if(t._array){const i=t._array;for(let t=0;t<i.length&&4*t<e.length;++t){const n=i[t];super.uniform4f(n,e[4*t],e[4*t+1],e[4*t+2],e[4*t+3])}}else super.uniform4f(0|t._,e[0],e[1],e[2],e[3])}uniform4i(t,e,i,n,s){this._checkUniformValid(t,e,"uniform4i",4,"i")&&super.uniform4i(0|t._,e,i,n,s)}uniform4iv(t,e){if(this._checkUniformValueValid(t,e,"uniform4iv",4,"i"))if(t._array){const i=t._array;for(let t=0;t<i.length&&4*t<e.length;++t){const n=i[t];super.uniform4i(n,e[4*t],e[4*t+1],e[4*t+2],e[4*t+3])}}else this.uniform4i(t,e[0],e[1],e[2],e[3])}_checkUniformMatrix(t,e,i,n,s){if(!S(t)||"object"!=typeof i)throw new TypeError(n+"(WebGLUniformLocation, Boolean, Array)");return e||"object"!=typeof i||null===i||!i.length||i.length%s*s!=0?(this.setError(o.INVALID_VALUE),!1):!!t&&(!!this._checkLocationActive(t)&&(i.length===s*s||(!!t._array||(this.setError(o.INVALID_VALUE),!1))))}uniformMatrix2fv(t,e,i){if(!this._checkUniformMatrix(t,e,i,"uniformMatrix2fv",2))return;const n=new Float32Array(i);super.uniformMatrix2fv(0|t._,!!e,n)}uniformMatrix3fv(t,e,i){if(!this._checkUniformMatrix(t,e,i,"uniformMatrix3fv",3))return;const n=new Float32Array(i);super.uniformMatrix3fv(0|t._,!!e,n)}uniformMatrix4fv(t,e,i){if(!this._checkUniformMatrix(t,e,i,"uniformMatrix4fv",4))return;const n=new Float32Array(i);super.uniformMatrix4fv(0|t._,!!e,n)}vertexAttrib1f(t,e){if(t|=0,!this._checkVertexIndex(t))return;const i=this._vertexGlobalState._attribs[t]._data;return i[3]=1,i[1]=i[2]=0,i[0]=e,super.vertexAttrib1f(0|t,+e)}vertexAttrib2f(t,e,i){if(t|=0,!this._checkVertexIndex(t))return;const n=this._vertexGlobalState._attribs[t]._data;return n[3]=1,n[2]=0,n[1]=i,n[0]=e,super.vertexAttrib2f(0|t,+e,+i)}vertexAttrib3f(t,e,i,n){if(t|=0,!this._checkVertexIndex(t))return;const s=this._vertexGlobalState._attribs[t]._data;return s[3]=1,s[2]=n,s[1]=i,s[0]=e,super.vertexAttrib3f(0|t,+e,+i,+n)}vertexAttrib4f(t,e,i,n,s){if(t|=0,!this._checkVertexIndex(t))return;const r=this._vertexGlobalState._attribs[t]._data;return r[3]=s,r[2]=n,r[1]=i,r[0]=e,super.vertexAttrib4f(0|t,+e,+i,+n,+s)}vertexAttrib1fv(t,e){if("object"!=typeof e||null===e||e.length<1)return void this.setError(o.INVALID_OPERATION);const i=this._vertexGlobalState._attribs[t]._data;return i[3]=1,i[2]=0,i[1]=0,i[0]=e[0],super.vertexAttrib1f(0|t,+e[0])}vertexAttrib2fv(t,e){if("object"!=typeof e||null===e||e.length<2)return void this.setError(o.INVALID_OPERATION);const i=this._vertexGlobalState._attribs[t]._data;return i[3]=1,i[2]=0,i[1]=e[1],i[0]=e[0],super.vertexAttrib2f(0|t,+e[0],+e[1])}vertexAttrib3fv(t,e){if("object"!=typeof e||null===e||e.length<3)return void this.setError(o.INVALID_OPERATION);const i=this._vertexGlobalState._attribs[t]._data;return i[3]=1,i[2]=e[2],i[1]=e[1],i[0]=e[0],super.vertexAttrib3f(0|t,+e[0],+e[1],+e[2])}vertexAttrib4fv(t,e){if("object"!=typeof e||null===e||e.length<4)return void this.setError(o.INVALID_OPERATION);const i=this._vertexGlobalState._attribs[t]._data;return i[3]=e[3],i[2]=e[2],i[1]=e[1],i[0]=e[0],super.vertexAttrib4f(0|t,+e[0],+e[1],+e[2],+e[3])}}t.exports={WebGLRenderingContext:q,wrapContext:function(t){const e=new q;return v(Object.keys(t),e,t,Y),v(Object.keys(t.constructor.prototype),e,t,Y),v(Object.getOwnPropertyNames(t),e,t,Y),v(Object.getOwnPropertyNames(t.constructor.prototype),e,t,Y),Object.defineProperties(e,{drawingBufferWidth:{get:()=>t.drawingBufferWidth,set(e){t.drawingBufferWidth=e}},drawingBufferHeight:{get:()=>t.drawingBufferHeight,set(e){t.drawingBufferHeight=e}}}),e}}},function(t,e,i){(function(e){const{gl:n}=i(0),{WebGLUniformLocation:s}=i(29);function r(t){return new Uint8Array(t.buffer).subarray(t.byteOffset,t.byteLength+t.byteOffset)}t.exports={bindPublics:function(t,e,i,n){for(let s=0;s<t.length;s++){const r=t[s],o=i[r];if("function"==typeof o)-1===n.indexOf(r)&&(e[r]=o.bind(i));else{if("_"===r[0]||"0"===r[0]||"1"===r[0])continue;e[r]=o}}},checkObject:function(t){return"object"==typeof t||void 0===t},isTypedArray:function(t){return t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Uint32Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array},isValidString:function(t){const e=t.replace(/(?:\/\*(?:[\s\S]*?)\*\/)|(?:([\s;])+\/\/(?:.*)$)/gm,"");return!/["$`@\\'\0]/.test(e)},vertexCount:function(t,e){switch(t){case n.TRIANGLES:return e-e%3;case n.LINES:return e-e%2;case n.LINE_LOOP:case n.POINTS:return e;case n.TRIANGLE_FAN:case n.LINE_STRIP:return e<2?0:e;case n.TRIANGLE_STRIP:return e<3?0:e;default:return-1}},typeSize:function(t){switch(t){case n.UNSIGNED_BYTE:case n.BYTE:return 1;case n.UNSIGNED_SHORT:case n.SHORT:return 2;case n.UNSIGNED_INT:case n.INT:case n.FLOAT:return 4}return 0},uniformTypeSize:function(t){switch(t){case n.BOOL_VEC4:case n.INT_VEC4:case n.FLOAT_VEC4:return 4;case n.BOOL_VEC3:case n.INT_VEC3:case n.FLOAT_VEC3:return 3;case n.BOOL_VEC2:case n.INT_VEC2:case n.FLOAT_VEC2:return 2;case n.BOOL:case n.INT:case n.FLOAT:case n.SAMPLER_2D:case n.SAMPLER_CUBE:return 1;default:return 0}},unpackTypedArray:r,extractImageData:function(t){if("object"==typeof t&&void 0!==t.width&&void 0!==t.height){if(void 0!==t.data)return t;let e=null;if("function"==typeof t.getContext)e=t.getContext("2d");else if(void 0!==t.src&&"object"==typeof document&&"function"==typeof document.createElement){const i=document.createElement("canvas");"object"==typeof i&&"function"==typeof i.getContext&&(e=i.getContext("2d"),null!==e&&e.drawImage(t,0,0))}if(null!==e)return e.getImageData(0,0,t.width,t.height)}return null},formatSize:function(t){switch(t){case n.ALPHA:case n.LUMINANCE:return 1;case n.LUMINANCE_ALPHA:return 2;case n.RGB:return 3;case n.RGBA:return 4}return 0},checkFormat:function(t){return t===n.ALPHA||t===n.LUMINANCE_ALPHA||t===n.LUMINANCE||t===n.RGB||t===n.RGBA},checkUniform:function(t,e){return e instanceof s&&e._program===t&&e._linkCount===t._linkCount},convertPixels:function(t){if("object"==typeof t&&null!==t){if(t instanceof ArrayBuffer)return new Uint8Array(t);if(t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint8ClampedArray||t instanceof Float32Array)return r(t);if(t instanceof e)return new Uint8Array(t)}return null},validCubeTarget:function(t){return t===n.TEXTURE_CUBE_MAP_POSITIVE_X||t===n.TEXTURE_CUBE_MAP_NEGATIVE_X||t===n.TEXTURE_CUBE_MAP_POSITIVE_Y||t===n.TEXTURE_CUBE_MAP_NEGATIVE_Y||t===n.TEXTURE_CUBE_MAP_POSITIVE_Z||t===n.TEXTURE_CUBE_MAP_NEGATIVE_Z}}}).call(this,i(27).Buffer)},,function(t,e){},,,function(t,e){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var n=new Uint8Array(16);t.exports=function(){return i(n),n}}else{var s=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),s[e]=t>>>((3&e)<<3)&255;return s}}},function(t,e){for(var i=[],n=0;n<256;++n)i[n]=(n+256).toString(16).substr(1);t.exports=function(t,e){var n=e||0,s=i;return[s[t[n++]],s[t[n++]],s[t[n++]],s[t[n++]],"-",s[t[n++]],s[t[n++]],"-",s[t[n++]],s[t[n++]],"-",s[t[n++]],s[t[n++]],"-",s[t[n++]],s[t[n++]],s[t[n++]],s[t[n++]],s[t[n++]],s[t[n++]]].join("")}},function(t,e,i){"use strict";function n(t){var e=32;return(t&=-t)&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}e.INT_BITS=32,e.INT_MAX=2147483647,e.INT_MIN=-1<<31,e.sign=function(t){return(t>0)-(t<0)},e.abs=function(t){var e=t>>31;return(t^e)-e},e.min=function(t,e){return e^(t^e)&-(t<e)},e.max=function(t,e){return t^(t^e)&-(t<e)},e.isPow2=function(t){return!(t&t-1||!t)},e.log2=function(t){var e,i;return e=(t>65535)<<4,e|=i=((t>>>=e)>255)<<3,e|=i=((t>>>=i)>15)<<2,(e|=i=((t>>>=i)>3)<<1)|(t>>>=i)>>1},e.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},e.popCount=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},e.countTrailingZeros=n,e.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1},e.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},e.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var s=new Array(256);!function(t){for(var e=0;e<256;++e){var i=e,n=e,s=7;for(i>>>=1;i;i>>>=1)n<<=1,n|=1&i,--s;t[e]=n<<s&255}}(s),e.reverse=function(t){return s[255&t]<<24|s[t>>>8&255]<<16|s[t>>>16&255]<<8|s[t>>>24&255]},e.interleave2=function(t,e){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))<<1},e.deinterleave2=function(t,e){return(t=65535&((t=16711935&((t=252645135&((t=858993459&((t=t>>>e&1431655765)|t>>>1))|t>>>2))|t>>>4))|t>>>16))<<16>>16},e.interleave3=function(t,e,i){return t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2),(t|=(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<1)|(i=1227133513&((i=3272356035&((i=251719695&((i=4278190335&((i&=1023)|i<<16))|i<<8))|i<<4))|i<<2))<<2},e.deinterleave3=function(t,e){return(t=1023&((t=4278190335&((t=251719695&((t=3272356035&((t=t>>>e&1227133513)|t>>>2))|t>>>4))|t>>>8))|t>>>16))<<22>>22},e.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>n(t)+1}},function(t,e){t.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},function(t,e){t.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},function(t,e,i){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var n=i(61),s=i(62),r=i(63);function o(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,i){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return _(this,t)}return h(this,t,e,i)}function h(t,e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,i,n){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===i&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,i):new Uint8Array(e,i,n);l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=u(t,e);return t}(t,e,i,n):"string"==typeof e?function(t,e,i){"string"==typeof i&&""!==i||(i="utf8");if(!l.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(e,i),s=(t=a(t,n)).write(e,i);s!==n&&(t=t.slice(0,s));return t}(t,e,i):function(t,e){if(l.isBuffer(e)){var i=0|d(e.length);return 0===(t=a(t,i)).length||e.copy(t,0,0,i),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?a(t,0):u(t,e);if("Buffer"===e.type&&r(e.data))return u(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function _(t,e){if(c(e),t=a(t,e<0?0:0|d(e)),!l.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function u(t,e){var i=e.length<0?0:0|d(e.length);t=a(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}function d(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return z(t).length;default:if(n)return V(t).length;e=(""+e).toLowerCase(),n=!0}}function f(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,i);case"utf8":case"utf-8":return A(this,e,i);case"ascii":return E(this,e,i);case"latin1":case"binary":return M(this,e,i);case"base64":return T(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function m(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function g(t,e,i,n,s){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=s?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(s)return-1;i=t.length-1}else if(i<0){if(!s)return-1;i=0}if("string"==typeof e&&(e=l.from(e,n)),l.isBuffer(e))return 0===e.length?-1:b(t,e,i,n,s);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):b(t,[e],i,n,s);throw new TypeError("val must be string, number or Buffer")}function b(t,e,i,n,s){var r,o=1,a=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,a/=2,l/=2,i/=2}function h(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(s){var c=-1;for(r=i;r<a;r++)if(h(t,r)===h(e,-1===c?0:r-c)){if(-1===c&&(c=r),r-c+1===l)return c*o}else-1!==c&&(r-=r-c),c=-1}else for(i+l>a&&(i=a-l),r=i;r>=0;r--){for(var _=!0,u=0;u<l;u++)if(h(t,r+u)!==h(e,u)){_=!1;break}if(_)return r}return-1}function y(t,e,i,n){i=Number(i)||0;var s=t.length-i;n?(n=Number(n))>s&&(n=s):n=s;var r=e.length;if(r%2!=0)throw new TypeError("Invalid hex string");n>r/2&&(n=r/2);for(var o=0;o<n;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[i+o]=a}return o}function v(t,e,i,n){return W(V(e,t.length-i),t,i,n)}function S(t,e,i,n){return W(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function x(t,e,i,n){return S(t,e,i,n)}function w(t,e,i,n){return W(z(e),t,i,n)}function C(t,e,i,n){return W(function(t,e){for(var i,n,s,r=[],o=0;o<t.length&&!((e-=2)<0);++o)i=t.charCodeAt(o),n=i>>8,s=i%256,r.push(s),r.push(n);return r}(e,t.length-i),t,i,n)}function T(t,e,i){return 0===e&&i===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,i))}function A(t,e,i){i=Math.min(t.length,i);for(var n=[],s=e;s<i;){var r,o,a,l,h=t[s],c=null,_=h>239?4:h>223?3:h>191?2:1;if(s+_<=i)switch(_){case 1:h<128&&(c=h);break;case 2:128==(192&(r=t[s+1]))&&(l=(31&h)<<6|63&r)>127&&(c=l);break;case 3:r=t[s+1],o=t[s+2],128==(192&r)&&128==(192&o)&&(l=(15&h)<<12|(63&r)<<6|63&o)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:r=t[s+1],o=t[s+2],a=t[s+3],128==(192&r)&&128==(192&o)&&128==(192&a)&&(l=(15&h)<<18|(63&r)<<12|(63&o)<<6|63&a)>65535&&l<1114112&&(c=l)}null===c?(c=65533,_=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),s+=_}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var i="",n=0;for(;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=4096));return i}(n)}e.Buffer=l,e.SlowBuffer=function(t){+t!=t&&(t=0);return l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,i){return h(null,t,e,i)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,i){return function(t,e,i,n){return c(e),e<=0?a(t,e):void 0!==i?"string"==typeof n?a(t,e).fill(i,n):a(t,e).fill(i):a(t,e)}(null,t,e,i)},l.allocUnsafe=function(t){return _(null,t)},l.allocUnsafeSlow=function(t){return _(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,s=0,r=Math.min(i,n);s<r;++s)if(t[s]!==e[s]){i=t[s],n=e[s];break}return i<n?-1:n<i?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!r(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=l.allocUnsafe(e),s=0;for(i=0;i<t.length;++i){var o=t[i];if(!l.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,s),s+=o.length}return n},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?A(this,0,t):f.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",i=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,i,n,s){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===s&&(s=this.length),e<0||i>t.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&e>=i)return 0;if(n>=s)return-1;if(e>=i)return 1;if(this===t)return 0;for(var r=(s>>>=0)-(n>>>=0),o=(i>>>=0)-(e>>>=0),a=Math.min(r,o),h=this.slice(n,s),c=t.slice(e,i),_=0;_<a;++_)if(h[_]!==c[_]){r=h[_],o=c[_];break}return r<o?-1:o<r?1:0},l.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},l.prototype.indexOf=function(t,e,i){return g(this,t,e,i,!0)},l.prototype.lastIndexOf=function(t,e,i){return g(this,t,e,i,!1)},l.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var s=this.length-e;if((void 0===i||i>s)&&(i=s),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var r=!1;;)switch(n){case"hex":return y(this,t,e,i);case"utf8":case"utf-8":return v(this,t,e,i);case"ascii":return S(this,t,e,i);case"latin1":case"binary":return x(this,t,e,i);case"base64":return w(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,e,i);default:if(r)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),r=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function E(t,e,i){var n="";i=Math.min(t.length,i);for(var s=e;s<i;++s)n+=String.fromCharCode(127&t[s]);return n}function M(t,e,i){var n="";i=Math.min(t.length,i);for(var s=e;s<i;++s)n+=String.fromCharCode(t[s]);return n}function R(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var s="",r=e;r<i;++r)s+=U(t[r]);return s}function I(t,e,i){for(var n=t.slice(e,i),s="",r=0;r<n.length;r+=2)s+=String.fromCharCode(n[r]+256*n[r+1]);return s}function P(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function L(t,e,i,n,s,r){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>s||e<r)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function D(t,e,i,n){e<0&&(e=65535+e+1);for(var s=0,r=Math.min(t.length-i,2);s<r;++s)t[i+s]=(e&255<<8*(n?s:1-s))>>>8*(n?s:1-s)}function k(t,e,i,n){e<0&&(e=4294967295+e+1);for(var s=0,r=Math.min(t.length-i,4);s<r;++s)t[i+s]=e>>>8*(n?s:3-s)&255}function O(t,e,i,n,s,r){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function F(t,e,i,n,r){return r||O(t,0,i,4),s.write(t,e,i,n,23,4),i+4}function B(t,e,i,n,r){return r||O(t,0,i,8),s.write(t,e,i,n,52,8),i+8}l.prototype.slice=function(t,e){var i,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=l.prototype;else{var s=e-t;i=new l(s,void 0);for(var r=0;r<s;++r)i[r]=this[r+t]}return i},l.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=this[t],s=1,r=0;++r<e&&(s*=256);)n+=this[t+r]*s;return n},l.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=this[t+--e],s=1;e>0&&(s*=256);)n+=this[t+--e]*s;return n},l.prototype.readUInt8=function(t,e){return e||P(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||P(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||P(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||P(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||P(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=this[t],s=1,r=0;++r<e&&(s*=256);)n+=this[t+r]*s;return n>=(s*=128)&&(n-=Math.pow(2,8*e)),n},l.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=e,s=1,r=this[t+--n];n>0&&(s*=256);)r+=this[t+--n]*s;return r>=(s*=128)&&(r-=Math.pow(2,8*e)),r},l.prototype.readInt8=function(t,e){return e||P(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||P(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt16BE=function(t,e){e||P(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt32LE=function(t,e){return e||P(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||P(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||P(t,4,this.length),s.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||P(t,4,this.length),s.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||P(t,8,this.length),s.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||P(t,8,this.length),s.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||L(this,t,e,i,Math.pow(2,8*i)-1,0);var s=1,r=0;for(this[e]=255&t;++r<i&&(s*=256);)this[e+r]=t/s&255;return e+i},l.prototype.writeUIntBE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||L(this,t,e,i,Math.pow(2,8*i)-1,0);var s=i-1,r=1;for(this[e+s]=255&t;--s>=0&&(r*=256);)this[e+s]=t/r&255;return e+i},l.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):k(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e|=0,!n){var s=Math.pow(2,8*i-1);L(this,t,e,i,s-1,-s)}var r=0,o=1,a=0;for(this[e]=255&t;++r<i&&(o*=256);)t<0&&0===a&&0!==this[e+r-1]&&(a=1),this[e+r]=(t/o>>0)-a&255;return e+i},l.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e|=0,!n){var s=Math.pow(2,8*i-1);L(this,t,e,i,s-1,-s)}var r=i-1,o=1,a=0;for(this[e+r]=255&t;--r>=0&&(o*=256);)t<0&&0===a&&0!==this[e+r+1]&&(a=1),this[e+r]=(t/o>>0)-a&255;return e+i},l.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):k(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,i){return F(this,t,e,!0,i)},l.prototype.writeFloatBE=function(t,e,i){return F(this,t,e,!1,i)},l.prototype.writeDoubleLE=function(t,e,i){return B(this,t,e,!0,i)},l.prototype.writeDoubleBE=function(t,e,i){return B(this,t,e,!1,i)},l.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var s,r=n-i;if(this===t&&i<e&&e<n)for(s=r-1;s>=0;--s)t[s+e]=this[s+i];else if(r<1e3||!l.TYPED_ARRAY_SUPPORT)for(s=0;s<r;++s)t[s+e]=this[s+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+r),e);return r},l.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var s=t.charCodeAt(0);s<256&&(t=s)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var r;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(r=e;r<i;++r)this[r]=t;else{var o=l.isBuffer(t)?t:V(new l(t,n).toString()),a=o.length;for(r=0;r<i-e;++r)this[r+e]=o[r%a]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function U(t){return t<16?"0"+t.toString(16):t.toString(16)}function V(t,e){var i;e=e||1/0;for(var n=t.length,s=null,r=[],o=0;o<n;++o){if((i=t.charCodeAt(o))>55295&&i<57344){if(!s){if(i>56319){(e-=3)>-1&&r.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&r.push(239,191,189);continue}s=i;continue}if(i<56320){(e-=3)>-1&&r.push(239,191,189),s=i;continue}i=65536+(s-55296<<10|i-56320)}else s&&(e-=3)>-1&&r.push(239,191,189);if(s=null,i<128){if((e-=1)<0)break;r.push(i)}else if(i<2048){if((e-=2)<0)break;r.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;r.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;r.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return r}function z(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(N,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function W(t,e,i,n){for(var s=0;s<n&&!(s+i>=e.length||s>=t.length);++s)e[s+i]=t[s];return s}}).call(this,i(28))},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e){t.exports={WebGLUniformLocation:class{constructor(t,e,i){this._=t,this._program=e,this._linkCount=e._linkCount,this._activeInfo=i,this._array=null}}}},function(t,e,i){const{gl:n}=i(0),{WebGLBuffer:s}=i(31);class r{constructor(t,e){this._ctx=t,this._idx=e,this._clear()}_clear(){this._isPointer=!1,this._pointerBuffer=null,this._pointerOffset=0,this._pointerSize=0,this._pointerStride=0,this._pointerType=n.FLOAT,this._pointerNormal=!1,this._divisor=0,this._inputSize=4,this._inputStride=0}}class o{constructor(t){this._idx=t,this._data=new Float32Array([0,0,0,1])}}t.exports={WebGLVertexArrayObjectAttribute:r,WebGLVertexArrayGlobalAttribute:o,WebGLVertexArrayObjectState:class{constructor(t){const e=t.getParameter(t.MAX_VERTEX_ATTRIBS);this._attribs=new Array(e);for(let i=0;i<e;++i)this._attribs[i]=new r(t,i);this._elementArrayBufferBinding=null}setElementArrayBuffer(t){if(null!==t&&!(t instanceof s))throw new TypeError("setElementArrayBuffer(WebGLBuffer?)");const e=this._elementArrayBufferBinding;e!==t&&(e&&(e._refCount-=1,e._checkDelete()),t&&(t._refCount+=1),this._elementArrayBufferBinding=t)}cleanUp(){const t=this._elementArrayBufferBinding;t&&(t._refCount-=1,t._checkDelete(),this._elementArrayBufferBinding=null);for(let t=0;t<this._attribs.length;++t){const e=this._attribs[t];e._pointerBuffer&&(e._pointerBuffer._refCount-=1,e._pointerBuffer._checkDelete()),e._clear()}}releaseArrayBuffer(t){if(t)for(let e=0;e<this._attribs.length;++e){const i=this._attribs[e];i._pointerBuffer===t&&(i._pointerBuffer._refCount-=1,i._pointerBuffer._checkDelete(),i._clear())}}setVertexAttribPointer(t,e,i,n,s,r,o,a,l){const h=this._attribs[e];t!==h._pointerBuffer&&(h._pointerBuffer&&(h._pointerBuffer._refCount-=1,h._pointerBuffer._checkDelete()),t&&(t._refCount+=1),h._pointerBuffer=t),h._pointerSize=i,h._pointerOffset=n,h._pointerStride=s,h._pointerType=r,h._pointerNormal=o,h._inputStride=a,h._inputSize=l}},WebGLVertexArrayGlobalState:class{constructor(t){const e=t.getParameter(t.MAX_VERTEX_ATTRIBS);this._attribs=new Array(e);for(let t=0;t<e;++t)this._attribs[t]=new o(t);this._arrayBufferBinding=null}setArrayBuffer(t){if(null!==t&&!(t instanceof s))throw new TypeError("setArrayBuffer(WebGLBuffer?)");const e=this._arrayBufferBinding;e!==t&&(e&&(e._refCount-=1,e._checkDelete()),t&&(t._refCount+=1),this._arrayBufferBinding=t)}}}},function(t,e,i){const{Linkable:n}=i(7),{gl:s}=i(0);t.exports={WebGLBuffer:class extends n{constructor(t,e){super(t),this._ctx=e,this._size=0,this._elements=new Uint8Array(0)}_performDelete(){const t=this._ctx;delete t._buffers[0|this._],s.deleteBuffer.call(t,0|this._)}}}},function(t,e,i){const{Canvas:n,Image:s}=i(15),r=i(82),o=i(83),a=Symbol("ctx");function l(t,e){const{width:i,height:n}=e,s=e[a],r=s.getImageData(0,0,i,n),o=new Uint8Array(i*n*4);t.readPixels(0,0,i,n,t.RGBA,t.UNSIGNED_BYTE,o);for(let t=0;t<n;t++)for(let e=0;e<i;e++){const s=e,a=n-t-1;for(let e=0;e<4;e++){const n=4*(a*i+s)+e,l=4*(t*i+s)+e;r.data[n]=o[l]}}return s.putImageData(r,0,0),s}t.exports=class extends n{constructor(...t){super(...t),this.__event__=new r,this.__attributes__={},this.style={}}get width(){return super.width}set width(t){if(this.__gl__){this.__gl__.getExtension("STACKGL_resize_drawingbuffer").resize(t,this.height)}super.width=t}get height(){return super.height}set height(t){if(this.__gl__){this.__gl__.getExtension("STACKGL_resize_drawingbuffer").resize(this.width,t)}super.height=t}get clientWidth(){return super.width}get clientHeight(){return super.height}get __ctx__(){const t=this.__gl__;return t&&l(t,this),this[a]}getContext(t,e){if(this.__contextType__&&this.__contextType__!==t)return null;if(this.__gl__)return this.__gl__;if(this.__contextType__=t,"webgl"===t||"webgl2"===t){const{width:t,height:i}=this;this[a]=super.getContext("2d",e);const r=o(t,i,e),l=r.getUniformLocation;r.getUniformLocation=function(t,e){if(t._uniforms&&!/\[\d+\]$/.test(e)){const i=new RegExp(e+"\\[\\d+\\]$");for(let n=0;n<t._uniforms.length;n++){const s=t._uniforms[n].name;i.test(s)&&(e=s)}}return l.call(this,t,e)},r.canvas=this;const h=r.texImage2D;return r.texImage2D=function(...t){let e=t[t.length-1];if(e._image&&(e=e._image),e instanceof s){const i=new n(e.width,e.height);i.getContext("2d").drawImage(e,0,0),t[t.length-1]=i}return h.apply(this,t)},this.__gl__=r,this.__gl__}return super.getContext(t,e)}toBuffer(...t){const e=this.__gl__;return e&&l(e,this),super.toBuffer(...t)}toDataURL(...t){const e=this.__gl__;return e&&l(e,this),super.toDataURL(...t)}createPNGStream(...t){const e=this.__gl__;return e&&l(e,this),super.createPNGStream(...t)}createJPEGStream(...t){const e=this.__gl__;return e&&l(e,this),super.createJPEGStream(...t)}createPDFStream(...t){const e=this.__gl__;return e&&l(e,this),super.createPDFStream(...t)}addEventListener(t,e){return this.__event__.addListener(t,e)}removeEventListener(t,e){return e?this.__event__.removeListener(t,e):this.removeAllListeners(t)}dispatchEvent(t){return t.target=this,this.emit(t.type,t)}setAttribute(t,e){this.__attributes__[t]=e}getAttribute(t){return this.__attributes__[t]}removeAttribute(t){delete this.__attributes__[t]}}},,function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return u}));var n=i(8),s=i(9),r=i.n(s),o=i(13),a=i.n(o),l=i(3),h=i(4),c=i(5);const _="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class u extends n.a{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,i=_?{}:Object(l.b)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=h.d&&!_?e?new h.a(t,e):new h.a(t):new h.a(t,e,i)}catch(t){return this.emit("error",t)}this.ws.binaryType=this.socket.binaryType||h.b,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(e){this.writable=!1;for(let i=0;i<e.length;i++){const n=e[i],s=i===e.length-1;Object(c.c)(n,this.supportsBinary,e=>{const i={};if(!h.d&&(n.options&&(i.compress=n.options.compress),this.opts.perMessageDeflate)){("string"==typeof e?t.byteLength(e):e.length)<this.opts.perMessageDeflate.threshold&&(i.compress=!1)}try{h.d?this.ws.send(e):this.ws.send(e,i)}catch(t){}s&&Object(h.c)(()=>{this.writable=!0,this.emit("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let i="";this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(i=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=a()()),this.supportsBinary||(t.b64=1);const n=r.a.encode(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(n.length?"?"+n:"")}check(){return!(!h.a||"__initialize"in h.a&&this.name===u.prototype.name)}}}).call(this,i(27).Buffer)},function(t,e){function i(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=i,i.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-i:t+i}return 0|Math.min(t,this.max)},i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(t){this.ms=t},i.prototype.setMax=function(t){this.max=t},i.prototype.setJitter=function(t){this.jitter=t}},,,,function(t,e,i){(function(n,s){var r,o;void 0===(o="function"==typeof(r=function(){var e=function(r){(r=r||{})||(r=(void 0!==e?e:null)||{});var o={};for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a]);var l,h,c=!1,_=!1,u=!1,d=!1;if(r.ENVIRONMENT)if("WEB"===r.ENVIRONMENT)c=!0;else if("WORKER"===r.ENVIRONMENT)_=!0;else if("NODE"===r.ENVIRONMENT)u=!0;else{if("SHELL"!==r.ENVIRONMENT)throw new Error("The provided Module['ENVIRONMENT'] value is not valid. It must be one of: WEB|WORKER|NODE|SHELL.");d=!0}else c="object"==typeof window,_="function"==typeof importScripts,u="object"==typeof n&&!c&&!_,d=!c&&!u&&!_;if(u)r.print||(r.print=console.log),r.printErr||(r.printErr=console.warn),r.read=function(t,e){l||(l=i(19)),h||(h=i(14)),t=h.normalize(t);var n=l.readFileSync(t);return n||t==h.resolve(t)||(t=path.join(s,"..","src",t),n=l.readFileSync(t)),n&&!e&&(n=n.toString()),n},r.readBinary=function(t){var e=r.read(t,!0);return e.buffer||(e=new Uint8Array(e)),x(e.buffer),e},r.load=function(t){f(read(t))},r.thisProgram||(n.argv.length>1?r.thisProgram=n.argv[1].replace(/\\/g,"/"):r.thisProgram="unknown-program"),r.arguments=n.argv.slice(2),t.exports=r,n.on("uncaughtException",(function(t){if(!(t instanceof um))throw t})),r.inspect=function(){return"[Emscripten Module object]"};else if(d)r.print||(r.print=print),"undefined"!=typeof printErr&&(r.printErr=printErr),"undefined"!=typeof read?r.read=read:r.read=function(){throw"no read() available (jsc?)"},r.readBinary=function(t){if("function"==typeof readbuffer)return new Uint8Array(readbuffer(t));var e=read(t,"binary");return x("object"==typeof e),e},"undefined"!=typeof scriptArgs?r.arguments=scriptArgs:void 0!==arguments&&(r.arguments=arguments);else{if(!c&&!_)throw"Unknown runtime environment. Where are we?";if(r.read=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},r.readAsync=function(t,e,i){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?e(n.response):i()},n.onerror=i,n.send(null)},void 0!==arguments&&(r.arguments=arguments),"undefined"!=typeof console)r.print||(r.print=function(t){console.log(t)}),r.printErr||(r.printErr=function(t){console.warn(t)});else{var p=!1;r.print||(r.print=p&&"undefined"!=typeof dump?function(t){dump(t)}:function(t){})}_&&(r.load=importScripts),void 0===r.setWindowTitle&&(r.setWindowTitle=function(t){document.title=t})}function f(t){gm("NO_DYNAMIC_EXECUTION=1 was set, cannot eval")}for(var a in!r.load&&r.read&&(r.load=function(t){f(r.read(t))}),r.print||(r.print=function(){}),r.printErr||(r.printErr=r.print),r.arguments||(r.arguments=[]),r.thisProgram||(r.thisProgram="./this.program"),r.print=r.print,r.printErr=r.printErr,r.preRun=[],r.postRun=[],o)o.hasOwnProperty(a)&&(r[a]=o[a]);o=void 0;var m={setTempRet0:function(t){tempRet0=t},getTempRet0:function(){return tempRet0},stackSave:function(){return ot},stackRestore:function(t){ot=t},getNativeTypeSize:function(t){switch(t){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:if("*"===t[t.length-1])return m.QUANTUM_SIZE;if("i"===t[0]){var e=parseInt(t.substr(1));return x(e%8==0),e/8}return 0}},getNativeFieldSize:function(t){return Math.max(m.getNativeTypeSize(t),m.QUANTUM_SIZE)},STACK_ALIGN:16,prepVararg:function(t,e){return"double"===e||"i64"===e?7&t&&(x(4==(7&t)),t+=4):x(0==(3&t)),t},getAlignSize:function(t,e,i){return i||"i64"!=t&&"double"!=t?t?Math.min(e||(t?m.getNativeFieldSize(t):0),m.QUANTUM_SIZE):Math.min(e,8):8},dynCall:function(t,e,i){return i&&i.length?(i.splice||(i=Array.prototype.slice.call(i)),i.splice(0,0,e),r["dynCall_"+t].apply(null,i)):r["dynCall_"+t].call(null,e)},functionPointers:[],addFunction:function(t){for(var e=0;e<m.functionPointers.length;e++)if(!m.functionPointers[e])return m.functionPointers[e]=t,2*(1+e);throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},removeFunction:function(t){m.functionPointers[(t-2)/2]=null},warnOnce:function(t){m.warnOnce.shown||(m.warnOnce.shown={}),m.warnOnce.shown[t]||(m.warnOnce.shown[t]=1,r.printErr(t))},funcWrappers:{},getFuncWrapper:function(t,e){x(e),m.funcWrappers[e]||(m.funcWrappers[e]={});var i=m.funcWrappers[e];return i[t]||(i[t]=function(){return m.dynCall(e,t,arguments)}),i[t]},getCompilerSetting:function(t){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},stackAlloc:function(t){var e=ot;return ot=15+(ot=ot+t|0)&-16,e},staticAlloc:function(t){var e=nt;return nt=15+(nt=nt+t|0)&-16,e},dynamicAlloc:function(t){var e=lt;return(lt=15+(lt=lt+t|0)&-16)>=ut&&!ct()?(lt=e,0):e},alignMemory:function(t,e){return t=Math.ceil(t/(e||16))*(e||16)},makeBigInt:function(t,e,i){return i?+(t>>>0)+4294967296*+(e>>>0):+(t>>>0)+4294967296*+(0|e)},GLOBAL_BASE:8,QUANTUM_SIZE:4,__dummy__:0};r.Runtime=m;var g,b,y,v,S=!1;function x(t,e){t||gm("Assertion failed: "+e)}function w(t){var e=r["_"+t];return e||gm("NO_DYNAMIC_EXECUTION=1 was set, cannot eval"),x(e,"Cannot call unknown function "+t+" (perhaps LLVM optimizations or closure removed it?)"),e}function C(t,e,i,n){switch("*"===(i=i||"i8").charAt(i.length-1)&&(i="i32"),i){case"i1":case"i8":M[t>>0]=e;break;case"i16":I[t>>1]=e;break;case"i32":L[t>>2]=e;break;case"i64":tempI64=[e>>>0,(tempDouble=e,+Ft(tempDouble)>=1?tempDouble>0?(0|Vt(+Nt(tempDouble/4294967296),4294967295))>>>0:~~+Bt((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],L[t>>2]=tempI64[0],L[t+4>>2]=tempI64[1];break;case"float":k[t>>2]=e;break;case"double":O[t>>3]=e;break;default:gm("invalid type for setValue: "+i)}}function T(t,e,i){switch("*"===(e=e||"i8").charAt(e.length-1)&&(e="i32"),e){case"i1":case"i8":return M[t>>0];case"i16":return I[t>>1];case"i32":case"i64":return L[t>>2];case"float":return k[t>>2];case"double":return O[t>>3];default:gm("invalid type for setValue: "+e)}return null}v={string:(y={stackSave:function(){m.stackSave()},stackRestore:function(){m.stackRestore()},arrayToC:function(t){var e=m.stackAlloc(t.length);return kt(t,e),e},stringToC:function(t){var e=0;return null!=t&&0!==t&&Dt(t,e=m.stackAlloc(1+(t.length<<2))),e}}).stringToC,array:y.arrayToC},b=function(t,e,i,n,s){var r=w(t),o=[],a=0;if(n)for(var l=0;l<n.length;l++){var h=v[i[l]];h?(0===a&&(a=m.stackSave()),o[l]=h(n[l])):o[l]=n[l]}var c=r.apply(null,o);if("string"===e&&(c=G(c)),0!==a){if(s&&s.async)return void EmterpreterAsync.asyncFinalizers.push((function(){m.stackRestore(a)}));m.stackRestore(a)}return c},g=function(t,e,i){return function(){return b(t,e,i,arguments)}},r.ccall=b,r.cwrap=g,r.setValue=C,r.getValue=T;var A,E,M,R,I,P,L,D,k,O,F=0,B=1,N=2,U=3,V=4;function z(t,e,i,n){var s,r;"number"==typeof t?(s=!0,r=t):(s=!1,r=t.length);var o,a="string"==typeof e?e:null;if(o=i==V?n:["function"==typeof ce?ce:m.staticAlloc,m.stackAlloc,m.staticAlloc,m.dynamicAlloc][void 0===i?N:i](Math.max(r,a?1:e.length)),s){var l;for(n=o,x(0==(3&o)),l=o+(-4&r);n<l;n+=4)L[n>>2]=0;for(l=o+r;n<l;)M[n++>>0]=0;return o}if("i8"===a)return t.subarray||t.slice?R.set(t,o):R.set(new Uint8Array(t),o),o;for(var h,c,_,u=0;u<r;){var d=t[u];"function"==typeof d&&(d=m.getFunctionIndex(d)),0!==(h=a||e[u])?("i64"==h&&(h="i32"),C(o+u,d,h),_!==h&&(c=m.getNativeTypeSize(h),_=h),u+=c):u++}return o}function W(t){return st?void 0!==ye&&!ye.called||!vt?m.dynamicAlloc(t):ce(t):m.staticAlloc(t)}function G(t,e){if(0===e||!t)return"";for(var i,n=0,s=0;n|=i=R[t+s>>0],(0!=i||e)&&(s++,!e||s!=e););e||(e=s);var o="";if(n<128){for(var a;e>0;)a=String.fromCharCode.apply(String,R.subarray(t,t+Math.min(e,1024))),o=o?o+a:a,t+=1024,e-=1024;return o}return r.UTF8ToString(t)}function j(t){for(var e="";;){var i=M[t++>>0];if(!i)return e;e+=String.fromCharCode(i)}}function H(t,e){return Ot(t,e,!1)}function X(t,e){for(var i,n,s,r,o,a="";;){if(!(i=t[e++]))return a;if(128&i)if(n=63&t[e++],192!=(224&i))if(s=63&t[e++],224==(240&i)?i=(15&i)<<12|n<<6|s:(r=63&t[e++],240==(248&i)?i=(7&i)<<18|n<<12|s<<6|r:(o=63&t[e++],i=248==(252&i)?(3&i)<<24|n<<18|s<<12|r<<6|o:(1&i)<<30|n<<24|s<<18|r<<12|o<<6|63&t[e++])),i<65536)a+=String.fromCharCode(i);else{var l=i-65536;a+=String.fromCharCode(55296|l>>10,56320|1023&l)}else a+=String.fromCharCode((31&i)<<6|n);else a+=String.fromCharCode(i)}}function Y(t){return X(R,t)}function q(t,e,i,n){if(!(n>0))return 0;for(var s=i,r=i+n-1,o=0;o<t.length;++o){var a=t.charCodeAt(o);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&t.charCodeAt(++o)),a<=127){if(i>=r)break;e[i++]=a}else if(a<=2047){if(i+1>=r)break;e[i++]=192|a>>6,e[i++]=128|63&a}else if(a<=65535){if(i+2>=r)break;e[i++]=224|a>>12,e[i++]=128|a>>6&63,e[i++]=128|63&a}else if(a<=2097151){if(i+3>=r)break;e[i++]=240|a>>18,e[i++]=128|a>>12&63,e[i++]=128|a>>6&63,e[i++]=128|63&a}else if(a<=67108863){if(i+4>=r)break;e[i++]=248|a>>24,e[i++]=128|a>>18&63,e[i++]=128|a>>12&63,e[i++]=128|a>>6&63,e[i++]=128|63&a}else{if(i+5>=r)break;e[i++]=252|a>>30,e[i++]=128|a>>24&63,e[i++]=128|a>>18&63,e[i++]=128|a>>12&63,e[i++]=128|a>>6&63,e[i++]=128|63&a}}return e[i]=0,i-s}function K(t,e,i){return q(t,R,e,i)}function Z(t){for(var e=0,i=0;i<t.length;++i){var n=t.charCodeAt(i);n>=55296&&n<=57343&&(n=65536+((1023&n)<<10)|1023&t.charCodeAt(++i)),n<=127?++e:e+=n<=2047?2:n<=65535?3:n<=2097151?4:n<=67108863?5:6}return e}function Q(t){if(r.___cxa_demangle)try{var e=ce(t.length);Dt(t.substr(1),e);var i=ce(4),n=r.___cxa_demangle(e,0,0,i);if(0===T(i,"i32")&&n)return G(n)}catch(e){return t}finally{e&&Pd(e),i&&Pd(i),n&&Pd(n)}return m.warnOnce("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),t}function $(t){return t.replace(/__Z[\w\d_]+/g,(function(t){var e=Q(t);return t===e?t:t+" ["+e+"]"}))}function J(){var t=new Error;if(!t.stack){try{throw new Error(0)}catch(e){t=e}if(!t.stack)return"(no stack trace available)"}return t.stack.toString()}function tt(){return $(J())}function et(t){return t%4096>0&&(t+=4096-t%4096),t}function it(){r.HEAP8=M=new Int8Array(E),r.HEAP16=I=new Int16Array(E),r.HEAP32=L=new Int32Array(E),r.HEAPU8=R=new Uint8Array(E),r.HEAPU16=P=new Uint16Array(E),r.HEAPU32=D=new Uint32Array(E),r.HEAPF32=k=new Float32Array(E),r.HEAPF64=O=new Float64Array(E)}r.ALLOC_NORMAL=F,r.ALLOC_STACK=B,r.ALLOC_STATIC=N,r.ALLOC_DYNAMIC=U,r.ALLOC_NONE=V,r.allocate=z,r.getMemory=W,r.Pointer_stringify=G,r.AsciiToString=j,r.stringToAscii=H,r.UTF8ArrayToString=X,r.UTF8ToString=Y,r.stringToUTF8Array=q,r.stringToUTF8=K,r.lengthBytesUTF8=Z,r.stackTrace=tt;var nt=0,st=!1,rt=0,ot=0,at=0,lt=0;function ht(){gm("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+ut+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which adjusts the size at runtime but prevents some optimizations, (3) set Module.TOTAL_MEMORY to a higher value before the program runs, or if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function ct(){ht()}for(var _t=r.TOTAL_STACK||5242880,ut=r.TOTAL_MEMORY||67108864,dt=65536;dt<ut||dt<2*_t;)dt<16777216?dt*=2:dt+=16777216;if(dt!==ut&&(ut=dt),E=r.buffer?r.buffer:new ArrayBuffer(ut),it(),L[0]=255,255!==R[0]||0!==R[3])throw"Typed arrays 2 must be run on a little-endian system";function pt(t){for(;t.length>0;){var e=t.shift();if("function"!=typeof e){var i=e.func;"number"==typeof i?void 0===e.arg?m.dynCall("v",i):m.dynCall("vi",i,[e.arg]):i(void 0===e.arg?null:e.arg)}else e()}}r.HEAP=A,r.buffer=E,r.HEAP8=M,r.HEAP16=I,r.HEAP32=L,r.HEAPU8=R,r.HEAPU16=P,r.HEAPU32=D,r.HEAPF32=k,r.HEAPF64=O;var ft=[],mt=[],gt=[],bt=[],yt=[],vt=!1;function St(){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)At(r.preRun.shift());pt(ft)}function xt(){vt||(vt=!0,pt(mt))}function wt(){pt(gt)}function Ct(){pt(bt)}function Tt(){if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;)It(r.postRun.shift());pt(yt)}function At(t){ft.unshift(t)}function Et(t){mt.unshift(t)}function Mt(t){gt.unshift(t)}function Rt(t){bt.unshift(t)}function It(t){yt.unshift(t)}function Pt(t,e,i){var n=i>0?i:Z(t)+1,s=new Array(n),r=q(t,s,0,s.length);return e&&(s.length=r),s}function Lt(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];n>255&&(n&=255),e.push(String.fromCharCode(n))}return e.join("")}function Dt(t,e,i){for(var n=Pt(t,i),s=0;s<n.length;){var r=n[s];M[e+s>>0]=r,s+=1}}function kt(t,e){for(var i=0;i<t.length;i++)M[e++>>0]=t[i]}function Ot(t,e,i){for(var n=0;n<t.length;++n)M[e++>>0]=t.charCodeAt(n);i||(M[e>>0]=0)}r.addOnPreRun=At,r.addOnInit=Et,r.addOnPreMain=Mt,r.addOnExit=Rt,r.addOnPostRun=It,r.intArrayFromString=Pt,r.intArrayToString=Lt,r.writeStringToMemory=Dt,r.writeArrayToMemory=kt,r.writeAsciiToMemory=Ot,Math.imul&&-5===Math.imul(4294967295,5)||(Math.imul=function(t,e){var i=65535&t,n=65535&e;return i*n+((t>>>16)*n+i*(e>>>16)<<16)|0}),Math.imul=Math.imul,Math.clz32||(Math.clz32=function(t){t>>>=0;for(var e=0;e<32;e++)if(t&1<<31-e)return e;return 32}),Math.clz32=Math.clz32,Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Math.trunc=Math.trunc;var Ft=Math.abs,Bt=(Math.cos,Math.sin,Math.tan,Math.acos,Math.asin,Math.atan,Math.atan2,Math.exp,Math.log,Math.sqrt,Math.ceil),Nt=Math.floor,Ut=Math.pow,Vt=(Math.imul,Math.fround,Math.min),zt=(Math.clz32,Math.trunc,0),Wt=null,Gt=null;function jt(t){zt++,r.monitorRunDependencies&&r.monitorRunDependencies(zt)}function Ht(t){if(zt--,r.monitorRunDependencies&&r.monitorRunDependencies(zt),0==zt&&(null!==Wt&&(clearInterval(Wt),Wt=null),Gt)){var e=Gt;Gt=null,e()}}r.addRunDependency=jt,r.removeRunDependency=Ht,r.preloadedImages={},r.preloadedAudios={};var Xt=[function(t,e,i,n,s,o,a,l){var h=r.getCache(r.ConcreteContactResultCallback)[t];if(!h.hasOwnProperty("addSingleResult"))throw"a JSImplementation must implement all functions, you forgot ConcreteContactResultCallback::addSingleResult.";return h.addSingleResult(e,i,n,s,o,a,l)}];function Yt(t,e,i,n,s,r,o,a,l){return Xt[t](e,i,n,s,r,o,a,l)}nt=23352,mt.push({func:function(){qn()}},{func:function(){kl()}}),z([36,32,0,0,209,32,0,0,76,32,0,0,183,32,0,0,8,0,0,0,0,0,0,0,76,32,0,0,168,32,0,0,16,0,0,0,0,0,0,0,36,32,0,0,20,33,0,0,76,32,0,0,251,32,0,0,48,0,0,0,0,0,0,0,76,32,0,0,233,32,0,0,56,0,0,0,0,0,0,0,36,32,0,0,48,33,0,0,36,32,0,0,71,33,0,0,76,32,0,0,90,33,0,0,8,0,0,0,0,0,0,0,76,32,0,0,109,33,0,0,96,0,0,0,0,0,0,0,76,32,0,0,130,33,0,0,96,0,0,0,0,0,0,0,76,32,0,0,152,33,0,0,96,0,0,0,0,0,0,0,36,32,0,0,175,33,0,0,36,32,0,0,190,33,0,0,76,32,0,0,214,33,0,0,56,0,0,0,0,0,0,0,76,32,0,0,245,33,0,0,216,0,0,0,0,0,0,0,36,32,0,0,118,34,0,0,76,32,0,0,138,34,0,0,216,0,0,0,0,0,0,0,36,32,0,0,248,34,0,0,76,32,0,0,100,35,0,0,88,0,0,0,0,0,0,0,76,32,0,0,133,35,0,0,248,0,0,0,0,0,0,0,76,32,0,0,162,35,0,0,40,1,0,0,0,0,0,0,36,32,0,0,181,35,0,0,76,32,0,0,220,35,0,0,168,0,0,0,0,0,0,0,76,32,0,0,244,35,0,0,216,0,0,0,0,0,0,0,36,32,0,0,14,36,0,0,36,32,0,0,61,36,0,0,136,32,0,0,54,37,0,0,0,0,0,0,2,0,0,0,96,6,0,0,2,0,0,0,104,6,0,0,2,4,0,0,76,32,0,0,74,37,0,0,144,1,0,0,0,0,0,0,76,32,0,0,96,37,0,0,160,1,0,0,0,0,0,0,36,32,0,0,122,37,0,0,36,32,0,0,149,37,0,0,76,32,0,0,178,37,0,0,64,7,0,0,0,0,0,0,76,32,0,0,69,38,0,0,64,7,0,0,0,0,0,0,76,32,0,0,218,38,0,0,96,0,0,0,0,0,0,0,76,32,0,0,88,39,0,0,240,1,0,0,0,0,0,0,36,32,0,0,221,39,0,0,76,32,0,0,65,40,0,0,80,7,0,0,0,0,0,0,76,32,0,0,240,40,0,0,80,7,0,0,0,0,0,0,76,32,0,0,181,41,0,0,40,2,0,0,0,0,0,0,36,32,0,0,82,42,0,0,76,32,0,0,141,42,0,0,144,1,0,0,0,0,0,0,76,32,0,0,165,42,0,0,160,1,0,0,0,0,0,0,76,32,0,0,191,42,0,0,64,4,0,0,0,0,0,0,76,32,0,0,217,42,0,0,248,0,0,0,0,0,0,0,76,32,0,0,248,42,0,0,96,0,0,0,0,0,0,0,76,32,0,0,17,43,0,0,96,2,0,0,0,0,0,0,76,32,0,0,56,43,0,0,96,0,0,0,0,0,0,0,36,32,0,0,89,43,0,0,76,32,0,0,122,43,0,0,248,0,0,0,0,0,0,0,76,32,0,0,158,43,0,0,96,6,0,0,0,0,0,0,76,32,0,0,185,43,0,0,24,6,0,0,0,0,0,0,76,32,0,0,238,43,0,0,96,6,0,0,0,0,0,0,76,32,0,0,140,44,0,0,160,2,0,0,0,0,0,0,76,32,0,0,180,44,0,0,248,0,0,0,0,0,0,0,76,32,0,0,206,44,0,0,24,3,0,0,0,0,0,0,36,32,0,0,83,45,0,0,76,32,0,0,131,45,0,0,24,3,0,0,0,0,0,0,76,32,0,0,16,46,0,0,64,4,0,0,0,0,0,0,76,32,0,0,43,46,0,0,88,0,0,0,0,0,0,0,76,32,0,0,77,46,0,0,96,3,0,0,0,0,0,0,36,32,0,0,111,46,0,0,76,32,0,0,138,46,0,0,160,2,0,0,0,0,0,0,76,32,0,0,188,46,0,0,160,2,0,0,0,0,0,0,76,32,0,0,245,46,0,0,160,2,0,0,0,0,0,0,76,32,0,0,34,47,0,0,160,2,0,0,0,0,0,0,76,32,0,0,87,47,0,0,160,2,0,0,0,0,0,0,76,32,0,0,139,47,0,0,160,2,0,0,0,0,0,0,76,32,0,0,172,47,0,0,160,2,0,0,0,0,0,0,76,32,0,0,221,47,0,0,160,2,0,0,0,0,0,0,76,32,0,0,16,48,0,0,160,2,0,0,0,0,0,0,76,32,0,0,59,48,0,0,160,2,0,0,0,0,0,0,76,32,0,0,107,48,0,0,88,0,0,0,0,0,0,0,76,32,0,0,126,48,0,0,80,1,0,0,0,0,0,0,76,32,0,0,142,48,0,0,24,4,0,0,0,0,0,0,36,32,0,0,169,48,0,0,76,32,0,0,195,48,0,0,24,3,0,0,0,0,0,0,36,32,0,0,214,48,0,0,76,32,0,0,29,49,0,0,248,0,0,0,0,0,0,0,76,32,0,0,64,49,0,0,248,0,0,0,0,0,0,0,76,32,0,0,101,49,0,0,40,1,0,0,0,0,0,0,76,32,0,0,126,49,0,0,24,6,0,0,0,0,0,0,76,32,0,0,143,49,0,0,144,6,0,0,0,0,0,0,76,32,0,0,208,49,0,0,176,0,0,0,0,0,0,0,76,32,0,0,62,50,0,0,176,0,0,0,0,0,0,0,76,32,0,0,166,50,0,0,176,0,0,0,0,0,0,0,76,32,0,0,23,51,0,0,112,5,0,0,0,0,0,0,76,32,0,0,72,51,0,0,216,4,0,0,0,0,0,0,76,32,0,0,99,51,0,0,216,4,0,0,0,0,0,0,36,32,0,0,126,51,0,0,76,32,0,0,166,51,0,0,8,5,0,0,0,0,0,0,76,32,0,0,238,51,0,0,8,5,0,0,0,0,0,0,76,32,0,0,255,51,0,0,112,5,0,0,0,0,0,0,76,32,0,0,34,52,0,0,48,5,0,0,0,0,0,0,76,32,0,0,55,52,0,0,48,5,0,0,0,0,0,0,76,32,0,0,76,52,0,0,40,6,0,0,0,0,0,0,76,32,0,0,125,52,0,0,136,5,0,0,0,0,0,0,36,32,0,0,149,52,0,0,76,32,0,0,170,52,0,0,8,5,0,0,0,0,0,0,76,32,0,0,186,52,0,0,40,6,0,0,0,0,0,0,76,32,0,0,228,52,0,0,104,6,0,0,0,0,0,0,76,32,0,0,1,53,0,0,112,5,0,0,0,0,0,0,76,32,0,0,49,53,0,0,184,5,0,0,0,0,0,0,76,32,0,0,78,53,0,0,184,5,0,0,0,0,0,0,76,32,0,0,107,53,0,0,240,0,0,0,0,0,0,0,76,32,0,0,124,53,0,0,104,6,0,0,0,0,0,0,76,32,0,0,224,53,0,0,104,6,0,0,0,0,0,0,76,32,0,0,59,54,0,0,112,5,0,0,0,0,0,0,76,32,0,0,85,54,0,0,24,6,0,0,0,0,0,0,76,32,0,0,122,54,0,0,112,5,0,0,0,0,0,0,76,32,0,0,145,54,0,0,32,5,0,0,0,0,0,0,36,32,0,0,201,54,0,0,36,32,0,0,99,55,0,0,36,32,0,0,120,55,0,0,76,32,0,0,154,55,0,0,88,6,0,0,0,0,0,0,76,32,0,0,183,55,0,0,112,6,0,0,0,0,0,0,76,32,0,0,200,55,0,0,32,5,0,0,0,0,0,0,76,32,0,0,235,55,0,0,104,6,0,0,0,0,0,0,76,32,0,0,81,56,0,0,96,6,0,0,0,0,0,0,76,32,0,0,105,56,0,0,224,6,0,0,0,0,0,0,76,32,0,0,135,56,0,0,24,3,0,0,0,0,0,0,36,32,0,0,154,56,0,0,76,32,0,0,169,56,0,0,224,6,0,0,0,0,0,0,76,32,0,0,187,56,0,0,8,7,0,0,0,0,0,0,36,32,0,0,220,56,0,0,76,32,0,0,253,56,0,0,40,1,0,0,0,0,0,0,76,32,0,0,17,57,0,0,8,7,0,0,0,0,0,0,76,32,0,0,53,57,0,0,24,3,0,0,0,0,0,0,76,32,0,0,224,57,0,0,96,6,0,0,0,0,0,0,76,32,0,0,252,57,0,0,96,6,0,0,0,0,0,0,76,32,0,0,27,58,0,0,224,6,0,0,0,0,0,0,76,32,0,0,52,58,0,0,128,7,0,0,0,0,0,0,76,32,0,0,85,58,0,0,144,7,0,0,0,0,0,0,36,32,0,0,118,58,0,0,76,32,0,0,138,58,0,0,168,7,0,0,0,0,0,0,76,32,0,0,184,58,0,0,40,2,0,0,0,0,0,0,76,32,0,0,234,58,0,0,200,7,0,0,0,0,0,0,136,32,0,0,2,59,0,0,0,0,0,0,1,0,0,0,224,7,0,0,2,4,0,0,36,32,0,0,22,59,0,0,76,32,0,0,99,59,0,0,200,7,0,0,0,0,0,0,76,32,0,0,153,59,0,0,200,7,0,0,0,0,0,0,76,32,0,0,186,59,0,0,232,7,0,0,0,0,0,0,76,32,0,0,252,59,0,0,200,7,0,0,0,0,0,0,76,32,0,0,43,60,0,0,200,7,0,0,0,0,0,0,76,32,0,0,102,60,0,0,72,8,0,0,0,0,0,0,36,32,0,0,140,60,0,0,76,32,0,0,235,60,0,0,200,7,0,0,0,0,0,0,76,32,0,0,50,61,0,0,112,8,0,0,0,0,0,0,76,32,0,0,76,61,0,0,88,1,0,0,0,0,0,0,76,32,0,0,239,61,0,0,168,7,0,0,0,0,0,0,76,32,0,0,212,62,0,0,160,8,0,0,0,0,0,0,36,32,0,0,242,62,0,0,76,32,0,0,32,63,0,0,80,1,0,0,0,0,0,0,76,32,0,0,111,63,0,0,144,7,0,0,0,0,0,0,76,32,0,0,130,63,0,0,216,8,0,0,0,0,0,0,36,32,0,0,158,63,0,0,76,32,0,0,179,63,0,0,240,1,0,0,0,0,0,0,76,32,0,0,250,63,0,0,0,9,0,0,0,0,0,0,36,32,0,0,26,64,0,0,76,32,0,0,110,65,0,0,24,9,0,0,0,0,0,0,36,32,0,0,133,65,0,0,76,32,0,0,149,65,0,0,48,0,0,0,0,0,0,0,36,32,0,0,50,76,0,0,76,32,0,0,16,76,0,0,88,9,0,0,0,0,0,0,76,32,0,0,189,75,0,0,56,9,0,0,0,0,0,0,76,32,0,0,226,75,0,0,104,9,0,0,0,0,0,0,36,32,0,0,3,76,0,0,76,32,0,0,248,76,0,0,48,9,0,0,0,0,0,0,76,32,0,0,56,77,0,0,88,9,0,0,0,0,0,0,76,32,0,0,20,77,0,0,128,9,0,0,0,0,0,0,76,32,0,0,90,77,0,0,56,9,0,0,0,0,0,0,0,0,0,0,32,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,3,0,0,0,0,0,0,0,16,0,0,0,1,0,0,0,4,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,3,0,0,0,0,0,0,0,72,0,0,0,5,0,0,0,6,0,0,0,1,0,0,0,1,0,0,0,3,0,0,0,3,0,0,0,4,0,0,0,5,0,0,0,4,0,0,0,6,0,0,0,5,0,0,0,3,0,0,0,6,0,0,0,2,0,0,0,7,0,0,0,4,0,0,0,5,0,0,0,0,0,0,0,104,0,0,0,7,0,0,0,8,0,0,0,2,0,0,0,7,0,0,0,2,0,0,0,3,0,0,0,2,0,0,0,4,0,0,0,6,0,0,0,8,0,0,0,9,0,0,0,8,0,0,0,7,0,0,0,9,0,0,0,0,0,0,0,120,0,0,0,10,0,0,0,11,0,0,0,9,0,0,0,8,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,136,0,0,0,10,0,0,0,12,0,0,0,10,0,0,0,9,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,152,0,0,0,10,0,0,0,13,0,0,0,10,0,0,0,10,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,184,0,0,0,14,0,0,0,15,0,0,0,3,0,0,0,2,0,0,0,11,0,0,0,10,0,0,0,11,0,0,0,12,0,0,0,12,0,0,0,13,0,0,0,13,0,0,0,11,0,0,0,14,0,0,0,4,0,0,0,14,0,0,0,12,0,0,0,13,0,0,0,0,0,0,0,200,0,0,0,16,0,0,0,17,0,0,0,3,0,0,0,0,0,0,0,224,0,0,0,16,0,0,0,18,0,0,0,4,0,0,0,0,0,0,0,240,0,0,0,19,0,0,0,20,0,0,0,3,0,0,0,15,0,0,0,5,0,0,0,14,0,0,0,15,0,0,0,0,0,0,0,8,1,0,0,21,0,0,0,22,0,0,0,3,0,0,0,1,0,0,0,16,0,0,0,0,0,0,0,24,1,0,0,23,0,0,0,24,0,0,0,4,0,0,0,0,0,0,0,48,1,0,0,25,0,0,0,26,0,0,0,4,0,0,0,6,0,0,0,17,0,0,0,18,0,0,0,7,0,0,0,8,0,0,0,5,0,0,0,16,0,0,0,5,0,0,0,17,0,0,0,18,0,0,0,19,0,0,0,6,0,0,0,19,0,0,0,0,0,0,0,64,1,0,0,16,0,0,0,27,0,0,0,7,0,0,0,0,0,0,0,80,1,0,0,28,0,0,0,29,0,0,0,20,0,0,0,8,0,0,0,20,0,0,0,9,0,0,0,21,0,0,0,0,0,0,0,88,1,0,0,30,0,0,0,31,0,0,0,32,0,0,0,33,0,0,0,22,0,0,0,21,0,0,0,34,0,0,0,6,0,0,0,7,0,0,0,8,0,0,0,23,0,0,0,35,0,0,0,24,0,0,0,0,0,0,0,96,1,0,0,36,0,0,0,37,0,0,0,9,0,0,0,10,0,0,0,252,255,255,255,96,1,0,0,38,0,0,0,39,0,0,0,11,0,0,0,0,0,0,0,128,1,0,0,40,0,0,0,41,0,0,0,9,0,0,0,0,0,0,0,168,1,0,0,1,0,0,0,25,0,0,0,15,0,0,0,42,0,0,0,43,0,0,0,0,0,0,0,176,1,0,0,44,0,0,0,45,0,0,0,12,0,0,0,1,0,0,0,0,0,0,0,192,1,0,0,44,0,0,0,46,0,0,0,12,0,0,0,2,0,0,0,0,0,0,0,208,1,0,0,10,0,0,0,47,0,0,0,10,0,0,0,26,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,224,1,0,0,48,0,0,0,49,0,0,0,10,0,0,0,1,0,0,0,0,0,0,0,248,1,0,0,44,0,0,0,50,0,0,0,13,0,0,0,1,0,0,0,0,0,0,0,8,2,0,0,44,0,0,0,51,0,0,0,13,0,0,0,2,0,0,0,0,0,0,0,24,2,0,0,52,0,0,0,53,0,0,0,11,0,0,0,2,0,0,0,0,0,0,0,48,2,0,0,40,0,0,0,54,0,0,0,12,0,0,0,0,0,0,0,64,2,0,0,40,0,0,0,55,0,0,0,13,0,0,0,0,0,0,0,80,2,0,0,56,0,0,0,57,0,0,0,16,0,0,0,17,0,0,0,1,0,0,0,0,0,0,0,96,2,0,0,58,0,0,0,59,0,0,0,5,0,0,0,2,0,0,0,27,0,0,0,0,0,0,0,112,2,0,0,10,0,0,0,60,0,0,0,10,0,0,0,28,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,128,2,0,0,61,0,0,0,62,0,0,0,6,0,0,0,3,0,0,0,29,0,0,0,0,0,0,0,144,2,0,0,10,0,0,0,63,0,0,0,18,0,0,0,30,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,168,2,0,0,64,0,0,0,65,0,0,0,7,0,0,0,4,0,0,0,31,0,0,0,0,0,0,0,184,2,0,0,66,0,0,0,67,0,0,0,14,0,0,0,0,0,0,0,200,2,0,0,68,0,0,0,69,0,0,0,15,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,32,0,0,0,22,0,0,0,1,0,0,0,23,0,0,0,33,0,0,0,2,0,0,0,2,0,0,0,24,0,0,0,10,0,0,0,34,0,0,0,20,0,0,0,21,0,0,0,1,0,0,0,16,0,0,0,17,0,0,0,25,0,0,0,22,0,0,0,14,0,0,0,26,0,0,0,27,0,0,0,18,0,0,0,23,0,0,0,28,0,0,0,19,0,0,0,1,0,0,0,20,0,0,0,0,0,0,0,216,2,0,0,44,0,0,0,70,0,0,0,21,0,0,0,0,0,0,0,232,2,0,0,71,0,0,0,72,0,0,0,5,0,0,0,0,0,0,0,248,2,0,0,73,0,0,0,74,0,0,0,8,0,0,0,5,0,0,0,35,0,0,0,0,0,0,0,8,3,0,0,56,0,0,0,75,0,0,0,24,0,0,0,25,0,0,0,2,0,0,0,0,0,0,0,32,3,0,0,56,0,0,0,76,0,0,0,26,0,0,0,27,0,0,0,3,0,0,0,0,0,0,0,48,3,0,0,56,0,0,0,77,0,0,0,16,0,0,0,17,0,0,0,4,0,0,0,0,0,0,0,64,3,0,0,78,0,0,0,79,0,0,0,9,0,0,0,6,0,0,0,36,0,0,0,0,0,0,0,80,3,0,0,80,0,0,0,81,0,0,0,29,0,0,0,30,0,0,0,11,0,0,0,31,0,0,0,0,0,0,0,104,3,0,0,82,0,0,0,83,0,0,0,6,0,0,0,0,0,0,0,120,3,0,0,82,0,0,0,84,0,0,0,7,0,0,0,0,0,0,0,136,3,0,0,82,0,0,0,85,0,0,0,8,0,0,0,0,0,0,0,152,3,0,0,82,0,0,0,86,0,0,0,9,0,0,0,0,0,0,0,168,3,0,0,82,0,0,0,87,0,0,0,10,0,0,0,0,0,0,0,184,3,0,0,82,0,0,0,88,0,0,0,11,0,0,0,0,0,0,0,200,3,0,0,82,0,0,0,89,0,0,0,12,0,0,0,0,0,0,0,216,3,0,0,82,0,0,0,90,0,0,0,13,0,0,0,0,0,0,0,232,3,0,0,82,0,0,0,91,0,0,0,14,0,0,0,0,0,0,0,248,3,0,0,82,0,0,0,92,0,0,0,15,0,0,0,0,0,0,0,8,4,0,0,93,0,0,0,94,0,0,0,10,0,0,0,7,0,0,0,37,0,0,0,0,0,0,0,24,4,0,0,95,0,0,0,96,0,0,0,20,0,0,0,8,0,0,0,20,0,0,0,9,0,0,0,21,0,0,0,28,0,0,0,22,0,0,0,0,0,0,0,40,4,0,0,97,0,0,0,98,0,0,0,20,0,0,0,8,0,0,0,20,0,0,0,9,0,0,0,21,0,0,0,29,0,0,0,23,0,0,0,0,0,0,0,56,4,0,0,99,0,0,0,100,0,0,0,12,0,0,0,13,0,0,0,32,0,0,0,0,0,0,0,64,4,0,0,56,0,0,0,101,0,0,0,16,0,0,0,17,0,0,0,5,0,0,0,0,0,0,0,80,4,0,0,102,0,0,0,103,0,0,0,30,0,0,0,38,0,0,0,0,0,0,0,88,4,0,0,104,0,0,0,105,0,0,0,11,0,0,0,8,0,0,0,39,0,0,0,0,0,0,0,104,4,0,0,106,0,0,0,107,0,0,0,12,0,0,0,9,0,0,0,40,0,0,0,0,0,0,0,120,4,0,0,23,0,0,0,108,0,0,0,13,0,0,0,0,0,0,0,136,4,0,0,68,0,0,0,109,0,0,0,24,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,41,0,0,0,22,0,0,0,2,0,0,0,33,0,0,0,33,0,0,0,3,0,0,0,2,0,0,0,24,0,0,0,10,0,0,0,34,0,0,0,31,0,0,0,32,0,0,0,1,0,0,0,25,0,0,0,17,0,0,0,34,0,0,0,33,0,0,0,14,0,0,0,35,0,0,0,36,0,0,0,26,0,0,0,34,0,0,0,37,0,0,0,27,0,0,0,2,0,0,0,35,0,0,0,0,0,0,0,152,4,0,0,110,0,0,0,111,0,0,0,28,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,42,0,0,0,38,0,0,0,3,0,0,0,39,0,0,0,33,0,0,0,4,0,0,0,3,0,0,0,40,0,0,0,14,0,0,0,34,0,0,0,29,0,0,0,36,0,0,0,37,0,0,0,43,0,0,0,44,0,0,0,0,0,0,0,168,4,0,0,112,0,0,0,113,0,0,0,38,0,0,0,0,0,0,0,184,4,0,0,112,0,0,0,114,0,0,0,39,0,0,0,0,0,0,0,200,4,0,0,112,0,0,0,115,0,0,0,40,0,0,0,0,0,0,0,216,4,0,0,116,0,0,0,117,0,0,0,30,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,45,0,0,0,22,0,0,0,4,0,0,0,41,0,0,0,46,0,0,0,5,0,0,0,2,0,0,0,42,0,0,0,15,0,0,0,34,0,0,0,20,0,0,0,41,0,0,0,1,0,0,0,31,0,0,0,17,0,0,0,43,0,0,0,42,0,0,0,0,0,0,0,232,4,0,0,116,0,0,0,118,0,0,0,30,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,45,0,0,0,22,0,0,0,4,0,0,0,44,0,0,0,46,0,0,0,5,0,0,0,2,0,0,0,42,0,0,0,15,0,0,0,34,0,0,0,20,0,0,0,41,0,0,0,1,0,0,0,31,0,0,0,17,0,0,0,43,0,0,0,42,0,0,0,0,0,0,0,248,4,0,0,116,0,0,0,119,0,0,0,30,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,45,0,0,0,22,0,0,0,4,0,0,0,45,0,0,0,46,0,0,0,5,0,0,0,2,0,0,0,42,0,0,0,15,0,0,0,34,0,0,0,20,0,0,0,41,0,0,0,1,0,0,0,31,0,0,0,17,0,0,0,43,0,0,0,42,0,0,0,0,0,0,0,16,5,0,0,120,0,0,0,121,0,0,0,32,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,47,0,0,0,46,0,0,0,5,0,0,0,47,0,0,0,33,0,0,0,6,0,0,0,4,0,0,0,48,0,0,0,16,0,0,0,34,0,0,0,48,0,0,0,122,0,0,0,0,0,0,0,48,5,0,0,116,0,0,0,123,0,0,0,33,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,49,0,0,0,22,0,0,0,6,0,0,0,49,0,0,0,50,0,0,0,2,0,0,0,2,0,0,0,50,0,0,0,17,0,0,0,34,0,0,0,43,0,0,0,44,0,0,0,1,0,0,0,34,0,0,0,17,0,0,0,43,0,0,0,42,0,0,0,0,0,0,0,64,5,0,0,116,0,0,0,124,0,0,0,33,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,49,0,0,0,22,0,0,0,6,0,0,0,51,0,0,0,51,0,0,0,2,0,0,0,2,0,0,0,50,0,0,0,17,0,0,0,34,0,0,0,43,0,0,0,44,0,0,0,1,0,0,0,34,0,0,0,17,0,0,0,43,0,0,0,42,0,0,0,0,0,0,0,80,5,0,0,116,0,0,0,125,0,0,0,33,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,49,0,0,0,22,0,0,0,6,0,0,0,52,0,0,0,52,0,0,0,2,0,0,0,2,0,0,0,50,0,0,0,17,0,0,0,34,0,0,0,43,0,0,0,44,0,0,0,1,0,0,0,34,0,0,0,17,0,0,0,43,0,0,0,42,0,0,0,0,0,0,0,96,5,0,0,126,0,0,0,127,0,0,0,35,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,53,0,0,0,22,0,0,0,7,0,0,0,53,0,0,0,33,0,0,0,2,0,0,0,2,0,0,0,54,0,0,0,18,0,0,0,34,0,0,0,45,0,0,0,46,0,0,0,2,0,0,0,36,0,0,0,17,0,0,0,43,0,0,0,42,0,0,0,14,0,0,0,55,0,0,0,56,0,0,0,37,0,0,0,47,0,0,0,57,0,0,0,38,0,0,0,3,0,0,0,0,0,0,0,128,5,0,0,128,0,0,0,129,0,0,0,0,0,0,0,152,5,0,0,68,0,0,0,130,0,0,0,35,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,54,0,0,0,58,0,0,0,7,0,0,0,59,0,0,0,33,0,0,0,2,0,0,0,2,0,0,0,24,0,0,0,10,0,0,0,34,0,0,0,48,0,0,0,49,0,0,0,1,0,0,0,39,0,0,0,17,0,0,0,43,0,0,0,42,0,0,0,14,0,0,0,60,0,0,0,61,0,0,0,40,0,0,0,50,0,0,0,62,0,0,0,41,0,0,0,4,0,0,0,0,0,0,0,168,5,0,0,131,0,0,0,132,0,0,0,42,0,0,0,0,0,0,0,184,5,0,0,116,0,0,0,133,0,0,0,43,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,55,0,0,0,22,0,0,0,8,0,0,0,63,0,0,0,56,0,0,0,7,0,0,0,2,0,0,0,64,0,0,0,19,0,0,0,34,0,0,0,51,0,0,0,52,0,0,0,1,0,0,0,44,0,0,0,17,0,0,0,43,0,0,0,42,0,0,0,5,0,0,0,0,0,0,0,200,5,0,0,116,0,0,0,134,0,0,0,43,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,55,0,0,0,22,0,0,0,8,0,0,0,65,0,0,0,56,0,0,0,7,0,0,0,2,0,0,0,64,0,0,0,19,0,0,0,34,0,0,0,51,0,0,0,53,0,0,0,1,0,0,0,45,0,0,0,17,0,0,0,43,0,0,0,42,0,0,0,6,0,0,0,0,0,0,0,216,5,0,0,116,0,0,0,135,0,0,0,43,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,55,0,0,0,22,0,0,0,8,0,0,0,66,0,0,0,56,0,0,0,7,0,0,0,2,0,0,0,64,0,0,0,19,0,0,0,34,0,0,0,51,0,0,0,54,0,0,0,1,0,0,0,46,0,0,0,17,0,0,0,43,0,0,0,42,0,0,0,7,0,0,0,0,0,0,0,232,5,0,0,136,0,0,0,137,0,0,0,3,0,0,0,15,0,0,0,5,0,0,0,14,0,0,0,15,0,0,0,16,0,0,0,0,0,0,0,248,5,0,0,131,0,0,0,138,0,0,0,47,0,0,0,0,0,0,0,8,6,0,0,131,0,0,0,139,0,0,0,48,0,0,0,0,0,0,0,24,6,0,0,68,0,0,0,140,0,0,0,33,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,32,0,0,0,22,0,0,0,7,0,0,0,1,0,0,0,33,0,0,0,2,0,0,0,2,0,0,0,24,0,0,0,10,0,0,0,34,0,0,0,20,0,0,0,55,0,0,0,1,0,0,0,49,0,0,0,17,0,0,0,43,0,0,0,42,0,0,0,14,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,56,6,0,0,116,0,0,0,141,0,0,0,50,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,32,0,0,0,22,0,0,0,9,0,0,0,67,0,0,0,33,0,0,0,8,0,0,0,8,0,0,0,24,0,0,0,10,0,0,0,34,0,0,0,56,0,0,0,57,0,0,0,1,0,0,0,51,0,0,0,17,0,0,0,43,0,0,0,42,0,0,0,0,0,0,0,72,6,0,0,142,0,0,0,143,0,0,0,52,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,57,0,0,0,68,0,0,0,10,0,0,0,69,0,0,0,33,0,0,0,4,0,0,0,3,0,0,0,70,0,0,0,20,0,0,0,34,0,0,0,53,0,0,0,0,0,0,0,112,6,0,0,144,0,0,0,145,0,0,0,54,0,0,0,1,0,0,0,2,0,0,0,58,0,0,0,59,0,0,0,71,0,0,0,60,0,0,0,61,0,0,0,72,0,0,0,58,0,0,0,59,0,0,0,73,0,0,0,21,0,0,0,0,0,0,0,128,6,0,0,146,0,0,0,147,0,0,0,54,0,0,0,1,0,0,0,2,0,0,0,58,0,0,0,59,0,0,0,71,0,0,0,62,0,0,0,63,0,0,0,72,0,0,0,58,0,0,0,59,0,0,0,73,0,0,0,21,0,0,0,0,0,0,0,144,6,0,0,148,0,0,0,149,0,0,0,28,0,0,0,19,0,0,0,1,0,0,0,1,0,0,0,64,0,0,0,38,0,0,0,3,0,0,0,74,0,0,0,33,0,0,0,4,0,0,0,3,0,0,0,75,0,0,0,22,0,0,0,34,0,0,0,55,0,0,0,36,0,0,0,37,0,0,0,0,0,0,0,160,6,0,0,131,0,0,0,150,0,0,0,56,0,0,0,0,0,0,0,176,6,0,0,44,0,0,0,151,0,0,0,57,0,0,0,0,0,0,0,192,6,0,0,152,0,0,0,153,0,0,0,1,0,0,0,0,0,0,0,208,6,0,0,56,0,0,0,154,0,0,0,60,0,0,0,61,0,0,0,6,0,0,0,0,0,0,0,232,6,0,0,152,0,0,0,155,0,0,0,2,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,248,6,0,0,156,0,0,0,157,0,0,0,1,0,0,0,0,0,0,0,16,7,0,0,23,0,0,0,158,0,0,0,14,0,0,0,0,0,0,0,32,7,0,0,156,0,0,0,159,0,0,0,2,0,0,0,0,0,0,0,48,7,0,0,56,0,0,0,160,0,0,0,62,0,0,0,63,0,0,0,7,0,0,0,10,215,163,60,0,0,0,0,80,7,0,0,44,0,0,0,161,0,0,0,13,0,0,0,1,0,0,0,0,0,0,0,96,7,0,0,152,0,0,0,162,0,0,0,3,0,0,0,0,0,0,0,112,7,0,0,163,0,0,0,164,0,0,0,2,0,0,0,65,0,0,0,66,0,0,0,3,0,0,0,67,0,0,0,68,0,0,0,69,0,0,0,4,0,0,0,76,0,0,0,165,0,0,0,77,0,0,0,70,0,0,0,0,0,0,0,152,7,0,0,52,0,0,0,166,0,0,0,15,0,0,0,3,0,0,0,0,0,0,0,184,7,0,0,167,0,0,0,168,0,0,0,169,0,0,0,1,0,0,0,71,0,0,0,72,0,0,0,8,0,0,0,1,0,0,0,4,0,0,0,78,0,0,0,23,0,0,0,64,0,0,0,0,0,0,0,200,7,0,0,167,0,0,0,170,0,0,0,171,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,9,0,0,0,1,0,0,0,1,0,0,0,79,0,0,0,24,0,0,0,0,0,0,0,232,7,0,0,167,0,0,0,172,0,0,0,173,0,0,0,1,0,0,0,73,0,0,0,74,0,0,0,9,0,0,0,2,0,0,0,5,0,0,0,80,0,0,0,25,0,0,0,174,0,0,0,81,0,0,0,0,0,0,0,248,7,0,0,167,0,0,0,175,0,0,0,176,0,0,0,1,0,0,0,75,0,0,0,76,0,0,0,9,0,0,0,3,0,0,0,6,0,0,0,82,0,0,0,26,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,8,8,0,0,167,0,0,0,177,0,0,0,173,0,0,0,1,0,0,0,73,0,0,0,77,0,0,0,9,0,0,0,2,0,0,0,5,0,0,0,83,0,0,0,27,0,0,0,174,0,0,0,81,0,0,0,65,0,0,0,0,0,0,0,24,8,0,0,167,0,0,0,178,0,0,0,179,0,0,0,1,0,0,0,78,0,0,0,79,0,0,0,9,0,0,0,4,0,0,0,7,0,0,0,84,0,0,0,28,0,0,0,85,0,0,0,0,0,0,0,40,8,0,0,167,0,0,0,180,0,0,0,181,0,0,0,1,0,0,0,80,0,0,0,81,0,0,0,9,0,0,0,5,0,0,0,8,0,0,0,86,0,0,0,29,0,0,0,87,0,0,0,0,0,0,0,56,8,0,0,182,0,0,0,183,0,0,0,66,0,0,0,1,0,0,0,67,0,0,0,184,0,0,0,88,0,0,0,58,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,80,8,0,0,167,0,0,0,185,0,0,0,171,0,0,0,1,0,0,0,82,0,0,0,83,0,0,0,9,0,0,0,6,0,0,0,9,0,0,0,89,0,0,0,30,0,0,0,90,0,0,0,0,0,0,0,96,8,0,0,186,0,0,0,187,0,0,0,32,0,0,0,33,0,0,0,22,0,0,0,21,0,0,0,188,0,0,0,6,0,0,0,7,0,0,0,59,0,0,0,84,0,0,0,35,0,0,0,85,0,0,0,1,0,0,0,68,0,0,0,86,0,0,0,87,0,0,0,88,0,0,0,89,0,0,0,90,0,0,0,189,0,0,0,91,0,0,0,60,0,0,0,92,0,0,0,93,0,0,0,91,0,0,0,92,0,0,0,16,0,0,0,17,0,0,0,93,0,0,0,190,0,0,0,94,0,0,0,95,0,0,0,96,0,0,0,97,0,0,0,9,0,0,0,10,0,0,0,191,0,0,0,98,0,0,0,11,0,0,0,12,0,0,0,13,0,0,0,99,0,0,0,192,0,0,0,100,0,0,0,14,0,0,0,0,0,0,0,168,7,0,0,52,0,0,0,193,0,0,0,15,0,0,0,10,0,0,0,0,0,0,0,128,8,0,0,52,0,0,0,194,0,0,0,18,0,0,0,11,0,0,0,0,0,0,0,144,8,0,0,195,0,0,0,196,0,0,0,3,0,0,0,0,0,0,0,168,8,0,0,197,0,0,0,198,0,0,0,20,0,0,0,8,0,0,0,94,0,0,0,31,0,0,0,101,0,0,0,0,0,0,0,184,8,0,0,199,0,0,0,200,0,0,0,5,0,0,0,102,0,0,0,15,0,0,0,16,0,0,0,61,0,0,0,0,0,0,0,200,8,0,0,201,0,0,0,202,0,0,0,17,0,0,0,0,0,0,0,224,8,0,0,48,0,0,0,203,0,0,0,19,0,0,0,12,0,0,0,28,88,0,0,0,0,0,0,240,8,0,0,204,0,0,0,205,0,0,0,20,0,0,0,1,0,0,0,0,0,0,0,8,9,0,0,206,0,0,0,207,0,0,0,103,0,0,0,104,0,0,0,0,0,0,0,32,9,0,0,208,0,0,0,209,0,0,0,32,0,0,0,18,0,0,0,69,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,33,0,0,0,34,0,0,0,41,91,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,56,9,0,0,210,0,0,0,211,0,0,0,212,0,0,0,213,0,0,0,35,0,0,0,4,0,0,0,15,0,0,0,62,0,0,0,0,0,0,0,72,9,0,0,210,0,0,0,214,0,0,0,212,0,0,0,213,0,0,0,35,0,0,0,5,0,0,0,16,0,0,0,63,0,0,0,0,0,0,0,112,9,0,0,215,0,0,0,216,0,0,0,96,0,0,0,0,0,0,0,160,9,0,0,210,0,0,0,217,0,0,0,212,0,0,0,213,0,0,0,35,0,0,0,6,0,0,0,17,0,0,0,64,0,0,0,49,50,98,116,65,120,105,115,83,119,101,101,112,51,0,50,48,98,116,65,120,105,115,83,119,101,101,112,51,73,110,116,101,114,110,97,108,73,116,69,0,50,49,98,116,66,114,111,97,100,112,104,97,115,101,73,110,116,101,114,102,97,99,101,0,49,53,98,116,78,117,108,108,80,97,105,114,67,97,99,104,101,0,50,50,98,116,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,67,97,99,104,101,0,50,53,98,116,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,67,97,108,108,98,97,99,107,0,50,48,98,116,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,78,54,98,116,68,98,118,116,56,73,67,111,108,108,105,100,101,69,0,49,54,98,116,68,98,118,116,66,114,111,97,100,112,104,97,115,101,0,49,56,98,116,68,98,118,116,84,114,101,101,67,111,108,108,105,100,101,114,0,49,57,66,114,111,97,100,112,104,97,115,101,82,97,121,84,101,115,116,101,114,0,50,48,66,114,111,97,100,112,104,97,115,101,65,97,98,98,84,101,115,116,101,114,0,49,50,98,116,68,105,115,112,97,116,99,104,101,114,0,50,49,98,116,78,111,100,101,79,118,101,114,108,97,112,67,97,108,108,98,97,99,107,0,50,56,98,116,72,97,115,104,101,100,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,67,97,99,104,101,0,90,78,50,56,98,116,72,97,115,104,101,100,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,67,97,99,104,101,51,55,114,101,109,111,118,101,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,115,67,111,110,116,97,105,110,105,110,103,80,114,111,120,121,69,80,49,55,98,116,66,114,111,97,100,112,104,97,115,101,80,114,111,120,121,80,49,50,98,116,68,105,115,112,97,116,99,104,101,114,69,49,56,82,101,109,111,118,101,80,97,105,114,67,97,108,108,98,97,99,107,0,49,55,98,116,79,118,101,114,108,97,112,67,97,108,108,98,97,99,107,0,90,78,50,56,98,116,72,97,115,104,101,100,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,67,97,99,104,101,49,57,99,108,101,97,110,80,114,111,120,121,70,114,111,109,80,97,105,114,115,69,80,49,55,98,116,66,114,111,97,100,112,104,97,115,101,80,114,111,120,121,80,49,50,98,116,68,105,115,112,97,116,99,104,101,114,69,49,55,67,108,101,97,110,80,97,105,114,67,97,108,108,98,97,99,107,0,49,52,98,116,81,117,97,110,116,105,122,101,100,66,118,104,0,98,116,79,112,116,105,109,105,122,101,100,66,118,104,78,111,100,101,68,97,116,97,0,98,116,81,117,97,110,116,105,122,101,100,66,118,104,78,111,100,101,68,97,116,97,0,98,116,66,118,104,83,117,98,116,114,101,101,73,110,102,111,68,97,116,97,0,98,116,81,117,97,110,116,105,122,101,100,66,118,104,70,108,111,97,116,68,97,116,97,0,51,48,98,116,65,99,116,105,118,97,116,105,110,103,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,50,54,98,116,66,111,120,66,111,120,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,49,54,98,116,66,111,120,66,111,120,68,101,116,101,99,116,111,114,0,51,54,98,116,68,105,115,99,114,101,116,101,67,111,108,108,105,115,105,111,110,68,101,116,101,99,116,111,114,73,110,116,101,114,102,97,99,101,0,50,49,98,116,67,111,108,108,105,115,105,111,110,68,105,115,112,97,116,99,104,101,114,0,50,51,98,116,67,111,108,108,105,115,105,111,110,80,97,105,114,67,97,108,108,98,97,99,107,0,49,55,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,0,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,70,108,111,97,116,68,97,116,97,0,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,0,117,112,100,97,116,101,65,97,98,98,115,0,1,79,118,101,114,102,108,111,119,32,105,110,32,65,65,66,66,44,32,111,98,106,101,99,116,32,114,101,109,111,118,101,100,32,102,114,111,109,32,115,105,109,117,108,97,116,105,111,110,0,73,102,32,121,111,117,32,99,97,110,32,114,101,112,114,111,100,117,99,101,32,116,104,105,115,44,32,112,108,101,97,115,101,32,101,109,97,105,108,32,98,117,103,115,64,99,111,110,116,105,110,117,111,117,115,112,104,121,115,105,99,115,46,99,111,109,10,0,80,108,101,97,115,101,32,105,110,99,108,117,100,101,32,97,98,111,118,101,32,105,110,102,111,114,109,97,116,105,111,110,44,32,121,111,117,114,32,80,108,97,116,102,111,114,109,44,32,118,101,114,115,105,111,110,32,111,102,32,79,83,46,10,0,84,104,97,110,107,115,46,10,0,99,97,108,99,117,108,97,116,101,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,115,0,49,55,68,101,98,117,103,68,114,97,119,99,97,108,108,98,97,99,107,0,49,57,98,116,83,105,110,103,108,101,82,97,121,67,97,108,108,98,97,99,107,0,50,51,98,116,66,114,111,97,100,112,104,97,115,101,82,97,121,67,97,108,108,98,97,99,107,0,50,52,98,116,66,114,111,97,100,112,104,97,115,101,65,97,98,98,67,97,108,108,98,97,99,107,0,78,49,50,98,116,67,111,110,118,101,120,67,97,115,116,49,48,67,97,115,116,82,101,115,117,108,116,69,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,49,114,97,121,84,101,115,116,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,50,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,49,55,82,97,121,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,69,50,57,66,114,105,100,103,101,84,114,105,97,110,103,108,101,82,97,121,99,97,115,116,67,97,108,108,98,97,99,107,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,49,114,97,121,84,101,115,116,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,50,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,49,55,82,97,121,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,69,50,57,66,114,105,100,103,101,84,114,105,97,110,103,108,101,82,97,121,99,97,115,116,67,97,108,108,98,97,99,107,95,48,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,49,114,97,121,84,101,115,116,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,50,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,49,55,82,97,121,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,69,57,82,97,121,84,101,115,116,101,114,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,49,114,97,121,84,101,115,116,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,50,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,49,55,82,97,121,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,69,49,53,76,111,99,97,108,73,110,102,111,65,100,100,101,114,50,0,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,49,55,82,97,121,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,0,112,101,114],"i8",V,m.GLOBAL_BASE),z([102,111,114,109,68,105,115,99,114,101,116,101,67,111,108,108,105,115,105,111,110,68,101,116,101,99,116,105,111,110,0,100,105,115,112,97,116,99,104,65,108,108,67,111,108,108,105,115,105,111,110,80,97,105,114,115,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,53,111,98,106,101,99,116,81,117,101,114,121,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,80,75,49,51,98,116,67,111,110,118,101,120,83,104,97,112,101,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,53,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,50,48,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,102,69,51,50,66,114,105,100,103,101,84,114,105,97,110,103,108,101,67,111,110,118,101,120,99,97,115,116,67,97,108,108,98,97,99,107,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,53,111,98,106,101,99,116,81,117,101,114,121,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,80,75,49,51,98,116,67,111,110,118,101,120,83,104,97,112,101,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,53,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,50,48,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,102,69,51,50,66,114,105,100,103,101,84,114,105,97,110,103,108,101,67,111,110,118,101,120,99,97,115,116,67,97,108,108,98,97,99,107,95,48,0,99,111,110,118,101,120,83,119,101,101,112,67,111,109,112,111,117,110,100,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,53,111,98,106,101,99,116,81,117,101,114,121,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,80,75,49,51,98,116,67,111,110,118,101,120,83,104,97,112,101,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,53,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,50,48,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,102,69,49,52,76,111,99,97,108,73,110,102,111,65,100,100,101,114,0,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,48,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,0,99,111,110,118,101,120,83,119,101,101,112,84,101,115,116,0,50,49,98,116,83,105,110,103,108,101,83,119,101,101,112,67,97,108,108,98,97,99,107,0,50,51,98,116,83,105,110,103,108,101,67,111,110,116,97,99,116,67,97,108,108,98,97,99,107,0,50,51,98,116,66,114,105,100,103,101,100,77,97,110,105,102,111,108,100,82,101,115,117,108,116,0,50,56,98,116,67,111,109,112,111,117,110,100,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,50,50,98,116,67,111,109,112,111,117,110,100,76,101,97,102,67,97,108,108,98,97,99,107,0,51,54,98,116,67,111,109,112,111,117,110,100,67,111,109,112,111,117,110,100,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,51,48,98,116,67,111,109,112,111,117,110,100,67,111,109,112,111,117,110,100,76,101,97,102,67,97,108,108,98,97,99,107,0,51,48,98,116,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,67,114,101,97,116,101,70,117,110,99,0,51,51,98,116,67,111,110,118,101,120,67,111,110,99,97,118,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,50,52,98,116,67,111,110,118,101,120,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,0,49,53,98,116,84,114,105,97,110,103,108,101,83,104,97,112,101,0,84,114,105,97,110,103,108,101,0,98,116,67,111,110,118,101,120,73,110,116,101,114,110,97,108,83,104,97,112,101,68,97,116,97,0,90,78,51,51,98,116,67,111,110,118,101,120,67,111,110,99,97,118,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,50,49,99,97,108,99,117,108,97,116,101,84,105,109,101,79,102,73,109,112,97,99,116,69,80,49,55,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,83,49,95,82,75,49,54,98,116,68,105,115,112,97,116,99,104,101,114,73,110,102,111,80,49,54,98,116,77,97,110,105,102,111,108,100,82,101,115,117,108,116,69,51,49,76,111,99,97,108,84,114,105,97,110,103,108,101,83,112,104,101,114,101,67,97,115,116,67,97,108,108,98,97,99,107,0,78,50,51,98,116,67,111,110,118,101,120,67,111,110,118,101,120,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,50,51,98,116,67,111,110,118,101,120,67,111,110,118,101,120,65,108,103,111,114,105,116,104,109,0,90,78,50,51,98,116,67,111,110,118,101,120,67,111,110,118,101,120,65,108,103,111,114,105,116,104,109,49,54,112,114,111,99,101,115,115,67,111,108,108,105,115,105,111,110,69,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,83,50,95,82,75,49,54,98,116,68,105,115,112,97,116,99,104,101,114,73,110,102,111,80,49,54,98,116,77,97,110,105,102,111,108,100,82,101,115,117,108,116,69,49,51,98,116,68,117,109,109,121,82,101,115,117,108,116,0,78,51,54,98,116,68,105,115,99,114,101,116,101,67,111,108,108,105,115,105,111,110,68,101,116,101,99,116,111,114,73,110,116,101,114,102,97,99,101,54,82,101,115,117,108,116,69,0,90,78,50,51,98,116,67,111,110,118,101,120,67,111,110,118,101,120,65,108,103,111,114,105,116,104,109,49,54,112,114,111,99,101,115,115,67,111,108,108,105,115,105,111,110,69,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,83,50,95,82,75,49,54,98,116,68,105,115,112,97,116,99,104,101,114,73,110,102,111,80,49,54,98,116,77,97,110,105,102,111,108,100,82,101,115,117,108,116,69,50,49,98,116,87,105,116,104,111,117,116,77,97,114,103,105,110,82,101,115,117,108,116,0,50,52,98,116,80,101,114,116,117,114,98,101,100,67,111,110,116,97,99,116,82,101,115,117,108,116,0,51,49,98,116,67,111,110,118,101,120,80,108,97,110,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,51,49,98,116,68,101,102,97,117,108,116,67,111,108,108,105,115,105,111,110,67,111,110,102,105,103,117,114,97,116,105,111,110,0,50,52,98,116,67,111,108,108,105,115,105,111,110,67,111,110,102,105,103,117,114,97,116,105,111,110,0,78,51,51,98,116,67,111,110,118,101,120,67,111,110,99,97,118,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,78,51,51,98,116,67,111,110,118,101,120,67,111,110,99,97,118,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,55,83,119,97,112,112,101,100,67,114,101,97,116,101,70,117,110,99,69,0,78,50,56,98,116,67,111,109,112,111,117,110,100,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,78,51,54,98,116,67,111,109,112,111,117,110,100,67,111,109,112,111,117,110,100,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,78,50,56,98,116,67,111,109,112,111,117,110,100,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,55,83,119,97,112,112,101,100,67,114,101,97,116,101,70,117,110,99,69,0,78,49,54,98,116,69,109,112,116,121,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,78,51,50,98,116,83,112,104,101,114,101,83,112,104,101,114,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,78,51,52,98,116,83,112,104,101,114,101,84,114,105,97,110,103,108,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,78,50,54,98,116,66,111,120,66,111,120,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,78,51,49,98,116,67,111,110,118,101,120,80,108,97,110,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,49,54,98,116,69,109,112,116,121,65,108,103,111,114,105,116,104,109,0,49,51,98,116,71,104,111,115,116,79,98,106,101,99,116,0,50,52,98,116,80,97,105,114,67,97,99,104,105,110,103,71,104,111,115,116,79,98,106,101,99,116,0,50,51,98,116,72,97,115,104,101,100,83,105,109,112,108,101,80,97,105,114,67,97,99,104,101,0,49,54,98,116,77,97,110,105,102,111,108,100,82,101,115,117,108,116,0,50,53,98,116,83,105,109,117,108,97,116,105,111,110,73,115,108,97,110,100,77,97,110,97,103,101,114,0,105,115,108,97,110,100,85,110,105,111,110,70,105,110,100,65,110,100,81,117,105,99,107,83,111,114,116,0,112,114,111,99,101,115,115,73,115,108,97,110,100,115,0,51,50,98,116,83,112,104,101,114,101,83,112,104,101,114,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,51,52,98,116,83,112,104,101,114,101,84,114,105,97,110,103,108,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,50,50,83,112,104,101,114,101,84,114,105,97,110,103,108,101,68,101,116,101,99,116,111,114,0,49,48,98,116,66,111,120,83,104,97,112,101,0,66,111,120,0,50,50,98,116,66,118,104,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,0,66,86,72,84,82,73,65,78,71,76,69,77,69,83,72,0,98,116,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,68,97,116,97,0,90,78,75,50,50,98,116,66,118,104,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,49,57,112,114,111,99,101,115,115,65,108,108,84,114,105,97,110,103,108,101,115,69,80,49,56,98,116,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,82,75,57,98,116,86,101,99,116,111,114,51,83,52,95,69,50,49,77,121,78,111,100,101,79,118,101,114,108,97,112,67,97,108,108,98,97,99,107,0,90,78,50,50,98,116,66,118,104,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,49,52,112,101,114,102,111,114,109,82,97,121,99,97,115,116,69,80,49,56,98,116,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,82,75,57,98,116,86,101,99,116,111,114,51,83,52,95,69,50,49,77,121,78,111,100,101,79,118,101,114,108,97,112,67,97,108,108,98,97,99,107,0,90,78,50,50,98,116,66,118,104,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,49,55,112,101,114,102,111,114,109,67,111,110,118,101,120,99,97,115,116,69,80,49,56,98,116,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,82,75,57,98,116,86,101,99,116,111,114,51,83,52,95,83,52,95,83,52,95,69,50,49,77,121,78,111,100,101,79,118,101,114,108,97,112,67,97,108,108,98,97,99,107,0,49,52,98,116,67,97,112,115,117,108,101,83,104,97,112,101,0,67,97,112,115,117,108,101,83,104,97,112,101,0,98,116,67,97,112,115,117,108,101,83,104,97,112,101,68,97,116,97,0,49,53,98,116,67,97,112,115,117,108,101,83,104,97,112,101,88,0,67,97,112,115,117,108,101,88,0,49,53,98,116,67,97,112,115,117,108,101,83,104,97,112,101,90,0,67,97,112,115,117,108,101,90,0,49,54,98,116,67,111,108,108,105,115,105,111,110,83,104,97,112,101,0,98,116,67,111,108,108,105,115,105,111,110,83,104,97,112,101,68,97,116,97,0,49,53,98,116,67,111,109,112,111,117,110,100,83,104,97,112,101,0,67,111,109,112,111,117,110,100,0,98,116,67,111,109,112,111,117,110,100,83,104,97,112,101,67,104,105,108,100,68,97,116,97,0,98,116,67,111,109,112,111,117,110,100,83,104,97,112,101,68,97,116,97,0,49,52,98,116,67,111,110,99,97,118,101,83,104,97,112,101,0,49,49,98,116,67,111,110,101,83,104,97,112,101,0,67,111,110,101,0,98,116,67,111,110,101,83,104,97,112,101,68,97,116,97,0,49,50,98,116,67,111,110,101,83,104,97,112,101,90,0,67,111,110,101,90,0,49,50,98,116,67,111,110,101,83,104,97,112,101,88,0,67,111,110,101,88,0,49,55,98,116,67,111,110,118,101,120,72,117,108,108,83,104,97,112,101,0,67,111,110,118,101,120,0,98,116,67,111,110,118,101,120,72,117,108,108,83,104,97,112,101,68,97,116,97,0,50,49,98,116,67,111,110,118,101,120,73,110,116,101,114,110,97,108,83,104,97,112,101,0,49,56,98,116,67,111,110,118,101,120,80,111,108,121,104,101,100,114,111,110,0,49,51,98,116,67,111,110,118,101,120,83,104,97,112,101,0,50,53,98,116,67,111,110,118,101,120,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,0,67,111,110,118,101,120,84,114,105,109,101,115,104,0,50,54,76,111,99,97,108,83,117,112,112,111,114,116,86,101,114,116,101,120,67,97,108,108,98,97,99,107,0,49,53,98,116,67,121,108,105,110,100,101,114,83,104,97,112,101,0,67,121,108,105,110,100,101,114,89,0,98,116,67,121,108,105,110,100,101,114,83,104,97,112,101,68,97,116,97,0,49,54,98,116,67,121,108,105,110,100,101,114,83,104,97,112,101,88,0,67,121,108,105,110,100,101,114,88,0,49,54,98,116,67,121,108,105,110,100,101,114,83,104,97,112,101,90,0,67,121,108,105,110,100,101,114,90,0,49,52,98,116,79,112,116,105,109,105,122,101,100,66,118,104,0,90,78,49,52,98,116,79,112,116,105,109,105,122,101,100,66,118,104,53,98,117,105,108,100,69,80,50,51,98,116,83,116,114,105,100,105,110,103,77,101,115,104,73,110,116,101,114,102,97,99,101,98,82,75,57,98,116,86,101,99,116,111,114,51,83,52,95,69,50,57,81,117,97,110,116,105,122,101,100,78,111,100,101,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,0,90,78,49,52,98,116,79,112,116,105,109,105,122,101,100,66,118,104,53,98,117,105,108,100,69,80,50,51,98,116,83,116,114,105,100,105,110,103,77,101,115,104,73,110,116,101,114,102,97,99,101,98,82,75,57,98,116,86,101,99,116,111,114,51,83,52,95,69,50,48,78,111,100,101,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,0,50,51,98,116,80,111,108,121,104,101,100,114,97,108,67,111,110,118,101,120,83,104,97,112,101,0,51,52,98,116,80,111,108,121,104,101,100,114,97,108,67,111,110,118,101,120,65,97,98,98,67,97,99,104,105,110,103,83,104,97,112,101,0,49,51,98,116,83,112,104,101,114,101,83,104,97,112,101,0,83,80,72,69,82,69,0,49,56,98,116,83,116,97,116,105,99,80,108,97,110,101,83,104,97,112,101,0,83,84,65,84,73,67,80,76,65,78,69,0,98,116,83,116,97,116,105,99,80,108,97,110,101,83,104,97,112,101,68,97,116,97,0,50,51,98,116,83,116,114,105,100,105,110,103,77,101,115,104,73,110,116,101,114,102,97,99,101,0,98,116,73,110,116,73,110,100,101,120,68,97,116,97,0,98,116,83,104,111,114,116,73,110,116,73,110,100,101,120,84,114,105,112,108,101,116,68,97,116,97,0,98,116,67,104,97,114,73,110,100,101,120,84,114,105,112,108,101,116,68,97,116,97,0,98,116,86,101,99,116,111,114,51,68,111,117,98,108,101,68,97,116,97,0,98,116,77,101,115,104,80,97,114,116,68,97,116,97,0,98,116,83,116,114,105,100,105,110,103,77,101,115,104,73,110,116,101,114,102,97,99,101,68,97,116,97,0,49,56,98,116,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,0,51,49,98,116,73,110,116,101,114,110,97,108,84,114,105,97,110,103,108,101,73,110,100,101,120,67,97,108,108,98,97,99,107,0,50,54,98,116,84,114,105,97,110,103,108,101,73,110,100,101,120,86,101,114,116,101,120,65,114,114,97,121,0,49,52,98,116,84,114,105,97,110,103,108,101,77,101,115,104,0,49,57,98,116,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,0,84,82,73,65,78,71,76,69,77,69,83,72,0,90,78,75,49,57,98,116,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,49,57,112,114,111,99,101,115,115,65,108,108,84,114,105,97,110,103,108,101,115,69,80,49,56,98,116,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,82,75,57,98,116,86,101,99,116,111,114,51,83,52,95,69,49,54,70,105,108,116,101,114,101,100,67,97,108,108,98,97,99,107,0,50,49,83,117,112,112,111,114,116,86,101,114,116,101,120,67,97,108,108,98,97,99,107,0,50,55,98,116,67,111,110,116,105,110,117,111,117,115,67,111,110,118,101,120,67,111,108,108,105,115,105,111,110,0,49,54,98,116,80,111,105,110,116,67,111,108,108,101,99,116,111,114,0,49,50,98,116,67,111,110,118,101,120,67,97,115,116,0,49,53,98,116,71,106,107,67,111,110,118,101,120,67,97,115,116,0,51,48,98,116,71,106,107,69,112,97,80,101,110,101,116,114,97,116,105,111,110,68,101,112,116,104,83,111,108,118,101,114,0,51,48,98,116,67,111,110,118,101,120,80,101,110,101,116,114,97,116,105,111,110,68,101,112,116,104,83,111,108,118,101,114,0,49,55,98,116,71,106,107,80,97,105,114,68,101,116,101,99,116,111,114,0,51,51,98,116,77,105,110,107,111,119,115,107,105,80,101,110,101,116,114,97,116,105,111,110,68,101,112,116,104,83,111,108,118,101,114,0,90,78,51,51,98,116,77,105,110,107,111,119,115,107,105,80,101,110,101,116,114,97,116,105,111,110,68,101,112,116,104,83,111,108,118,101,114,49,50,99,97,108,99,80,101,110,68,101,112,116,104,69,82,50,50,98,116,86,111,114,111,110,111,105,83,105,109,112,108,101,120,83,111,108,118,101,114,80,75,49,51,98,116,67,111,110,118,101,120,83,104,97,112,101,83,52,95,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,55,95,82,57,98,116,86,101,99,116,111,114,51,83,57,95,83,57,95,80,49,50,98,116,73,68,101,98,117,103,68,114,97,119,69,50,48,98,116,73,110,116,101,114,109,101,100,105,97,116,101,82,101,115,117,108,116,0,50,53,98,116,84,114,105,97,110,103,108,101,82,97,121,99,97,115,116,67,97,108,108,98,97,99,107,0,50,56,98,116,84,114,105,97,110,103,108,101,67,111,110,118,101,120,99,97,115,116,67,97,108,108,98,97,99,107,0,50,50,98,116,83,117,98,115,105,109,112,108,101,120,67,111,110,118,101,120,67,97,115,116,0,51,48,98,116,75,105,110,101,109,97,116,105,99,67,104,97,114,97,99,116,101,114,67,111,110,116,114,111,108,108,101,114,0,51,48,98,116,67,104,97,114,97,99,116,101,114,67,111,110,116,114,111,108,108,101,114,73,110,116,101,114,102,97,99,101,0,49,55,98,116,65,99,116,105,111,110,73,110,116,101,114,102,97,99,101,0,52,51,98,116,75,105,110,101,109,97,116,105,99,67,108,111,115,101,115,116,78,111,116,77,101,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,0,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,55,67,108,111,115,101,115,116,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,0,50,49,98,116,67,111,110,101,84,119,105,115,116,67,111,110,115,116,114,97,105,110,116,0,49,55,98,116,84,121,112,101,100,67,111,110,115,116,114,97,105,110,116,0,49,51,98,116,84,121,112,101,100,79,98,106,101,99,116,0,98,116,67,111,110,101,84,119,105,115,116,67,111,110,115,116,114,97,105,110,116,68,97,116,97,0,98,116,71,101,110,101,114,105,99,54,68,111,102,83,112,114,105,110,103,50,67,111,110,115,116,114,97,105,110,116,68,97,116,97,0,50,51,98,116,71,101,110,101,114,105,99,54,68,111,102,67,111,110,115,116,114,97,105,110,116,0,98,116,71,101,110,101,114,105,99,54,68,111,102,67,111,110,115,116,114,97,105,110,116,68,97,116,97,0,51,48,98,116,71,101,110,101,114,105,99,54,68,111,102,83,112,114,105,110,103,50,67,111,110,115,116,114,97,105,110,116,0,50,57,98,116,71,101,110,101,114,105,99,54,68,111,102,83,112,114,105,110,103,67,111,110,115,116,114,97,105,110,116,0,98,116,71,101,110,101,114,105,99,54,68,111,102,83,112,114,105,110,103,67,111,110,115,116,114,97,105,110,116,68,97,116,97,0,49,55,98,116,72,105,110,103,101,67,111,110,115,116,114,97,105,110,116,0,98,116,72,105,110,103,101,67,111,110,115,116,114,97,105,110,116,70,108,111,97,116,68,97,116,97,0,50,51,98,116,80,111,105,110,116,50,80,111,105,110,116,67,111,110,115,116,114,97,105,110,116,0,98,116,80,111,105,110,116,50,80,111,105,110,116,67,111,110,115,116,114,97,105,110,116,70,108,111,97,116,68,97,116,97,0,51,53,98,116,83,101,113,117,101,110,116,105,97,108,73,109,112,117,108,115,101,67,111,110,115,116,114,97,105,110,116,83,111,108,118,101,114,0,49,56,98,116,67,111,110,115,116,114,97,105,110,116,83,111,108,118,101,114,0,115,111,108,118,101,71,114,111,117,112,0,115,111,108,118,101,71,114,111,117,112,67,97,99,104,101,70,114,105,101,110,100,108,121,83,101,116,117,112,0,115,111,108,118,101,71,114,111,117,112,67,97,99,104,101,70,114,105,101,110,100,108,121,73,116,101,114,97,116,105,111,110,115,0,49,56,98,116,83,108,105,100,101,114,67,111,110,115,116,114,97,105,110,116,0,98,116,83,108,105,100,101,114,67,111,110,115,116,114,97,105,110,116,68,97,116,97,0,98,116,84,121,112,101,100,67,111,110,115,116,114,97,105,110,116,70,108,111,97,116,68,97,116,97,0,50,51,98,116,68,105,115,99,114,101,116,101,68,121,110,97,109,105,99,115,87,111,114,108,100,0,49,53,98,116,68,121,110,97,109,105,99,115,87,111,114,108,100,0,100,101,98,117,103,68,114,97,119,87,111,114,108,100,0,98,116,68,121,110,97,109,105,99,115,87,111,114,108,100,70,108,111,97,116,68,97,116,97,0,115,116,101,112,83,105,109,117,108,97,116,105,111,110,0,115,121,110,99,104,114,111,110,105,122,101,77,111,116,105,111,110,83,116,97,116,101,115,0,112,114,101,100,105,99,116,85,110,99,111,110,115,116,114,97,105,110,116,77,111,116,105,111,110,0,105,110,116,101,103,114,97,116,101,84,114,97,110,115,102,111,114,109,115,0,67,67,68,32,109,111,116,105,111,110,32,99,108,97,109,112,105,110,103,0,51,52,98,116,67,108,111,115,101,115,116,78,111,116,77,101,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,0,97,112,112,108,121,32,115,112,101,99,117,108,97,116,105,118,101,32,99,111,110,116,97,99,116,32,114,101,115,116,105,116,117,116,105,111,110,0,117,112,100,97,116,101,65,99,116,105,118,97,116,105,111,110,83,116,97,116,101,0,105,110,116,101,114,110,97,108,83,105,110,103,108,101,83,116,101,112,83,105,109,117,108,97,116,105,111,110,0,99,114,101,97,116,101,80,114,101,100,105,99,116,105,118,101,67,111,110,116,97,99,116,115,0,114,101,108,101,97,115,101,32,112,114,101,100,105,99,116,105,118,101,32,99,111,110,116,97,99,116,32,109,97,110,105,102,111,108,100,115,0,112,114,101,100,105,99,116,105,118,101,32,99,111,110,118,101,120,83,119,101,101,112,84,101,115,116,0,117,112,100,97,116,101,65,99,116,105,111,110,115,0,50,55,73,110,112,108,97,99,101,83,111,108,118,101,114,73,115,108,97,110,100,67,97,108,108,98,97,99,107,0,78,50,53,98,116,83,105,109,117,108,97,116,105,111,110,73,115,108,97,110,100,77,97,110,97,103,101,114,49,52,73,115,108,97,110,100,67,97,108,108,98,97,99,107,69,0,49,49,98,116,82,105,103,105,100,66,111,100,121,0,98,116,82,105,103,105,100,66,111,100,121,70,108,111,97,116,68,97,116,97,0,99,97,108,99,117,108,97,116,101,83,105,109,117,108,97,116,105,111,110,73,115,108,97,110,100,115,0,115,111,108,118,101,67,111,110,115,116,114,97,105,110,116,115,0,49,54,98,116,82,97,121,99,97,115,116,86,101,104,105,99,108,101,0,50,53,98,116,68,101,102,97,117,108,116,86,101,104,105,99,108,101,82,97,121,99,97,115,116,101,114,0,49,56,98,116,86,101,104,105,99,108,101,82,97,121,99,97,115,116,101,114,0,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,52,67,108,111,115,101,115,116,82,97,121,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,0,98,116,86,101,99,116,111,114,51,70,108,111,97,116,68,97,116,97,0,82,111,111,116,0,50,57,67,111,110,99,114,101,116,101,67,111,110,116,97,99,116,82,101,115,117,108,116,67,97,108,108,98,97,99,107,0,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,49,67,111,110,116,97,99,116,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,0,123,32,118,97,114,32,115,101,108,102,32,61,32,77,111,100,117,108,101,91,39,103,101,116,67,97,99,104,101,39,93,40,77,111,100,117,108,101,91,39,67,111,110,99,114,101,116,101,67,111,110,116,97,99,116,82,101,115,117,108,116,67,97,108,108,98,97,99,107,39,93,41,91,36,48,93,59,32,105,102,32,40,33,115,101,108,102,46,104,97,115,79,119,110,80,114,111,112,101,114,116,121,40,39,97,100,100,83,105,110,103,108,101,82,101,115,117,108,116,39,41,41,32,116,104,114,111,119,32,39,97,32,74,83,73,109,112,108,101,109,101,110,116,97,116,105,111,110,32,109,117,115,116,32,105,109,112,108,101,109,101,110,116,32,97,108,108,32,102,117,110,99,116,105,111,110,115,44,32,121,111,117,32,102,111,114,103,111,116,32,67,111,110,99,114,101,116,101,67,111,110,116,97,99,116,82,101,115,117,108,116,67,97,108,108,98,97,99,107,58,58,97,100,100,83,105,110,103,108,101,82,101,115,117,108,116,46,39,59,32,114,101,116,117,114,110,32,115,101,108,102,91,39,97,100,100,83,105,110,103,108,101,82,101,115,117,108,116,39,93,40,36,49,44,36,50,44,36,51,44,36,52,44,36,53,44,36,54,44,36,55,41,59,32,125,0,50,48,98,116,68,101,102,97,117,108,116,77,111,116,105,111,110,83,116,97,116,101,0,49,51,98,116,77,111,116,105,111,110,83,116,97,116,101,0,49,57,98,116,71,104,111,115,116,80,97,105,114,67,97,108,108,98,97,99,107,0,17,0,10,0,17,17,17,0,0,0,0,5,0,0,0,0,0,0,9,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,15,10,17,17,17,3,10,7,0,1,19,9,11,11,0,0,9,6,11,0,0,11,0,6,17,0,0,0,17,17,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,10,10,17,17,17,0,10,0,0,2,0,9,11,0,0,0,9,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,13,0,0,0,4,13,0,0,0,0,9,14,0,0,0,0,0,14,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,15,0,0,0,0,9,16,0,0,0,0,0,16,0,0,16,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,10,0,0,0,0,9,11,0,0,0,0,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,45,43,32,32,32,48,88,48,120,0,84,33,34,25,13,1,2,3,17,75,28,12,16,4,11,29,18,30,39,104,110,111,112,113,98,32,5,6,15,19,20,21,26,8,22,7,40,36,23,24,9,10,14,27,31,37,35,131,130,125,38,42,43,60,61,62,63,67,71,74,77,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,105,106,107,108,114,115,116,121,122,123,124,0,73,108,108,101,103,97,108,32,98,121,116,101,32,115,101,113,117,101,110,99,101,0,68,111,109,97,105,110,32,101,114,114,111,114,0,82,101,115,117,108,116,32,110,111,116,32,114,101,112,114,101,115,101,110,116,97,98,108,101,0,78,111,116,32,97,32,116,116,121,0,80,101,114,109,105,115,115,105,111,110,32,100,101,110,105,101,100,0,79,112,101,114,97,116,105,111,110,32,110,111,116,32,112,101,114,109,105,116,116,101,100,0,78,111,32,115,117,99,104,32,102,105,108,101,32,111,114,32,100,105,114,101,99,116,111,114,121,0,78,111,32,115,117,99,104,32,112,114,111,99,101,115,115,0,70,105,108,101,32,101,120,105,115,116,115,0,86,97,108,117,101,32,116,111,111,32,108,97,114,103,101,32,102,111,114,32,100,97,116,97,32,116,121,112,101,0,78,111,32,115,112,97,99,101,32,108,101,102,116,32,111,110,32,100,101,118,105,99,101,0,79,117,116,32,111,102,32,109,101,109,111,114,121,0,82,101,115,111,117,114,99,101,32,98,117,115,121,0,73,110,116,101,114,114,117,112,116,101,100,32,115,121,115,116,101,109,32,99,97,108,108,0,82,101,115,111,117,114,99,101,32,116,101,109,112,111,114,97,114,105,108,121,32,117,110,97,118,97,105,108,97,98,108,101,0,73,110,118,97,108,105,100,32,115,101,101,107,0,67,114,111,115,115,45,100,101,118,105,99,101,32,108,105,110,107,0,82,101,97,100,45,111,110,108,121,32,102,105,108,101,32,115,121,115,116,101,109,0,68,105,114,101,99,116,111,114,121,32,110,111,116,32,101,109,112,116,121,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,112,101,101,114,0,79,112,101,114,97,116,105,111,110,32,116,105,109,101,100,32,111,117,116,0,67,111,110,110,101,99,116,105,111,110,32,114,101,102,117,115,101,100,0,72,111,115,116,32,105,115,32,100,111,119,110,0,72,111,115,116,32,105,115,32,117,110,114,101,97,99,104,97,98,108,101,0,65,100,100,114,101,115,115,32,105,110,32,117,115,101,0,66,114,111,107,101,110,32,112,105,112,101,0,73,47,79,32,101,114,114,111,114,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,32,111,114,32,97,100,100,114,101,115,115,0,66,108,111,99,107,32,100,101,118,105,99,101,32,114,101,113,117,105,114,101,100,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,0,78,111,116,32,97,32,100,105,114,101,99,116,111,114,121,0,73,115,32,97,32,100,105,114,101,99,116,111,114,121,0,84,101,120,116,32,102,105,108,101,32,98,117,115,121,0,69,120,101,99,32,102,111,114,109,97,116,32,101,114,114,111,114,0,73,110,118,97,108,105,100,32,97,114,103,117,109,101,110,116,0,65,114,103,117,109,101,110,116,32,108,105,115,116,32,116,111,111,32,108,111,110,103,0,83,121,109,98,111,108,105,99,32,108,105,110,107,32,108,111,111,112,0,70,105,108,101,110,97,109,101,32,116,111,111,32,108,111,110,103,0,84,111,111,32,109,97,110,121,32,111,112,101,110,32,102,105,108,101,115,32,105,110,32,115,121,115,116,101,109,0,78,111,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,115,32,97,118,97,105,108,97,98,108,101,0,66,97,100,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,0,78,111,32,99,104,105,108,100,32,112,114,111,99,101,115,115,0,66,97,100,32,97,100,100,114,101,115,115,0,70,105,108,101,32,116,111,111,32,108,97,114,103,101,0,84,111,111,32,109,97,110,121,32,108,105,110,107,115,0,78,111,32,108,111,99,107,115,32,97,118,97,105,108,97,98,108,101,0,82,101,115,111,117,114,99,101,32,100,101,97,100,108,111,99,107,32,119,111,117,108,100,32,111,99,99,117,114,0,83,116,97,116,101,32,110,111,116,32,114,101,99,111,118,101,114,97,98,108,101,0,80,114,101,118,105,111,117,115,32,111,119,110,101,114,32,100,105,101,100,0,79,112,101,114,97,116,105,111,110,32,99,97,110,99,101,108,101,100,0,70,117,110,99,116,105,111,110,32,110,111,116,32,105,109,112,108,101,109,101,110,116,101,100,0,78,111,32,109,101,115,115,97,103,101,32,111,102,32,100,101,115,105,114,101,100,32,116,121,112,101,0,73,100,101,110,116,105,102,105,101,114,32,114,101,109,111,118,101,100,0,68,101,118,105,99,101,32,110,111,116,32,97,32,115,116,114,101,97,109,0,78,111,32,100,97,116,97,32,97,118,97,105,108,97,98,108,101,0,68,101,118,105,99,101,32,116,105,109,101,111,117,116,0,79,117,116,32,111,102,32,115,116,114,101,97,109,115,32,114,101,115,111,117,114,99,101,115,0,76,105,110,107,32,104,97,115,32,98,101,101,110,32,115,101,118,101,114,101,100,0,80,114,111,116,111,99,111,108,32,101,114,114,111,114,0,66,97,100,32,109,101,115,115,97,103,101,0,70,105,108,101,32,100,101,115,99,114,105,112,116,111,114,32,105,110,32,98,97,100,32,115,116,97,116,101,0,78,111,116,32,97,32,115,111,99,107,101,116,0,68,101,115,116,105,110,97,116,105,111,110,32,97,100,100,114,101,115,115,32,114,101,113,117,105,114,101,100,0,77,101,115,115,97,103,101,32,116,111,111,32,108,97,114,103,101,0,80,114,111,116,111,99,111,108,32,119,114,111,110,103,32,116,121,112,101,32,102,111,114,32,115,111,99,107,101,116,0,80,114,111,116,111,99,111,108,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,80,114,111,116,111,99,111,108,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,83,111,99,107,101,116,32,116,121,112,101,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,78,111,116,32,115,117,112,112,111,114,116,101,100,0,80,114,111,116,111,99,111,108,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,65,100,100,114,101,115,115,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,32,98,121,32,112,114,111,116,111,99,111,108,0,65,100,100,114,101,115,115,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,78,101,116,119,111,114,107,32,105,115,32,100,111,119,110,0,78,101,116,119,111,114,107,32,117,110,114,101,97,99,104,97,98,108,101,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,110,101,116,119,111,114,107,0,67,111,110,110,101,99,116,105,111,110,32,97,98,111,114,116,101,100,0,78,111,32,98,117,102,102,101,114,32,115,112,97,99,101,32,97,118,97,105,108,97,98,108,101,0,83,111,99,107,101,116,32,105,115,32,99,111,110,110,101,99,116,101,100,0,83,111,99,107,101,116,32,110,111,116,32,99,111,110,110,101,99,116,101,100,0,67,97,110,110,111,116,32,115,101,110,100,32,97,102,116,101,114,32,115,111,99,107,101,116,32,115,104,117,116,100,111,119,110,0,79,112,101,114,97,116,105,111,110,32,97,108,114,101,97,100,121,32,105,110,32,112,114,111,103,114,101,115,115,0,79,112,101,114,97,116,105,111,110,32,105,110,32,112,114,111,103,114,101,115,115,0,83,116,97,108,101,32,102,105,108,101,32,104,97,110,100,108,101,0,82,101,109,111,116,101,32,73,47,79,32,101,114,114,111,114,0,81,117,111,116,97,32,101,120,99,101,101,100,101,100,0,78,111,32,109,101,100,105,117,109,32,102,111,117,110,100,0,87,114,111,110,103,32,109,101,100,105,117,109,32,116,121,112,101,0,78,111,32,101,114,114,111,114,32,105,110,102,111,114,109,97,116,105,111,110,0,0,40,110,117,108,108,41,0,45,48,88,43,48,88,32,48,88,45,48,120,43,48,120,32,48,120,0,105,110,102,0,73,78,70,0,110,97,110,0,78,65,78,0,46,0,99,97,110,110,111,116,32,122,101,114,111,32,111,117,116,32,116,104,114,101,97,100,32,118,97,108,117,101,32,102,111,114,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,40,41,0,99,97,110,110,111,116,32,99,114,101,97,116,101,32,112,116,104,114,101,97,100,32,107,101,121,32,102,111,114,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,40,41,0,112,116,104,114,101,97,100,95,111,110,99,101,32,102,97,105,108,117,114,101,32,105,110,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,95,102,97,115,116,40,41,0,78,49,48,95,95,99,120,120,97,98,105,118,49,50,48,95,95,115,105,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,54,95,95,115,104,105,109,95,116,121,112,101,95,105,110,102,111,69,0,83,116,57,116,121,112,101,95,105,110,102,111,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,55,95,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,83,116,57,101,120,99,101,112,116,105,111,110,0,117,110,99,97,117,103,104,116,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,101,120,99,101,112,116,105,111,110,32,111,102,32,116,121,112,101,32,37,115,58,32,37,115,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,101,120,99,101,112,116,105,111,110,32,111,102,32,116,121,112,101,32,37,115,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,102,111,114,101,105,103,110,32,101,120,99,101,112,116,105,111,110,0,116,101,114,109,105,110,97,116,105,110,103,0,116,101,114,109,105,110,97,116,101,95,104,97,110,100,108,101,114,32,117,110,101,120,112,101,99,116,101,100,108,121,32,114,101,116,117,114,110,101,100,0,83,116,57,98,97,100,95,97,108,108,111,99,0,115,116,100,58,58,98,97,100,95,97,108,108,111,99,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,57,95,95,112,111,105,110,116,101,114,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,55,95,95,112,98,97,115,101,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,50,49,95,95,118,109,105,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0],"i8",V,m.GLOBAL_BASE+10240);var qt=nt;function Kt(){return!!Kt.uncaught_exception}nt+=16,r._i64Subtract=Na,r._i64Add=vu;var Zt={last:0,caught:[],infos:{},deAdjust:function(t){if(!t||Zt.infos[t])return t;for(var e in Zt.infos)if(Zt.infos[e].adjusted===t)return e;return t},addRef:function(t){t&&Zt.infos[t].refcount++},decRef:function(t){if(t){var e=Zt.infos[t];x(e.refcount>0),e.refcount--,0===e.refcount&&(e.destructor&&m.dynCall("vi",e.destructor,[t]),delete Zt.infos[t],___cxa_free_exception(t))}},clearRef:function(t){t&&(Zt.infos[t].refcount=0)}};function Qt(t){throw Zt.last||(Zt.last=t),Zt.clearRef(Zt.deAdjust(t)),t+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function $t(){var t=Zt.last;if(!t)return 0|(di.setTempRet0(0),0);var e=Zt.infos[t],i=e.type;if(!i)return 0|(di.setTempRet0(0),t);var n=Array.prototype.slice.call(arguments);r.___cxa_is_pointer_type(i),$t.buffer||($t.buffer=ce(4)),L[$t.buffer>>2]=t,t=$t.buffer;for(var s=0;s<n.length;s++)if(n[s]&&r.___cxa_can_catch(n[s],i,t))return t=L[t>>2],e.adjusted=t,0|(di.setTempRet0(n[s]),t);return t=L[t>>2],0|(di.setTempRet0(i),t)}function Jt(t,e,i){throw Zt.infos[t]={ptr:t,adjusted:t,type:e,destructor:i,refcount:0},Zt.last=t,"uncaught_exception"in Kt?Kt.uncaught_exception++:Kt.uncaught_exception=1,t+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function te(){}function ee(){r.abort()}function ie(t,e){ie.seen||(ie.seen={}),t in ie.seen||(m.dynCall("v",e),ie.seen[t]=1)}r._memset=Np,r._bitshift64Shl=ml;var ne={};function se(t){return ne[t]||0}var re=1,oe={EPERM:1,ENOENT:2,ESRCH:3,EINTR:4,EIO:5,ENXIO:6,E2BIG:7,ENOEXEC:8,EBADF:9,ECHILD:10,EAGAIN:11,EWOULDBLOCK:11,ENOMEM:12,EACCES:13,EFAULT:14,ENOTBLK:15,EBUSY:16,EEXIST:17,EXDEV:18,ENODEV:19,ENOTDIR:20,EISDIR:21,EINVAL:22,ENFILE:23,EMFILE:24,ENOTTY:25,ETXTBSY:26,EFBIG:27,ENOSPC:28,ESPIPE:29,EROFS:30,EMLINK:31,EPIPE:32,EDOM:33,ERANGE:34,ENOMSG:42,EIDRM:43,ECHRNG:44,EL2NSYNC:45,EL3HLT:46,EL3RST:47,ELNRNG:48,EUNATCH:49,ENOCSI:50,EL2HLT:51,EDEADLK:35,ENOLCK:37,EBADE:52,EBADR:53,EXFULL:54,ENOANO:55,EBADRQC:56,EBADSLT:57,EDEADLOCK:35,EBFONT:59,ENOSTR:60,ENODATA:61,ETIME:62,ENOSR:63,ENONET:64,ENOPKG:65,EREMOTE:66,ENOLINK:67,EADV:68,ESRMNT:69,ECOMM:70,EPROTO:71,EMULTIHOP:72,EDOTDOT:73,EBADMSG:74,ENOTUNIQ:76,EBADFD:77,EREMCHG:78,ELIBACC:79,ELIBBAD:80,ELIBSCN:81,ELIBMAX:82,ELIBEXEC:83,ENOSYS:38,ENOTEMPTY:39,ENAMETOOLONG:36,ELOOP:40,EOPNOTSUPP:95,EPFNOSUPPORT:96,ECONNRESET:104,ENOBUFS:105,EAFNOSUPPORT:97,EPROTOTYPE:91,ENOTSOCK:88,ENOPROTOOPT:92,ESHUTDOWN:108,ECONNREFUSED:111,EADDRINUSE:98,ECONNABORTED:103,ENETUNREACH:101,ENETDOWN:100,ETIMEDOUT:110,EHOSTDOWN:112,EHOSTUNREACH:113,EINPROGRESS:115,EALREADY:114,EDESTADDRREQ:89,EMSGSIZE:90,EPROTONOSUPPORT:93,ESOCKTNOSUPPORT:94,EADDRNOTAVAIL:99,ENETRESET:102,EISCONN:106,ENOTCONN:107,ETOOMANYREFS:109,EUSERS:87,EDQUOT:122,ESTALE:116,ENOTSUP:95,ENOMEDIUM:123,EILSEQ:84,EOVERFLOW:75,ECANCELED:125,ENOTRECOVERABLE:131,EOWNERDEAD:130,ESTRPIPE:86};function ae(t,e){return 0==t?oe.EINVAL:(L[t>>2]=re,ne[re]=0,re++,0)}var le=Ut;function he(t,e){return t in ne?(ne[t]=e,0):oe.EINVAL}function ce(t){return m.dynamicAlloc(t+8)+8&4294967288}function _e(t){return ce(t)}function ue(){throw S=!0,"Pure virtual function called!"}function de(t,e){bt.push((function(){m.dynCall("vi",t,[e])})),de.level=bt.length}function pe(){x(de.level==bt.length,"cannot pop if something else added meanwhile!"),bt.pop(),de.level=bt.length}function fe(t){return Kt.uncaught_exception--,Zt.caught.push(t),Zt.addRef(Zt.deAdjust(t)),t}function me(t,e,i){return R.set(R.subarray(e,e+i),t),t}r._malloc=ce,r._bitshift64Ashr=yh,r._bitshift64Lshr=td,r._memcpy=fd;var ge={varargs:0,get:function(t){return ge.varargs+=4,L[ge.varargs-4>>2]},getStr:function(){return G(ge.get())},get64:function(){var t=ge.get(),e=ge.get();return x(t>=0?0===e:-1===e),t},getZero:function(){x(0===ge.get())}};function be(t,e){ge.varargs=e;try{var i=ge.getStreamFromFD();return FS.close(i),0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||gm(t),-t.errno}}function ye(t){var e=ye;e.called||(lt=et(lt),e.called=!0,x(m.dynamicAlloc),e.alloc=m.dynamicAlloc,m.dynamicAlloc=function(){gm("cannot dynamically allocate, sbrk now has control")});var i=lt;return 0==t||e.alloc(t)?i:-1>>>0}function ve(t){var e=Date.now();return L[t>>2]=e/1e3|0,L[t+4>>2]=e%1e3*1e3|0,0}function Se(){gm("trap!")}function xe(t,e){ge.varargs=e;try{var i=ge.getStreamFromFD(),n=ge.get(),s=ge.get(),r=ge.get(),o=ge.get(),a=s;return x(0===n),FS.llseek(i,a,o),L[r>>2]=i.position,i.getdents&&0===a&&0===o&&(i.getdents=null),0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||gm(t),-t.errno}}function we(t,e){ge.varargs=e;try{var i=ge.get(),n=ge.get(),s=ge.get(),o=0;we.buffer||(we.buffers=[null,[],[]],we.printChar=function(t,e){var i=we.buffers[t];x(i),0===e||10===e?((1===t?r.print:r.printErr)(X(i,0)),i.length=0):i.push(e)});for(var a=0;a<s;a++){for(var l=L[n+8*a>>2],h=L[n+(8*a+4)>>2],c=0;c<h;c++)we.printChar(i,R[l+c]);o+=h}return o}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||gm(t),-t.errno}}r._memmove=Yl,r._llvm_bswap_i32=yp,r._pthread_self=ar,bt.push((function(){var t=r._fflush;t&&t(0);var e=we.printChar;if(e){var i=we.buffers;i[1].length&&e(1,10),i[2].length&&e(2,10)}})),rt=ot=m.alignMemory(nt),st=!0,at=rt+_t,lt=m.alignMemory(at);var Ce=z([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",U);function Te(t,e,i,n,s,o){try{r.dynCall_viiiii(t,e,i,n,s,o)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Ae(t,e,i){try{r.dynCall_vid(t,e,i)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Ee(t,e){try{r.dynCall_vi(t,e)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Me(t,e,i,n,s,o,a){try{r.dynCall_viiidii(t,e,i,n,s,o,a)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Re(t,e,i){try{r.dynCall_vii(t,e,i)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Ie(t,e,i,n,s,o,a,l,h,c,_){try{return r.dynCall_iiiiiiiiiii(t,e,i,n,s,o,a,l,h,c,_)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Pe(t,e){try{return r.dynCall_ii(t,e)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Le(t,e,i,n,s){try{r.dynCall_viidi(t,e,i,n,s)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function De(t,e,i,n,s,o,a){try{r.dynCall_viddiii(t,e,i,n,s,o,a)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function ke(t,e,i,n,s){try{r.dynCall_vidii(t,e,i,n,s)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Oe(t,e,i,n,s){try{return r.dynCall_iiiii(t,e,i,n,s)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Fe(t,e,i,n){try{r.dynCall_vidi(t,e,i,n)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Be(t,e,i,n,s,o,a,l,h){try{return r.dynCall_diiiiiiii(t,e,i,n,s,o,a,l,h)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Ne(t,e,i,n,s,o,a,l,h,c,_,u){try{r.dynCall_viiiiddddiid(t,e,i,n,s,o,a,l,h,c,_,u)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Ue(t,e,i,n,s,o){try{return r.dynCall_diiiii(t,e,i,n,s,o)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Ve(t,e,i,n){try{return r.dynCall_iiii(t,e,i,n)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function ze(t,e,i,n,s,o,a){try{r.dynCall_viiiiii(t,e,i,n,s,o,a)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function We(t,e,i,n){try{return r.dynCall_iiid(t,e,i,n)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Ge(t,e){try{return r.dynCall_di(t,e)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function je(t,e,i,n,s,o,a){try{return r.dynCall_iiiiiii(t,e,i,n,s,o,a)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function He(t,e,i,n,s,o,a){try{return r.dynCall_diiidii(t,e,i,n,s,o,a)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Xe(t,e,i,n,s,o){try{r.dynCall_viidii(t,e,i,n,s,o)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Ye(t,e,i,n,s,o,a,l){try{r.dynCall_viiiiiii(t,e,i,n,s,o,a,l)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function qe(t,e,i,n,s,o,a,l,h,c){try{r.dynCall_viiiiiiiii(t,e,i,n,s,o,a,l,h,c)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Ke(t,e,i,n,s,o,a,l,h,c,_){try{r.dynCall_viiiiiiiiii(t,e,i,n,s,o,a,l,h,c,_)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Ze(t,e,i){try{return r.dynCall_iii(t,e,i)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Qe(t,e,i,n){try{return r.dynCall_diii(t,e,i,n)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function $e(t,e,i,n,s,o,a,l,h,c,_){try{return r.dynCall_diiiiiiiiii(t,e,i,n,s,o,a,l,h,c,_)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function Je(t,e,i,n,s,o){try{r.dynCall_viiiid(t,e,i,n,s,o)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function ti(t,e,i,n,s,o,a,l,h,c){try{return r.dynCall_diiiiiiiii(t,e,i,n,s,o,a,l,h,c)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function ei(t,e,i){try{return r.dynCall_did(t,e,i)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function ii(t,e,i,n,s,o,a,l,h,c,_,u,d){try{r.dynCall_viiiidddddidi(t,e,i,n,s,o,a,l,h,c,_,u,d)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function ni(t,e,i,n,s,o){try{return r.dynCall_diidii(t,e,i,n,s,o)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function si(t,e,i,n,s){try{return r.dynCall_diiii(t,e,i,n,s)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function ri(t,e,i,n,s,o,a,l,h,c){try{return r.dynCall_iiiiiiiiii(t,e,i,n,s,o,a,l,h,c)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function oi(t,e,i,n,s){try{r.dynCall_viiid(t,e,i,n,s)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function ai(t,e,i,n){try{r.dynCall_viii(t,e,i,n)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function li(t){try{r.dynCall_v(t)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function hi(t,e,i,n){try{r.dynCall_viid(t,e,i,n)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function ci(t,e,i,n,s){try{return r.dynCall_iidid(t,e,i,n,s)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}function _i(t,e,i,n,s){try{r.dynCall_viiii(t,e,i,n,s)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;di.setThrew(1,0)}}r.asmGlobalArg={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},r.asmLibraryArg={abort:gm,assert:x,invoke_viiiii:Te,invoke_vid:Ae,invoke_vi:Ee,invoke_viiidii:Me,invoke_vii:Re,invoke_iiiiiiiiiii:Ie,invoke_ii:Pe,invoke_viidi:Le,invoke_viddiii:De,invoke_vidii:ke,invoke_iiiii:Oe,invoke_vidi:Fe,invoke_diiiiiiii:Be,invoke_viiiiddddiid:Ne,invoke_diiiii:Ue,invoke_iiii:Ve,invoke_viiiiii:ze,invoke_iiid:We,invoke_di:Ge,invoke_iiiiiii:je,invoke_diiidii:He,invoke_viidii:Xe,invoke_viiiiiii:Ye,invoke_viiiiiiiii:qe,invoke_viiiiiiiiii:Ke,invoke_iii:Ze,invoke_diii:Qe,invoke_diiiiiiiiii:$e,invoke_viiiid:Je,invoke_diiiiiiiii:ti,invoke_did:ei,invoke_viiiidddddidi:ii,invoke_diidii:ni,invoke_diiii:si,invoke_iiiiiiiiii:ri,invoke_viiid:oi,invoke_viii:ai,invoke_v:li,invoke_viid:hi,invoke_iidid:ci,invoke_viiii:_i,_pthread_cleanup_pop:pe,_abort:ee,___gxx_personality_v0:te,___cxa_allocate_exception:_e,__ZSt18uncaught_exceptionv:Kt,_sbrk:ye,_llvm_pow_f32:le,___cxa_begin_catch:fe,_emscripten_memcpy_big:me,___resumeException:Qt,___cxa_find_matching_catch:$t,_pthread_getspecific:se,_pthread_once:ie,_llvm_trap:Se,_pthread_key_create:ae,_emscripten_asm_const_diiiiiiii:Yt,_pthread_setspecific:he,___cxa_throw:Jt,___syscall6:be,_pthread_cleanup_push:de,_gettimeofday:ve,___syscall140:xe,___cxa_pure_virtual:ue,___syscall146:we,STACKTOP:ot,STACK_MAX:at,tempDoublePtr:qt,ABORT:S,cttz_i8:Ce};var ui,di=function(t,e,i){"use asm";var n=new t.Int8Array(i);var s=new t.Int16Array(i);var r=new t.Int32Array(i);var o=new t.Uint8Array(i);var a=new t.Uint16Array(i);var l=new t.Uint32Array(i);var h=new t.Float32Array(i);var c=new t.Float64Array(i);var _=e.STACKTOP|0;var u=e.STACK_MAX|0;var d=e.tempDoublePtr|0;var p=e.ABORT|0;var f=e.cttz_i8|0;var m=0;var g=0;var b=0;var y=0;var v=t.NaN,S=t.Infinity;var x=0,w=0,C=0,T=0,A=0.0,E=0,M=0,R=0,I=0.0;var P=0;var L=0;var D=0;var k=0;var O=0;var F=0;var B=0;var N=0;var U=0;var V=0;var z=t.Math.floor;var W=t.Math.abs;var G=t.Math.sqrt;var j=t.Math.pow;var H=t.Math.cos;var X=t.Math.sin;var Y=t.Math.tan;var q=t.Math.acos;var K=t.Math.asin;var Z=t.Math.atan;var Q=t.Math.atan2;var $=t.Math.exp;var J=t.Math.log;var tt=t.Math.ceil;var et=t.Math.imul;var it=t.Math.min;var nt=t.Math.clz32;var st=e.abort;var rt=e.assert;var ot=e.invoke_viiiii;var at=e.invoke_vid;var lt=e.invoke_vi;var ht=e.invoke_viiidii;var ct=e.invoke_vii;var _t=e.invoke_iiiiiiiiiii;var ut=e.invoke_ii;var dt=e.invoke_viidi;var pt=e.invoke_viddiii;var ft=e.invoke_vidii;var mt=e.invoke_iiiii;var gt=e.invoke_vidi;var bt=e.invoke_diiiiiiii;var yt=e.invoke_viiiiddddiid;var vt=e.invoke_diiiii;var St=e.invoke_iiii;var xt=e.invoke_viiiiii;var wt=e.invoke_iiid;var Ct=e.invoke_di;var Tt=e.invoke_iiiiiii;var At=e.invoke_diiidii;var Et=e.invoke_viidii;var Mt=e.invoke_viiiiiii;var Rt=e.invoke_viiiiiiiii;var It=e.invoke_viiiiiiiiii;var Pt=e.invoke_iii;var Lt=e.invoke_diii;var Dt=e.invoke_diiiiiiiiii;var kt=e.invoke_viiiid;var Ot=e.invoke_diiiiiiiii;var Ft=e.invoke_did;var Bt=e.invoke_viiiidddddidi;var Nt=e.invoke_diidii;var Ut=e.invoke_diiii;var Vt=e.invoke_iiiiiiiiii;var zt=e.invoke_viiid;var Wt=e.invoke_viii;var Gt=e.invoke_v;var jt=e.invoke_viid;var Ht=e.invoke_iidid;var Xt=e.invoke_viiii;var Yt=e._pthread_cleanup_pop;var qt=e._abort;var Kt=e.___gxx_personality_v0;var Zt=e.___cxa_allocate_exception;var Qt=e.__ZSt18uncaught_exceptionv;var $t=e._sbrk;var Jt=e._llvm_pow_f32;var te=e.___cxa_begin_catch;var ee=e._emscripten_memcpy_big;var ie=e.___resumeException;var ne=e.___cxa_find_matching_catch;var se=e._pthread_getspecific;var re=e._pthread_once;var oe=e._llvm_trap;var ae=e._pthread_key_create;var le=e._emscripten_asm_const_diiiiiiii;var he=e._pthread_setspecific;var ce=e.___cxa_throw;var _e=e.___syscall6;var ue=e._pthread_cleanup_push;var de=e._gettimeofday;var pe=e.___syscall140;var fe=e.___cxa_pure_virtual;var me=e.___syscall146;var ge=0.0;function be(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0,l=0,c=0,u=0,d=0,p=0,f=0,m=0,g=0,b=0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0;b=_;_=_+16|0;r[5637]=(r[5637]|0)+1;s=Zl(1479)|0;if(!s)g=0;else{r[(s+4+15&-16)+-4>>2]=s;g=s+4+15&-16}if(!(n[19880]|0)){n[19880]=1;r[b>>2]=0;r[b+4>>2]=0;r[b+8>>2]=0;r[b+12>>2]=0;zy(21260,0.0,0,0,b)}r[5366]=r[5366]|1;h[5407]=0.0;y=+h[5417]*0.0;v=+h[5418]*0.0;h[5412]=+h[5416]*0.0;h[5413]=y;h[5414]=v;h[5415]=0.0;r[5420]=0;r[5421]=0;r[5422]=0;r[5423]=0;v=+h[5409]*0.0;y=+h[5410]*0.0;h[5461]=+h[5408]*0.0;h[5462]=v;h[5463]=y;h[5464]=0.0;r[g+4>>2]=12;r[g+8>>2]=-1;r[g+12>>2]=-1;h[g+16>>2]=3402823466385288598117041.0e14;n[g+20>>0]=1;n[g+21>>0]=0;r[g+24>>2]=-1;c=g+28|0;r[c>>2]=21260;u=g+32|0;r[u>>2]=t;h[g+36>>2]=0.0;h[g+40>>2]=.30000001192092896;r[g+44>>2]=0;r[g>>2]=7300;d=g+112|0;r[d>>2]=r[e>>2];r[d+4>>2]=r[e+4>>2];r[d+8>>2]=r[e+8>>2];r[d+12>>2]=r[e+12>>2];p=g+128|0;r[p>>2]=r[e+16>>2];r[p+4>>2]=r[e+16+4>>2];r[p+8>>2]=r[e+16+8>>2];r[p+12>>2]=r[e+16+12>>2];f=g+144|0;r[f>>2]=r[e+32>>2];r[f+4>>2]=r[e+32+4>>2];r[f+8>>2]=r[e+32+8>>2];r[f+12>>2]=r[e+32+12>>2];m=g+160|0;r[m>>2]=r[e+48>>2];r[m+4>>2]=r[e+48+4>>2];r[m+8>>2]=r[e+48+8>>2];r[m+12>>2]=r[e+48+12>>2];s=g+728|0;e=g+760|0;o=g+908|0;a=g+680|0;l=a+48|0;do{r[a>>2]=0;a=a+4|0}while((a|0)<(l|0));r[s>>2]=1045220557;r[g+732>>2]=1045220557;r[g+736>>2]=1045220557;a=g+740|0;r[a>>2]=0;r[a+4>>2]=0;r[a+8>>2]=0;r[a+12>>2]=0;r[a+16>>2]=0;r[e>>2]=1063675494;r[g+764>>2]=1063675494;r[g+768>>2]=1063675494;a=g+772|0;h[g+804>>2]=0.0;h[g+820>>2]=0.0;n[g+836>>0]=0;h[g+840>>2]=0.0;n[g+856>>0]=0;h[g+860>>2]=0.0;h[g+876>>2]=0.0;h[g+892>>2]=0.0;h[g+808>>2]=0.0;h[g+824>>2]=0.0;n[g+837>>0]=0;h[g+844>>2]=0.0;n[g+857>>0]=0;h[g+864>>2]=0.0;h[g+880>>2]=0.0;h[g+896>>2]=0.0;h[g+812>>2]=0.0;h[g+828>>2]=0.0;n[g+838>>0]=0;h[g+848>>2]=0.0;n[g+858>>0]=0;h[g+868>>2]=0.0;h[g+884>>2]=0.0;h[g+900>>2]=0.0;r[a>>2]=0;r[a+4>>2]=0;r[a+8>>2]=0;r[a+12>>2]=0;r[a+16>>2]=0;r[a+20>>2]=0;r[a+24>>2]=0;n[a+28>>0]=0;a=o;l=a+60|0;do{r[a>>2]=0;a=a+4|0}while((a|0)<(l|0));h[g+968>>2]=1.0;h[g+972>>2]=-1.0;h[g+976>>2]=0.0;h[g+980>>2]=.20000000298023224;h[g+984>>2]=0.0;h[g+988>>2]=.8999999761581421;h[g+992>>2]=0.0;n[g+996>>0]=0;h[g+1e3>>2]=0.0;h[g+1004>>2]=.10000000149011612;n[g+1008>>0]=0;h[g+1012>>2]=0.0;n[g+1016>>0]=0;h[g+1020>>2]=0.0;n[g+1024>>0]=0;h[g+1028>>2]=0.0;n[g+1032>>0]=0;l=g+1036|0;r[l>>2]=0;r[l+4>>2]=0;r[l+8>>2]=0;r[l+12>>2]=0;r[l+16>>2]=0;h[g+1056>>2]=1.0;h[g+1060>>2]=-1.0;h[g+1064>>2]=0.0;h[g+1068>>2]=.20000000298023224;h[g+1072>>2]=0.0;h[g+1076>>2]=.8999999761581421;h[g+1080>>2]=0.0;n[g+1084>>0]=0;h[g+1088>>2]=0.0;h[g+1092>>2]=.10000000149011612;n[g+1096>>0]=0;h[g+1100>>2]=0.0;n[g+1104>>0]=0;h[g+1108>>2]=0.0;n[g+1112>>0]=0;h[g+1116>>2]=0.0;n[g+1120>>0]=0;l=g+1124|0;r[l>>2]=0;r[l+4>>2]=0;r[l+8>>2]=0;r[l+12>>2]=0;r[l+16>>2]=0;h[g+1144>>2]=1.0;h[g+1148>>2]=-1.0;h[g+1152>>2]=0.0;h[g+1156>>2]=.20000000298023224;h[g+1160>>2]=0.0;h[g+1164>>2]=.8999999761581421;h[g+1168>>2]=0.0;n[g+1172>>0]=0;h[g+1176>>2]=0.0;h[g+1180>>2]=.10000000149011612;n[g+1184>>0]=0;h[g+1188>>2]=0.0;n[g+1192>>0]=0;h[g+1196>>2]=0.0;n[g+1200>>0]=0;h[g+1204>>2]=0.0;n[g+1208>>0]=0;l=g+1212|0;r[l>>2]=0;r[l+4>>2]=0;r[l+8>>2]=0;r[l+12>>2]=0;r[l+16>>2]=0;r[g+1232>>2]=i;r[g+1456>>2]=0;D=+h[d>>2];U=+h[t+4>>2];L=+h[p>>2];N=+h[t+8>>2];P=+h[f>>2];B=+h[t+12>>2];I=+h[g+116>>2];R=+h[g+132>>2];M=+h[g+148>>2];E=+h[g+120>>2];T=+h[g+136>>2];w=+h[g+152>>2];F=+h[t+20>>2];O=+h[t+24>>2];k=+h[t+28>>2];A=+h[t+36>>2];C=+h[t+40>>2];x=+h[t+44>>2];z=+h[m>>2];V=+h[g+164>>2];v=+h[g+168>>2];S=+h[t+52>>2]+(U*z+N*V+B*v);y=F*z+O*V+k*v+ +h[t+56>>2];v=A*z+C*V+x*v+ +h[t+60>>2];h[g+48>>2]=D*U+L*N+P*B;h[g+52>>2]=U*I+N*R+B*M;h[g+56>>2]=U*E+N*T+B*w;h[g+60>>2]=0.0;h[g+64>>2]=D*F+L*O+P*k;h[g+68>>2]=I*F+R*O+M*k;h[g+72>>2]=E*F+T*O+w*k;h[g+76>>2]=0.0;h[g+80>>2]=D*A+L*C+P*x;h[g+84>>2]=I*A+R*C+M*x;h[g+88>>2]=E*A+T*C+w*x;h[g+92>>2]=0.0;h[g+96>>2]=S;h[g+100>>2]=y;h[g+104>>2]=v;h[g+108>>2]=0.0;cM(g,(r[c>>2]|0)+4|0,(r[u>>2]|0)+4|0);_=b;return g|0}function ye(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0,l=0,c=0,_=0;r[5637]=(r[5637]|0)+1;a=Zl(1479)|0;if(!a)_=0;else{r[(a+4+15&-16)+-4>>2]=a;_=a+4+15&-16}r[_+4>>2]=12;r[_+8>>2]=-1;r[_+12>>2]=-1;h[_+16>>2]=3402823466385288598117041.0e14;n[_+20>>0]=1;n[_+21>>0]=0;r[_+24>>2]=-1;c=_+28|0;r[c>>2]=t;l=_+32|0;r[l>>2]=e;h[_+36>>2]=0.0;h[_+40>>2]=.30000001192092896;r[_+44>>2]=0;r[_>>2]=7300;a=_+48|0;r[a>>2]=r[i>>2];r[a+4>>2]=r[i+4>>2];r[a+8>>2]=r[i+8>>2];r[a+12>>2]=r[i+12>>2];a=_+64|0;r[a>>2]=r[i+16>>2];r[a+4>>2]=r[i+16+4>>2];r[a+8>>2]=r[i+16+8>>2];r[a+12>>2]=r[i+16+12>>2];a=_+80|0;r[a>>2]=r[i+32>>2];r[a+4>>2]=r[i+32+4>>2];r[a+8>>2]=r[i+32+8>>2];r[a+12>>2]=r[i+32+12>>2];a=_+96|0;r[a>>2]=r[i+48>>2];r[a+4>>2]=r[i+48+4>>2];r[a+8>>2]=r[i+48+8>>2];r[a+12>>2]=r[i+48+12>>2];a=_+112|0;r[a>>2]=r[s>>2];r[a+4>>2]=r[s+4>>2];r[a+8>>2]=r[s+8>>2];r[a+12>>2]=r[s+12>>2];a=_+128|0;r[a>>2]=r[s+16>>2];r[a+4>>2]=r[s+16+4>>2];r[a+8>>2]=r[s+16+8>>2];r[a+12>>2]=r[s+16+12>>2];a=_+144|0;r[a>>2]=r[s+32>>2];r[a+4>>2]=r[s+32+4>>2];r[a+8>>2]=r[s+32+8>>2];r[a+12>>2]=r[s+32+12>>2];a=_+160|0;r[a>>2]=r[s+48>>2];r[a+4>>2]=r[s+48+4>>2];r[a+8>>2]=r[s+48+8>>2];r[a+12>>2]=r[s+48+12>>2];a=_+728|0;t=_+760|0;e=_+908|0;i=_+680|0;s=i+48|0;do{r[i>>2]=0;i=i+4|0}while((i|0)<(s|0));r[a>>2]=1045220557;r[_+732>>2]=1045220557;r[_+736>>2]=1045220557;i=_+740|0;r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;r[i+12>>2]=0;r[i+16>>2]=0;r[t>>2]=1063675494;r[_+764>>2]=1063675494;r[_+768>>2]=1063675494;i=_+772|0;h[_+804>>2]=0.0;h[_+820>>2]=0.0;n[_+836>>0]=0;h[_+840>>2]=0.0;n[_+856>>0]=0;h[_+860>>2]=0.0;h[_+876>>2]=0.0;h[_+892>>2]=0.0;h[_+808>>2]=0.0;h[_+824>>2]=0.0;n[_+837>>0]=0;h[_+844>>2]=0.0;n[_+857>>0]=0;h[_+864>>2]=0.0;h[_+880>>2]=0.0;h[_+896>>2]=0.0;h[_+812>>2]=0.0;h[_+828>>2]=0.0;n[_+838>>0]=0;h[_+848>>2]=0.0;n[_+858>>0]=0;h[_+868>>2]=0.0;h[_+884>>2]=0.0;h[_+900>>2]=0.0;r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;r[i+12>>2]=0;r[i+16>>2]=0;r[i+20>>2]=0;r[i+24>>2]=0;n[i+28>>0]=0;i=e;s=i+60|0;do{r[i>>2]=0;i=i+4|0}while((i|0)<(s|0));h[_+968>>2]=1.0;h[_+972>>2]=-1.0;h[_+976>>2]=0.0;h[_+980>>2]=.20000000298023224;h[_+984>>2]=0.0;h[_+988>>2]=.8999999761581421;h[_+992>>2]=0.0;n[_+996>>0]=0;h[_+1e3>>2]=0.0;h[_+1004>>2]=.10000000149011612;n[_+1008>>0]=0;h[_+1012>>2]=0.0;n[_+1016>>0]=0;h[_+1020>>2]=0.0;n[_+1024>>0]=0;h[_+1028>>2]=0.0;n[_+1032>>0]=0;s=_+1036|0;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;r[s+16>>2]=0;h[_+1056>>2]=1.0;h[_+1060>>2]=-1.0;h[_+1064>>2]=0.0;h[_+1068>>2]=.20000000298023224;h[_+1072>>2]=0.0;h[_+1076>>2]=.8999999761581421;h[_+1080>>2]=0.0;n[_+1084>>0]=0;h[_+1088>>2]=0.0;h[_+1092>>2]=.10000000149011612;n[_+1096>>0]=0;h[_+1100>>2]=0.0;n[_+1104>>0]=0;h[_+1108>>2]=0.0;n[_+1112>>0]=0;h[_+1116>>2]=0.0;n[_+1120>>0]=0;s=_+1124|0;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;r[s+16>>2]=0;h[_+1144>>2]=1.0;h[_+1148>>2]=-1.0;h[_+1152>>2]=0.0;h[_+1156>>2]=.20000000298023224;h[_+1160>>2]=0.0;h[_+1164>>2]=.8999999761581421;h[_+1168>>2]=0.0;n[_+1172>>0]=0;h[_+1176>>2]=0.0;h[_+1180>>2]=.10000000149011612;n[_+1184>>0]=0;h[_+1188>>2]=0.0;n[_+1192>>0]=0;h[_+1196>>2]=0.0;n[_+1200>>0]=0;h[_+1204>>2]=0.0;n[_+1208>>0]=0;s=_+1212|0;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;r[s+16>>2]=0;r[_+1232>>2]=o;r[_+1456>>2]=0;cM(_,(r[c>>2]|0)+4|0,(r[l>>2]|0)+4|0);return _|0}function ve(t,e){t=t|0;e=e|0;n[t+21>>0]=e&1;return}function Se(t,e,i){t=t|0;e=e|0;i=i|0;if((e|0)<3){n[t+798+e>>0]=i&1;return}else{n[t+968+((e+-3|0)*88|0)+48>>0]=i&1;return}}function xe(t){t=t|0;return+ +h[t+16>>2]}function we(t,e){t=t|0;e=e|0;return t+968+(e*88|0)|0}function Ce(t){t=t|0;return t+680|0}function Te(t,e){t=t|0;e=e|0;var i=0.0;i=+ql(+h[e>>2]);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;h[t+968>>2]=i;i=+ql(+h[e+4>>2]);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;h[t+1056>>2]=i;i=+ql(+h[e+8>>2]);if(i<-3.1415927410125732){i=i+6.2831854820251465;t=t+1144|0;h[t>>2]=i;return}if(!(i>3.1415927410125732)){t=t+1144|0;h[t>>2]=i;return}i=i+-6.2831854820251465;t=t+1144|0;h[t>>2]=i;return}function Ae(t,e){t=t|0;e=e|0;var i=0.0;i=+ql(+h[e>>2]);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;h[t+972>>2]=i;i=+ql(+h[e+4>>2]);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;h[t+1060>>2]=i;i=+ql(+h[e+8>>2]);if(i<-3.1415927410125732){i=i+6.2831854820251465;t=t+1148|0;h[t>>2]=i;return}if(!(i>3.1415927410125732)){t=t+1148|0;h[t>>2]=i;return}i=i+-6.2831854820251465;t=t+1148|0;h[t>>2]=i;return}function Ee(t,e){t=t|0;e=+e;h[t+16>>2]=e;return}function Me(t,e,i){t=t|0;e=e|0;i=+i;if((e|0)<3){h[t+840+(e<<2)>>2]=i;n[t+856+e>>0]=1;return}else{h[t+968+((e+-3|0)*88|0)+60>>2]=i;n[t+968+((e+-3|0)*88|0)+64>>0]=1;return}}function Re(t,e){t=t|0;e=e|0;r[t+680>>2]=r[e>>2];r[t+680+4>>2]=r[e+4>>2];r[t+680+8>>2]=r[e+8>>2];r[t+680+12>>2]=r[e+12>>2];return}function Ie(t,e){t=t|0;e=e|0;r[t+696>>2]=r[e>>2];r[t+696+4>>2]=r[e+4>>2];r[t+696+8>>2]=r[e+8>>2];r[t+696+12>>2]=r[e+12>>2];return}function Pe(t,e,i){t=t|0;e=e|0;i=+i;if((e|0)<3){h[t+820+(e<<2)>>2]=i;n[t+836+e>>0]=1;return}else{h[t+968+((e+-3|0)*88|0)+52>>2]=i;n[t+968+((e+-3|0)*88|0)+56>>0]=1;return}}function Le(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function De(t,e,i){t=t|0;e=e|0;i=i|0;var s=0;r[5637]=(r[5637]|0)+1;s=Zl(1407)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}aM(s,t,e,i);r[s>>2]=7364;r[s+4>>2]=9;n[s+1309>>0]=0;h[s+1316>>2]=0.0;h[s+1340>>2]=0.0;h[s+1364>>2]=1.0;n[s+1310>>0]=0;h[s+1320>>2]=0.0;h[s+1344>>2]=0.0;h[s+1368>>2]=1.0;n[s+1311>>0]=0;h[s+1324>>2]=0.0;h[s+1348>>2]=0.0;h[s+1372>>2]=1.0;n[s+1312>>0]=0;h[s+1328>>2]=0.0;h[s+1352>>2]=0.0;h[s+1376>>2]=1.0;n[s+1313>>0]=0;h[s+1332>>2]=0.0;h[s+1356>>2]=0.0;h[s+1380>>2]=1.0;n[s+1314>>0]=0;h[s+1336>>2]=0.0;h[s+1360>>2]=0.0;h[s+1384>>2]=1.0;return s|0}function ke(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0;r[5637]=(r[5637]|0)+1;a=Zl(1407)|0;if(!a)a=0;else{r[(a+4+15&-16)+-4>>2]=a;a=a+4+15&-16}oM(a,t,e,i,s,o);r[a>>2]=7364;r[a+4>>2]=9;n[a+1309>>0]=0;h[a+1316>>2]=0.0;h[a+1340>>2]=0.0;h[a+1364>>2]=1.0;n[a+1310>>0]=0;h[a+1320>>2]=0.0;h[a+1344>>2]=0.0;h[a+1368>>2]=1.0;n[a+1311>>0]=0;h[a+1324>>2]=0.0;h[a+1348>>2]=0.0;h[a+1372>>2]=1.0;n[a+1312>>0]=0;h[a+1328>>2]=0.0;h[a+1352>>2]=0.0;h[a+1376>>2]=1.0;n[a+1313>>0]=0;h[a+1332>>2]=0.0;h[a+1356>>2]=0.0;h[a+1380>>2]=1.0;n[a+1314>>0]=0;h[a+1336>>2]=0.0;h[a+1360>>2]=0.0;h[a+1384>>2]=1.0;return a|0}function Oe(t,e){t=t|0;e=e|0;n[t+21>>0]=e&1;return}function Fe(t,e,i){t=t|0;e=e|0;i=i|0;n[t+1309+e>>0]=i&1;if((e|0)<3){n[t+788+e>>0]=i&1;return}else{n[t+868+(e+-3<<6)+44>>0]=i&1;return}}function Be(t){t=t|0;return+ +h[t+16>>2]}function Ne(t,e){t=t|0;e=e|0;var i=0.0;i=+ql(+h[e>>2]);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;h[t+868>>2]=i;i=+ql(+h[e+4>>2]);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;h[t+932>>2]=i;i=+ql(+h[e+8>>2]);if(i<-3.1415927410125732){i=i+6.2831854820251465;t=t+996|0;h[t>>2]=i;return}if(!(i>3.1415927410125732)){t=t+996|0;h[t>>2]=i;return}i=i+-6.2831854820251465;t=t+996|0;h[t>>2]=i;return}function Ue(t,e){t=t|0;e=e|0;var i=0.0;i=+ql(+h[e>>2]);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;h[t+872>>2]=i;i=+ql(+h[e+4>>2]);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;h[t+936>>2]=i;i=+ql(+h[e+8>>2]);if(i<-3.1415927410125732){i=i+6.2831854820251465;t=t+1e3|0;h[t>>2]=i;return}if(!(i>3.1415927410125732)){t=t+1e3|0;h[t>>2]=i;return}i=i+-6.2831854820251465;t=t+1e3|0;h[t>>2]=i;return}function Ve(t,e){t=t|0;e=+e;h[t+16>>2]=e;return}function ze(t,e,i){t=t|0;e=e|0;i=+i;h[t+1364+(e<<2)>>2]=i;return}function We(t,e){t=t|0;e=e|0;r[t+680>>2]=r[e>>2];r[t+680+4>>2]=r[e+4>>2];r[t+680+8>>2]=r[e+8>>2];r[t+680+12>>2]=r[e+12>>2];return}function Ge(t,e){t=t|0;e=e|0;r[t+696>>2]=r[e>>2];r[t+696+4>>2]=r[e+4>>2];r[t+696+8>>2]=r[e+8>>2];r[t+696+12>>2]=r[e+12>>2];return}function je(t,e,i){t=t|0;e=e|0;i=+i;h[t+1340+(e<<2)>>2]=i;return}function He(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Xe(t){t=t|0;if(r[t+204>>2]&3|0)return;if((r[t+216>>2]&-2|0)!=4)r[t+216>>2]=1;h[t+220>>2]=0.0;return}function Ye(t,e){t=t|0;e=e|0;if(!e?r[t+204>>2]&3|0:0)return;if((r[t+216>>2]&-2|0)!=4)r[t+216>>2]=1;h[t+220>>2]=0.0;return}function qe(){var t=0,e=0;r[5637]=(r[5637]|0)+1;t=Zl(327)|0;if(!t)t=0;else{r[(t+4+15&-16)+-4>>2]=t;t=t+4+15&-16}r[t+164>>2]=1065353216;r[t+168>>2]=1065353216;r[t+172>>2]=1065353216;h[t+176>>2]=0.0;r[t+180>>2]=0;h[t+184>>2]=999999984306749440.0;e=t+188|0;r[e>>2]=0;r[e+4>>2]=0;r[e+8>>2]=0;r[e+12>>2]=0;r[t+204>>2]=1;r[t+208>>2]=-1;r[t+212>>2]=-1;r[t+216>>2]=1;h[t+220>>2]=0.0;h[t+224>>2]=.5;h[t+228>>2]=0.0;h[t+232>>2]=0.0;r[t+240>>2]=0;r[t+244>>2]=-1;h[t+248>>2]=1.0;h[t+252>>2]=0.0;h[t+256>>2]=0.0;r[t+260>>2]=0;n[t+280>>0]=1;r[t+276>>2]=0;r[t+268>>2]=0;r[t+272>>2]=0;r[t+284>>2]=0;r[t+4>>2]=1065353216;e=t+8|0;r[e>>2]=0;r[e+4>>2]=0;r[e+8>>2]=0;r[e+12>>2]=0;r[t+24>>2]=1065353216;e=t+28|0;r[e>>2]=0;r[e+4>>2]=0;r[e+8>>2]=0;r[e+12>>2]=0;r[t+44>>2]=1065353216;e=t+48|0;r[e>>2]=0;r[e+4>>2]=0;r[e+8>>2]=0;r[e+12>>2]=0;r[e+16>>2]=0;r[t>>2]=4344;n[t+304>>0]=1;r[t+300>>2]=0;r[t+292>>2]=0;r[t+296>>2]=0;r[t+236>>2]=4;return t|0}function Ke(t,e){t=t|0;e=e|0;r[t+216>>2]=e;return}function Ze(t){t=t|0;return r[t+204>>2]|0}function Qe(t){t=t|0;return r[t+192>>2]|0}function $e(t){t=t|0;return r[t+292>>2]|0}function Je(t,e){t=t|0;e=e|0;return r[(r[t+300>>2]|0)+(e<<2)>>2]|0}function ti(t){t=t|0;return t+4|0}function ei(t){t=t|0;t=r[t+216>>2]|0;return(t|0)!=5&(t|0)!=2|0}function ii(t){t=t|0;return(r[t+204>>2]&2|0)!=0|0}function ni(t,e){t=t|0;e=e|0;if((r[t+216>>2]&-2|0)==4)return;r[t+216>>2]=e;return}function si(t,e,i){t=t|0;e=e|0;i=i|0;r[t+164>>2]=r[e>>2];r[t+164+4>>2]=r[e+4>>2];r[t+164+8>>2]=r[e+8>>2];r[t+164+12>>2]=r[e+12>>2];if(!(+h[e>>2]!=1.0)?!(+h[e+4>>2]!=1.0):0)i=+h[e+8>>2]!=1.0?i:0;r[t+180>>2]=i;return}function ri(t,e){t=t|0;e=+e;h[t+256>>2]=e;return}function oi(t,e){t=t|0;e=+e;h[t+252>>2]=e;return}function ai(t,e){t=t|0;e=e|0;r[t+204>>2]=e;return}function li(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+8>>2]&127](t,e);return}function hi(t,e){t=t|0;e=+e;h[t+184>>2]=e;return}function ci(t,e){t=t|0;e=+e;r[t+284>>2]=(r[t+284>>2]|0)+1;h[t+224>>2]=e;return}function _i(t,e){t=t|0;e=+e;r[t+284>>2]=(r[t+284>>2]|0)+1;h[t+228>>2]=e;return}function ui(t,e){t=t|0;e=+e;r[t+284>>2]=(r[t+284>>2]|0)+1;h[t+232>>2]=e;return}function di(t,e){t=t|0;e=e|0;r[t+284>>2]=(r[t+284>>2]|0)+1;r[t+4>>2]=r[e>>2];r[t+4+4>>2]=r[e+4>>2];r[t+4+8>>2]=r[e+8>>2];r[t+4+12>>2]=r[e+12>>2];r[t+20>>2]=r[e+16>>2];r[t+20+4>>2]=r[e+16+4>>2];r[t+20+8>>2]=r[e+16+8>>2];r[t+20+12>>2]=r[e+16+12>>2];r[t+36>>2]=r[e+32>>2];r[t+36+4>>2]=r[e+32+4>>2];r[t+36+8>>2]=r[e+32+8>>2];r[t+36+12>>2]=r[e+32+12>>2];r[t+52>>2]=r[e+48>>2];r[t+52+4>>2]=r[e+48+4>>2];r[t+52+8>>2]=r[e+48+8>>2];r[t+52+12>>2]=r[e+48+12>>2];return}function pi(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function fi(){var t=0,e=0;while(1){t=Zl(4)|0;if(t|0){e=6;break}t=r[5831]|0;r[5831]=t+0;if(!t){e=5;break}zk[t&3]()}if((e|0)==5){e=Zt(4)|0;r[e>>2]=8308;ce(e|0,2416,215)}else if((e|0)==6){r[t>>2]=8084;return t|0}return 0}function mi(t){t=t|0;return}function gi(t){t=t|0;Ql(t);return}function bi(t,e,i){t=t|0;e=e|0;i=i|0;var n=0;n=r[e>>2]|0;t=r[i>>2]|0;t=(r[t+236>>2]|0)==4?t:0;if(!((n|0)==0?1:(r[n+236>>2]|0)!=4))Vk[r[(r[n>>2]|0)+28>>2]&127](n,i,e);if(!t)return 0;Vk[r[(r[t>>2]|0)+28>>2]&127](t,e,i);return 0}function yi(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0;s=r[e>>2]|0;t=r[i>>2]|0;t=(r[t+236>>2]|0)==4?t:0;if(!((s|0)==0?1:(r[s+236>>2]|0)!=4))jk[r[(r[s>>2]|0)+32>>2]&127](s,i,n,e);if(!t)return 0;jk[r[(r[t>>2]|0)+32>>2]&127](t,e,n,i);return 0}function vi(t,e,i){t=t|0;e=e|0;i=i|0;return}function Si(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function xi(t,e){t=t|0;e=e|0;var i=0;r[5637]=(r[5637]|0)+1;i=Zl(787)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}MD(i,t,e,0);return i|0}function wi(t,e,i){t=t|0;e=e|0;i=i|0;var n=0;r[5637]=(r[5637]|0)+1;n=Zl(787)|0;if(!n)n=0;else{r[(n+4+15&-16)+-4>>2]=n;n=n+4+15&-16}MD(n,t,e,i);return n|0}function Ci(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0;r[5637]=(r[5637]|0)+1;o=Zl(787)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}r[o+4>>2]=4;r[o+8>>2]=-1;r[o+12>>2]=-1;h[o+16>>2]=3402823466385288598117041.0e14;n[o+20>>0]=1;n[o+21>>0]=0;r[o+24>>2]=-1;r[o+28>>2]=t;r[o+32>>2]=e;h[o+36>>2]=0.0;h[o+40>>2]=.30000001192092896;r[o+44>>2]=0;r[o>>2]=7428;e=o+552|0;r[e>>2]=r[i>>2];r[e+4>>2]=r[i+4>>2];r[e+8>>2]=r[i+8>>2];r[e+12>>2]=r[i+12>>2];e=o+568|0;r[e>>2]=r[i+16>>2];r[e+4>>2]=r[i+16+4>>2];r[e+8>>2]=r[i+16+8>>2];r[e+12>>2]=r[i+16+12>>2];e=o+584|0;r[e>>2]=r[i+32>>2];r[e+4>>2]=r[i+32+4>>2];r[e+8>>2]=r[i+32+8>>2];r[e+12>>2]=r[i+32+12>>2];e=o+600|0;r[e>>2]=r[i+48>>2];r[e+4>>2]=r[i+48+4>>2];r[e+8>>2]=r[i+48+8>>2];r[e+12>>2]=r[i+48+12>>2];i=o+616|0;r[i>>2]=r[s>>2];r[i+4>>2]=r[s+4>>2];r[i+8>>2]=r[s+8>>2];r[i+12>>2]=r[s+12>>2];i=o+632|0;r[i>>2]=r[s+16>>2];r[i+4>>2]=r[s+16+4>>2];r[i+8>>2]=r[s+16+8>>2];r[i+12>>2]=r[s+16+12>>2];i=o+648|0;r[i>>2]=r[s+32>>2];r[i+4>>2]=r[s+32+4>>2];r[i+8>>2]=r[s+32+8>>2];r[i+12>>2]=r[s+32+12>>2];i=o+664|0;r[i>>2]=r[s+48>>2];r[i+4>>2]=r[s+48+4>>2];r[i+8>>2]=r[s+48+8>>2];r[i+12>>2]=r[s+48+12>>2];h[o+688>>2]=0.0;h[o+692>>2]=-1.0;h[o+696>>2]=.8999999761581421;h[o+700>>2]=.30000001192092896;h[o+704>>2]=1.0;h[o+708>>2]=0.0;h[o+712>>2]=0.0;n[o+716>>0]=0;n[o+736>>0]=0;n[o+737>>0]=0;n[o+738>>0]=0;n[o+739>>0]=1;n[o+740>>0]=0;s=o+748|0;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;r[s+16>>2]=0;h[o+732>>2]=1.0;return o|0}function Ti(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0;r[5637]=(r[5637]|0)+1;a=Zl(787)|0;if(!a)a=0;else{r[(a+4+15&-16)+-4>>2]=a;a=a+4+15&-16}r[a+4>>2]=4;r[a+8>>2]=-1;r[a+12>>2]=-1;h[a+16>>2]=3402823466385288598117041.0e14;n[a+20>>0]=1;n[a+21>>0]=0;r[a+24>>2]=-1;r[a+28>>2]=t;r[a+32>>2]=e;h[a+36>>2]=0.0;h[a+40>>2]=.30000001192092896;r[a+44>>2]=0;r[a>>2]=7428;e=a+552|0;r[e>>2]=r[i>>2];r[e+4>>2]=r[i+4>>2];r[e+8>>2]=r[i+8>>2];r[e+12>>2]=r[i+12>>2];e=a+568|0;r[e>>2]=r[i+16>>2];r[e+4>>2]=r[i+16+4>>2];r[e+8>>2]=r[i+16+8>>2];r[e+12>>2]=r[i+16+12>>2];e=a+584|0;r[e>>2]=r[i+32>>2];r[e+4>>2]=r[i+32+4>>2];r[e+8>>2]=r[i+32+8>>2];r[e+12>>2]=r[i+32+12>>2];e=a+600|0;r[e>>2]=r[i+48>>2];r[e+4>>2]=r[i+48+4>>2];r[e+8>>2]=r[i+48+8>>2];r[e+12>>2]=r[i+48+12>>2];i=a+616|0;r[i>>2]=r[s>>2];r[i+4>>2]=r[s+4>>2];r[i+8>>2]=r[s+8>>2];r[i+12>>2]=r[s+12>>2];i=a+632|0;r[i>>2]=r[s+16>>2];r[i+4>>2]=r[s+16+4>>2];r[i+8>>2]=r[s+16+8>>2];r[i+12>>2]=r[s+16+12>>2];i=a+648|0;r[i>>2]=r[s+32>>2];r[i+4>>2]=r[s+32+4>>2];r[i+8>>2]=r[s+32+8>>2];r[i+12>>2]=r[s+32+12>>2];i=a+664|0;r[i>>2]=r[s+48>>2];r[i+4>>2]=r[s+48+4>>2];r[i+8>>2]=r[s+48+8>>2];r[i+12>>2]=r[s+48+12>>2];h[a+688>>2]=0.0;h[a+692>>2]=-1.0;h[a+696>>2]=.8999999761581421;h[a+700>>2]=.30000001192092896;h[a+704>>2]=1.0;h[a+708>>2]=0.0;h[a+712>>2]=0.0;n[a+716>>0]=0;n[a+736>>0]=0;n[a+737>>0]=0;n[a+738>>0]=0;n[a+739>>0]=1;n[a+740>>0]=o&1;s=a+748|0;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;r[s+16>>2]=0;h[a+732>>2]=o?-1.0:1.0;return a|0}function Ai(t,e,i,n,s,o){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;var a=0;r[5637]=(r[5637]|0)+1;a=Zl(787)|0;if(!a)a=0;else{r[(a+4+15&-16)+-4>>2]=a;a=a+4+15&-16}ED(a,t,e,i,n,s,o,0);return a|0}function Ei(t,e,i,n,s,o,a){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;var l=0;r[5637]=(r[5637]|0)+1;l=Zl(787)|0;if(!l)l=0;else{r[(l+4+15&-16)+-4>>2]=l;l=l+4+15&-16}ED(l,t,e,i,n,s,o,a);return l|0}function Mi(t,e,i,s){t=t|0;e=e|0;i=+i;s=+s;n[t+737>>0]=e&1;h[t+680>>2]=i;h[t+684>>2]=s;return}function Ri(t,e){t=t|0;e=e|0;n[t+21>>0]=e&1;return}function Ii(t){t=t|0;return+ +h[t+16>>2]}function Pi(t,e){t=t|0;e=+e;h[t+16>>2]=e;return}function Li(t,e,i,n,s){t=t|0;e=+e;i=+i;n=+n;s=+s;h[t+692>>2]=(i-e)*.5;e=+ql((i-e)*.5+e);if(!(e<-3.1415927410125732)){if(e>3.1415927410125732)e=e+-6.2831854820251465}else e=e+6.2831854820251465;h[t+688>>2]=e;h[t+696>>2]=n;h[t+700>>2]=s;h[t+704>>2]=1.0;return}function Di(t,e,i,n,s,r){t=t|0;e=+e;i=+i;n=+n;s=+s;r=+r;h[t+692>>2]=(i-e)*.5;e=+ql((i-e)*.5+e);if(!(e<-3.1415927410125732)){if(e>3.1415927410125732)e=e+-6.2831854820251465}else e=e+6.2831854820251465;h[t+688>>2]=e;h[t+696>>2]=n;h[t+700>>2]=s;h[t+704>>2]=r;return}function ki(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Oi(t,e,i){t=t|0;e=e|0;i=+i;var s=0,o=0;r[5637]=(r[5637]|0)+1;s=Zl(203)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}r[s>>2]=7044;o=s+60|0;n[s+144>>0]=1;r[s+140>>2]=0;r[s+132>>2]=0;r[s+136>>2]=0;r[s+176>>2]=1;h[s+56>>2]=.019999999552965164;r[o>>2]=0;r[o+4>>2]=0;r[o+8>>2]=0;r[o+12>>2]=0;n[s+170>>0]=1;r[s+8>>2]=t;h[s+52>>2]=i;h[s+48>>2]=0.0;r[s+12>>2]=e;n[s+171>>0]=1;h[s+172>>2]=0.0;h[s+16>>2]=0.0;h[s+20>>2]=0.0;h[s+44>>2]=29.399999618530273;h[s+24>>2]=55.0;h[s+28>>2]=10.0;n[s+168>>0]=0;n[s+169>>0]=0;n[s+180>>0]=1;h[s+36>>2]=.7853981852531433;h[s+40>>2]=.7071067690849304;h[s+108>>2]=0.0;n[s+181>>0]=0;n[s+182>>0]=0;return s|0}function Fi(t,e,i,s){t=t|0;e=e|0;i=+i;s=s|0;var o=0,a=0;r[5637]=(r[5637]|0)+1;o=Zl(203)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}r[o>>2]=7044;a=o+60|0;n[o+144>>0]=1;r[o+140>>2]=0;r[o+132>>2]=0;r[o+136>>2]=0;r[o+176>>2]=s;h[o+56>>2]=.019999999552965164;r[a>>2]=0;r[a+4>>2]=0;r[a+8>>2]=0;r[a+12>>2]=0;n[o+170>>0]=1;r[o+8>>2]=t;h[o+52>>2]=i;h[o+48>>2]=0.0;r[o+12>>2]=e;n[o+171>>0]=1;h[o+172>>2]=0.0;h[o+16>>2]=0.0;h[o+20>>2]=0.0;h[o+44>>2]=29.399999618530273;h[o+24>>2]=55.0;h[o+28>>2]=10.0;n[o+168>>0]=0;n[o+169>>0]=0;n[o+180>>0]=1;h[o+36>>2]=.7853981852531433;h[o+40>>2]=.7071067690849304;h[o+108>>2]=0.0;n[o+181>>0]=0;n[o+182>>0]=0;return o|0}function Bi(t){t=t|0;return ck[r[(r[t>>2]|0)+40>>2]&127](t)|0}function Ni(t){t=t|0;return r[t+8>>2]|0}function Ui(t){t=t|0;return+ +h[t+44>>2]}function Vi(t){t=t|0;return+ +h[t+36>>2]}function zi(t){t=t|0;ok[r[(r[t>>2]|0)+44>>2]&255](t);return}function Wi(t){t=t|0;return ck[r[(r[t>>2]|0)+48>>2]&127](t)|0}function Gi(t,e,i){t=t|0;e=e|0;i=+i;Wk[r[(r[t>>2]|0)+36>>2]&7](t,e,i);return}function ji(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+32>>2]&127](t,e);return}function Hi(t,e){t=t|0;e=+e;h[t+24>>2]=e;return}function Xi(t,e){t=t|0;e=+e;h[t+44>>2]=e;return}function Yi(t,e){t=t|0;e=+e;h[t+28>>2]=e;return}function qi(t,e){t=t|0;e=+e;h[t+32>>2]=e;return}function Ki(t,e){t=t|0;e=+e;h[t+36>>2]=e;h[t+40>>2]=+H(+e);return}function Zi(t,e){t=t|0;e=e|0;e=(e|0)<0?0:e;r[t+176>>2]=(e|0)>2?2:e;return}function Qi(t,e){t=t|0;e=e|0;n[t+170>>0]=e&1;return}function $i(t,e,i){t=t|0;e=e|0;i=+i;Wk[r[(r[t>>2]|0)+20>>2]&7](t,e,i);return}function Ji(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+16>>2]&127](t,e);return}function tn(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+28>>2]&127](t,e);return}function en(t){t=t|0;if(!t)return;Ql(t);return}function nn(t){t=t|0;return+ +h[t+80>>2]}function sn(t){t=t|0;return t+48|0}function rn(t){t=t|0;return t+32|0}function on(t){t=t|0;return t|0}function an(t){t=t|0;return t+16|0}function ln(t){t=t|0;return t+64|0}function hn(t){t=t|0;return t+48|0}function cn(t){t=t|0;return t+32|0}function _n(t,e){t=t|0;e=e|0;r[t>>2]=r[e>>2];r[t+4>>2]=r[e+4>>2];r[t+8>>2]=r[e+8>>2];r[t+12>>2]=r[e+12>>2];return}function un(t,e){t=t|0;e=e|0;r[t+16>>2]=r[e>>2];r[t+16+4>>2]=r[e+4>>2];r[t+16+8>>2]=r[e+8>>2];r[t+16+12>>2]=r[e+12>>2];return}function dn(t,e){t=t|0;e=e|0;r[t+64>>2]=r[e>>2];r[t+64+4>>2]=r[e+4>>2];r[t+64+8>>2]=r[e+8>>2];r[t+64+12>>2]=r[e+12>>2];return}function pn(t,e){t=t|0;e=e|0;r[t+48>>2]=r[e>>2];r[t+48+4>>2]=r[e+4>>2];r[t+48+8>>2]=r[e+8>>2];r[t+48+12>>2]=r[e+12>>2];return}function fn(t,e){t=t|0;e=e|0;r[t+32>>2]=r[e>>2];r[t+32+4>>2]=r[e+4>>2];r[t+32+8>>2]=r[e+8>>2];r[t+32+12>>2]=r[e+12>>2];return}function mn(t){t=t|0;if(!t)return;Ql(t);return}function gn(t,e){t=t|0;e=e|0;Kx(t,e);return}function bn(t,e){t=t|0;e=e|0;if(!(n[19920]|0))n[19920]=1;r[5696]=r[t+(e<<4)>>2];r[5697]=r[t+(e<<4)+4>>2];r[5698]=r[t+(e<<4)+8>>2];r[5699]=r[t+(e<<4)+12>>2];return 22784}function yn(t,e,i,n){t=t|0;e=+e;i=+i;n=+n;var s=0.0,r=0.0,o=0.0;r=+H(+e);s=+H(+i);o=+H(+n);e=+X(+e);i=+X(+i);n=+X(+n);h[t>>2]=s*o;h[t+4>>2]=i*(o*e)-r*n;h[t+8>>2]=r*o*i+e*n;h[t+12>>2]=0.0;h[t+16>>2]=s*n;h[t+20>>2]=r*o+i*(e*n);h[t+24>>2]=i*(r*n)-o*e;h[t+28>>2]=0.0;h[t+32>>2]=-i;h[t+36>>2]=s*e;h[t+40>>2]=r*s;h[t+44>>2]=0.0;return}function vn(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Sn(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+8>>2]&127](t,e);return}function xn(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+12>>2]&127](t,e);return}function wn(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Cn(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+60>>2]&127](t,e);return}function Tn(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function An(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function En(t){t=t|0;if(r[t+204>>2]&3|0)return;if((r[t+216>>2]&-2|0)!=4)r[t+216>>2]=1;h[t+220>>2]=0.0;return}function Mn(t,e){t=t|0;e=e|0;if(!e?r[t+204>>2]&3|0:0)return;if((r[t+216>>2]&-2|0)!=4)r[t+216>>2]=1;h[t+220>>2]=0.0;return}function Rn(){var t=0;r[5637]=(r[5637]|0)+1;t=Zl(331)|0;if(!t)t=0;else{r[(t+4+15&-16)+-4>>2]=t;t=t+4+15&-16}RR(t);return t|0}function In(t,e){t=t|0;e=e|0;r[t+216>>2]=e;return}function Pn(t){t=t|0;return r[t+204>>2]|0}function Ln(t){t=t|0;return r[t+192>>2]|0}function Dn(t){t=t|0;return r[t+292>>2]|0}function kn(t,e){t=t|0;e=e|0;return r[(r[t+300>>2]|0)+(e<<2)>>2]|0}function On(t){t=t|0;return t+4|0}function Fn(t){t=t|0;t=r[t+216>>2]|0;return(t|0)!=5&(t|0)!=2|0}function Bn(t){t=t|0;return(r[t+204>>2]&2|0)!=0|0}function Nn(t,e){t=t|0;e=e|0;if((r[t+216>>2]&-2|0)==4)return;r[t+216>>2]=e;return}function Un(t,e,i){t=t|0;e=e|0;i=i|0;r[t+164>>2]=r[e>>2];r[t+164+4>>2]=r[e+4>>2];r[t+164+8>>2]=r[e+8>>2];r[t+164+12>>2]=r[e+12>>2];if(!(+h[e>>2]!=1.0)?!(+h[e+4>>2]!=1.0):0)i=+h[e+8>>2]!=1.0?i:0;r[t+180>>2]=i;return}function Vn(t,e){t=t|0;e=+e;h[t+256>>2]=e;return}function zn(t,e){t=t|0;e=+e;h[t+252>>2]=e;return}function Wn(t,e){t=t|0;e=e|0;r[t+204>>2]=e;return}function Gn(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+8>>2]&127](t,e);return}function jn(t,e){t=t|0;e=+e;h[t+184>>2]=e;return}function Hn(t,e){t=t|0;e=+e;r[t+284>>2]=(r[t+284>>2]|0)+1;h[t+224>>2]=e;return}function Xn(t,e){t=t|0;e=+e;r[t+284>>2]=(r[t+284>>2]|0)+1;h[t+228>>2]=e;return}function Yn(t,e){t=t|0;e=+e;r[t+284>>2]=(r[t+284>>2]|0)+1;h[t+232>>2]=e;return}function qn(t,e){t=t|0;e=e|0;r[t+284>>2]=(r[t+284>>2]|0)+1;r[t+4>>2]=r[e>>2];r[t+4+4>>2]=r[e+4>>2];r[t+4+8>>2]=r[e+8>>2];r[t+4+12>>2]=r[e+12>>2];r[t+20>>2]=r[e+16>>2];r[t+20+4>>2]=r[e+16+4>>2];r[t+20+8>>2]=r[e+16+8>>2];r[t+20+12>>2]=r[e+16+12>>2];r[t+36>>2]=r[e+32>>2];r[t+36+4>>2]=r[e+32+4>>2];r[t+36+8>>2]=r[e+32+8>>2];r[t+36+12>>2]=r[e+32+12>>2];r[t+52>>2]=r[e+48>>2];r[t+52+4>>2]=r[e+48+4>>2];r[t+52+8>>2]=r[e+48+8>>2];r[t+52+12>>2]=r[e+48+12>>2];return}function Kn(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function Zn(){var t=0,e=0;r[5637]=(r[5637]|0)+1;t=Zl(791)|0;if(!t)t=0;else{r[(t+4+15&-16)+-4>>2]=t;t=t+4+15&-16}r[t>>2]=1025;r[t+116>>2]=0;n[t+120>>0]=0;e=t+124|0;r[e>>2]=0;r[e+4>>2]=0;r[e+8>>2]=0;r[e+12>>2]=0;r[e+16>>2]=0;r[e+20>>2]=0;r[e+24>>2]=0;r[e+28>>2]=0;r[t+300>>2]=0;n[t+304>>0]=0;e=t+308|0;r[e>>2]=0;r[e+4>>2]=0;r[e+8>>2]=0;r[e+12>>2]=0;r[e+16>>2]=0;r[e+20>>2]=0;r[e+24>>2]=0;r[e+28>>2]=0;r[t+484>>2]=0;n[t+488>>0]=0;e=t+492|0;r[e>>2]=0;r[e+4>>2]=0;r[e+8>>2]=0;r[e+12>>2]=0;r[e+16>>2]=0;r[e+20>>2]=0;r[e+24>>2]=0;r[e+28>>2]=0;r[t+668>>2]=0;n[t+672>>0]=0;e=t+676|0;r[e>>2]=0;r[e+4>>2]=0;r[e+8>>2]=0;r[e+12>>2]=0;r[e+16>>2]=0;r[e+20>>2]=0;r[e+24>>2]=0;r[e+28>>2]=0;r[t+740>>2]=0;r[t+744>>2]=0;r[t+748>>2]=0;r[t+768>>2]=0;return t|0}function Qn(t){t=t|0;return r[t+740>>2]|0}function $n(t){t=t|0;return r[t+744>>2]|0}function Jn(t,e){t=t|0;e=e|0;return t+4+(e*184|0)|0}function ts(t){t=t|0;return r[t+748>>2]|0}function es(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function is(t,e){t=t|0;e=e|0;var i=0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0;r[5637]=(r[5637]|0)+1;i=Zl(379)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}Bb(i,3,t);r[i>>2]=7484;_=i+300|0;r[_>>2]=r[e>>2];r[_+4>>2]=r[e+4>>2];r[_+8>>2]=r[e+8>>2];r[_+12>>2]=r[e+12>>2];c=+h[e>>2];l=+h[e+4>>2];a=+h[e+8>>2];o=c*+h[t+20>>2]+l*+h[t+24>>2]+a*+h[t+28>>2]+ +h[t+56>>2];s=c*+h[t+36>>2]+l*+h[t+40>>2]+a*+h[t+44>>2]+ +h[t+60>>2];h[i+316>>2]=c*+h[t+4>>2]+l*+h[t+8>>2]+a*+h[t+12>>2]+ +h[t+52>>2];h[i+320>>2]=o;h[i+324>>2]=s;h[i+328>>2]=0.0;r[i+332>>2]=0;n[i+344>>0]=0;h[i+348>>2]=.30000001192092896;h[i+352>>2]=1.0;h[i+356>>2]=0.0;return i|0}function ns(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0;r[5637]=(r[5637]|0)+1;o=Zl(379)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}r[o+4>>2]=3;r[o+8>>2]=-1;r[o+12>>2]=-1;h[o+16>>2]=3402823466385288598117041.0e14;n[o+20>>0]=1;n[o+21>>0]=0;r[o+24>>2]=-1;r[o+28>>2]=t;r[o+32>>2]=e;h[o+36>>2]=0.0;h[o+40>>2]=.30000001192092896;r[o+44>>2]=0;r[o>>2]=7484;e=o+300|0;r[e>>2]=r[i>>2];r[e+4>>2]=r[i+4>>2];r[e+8>>2]=r[i+8>>2];r[e+12>>2]=r[i+12>>2];i=o+316|0;r[i>>2]=r[s>>2];r[i+4>>2]=r[s+4>>2];r[i+8>>2]=r[s+8>>2];r[i+12>>2]=r[s+12>>2];r[o+332>>2]=0;n[o+344>>0]=0;h[o+348>>2]=.30000001192092896;h[o+352>>2]=1.0;h[o+356>>2]=0.0;return o|0}function ss(t,e){t=t|0;e=e|0;n[t+21>>0]=e&1;return}function rs(t){t=t|0;return+ +h[t+16>>2]}function os(t){t=t|0;return t+300|0}function as(t){t=t|0;return t+316|0}function ls(t){t=t|0;return t+348|0}function hs(t,e){t=t|0;e=+e;h[t+16>>2]=e;return}function cs(t,e){t=t|0;e=e|0;r[t+300>>2]=r[e>>2];r[t+300+4>>2]=r[e+4>>2];r[t+300+8>>2]=r[e+8>>2];r[t+300+12>>2]=r[e+12>>2];return}function _s(t,e){t=t|0;e=e|0;r[t+316>>2]=r[e>>2];r[t+316+4>>2]=r[e+4>>2];r[t+316+8>>2]=r[e+8>>2];r[t+316+12>>2]=r[e+12>>2];return}function us(t,e){t=t|0;e=e|0;r[t+348>>2]=r[e>>2];r[t+348+4>>2]=r[e+4>>2];r[t+348+8>>2]=r[e+8>>2];return}function ds(t){t=t|0;if(!t)return;Ql(t);return}function ps(t,e){t=t|0;e=+e;h[t+12>>2]=e;return}function fs(t,e){t=t|0;e=+e;h[t>>2]=e;return}function ms(t,e){t=t|0;e=+e;h[t+4>>2]=e;return}function gs(t,e){t=t|0;e=+e;h[t+8>>2]=e;return}function bs(t){t=t|0;return+ +h[t+12>>2]}function ys(t){t=t|0;return+ +h[t>>2]}function vs(t){t=t|0;return+ +h[t+4>>2]}function Ss(t){t=t|0;return+ +h[t+8>>2]}function xs(t){t=t|0;if(!t)return;Ql(t);return}function ws(t,e,i,n){t=+t;e=+e;i=+i;n=+n;var s=0,o=0;while(1){s=Zl(16)|0;if(s|0){o=6;break}s=r[5831]|0;r[5831]=s+0;if(!s){o=5;break}zk[s&3]()}if((o|0)==5){o=Zt(4)|0;r[o>>2]=8308;ce(o|0,2416,215)}else if((o|0)==6){h[s>>2]=t;h[s+4>>2]=e;h[s+8>>2]=i;h[s+12>>2]=n;return s|0}return 0}function Cs(t){t=t|0;var e=0.0,i=0.0,n=0.0,s=0.0,r=0.0;r=+h[t>>2];s=+h[t+4>>2];n=+h[t+8>>2];i=+h[t+12>>2];e=1.0/+G(+(r*r+s*s+n*n+i*i));h[t>>2]=r*e;h[t+4>>2]=s*e;h[t+8>>2]=n*e;h[t+12>>2]=i*e;return}function Ts(t,e,i,n,s){t=t|0;e=+e;i=+i;n=+n;s=+s;h[t>>2]=e;h[t+4>>2]=i;h[t+8>>2]=n;h[t+12>>2]=s;return}function As(t,e){t=t|0;e=+e;h[t+12>>2]=e;return}function Es(t,e){t=t|0;e=+e;h[t>>2]=e;return}function Ms(t,e){t=t|0;e=+e;h[t+4>>2]=e;return}function Rs(t,e){t=t|0;e=+e;h[t+8>>2]=e;return}function Is(t){t=t|0;return+ +h[t+12>>2]}function Ps(t){t=t|0;return+ +h[t>>2]}function Ls(t){t=t|0;return+ +h[t+4>>2]}function Ds(t){t=t|0;return+ +h[t+8>>2]}function ks(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Os(t,e,i,n,s,r,o,a){t=t|0;e=e|0;i=i|0;n=n|0;s=+s;r=+r;o=o|0;a=a|0;return D_(t,e,i,n,s,r,o,a)|0}function Fs(t,e,i){t=t|0;e=+e;i=i|0;h[(r[t+136>>2]|0)+(i*284|0)+252>>2]=e;return}function Bs(t,e,i){t=t|0;e=e|0;i=i|0;var s=0;while(1){t=Zl(144)|0;if(t|0){s=6;break}t=r[5831]|0;r[5831]=t+0;if(!t){s=5;break}zk[t&3]()}if((s|0)==5){i=Zt(4)|0;r[i>>2]=8308;ce(i|0,2416,215)}else if((s|0)==6){r[t>>2]=7952;n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;r[t+12>>2]=0;n[t+40>>0]=1;r[t+36>>2]=0;r[t+28>>2]=0;r[t+32>>2]=0;n[t+60>>0]=1;r[t+56>>2]=0;r[t+48>>2]=0;r[t+52>>2]=0;n[t+80>>0]=1;r[t+76>>2]=0;r[t+68>>2]=0;r[t+72>>2]=0;r[t+92>>2]=i;h[t+96>>2]=0.0;n[t+140>>0]=1;r[t+136>>2]=0;r[t+128>>2]=0;r[t+132>>2]=0;r[t+108>>2]=e;r[t+112>>2]=0;r[t+116>>2]=2;r[t+120>>2]=1;h[t+104>>2]=0.0;h[t+100>>2]=0.0;return t|0}return 0}function Ns(t){t=t|0;return r[t+128>>2]|0}function Us(t){t=t|0;return r[t+108>>2]|0}function Vs(t,e){t=t|0;e=e|0;return(r[t+136>>2]|0)+(e*284|0)|0}function zs(t,e){t=t|0;e=e|0;return(r[t+136>>2]|0)+(e*284|0)+92|0}function Ws(t,e,i){t=t|0;e=+e;i=i|0;h[(r[t+136>>2]|0)+(i*284|0)+256>>2]=e;return}function Gs(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;jk[r[(r[t>>2]|0)+24>>2]&127](t,e,i,n);return}function js(t,e,i){t=t|0;e=+e;i=i|0;h[(r[t+136>>2]|0)+(i*284|0)+232>>2]=e;return}function Hs(t,e,i){t=t|0;e=e|0;i=i|0;w_(r[t+108>>2]|0,r[t+136>>2]|0,e,i);return}function Xs(t){t=t|0;if(!t)return;Ql(t);return}function Ys(t,e,i){t=+t;e=e|0;i=i|0;var s=0,o=0;while(1){s=Zl(140)|0;if(s|0){o=6;break}s=r[5831]|0;r[5831]=s+0;if(!s){o=5;break}zk[s&3]()}if((o|0)==5){i=Zt(4)|0;r[i>>2]=8308;ce(i|0,2416,215)}else if((o|0)==6){h[s>>2]=t;r[s+4>>2]=e;r[s+72>>2]=i;r[s+76>>2]=0;r[s+76+4>>2]=0;r[s+76+8>>2]=0;r[s+76+12>>2]=0;r[s+76+16>>2]=0;r[s+76+20>>2]=0;h[s+100>>2]=.5;h[s+104>>2]=0.0;h[s+108>>2]=0.0;h[s+112>>2]=.800000011920929;h[s+116>>2]=1.0;n[s+120>>0]=0;h[s+124>>2]=.004999999888241291;h[s+128>>2]=.009999999776482582;h[s+132>>2]=.009999999776482582;h[s+136>>2]=.009999999776482582;r[s+8>>2]=1065353216;r[s+12>>2]=0;r[s+12+4>>2]=0;r[s+12+8>>2]=0;r[s+12+12>>2]=0;r[s+28>>2]=1065353216;r[s+32>>2]=0;r[s+32+4>>2]=0;r[s+32+8>>2]=0;r[s+32+12>>2]=0;r[s+48>>2]=1065353216;r[s+52>>2]=0;r[s+52+4>>2]=0;r[s+52+8>>2]=0;r[s+52+12>>2]=0;r[s+52+16>>2]=0;return s|0}return 0}function qs(t,e,i,s){t=+t;e=e|0;i=i|0;s=s|0;var o=0,a=0;while(1){o=Zl(140)|0;if(o|0){a=6;break}o=r[5831]|0;r[5831]=o+0;if(!o){a=5;break}zk[o&3]()}if((a|0)==5){s=Zt(4)|0;r[s>>2]=8308;ce(s|0,2416,215)}else if((a|0)==6){h[o>>2]=t;r[o+4>>2]=e;r[o+72>>2]=i;r[o+76>>2]=r[s>>2];r[o+76+4>>2]=r[s+4>>2];r[o+76+8>>2]=r[s+8>>2];r[o+76+12>>2]=r[s+12>>2];h[o+92>>2]=0.0;h[o+96>>2]=0.0;h[o+100>>2]=.5;h[o+104>>2]=0.0;h[o+108>>2]=0.0;h[o+112>>2]=.800000011920929;h[o+116>>2]=1.0;n[o+120>>0]=0;h[o+124>>2]=.004999999888241291;h[o+128>>2]=.009999999776482582;h[o+132>>2]=.009999999776482582;h[o+136>>2]=.009999999776482582;r[o+8>>2]=1065353216;r[o+12>>2]=0;r[o+12+4>>2]=0;r[o+12+8>>2]=0;r[o+12+12>>2]=0;r[o+28>>2]=1065353216;r[o+32>>2]=0;r[o+32+4>>2]=0;r[o+32+8>>2]=0;r[o+32+12>>2]=0;r[o+48>>2]=1065353216;r[o+52>>2]=0;r[o+52+4>>2]=0;r[o+52+8>>2]=0;r[o+52+12>>2]=0;r[o+52+16>>2]=0;return o|0}return 0}function Ks(t){t=t|0;return+ +h[t+136>>2]}function Zs(t){t=t|0;return+ +h[t+132>>2]}function Qs(t){t=t|0;return+ +h[t+124>>2]}function $s(t){t=t|0;return(n[t+120>>0]|0)!=0|0}function Js(t){t=t|0;return+ +h[t+128>>2]}function tr(t){t=t|0;return+ +h[t+96>>2]}function er(t){t=t|0;return+ +h[t+116>>2]}function ir(t){t=t|0;return+ +h[t+100>>2]}function nr(t){t=t|0;return+ +h[t+92>>2]}function sr(t){t=t|0;return+ +h[t+112>>2]}function rr(t){t=t|0;return+ +h[t+108>>2]}function or(t){t=t|0;return+ +h[t+104>>2]}function ar(t,e){t=t|0;e=+e;h[t+136>>2]=e;return}function lr(t,e){t=t|0;e=+e;h[t+132>>2]=e;return}function hr(t,e){t=t|0;e=+e;h[t+124>>2]=e;return}function cr(t,e){t=t|0;e=e|0;n[t+120>>0]=e&1;return}function _r(t,e){t=t|0;e=+e;h[t+128>>2]=e;return}function ur(t,e){t=t|0;e=+e;h[t+96>>2]=e;return}function dr(t,e){t=t|0;e=+e;h[t+116>>2]=e;return}function pr(t,e){t=t|0;e=+e;h[t+100>>2]=e;return}function fr(t,e){t=t|0;e=+e;h[t+92>>2]=e;return}function mr(t,e){t=t|0;e=+e;h[t+112>>2]=e;return}function gr(t,e){t=t|0;e=+e;h[t+108>>2]=e;return}function br(t,e){t=t|0;e=+e;h[t+104>>2]=e;return}function yr(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function vr(t){t=t|0;if(r[t+204>>2]&3|0)return;if((r[t+216>>2]&-2|0)!=4)r[t+216>>2]=1;h[t+220>>2]=0.0;return}function Sr(t,e){t=t|0;e=e|0;if(!e?r[t+204>>2]&3|0:0)return;if((r[t+216>>2]&-2|0)!=4)r[t+216>>2]=1;h[t+220>>2]=0.0;return}function xr(t,e){t=t|0;e=e|0;var i=0.0,n=0.0;n=+h[e+4>>2]*+h[t+376>>2];i=+h[e+8>>2]*+h[t+380>>2];h[t+436>>2]=+h[e>>2]*+h[t+372>>2]+ +h[t+436>>2];h[t+440>>2]=n+ +h[t+440>>2];h[t+444>>2]=i+ +h[t+444>>2];return}function wr(t,e){t=t|0;e=e|0;var i=0.0,n=0.0,s=0.0;s=+h[t+368>>2];n=+h[e+4>>2]*+h[t+376>>2]*s;i=s*(+h[e+8>>2]*+h[t+380>>2]);h[t+336>>2]=+h[e>>2]*+h[t+372>>2]*s+ +h[t+336>>2];h[t+340>>2]=n+ +h[t+340>>2];h[t+344>>2]=i+ +h[t+344>>2];return}function Cr(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,r=0.0,o=0.0,a=0.0,l=0.0,c=0.0;n=+h[t+372>>2];o=+h[t+376>>2];r=+h[e+4>>2]*o;a=+h[t+380>>2];l=+h[e+8>>2]*a;h[t+436>>2]=+h[e>>2]*n+ +h[t+436>>2];h[t+440>>2]=r+ +h[t+440>>2];h[t+444>>2]=l+ +h[t+444>>2];n=n*+h[e>>2];o=o*+h[e+4>>2];a=a*+h[e+8>>2];l=+h[i+4>>2];r=+h[i+8>>2];c=+h[i>>2];s=(n*r-a*c)*+h[t+572>>2];n=(o*c-n*l)*+h[t+576>>2];h[t+452>>2]=(l*a-o*r)*+h[t+568>>2]+ +h[t+452>>2];h[t+456>>2]=s+ +h[t+456>>2];h[t+460>>2]=n+ +h[t+460>>2];return}function Tr(t,e,i){t=t|0;e=e|0;i=i|0;zE(t,e,i);return}function Ar(t,e){t=t|0;e=e|0;var i=0.0,n=0.0,s=0.0,r=0.0,o=0.0;o=+h[e>>2];r=+h[e+4>>2];s=+h[e+8>>2];n=(o*+h[t+304>>2]+r*+h[t+308>>2]+s*+h[t+312>>2])*+h[t+572>>2];i=(o*+h[t+320>>2]+r*+h[t+324>>2]+s*+h[t+328>>2])*+h[t+576>>2];h[t+352>>2]=(+h[t+288>>2]*o+ +h[t+292>>2]*r+ +h[t+296>>2]*s)*+h[t+568>>2]+ +h[t+352>>2];h[t+356>>2]=n+ +h[t+356>>2];h[t+360>>2]=i+ +h[t+360>>2];return}function Er(t,e){t=t|0;e=e|0;var i=0.0,n=0.0;n=+h[e+4>>2]*+h[t+572>>2];i=+h[e+8>>2]*+h[t+576>>2];h[t+452>>2]=+h[e>>2]*+h[t+568>>2]+ +h[t+452>>2];h[t+456>>2]=n+ +h[t+456>>2];h[t+460>>2]=i+ +h[t+460>>2];return}function Mr(t){t=t|0;var e=0,i=0;r[5637]=(r[5637]|0)+1;e=Zl(659)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}r[e+164>>2]=1065353216;r[e+168>>2]=1065353216;r[e+172>>2]=1065353216;h[e+176>>2]=0.0;r[e+180>>2]=0;h[e+184>>2]=999999984306749440.0;i=e+188|0;r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;r[i+12>>2]=0;r[e+204>>2]=1;r[e+208>>2]=-1;r[e+212>>2]=-1;r[e+216>>2]=1;h[e+220>>2]=0.0;h[e+224>>2]=.5;h[e+228>>2]=0.0;h[e+232>>2]=0.0;r[e+236>>2]=1;r[e+240>>2]=0;r[e+244>>2]=-1;h[e+248>>2]=1.0;h[e+252>>2]=0.0;h[e+256>>2]=0.0;r[e+260>>2]=0;n[e+280>>0]=1;r[e+276>>2]=0;r[e+268>>2]=0;r[e+272>>2]=0;r[e+284>>2]=0;r[e+4>>2]=1065353216;i=e+8|0;r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;r[i+12>>2]=0;r[e+24>>2]=1065353216;i=e+28|0;r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;r[i+12>>2]=0;r[e+44>>2]=1065353216;i=e+48|0;r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;r[i+12>>2]=0;r[i+16>>2]=0;r[e>>2]=7916;n[e+524>>0]=1;r[e+520>>2]=0;r[e+512>>2]=0;r[e+516>>2]=0;Vy(e,t);return e|0}function Rr(t,e){t=t|0;e=e|0;r[t+216>>2]=e;return}function Ir(t){t=t|0;return t+352|0}function Pr(t){t=t|0;return t+4|0}function Lr(t){t=t|0;return r[t+204>>2]|0}function Dr(t){t=t|0;return r[t+192>>2]|0}function kr(t){t=t|0;return t+336|0}function Or(t){t=t|0;return r[t+504>>2]|0}function Fr(t){t=t|0;return t+4|0}function Br(t){t=t|0;t=r[t+216>>2]|0;return(t|0)!=5&(t|0)!=2|0}function Nr(t){t=t|0;return(r[t+204>>2]&2|0)!=0|0}function Ur(t,e){t=t|0;e=e|0;if((r[t+216>>2]&-2|0)==4)return;r[t+216>>2]=e;return}function Vr(t,e){t=t|0;e=e|0;r[t+284>>2]=(r[t+284>>2]|0)+1;r[t+568>>2]=r[e>>2];r[t+568+4>>2]=r[e+4>>2];r[t+568+8>>2]=r[e+8>>2];r[t+568+12>>2]=r[e+12>>2];return}function zr(t,e){t=t|0;e=e|0;r[t+284>>2]=(r[t+284>>2]|0)+1;r[t+352>>2]=r[e>>2];r[t+352+4>>2]=r[e+4>>2];r[t+352+8>>2]=r[e+8>>2];r[t+352+12>>2]=r[e+12>>2];return}function Wr(t,e,i){t=t|0;e=e|0;i=i|0;r[t+164>>2]=r[e>>2];r[t+164+4>>2]=r[e+4>>2];r[t+164+8>>2]=r[e+8>>2];r[t+164+12>>2]=r[e+12>>2];if(!(+h[e>>2]!=1.0)?!(+h[e+4>>2]!=1.0):0)i=+h[e+8>>2]!=1.0?i:0;r[t+180>>2]=i;return}function Gr(t,e){t=t|0;e=+e;h[t+256>>2]=e;return}function jr(t,e){t=t|0;e=+e;h[t+252>>2]=e;return}function Hr(t,e){t=t|0;e=e|0;Gy(t,e);return}function Xr(t,e){t=t|0;e=e|0;r[t+204>>2]=e;return}function Yr(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+8>>2]&127](t,e);return}function qr(t,e){t=t|0;e=+e;h[t+184>>2]=e;return}function Kr(t,e,i){t=t|0;e=+e;i=+i;var n=0;n=_;_=_+32|0;h[n+20>>2]=e;h[n+16>>2]=i;h[n+12>>2]=0.0;h[n+8>>2]=1.0;r[t+468>>2]=r[(e<0.0?n+12|0:e>1.0?n+8|0:n+20|0)>>2];h[n+4>>2]=0.0;h[n>>2]=1.0;r[t+472>>2]=r[(i<0.0?n+4|0:i>1.0?n:n+16|0)>>2];_=n;return}function Zr(t,e){t=t|0;e=+e;r[t+284>>2]=(r[t+284>>2]|0)+1;h[t+224>>2]=e;return}function Qr(t,e){t=t|0;e=e|0;var i=0.0,n=0.0,s=0.0;r[t+372>>2]=r[e>>2];r[t+372+4>>2]=r[e+4>>2];r[t+372+8>>2]=r[e+8>>2];r[t+372+12>>2]=r[e+12>>2];s=+h[t+368>>2];n=s*+h[t+376>>2];i=s*+h[t+380>>2];h[t+584>>2]=+h[t+372>>2]*s;h[t+588>>2]=n;h[t+592>>2]=i;h[t+596>>2]=0.0;return}function $r(t,e){t=t|0;e=e|0;r[t+284>>2]=(r[t+284>>2]|0)+1;r[t+336>>2]=r[e>>2];r[t+336+4>>2]=r[e+4>>2];r[t+336+8>>2]=r[e+8>>2];r[t+336+12>>2]=r[e+12>>2];return}function Jr(t,e,i){t=t|0;e=+e;i=i|0;var n=0,s=0,o=0.0,a=0.0,l=0.0;n=r[t+204>>2]|0;if(e==0.0){r[t+204>>2]=n|1;o=0.0}else{r[t+204>>2]=n&-2;o=1.0/e}h[t+368>>2]=o;l=+h[t+408>>2]*e;a=+h[t+412>>2]*e;h[t+388>>2]=+h[t+404>>2]*e;h[t+392>>2]=l;h[t+396>>2]=a;h[t+400>>2]=0.0;e=+h[i>>2];s=e!=0.0?(h[d>>2]=1.0/e,r[d>>2]|0):0;e=+h[i+4>>2];n=e!=0.0?(h[d>>2]=1.0/e,r[d>>2]|0):0;e=+h[i+8>>2];i=e!=0.0?(h[d>>2]=1.0/e,r[d>>2]|0):0;r[t+420>>2]=s;r[t+424>>2]=n;r[t+428>>2]=i;h[t+432>>2]=0.0;a=o*+h[t+376>>2];l=o*+h[t+380>>2];h[t+584>>2]=+h[t+372>>2]*o;h[t+588>>2]=a;h[t+592>>2]=l;h[t+596>>2]=0.0;return}function to(t,e){t=t|0;e=e|0;r[t+504>>2]=e;if(!e)return;lk[r[(r[e>>2]|0)+8>>2]&127](e,t+4|0);return}function eo(t,e){t=t|0;e=+e;r[t+284>>2]=(r[t+284>>2]|0)+1;h[t+228>>2]=e;return}function io(t,e){t=t|0;e=+e;r[t+284>>2]=(r[t+284>>2]|0)+1;h[t+232>>2]=e;return}function no(t,e,i){t=t|0;e=+e;i=+i;h[t+496>>2]=e;h[t+500>>2]=i;return}function so(t,e){t=t|0;e=e|0;r[t+284>>2]=(r[t+284>>2]|0)+1;r[t+4>>2]=r[e>>2];r[t+4+4>>2]=r[e+4>>2];r[t+4+8>>2]=r[e+8>>2];r[t+4+12>>2]=r[e+12>>2];r[t+20>>2]=r[e+16>>2];r[t+20+4>>2]=r[e+16+4>>2];r[t+20+8>>2]=r[e+16+8>>2];r[t+20+12>>2]=r[e+16+12>>2];r[t+36>>2]=r[e+32>>2];r[t+36+4>>2]=r[e+32+4>>2];r[t+36+8>>2]=r[e+32+8>>2];r[t+36+12>>2]=r[e+32+12>>2];r[t+52>>2]=r[e+48>>2];r[t+52+4>>2]=r[e+48+4>>2];r[t+52+8>>2]=r[e+48+8>>2];r[t+52+12>>2]=r[e+48+12>>2];return}function ro(t,e){t=t|0;e=e|0;return((r[e+236>>2]&2|0)==0?0:e)|0}function oo(t){t=t|0;var e=0.0,i=0.0,n=0.0,s=0.0,r=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0;d=+h[t+4>>2];o=+h[t+420>>2];u=+h[t+8>>2];s=+h[t+424>>2];_=+h[t+12>>2];i=+h[t+428>>2];c=+h[t+20>>2];l=+h[t+24>>2];a=+h[t+28>>2];r=+h[t+36>>2];n=+h[t+40>>2];e=+h[t+44>>2];h[t+288>>2]=d*o*d+u*s*u+_*i*_;h[t+292>>2]=d*o*c+u*s*l+_*i*a;h[t+296>>2]=d*o*r+u*s*n+_*i*e;h[t+300>>2]=0.0;h[t+304>>2]=o*c*d+s*l*u+i*a*_;h[t+308>>2]=o*c*c+s*l*l+i*a*a;h[t+312>>2]=o*c*r+s*l*n+i*a*e;h[t+316>>2]=0.0;h[t+320>>2]=o*r*d+s*n*u+i*e*_;h[t+324>>2]=o*r*c+s*n*l+i*e*a;h[t+328>>2]=o*r*r+s*n*n+i*e*e;h[t+332>>2]=0.0;return}function ao(t){t=t|0;if(!t)return;Ql(t);return}function lo(t){t=t|0;return+ +h[t+80>>2]}function ho(t,e){t=t|0;e=+e;h[t+80>>2]=e;return}function co(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function _o(){var t=0;r[5637]=(r[5637]|0)+1;t=Zl(223)|0;if(!t)t=0;else{r[(t+4+15&-16)+-4>>2]=t;t=t+4+15&-16}r[t>>2]=7540;n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;r[t+12>>2]=0;n[t+40>>0]=1;r[t+36>>2]=0;r[t+28>>2]=0;r[t+32>>2]=0;n[t+60>>0]=1;r[t+56>>2]=0;r[t+48>>2]=0;r[t+52>>2]=0;n[t+80>>0]=1;r[t+76>>2]=0;r[t+68>>2]=0;r[t+72>>2]=0;n[t+100>>0]=1;r[t+96>>2]=0;r[t+88>>2]=0;r[t+92>>2]=0;n[t+120>>0]=1;r[t+116>>2]=0;r[t+108>>2]=0;r[t+112>>2]=0;n[t+140>>0]=1;r[t+136>>2]=0;r[t+128>>2]=0;r[t+132>>2]=0;n[t+160>>0]=1;r[t+156>>2]=0;r[t+148>>2]=0;r[t+152>>2]=0;n[t+180>>0]=1;r[t+176>>2]=0;r[t+168>>2]=0;r[t+172>>2]=0;r[t+192>>2]=13;r[t+196>>2]=14;r[t+200>>2]=0;return t|0}function uo(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function po(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0,l=0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0,O=0,F=0,B=0;o=_;_=_+16|0;r[5637]=(r[5637]|0)+1;s=Zl(1147)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}if(!(n[19880]|0)){n[19880]=1;r[o>>2]=0;r[o+4>>2]=0;r[o+8>>2]=0;r[o+12>>2]=0;zy(21260,0.0,0,0,o)}r[5366]=r[5366]|1;h[5407]=0.0;T=+h[5417]*0.0;P=+h[5418]*0.0;h[5412]=+h[5416]*0.0;h[5413]=T;h[5414]=P;h[5415]=0.0;r[5420]=0;r[5421]=0;r[5422]=0;r[5423]=0;P=+h[5409]*0.0;T=+h[5410]*0.0;h[5461]=+h[5408]*0.0;h[5462]=P;h[5463]=T;h[5464]=0.0;r[s+4>>2]=7;r[s+8>>2]=-1;r[s+12>>2]=-1;h[s+16>>2]=3402823466385288598117041.0e14;n[s+20>>0]=1;n[s+21>>0]=0;r[s+24>>2]=-1;l=s+28|0;r[l>>2]=21260;a=s+32|0;r[a>>2]=t;h[s+36>>2]=0.0;h[s+40>>2]=.30000001192092896;r[s+44>>2]=0;r[s>>2]=7600;n[s+48>>0]=0;B=s+116|0;r[B>>2]=r[e>>2];r[B+4>>2]=r[e+4>>2];r[B+8>>2]=r[e+8>>2];r[B+12>>2]=r[e+12>>2];F=s+132|0;r[F>>2]=r[e+16>>2];r[F+4>>2]=r[e+16+4>>2];r[F+8>>2]=r[e+16+8>>2];r[F+12>>2]=r[e+16+12>>2];O=s+148|0;r[O>>2]=r[e+32>>2];r[O+4>>2]=r[e+32+4>>2];r[O+8>>2]=r[e+32+8>>2];r[O+12>>2]=r[e+32+12>>2];k=s+164|0;r[k>>2]=r[e+48>>2];r[k+4>>2]=r[e+48+4>>2];r[k+8>>2]=r[e+48+8>>2];r[k+12>>2]=r[e+48+12>>2];n[s+180>>0]=i&1;T=+h[B>>2];P=+h[t+4>>2];C=+h[F>>2];I=+h[t+8>>2];w=+h[O>>2];R=+h[t+12>>2];x=+h[s+120>>2];S=+h[s+136>>2];v=+h[s+152>>2];y=+h[s+124>>2];g=+h[s+140>>2];f=+h[s+156>>2];M=+h[t+20>>2];E=+h[t+24>>2];A=+h[t+28>>2];b=+h[t+36>>2];m=+h[t+40>>2];p=+h[t+44>>2];D=+h[k>>2];L=+h[s+168>>2];c=+h[s+172>>2];d=+h[t+52>>2]+(P*D+I*L+R*c);u=M*D+E*L+A*c+ +h[t+56>>2];c=b*D+m*L+p*c+ +h[t+60>>2];h[s+52>>2]=T*P+C*I+w*R;h[s+56>>2]=P*x+I*S+R*v;h[s+60>>2]=P*y+I*g+R*f;h[s+64>>2]=0.0;h[s+68>>2]=T*M+C*E+w*A;h[s+72>>2]=x*M+S*E+v*A;h[s+76>>2]=y*M+g*E+f*A;h[s+80>>2]=0.0;h[s+84>>2]=T*b+C*m+w*p;h[s+88>>2]=x*b+S*m+v*p;h[s+92>>2]=y*b+g*m+f*p;h[s+96>>2]=0.0;h[s+100>>2]=d;h[s+104>>2]=u;h[s+108>>2]=c;h[s+112>>2]=0.0;h[s+184>>2]=1.0;h[s+188>>2]=-1.0;h[s+192>>2]=0.0;h[s+196>>2]=0.0;h[s+200>>2]=1.0;h[s+204>>2]=.699999988079071;h[s+208>>2]=0.0;h[s+212>>2]=0.0;h[s+216>>2]=1.0;h[s+220>>2]=.699999988079071;h[s+224>>2]=0.0;h[s+228>>2]=0.0;h[s+264>>2]=1.0;h[s+268>>2]=.699999988079071;h[s+272>>2]=1.0;h[s+276>>2]=0.0;h[s+280>>2]=1.0;h[s+284>>2]=.699999988079071;h[s+288>>2]=1.0;h[s+292>>2]=0.0;h[s+232>>2]=1.0;h[s+236>>2]=.699999988079071;h[s+240>>2]=1.0;h[s+244>>2]=0.0;h[s+248>>2]=1.0;h[s+252>>2]=.699999988079071;h[s+256>>2]=1.0;h[s+260>>2]=0.0;n[s+1096>>0]=0;i=s+1100|0;h[s+1116>>2]=0.0;h[s+1120>>2]=0.0;h[s+1124>>2]=0.0;r[s+300>>2]=0;r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;n[i+12>>0]=0;n[s+49>>0]=1;Ib(s,(r[l>>2]|0)+4|0,(r[a>>2]|0)+4|0);_=o;return s|0}function fo(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0,l=0;r[5637]=(r[5637]|0)+1;a=Zl(1147)|0;if(!a)a=0;else{r[(a+4+15&-16)+-4>>2]=a;a=a+4+15&-16}r[a+4>>2]=7;r[a+8>>2]=-1;r[a+12>>2]=-1;h[a+16>>2]=3402823466385288598117041.0e14;n[a+20>>0]=1;n[a+21>>0]=0;r[a+24>>2]=-1;l=a+28|0;r[l>>2]=t;t=a+32|0;r[t>>2]=e;h[a+36>>2]=0.0;h[a+40>>2]=.30000001192092896;r[a+44>>2]=0;r[a>>2]=7600;n[a+48>>0]=0;e=a+52|0;r[e>>2]=r[i>>2];r[e+4>>2]=r[i+4>>2];r[e+8>>2]=r[i+8>>2];r[e+12>>2]=r[i+12>>2];e=a+68|0;r[e>>2]=r[i+16>>2];r[e+4>>2]=r[i+16+4>>2];r[e+8>>2]=r[i+16+8>>2];r[e+12>>2]=r[i+16+12>>2];e=a+84|0;r[e>>2]=r[i+32>>2];r[e+4>>2]=r[i+32+4>>2];r[e+8>>2]=r[i+32+8>>2];r[e+12>>2]=r[i+32+12>>2];e=a+100|0;r[e>>2]=r[i+48>>2];r[e+4>>2]=r[i+48+4>>2];r[e+8>>2]=r[i+48+8>>2];r[e+12>>2]=r[i+48+12>>2];i=a+116|0;r[i>>2]=r[s>>2];r[i+4>>2]=r[s+4>>2];r[i+8>>2]=r[s+8>>2];r[i+12>>2]=r[s+12>>2];i=a+132|0;r[i>>2]=r[s+16>>2];r[i+4>>2]=r[s+16+4>>2];r[i+8>>2]=r[s+16+8>>2];r[i+12>>2]=r[s+16+12>>2];i=a+148|0;r[i>>2]=r[s+32>>2];r[i+4>>2]=r[s+32+4>>2];r[i+8>>2]=r[s+32+8>>2];r[i+12>>2]=r[s+32+12>>2];i=a+164|0;r[i>>2]=r[s+48>>2];r[i+4>>2]=r[s+48+4>>2];r[i+8>>2]=r[s+48+8>>2];r[i+12>>2]=r[s+48+12>>2];n[a+180>>0]=o&1;h[a+184>>2]=1.0;h[a+188>>2]=-1.0;h[a+192>>2]=0.0;h[a+196>>2]=0.0;h[a+200>>2]=1.0;h[a+204>>2]=.699999988079071;h[a+208>>2]=0.0;h[a+212>>2]=0.0;h[a+216>>2]=1.0;h[a+220>>2]=.699999988079071;h[a+224>>2]=0.0;h[a+228>>2]=0.0;h[a+264>>2]=1.0;h[a+268>>2]=.699999988079071;h[a+272>>2]=1.0;h[a+276>>2]=0.0;h[a+280>>2]=1.0;h[a+284>>2]=.699999988079071;h[a+288>>2]=1.0;h[a+292>>2]=0.0;h[a+232>>2]=1.0;h[a+236>>2]=.699999988079071;h[a+240>>2]=1.0;h[a+244>>2]=0.0;h[a+248>>2]=1.0;h[a+252>>2]=.699999988079071;h[a+256>>2]=1.0;h[a+260>>2]=0.0;n[a+1096>>0]=0;o=a+1100|0;h[a+1116>>2]=0.0;h[a+1120>>2]=0.0;h[a+1124>>2]=0.0;r[a+300>>2]=0;r[o>>2]=0;r[o+4>>2]=0;r[o+8>>2]=0;n[o+12>>0]=0;n[a+49>>0]=1;Ib(a,(r[l>>2]|0)+4|0,(r[t>>2]|0)+4|0);return a|0}function mo(t,e){t=t|0;e=e|0;n[t+21>>0]=e&1;return}function go(t){t=t|0;return+ +h[t+16>>2]}function bo(t,e){t=t|0;e=+e;h[t+16>>2]=e;return}function yo(t,e){t=t|0;e=+e;e=+ql(e);if(!(e<-3.1415927410125732)){if(e>3.1415927410125732)e=e+-6.2831854820251465}else e=e+6.2831854820251465;h[t+192>>2]=e;return}function vo(t,e){t=t|0;e=+e;h[t+184>>2]=e;return}function So(t,e){t=t|0;e=+e;e=+ql(e);if(!(e<-3.1415927410125732)){if(e>3.1415927410125732)e=e+-6.2831854820251465}else e=e+6.2831854820251465;h[t+196>>2]=e;return}function xo(t,e){t=t|0;e=+e;h[t+188>>2]=e;return}function wo(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Co(t){t=+t;var e=0;r[5637]=(r[5637]|0)+1;e=Zl(75)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}r[e+8>>2]=0;r[e+12>>2]=-1;r[e+16>>2]=1065353216;r[e+20>>2]=1065353216;r[e+24>>2]=1065353216;h[e+28>>2]=0.0;r[e>>2]=6380;r[e+4>>2]=8;h[e+32>>2]=t;h[e+48>>2]=t;return e|0}function To(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function Ao(t){t=t|0;return+ +xk[r[(r[t>>2]|0)+48>>2]&15](t)}function Eo(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function Mo(t,e){t=t|0;e=+e;rk[r[(r[t>>2]|0)+44>>2]&31](t,e);return}function Ro(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Io(t,e){t=t|0;e=+e;var i=0,n=0,s=0.0,o=0.0,a=0.0,l=0.0;r[5637]=(r[5637]|0)+1;i=Zl(107)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}n=i+4|0;r[n>>2]=35;r[i+8>>2]=0;r[i+12>>2]=-1;h[i+16>>2]=0.0;r[i>>2]=6480;l=+h[t>>2];a=+h[t+4>>2];o=+h[t+8>>2];t=r[t+12>>2]|0;s=1.0/+G(+(l*l+a*a+o*o));h[i+52>>2]=l*s;h[i+56>>2]=a*s;h[i+60>>2]=o*s;r[i+64>>2]=t;h[i+68>>2]=e;r[i+72>>2]=1065353216;r[i+76>>2]=1065353216;r[i+80>>2]=1065353216;h[i+84>>2]=0.0;r[n>>2]=28;return i|0}function Po(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function Lo(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function Do(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function ko(t){t=t|0;if(!t)return;Ql(t);return}function Oo(){var t=0,e=0;while(1){t=Zl(64)|0;if(t|0){e=6;break}t=r[5831]|0;r[5831]=t+0;if(!t){e=5;break}zk[t&3]()}if((e|0)==5){e=Zt(4)|0;r[e>>2]=8308;ce(e|0,2416,215)}else if((e|0)==6)return t|0;return 0}function Fo(t,e){t=t|0;e=e|0;var i=0,n=0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0;while(1){i=Zl(64)|0;if(i|0){n=6;break}i=r[5831]|0;r[5831]=i+0;if(!i){n=5;break}zk[i&3]()}if((n|0)==5){e=Zt(4)|0;r[e>>2]=8308;ce(e|0,2416,215)}else if((n|0)==6){l=+h[t>>2];o=+h[t+4>>2];u=+h[t+8>>2];c=+h[t+12>>2];a=l*(2.0/(l*l+o*o+u*u+c*c));s=o*(2.0/(l*l+o*o+u*u+c*c));_=u*(2.0/(l*l+o*o+u*u+c*c));h[i>>2]=1.0-(o*s+u*_);h[i+4>>2]=l*s-c*_;h[i+8>>2]=l*_+c*s;h[i+12>>2]=0.0;h[i+16>>2]=l*s+c*_;h[i+20>>2]=1.0-(l*a+u*_);h[i+24>>2]=o*_-c*a;h[i+28>>2]=0.0;h[i+32>>2]=l*_-c*s;h[i+36>>2]=o*_+c*a;h[i+40>>2]=1.0-(l*a+o*s);h[i+44>>2]=0.0;r[i+48>>2]=r[e>>2];r[i+48+4>>2]=r[e+4>>2];r[i+48+8>>2]=r[e+8>>2];r[i+48+12>>2]=r[e+12>>2];return i|0}return 0}function Bo(t){t=t|0;return t|0}function No(t){t=t|0;return t+48|0}function Uo(t){t=t|0;var e=0;e=_;_=_+16|0;if(!(n[19928]|0))n[19928]=1;Kx(t,e);r[5700]=r[e>>2];r[5701]=r[e+4>>2];r[5702]=r[e+8>>2];r[5703]=r[e+12>>2];_=e;return 22800}function Vo(t){t=t|0;r[t>>2]=1065353216;r[t+4>>2]=0;r[t+4+4>>2]=0;r[t+4+8>>2]=0;r[t+4+12>>2]=0;r[t+20>>2]=1065353216;r[t+24>>2]=0;r[t+24+4>>2]=0;r[t+24+8>>2]=0;r[t+24+12>>2]=0;r[t+40>>2]=1065353216;r[t+44>>2]=0;r[t+44+4>>2]=0;r[t+44+8>>2]=0;r[t+44+12>>2]=0;r[t+44+16>>2]=0;return}function zo(t,e){t=t|0;e=e|0;r[t+48>>2]=r[e>>2];r[t+48+4>>2]=r[e+4>>2];r[t+48+8>>2]=r[e+8>>2];r[t+48+12>>2]=r[e+12>>2];return}function Wo(t,e){t=t|0;e=e|0;var i=0.0,n=0.0,s=0.0,r=0.0,o=0.0,a=0.0,l=0.0;r=+h[e>>2];n=+h[e+4>>2];l=+h[e+8>>2];o=+h[e+12>>2];s=r*(2.0/(r*r+n*n+l*l+o*o));i=n*(2.0/(r*r+n*n+l*l+o*o));a=l*(2.0/(r*r+n*n+l*l+o*o));h[t>>2]=1.0-(n*i+l*a);h[t+4>>2]=r*i-o*a;h[t+8>>2]=r*a+o*i;h[t+12>>2]=0.0;h[t+16>>2]=r*i+o*a;h[t+20>>2]=1.0-(r*s+l*a);h[t+24>>2]=n*a-o*s;h[t+28>>2]=0.0;h[t+32>>2]=r*a-o*i;h[t+36>>2]=n*a+o*s;h[t+40>>2]=1.0-(r*s+n*i);h[t+44>>2]=0.0;return}function Go(t){t=t|0;if(!t)return;Ql(t);return}function jo(t){t=t|0;return t+260|0}function Ho(t,e){t=t|0;e=e|0;r[t+260>>2]=r[e>>2];r[t+260+4>>2]=r[e+4>>2];r[t+260+8>>2]=r[e+8>>2];r[t+260+12>>2]=r[e+12>>2];return}function Xo(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Yo(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function qo(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function Ko(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Zo(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0;s=r[t+32>>2]|0;r[s>>2]=(r[s>>2]|0)+1;bv(t,yv(t,e,0)|0);bv(t,yv(t,i,0)|0);bv(t,yv(t,n,0)|0);return}function Qo(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var o=0;o=r[t+32>>2]|0;r[o>>2]=(r[o>>2]|0)+1;bv(t,yv(t,e,s)|0);bv(t,yv(t,i,s)|0);bv(t,yv(t,n,s)|0);return}function $o(){var t=0;r[5637]=(r[5637]|0)+1;t=Zl(191)|0;if(!t)t=0;else{r[(t+4+15&-16)+-4>>2]=t;t=t+4+15&-16}gv(t,1,1);return t|0}function Jo(t){t=t|0;var e=0;r[5637]=(r[5637]|0)+1;e=Zl(191)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}gv(e,t,1);return e|0}function ta(t,e){t=t|0;e=e|0;var i=0;r[5637]=(r[5637]|0)+1;i=Zl(191)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}gv(i,t,e);return i|0}function ea(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function ia(t,e){t=t|0;e=e|0;n[t+21>>0]=e&1;return}function na(t){t=t|0;return+ +h[t+16>>2]}function sa(t,e){t=t|0;e=+e;h[t+16>>2]=e;return}function ra(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function oa(){var t=0;r[5637]=(r[5637]|0)+1;t=Zl(35)|0;if(!t){t=0;return t|0}r[(t+4+15&-16)+-4>>2]=t;t=t+4+15&-16;return t|0}function aa(t,e,i){t=+t;e=+e;i=+i;var n=0;r[5637]=(r[5637]|0)+1;n=Zl(35)|0;if(!n)n=0;else{r[(n+4+15&-16)+-4>>2]=n;n=n+4+15&-16}h[n>>2]=t;h[n+4>>2]=e;h[n+8>>2]=i;h[n+12>>2]=0.0;return n|0}function la(t,e){t=t|0;e=e|0;return+(+h[t>>2]*+h[e>>2]+ +h[t+4>>2]*+h[e+4>>2]+ +h[t+8>>2]*+h[e+8>>2])}function ha(t){t=t|0;var e=0.0,i=0.0,n=0.0;n=+h[t>>2];i=+h[t+4>>2];e=+h[t+8>>2];return+ +G(+(n*n+i*i+e*e))}function ca(t){t=t|0;var e=0.0,i=0.0,n=0.0,s=0.0;s=+h[t>>2];n=+h[t+4>>2];i=+h[t+8>>2];e=1.0/+G(+(s*s+n*n+i*i));h[t>>2]=s*e;h[t+4>>2]=n*e;h[t+8>>2]=i*e;return}function _a(t,e){t=t|0;e=e|0;h[t>>2]=+h[e>>2]+ +h[t>>2];h[t+4>>2]=+h[e+4>>2]+ +h[t+4>>2];h[t+8>>2]=+h[e+8>>2]+ +h[t+8>>2];return t|0}function ua(t,e){t=t|0;e=+e;h[t>>2]=+h[t>>2]*e;h[t+4>>2]=+h[t+4>>2]*e;h[t+8>>2]=+h[t+8>>2]*e;return t|0}function da(t,e){t=t|0;e=e|0;h[t>>2]=+h[t>>2]-+h[e>>2];h[t+4>>2]=+h[t+4>>2]-+h[e+4>>2];h[t+8>>2]=+h[t+8>>2]-+h[e+8>>2];return t|0}function pa(t,e,i,n){t=t|0;e=+e;i=+i;n=+n;h[t>>2]=e;h[t+4>>2]=i;h[t+8>>2]=n;h[t+12>>2]=0.0;return}function fa(t,e){t=t|0;e=+e;h[t>>2]=e;return}function ma(t,e){t=t|0;e=+e;h[t+4>>2]=e;return}function ga(t,e){t=t|0;e=+e;h[t+8>>2]=e;return}function ba(t){t=t|0;return+ +h[t>>2]}function ya(t){t=t|0;return+ +h[t+4>>2]}function va(t){t=t|0;return+ +h[t+8>>2]}function Sa(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function xa(){var t=0;r[5637]=(r[5637]|0)+1;t=Zl(35)|0;if(!t){t=0;return t|0}r[(t+4+15&-16)+-4>>2]=t;t=t+4+15&-16;return t|0}function wa(t,e,i,n){t=+t;e=+e;i=+i;n=+n;var s=0;r[5637]=(r[5637]|0)+1;s=Zl(35)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}h[s>>2]=t;h[s+4>>2]=e;h[s+8>>2]=i;h[s+12>>2]=n;return s|0}function Ca(t,e){t=t|0;e=e|0;return+(+h[t>>2]*+h[e>>2]+ +h[t+4>>2]*+h[e+4>>2]+ +h[t+8>>2]*+h[e+8>>2])}function Ta(t){t=t|0;var e=0.0,i=0.0,n=0.0;n=+h[t>>2];i=+h[t+4>>2];e=+h[t+8>>2];return+ +G(+(n*n+i*i+e*e))}function Aa(t){t=t|0;var e=0.0,i=0.0,n=0.0,s=0.0;s=+h[t>>2];n=+h[t+4>>2];i=+h[t+8>>2];e=1.0/+G(+(s*s+n*n+i*i));h[t>>2]=s*e;h[t+4>>2]=n*e;h[t+8>>2]=i*e;return}function Ea(t,e){t=t|0;e=e|0;h[t>>2]=+h[e>>2]+ +h[t>>2];h[t+4>>2]=+h[e+4>>2]+ +h[t+4>>2];h[t+8>>2]=+h[e+8>>2]+ +h[t+8>>2];return t|0}function Ma(t,e){t=t|0;e=+e;h[t>>2]=+h[t>>2]*e;h[t+4>>2]=+h[t+4>>2]*e;h[t+8>>2]=+h[t+8>>2]*e;return t|0}function Ra(t,e){t=t|0;e=e|0;h[t>>2]=+h[t>>2]-+h[e>>2];h[t+4>>2]=+h[t+4>>2]-+h[e+4>>2];h[t+8>>2]=+h[t+8>>2]-+h[e+8>>2];return t|0}function Ia(t,e,i,n,s){t=t|0;e=+e;i=+i;n=+n;s=+s;h[t>>2]=e;h[t+4>>2]=i;h[t+8>>2]=n;h[t+12>>2]=s;return}function Pa(t,e){t=t|0;e=+e;h[t>>2]=e;return}function La(t,e){t=t|0;e=+e;h[t+4>>2]=e;return}function Da(t,e){t=t|0;e=+e;h[t+8>>2]=e;return}function ka(t){t=t|0;return+ +h[t+12>>2]}function Oa(t){t=t|0;return+ +h[t>>2]}function Fa(t){t=t|0;return+ +h[t+4>>2]}function Ba(t){t=t|0;return+ +h[t+8>>2]}function Na(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Ua(){var t=0,e=0;while(1){t=Zl(24)|0;if(t|0){e=6;break}t=r[5831]|0;r[5831]=t+0;if(!t){e=5;break}zk[t&3]()}if((e|0)==5){e=Zt(4)|0;r[e>>2]=8308;ce(e|0,2416,215)}else if((e|0)==6){h[t>>2]=5.880000114440918;h[t+4>>2]=.8299999833106995;h[t+8>>2]=.8799999952316284;h[t+12>>2]=500.0;h[t+16>>2]=10.5;h[t+20>>2]=6.0e3;return t|0}return 0}function Va(t){t=t|0;return+ +h[t+16>>2]}function za(t){t=t|0;return+ +h[t+20>>2]}function Wa(t){t=t|0;return+ +h[t+12>>2]}function Ga(t){t=t|0;return+ +h[t+4>>2]}function ja(t){t=t|0;return+ +h[t+8>>2]}function Ha(t){t=t|0;return+ +h[t>>2]}function Xa(t,e){t=t|0;e=+e;h[t+16>>2]=e;return}function Ya(t,e){t=t|0;e=+e;h[t+20>>2]=e;return}function qa(t,e){t=t|0;e=+e;h[t+12>>2]=e;return}function Ka(t,e){t=t|0;e=+e;h[t+4>>2]=e;return}function Za(t,e){t=t|0;e=+e;h[t+8>>2]=e;return}function Qa(t,e){t=t|0;e=+e;h[t>>2]=e;return}function $a(t){t=t|0;if(!t)return;Ql(t);return}function Ja(t){t=t|0;return(n[t+260>>0]|0)!=0|0}function tl(t){t=t|0;return t+156|0}function el(t){t=t|0;return+ +h[t+252>>2]}function il(t){t=t|0;return+ +h[t+228>>2]}function nl(t){t=t|0;return+ +h[t+248>>2]}function sl(t){t=t|0;return+ +h[t+208>>2]}function rl(t){t=t|0;return t|0}function ol(t){t=t|0;return+ +h[t+244>>2]}function al(t){t=t|0;return+ +h[t+232>>2]}function ll(t){t=t|0;return+ +h[t+204>>2]}function hl(t){t=t|0;return+ +h[t+216>>2]}function cl(t){t=t|0;return+ +h[t+220>>2]}function _l(t){t=t|0;return+ +h[t+224>>2]}function ul(t){t=t|0;return+ +h[t+212>>2]}function dl(t){t=t|0;return+ +h[t+276>>2]}function pl(t,e){t=t|0;e=e|0;n[t+260>>0]=e&1;return}function fl(t,e){t=t|0;e=e|0;r[t+156>>2]=r[e>>2];r[t+156+4>>2]=r[e+4>>2];r[t+156+8>>2]=r[e+8>>2];r[t+156+12>>2]=r[e+12>>2];return}function ml(t,e){t=t|0;e=+e;h[t+252>>2]=e;return}function gl(t,e){t=t|0;e=+e;h[t+228>>2]=e;return}function bl(t,e){t=t|0;e=+e;h[t+248>>2]=e;return}function yl(t,e){t=t|0;e=+e;h[t+208>>2]=e;return}function vl(t,e){t=t|0;e=e|0;var i=0;i=t+92|0;do{r[t>>2]=r[e>>2];t=t+4|0;e=e+4|0}while((t|0)<(i|0));return}function Sl(t,e){t=t|0;e=+e;h[t+244>>2]=e;return}function xl(t,e){t=t|0;e=+e;h[t+232>>2]=e;return}function wl(t,e){t=t|0;e=+e;h[t+204>>2]=e;return}function Cl(t,e){t=t|0;e=+e;h[t+216>>2]=e;return}function Tl(t,e){t=t|0;e=+e;h[t+220>>2]=e;return}function Al(t,e){t=t|0;e=+e;h[t+224>>2]=e;return}function El(t,e){t=t|0;e=+e;h[t+212>>2]=e;return}function Ml(t,e){t=t|0;e=+e;h[t+276>>2]=e;return}function Rl(){return 0}function Il(){return 1}function Pl(){return 2}function Ll(){return 3}function Dl(){return 4}function kl(){return 5}function Ol(t){t=t|0;var e=0,i=0;i=_;_=_+16|0;r[i>>2]=r[t+60>>2];t=_e(6,i|0)|0;if(t>>>0>4294963200){if(!0)e=22816;else e=r[(Nh()|0)+64>>2]|0;r[e>>2]=0-t;t=-1}_=i;return t|0}function Fl(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0,a=0,l=0,h=0;h=_;_=_+48|0;o=r[t+28>>2]|0;r[h+32>>2]=o;o=(r[t+20>>2]|0)-o|0;r[h+32+4>>2]=o;r[h+32+8>>2]=e;r[h+32+12>>2]=i;l=h+32|0;s=2;o=o+i|0;while(1){if(!0){r[h+16>>2]=r[t+60>>2];r[h+16+4>>2]=l;r[h+16+8>>2]=s;e=me(146,h+16|0)|0;if(e>>>0>4294963200){if(!0)n=22816;else n=r[(Nh()|0)+64>>2]|0;r[n>>2]=0-e;e=-1}}else{ue(218,t|0);r[h>>2]=r[t+60>>2];r[h+4>>2]=l;r[h+8>>2]=s;e=me(146,h|0)|0;if(e>>>0>4294963200){if(!0)n=22816;else n=r[(Nh()|0)+64>>2]|0;r[n>>2]=0-e;e=-1}Yt(0)}if((o|0)==(e|0)){e=13;break}if((e|0)<0){e=15;break}o=o-e|0;n=r[l+4>>2]|0;if(e>>>0<=n>>>0)if((s|0)==2){r[t+28>>2]=(r[t+28>>2]|0)+e;a=n;n=l;s=2}else{a=n;n=l}else{a=r[t+44>>2]|0;r[t+28>>2]=a;r[t+20>>2]=a;a=r[l+12>>2]|0;e=e-n|0;n=l+8|0;s=s+-1|0}r[n>>2]=(r[n>>2]|0)+e;r[n+4>>2]=a-e;l=n}if((e|0)==13){l=r[t+44>>2]|0;r[t+16>>2]=l+(r[t+48>>2]|0);r[t+28>>2]=l;r[t+20>>2]=l}else if((e|0)==15){r[t+16>>2]=0;r[t+28>>2]=0;r[t+20>>2]=0;r[t>>2]=r[t>>2]|32;if((s|0)==2)i=0;else i=i-(r[l+4>>2]|0)|0}_=h;return i|0}function Bl(t){t=t|0;return}function Nl(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0;s=_;_=_+32|0;r[s>>2]=r[t+60>>2];r[s+4>>2]=0;r[s+8>>2]=e;r[s+12>>2]=s+20;r[s+16>>2]=i;e=pe(140,s|0)|0;if(e>>>0<=4294963200)if((e|0)<0)n=7;else t=r[s+20>>2]|0;else{if(!0)t=22816;else t=r[(Nh()|0)+64>>2]|0;r[t>>2]=0-e;n=7}if((n|0)==7){r[s+20>>2]=-1;t=-1}_=s;return t|0}function Ul(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0;t:do{if((i|0)!=0&(t&3|0)!=0){s=i;while(1){if((n[t>>0]|0)==(e&255)<<24>>24)break t;t=t+1|0;i=s+-1|0;if((i|0)!=0&(t&3|0)!=0)s=i;else{s=i;i=(i|0)!=0;o=5;break}}}else{s=i;i=(i|0)!=0;o=5}}while(0);t:do{if((o|0)==5)if(i){if((n[t>>0]|0)!=(e&255)<<24>>24){i=et(e&255,16843009)|0;e:do{if(s>>>0>3)while(1){a=r[t>>2]^i;if((a&-2139062144^-2139062144)&a+-16843009|0)break;t=t+4|0;s=s+-4|0;if(s>>>0<=3){o=11;break e}}else o=11}while(0);if((o|0)==11)if(!s){s=0;break}while(1){if((n[t>>0]|0)==(e&255)<<24>>24)break t;t=t+1|0;s=s+-1|0;if(!s){s=0;break}}}}else s=0}while(0);return(s|0?t:0)|0}function Vl(t,e,i,a,l){t=t|0;e=e|0;i=i|0;a=a|0;l=l|0;var h=0,u=0,p=0,f=0.0,m=0,g=0,b=0.0,y=0,v=0,S=0,x=0,w=0,C=0,T=0,A=0,E=0,M=0,R=0,I=0,L=0,D=0,k=0,O=0,F=0,B=0,N=0,U=0,V=0;V=_;_=_+624|0;F=V+536+40|0;N=V+588|0;U=V+576+12|0;B=V+588+9|0;h=0;u=0;g=0;x=e;t:while(1){do{if((h|0)>-1){if((u|0)<=(2147483647-h|0)){h=u+h|0;break}if(!0)h=22816;else h=r[(Nh()|0)+64>>2]|0;r[h>>2]=75;h=-1}}while(0);e=n[x>>0]|0;if(!(e<<24>>24)){O=254;break}else u=x;e:while(1){switch(e<<24>>24){case 37:{e=u;O=11;break e}case 0:{e=u;break e}default:{}}k=u+1|0;e=n[k>>0]|0;u=k}e:do{if((O|0)==11)while(1){O=0;if((n[e+1>>0]|0)!=37)break e;u=u+1|0;e=e+2|0;if((n[e>>0]|0)==37)O=11;else break}}while(0);S=u-x|0;if(t|0?(r[t>>2]&32|0)==0:0)zl(x,S,t);if((u|0)!=(x|0)){u=S;x=e;continue}p=e+1|0;u=n[p>>0]|0;if(((u<<24>>24)+-48|0)>>>0<10){k=(n[e+2>>0]|0)==36;p=k?e+3|0:p;m=n[p>>0]|0;v=k?(u<<24>>24)+-48|0:-1;g=k?1:g}else{m=u;v=-1}e=m<<24>>24;e:do{if((e&-32|0)==32){u=m;m=0;do{if(!(1<<e+-32&75913))break e;m=1<<(u<<24>>24)+-32|m;p=p+1|0;u=n[p>>0]|0;e=u<<24>>24}while((e&-32|0)==32)}else{u=m;m=0}}while(0);do{if(u<<24>>24==42){u=p+1|0;e=(n[u>>0]|0)+-48|0;if(e>>>0<10?(n[p+2>>0]|0)==36:0){r[l+(e<<2)>>2]=10;e=1;p=p+3|0;u=r[a+((n[u>>0]|0)+-48<<3)>>2]|0}else{if(g|0){h=-1;break t}if(!t){y=m;k=0;p=u;D=0;break}e=(r[i>>2]|0)+(4-1)&~(4-1);k=r[e>>2]|0;r[i>>2]=e+4;e=0;p=u;u=k}if((u|0)<0){y=m|8192;k=e;D=0-u|0}else{y=m;k=e;D=u}}else{e=(u<<24>>24)+-48|0;if(e>>>0<10){u=0;do{u=(u*10|0)+e|0;p=p+1|0;e=(n[p>>0]|0)+-48|0}while(e>>>0<10);if((u|0)<0){h=-1;break t}else{y=m;k=g;D=u}}else{y=m;k=g;D=0}}}while(0);e:do{if((n[p>>0]|0)==46){e=p+1|0;m=n[e>>0]|0;if(m<<24>>24!=42){if(((m<<24>>24)+-48|0)>>>0<10){u=0;p=(m<<24>>24)+-48|0}else{g=0;break}while(1){u=(u*10|0)+p|0;e=e+1|0;p=(n[e>>0]|0)+-48|0;if(p>>>0>=10){g=u;break e}}}e=p+2|0;u=(n[e>>0]|0)+-48|0;if(u>>>0<10?(n[p+3>>0]|0)==36:0){r[l+(u<<2)>>2]=10;g=r[a+((n[e>>0]|0)+-48<<3)>>2]|0;e=p+4|0;break}if(k|0){h=-1;break t}if(t|0){L=(r[i>>2]|0)+(4-1)&~(4-1);g=r[L>>2]|0;r[i>>2]=L+4}else g=0}else{g=-1;e=p}}while(0);m=0;while(1){u=(n[e>>0]|0)+-65|0;if(u>>>0>57){h=-1;break t}L=e+1|0;u=n[16811+(m*58|0)+u>>0]|0;if(((u&255)+-1|0)>>>0<8){e=L;m=u&255}else break}if(!(u<<24>>24)){h=-1;break}p=(v|0)>-1;do{if(u<<24>>24==19)if(p){h=-1;break t}else O=54;else{if(p){r[l+(v<<2)>>2]=u&255;I=a+(v<<3)|0;O=r[I+4>>2]|0;r[V>>2]=r[I>>2];r[V+4>>2]=O;O=54;break}if(!t){h=0;break t}Gl(V,u&255,i)}}while(0);if((O|0)==54?(O=0,(t|0)==0):0){u=S;g=k;x=L;continue}R=n[e>>0]|0;R=(m|0)!=0&(R&15|0)==3?R&-33:R;p=y&-65537;I=(y&8192|0)==0?y:p;e:do{switch(R|0){case 110:switch(m|0){case 0:{r[r[V>>2]>>2]=h;u=S;g=k;x=L;continue t}case 1:{r[r[V>>2]>>2]=h;u=S;g=k;x=L;continue t}case 2:{u=r[V>>2]|0;r[u>>2]=h;r[u+4>>2]=((h|0)<0)<<31>>31;u=S;g=k;x=L;continue t}case 3:{s[r[V>>2]>>1]=h;u=S;g=k;x=L;continue t}case 4:{n[r[V>>2]>>0]=h;u=S;g=k;x=L;continue t}case 6:{r[r[V>>2]>>2]=h;u=S;g=k;x=L;continue t}case 7:{u=r[V>>2]|0;r[u>>2]=h;r[u+4>>2]=((h|0)<0)<<31>>31;u=S;g=k;x=L;continue t}default:{u=S;g=k;x=L;continue t}}case 112:{y=I|8;g=g>>>0>8?g:8;v=120;O=66;break}case 88:case 120:{y=I;v=R;O=66;break}case 111:{u=r[V>>2]|0;p=r[V+4>>2]|0;if((u|0)==0&(p|0)==0)e=F;else{e=F;do{e=e+-1|0;n[e>>0]=u&7|48;u=kh(u|0,p|0,3)|0;p=P}while(!((u|0)==0&(p|0)==0))}if(!(I&8)){u=I;y=0;m=17291;O=79}else{y=F-e|0;u=I;g=(g|0)>(y|0)?g:y+1|0;y=0;m=17291;O=79}break}case 105:case 100:{e=r[V>>2]|0;u=r[V+4>>2]|0;if((u|0)<0){e=Rh(0,0,e|0,u|0)|0;u=P;r[V>>2]=e;r[V+4>>2]=u;p=1;m=17291;O=78;break e}if(!(I&2048)){p=I&1;m=(I&1|0)==0?17291:17293;O=78}else{p=1;m=17292;O=78}break}case 117:{e=r[V>>2]|0;u=r[V+4>>2]|0;p=0;m=17291;O=78;break}case 99:{n[V+536+39>>0]=r[V>>2];e=V+536+39|0;v=1;x=0;S=17291;u=F;break}case 109:{if(!0)e=22816;else e=r[(Nh()|0)+64>>2]|0;u=r[e>>2]|0;e=0;while(1){if((o[17301+e>>0]|0)==(u|0)){O=85;break}e=e+1|0;if((e|0)==87){u=87;e=17389;break}}if((O|0)==85)if(!e){u=17389;O=92;break e}else{u=e;e=17389}do{do{O=e;e=e+1|0}while((n[O>>0]|0)!=0);u=u+-1|0}while((u|0)!=0);u=e;O=92;break}case 115:{u=r[V>>2]|0;u=u|0?u:19193;O=92;break}case 67:{r[V+8>>2]=r[V>>2];r[V+8+4>>2]=0;r[V>>2]=V+8;e=V+8|0;g=-1;O=96;break}case 83:{e=r[V>>2]|0;if(!g){Hl(t,32,D,0,I);e=0;O=107}else O=96;break}case 65:case 71:case 70:case 69:case 97:case 103:case 102:case 101:{f=+c[V>>3];r[V+16>>2]=0;c[d>>3]=f;if((r[d+4>>2]|0)>=0)if(!(I&2048)){E=I&1;M=(I&1|0)==0?19201:19206}else{E=1;M=19203}else{f=-f;E=1;M=19200}c[d>>3]=f;A=r[d+4>>2]&2146435072;do{if(A>>>0<2146435072|(A|0)==2146435072&0<0){f=+Yl(f,V+16|0)*2.0;if(f!=0.0)r[V+16>>2]=(r[V+16>>2]|0)+-1;if((R|32|0)==97){v=(R&32|0)==0?M:M+9|0;y=E|2;e=12-g|0;do{if(!(g>>>0>11|(e|0)==0)){b=8.0;do{e=e+-1|0;b=b*16.0}while((e|0)!=0);if((n[v>>0]|0)==45){f=-(b+(-f-b));break}else{f=f+b-b;break}}}while(0);u=r[V+16>>2]|0;e=(u|0)<0?0-u|0:u;e=jl(e,((e|0)<0)<<31>>31,V+576+12|0)|0;if((e|0)==(V+576+12|0)){n[V+576+11>>0]=48;e=V+576+11|0}n[e+-1>>0]=(u>>31&2)+43;m=e+-2|0;n[m>>0]=R+15;p=(g|0)<1;e=V+588|0;while(1){M=~~f;u=e+1|0;n[e>>0]=o[17275+M>>0]|R&32;f=(f-+(M|0))*16.0;do{if((u-N|0)==1){if((I&8|0)==0&(p&f==0.0))break;n[u>>0]=46;u=e+2|0}}while(0);if(!(f!=0.0))break;else e=u}e=(g|0)!=0&(-2-N+u|0)<(g|0)?U+2+g-m|0:U-N-m+u|0;Hl(t,32,D,e+y|0,I);if(!(r[t>>2]&32))zl(v,y,t);Hl(t,48,D,e+y|0,I^65536);if(!(r[t>>2]&32))zl(V+588|0,u-N|0,t);Hl(t,48,e-(u-N+(U-m))|0,0,0);if(!(r[t>>2]&32))zl(m,U-m|0,t);Hl(t,32,D,e+y|0,I^8192);e=(e+y|0)<(D|0)?D:e+y|0;break}e=(g|0)<0?6:g;if(f!=0.0){u=(r[V+16>>2]|0)+-28|0;r[V+16>>2]=u;f=f*268435456.0}else u=r[V+16>>2]|0;A=(u|0)<0?V+24|0:V+24+288|0;m=A;do{T=~~f>>>0;r[m>>2]=T;m=m+4|0;f=(f-+(T>>>0))*1.0e9}while(f!=0.0);u=r[V+16>>2]|0;if((u|0)>0){p=A;do{y=(u|0)>29?29:u;u=m+-4|0;do{if(u>>>0>=p>>>0){g=0;do{C=Lh(r[u>>2]|0,0,y|0)|0;C=Ih(C|0,P|0,g|0,0)|0;T=P;w=Hh(C|0,T|0,1e9,0)|0;r[u>>2]=w;g=jh(C|0,T|0,1e9,0)|0;u=u+-4|0}while(u>>>0>=p>>>0);if(!g)break;p=p+-4|0;r[p>>2]=g}}while(0);while(1){if(m>>>0<=p>>>0)break;u=m+-4|0;if(!(r[u>>2]|0))m=u;else break}u=(r[V+16>>2]|0)-y|0;r[V+16>>2]=u}while((u|0)>0)}else p=A;if((u|0)<0){do{y=0-u|0;y=(y|0)>9?9:y;do{if(p>>>0<m>>>0){g=0;u=p;do{T=r[u>>2]|0;r[u>>2]=(T>>>y)+g;g=et(T&(1<<y)+-1,1e9>>>y)|0;u=u+4|0}while(u>>>0<m>>>0);u=(r[p>>2]|0)==0?p+4|0:p;if(!g){p=u;u=m;break}r[m>>2]=g;p=u;u=m+4|0}else{p=(r[p>>2]|0)==0?p+4|0:p;u=m}}while(0);m=(R|32|0)==102?A:p;m=(u-m>>2|0)>(((e+25|0)/9|0)+1|0)?m+(((e+25|0)/9|0)+1<<2)|0:u;u=(r[V+16>>2]|0)+y|0;r[V+16>>2]=u}while((u|0)<0);u=p}else u=p;do{if(u>>>0<m>>>0){p=(A-u>>2)*9|0;y=r[u>>2]|0;if(y>>>0<10)break;else g=10;do{g=g*10|0;p=p+1|0}while(y>>>0>=g>>>0)}else p=0}while(0);g=e-((R|32|0)!=102?p:0)+(((e|0)!=0&(R|32|0)==103)<<31>>31)|0;if((g|0)<(((m-A>>2)*9|0)+-9|0)){w=A+4+(((g+9216|0)/9|0)+-1024<<2)|0;if((((g+9216|0)%9|0)+1|0)<9){y=10;v=((g+9216|0)%9|0)+1|0;while(1){g=y*10|0;v=v+1|0;if((v|0)==9)break;else y=g}}else g=10;S=r[w>>2]|0;x=(S>>>0)%(g>>>0)|0;y=(w+4|0)==(m|0);do{if(y&(x|0)==0)g=w;else{b=(((S>>>0)/(g>>>0)|0)&1|0)==0?9007199254740992.0:9007199254740994.0;v=(g|0)/2|0;if(x>>>0<v>>>0)f=.5;else f=y&(x|0)==(v|0)?1.0:1.5;do{if(E){if((n[M>>0]|0)!=45)break;b=-b;f=-f}}while(0);r[w>>2]=S-x;if(!(b+f!=b)){g=w;break}T=S-x+g|0;r[w>>2]=T;if(T>>>0>999999999){p=w;while(1){g=p+-4|0;r[p>>2]=0;if(g>>>0<u>>>0){u=u+-4|0;r[u>>2]=0}T=(r[g>>2]|0)+1|0;r[g>>2]=T;if(T>>>0>999999999)p=g;else break}}else g=w;p=(A-u>>2)*9|0;v=r[u>>2]|0;if(v>>>0<10)break;else y=10;do{y=y*10|0;p=p+1|0}while(v>>>0>=y>>>0)}}while(0);C=g+4|0;T=u;u=m>>>0>C>>>0?C:m}else{T=u;u=m}v=0-p|0;C=u;while(1){if(C>>>0<=T>>>0){x=0;break}u=C+-4|0;if(!(r[u>>2]|0))C=u;else{x=1;break}}do{if((R|32|0)==103){if((((e|0)!=0^1)+e|0)>(p|0)&(p|0)>-5){y=R+-1|0;e=((e|0)!=0^1)+e+-1-p|0}else{y=R+-2|0;e=((e|0)!=0^1)+e+-1|0}if(I&8|0){g=I&8;break}do{if(x){u=r[C+-4>>2]|0;if(!u){m=9;break}if(!((u>>>0)%10|0)){g=10;m=0}else{m=0;break}do{g=g*10|0;m=m+1|0}while(!((u>>>0)%(g>>>0)|0|0))}else m=9}while(0);u=((C-A>>2)*9|0)+-9|0;if((y|32|0)==102){g=u-m|0;g=(g|0)<0?0:g;e=(e|0)<(g|0)?e:g;g=0;break}else{g=u+p-m|0;g=(g|0)<0?0:g;e=(e|0)<(g|0)?e:g;g=0;break}}else{y=R;g=I&8}}while(0);S=e|g;m=(y|32|0)==102;if(m){u=(p|0)>0?p:0;v=0}else{u=(p|0)<0?v:p;u=jl(u,((u|0)<0)<<31>>31,V+576+12|0)|0;if((U-u|0)<2)do{u=u+-1|0;n[u>>0]=48}while((U-u|0)<2);n[u+-1>>0]=(p>>31&2)+43;v=u+-2|0;n[v>>0]=y;u=U-v|0}w=E+1+e+((S|0)!=0&1)+u|0;Hl(t,32,D,w,I);if(!(r[t>>2]&32))zl(M,E,t);Hl(t,48,D,w,I^65536);do{if(m){m=T>>>0>A>>>0?A:T;p=m;do{u=jl(r[p>>2]|0,0,B)|0;do{if((p|0)==(m|0)){if((u|0)!=(B|0))break;n[V+588+8>>0]=48;u=V+588+8|0}else{if(u>>>0<=(V+588|0)>>>0)break;Ph(V+588|0,48,u-N|0)|0;do{u=u+-1|0}while(u>>>0>(V+588|0)>>>0)}}while(0);if(!(r[t>>2]&32))zl(u,B-u|0,t);p=p+4|0}while(p>>>0<=A>>>0);do{if(S|0){if(r[t>>2]&32|0)break;zl(19235,1,t)}}while(0);if((e|0)>0&p>>>0<C>>>0)while(1){u=jl(r[p>>2]|0,0,B)|0;if(u>>>0>(V+588|0)>>>0){Ph(V+588|0,48,u-N|0)|0;do{u=u+-1|0}while(u>>>0>(V+588|0)>>>0)}if(!(r[t>>2]&32))zl(u,(e|0)>9?9:e,t);p=p+4|0;u=e+-9|0;if(!((e|0)>9&p>>>0<C>>>0)){e=u;break}else e=u}Hl(t,48,e+9|0,9,0)}else{y=x?C:T+4|0;if((e|0)>-1){g=(g|0)==0;m=T;do{u=jl(r[m>>2]|0,0,B)|0;if((u|0)==(B|0)){n[V+588+8>>0]=48;u=V+588+8|0}do{if((m|0)==(T|0)){p=u+1|0;if(!(r[t>>2]&32))zl(u,1,t);if(g&(e|0)<1){u=p;break}if(r[t>>2]&32|0){u=p;break}zl(19235,1,t);u=p}else{if(u>>>0<=(V+588|0)>>>0)break;Ph(V+588|0,48,u+(0-N)|0)|0;do{u=u+-1|0}while(u>>>0>(V+588|0)>>>0)}}while(0);p=B-u|0;if(!(r[t>>2]&32))zl(u,(e|0)>(p|0)?p:e,t);e=e-p|0;m=m+4|0}while(m>>>0<y>>>0&(e|0)>-1)}Hl(t,48,e+18|0,18,0);if(r[t>>2]&32|0)break;zl(v,U-v|0,t)}}while(0);Hl(t,32,D,w,I^8192);e=(w|0)<(D|0)?D:w}else{m=f!=f|0.0!=0.0;u=m?0:E;Hl(t,32,D,u+3|0,p);e=r[t>>2]|0;if(!(e&32)){zl(M,u,t);e=r[t>>2]|0}if(!(e&32))zl(m?R&32|0?19227:19231:R&32|0?19219:19223,3,t);Hl(t,32,D,u+3|0,I^8192);e=(u+3|0)<(D|0)?D:u+3|0}}while(0);u=e;g=k;x=L;continue t}default:{e=x;p=I;v=g;x=0;S=17291;u=F}}}while(0);e:do{if((O|0)==66){u=r[V>>2]|0;p=r[V+4>>2]|0;m=v&32;if(!((u|0)==0&(p|0)==0)){e=F;do{e=e+-1|0;n[e>>0]=o[17275+(u&15)>>0]|m;u=kh(u|0,p|0,4)|0;p=P}while(!((u|0)==0&(p|0)==0));if((y&8|0)==0|(r[V>>2]|0)==0&(r[V+4>>2]|0)==0){u=y;y=0;m=17291;O=79}else{u=y;y=2;m=17291+(v>>4)|0;O=79}}else{e=F;u=y;y=0;m=17291;O=79}}else if((O|0)==78){e=jl(e,u,F)|0;u=I;y=p;O=79}else if((O|0)==92){O=0;I=Ul(u,0,g)|0;e=u;v=(I|0)==0?g:I-u|0;x=0;S=17291;u=(I|0)==0?u+g|0:I}else if((O|0)==96){O=0;p=0;u=0;y=e;while(1){m=r[y>>2]|0;if(!m)break;u=Xl(V+528|0,m)|0;if((u|0)<0|u>>>0>(g-p|0)>>>0)break;p=u+p|0;if(g>>>0>p>>>0)y=y+4|0;else break}if((u|0)<0){h=-1;break t}Hl(t,32,D,p,I);if(!p){e=0;O=107}else{m=0;while(1){u=r[e>>2]|0;if(!u){e=p;O=107;break e}u=Xl(V+528|0,u)|0;m=u+m|0;if((m|0)>(p|0)){e=p;O=107;break e}if(!(r[t>>2]&32))zl(V+528|0,u,t);if(m>>>0>=p>>>0){e=p;O=107;break}else e=e+4|0}}}}while(0);if((O|0)==107){O=0;Hl(t,32,D,e,I^8192);u=(D|0)>(e|0)?D:e;g=k;x=L;continue}if((O|0)==79){O=0;p=(g|0)>-1?u&-65537:u;u=(r[V>>2]|0)!=0|(r[V+4>>2]|0)!=0;if((g|0)!=0|u){v=(u&1^1)+(F-e)|0;v=(g|0)>(v|0)?g:v;x=y;S=m;u=F}else{e=F;v=0;x=y;S=m;u=F}}y=u-e|0;m=(v|0)<(y|0)?y:v;g=x+m|0;u=(D|0)<(g|0)?g:D;Hl(t,32,u,g,p);if(!(r[t>>2]&32))zl(S,x,t);Hl(t,48,u,g,p^65536);Hl(t,48,m,y,0);if(!(r[t>>2]&32))zl(e,y,t);Hl(t,32,u,g,p^8192);g=k;x=L}t:do{if((O|0)==254)if(!t)if(!g)h=0;else{h=1;while(1){e=r[l+(h<<2)>>2]|0;if(!e){e=0;break}Gl(a+(h<<3)|0,e,i);h=h+1|0;if((h|0)>=10){h=1;break t}}while(1){h=h+1|0;if(e|0){h=-1;break t}if((h|0)>=10){h=1;break t}e=r[l+(h<<2)>>2]|0}}}while(0);_=V;return h|0}function zl(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0;s=r[i+16>>2]|0;if(!s){if(!(Wl(i)|0)){o=r[i+16>>2]|0;a=5}}else{o=s;a=5}t:do{if((a|0)==5){s=r[i+20>>2]|0;if((o-s|0)>>>0<e>>>0){yk[r[i+36>>2]&63](i,t,e)|0;break}e:do{if((n[i+75>>0]|0)>-1){a=e;while(1){if(!a){o=e;break e}o=a+-1|0;if((n[t+o>>0]|0)==10)break;else a=o}if((yk[r[i+36>>2]&63](i,t,a)|0)>>>0<a>>>0)break t;o=e-a|0;t=t+a|0;s=r[i+20>>2]|0}else o=e}while(0);Oh(s|0,t|0,o|0)|0;r[i+20>>2]=(r[i+20>>2]|0)+o}}while(0);return}function Wl(t){t=t|0;var e=0;e=n[t+74>>0]|0;n[t+74>>0]=e+255|e;e=r[t>>2]|0;if(!(e&8)){r[t+8>>2]=0;r[t+4>>2]=0;e=r[t+44>>2]|0;r[t+28>>2]=e;r[t+20>>2]=e;r[t+16>>2]=e+(r[t+48>>2]|0);e=0}else{r[t>>2]=e|32;e=-1}return e|0}function Gl(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0.0;t:do{if(e>>>0<=20)do{switch(e|0){case 9:{n=(r[i>>2]|0)+(4-1)&~(4-1);e=r[n>>2]|0;r[i>>2]=n+4;r[t>>2]=e;break t}case 10:{e=(r[i>>2]|0)+(4-1)&~(4-1);n=r[e>>2]|0;r[i>>2]=e+4;r[t>>2]=n;r[t+4>>2]=((n|0)<0)<<31>>31;break t}case 11:{e=(r[i>>2]|0)+(4-1)&~(4-1);n=r[e>>2]|0;r[i>>2]=e+4;r[t>>2]=n;r[t+4>>2]=0;break t}case 12:{s=(r[i>>2]|0)+(8-1)&~(8-1);e=r[s>>2]|0;n=r[s+4>>2]|0;r[i>>2]=s+8;r[t>>2]=e;r[t+4>>2]=n;break t}case 13:{n=(r[i>>2]|0)+(4-1)&~(4-1);s=r[n>>2]|0;r[i>>2]=n+4;r[t>>2]=(s&65535)<<16>>16;r[t+4>>2]=(((s&65535)<<16>>16|0)<0)<<31>>31;break t}case 14:{n=(r[i>>2]|0)+(4-1)&~(4-1);s=r[n>>2]|0;r[i>>2]=n+4;r[t>>2]=s&65535;r[t+4>>2]=0;break t}case 15:{n=(r[i>>2]|0)+(4-1)&~(4-1);s=r[n>>2]|0;r[i>>2]=n+4;r[t>>2]=(s&255)<<24>>24;r[t+4>>2]=(((s&255)<<24>>24|0)<0)<<31>>31;break t}case 16:{n=(r[i>>2]|0)+(4-1)&~(4-1);s=r[n>>2]|0;r[i>>2]=n+4;r[t>>2]=s&255;r[t+4>>2]=0;break t}case 17:{s=(r[i>>2]|0)+(8-1)&~(8-1);o=+c[s>>3];r[i>>2]=s+8;c[t>>3]=o;break t}case 18:{s=(r[i>>2]|0)+(8-1)&~(8-1);o=+c[s>>3];r[i>>2]=s+8;c[t>>3]=o;break t}default:break t}}while(0)}while(0);return}function jl(t,e,i){t=t|0;e=e|0;i=i|0;var s=0;if(e>>>0>0|(e|0)==0&t>>>0>4294967295)while(1){s=Hh(t|0,e|0,10,0)|0;i=i+-1|0;n[i>>0]=s|48;s=t;t=jh(t|0,e|0,10,0)|0;if(!(e>>>0>9|(e|0)==9&s>>>0>4294967295))break;else e=P}if(t)while(1){i=i+-1|0;n[i>>0]=(t>>>0)%10|0|48;if(t>>>0<10)break;else t=(t>>>0)/10|0}return i|0}function Hl(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var o=0,a=0;a=_;_=_+256|0;do{if((i|0)>(n|0)&(s&73728|0)==0){Ph(a|0,e|0,((i-n|0)>>>0>256?256:i-n|0)|0)|0;s=r[t>>2]|0;if((i-n|0)>>>0>255){o=i-n|0;e=s;s=(s&32|0)==0;do{if(s){zl(a,256,t);e=r[t>>2]|0}o=o+-256|0;s=(e&32|0)==0}while(o>>>0>255);if(s)e=i-n&255;else break}else if(!(s&32))e=i-n|0;else break;zl(a,e,t)}}while(0);_=a;return}function Xl(t,e){t=t|0;e=e|0;do{if(!t)t=0;else{if(e>>>0<128){n[t>>0]=e;t=1;break}if(e>>>0<2048){n[t>>0]=e>>>6|192;n[t+1>>0]=e&63|128;t=2;break}if(e>>>0<55296|(e&-8192|0)==57344){n[t>>0]=e>>>12|224;n[t+1>>0]=e>>>6&63|128;n[t+2>>0]=e&63|128;t=3;break}if((e+-65536|0)>>>0<1048576){n[t>>0]=e>>>18|240;n[t+1>>0]=e>>>12&63|128;n[t+2>>0]=e>>>6&63|128;n[t+3>>0]=e&63|128;t=4;break}if(!0)t=22816;else t=r[(Nh()|0)+64>>2]|0;r[t>>2]=84;t=-1}}while(0);return t|0}function Yl(t,e){t=+t;e=e|0;var i=0,n=0,s=0;c[d>>3]=t;i=r[d>>2]|0;n=r[d+4>>2]|0;s=kh(i|0,n|0,52)|0;switch(s&2047|0){case 0:{if(t!=0.0){t=+Yl(t*18446744073709551616.0,e);i=(r[e>>2]|0)+-64|0}else i=0;r[e>>2]=i;break}case 2047:break;default:{r[e>>2]=(s&2047)+-1022;r[d>>2]=i;r[d+4>>2]=n&-2146435073|1071644672;t=+c[d>>3]}}return+t}function ql(t){t=+t;var e=0,i=0,n=0,s=0,o=0,a=0;a=(h[d>>2]=t,r[d>>2]|0);t:do{if((a>>>23&255|0)==255)t=t*6.2831854820251465/(t*6.2831854820251465);else{if(a<<1>>>0<=2173837238)return+((a<<1|0)==-2121130058?t*0.0:t);if(!(a>>>23&255)){if((a<<9|0)>-1){e=0;i=a<<9;do{e=e+-1|0;i=i<<1}while((i|0)>-1);i=e}else i=0;e=i;n=a<<1-i}else{e=a>>>23&255;n=a&8388607|8388608}s=n+-13176795|0;e:do{if((e|0)>129){o=(s|0)>-1;i=s;while(1){if(o){if((n|0)==13176795)break}else i=n;n=i<<1;e=e+-1|0;if((e|0)>129){o=(n+-13176795|0)>-1;i=n+-13176795|0}else{i=n+-13176795|0;s=(n+-13176795|0)>-1;break e}}t=t*0.0;break t}else{i=s;s=(s|0)>-1}}while(0);if(s){if((n|0)==13176795){t=t*0.0;break}}else i=n;if(i>>>0<8388608)do{i=i<<1;e=e+-1|0}while(i>>>0<8388608);if((e|0)>0)e=i+-8388608|e<<23;else e=i>>>(1-e|0);t=(r[d>>2]=e|a&-2147483648,+h[d>>2])}}while(0);return+t}function Kl(t,e){t=t|0;e=e|0;var i=0,s=0,a=0;a=_;_=_+16|0;n[a>>0]=e;i=r[t+16>>2]|0;if(!i)if(!(Wl(t)|0)){i=r[t+16>>2]|0;s=4}else i=-1;else s=4;do{if((s|0)==4){s=r[t+20>>2]|0;if(s>>>0<i>>>0?(e&255|0)!=(n[t+75>>0]|0):0){r[t+20>>2]=s+1;n[s>>0]=e;i=e&255;break}if((yk[r[t+36>>2]&63](t,a,1)|0)==1)i=o[a>>0]|0;else i=-1}}while(0);_=a;return i|0}function Zl(t){t=t|0;var e=0,i=0,n=0,s=0,o=0,a=0,l=0,h=0,c=0,u=0,d=0,p=0,f=0,m=0,g=0,b=0,y=0,v=0,S=0,x=0,w=0,C=0,T=0,A=0,E=0,M=0,R=0,I=0,P=0;P=_;_=_+16|0;do{if(t>>>0<245){p=t>>>0<11?16:t+11&-8;o=r[5705]|0;if(o>>>(p>>>3)&3|0){t=22860+((o>>>(p>>>3)&1^1)+(p>>>3)<<1<<2)|0;e=r[t+8>>2]|0;i=r[e+8>>2]|0;do{if((t|0)!=(i|0)){if(i>>>0<(r[5709]|0)>>>0)qt();if((r[i+12>>2]|0)==(e|0)){r[i+12>>2]=t;r[t+8>>2]=i;break}else qt()}else r[5705]=o&~(1<<(o>>>(p>>>3)&1^1)+(p>>>3))}while(0);I=(o>>>(p>>>3)&1^1)+(p>>>3)<<3;r[e+4>>2]=I|3;r[e+I+4>>2]=r[e+I+4>>2]|1;I=e+8|0;_=P;return I|0}e=r[5707]|0;if(p>>>0>e>>>0){if(o>>>(p>>>3)|0){t=o>>>(p>>>3)<<(p>>>3)&(2<<(p>>>3)|0-(2<<(p>>>3)));s=((t&0-t)+-1|0)>>>(((t&0-t)+-1|0)>>>12&16);n=s>>>(s>>>5&8)>>>(s>>>(s>>>5&8)>>>2&4);n=(s>>>5&8|((t&0-t)+-1|0)>>>12&16|s>>>(s>>>5&8)>>>2&4|n>>>1&2|n>>>(n>>>1&2)>>>1&1)+(n>>>(n>>>1&2)>>>(n>>>(n>>>1&2)>>>1&1))|0;s=r[22860+(n<<1<<2)+8>>2]|0;t=r[s+8>>2]|0;do{if((22860+(n<<1<<2)|0)!=(t|0)){if(t>>>0<(r[5709]|0)>>>0)qt();if((r[t+12>>2]|0)==(s|0)){r[t+12>>2]=22860+(n<<1<<2);r[22860+(n<<1<<2)+8>>2]=t;a=r[5707]|0;break}else qt()}else{r[5705]=o&~(1<<n);a=e}}while(0);r[s+4>>2]=p|3;r[s+p+4>>2]=(n<<3)-p|1;r[s+p+((n<<3)-p)>>2]=(n<<3)-p;if(a|0){i=r[5710]|0;e=a>>>3;t=r[5705]|0;if(t&1<<e){t=r[22860+(e<<1<<2)+8>>2]|0;if(t>>>0<(r[5709]|0)>>>0)qt();else{l=22860+(e<<1<<2)+8|0;h=t}}else{r[5705]=t|1<<e;l=22860+(e<<1<<2)+8|0;h=22860+(e<<1<<2)|0}r[l>>2]=i;r[h+12>>2]=i;r[i+8>>2]=h;r[i+12>>2]=22860+(e<<1<<2)}r[5707]=(n<<3)-p;r[5710]=s+p;I=s+8|0;_=P;return I|0}t=r[5706]|0;if(t){l=((t&0-t)+-1|0)>>>(((t&0-t)+-1|0)>>>12&16);h=l>>>(l>>>5&8)>>>(l>>>(l>>>5&8)>>>2&4);h=r[23124+((l>>>5&8|((t&0-t)+-1|0)>>>12&16|l>>>(l>>>5&8)>>>2&4|h>>>1&2|h>>>(h>>>1&2)>>>1&1)+(h>>>(h>>>1&2)>>>(h>>>(h>>>1&2)>>>1&1))<<2)>>2]|0;l=(r[h+4>>2]&-8)-p|0;e=h;while(1){t=r[e+16>>2]|0;if(!t){t=r[e+20>>2]|0;if(!t)break}e=(r[t+4>>2]&-8)-p|0;I=e>>>0<l>>>0;l=I?e:l;e=t;h=I?t:h}s=r[5709]|0;if(h>>>0<s>>>0)qt();a=h+p|0;if(h>>>0>=a>>>0)qt();o=r[h+24>>2]|0;t=r[h+12>>2]|0;do{if((t|0)==(h|0)){e=h+20|0;t=r[e>>2]|0;if(!t){e=h+16|0;t=r[e>>2]|0;if(!t){c=0;break}}while(1){i=t+20|0;n=r[i>>2]|0;if(n|0){t=n;e=i;continue}i=t+16|0;n=r[i>>2]|0;if(!n)break;else{t=n;e=i}}if(e>>>0<s>>>0)qt();else{r[e>>2]=0;c=t;break}}else{e=r[h+8>>2]|0;if(e>>>0<s>>>0)qt();if((r[e+12>>2]|0)!=(h|0))qt();if((r[t+8>>2]|0)==(h|0)){r[e+12>>2]=t;r[t+8>>2]=e;c=t;break}else qt()}}while(0);do{if(o|0){t=r[h+28>>2]|0;if((h|0)==(r[23124+(t<<2)>>2]|0)){r[23124+(t<<2)>>2]=c;if(!c){r[5706]=r[5706]&~(1<<t);break}}else{if(o>>>0<(r[5709]|0)>>>0)qt();if((r[o+16>>2]|0)==(h|0))r[o+16>>2]=c;else r[o+20>>2]=c;if(!c)break}e=r[5709]|0;if(c>>>0<e>>>0)qt();r[c+24>>2]=o;t=r[h+16>>2]|0;do{if(t|0)if(t>>>0<e>>>0)qt();else{r[c+16>>2]=t;r[t+24>>2]=c;break}}while(0);t=r[h+20>>2]|0;if(t|0)if(t>>>0<(r[5709]|0)>>>0)qt();else{r[c+20>>2]=t;r[t+24>>2]=c;break}}}while(0);if(l>>>0<16){I=l+p|0;r[h+4>>2]=I|3;I=h+I+4|0;r[I>>2]=r[I>>2]|1}else{r[h+4>>2]=p|3;r[a+4>>2]=l|1;r[a+l>>2]=l;e=r[5707]|0;if(e|0){i=r[5710]|0;t=r[5705]|0;if(t&1<<(e>>>3)){t=r[22860+(e>>>3<<1<<2)+8>>2]|0;if(t>>>0<(r[5709]|0)>>>0)qt();else{u=22860+(e>>>3<<1<<2)+8|0;d=t}}else{r[5705]=t|1<<(e>>>3);u=22860+(e>>>3<<1<<2)+8|0;d=22860+(e>>>3<<1<<2)|0}r[u>>2]=i;r[d+12>>2]=i;r[i+8>>2]=d;r[i+12>>2]=22860+(e>>>3<<1<<2)}r[5707]=l;r[5710]=a}I=h+8|0;_=P;return I|0}}}else if(t>>>0<=4294967231){p=t+11&-8;l=r[5706]|0;if(l){if((t+11|0)>>>8)if(p>>>0>16777215)a=31;else{a=(t+11|0)>>>8<<((((t+11|0)>>>8)+1048320|0)>>>16&8);a=14-((a+520192|0)>>>16&4|(((t+11|0)>>>8)+1048320|0)>>>16&8|((a<<((a+520192|0)>>>16&4))+245760|0)>>>16&2)+(a<<((a+520192|0)>>>16&4)<<(((a<<((a+520192|0)>>>16&4))+245760|0)>>>16&2)>>>15)|0;a=p>>>(a+7|0)&1|a<<1}else a=0;e=r[23124+(a<<2)>>2]|0;t:do{if(!e){i=0-p|0;t=0;e=0;w=86}else{i=0-p|0;t=0;s=p<<((a|0)==31?0:25-(a>>>1)|0);o=e;e=0;while(1){n=r[o+4>>2]&-8;if((n-p|0)>>>0<i>>>0)if((n|0)==(p|0)){i=n-p|0;t=o;e=o;w=90;break t}else{i=n-p|0;e=o}n=r[o+20>>2]|0;o=r[o+16+(s>>>31<<2)>>2]|0;t=(n|0)==0|(n|0)==(o|0)?t:n;n=(o|0)==0;if(n){w=86;break}else s=s<<(n&1^1)}}}while(0);if((w|0)==86){if((t|0)==0&(e|0)==0){t=2<<a;if(!(l&(t|0-t)))break;u=(l&(t|0-t)&0-(l&(t|0-t)))+-1|0;d=u>>>(u>>>12&16)>>>(u>>>(u>>>12&16)>>>5&8);t=d>>>(d>>>2&4)>>>(d>>>(d>>>2&4)>>>1&2);t=r[23124+((u>>>(u>>>12&16)>>>5&8|u>>>12&16|d>>>2&4|d>>>(d>>>2&4)>>>1&2|t>>>1&1)+(t>>>(t>>>1&1))<<2)>>2]|0}if(!t){l=i;h=e}else w=90}if((w|0)==90)while(1){w=0;d=(r[t+4>>2]&-8)-p|0;n=d>>>0<i>>>0;i=n?d:i;e=n?t:e;n=r[t+16>>2]|0;if(n|0){t=n;w=90;continue}t=r[t+20>>2]|0;if(!t){l=i;h=e;break}else w=90}if((h|0)!=0?l>>>0<((r[5707]|0)-p|0)>>>0:0){s=r[5709]|0;if(h>>>0<s>>>0)qt();a=h+p|0;if(h>>>0>=a>>>0)qt();o=r[h+24>>2]|0;t=r[h+12>>2]|0;do{if((t|0)==(h|0)){e=h+20|0;t=r[e>>2]|0;if(!t){e=h+16|0;t=r[e>>2]|0;if(!t){m=0;break}}while(1){i=t+20|0;n=r[i>>2]|0;if(n|0){t=n;e=i;continue}i=t+16|0;n=r[i>>2]|0;if(!n)break;else{t=n;e=i}}if(e>>>0<s>>>0)qt();else{r[e>>2]=0;m=t;break}}else{e=r[h+8>>2]|0;if(e>>>0<s>>>0)qt();if((r[e+12>>2]|0)!=(h|0))qt();if((r[t+8>>2]|0)==(h|0)){r[e+12>>2]=t;r[t+8>>2]=e;m=t;break}else qt()}}while(0);do{if(o|0){t=r[h+28>>2]|0;if((h|0)==(r[23124+(t<<2)>>2]|0)){r[23124+(t<<2)>>2]=m;if(!m){r[5706]=r[5706]&~(1<<t);break}}else{if(o>>>0<(r[5709]|0)>>>0)qt();if((r[o+16>>2]|0)==(h|0))r[o+16>>2]=m;else r[o+20>>2]=m;if(!m)break}e=r[5709]|0;if(m>>>0<e>>>0)qt();r[m+24>>2]=o;t=r[h+16>>2]|0;do{if(t|0)if(t>>>0<e>>>0)qt();else{r[m+16>>2]=t;r[t+24>>2]=m;break}}while(0);t=r[h+20>>2]|0;if(t|0)if(t>>>0<(r[5709]|0)>>>0)qt();else{r[m+20>>2]=t;r[t+24>>2]=m;break}}}while(0);do{if(l>>>0>=16){r[h+4>>2]=p|3;r[a+4>>2]=l|1;r[a+l>>2]=l;e=l>>>3;if(l>>>0<256){t=r[5705]|0;if(t&1<<e){t=r[22860+(e<<1<<2)+8>>2]|0;if(t>>>0<(r[5709]|0)>>>0)qt();else{g=22860+(e<<1<<2)+8|0;b=t}}else{r[5705]=t|1<<e;g=22860+(e<<1<<2)+8|0;b=22860+(e<<1<<2)|0}r[g>>2]=a;r[b+12>>2]=a;r[a+8>>2]=b;r[a+12>>2]=22860+(e<<1<<2);break}t=l>>>8;if(t)if(l>>>0>16777215)i=31;else{i=t<<((t+1048320|0)>>>16&8)<<(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4);i=14-(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4|(t+1048320|0)>>>16&8|(i+245760|0)>>>16&2)+(i<<((i+245760|0)>>>16&2)>>>15)|0;i=l>>>(i+7|0)&1|i<<1}else i=0;n=23124+(i<<2)|0;r[a+28>>2]=i;r[a+16+4>>2]=0;r[a+16>>2]=0;t=r[5706]|0;e=1<<i;if(!(t&e)){r[5706]=t|e;r[n>>2]=a;r[a+24>>2]=n;r[a+12>>2]=a;r[a+8>>2]=a;break}i=l<<((i|0)==31?0:25-(i>>>1)|0);n=r[n>>2]|0;while(1){if((r[n+4>>2]&-8|0)==(l|0)){w=148;break}e=n+16+(i>>>31<<2)|0;t=r[e>>2]|0;if(!t){w=145;break}else{i=i<<1;n=t}}if((w|0)==145)if(e>>>0<(r[5709]|0)>>>0)qt();else{r[e>>2]=a;r[a+24>>2]=n;r[a+12>>2]=a;r[a+8>>2]=a;break}else if((w|0)==148){t=n+8|0;e=r[t>>2]|0;I=r[5709]|0;if(e>>>0>=I>>>0&n>>>0>=I>>>0){r[e+12>>2]=a;r[t>>2]=a;r[a+8>>2]=e;r[a+12>>2]=n;r[a+24>>2]=0;break}else qt()}}else{I=l+p|0;r[h+4>>2]=I|3;I=h+I+4|0;r[I>>2]=r[I>>2]|1}}while(0);I=h+8|0;_=P;return I|0}}}else p=-1}while(0);i=r[5707]|0;if(i>>>0>=p>>>0){t=i-p|0;e=r[5710]|0;if(t>>>0>15){I=e+p|0;r[5710]=I;r[5707]=t;r[I+4>>2]=t|1;r[I+t>>2]=t;r[e+4>>2]=p|3}else{r[5707]=0;r[5710]=0;r[e+4>>2]=i|3;r[e+i+4>>2]=r[e+i+4>>2]|1}I=e+8|0;_=P;return I|0}t=r[5708]|0;if(t>>>0>p>>>0){M=t-p|0;r[5708]=M;I=r[5711]|0;R=I+p|0;r[5711]=R;r[R+4>>2]=M|1;r[I+4>>2]=p|3;I=I+8|0;_=P;return I|0}if(!(r[5823]|0)){r[5825]=4096;r[5824]=4096;r[5826]=-1;r[5827]=-1;r[5828]=0;r[5816]=0;r[P>>2]=P&-16^1431655768;r[5823]=P&-16^1431655768}s=p+48|0;i=r[5825]|0;o=p+47|0;a=i+o&0-i;if(a>>>0<=p>>>0){I=0;_=P;return I|0}t=r[5815]|0;if(t|0?(b=r[5813]|0,(b+a|0)>>>0<=b>>>0|(b+a|0)>>>0>t>>>0):0){I=0;_=P;return I|0}t:do{if(!(r[5816]&4)){e=r[5711]|0;e:do{if(e){n=23268;while(1){t=r[n>>2]|0;if(t>>>0<=e>>>0?(f=n+4|0,(t+(r[f>>2]|0)|0)>>>0>e>>>0):0)break;t=r[n+8>>2]|0;if(!t){w=171;break e}else n=t}t=i+o-(r[5708]|0)&0-i;if(t>>>0<2147483647){e=$t(t|0)|0;if((e|0)==((r[n>>2]|0)+(r[f>>2]|0)|0)){if((e|0)!=(-1|0)){a=e;o=t;w=191;break t}}else w=181}}else w=171}while(0);do{if((w|0)==171?(y=$t(0)|0,(y|0)!=(-1|0)):0){t=r[5824]|0;if(!(t+-1&y))t=a;else t=a-y+(t+-1+y&0-t)|0;e=r[5813]|0;i=e+t|0;if(t>>>0>p>>>0&t>>>0<2147483647){b=r[5815]|0;if(b|0?i>>>0<=e>>>0|i>>>0>b>>>0:0)break;e=$t(t|0)|0;if((e|0)==(y|0)){a=y;o=t;w=191;break t}else w=181}}}while(0);e:do{if((w|0)==181){i=0-t|0;do{if(s>>>0>t>>>0&(t>>>0<2147483647&(e|0)!=(-1|0))?(v=r[5825]|0,v=o-t+v&0-v,v>>>0<2147483647):0)if(($t(v|0)|0)==(-1|0)){$t(i|0)|0;break e}else{t=v+t|0;break}}while(0);if((e|0)!=(-1|0)){a=e;o=t;w=191;break t}}}while(0);r[5816]=r[5816]|4;w=188}else w=188}while(0);if((((w|0)==188?a>>>0<2147483647:0)?(S=$t(a|0)|0,x=$t(0)|0,S>>>0<x>>>0&((S|0)!=(-1|0)&(x|0)!=(-1|0))):0)?(x-S|0)>>>0>(p+40|0)>>>0:0){a=S;o=x-S|0;w=191}if((w|0)==191){t=(r[5813]|0)+o|0;r[5813]=t;if(t>>>0>(r[5814]|0)>>>0)r[5814]=t;c=r[5711]|0;do{if(c){s=23268;while(1){t=r[s>>2]|0;e=s+4|0;i=r[e>>2]|0;if((a|0)==(t+i|0)){w=201;break}n=r[s+8>>2]|0;if(!n)break;else s=n}if(((w|0)==201?(r[s+12>>2]&8|0)==0:0)?c>>>0<a>>>0&c>>>0>=t>>>0:0){r[e>>2]=i+o;R=(c+8&7|0)==0?0:0-(c+8)&7;I=o-R+(r[5708]|0)|0;r[5711]=c+R;r[5708]=I;r[c+R+4>>2]=I|1;r[c+R+I+4>>2]=40;r[5712]=r[5827];break}t=r[5709]|0;if(a>>>0<t>>>0){r[5709]=a;h=a}else h=t;e=a+o|0;t=23268;while(1){if((r[t>>2]|0)==(e|0)){w=209;break}t=r[t+8>>2]|0;if(!t){e=23268;break}}if((w|0)==209)if(!(r[t+12>>2]&8)){r[t>>2]=a;d=t+4|0;r[d>>2]=(r[d>>2]|0)+o;d=a+8|0;d=a+((d&7|0)==0?0:0-d&7)|0;t=e+((e+8&7|0)==0?0:0-(e+8)&7)|0;u=d+p|0;l=t-d-p|0;r[d+4>>2]=p|3;do{if((t|0)!=(c|0)){if((t|0)==(r[5710]|0)){I=(r[5707]|0)+l|0;r[5707]=I;r[5710]=u;r[u+4>>2]=I|1;r[u+I>>2]=I;break}a=r[t+4>>2]|0;if((a&3|0)==1){t:do{if(a>>>0>=256){o=r[t+24>>2]|0;e=r[t+12>>2]|0;do{if((e|0)==(t|0)){e=r[t+16+4>>2]|0;if(!e){e=r[t+16>>2]|0;if(!e){M=0;break}else s=t+16|0}else s=t+16+4|0;while(1){i=e+20|0;n=r[i>>2]|0;if(n|0){e=n;s=i;continue}i=e+16|0;n=r[i>>2]|0;if(!n)break;else{e=n;s=i}}if(s>>>0<h>>>0)qt();else{r[s>>2]=0;M=e;break}}else{i=r[t+8>>2]|0;if(i>>>0<h>>>0)qt();if((r[i+12>>2]|0)!=(t|0))qt();if((r[e+8>>2]|0)==(t|0)){r[i+12>>2]=e;r[e+8>>2]=i;M=e;break}else qt()}}while(0);if(!o)break;e=r[t+28>>2]|0;do{if((t|0)!=(r[23124+(e<<2)>>2]|0)){if(o>>>0<(r[5709]|0)>>>0)qt();if((r[o+16>>2]|0)==(t|0))r[o+16>>2]=M;else r[o+20>>2]=M;if(!M)break t}else{r[23124+(e<<2)>>2]=M;if(M|0)break;r[5706]=r[5706]&~(1<<e);break t}}while(0);i=r[5709]|0;if(M>>>0<i>>>0)qt();r[M+24>>2]=o;e=r[t+16>>2]|0;do{if(e|0)if(e>>>0<i>>>0)qt();else{r[M+16>>2]=e;r[e+24>>2]=M;break}}while(0);e=r[t+16+4>>2]|0;if(!e)break;if(e>>>0<(r[5709]|0)>>>0)qt();else{r[M+20>>2]=e;r[e+24>>2]=M;break}}else{e=r[t+8>>2]|0;i=r[t+12>>2]|0;do{if((e|0)!=(22860+(a>>>3<<1<<2)|0)){if(e>>>0<h>>>0)qt();if((r[e+12>>2]|0)==(t|0))break;qt()}}while(0);if((i|0)==(e|0)){r[5705]=r[5705]&~(1<<(a>>>3));break}do{if((i|0)==(22860+(a>>>3<<1<<2)|0))A=i+8|0;else{if(i>>>0<h>>>0)qt();if((r[i+8>>2]|0)==(t|0)){A=i+8|0;break}qt()}}while(0);r[e+12>>2]=i;r[A>>2]=e}}while(0);t=t+(a&-8)|0;s=(a&-8)+l|0}else s=l;e=t+4|0;r[e>>2]=r[e>>2]&-2;r[u+4>>2]=s|1;r[u+s>>2]=s;e=s>>>3;if(s>>>0<256){t=r[5705]|0;do{if(!(t&1<<e)){r[5705]=t|1<<e;R=22860+(e<<1<<2)+8|0;I=22860+(e<<1<<2)|0}else{t=r[22860+(e<<1<<2)+8>>2]|0;if(t>>>0>=(r[5709]|0)>>>0){R=22860+(e<<1<<2)+8|0;I=t;break}qt()}}while(0);r[R>>2]=u;r[I+12>>2]=u;r[u+8>>2]=I;r[u+12>>2]=22860+(e<<1<<2);break}t=s>>>8;do{if(!t)i=0;else{if(s>>>0>16777215){i=31;break}i=t<<((t+1048320|0)>>>16&8)<<(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4);i=14-(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4|(t+1048320|0)>>>16&8|(i+245760|0)>>>16&2)+(i<<((i+245760|0)>>>16&2)>>>15)|0;i=s>>>(i+7|0)&1|i<<1}}while(0);n=23124+(i<<2)|0;r[u+28>>2]=i;r[u+16+4>>2]=0;r[u+16>>2]=0;t=r[5706]|0;e=1<<i;if(!(t&e)){r[5706]=t|e;r[n>>2]=u;r[u+24>>2]=n;r[u+12>>2]=u;r[u+8>>2]=u;break}i=s<<((i|0)==31?0:25-(i>>>1)|0);n=r[n>>2]|0;while(1){if((r[n+4>>2]&-8|0)==(s|0)){w=279;break}e=n+16+(i>>>31<<2)|0;t=r[e>>2]|0;if(!t){w=276;break}else{i=i<<1;n=t}}if((w|0)==276)if(e>>>0<(r[5709]|0)>>>0)qt();else{r[e>>2]=u;r[u+24>>2]=n;r[u+12>>2]=u;r[u+8>>2]=u;break}else if((w|0)==279){t=n+8|0;e=r[t>>2]|0;I=r[5709]|0;if(e>>>0>=I>>>0&n>>>0>=I>>>0){r[e+12>>2]=u;r[t>>2]=u;r[u+8>>2]=e;r[u+12>>2]=n;r[u+24>>2]=0;break}else qt()}}else{I=(r[5708]|0)+l|0;r[5708]=I;r[5711]=u;r[u+4>>2]=I|1}}while(0);I=d+8|0;_=P;return I|0}else e=23268;while(1){t=r[e>>2]|0;if(t>>>0<=c>>>0?(C=t+(r[e+4>>2]|0)|0,C>>>0>c>>>0):0)break;e=r[e+8>>2]|0}s=C+-47+((C+-47+8&7|0)==0?0:0-(C+-47+8)&7)|0;s=s>>>0<(c+16|0)>>>0?c:s;t=a+8|0;t=(t&7|0)==0?0:0-t&7;I=a+t|0;t=o+-40-t|0;r[5711]=I;r[5708]=t;r[I+4>>2]=t|1;r[I+t+4>>2]=40;r[5712]=r[5827];r[s+4>>2]=27;r[s+8>>2]=r[5817];r[s+8+4>>2]=r[5818];r[s+8+8>>2]=r[5819];r[s+8+12>>2]=r[5820];r[5817]=a;r[5818]=o;r[5820]=0;r[5819]=s+8;t=s+24|0;do{t=t+4|0;r[t>>2]=7}while((t+4|0)>>>0<C>>>0);if((s|0)!=(c|0)){r[s+4>>2]=r[s+4>>2]&-2;r[c+4>>2]=s-c|1;r[s>>2]=s-c;if((s-c|0)>>>0<256){e=22860+((s-c|0)>>>3<<1<<2)|0;t=r[5705]|0;if(t&1<<((s-c|0)>>>3)){t=r[e+8>>2]|0;if(t>>>0<(r[5709]|0)>>>0)qt();else{T=e+8|0;E=t}}else{r[5705]=t|1<<((s-c|0)>>>3);T=e+8|0;E=e}r[T>>2]=c;r[E+12>>2]=c;r[c+8>>2]=E;r[c+12>>2]=e;break}if((s-c|0)>>>8)if((s-c|0)>>>0>16777215)i=31;else{i=(s-c|0)>>>8<<((((s-c|0)>>>8)+1048320|0)>>>16&8);i=14-((i+520192|0)>>>16&4|(((s-c|0)>>>8)+1048320|0)>>>16&8|((i<<((i+520192|0)>>>16&4))+245760|0)>>>16&2)+(i<<((i+520192|0)>>>16&4)<<(((i<<((i+520192|0)>>>16&4))+245760|0)>>>16&2)>>>15)|0;i=(s-c|0)>>>(i+7|0)&1|i<<1}else i=0;n=23124+(i<<2)|0;r[c+28>>2]=i;r[c+20>>2]=0;r[c+16>>2]=0;t=r[5706]|0;e=1<<i;if(!(t&e)){r[5706]=t|e;r[n>>2]=c;r[c+24>>2]=n;r[c+12>>2]=c;r[c+8>>2]=c;break}i=s-c<<((i|0)==31?0:25-(i>>>1)|0);n=r[n>>2]|0;while(1){if((r[n+4>>2]&-8|0)==(s-c|0)){w=305;break}e=n+16+(i>>>31<<2)|0;t=r[e>>2]|0;if(!t){w=302;break}else{i=i<<1;n=t}}if((w|0)==302)if(e>>>0<(r[5709]|0)>>>0)qt();else{r[e>>2]=c;r[c+24>>2]=n;r[c+12>>2]=c;r[c+8>>2]=c;break}else if((w|0)==305){t=n+8|0;e=r[t>>2]|0;I=r[5709]|0;if(e>>>0>=I>>>0&n>>>0>=I>>>0){r[e+12>>2]=c;r[t>>2]=c;r[c+8>>2]=e;r[c+12>>2]=n;r[c+24>>2]=0;break}else qt()}}}else{I=r[5709]|0;if((I|0)==0|a>>>0<I>>>0)r[5709]=a;r[5817]=a;r[5818]=o;r[5820]=0;r[5714]=r[5823];r[5713]=-1;t=0;do{I=22860+(t<<1<<2)|0;r[I+12>>2]=I;r[I+8>>2]=I;t=t+1|0}while((t|0)!=32);I=a+8|0;I=(I&7|0)==0?0:0-I&7;R=a+I|0;I=o+-40-I|0;r[5711]=R;r[5708]=I;r[R+4>>2]=I|1;r[R+I+4>>2]=40;r[5712]=r[5827]}}while(0);t=r[5708]|0;if(t>>>0>p>>>0){M=t-p|0;r[5708]=M;I=r[5711]|0;R=I+p|0;r[5711]=R;r[R+4>>2]=M|1;r[I+4>>2]=p|3;I=I+8|0;_=P;return I|0}}if(!0)t=22816;else t=r[(Nh()|0)+64>>2]|0;r[t>>2]=12;I=0;_=P;return I|0}function Ql(t){t=t|0;var e=0,i=0,n=0,s=0,o=0,a=0,l=0,h=0,c=0,_=0,u=0,d=0,p=0,f=0,m=0;if(!t)return;a=r[5709]|0;if((t+-8|0)>>>0<a>>>0)qt();e=r[t+-4>>2]|0;if((e&3|0)==1)qt();d=t+-8+(e&-8)|0;do{if(!(e&1)){n=r[t+-8>>2]|0;if(!(e&3))return;c=t+-8+(0-n)|0;h=n+(e&-8)|0;if(c>>>0<a>>>0)qt();if((c|0)==(r[5710]|0)){t=r[d+4>>2]|0;if((t&3|0)!=3){m=c;s=h;break}r[5707]=h;r[d+4>>2]=t&-2;r[c+4>>2]=h|1;r[c+h>>2]=h;return}if(n>>>0<256){t=r[c+8>>2]|0;e=r[c+12>>2]|0;if((t|0)!=(22860+(n>>>3<<1<<2)|0)){if(t>>>0<a>>>0)qt();if((r[t+12>>2]|0)!=(c|0))qt()}if((e|0)==(t|0)){r[5705]=r[5705]&~(1<<(n>>>3));m=c;s=h;break}if((e|0)!=(22860+(n>>>3<<1<<2)|0)){if(e>>>0<a>>>0)qt();if((r[e+8>>2]|0)!=(c|0))qt();else i=e+8|0}else i=e+8|0;r[t+12>>2]=e;r[i>>2]=t;m=c;s=h;break}o=r[c+24>>2]|0;t=r[c+12>>2]|0;do{if((t|0)==(c|0)){t=r[c+16+4>>2]|0;if(!t){t=r[c+16>>2]|0;if(!t){l=0;break}else n=c+16|0}else n=c+16+4|0;while(1){e=t+20|0;i=r[e>>2]|0;if(i|0){t=i;n=e;continue}e=t+16|0;i=r[e>>2]|0;if(!i)break;else{t=i;n=e}}if(n>>>0<a>>>0)qt();else{r[n>>2]=0;l=t;break}}else{e=r[c+8>>2]|0;if(e>>>0<a>>>0)qt();if((r[e+12>>2]|0)!=(c|0))qt();if((r[t+8>>2]|0)==(c|0)){r[e+12>>2]=t;r[t+8>>2]=e;l=t;break}else qt()}}while(0);if(o){t=r[c+28>>2]|0;if((c|0)==(r[23124+(t<<2)>>2]|0)){r[23124+(t<<2)>>2]=l;if(!l){r[5706]=r[5706]&~(1<<t);m=c;s=h;break}}else{if(o>>>0<(r[5709]|0)>>>0)qt();if((r[o+16>>2]|0)==(c|0))r[o+16>>2]=l;else r[o+20>>2]=l;if(!l){m=c;s=h;break}}e=r[5709]|0;if(l>>>0<e>>>0)qt();r[l+24>>2]=o;t=r[c+16>>2]|0;do{if(t|0)if(t>>>0<e>>>0)qt();else{r[l+16>>2]=t;r[t+24>>2]=l;break}}while(0);t=r[c+16+4>>2]|0;if(t)if(t>>>0<(r[5709]|0)>>>0)qt();else{r[l+20>>2]=t;r[t+24>>2]=l;m=c;s=h;break}else{m=c;s=h}}else{m=c;s=h}}else{m=t+-8|0;s=e&-8}}while(0);if(m>>>0>=d>>>0)qt();i=r[d+4>>2]|0;if(!(i&1))qt();if(!(i&2)){if((d|0)==(r[5711]|0)){f=(r[5708]|0)+s|0;r[5708]=f;r[5711]=m;r[m+4>>2]=f|1;if((m|0)!=(r[5710]|0))return;r[5710]=0;r[5707]=0;return}if((d|0)==(r[5710]|0)){f=(r[5707]|0)+s|0;r[5707]=f;r[5710]=m;r[m+4>>2]=f|1;r[m+f>>2]=f;return}s=(i&-8)+s|0;do{if(i>>>0>=256){o=r[d+24>>2]|0;t=r[d+12>>2]|0;do{if((t|0)==(d|0)){t=r[d+16+4>>2]|0;if(!t){t=r[d+16>>2]|0;if(!t){u=0;break}else n=d+16|0}else n=d+16+4|0;while(1){e=t+20|0;i=r[e>>2]|0;if(i|0){t=i;n=e;continue}e=t+16|0;i=r[e>>2]|0;if(!i)break;else{t=i;n=e}}if(n>>>0<(r[5709]|0)>>>0)qt();else{r[n>>2]=0;u=t;break}}else{e=r[d+8>>2]|0;if(e>>>0<(r[5709]|0)>>>0)qt();if((r[e+12>>2]|0)!=(d|0))qt();if((r[t+8>>2]|0)==(d|0)){r[e+12>>2]=t;r[t+8>>2]=e;u=t;break}else qt()}}while(0);if(o|0){t=r[d+28>>2]|0;if((d|0)==(r[23124+(t<<2)>>2]|0)){r[23124+(t<<2)>>2]=u;if(!u){r[5706]=r[5706]&~(1<<t);break}}else{if(o>>>0<(r[5709]|0)>>>0)qt();if((r[o+16>>2]|0)==(d|0))r[o+16>>2]=u;else r[o+20>>2]=u;if(!u)break}e=r[5709]|0;if(u>>>0<e>>>0)qt();r[u+24>>2]=o;t=r[d+16>>2]|0;do{if(t|0)if(t>>>0<e>>>0)qt();else{r[u+16>>2]=t;r[t+24>>2]=u;break}}while(0);t=r[d+16+4>>2]|0;if(t|0)if(t>>>0<(r[5709]|0)>>>0)qt();else{r[u+20>>2]=t;r[t+24>>2]=u;break}}}else{t=r[d+8>>2]|0;e=r[d+12>>2]|0;if((t|0)!=(22860+(i>>>3<<1<<2)|0)){if(t>>>0<(r[5709]|0)>>>0)qt();if((r[t+12>>2]|0)!=(d|0))qt()}if((e|0)==(t|0)){r[5705]=r[5705]&~(1<<(i>>>3));break}if((e|0)!=(22860+(i>>>3<<1<<2)|0)){if(e>>>0<(r[5709]|0)>>>0)qt();if((r[e+8>>2]|0)!=(d|0))qt();else _=e+8|0}else _=e+8|0;r[t+12>>2]=e;r[_>>2]=t}}while(0);r[m+4>>2]=s|1;r[m+s>>2]=s;if((m|0)==(r[5710]|0)){r[5707]=s;return}}else{r[d+4>>2]=i&-2;r[m+4>>2]=s|1;r[m+s>>2]=s}e=s>>>3;if(s>>>0<256){t=r[5705]|0;if(t&1<<e){t=r[22860+(e<<1<<2)+8>>2]|0;if(t>>>0<(r[5709]|0)>>>0)qt();else{p=22860+(e<<1<<2)+8|0;f=t}}else{r[5705]=t|1<<e;p=22860+(e<<1<<2)+8|0;f=22860+(e<<1<<2)|0}r[p>>2]=m;r[f+12>>2]=m;r[m+8>>2]=f;r[m+12>>2]=22860+(e<<1<<2);return}t=s>>>8;if(t)if(s>>>0>16777215)i=31;else{i=t<<((t+1048320|0)>>>16&8)<<(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4);i=14-(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4|(t+1048320|0)>>>16&8|(i+245760|0)>>>16&2)+(i<<((i+245760|0)>>>16&2)>>>15)|0;i=s>>>(i+7|0)&1|i<<1}else i=0;n=23124+(i<<2)|0;r[m+28>>2]=i;r[m+20>>2]=0;r[m+16>>2]=0;t=r[5706]|0;e=1<<i;do{if(t&e){i=s<<((i|0)==31?0:25-(i>>>1)|0);n=r[n>>2]|0;while(1){if((r[n+4>>2]&-8|0)==(s|0)){t=130;break}e=n+16+(i>>>31<<2)|0;t=r[e>>2]|0;if(!t){t=127;break}else{i=i<<1;n=t}}if((t|0)==127)if(e>>>0<(r[5709]|0)>>>0)qt();else{r[e>>2]=m;r[m+24>>2]=n;r[m+12>>2]=m;r[m+8>>2]=m;break}else if((t|0)==130){t=n+8|0;e=r[t>>2]|0;f=r[5709]|0;if(e>>>0>=f>>>0&n>>>0>=f>>>0){r[e+12>>2]=m;r[t>>2]=m;r[m+8>>2]=e;r[m+12>>2]=n;r[m+24>>2]=0;break}else qt()}}else{r[5706]=t|e;r[n>>2]=m;r[m+24>>2]=n;r[m+12>>2]=m;r[m+8>>2]=m}}while(0);m=(r[5713]|0)+-1|0;r[5713]=m;if(!m)t=23276;else return;while(1){t=r[t>>2]|0;if(!t)break;else t=t+8|0}r[5713]=-1;return}function $l(){var t=0,e=0,i=0,n=0;n=_;_=_+48|0;if(re(23316,3)|0)eh(19340,n);t=se(r[5830]|0)|0;if(t|0?(i=r[t>>2]|0,i|0):0){t=r[i+48>>2]|0;e=r[i+48+4>>2]|0;if(!((t&-256|0)==1126902528&(e|0)==1129074247)){r[n+32>>2]=19519;eh(19614,n+32|0)}if((t|0)==1126902529&(e|0)==1129074247)t=r[i+44>>2]|0;else t=i+80|0;r[n+44>>2]=t;i=r[i>>2]|0;t=r[i+4>>2]|0;if(oh(2352,i,n+44|0)|0){i=r[n+44>>2]|0;i=ck[r[(r[i>>2]|0)+8>>2]&127](i)|0;r[n+8>>2]=19519;r[n+8+4>>2]=t;r[n+8+8>>2]=i;eh(19528,n+8|0)}else{r[n+24>>2]=19519;r[n+24+4>>2]=t;eh(19573,n+24|0)}}eh(19652,n+40|0)}function Jl(){var t=0;t=_;_=_+16|0;if(!(ae(23320,219)|0)){_=t;return}else eh(19290,t)}function th(t){t=t|0;var e=0;e=_;_=_+16|0;Ql(t);if(!(he(r[5830]|0,0)|0)){_=e;return}else eh(19237,e)}function eh(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0;s=_;_=_+240|0;r[s+80>>2]=e;e=s+96|0;i=e+40|0;do{r[e>>2]=0;e=e+4|0}while((e|0)<(i|0));r[s+136>>2]=r[s+80>>2];if((Vl(0,t,s+136|0,s,s+96|0)|0)>=0){e=r[2026]|0;if((n[8178]|0)<1)r[2026]=e&-33;if(!(r[2038]|0)){i=r[2037]|0;r[2037]=s+152;r[2033]=s+152;r[2031]=s+152;r[2038]=80;r[2030]=s+152+80;Vl(8104,t,s+136|0,s,s+96|0)|0;if(i|0){yk[r[8140>>2]&63](8104,0,0)|0;r[2037]=i;r[2038]=0;r[2030]=0;r[2033]=0;r[2031]=0}}else Vl(8104,t,s+136|0,s,s+96|0)|0;r[2026]=r[2026]|e&32}e=(n[8179]|0)==10;do{if((r[2045]|0)<0){if(!e?(o=r[2031]|0,o>>>0<(r[2030]|0)>>>0):0){r[2031]=o+1;n[o>>0]=10;break}Kl(8104,10)|0}else{if(!e?(a=r[2031]|0,a>>>0<(r[2030]|0)>>>0):0){r[2031]=a+1;n[a>>0]=10;break}Kl(8104,10)|0}}while(0);qt()}function ih(t){t=t|0;return}function nh(t){t=t|0;Ql(t);return}function sh(t){t=t|0;return}function rh(t){t=t|0;return}function oh(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0;o=_;_=_+64|0;if((t|0)!=(e|0))if((e|0)!=0?(s=ah(e,2360)|0,(s|0)!=0):0){e=o;n=e+56|0;do{r[e>>2]=0;e=e+4|0}while((e|0)<(n|0));r[o>>2]=s;r[o+8>>2]=t;r[o+12>>2]=-1;r[o+48>>2]=1;jk[r[(r[s>>2]|0)+28>>2]&127](s,o,r[i>>2]|0,1);if((r[o+24>>2]|0)==1){r[i>>2]=r[o+16>>2];e=1}else e=0}else e=0;else e=1;_=o;return e|0}function ah(t,e){t=t|0;e=e|0;var i=0,o=0,a=0,l=0;l=_;_=_+64|0;a=r[t>>2]|0;o=t+(r[a+-8>>2]|0)|0;a=r[a+-4>>2]|0;r[l>>2]=e;r[l+4>>2]=t;r[l+8>>2]=2392;t=l+12|0;i=t+40|0;do{r[t>>2]=0;t=t+4|0}while((t|0)<(i|0));s[l+12+40>>1]=0;n[l+12+42>>0]=0;t:do{if((a|0)==(e|0)){r[l+48>>2]=1;vk[r[(r[e>>2]|0)+20>>2]&7](e,l,o,o,1,0);t=(r[l+24>>2]|0)==1?o:0}else{sk[r[(r[a>>2]|0)+24>>2]&31](a,l,o,1,0);switch(r[l+36>>2]|0){case 0:{t=((r[l+40>>2]|0)==1?(r[l+28>>2]|0)==1:0)&(r[l+32>>2]|0)==1?r[l+20>>2]|0:0;break t}case 1:break;default:{t=0;break t}}if((r[l+24>>2]|0)!=1?!(((r[l+40>>2]|0)==0?(r[l+28>>2]|0)==1:0)&(r[l+32>>2]|0)==1):0){t=0;break}t=r[l+16>>2]|0}}while(0);_=l;return t|0}function lh(t,e,i,n,s,o){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;if((t|0)==(r[e+8>>2]|0))hh(e,i,n,s);else{t=r[t+8>>2]|0;vk[r[(r[t>>2]|0)+20>>2]&7](t,e,i,n,s,o)}return}function hh(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;n[t+53>>0]=1;do{if((r[t+4>>2]|0)==(i|0)){n[t+52>>0]=1;i=r[t+16>>2]|0;if(!i){r[t+16>>2]=e;r[t+24>>2]=s;r[t+36>>2]=1;if(!((s|0)==1?(r[t+48>>2]|0)==1:0))break;n[t+54>>0]=1;break}if((i|0)!=(e|0)){r[t+36>>2]=(r[t+36>>2]|0)+1;n[t+54>>0]=1;break}i=r[t+24>>2]|0;if((i|0)==2){r[t+24>>2]=s;i=s}if((i|0)==1?(r[t+48>>2]|0)==1:0)n[t+54>>0]=1}}while(0);return}function ch(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;do{if((t|0)==(r[e+8>>2]|0)){if((r[e+4>>2]|0)==(i|0)?(r[e+28>>2]|0)!=1:0)r[e+28>>2]=s}else{if((t|0)!=(r[e>>2]|0)){t=r[t+8>>2]|0;sk[r[(r[t>>2]|0)+24>>2]&31](t,e,i,s,o);break}if((r[e+16>>2]|0)!=(i|0)?(r[e+20>>2]|0)!=(i|0):0){r[e+32>>2]=s;if((r[e+44>>2]|0)==4)break;n[e+52>>0]=0;n[e+53>>0]=0;t=r[t+8>>2]|0;vk[r[(r[t>>2]|0)+20>>2]&7](t,e,i,i,1,o);if(n[e+53>>0]|0)if(!(n[e+52>>0]|0)){s=1;t=13}else t=17;else{s=0;t=13}do{if((t|0)==13){r[e+20>>2]=i;r[e+40>>2]=(r[e+40>>2]|0)+1;if((r[e+36>>2]|0)==1?(r[e+24>>2]|0)==2:0){n[e+54>>0]=1;if(s){t=17;break}else{s=4;break}}if(s)t=17;else s=4}}while(0);if((t|0)==17)s=3;r[e+44>>2]=s;break}if((s|0)==1)r[e+32>>2]=1}}while(0);return}function _h(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;do{if((t|0)==(r[e+8>>2]|0)){t=r[e+16>>2]|0;if(!t){r[e+16>>2]=i;r[e+24>>2]=s;r[e+36>>2]=1;break}if((t|0)!=(i|0)){r[e+36>>2]=(r[e+36>>2]|0)+1;r[e+24>>2]=2;n[e+54>>0]=1;break}if((r[e+24>>2]|0)==2)r[e+24>>2]=s}else{t=r[t+8>>2]|0;jk[r[(r[t>>2]|0)+28>>2]&127](t,e,i,s)}}while(0);return}function uh(t){t=t|0;Ql(t);return}function dh(t,e,i,n,s,o){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;if((t|0)==(r[e+8>>2]|0))hh(e,i,n,s);return}function ph(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;do{if((t|0)==(r[e+8>>2]|0)){if((r[e+4>>2]|0)==(i|0)?(r[e+28>>2]|0)!=1:0)r[e+28>>2]=s}else if((t|0)==(r[e>>2]|0)){if((r[e+16>>2]|0)!=(i|0)?(r[e+20>>2]|0)!=(i|0):0){r[e+32>>2]=s;r[e+20>>2]=i;r[e+40>>2]=(r[e+40>>2]|0)+1;if((r[e+36>>2]|0)==1?(r[e+24>>2]|0)==2:0)n[e+54>>0]=1;r[e+44>>2]=4;break}if((s|0)==1)r[e+32>>2]=1}}while(0);return}function fh(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;do{if((t|0)==(r[e+8>>2]|0)){t=r[e+16>>2]|0;if(!t){r[e+16>>2]=i;r[e+24>>2]=s;r[e+36>>2]=1;break}if((t|0)!=(i|0)){r[e+36>>2]=(r[e+36>>2]|0)+1;r[e+24>>2]=2;n[e+54>>0]=1;break}if((r[e+24>>2]|0)==2)r[e+24>>2]=s}}while(0);return}function mh(t){t=t|0;return}function gh(t){t=t|0;Ql(t);return}function bh(t){t=t|0;return 19717}function yh(t){t=t|0;Ql(t);return}function vh(t,e,i,o,a,l){t=t|0;e=e|0;i=i|0;o=o|0;a=a|0;l=l|0;var h=0,c=0,_=0,u=0;if((t|0)==(r[e+8>>2]|0))hh(e,i,o,a);else{_=s[e+52>>1]|0;h=r[t+12>>2]|0;n[e+52>>0]=0;n[e+53>>0]=0;Sh(t+16|0,e,i,o,a,l);t:do{if((h|0)>1){u=t+24|0;do{if(n[e+54>>0]|0)break t;c=s[e+52>>1]|0;if(!((c&255)<<24>>24)){if((c&65535)>=256?(r[t+8>>2]&1|0)==0:0)break t}else{if((r[e+24>>2]|0)==1)break t;if(!(r[t+8>>2]&2))break t}n[e+52>>0]=0;n[e+53>>0]=0;Sh(u,e,i,o,a,l);u=u+8|0}while(u>>>0<(t+16+(h<<3)|0)>>>0)}}while(0);n[e+52>>0]=_;n[e+53>>0]=(_&65535)>>>8}return}function Sh(t,e,i,n,s,o){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;var a=0,l=0;a=r[t+4>>2]|0;if(!(a&1))l=a>>8;else l=r[(r[n>>2]|0)+(a>>8)>>2]|0;t=r[t>>2]|0;vk[r[(r[t>>2]|0)+20>>2]&7](t,e,i,n+l|0,a&2|0?s:2,o);return}function xh(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0,l=0,h=0,c=0;t:do{if((t|0)==(r[e+8>>2]|0)){if((r[e+4>>2]|0)==(i|0)?(r[e+28>>2]|0)!=1:0)r[e+28>>2]=s}else{if((t|0)!=(r[e>>2]|0)){l=r[t+12>>2]|0;wh(t+16|0,e,i,s,o);if((l|0)<=1)break;a=r[t+8>>2]|0;if((a&2|0)==0?(r[e+36>>2]|0)!=1:0){if(!(a&1)){a=t+24|0;while(1){if(n[e+54>>0]|0)break t;if((r[e+36>>2]|0)==1)break t;wh(a,e,i,s,o);a=a+8|0;if(a>>>0>=(t+16+(l<<3)|0)>>>0)break t}}a=t+24|0;while(1){if(n[e+54>>0]|0)break t;if((r[e+36>>2]|0)==1?(r[e+24>>2]|0)==1:0)break t;wh(a,e,i,s,o);a=a+8|0;if(a>>>0>=(t+16+(l<<3)|0)>>>0)break t}}a=t+24|0;while(1){if(n[e+54>>0]|0)break t;wh(a,e,i,s,o);a=a+8|0;if(a>>>0>=(t+16+(l<<3)|0)>>>0)break t}}if((r[e+16>>2]|0)!=(i|0)?(r[e+20>>2]|0)!=(i|0):0){r[e+32>>2]=s;if((r[e+44>>2]|0)==4)break;s=t+16+(r[t+12>>2]<<3)|0;c=0;a=0;h=t+16|0;e:while(1){if(h>>>0>=s>>>0){l=20;break}n[e+52>>0]=0;n[e+53>>0]=0;Sh(h,e,i,i,1,o);if(n[e+54>>0]|0){l=20;break}do{if(n[e+53>>0]|0){if(!(n[e+52>>0]|0))if(!(r[t+8>>2]&1)){a=1;l=20;break e}else{l=c;a=1;break}if((r[e+24>>2]|0)==1){l=25;break e}if(!(r[t+8>>2]&2)){l=25;break e}else{l=1;a=1}}else l=c}while(0);c=l;h=h+8|0}do{if((l|0)==20){if((!c?(r[e+20>>2]=i,r[e+40>>2]=(r[e+40>>2]|0)+1,(r[e+36>>2]|0)==1):0)?(r[e+24>>2]|0)==2:0){n[e+54>>0]=1;if(a){l=25;break}else{a=4;break}}if(a)l=25;else a=4}}while(0);if((l|0)==25)a=3;r[e+44>>2]=a;break}if((s|0)==1)r[e+32>>2]=1}}while(0);return}function wh(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var o=0,a=0;o=r[t+4>>2]|0;if(!(o&1))a=o>>8;else a=r[(r[i>>2]|0)+(o>>8)>>2]|0;t=r[t>>2]|0;sk[r[(r[t>>2]|0)+24>>2]&31](t,e,i+a|0,o&2|0?n:2,s);return}function Ch(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0;t:do{if((t|0)==(r[e+8>>2]|0)){o=r[e+16>>2]|0;if(!o){r[e+16>>2]=i;r[e+24>>2]=s;r[e+36>>2]=1;break}if((o|0)!=(i|0)){r[e+36>>2]=(r[e+36>>2]|0)+1;r[e+24>>2]=2;n[e+54>>0]=1;break}if((r[e+24>>2]|0)==2)r[e+24>>2]=s}else{o=r[t+12>>2]|0;Th(t+16|0,e,i,s);if((o|0)>1){a=t+24|0;do{Th(a,e,i,s);if(n[e+54>>0]|0)break t;a=a+8|0}while(a>>>0<(t+16+(o<<3)|0)>>>0)}}}while(0);return}function Th(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0;s=r[t+4>>2]|0;if(!(s&1))o=s>>8;else o=r[(r[i>>2]|0)+(s>>8)>>2]|0;t=r[t>>2]|0;jk[r[(r[t>>2]|0)+28>>2]&127](t,e,i+o|0,s&2|0?n:2);return}function Ah(t,e,i){t=t|0;e=e|0;i=i|0;var n=0;n=_;_=_+16|0;r[n>>2]=r[i>>2];t=yk[r[(r[t>>2]|0)+16>>2]&63](t,e,n)|0;if(t)r[i>>2]=r[n>>2];_=n;return t&1|0}function Eh(t){t=t|0;if(!t)t=0;else t=(ah(t,2448)|0)!=0;return t&1|0}function Mh(){}function Rh(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;n=e-n-(i>>>0>t>>>0|0)>>>0;return(P=n,t-i>>>0|0)|0}function Ih(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;return(P=e+n+(t+i>>>0>>>0<t>>>0|0)>>>0,t+i>>>0|0)|0}function Ph(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0;s=t+i|0;if((i|0)>=20){e=e&255;o=t&3;a=e|e<<8|e<<16|e<<24;if(o){o=t+4-o|0;while((t|0)<(o|0)){n[t>>0]=e;t=t+1|0}}while((t|0)<(s&~3|0)){r[t>>2]=a;t=t+4|0}}while((t|0)<(s|0)){n[t>>0]=e;t=t+1|0}return t-i|0}function Lh(t,e,i){t=t|0;e=e|0;i=i|0;if((i|0)<32){P=e<<i|(t&(1<<i)-1<<32-i)>>>32-i;return t<<i}P=t<<i-32;return 0}function Dh(t,e,i){t=t|0;e=e|0;i=i|0;if((i|0)<32){P=e>>i;return t>>>i|(e&(1<<i)-1)<<32-i}P=(e|0)<0?-1:0;return e>>i-32|0}function kh(t,e,i){t=t|0;e=e|0;i=i|0;if((i|0)<32){P=e>>>i;return t>>>i|(e&(1<<i)-1)<<32-i}P=0;return e>>>i-32|0}function Oh(t,e,i){t=t|0;e=e|0;i=i|0;var s=0;if((i|0)>=4096)return ee(t|0,e|0,i|0)|0;s=t|0;if((t&3)==(e&3)){while(t&3){if(!i)return s|0;n[t>>0]=n[e>>0]|0;t=t+1|0;e=e+1|0;i=i-1|0}while((i|0)>=4){r[t>>2]=r[e>>2];t=t+4|0;e=e+4|0;i=i-4|0}}while((i|0)>0){n[t>>0]=n[e>>0]|0;t=t+1|0;e=e+1|0;i=i-1|0}return s|0}function Fh(t,e,i){t=t|0;e=e|0;i=i|0;var s=0;if((e|0)<(t|0)&(t|0)<(e+i|0)){s=t;e=e+i|0;t=t+i|0;while((i|0)>0){t=t-1|0;e=e-1|0;i=i-1|0;n[t>>0]=n[e>>0]|0}t=s}else Oh(t,e,i)|0;return t|0}function Bh(t){t=t|0;return(t&255)<<24|(t>>8&255)<<16|(t>>16&255)<<8|t>>>24|0}function Nh(){return 0}function Uh(t){t=t|0;var e=0;e=n[f+(t&255)>>0]|0;if((e|0)<8)return e|0;e=n[f+(t>>8&255)>>0]|0;if((e|0)<8)return e+8|0;e=n[f+(t>>16&255)>>0]|0;if((e|0)<8)return e+16|0;return(n[f+(t>>>24)>>0]|0)+24|0}function Vh(t,e){t=t|0;e=e|0;var i=0,n=0,s=0;i=et(e&65535,t&65535)|0;s=(i>>>16)+(et(e&65535,t>>>16)|0)|0;n=et(e>>>16,t&65535)|0;return(P=(s>>>16)+(et(e>>>16,t>>>16)|0)+(((s&65535)+n|0)>>>16)|0,s+n<<16|i&65535|0)|0}function zh(t,e,i,n){t|0;e|0;i|0;n|0;var s=0,r=0,o=0,a=0;e>>31|((e|0)<0?-1:0)<<1;((e|0)<0?-1:0)>>31|((e|0)<0?-1:0)<<1;n>>31|((n|0)<0?-1:0)<<1;((n|0)<0?-1:0)>>31|((n|0)<0?-1:0)<<1;Rh(o^t|0,s^e|0,o|0,s|0)|0;P;return Rh((Xh(t,e,Rh(a^i|0,r^n|0,a|0,r|0)|0,P,0)|0)^(a^o)|0,P^(r^s)|0,a^o|0,r^s|0)|0}function Wh(t,e,i,n){t|0;e|0;i|0;n|0;var s=0,o=0,a=0,l=0,h=0;_;_=_+16|0;e>>31|((e|0)<0?-1:0)<<1;((e|0)<0?-1:0)>>31|((e|0)<0?-1:0)<<1;n>>31|((n|0)<0?-1:0)<<1;((n|0)<0?-1:0)>>31|((n|0)<0?-1:0)<<1;Rh(a^t|0,o^e|0,a|0,o|0)|0;P;Xh(t,e,Rh(h^i|0,l^n|0,h|0,l|0)|0,P,s|0)|0;Rh(r[s>>2]^a|0,r[s+4>>2]^o|0,a|0,o|0)|0;P;_=s;return(P=i,n)|0}function Gh(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,r=0;s=Vh(t,i)|0;r=P;return(P=(et(e,i)|0)+(et(n,t)|0)+r|r&0,s|0|0)|0}function jh(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;return Xh(t,e,i,n,0)|0}function Hh(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0;s=_;_=_+16|0;Xh(t,e,i,n,s|0)|0;_=s;return(P=r[s+4>>2]|0,r[s>>2]|0)|0}function Xh(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var o=0,a=0,l=0,h=0,c=0,_=0,u=0,d=0,p=0,f=0;if(!e)if(!n){if(s|0){r[s>>2]=(t>>>0)%(i>>>0);r[s+4>>2]=0}n=0;s=(t>>>0)/(i>>>0)>>>0;return(P=n,s)|0}else{if(!s){n=0;s=0;return(P=n,s)|0}r[s>>2]=t|0;r[s+4>>2]=e&0;n=0;s=0;return(P=n,s)|0}do{if(i){if(n|0){a=(nt(n|0)|0)-(nt(e|0)|0)|0;if(a>>>0<=31){d=a+1|0;l=t>>>((a+1|0)>>>0)&a-31>>31|e<<31-a;u=e>>>((a+1|0)>>>0)&a-31>>31;o=0;a=t<<31-a;break}if(!s){n=0;s=0;return(P=n,s)|0}r[s>>2]=t|0;r[s+4>>2]=e|e&0;n=0;s=0;return(P=n,s)|0}if(i-1&i|0){a=(nt(i|0)|0)+33-(nt(e|0)|0)|0;d=a;l=32-a-1>>31&e>>>((a-32|0)>>>0)|(e<<32-a|t>>>(a>>>0))&a-32>>31;u=a-32>>31&e>>>(a>>>0);o=t<<64-a&32-a>>31;a=(e<<64-a|t>>>((a-32|0)>>>0))&32-a>>31|t<<32-a&a-33>>31;break}if(s|0){r[s>>2]=i-1&t;r[s+4>>2]=0}if((i|0)==1){n=e|e&0;s=t|0|0;return(P=n,s)|0}else{s=Uh(i|0)|0;n=e>>>(s>>>0)|0;s=e<<32-s|t>>>(s>>>0)|0;return(P=n,s)|0}}else{if(!n){if(s|0){r[s>>2]=(e>>>0)%(i>>>0);r[s+4>>2]=0}n=0;s=(e>>>0)/(i>>>0)>>>0;return(P=n,s)|0}if(!t){if(s|0){r[s>>2]=0;r[s+4>>2]=(e>>>0)%(n>>>0)}i=0;s=(e>>>0)/(n>>>0)>>>0;return(P=i,s)|0}if(!(n-1&n)){if(s|0){r[s>>2]=t|0;r[s+4>>2]=n-1&e|e&0}i=0;s=e>>>((Uh(n|0)|0)>>>0);return(P=i,s)|0}a=(nt(n|0)|0)-(nt(e|0)|0)|0;if(a>>>0<=30){d=a+1|0;l=e<<31-a|t>>>((a+1|0)>>>0);u=e>>>((a+1|0)>>>0);o=0;a=t<<31-a;break}if(!s){n=0;s=0;return(P=n,s)|0}r[s>>2]=t|0;r[s+4>>2]=e|e&0;n=0;s=0;return(P=n,s)|0}}while(0);if(!d){h=a;e=u;t=0;a=0}else{c=Ih(i|0|0,n|n&0|0,-1,-1)|0;_=P;h=a;e=u;t=d;a=0;do{f=h;h=o>>>31|h<<1;o=a|o<<1;f=l<<1|f>>>31|0;p=l>>>31|e<<1|0;Rh(c|0,_|0,f|0,p|0)|0;d=P;u=d>>31|((d|0)<0?-1:0)<<1;a=u&1;l=Rh(f|0,p|0,u&(i|0)|0,(((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1)&(n|n&0)|0)|0;e=P;t=t-1|0}while((t|0)!=0);t=0}if(s|0){r[s>>2]=l;r[s+4>>2]=e}p=(o|0)>>>31|h<<1|(0<<1|o>>>31)&0|t;f=(o<<1|0>>>31)&-2|a;return(P=p,f)|0}function Yh(t,e,i,n,s,r){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;sk[t&31](e|0,i|0,n|0,s|0,r|0)}function qh(t,e,i){t=t|0;e=e|0;i=+i;rk[t&31](e|0,+i)}function Kh(t,e){t=t|0;e=e|0;ok[t&255](e|0)}function Zh(t,e,i,n,s,r,o){t=t|0;e=e|0;i=i|0;n=n|0;s=+s;r=r|0;o=o|0;ak[t&0](e|0,i|0,n|0,+s,r|0,o|0)}function Qh(t,e,i){t=t|0;e=e|0;i=i|0;lk[t&127](e|0,i|0)}function $h(t,e,i,n,s,r,o,a,l,h,c){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;l=l|0;h=h|0;c=c|0;return hk[t&3](e|0,i|0,n|0,s|0,r|0,o|0,a|0,l|0,h|0,c|0)|0}function Jh(t,e){t=t|0;e=e|0;return ck[t&127](e|0)|0}function tc(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=+n;s=s|0;_k[t&7](e|0,i|0,+n,s|0)}function ec(t,e,i,n,s,r,o){t=t|0;e=e|0;i=+i;n=+n;s=s|0;r=r|0;o=o|0;uk[t&0](e|0,+i,+n,s|0,r|0,o|0)}function ic(t,e,i,n,s){t=t|0;e=e|0;i=+i;n=n|0;s=s|0;dk[t&0](e|0,+i,n|0,s|0)}function nc(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;return pk[t&31](e|0,i|0,n|0,s|0)|0}function sc(t,e,i,n){t=t|0;e=e|0;i=+i;n=n|0;fk[t&15](e|0,+i,n|0)}function rc(t,e,i,n,s,r,o,a,l){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;l=l|0;return+mk[t&1](e|0,i|0,n|0,s|0,r|0,o|0,a|0,l|0)}function oc(t,e,i,n,s,r,o,a,l,h,c,_){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=+r;o=+o;a=+a;l=+l;h=h|0;c=c|0;_=+_;gk[t&0](e|0,i|0,n|0,s|0,+r,+o,+a,+l,h|0,c|0,+_)}function ac(t,e,i,n,s,r){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;return+bk[t&15](e|0,i|0,n|0,s|0,r|0)}function lc(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;return yk[t&63](e|0,i|0,n|0)|0}function hc(t,e,i,n,s,r,o){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;vk[t&7](e|0,i|0,n|0,s|0,r|0,o|0)}function cc(t,e,i,n){t=t|0;e=e|0;i=i|0;n=+n;return Sk[t&7](e|0,i|0,+n)|0}function _c(t,e){t=t|0;e=e|0;return+xk[t&15](e|0)}function uc(t,e,i,n,s,r,o){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;return wk[t&3](e|0,i|0,n|0,s|0,r|0,o|0)|0}function dc(t,e,i,n,s,r,o){t=t|0;e=e|0;i=i|0;n=n|0;s=+s;r=r|0;o=o|0;return+Ck[t&3](e|0,i|0,n|0,+s,r|0,o|0)}function pc(t,e,i,n,s,r){t=t|0;e=e|0;i=i|0;n=+n;s=s|0;r=r|0;Tk[t&0](e|0,i|0,+n,s|0,r|0)}function fc(t,e,i,n,s,r,o,a){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;Ak[t&3](e|0,i|0,n|0,s|0,r|0,o|0,a|0)}function mc(t,e,i,n,s,r,o,a,l,h){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;l=l|0;h=h|0;Ek[t&1](e|0,i|0,n|0,s|0,r|0,o|0,a|0,l|0,h|0)}function gc(t,e,i,n,s,r,o,a,l,h,c){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;l=l|0;h=h|0;c=c|0;Mk[t&3](e|0,i|0,n|0,s|0,r|0,o|0,a|0,l|0,h|0,c|0)}function bc(t,e,i){t=t|0;e=e|0;i=i|0;return Rk[t&31](e|0,i|0)|0}function yc(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;return+Ik[t&15](e|0,i|0,n|0)}function vc(t,e,i,n,s,r,o,a,l,h,c){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;l=l|0;h=h|0;c=c|0;return+Pk[t&3](e|0,i|0,n|0,s|0,r|0,o|0,a|0,l|0,h|0,c|0)}function Sc(t,e,i,n,s,r){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=+r;Lk[t&1](e|0,i|0,n|0,s|0,+r)}function xc(t,e,i,n,s,r,o,a,l,h){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;l=l|0;h=h|0;return+Dk[t&3](e|0,i|0,n|0,s|0,r|0,o|0,a|0,l|0,h|0)}function wc(t,e,i){t=t|0;e=e|0;i=+i;return+kk[t&1](e|0,+i)}function Cc(t,e,i,n,s,r,o,a,l,h,c,_,u){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=+r;o=+o;a=+a;l=+l;h=+h;c=c|0;_=+_;u=u|0;Ok[t&0](e|0,i|0,n|0,s|0,+r,+o,+a,+l,+h,c|0,+_,u|0)}function Tc(t,e,i,n,s,r){t=t|0;e=e|0;i=i|0;n=+n;s=s|0;r=r|0;return+Fk[t&3](e|0,i|0,+n,s|0,r|0)}function Ac(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;return+Bk[t&1](e|0,i|0,n|0,s|0)}function Ec(t,e,i,n,s,r,o,a,l,h){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;l=l|0;h=h|0;return Nk[t&3](e|0,i|0,n|0,s|0,r|0,o|0,a|0,l|0,h|0)|0}function Mc(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=+s;Uk[t&15](e|0,i|0,n|0,+s)}function Rc(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;Vk[t&127](e|0,i|0,n|0)}function Ic(t){t=t|0;zk[t&3]()}function Pc(t,e,i,n){t=t|0;e=e|0;i=i|0;n=+n;Wk[t&7](e|0,i|0,+n)}function Lc(t,e,i,n,s){t=t|0;e=e|0;i=+i;n=n|0;s=+s;return Gk[t&1](e|0,+i,n|0,+s)|0}function Dc(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;jk[t&127](e|0,i|0,n|0,s|0)}function kc(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;st(0)}function Oc(t,e){t=t|0;e=+e;st(1)}function Fc(t){t=t|0;st(2)}function Bc(t,e,i,n,s,r){t=t|0;e=e|0;i=i|0;n=+n;s=s|0;r=r|0;st(3)}function Nc(t,e){t=t|0;e=e|0;st(4)}function Uc(t,e,i,n,s,r,o,a,l,h){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;l=l|0;h=h|0;st(5);return 0}function Vc(t){t=t|0;st(6);return 0}function zc(t,e,i,n){t=t|0;e=e|0;i=+i;n=n|0;st(7)}function Wc(t,e,i,n,s,r){t=t|0;e=+e;i=+i;n=n|0;s=s|0;r=r|0;st(8)}function Gc(t,e,i,n){t=t|0;e=+e;i=i|0;n=n|0;st(9)}function jc(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;st(10);return 0}function Hc(t,e,i){t=t|0;e=+e;i=i|0;st(11)}function Xc(t,e,i,n,s,r,o,a){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;st(12);return 0.0}function Yc(t,e,i,n,s,r,o,a,l,h,c){t=t|0;e=e|0;i=i|0;n=n|0;s=+s;r=+r;o=+o;a=+a;l=l|0;h=h|0;c=+c;st(13)}function qc(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;st(14);return 0.0}function Kc(t,e,i){t=t|0;e=e|0;i=i|0;st(15);return 0}function Zc(t,e,i,n,s,r){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;st(16)}function Qc(t,e,i){t=t|0;e=e|0;i=+i;st(17);return 0}function $c(t){t=t|0;st(18);return 0.0}function Jc(t,e,i,n,s,r){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;st(19);return 0}function t_(t,e,i,n,s,r){t=t|0;e=e|0;i=i|0;n=+n;s=s|0;r=r|0;st(20);return 0.0}function e_(t,e,i,n,s){t=t|0;e=e|0;i=+i;n=n|0;s=s|0;st(21)}function i_(t,e,i,n,s,r,o){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;st(22)}function n_(t,e,i,n,s,r,o,a,l){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;l=l|0;st(23)}function s_(t,e,i,n,s,r,o,a,l,h){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;l=l|0;h=h|0;st(24)}function r_(t,e){t=t|0;e=e|0;st(25);return 0}function o_(t,e,i){t=t|0;e=e|0;i=i|0;st(26);return 0.0}function a_(t,e,i,n,s,r,o,a,l,h){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;l=l|0;h=h|0;st(27);return 0.0}function l_(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=+s;st(28)}function h_(t,e,i,n,s,r,o,a,l){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;l=l|0;st(29);return 0.0}function c_(t,e){t=t|0;e=+e;st(30);return 0.0}function __(t,e,i,n,s,r,o,a,l,h,c,_){t=t|0;e=e|0;i=i|0;n=n|0;s=+s;r=+r;o=+o;a=+a;l=+l;h=h|0;c=+c;_=_|0;st(31)}function u_(t,e,i,n,s){t=t|0;e=e|0;i=+i;n=n|0;s=s|0;st(32);return 0.0}function d_(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;st(33);return 0.0}function p_(t,e,i,n,s,r,o,a,l){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;l=l|0;st(34);return 0}function f_(t,e,i,n){t=t|0;e=e|0;i=i|0;n=+n;st(35)}function m_(t,e,i){t=t|0;e=e|0;i=i|0;st(36)}function g_(){st(37)}function b_(){fe()}function y_(t,e,i){t=t|0;e=e|0;i=+i;st(38)}function v_(t,e,i,n){t=t|0;e=+e;i=i|0;n=+n;st(39);return 0}function S_(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;st(40)}function x_(t,e){t=t|0;e=+e;var i=0,s=0,o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0,f=0,m=0,g=0.0,b=0.0,y=0.0,v=0.0,S=0,x=0,w=0,C=0,T=0,A=0,E=0,M=0,R=0,I=0.0,P=0.0;M=_;_=_+64|0;i=r[t+128>>2]|0;if((i|0)>0){s=0;do{w_(r[t+108>>2]|0,r[t+136>>2]|0,s,0);s=s+1|0;i=r[t+128>>2]|0}while((s|0)<(i|0))}s=r[t+108>>2]|0;y=+h[s+336>>2];v=+h[s+340>>2];o=+h[s+344>>2];o=+G(+(y*y+v*v+o*o))*3.5999999046325684;h[t+104>>2]=o;E=r[t+120>>2]|0;if(+h[s+4+(E<<2)>>2]*+h[s+336>>2]+ +h[s+20+(E<<2)>>2]*+h[s+340>>2]+ +h[s+36+(E<<2)>>2]*+h[s+344>>2]<0.0)h[t+104>>2]=-o;if((i|0)>0){E=0;do{A=r[t+136>>2]|0;f=A+(E*284|0)|0;C_(s,f,0);p=A+(E*284|0)+204|0;i=A+(E*284|0)+212|0;o=+h[p>>2]+ +h[i>>2];m=A+(E*284|0)+52|0;S=A+(E*284|0)+56|0;x=A+(E*284|0)+60|0;R=A+(E*284|0)+36|0;w=A+(E*284|0)+16|0;y=o*+h[S>>2]+ +h[A+(E*284|0)+40>>2];v=o*+h[x>>2]+ +h[A+(E*284|0)+44>>2];h[A+(E*284|0)+16>>2]=+h[m>>2]*o+ +h[R>>2];C=A+(E*284|0)+20|0;h[C>>2]=y;T=A+(E*284|0)+24|0;h[T>>2]=v;h[A+(E*284|0)+28>>2]=0.0;h[M+32>>2]=-1.0;s=r[t+92>>2]|0;R=pk[r[(r[s>>2]|0)+8>>2]&31](s,R,w,M)|0;s=A+(E*284|0)+88|0;r[s>>2]=0;do{if(R){o=o*+h[M+32>>2];r[f>>2]=r[M+16>>2];r[f+4>>2]=r[M+16+4>>2];r[f+8>>2]=r[M+16+8>>2];r[f+12>>2]=r[M+16+12>>2];n[A+(E*284|0)+84>>0]=1;if(!(n[19888]|0)){n[19888]=1;r[M+40>>2]=0;r[M+40+4>>2]=0;r[M+40+8>>2]=0;r[M+40+12>>2]=0;zy(21908,0.0,0,0,M+40|0)}r[5528]=r[5528]|1;h[5569]=0.0;a=+h[5579]*0.0;l=+h[5580]*0.0;h[5574]=+h[5578]*0.0;h[5575]=a;h[5576]=l;h[5577]=0.0;r[5582]=0;r[5583]=0;r[5584]=0;r[5585]=0;l=+h[5571]*0.0;a=+h[5572]*0.0;h[5623]=+h[5570]*0.0;h[5624]=l;h[5625]=a;h[5626]=0.0;r[s>>2]=21908;o=o-+h[i>>2];i=A+(E*284|0)+32|0;h[i>>2]=o;a=+h[p>>2];l=+h[A+(E*284|0)+208>>2]*.009999999776482582;if(o<a-l){h[i>>2]=a-l;o=a-l}if(o>a+l)h[i>>2]=a+l;r[w>>2]=r[M>>2];r[w+4>>2]=r[M+4>>2];r[w+8>>2]=r[M+8>>2];r[w+12>>2]=r[M+12>>2];b=+h[f>>2];y=+h[A+(E*284|0)+4>>2];v=+h[A+(E*284|0)+8>>2];g=b*+h[m>>2]+y*+h[S>>2]+v*+h[x>>2];i=r[t+108>>2]|0;d=+h[w>>2]-+h[i+52>>2];u=+h[C>>2]-+h[i+56>>2];o=+h[T>>2]-+h[i+60>>2];a=+h[i+356>>2];l=+h[i+360>>2];c=+h[i+352>>2];if(!(g>=-.10000000149011612)){h[A+(E*284|0)+272>>2]=-1.0/g*(b*(a*o-u*l+ +h[i+336>>2])+y*(d*l-o*c+ +h[i+340>>2])+v*(u*c-d*a+ +h[i+344>>2]));h[A+(E*284|0)+268>>2]=-1.0/g;break}else{h[A+(E*284|0)+272>>2]=0.0;h[A+(E*284|0)+268>>2]=10.0;break}}else{r[A+(E*284|0)+32>>2]=r[p>>2];h[A+(E*284|0)+272>>2]=0.0;y=-+h[S>>2];v=-+h[x>>2];h[f>>2]=-+h[m>>2];h[A+(E*284|0)+4>>2]=y;h[A+(E*284|0)+8>>2]=v;h[A+(E*284|0)+12>>2]=0.0;h[A+(E*284|0)+268>>2]=1.0}}while(0);E=E+1|0;i=r[t+128>>2]|0;s=r[t+108>>2]|0}while((E|0)<(i|0));a=1.0/+h[s+368>>2];if((i|0)>0){s=0;do{i=r[t+136>>2]|0;if(!(n[i+(s*284|0)+84>>0]|0))o=0.0;else{o=+h[i+(s*284|0)+272>>2];o=a*(+h[i+(s*284|0)+216>>2]*(+h[i+(s*284|0)+204>>2]-+h[i+(s*284|0)+32>>2])*+h[i+(s*284|0)+268>>2]-o*+h[(o<0.0?i+(s*284|0)+220|0:i+(s*284|0)+224|0)>>2]);o=o<0.0?0.0:o}h[i+(s*284|0)+276>>2]=o;s=s+1|0;i=r[t+128>>2]|0}while((s|0)<(i|0));if((i|0)>0){i=0;do{E=r[t+136>>2]|0;b=+h[E+(i*284|0)+276>>2];v=+h[E+(i*284|0)+248>>2];b=b>v?v:b;v=b*+h[E+(i*284|0)+4>>2]*e;y=b*+h[E+(i*284|0)+8>>2]*e;h[M+40>>2]=+h[E+(i*284|0)>>2]*b*e;h[M+40+4>>2]=v;h[M+40+8>>2]=y;h[M+40+12>>2]=0.0;R=r[t+108>>2]|0;y=+h[E+(i*284|0)+20>>2]-+h[R+56>>2];v=+h[E+(i*284|0)+24>>2]-+h[R+60>>2];h[M>>2]=+h[E+(i*284|0)+16>>2]-+h[R+52>>2];h[M+4>>2]=y;h[M+8>>2]=v;h[M+12>>2]=0.0;zE(R,M+40|0,M);i=i+1|0}while((i|0)<(r[t+128>>2]|0))}}}rk[r[(r[t>>2]|0)+20>>2]&31](t,e);s=r[t+128>>2]|0;if((s|0)<=0){_=M;return}p=r[t+136>>2]|0;f=r[t+108>>2]|0;m=0;do{o=+h[p+(m*284|0)+36>>2]-+h[f+52>>2];a=+h[p+(m*284|0)+40>>2]-+h[f+56>>2];l=+h[p+(m*284|0)+44>>2]-+h[f+60>>2];c=+h[f+356>>2];u=+h[f+360>>2];d=+h[f+352>>2];if(!(n[p+(m*284|0)+84>>0]|0)){i=p+(m*284|0)+240|0;o=+h[i>>2];R=p+(m*284|0)+236|0;h[R>>2]=o+ +h[R>>2]}else{i=r[t+120>>2]|0;P=+h[f+4+(i<<2)>>2];g=+h[f+20+(i<<2)>>2];y=+h[f+36+(i<<2)>>2];I=+h[p+(m*284|0)>>2];b=+h[p+(m*284|0)+4>>2];v=+h[p+(m*284|0)+8>>2];o=((a*d-o*c+ +h[f+344>>2])*(y-v*(P*I+g*b+y*v))+((c*l-a*u+ +h[f+336>>2])*(P-I*(P*I+g*b+y*v))+(o*u-l*d+ +h[f+340>>2])*(g-b*(P*I+g*b+y*v))))*e/+h[p+(m*284|0)+212>>2];i=p+(m*284|0)+240|0;h[i>>2]=o;R=p+(m*284|0)+236|0;h[R>>2]=+h[R>>2]+o}h[i>>2]=o*.9900000095367432;m=m+1|0}while((m|0)!=(s|0));_=M;return}function w_(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,r=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0;C_(t,e+(i*284|0)|0,n);u=+h[e+(i*284|0)+52>>2];o=+h[e+(i*284|0)+56>>2];m=+h[e+(i*284|0)+60>>2];L=+h[e+(i*284|0)+76>>2];w=+h[e+(i*284|0)+72>>2];T=+h[e+(i*284|0)+68>>2];x=1.0/+G(+((w*-u-T*-o)*(w*-u-T*-o)+((L*-o-w*-m)*(L*-o-w*-m)+(T*-m-L*-u)*(T*-m-L*-u))));S=(L*-o-w*-m)*x;v=x*(T*-m-L*-u);x=x*(w*-u-T*-o);s=+h[e+(i*284|0)+232>>2]*.5;c=+X(+s)/+G(+(u*u+o*o+m*m));s=+H(+s);_=2.0/(s*s+(c*-m*(c*-m)+(c*-u*(c*-u)+c*-o*(c*-o))));I=1.0-(c*-o*(c*-o*_)+c*-m*(c*-m*_));R=c*-u*(c*-o*_)-s*(c*-m*_);P=c*-u*(c*-m*_)+s*(c*-o*_);E=c*-u*(c*-o*_)+s*(c*-m*_);A=1.0-(c*-u*(c*-u*_)+c*-m*(c*-m*_));M=c*-o*(c*-m*_)-s*(c*-u*_);l=c*-u*(c*-m*_)-s*(c*-o*_);s=c*-o*(c*-m*_)+s*(c*-u*_);_=1.0-(c*-u*(c*-u*_)+c*-o*(c*-o*_));c=+h[e+(i*284|0)+236>>2]*-.5;C=+X(+c)/+G(+(L*L+(w*w+T*T)));c=+H(+c);g=2.0/(c*c+(L*C*(L*C)+(T*C*(T*C)+w*C*(w*C))));d=1.0-(w*C*(w*C*g)+L*C*(L*C*g));a=T*C*(w*C*g)-c*(L*C*g);y=T*C*(L*C*g)+c*(w*C*g);p=T*C*(w*C*g)+c*(L*C*g);r=1.0-(T*C*(T*C*g)+L*C*(L*C*g));b=w*C*(L*C*g)-c*(T*C*g);f=T*C*(L*C*g)-c*(w*C*g);c=w*C*(L*C*g)+c*(T*C*g);g=1.0-(T*C*(T*C*g)+w*C*(w*C*g));C=+h[e+(i*284|0)+68>>2];w=+h[e+(i*284|0)+72>>2];T=+h[e+(i*284|0)+76>>2];h[e+(i*284|0)+92>>2]=T*(I*y+R*b+P*g)+(C*(P*f+(R*p+I*d))+w*(P*c+(I*a+R*r)));h[e+(i*284|0)+96>>2]=x*(I*y+R*b+P*g)+(S*(P*f+(R*p+I*d))+v*(P*c+(I*a+R*r)));h[e+(i*284|0)+100>>2]=(I*y+R*b+P*g)*-m+((P*f+(R*p+I*d))*-u+(P*c+(I*a+R*r))*-o);h[e+(i*284|0)+104>>2]=0.0;h[e+(i*284|0)+108>>2]=T*(E*y+A*b+M*g)+(C*(M*f+(A*p+E*d))+w*(M*c+(E*a+A*r)));h[e+(i*284|0)+112>>2]=x*(E*y+A*b+M*g)+(S*(M*f+(A*p+E*d))+v*(M*c+(E*a+A*r)));h[e+(i*284|0)+116>>2]=(E*y+A*b+M*g)*-m+((M*f+(A*p+E*d))*-u+(M*c+(E*a+A*r))*-o);h[e+(i*284|0)+120>>2]=0.0;h[e+(i*284|0)+124>>2]=T*(l*y+s*b+_*g)+(C*(_*f+(s*p+l*d))+w*(_*c+(l*a+s*r)));h[e+(i*284|0)+128>>2]=x*(l*y+s*b+_*g)+(S*(_*f+(s*p+l*d))+v*(_*c+(l*a+s*r)));h[e+(i*284|0)+132>>2]=(l*y+s*b+_*g)*-m+((_*f+(s*p+l*d))*-u+(_*c+(l*a+s*r))*-o);h[e+(i*284|0)+136>>2]=0.0;o=+h[e+(i*284|0)+32>>2];r=o*+h[e+(i*284|0)+56>>2]+ +h[e+(i*284|0)+40>>2];s=o*+h[e+(i*284|0)+60>>2]+ +h[e+(i*284|0)+44>>2];h[e+(i*284|0)+140>>2]=+h[e+(i*284|0)+52>>2]*o+ +h[e+(i*284|0)+36>>2];h[e+(i*284|0)+144>>2]=r;h[e+(i*284|0)+148>>2]=s;h[e+(i*284|0)+152>>2]=0.0;return}function C_(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0;o=_;_=_+64|0;n[e+84>>0]=0;r[o>>2]=r[t+4>>2];r[o+4>>2]=r[t+4+4>>2];r[o+8>>2]=r[t+4+8>>2];r[o+12>>2]=r[t+4+12>>2];r[o+16>>2]=r[t+20>>2];r[o+16+4>>2]=r[t+20+4>>2];r[o+16+8>>2]=r[t+20+8>>2];r[o+16+12>>2]=r[t+20+12>>2];r[o+32>>2]=r[t+36>>2];r[o+32+4>>2]=r[t+36+4>>2];r[o+32+8>>2]=r[t+36+8>>2];r[o+32+12>>2]=r[t+36+12>>2];r[o+48>>2]=r[t+52>>2];r[o+48+4>>2]=r[t+52+4>>2];r[o+48+8>>2]=r[t+52+8>>2];r[o+48+12>>2]=r[t+52+12>>2];if(i?(s=r[t+504>>2]|0,s|0):0)lk[r[(r[s>>2]|0)+8>>2]&127](s,o);x=+h[e+156>>2];v=+h[o>>2];S=+h[e+160>>2];y=+h[o+4>>2];p=+h[e+164>>2];b=+h[o+8>>2];g=+h[o+16>>2];m=+h[o+20>>2];f=+h[o+24>>2];d=+h[o+32>>2];c=+h[o+36>>2];a=+h[o+40>>2];u=x*g+S*m+p*f+ +h[o+52>>2];l=x*d+S*c+p*a+ +h[o+56>>2];h[e+36>>2]=x*v+S*y+p*b+ +h[o+48>>2];h[e+40>>2]=u;h[e+44>>2]=l;h[e+48>>2]=0.0;l=+h[e+172>>2];u=+h[e+176>>2];p=+h[e+180>>2];h[e+52>>2]=v*l+y*u+b*p;h[e+56>>2]=l*g+u*m+p*f;h[e+60>>2]=l*d+u*c+p*a;h[e+64>>2]=0.0;p=+h[e+188>>2];u=+h[e+192>>2];l=+h[e+196>>2];h[e+68>>2]=v*p+y*u+b*l;h[e+72>>2]=p*g+u*m+l*f;h[e+76>>2]=p*d+u*c+l*a;h[e+80>>2]=0.0;_=o;return}function T_(t,e){t=t|0;e=+e;var i=0,s=0.0,o=0,a=0,l=0,c=0.0,u=0.0,d=0,p=0,f=0,m=0.0,g=0,b=0,y=0.0,v=0.0,S=0.0,x=0.0,w=0,C=0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,W=0.0;g=_;_=_+144|0;p=r[t+128>>2]|0;if(!p){_=g;return}l=r[t+8>>2]|0;if((l|0)<(p|0)){if((r[t+12>>2]|0)<(p|0)){r[5637]=(r[5637]|0)+1;i=Zl((p<<4|3)+16|0)|0;if(!i)a=0;else{r[(i+4+15&-16)+-4>>2]=i;a=i+4+15&-16}i=r[t+8>>2]|0;if((i|0)>0){o=0;do{d=a+(o<<4)|0;b=(r[t+16>>2]|0)+(o<<4)|0;r[d>>2]=r[b>>2];r[d+4>>2]=r[b+4>>2];r[d+8>>2]=r[b+8>>2];r[d+12>>2]=r[b+12>>2];o=o+1|0}while((o|0)!=(i|0))}i=r[t+16>>2]|0;if(i|0){if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[t+16>>2]=0}n[t+20>>0]=1;r[t+16>>2]=a;r[t+12>>2]=p;o=t+16|0}else o=t+16|0;i=l;do{b=(r[o>>2]|0)+(i<<4)|0;r[b>>2]=r[g+80>>2];r[b+4>>2]=r[g+80+4>>2];r[b+8>>2]=r[g+80+8>>2];r[b+12>>2]=r[g+80+12>>2];i=i+1|0}while((i|0)!=(p|0))}r[t+8>>2]=p;l=r[t+28>>2]|0;if((l|0)<(p|0)){if((r[t+32>>2]|0)<(p|0)){r[5637]=(r[5637]|0)+1;i=Zl((p<<4|3)+16|0)|0;if(!i)a=0;else{r[(i+4+15&-16)+-4>>2]=i;a=i+4+15&-16}i=r[t+28>>2]|0;if((i|0)>0){o=0;do{b=a+(o<<4)|0;d=(r[t+36>>2]|0)+(o<<4)|0;r[b>>2]=r[d>>2];r[b+4>>2]=r[d+4>>2];r[b+8>>2]=r[d+8>>2];r[b+12>>2]=r[d+12>>2];o=o+1|0}while((o|0)!=(i|0))}i=r[t+36>>2]|0;if(i|0){if(n[t+40>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[t+36>>2]=0}n[t+40>>0]=1;r[t+36>>2]=a;r[t+32>>2]=p;o=t+36|0}else o=t+36|0;i=l;do{b=(r[o>>2]|0)+(i<<4)|0;r[b>>2]=r[g+64>>2];r[b+4>>2]=r[g+64+4>>2];r[b+8>>2]=r[g+64+8>>2];r[b+12>>2]=r[g+64+12>>2];i=i+1|0}while((i|0)!=(p|0))}r[t+28>>2]=p;d=r[t+48>>2]|0;if((d|0)<(p|0)){do{if((r[t+52>>2]|0)<(p|0)){r[5637]=(r[5637]|0)+1;i=Zl((p<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=r[t+48>>2]|0;a=r[t+56>>2]|0;if((o|0)<=0){if(!a){n[t+60>>0]=1;r[t+56>>2]=i;r[t+52>>2]=p;o=p<<2;break}}else{l=0;do{r[i+(l<<2)>>2]=r[a+(l<<2)>>2];l=l+1|0}while((l|0)!=(o|0))}if(n[t+60>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}n[t+60>>0]=1;r[t+56>>2]=i;r[t+52>>2]=p;o=p<<2}else{o=p<<2;i=r[t+56>>2]|0}}while(0);Ph(i+(d<<2)|0,0,o-(d<<2)|0)|0}r[t+48>>2]=p;d=r[t+68>>2]|0;if((d|0)<(p|0)){do{if((r[t+72>>2]|0)<(p|0)){r[5637]=(r[5637]|0)+1;i=Zl((p<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=r[t+68>>2]|0;a=r[t+76>>2]|0;if((o|0)<=0){if(!a){n[t+80>>0]=1;r[t+76>>2]=i;r[t+72>>2]=p;o=p<<2;break}}else{l=0;do{r[i+(l<<2)>>2]=r[a+(l<<2)>>2];l=l+1|0}while((l|0)!=(o|0))}if(n[t+80>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}n[t+80>>0]=1;r[t+76>>2]=i;r[t+72>>2]=p;o=p<<2}else{o=p<<2;i=r[t+76>>2]|0}}while(0);Ph(i+(d<<2)|0,0,o-(d<<2)|0)|0}r[t+68>>2]=p;i=r[t+128>>2]|0;if((i|0)<=0){_=g;return}o=r[t+76>>2]|0;a=r[t+56>>2]|0;l=0;do{h[o+(l<<2)>>2]=0.0;h[a+(l<<2)>>2]=0.0;l=l+1|0}while((l|0)!=(i|0));l=0;do{o=r[t+136>>2]|0;a=r[o+(l*284|0)+88>>2]|0;if(a){i=o+(l*284|0)+92|0;r[g+96>>2]=r[i>>2];r[g+96+4>>2]=r[i+4>>2];r[g+96+8>>2]=r[i+8>>2];r[g+96+12>>2]=r[i+12>>2];i=o+(l*284|0)+108|0;r[g+96+16>>2]=r[i>>2];r[g+96+16+4>>2]=r[i+4>>2];r[g+96+16+8>>2]=r[i+8>>2];r[g+96+16+12>>2]=r[i+12>>2];i=o+(l*284|0)+124|0;r[g+96+32>>2]=r[i>>2];r[g+96+32+4>>2]=r[i+4>>2];r[g+96+32+8>>2]=r[i+8>>2];r[g+96+32+12>>2]=r[i+12>>2];i=r[t+36>>2]|0;w=r[t+112>>2]|0;p=r[g+96+16+(w<<2)>>2]|0;C=r[g+96+32+(w<<2)>>2]|0;r[i+(l<<4)>>2]=r[g+96+(w<<2)>>2];r[i+(l<<4)+4>>2]=p;r[i+(l<<4)+8>>2]=C;h[i+(l<<4)+12>>2]=0.0;i=r[t+36>>2]|0;C=i+(l<<4)|0;T=+h[C>>2];p=o+(l*284|0)|0;s=+h[p>>2];w=i+(l<<4)+4|0;x=+h[w>>2];d=o+(l*284|0)+4|0;c=+h[d>>2];i=i+(l<<4)+8|0;y=+h[i>>2];b=o+(l*284|0)+8|0;S=+h[b>>2];u=T-s*(T*s+x*c+y*S);v=x-c*(T*s+x*c+y*S);S=y-S*(T*s+x*c+y*S);y=1.0/+G(+(u*u+v*v+S*S));h[C>>2]=u*y;h[w>>2]=v*y;h[i>>2]=S*y;i=r[t+16>>2]|0;c=+h[d>>2];x=+h[b>>2];s=+h[p>>2];h[i+(l<<4)>>2]=c*(S*y)-x*(v*y);h[i+(l<<4)+4>>2]=x*(u*y)-S*y*s;h[i+(l<<4)+8>>2]=v*y*s-c*(u*y);h[i+(l<<4)+12>>2]=0.0;i=r[t+16>>2]|0;p=i+(l<<4)|0;y=+h[p>>2];b=i+(l<<4)+4|0;u=+h[b>>2];i=i+(l<<4)+8|0;c=+h[i>>2];s=1.0/+G(+(y*y+u*u+c*c));h[p>>2]=y*s;h[b>>2]=u*s;h[i>>2]=c*s;i=r[t+108>>2]|0;b=r[t+36>>2]|0;s=+h[b+(l<<4)>>2];c=+h[b+(l<<4)+4>>2];u=+h[b+(l<<4)+8>>2];if(s*s+c*c+u*u>1.100000023841858)s=0.0;else{M=+h[o+(l*284|0)+16>>2];L=M-+h[i+52>>2];I=+h[o+(l*284|0)+20>>2];k=I-+h[i+56>>2];O=+h[o+(l*284|0)+24>>2];B=O-+h[i+60>>2];M=M-+h[a+52>>2];I=I-+h[a+56>>2];O=O-+h[a+60>>2];P=+h[i+356>>2];N=+h[i+360>>2];D=+h[i+352>>2];E=+h[a+356>>2];F=+h[a+360>>2];R=+h[a+352>>2];A=(u*k-c*B)*+h[i+4>>2]+(s*B-u*L)*+h[i+20>>2]+(c*L-s*k)*+h[i+36>>2];y=(u*k-c*B)*+h[i+8>>2]+(s*B-u*L)*+h[i+24>>2]+(c*L-s*k)*+h[i+40>>2];v=(u*k-c*B)*+h[i+12>>2]+(s*B-u*L)*+h[i+28>>2]+(c*L-s*k)*+h[i+44>>2];S=(I*-u-O*-c)*+h[a+4>>2]+(O*-s-M*-u)*+h[a+20>>2]+(M*-c-I*-s)*+h[a+36>>2];x=(I*-u-O*-c)*+h[a+8>>2]+(O*-s-M*-u)*+h[a+24>>2]+(M*-c-I*-s)*+h[a+40>>2];T=(I*-u-O*-c)*+h[a+12>>2]+(O*-s-M*-u)*+h[a+28>>2]+(M*-c-I*-s)*+h[a+44>>2];s=(s*(B*P-k*N+ +h[i+336>>2]-(O*E-I*F+ +h[a+336>>2]))+c*(+h[i+340>>2]+(L*N-B*D)-(+h[a+340>>2]+(M*F-O*R)))+u*(k*D-L*P+ +h[i+344>>2]-(I*R-M*E+ +h[a+344>>2])))*-.20000000298023224*(1.0/(+h[a+368>>2]+(+h[i+368>>2]+(A*(A*+h[i+420>>2])+y*(y*+h[i+424>>2])+v*(v*+h[i+428>>2])))+(S*(S*+h[a+420>>2])+x*(x*+h[a+424>>2])+T*(T*+h[a+428>>2]))))}h[(r[t+76>>2]|0)+(l<<2)>>2]=s;i=r[t+128>>2]|0}l=l+1|0}while((l|0)<(i|0));if((i|0)<=0){_=g;return}o=r[t+136>>2]|0;a=0;p=0;while(1){i=r[o+(p*284|0)+88>>2]|0;if(i){s=+h[o+(p*284|0)+252>>2];if(s!=0.0){l=o;s=s*e}else{N=+h[o+(p*284|0)+256>>2];N=N==0.0?0.0:N;l=r[t+108>>2]|0;C=r[t+16>>2]|0;L=+h[o+(p*284|0)+16>>2];I=+h[o+(p*284|0)+20>>2];A=+h[o+(p*284|0)+24>>2];x=+h[C+(p<<4)>>2];R=+h[C+(p<<4)+4>>2];s=+h[C+(p<<4)+8>>2];V=L-+h[l+52>>2];z=I-+h[l+56>>2];c=A-+h[l+60>>2];u=+h[l+288>>2]*(z*s-c*R)+ +h[l+304>>2]*(c*x-V*s)+(V*R-z*x)*+h[l+320>>2];W=(z*s-c*R)*+h[l+292>>2]+(c*x-V*s)*+h[l+308>>2]+(V*R-z*x)*+h[l+324>>2];U=(z*s-c*R)*+h[l+296>>2]+(c*x-V*s)*+h[l+312>>2]+(V*R-z*x)*+h[l+328>>2];F=L-+h[i+52>>2];k=I-+h[i+56>>2];M=A-+h[i+60>>2];S=(R*F-x*k)*+h[i+320>>2]+(+h[i+288>>2]*(s*k-R*M)+ +h[i+304>>2]*(x*M-s*F));y=(s*k-R*M)*+h[i+292>>2]+(x*M-s*F)*+h[i+308>>2]+(R*F-x*k)*+h[i+324>>2];v=(s*k-R*M)*+h[i+296>>2]+(x*M-s*F)*+h[i+312>>2]+(R*F-x*k)*+h[i+328>>2];L=L-+h[l+52>>2];I=I-+h[l+56>>2];A=A-+h[l+60>>2];D=+h[l+356>>2];T=+h[l+360>>2];P=+h[l+352>>2];B=+h[i+356>>2];E=+h[i+360>>2];O=+h[i+352>>2];s=-(1.0/(+h[l+368>>2]+(s*(z*u-V*W)+(x*(c*W-z*U)+R*(V*U-c*u)))+(+h[i+368>>2]+(s*(k*S-F*y)+(x*(M*y-k*v)+R*(F*v-M*S)))))*((A*D-I*T+ +h[l+336>>2]-(M*B-k*E+ +h[i+336>>2]))*x+(+h[l+340>>2]+(L*T-A*P)-(+h[i+340>>2]+(F*E-M*O)))*R+(I*P-L*D+ +h[l+344>>2]-(k*O-F*B+ +h[i+344>>2]))*s));s=N<s?N:s;l=r[t+136>>2]|0;s=s<-N?-N:s}d=r[t+56>>2]|0;C=d+(p<<2)|0;h[C>>2]=0.0;i=l+(p*284|0)+280|0;h[i>>2]=1.0;u=+h[o+(p*284|0)+276>>2]*e*+h[o+(p*284|0)+228>>2];h[C>>2]=s;s=s*.5;c=+h[(r[t+76>>2]|0)+(p<<2)>>2];if(s*s+c*c>u*u){W=u/+G(+(s*s+c*c));h[i>>2]=W*+h[i>>2];i=1}else i=a}else{d=r[t+56>>2]|0;h[d+(p<<2)>>2]=0.0;h[o+(p*284|0)+280>>2]=1.0;l=o;i=a}p=p+1|0;a=r[t+128>>2]|0;if((p|0)>=(a|0))break;else{o=l;a=i}}if(i){if((a|0)<=0){_=g;return}i=r[t+76>>2]|0;o=0;do{if(+h[i+(o<<2)>>2]!=0.0?(f=l+(o*284|0)+280|0,m=+h[f>>2],m<1.0):0){C=d+(o<<2)|0;h[C>>2]=m*+h[C>>2];C=(r[t+76>>2]|0)+(o<<2)|0;h[C>>2]=+h[f>>2]*+h[C>>2]}o=o+1|0}while((o|0)!=(a|0))}if((a|0)<=0){_=g;return}a=d;i=0;while(1){o=r[t+108>>2]|0;d=l+(i*284|0)+16|0;c=+h[d>>2]-+h[o+52>>2];p=l+(i*284|0)+20|0;u=+h[p>>2]-+h[o+56>>2];f=l+(i*284|0)+24|0;e=+h[f>>2]-+h[o+60>>2];h[g+96>>2]=c;h[g+96+4>>2]=u;h[g+96+8>>2]=e;h[g+96+12>>2]=0.0;s=+h[a+(i<<2)>>2];if(s!=0.0){C=r[t+16>>2]|0;z=s*+h[C+(i<<4)+4>>2];W=s*+h[C+(i<<4)+8>>2];h[g+16>>2]=s*+h[C+(i<<4)>>2];h[g+16+4>>2]=z;h[g+16+8>>2]=W;h[g+16+12>>2]=0.0;zE(o,g+16|0,g+96|0)}s=+h[(r[t+76>>2]|0)+(i<<2)>>2];if(s!=0.0){C=r[(r[t+136>>2]|0)+(i*284|0)+88>>2]|0;z=+h[p>>2]-+h[C+56>>2];V=+h[f>>2]-+h[C+60>>2];h[g+48>>2]=+h[d>>2]-+h[C+52>>2];h[g+48+4>>2]=z;h[g+48+8>>2]=V;h[g+48+12>>2]=0.0;w=r[t+36>>2]|0;V=+h[w+(i<<4)>>2]*s;z=s*+h[w+(i<<4)+4>>2];W=s*+h[w+(i<<4)+8>>2];h[g+32>>2]=V;h[g+32+4>>2]=z;h[g+32+8>>2]=W;h[g+32+12>>2]=0.0;w=r[t+108>>2]|0;b=r[t+116>>2]|0;F=+h[w+4+(b<<2)>>2];B=+h[w+20+(b<<2)>>2];N=+h[w+36+(b<<2)>>2];U=(F*c+B*u+N*e)*(1.0-+h[l+(i*284|0)+244>>2]);h[g+96>>2]=c-F*U;h[g+96+4>>2]=u-B*U;h[g+96+8>>2]=e-N*U;zE(w,g+32|0,g+96|0);h[g>>2]=-V;h[g+4>>2]=-z;h[g+8>>2]=-W;h[g+12>>2]=0.0;zE(C,g,g+48|0)}i=i+1|0;if((i|0)>=(r[t+128>>2]|0))break;l=r[t+136>>2]|0;a=r[t+56>>2]|0}_=g;return}function A_(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;r[t+112>>2]=e;r[t+116>>2]=i;r[t+120>>2]=n;return}function E_(t){t=t|0;return}function M_(t){t=t|0;Ql(t);return}function R_(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var o=0,a=0.0,l=0.0,c=0.0,u=0.0;o=_;_=_+96|0;h[o+4>>2]=1.0;r[o+8>>2]=0;s[o+12>>1]=1;s[o+14>>1]=-1;r[o+16>>2]=0;r[o>>2]=8008;r[o+20>>2]=r[e>>2];r[o+20+4>>2]=r[e+4>>2];r[o+20+8>>2]=r[e+8>>2];r[o+20+12>>2]=r[e+12>>2];r[o+36>>2]=r[i>>2];r[o+36+4>>2]=r[i+4>>2];r[o+36+8>>2]=r[i+8>>2];r[o+36+12>>2]=r[i+12>>2];t=r[t+4>>2]|0;jk[r[(r[t>>2]|0)+32>>2]&127](t,e,i,o);e=r[o+8>>2]|0;if(!e){n=0;_=o;return n|0}if(!(r[e+236>>2]&2)){n=0;_=o;return n|0}if(r[e+204>>2]&4|0){n=0;_=o;return n|0}r[n>>2]=r[o+68>>2];r[n+4>>2]=r[o+68+4>>2];r[n+8>>2]=r[o+68+8>>2];r[n+12>>2]=r[o+68+12>>2];r[n+16>>2]=r[o+52>>2];r[n+16+4>>2]=r[o+52+4>>2];r[n+16+8>>2]=r[o+52+8>>2];r[n+16+12>>2]=r[o+52+12>>2];u=+h[n+16>>2];c=+h[n+20>>2];l=+h[n+24>>2];a=1.0/+G(+(u*u+c*c+l*l));h[n+16>>2]=u*a;h[n+20>>2]=c*a;h[n+24>>2]=l*a;r[n+32>>2]=r[o+4>>2];n=e;_=o;return n|0}function I_(t){t=t|0;Ql(t);return}function P_(t,e){t=t|0;e=e|0;e=r[e+4>>2]|0;if(!((s[t+14>>1]&(e&65535))<<16>>16)){t=0;return t|0}t=(e>>>16&65535&s[t+12>>1])<<16>>16!=0;return t|0}function L_(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0;r[t+4>>2]=r[e+24>>2];n=r[e>>2]|0;r[t+8>>2]=n;if(i){r[t+52>>2]=r[e+8>>2];r[t+52+4>>2]=r[e+8+4>>2];r[t+52+8>>2]=r[e+8+8>>2];r[t+52+12>>2]=r[e+8+12>>2]}else{c=+h[e+8>>2];l=+h[e+12>>2];a=+h[e+16>>2];o=c*+h[n+20>>2]+l*+h[n+24>>2]+a*+h[n+28>>2];s=c*+h[n+36>>2]+l*+h[n+40>>2]+a*+h[n+44>>2];h[t+52>>2]=+h[n+4>>2]*c+ +h[n+8>>2]*l+ +h[n+12>>2]*a;h[t+56>>2]=o;h[t+60>>2]=s;h[t+64>>2]=0.0}c=+h[e+24>>2];h[t+68>>2]=(1.0-c)*+h[t+20>>2]+c*+h[t+36>>2];h[t+72>>2]=(1.0-c)*+h[t+24>>2]+c*+h[t+40>>2];h[t+76>>2]=(1.0-c)*+h[t+28>>2]+c*+h[t+44>>2];return+ +h[e+24>>2]}function D_(t,e,i,s,o,a,l,c){t=t|0;e=e|0;i=i|0;s=s|0;o=+o;a=+a;l=l|0;c=c|0;var u=0,d=0,p=0,f=0,m=0,g=0,b=0,y=0,v=0,S=0,x=0;x=_;_=_+288|0;r[x+208>>2]=r[e>>2];r[x+208+4>>2]=r[e+4>>2];r[x+208+8>>2]=r[e+8>>2];r[x+208+12>>2]=r[e+12>>2];d=x+208+16|0;r[d>>2]=r[i>>2];r[d+4>>2]=r[i+4>>2];r[d+8>>2]=r[i+8>>2];r[d+12>>2]=r[i+12>>2];p=x+208+32|0;r[p>>2]=r[s>>2];r[p+4>>2]=r[s+4>>2];r[p+8>>2]=r[s+8>>2];r[p+12>>2]=r[s+12>>2];g=r[l>>2]|0;y=r[l+4>>2]|0;v=r[l+8>>2]|0;S=r[l+16>>2]|0;m=r[l+12>>2]|0;f=r[l+20>>2]|0;r[x>>2]=r[x+208>>2];r[x+4>>2]=r[x+208+4>>2];r[x+8>>2]=r[x+208+8>>2];r[x+12>>2]=r[x+208+12>>2];r[x+16>>2]=r[d>>2];r[x+16+4>>2]=r[d+4>>2];r[x+16+8>>2]=r[d+8>>2];r[x+16+12>>2]=r[d+12>>2];r[x+32>>2]=r[p>>2];r[x+32+4>>2]=r[p+4>>2];r[x+32+8>>2]=r[p+8>>2];r[x+32+12>>2]=r[p+12>>2];s=r[t+128>>2]|0;if((s|0)==(r[t+132>>2]|0)?(b=s|0?s<<1:1,(s|0)<(b|0)):0){if(!b)e=0;else{r[5637]=(r[5637]|0)+1;e=Zl((b*284|3)+16|0)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}s=r[t+128>>2]|0}if((s|0)>0){l=0;do{i=r[t+136>>2]|0;u=e+(l*284|0)|0;d=i+(l*284|0)|0;p=u+92|0;do{r[u>>2]=r[d>>2];u=u+4|0;d=d+4|0}while((u|0)<(p|0));u=e+(l*284|0)+92|0;d=i+(l*284|0)+92|0;r[u>>2]=r[d>>2];r[u+4>>2]=r[d+4>>2];r[u+8>>2]=r[d+8>>2];r[u+12>>2]=r[d+12>>2];u=e+(l*284|0)+108|0;d=i+(l*284|0)+108|0;r[u>>2]=r[d>>2];r[u+4>>2]=r[d+4>>2];r[u+8>>2]=r[d+8>>2];r[u+12>>2]=r[d+12>>2];u=e+(l*284|0)+124|0;d=i+(l*284|0)+124|0;r[u>>2]=r[d>>2];r[u+4>>2]=r[d+4>>2];r[u+8>>2]=r[d+8>>2];r[u+12>>2]=r[d+12>>2];u=e+(l*284|0)+140|0;d=i+(l*284|0)+140|0;r[u>>2]=r[d>>2];r[u+4>>2]=r[d+4>>2];r[u+8>>2]=r[d+8>>2];r[u+12>>2]=r[d+12>>2];u=e+(l*284|0)+156|0;d=i+(l*284|0)+156|0;p=u+128|0;do{r[u>>2]=r[d>>2];u=u+4|0;d=d+4|0}while((u|0)<(p|0));l=l+1|0}while((l|0)!=(s|0))}s=r[t+136>>2]|0;if(s|0){if(n[t+140>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[t+136>>2]=0}n[t+140>>0]=1;r[t+136>>2]=e;r[t+132>>2]=b;s=r[t+128>>2]|0}e=r[t+136>>2]|0;u=e+(s*284|0)|0;d=x+48|0;p=u+92|0;do{r[u>>2]=r[d>>2];u=u+4|0;d=d+4|0}while((u|0)<(p|0));u=e+(s*284|0)+92|0;r[u>>2]=r[x+192>>2];r[u+4>>2]=r[x+192+4>>2];r[u+8>>2]=r[x+192+8>>2];r[u+12>>2]=r[x+192+12>>2];u=e+(s*284|0)+108|0;r[u>>2]=r[x+176>>2];r[u+4>>2]=r[x+176+4>>2];r[u+8>>2]=r[x+176+8>>2];r[u+12>>2]=r[x+176+12>>2];u=e+(s*284|0)+124|0;r[u>>2]=r[x+160>>2];r[u+4>>2]=r[x+160+4>>2];r[u+8>>2]=r[x+160+8>>2];r[u+12>>2]=r[x+160+12>>2];u=e+(s*284|0)+140|0;r[u>>2]=r[x+144>>2];r[u+4>>2]=r[x+144+4>>2];r[u+8>>2]=r[x+144+8>>2];r[u+12>>2]=r[x+144+12>>2];e=e+(s*284|0)+156|0;u=e;d=x;p=u+48|0;do{r[u>>2]=r[d>>2];u=u+4|0;d=d+4|0}while((u|0)<(p|0));h[e+48>>2]=o;r[e+52>>2]=m;h[e+56>>2]=a;r[e+60>>2]=g;r[e+64>>2]=y;r[e+68>>2]=v;r[e+72>>2]=S;h[e+76>>2]=0.0;h[e+80>>2]=0.0;h[e+84>>2]=0.0;h[e+88>>2]=.10000000149011612;r[e+92>>2]=f;h[e+96>>2]=0.0;h[e+100>>2]=0.0;n[e+104>>0]=c&1;u=e+105|0;d=x+256|0;p=u+23|0;do{n[u>>0]=n[d>>0]|0;u=u+1|0;d=d+1|0}while((u|0)<(p|0));c=r[t+128>>2]|0;r[t+128>>2]=c+1;c=(r[t+136>>2]|0)+(c*284|0)|0;C_(r[t+108>>2]|0,c,0);w_(r[t+108>>2]|0,r[t+136>>2]|0,(r[t+128>>2]|0)+-1|0,0);_=x;return c|0}function k_(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0,a=0,l=0,h=0;n=r[t+56>>2]|0;if(!n){n=r[t+52>>2]|0;if(!n){r[5637]=(r[5637]|0)+1;n=Zl(31)|0;if(!n)n=0;else{r[(n+4+15&-16)+-4>>2]=n;n=n+4+15&-16}s=r[t+60>>2]|0;r[n+4>>2]=s;o=n+8|0;r[o>>2]=0;r[5637]=(r[5637]|0)+1;s=Zl((s*24|3)+16|0)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}r[n>>2]=s;r[o>>2]=r[t+48>>2];r[t+48>>2]=n}else r[t+52>>2]=r[n+8>>2];a=r[n+4>>2]|0;n=r[n>>2]|0;if((a|0)>0){s=0;o=n;do{s=s+1|0;l=o;o=o+24|0;r[l>>2]=(s|0)<(a|0)?o:0}while((s|0)!=(a|0));l=n}else l=n}else l=n;r[t+56>>2]=r[l>>2];r[l>>2]=0;r[l+4>>2]=0;r[l+8>>2]=0;r[l+12>>2]=0;r[l+16>>2]=0;r[l+20>>2]=0;n=r[t+56>>2]|0;if(!n){n=r[t+52>>2]|0;if(!n){r[5637]=(r[5637]|0)+1;n=Zl(31)|0;if(!n)n=0;else{r[(n+4+15&-16)+-4>>2]=n;n=n+4+15&-16}s=r[t+60>>2]|0;r[n+4>>2]=s;o=n+8|0;r[o>>2]=0;r[5637]=(r[5637]|0)+1;s=Zl((s*24|3)+16|0)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}r[n>>2]=s;r[o>>2]=r[t+48>>2];r[t+48>>2]=n}else r[t+52>>2]=r[n+8>>2];a=r[n+4>>2]|0;n=r[n>>2]|0;if((a|0)>0){s=0;o=n;do{s=s+1|0;h=o;o=o+24|0;r[h>>2]=(s|0)<(a|0)?o:0}while((s|0)!=(a|0))}}r[t+56>>2]=r[n>>2];r[n>>2]=0;r[n+4>>2]=0;r[n+8>>2]=0;r[l+8>>2]=n;r[n+8>>2]=l;h=r[t+100>>2]|0;r[l+20>>2]=h;r[n+20>>2]=h;r[l+12>>2]=i;r[n+12>>2]=e;r[l+16>>2]=0;r[n+16>>2]=0;n=r[t+116>>2]|0;r[t+116>>2]=n+1;if((n|0)<(r[t+120>>2]|0))return l|0;r[t+120>>2]=n+1;return l|0}function O_(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0,a=0,l=0,h=0,c=0,u=0,d=0,p=0,f=0,m=0,g=0,b=0,y=0,v=0,S=0,x=0,w=0,C=0,T=0,A=0,E=0,M=0,R=0,I=0,L=0,D=0,k=0,O=0,F=0,B=0,N=0,U=0,V=0;F=_;_=_+144|0;t:do{switch(i-e|0){case 0:{r[n>>2]=0;r[n+4>>2]=0;r[n+8>>2]=0;r[n+12>>2]=0;_=F;return}case 2:{s=r[(r[t+92>>2]|0)+(e<<2)>>2]|0;h=r[s+88>>2]|0;c=r[s+200>>2]|0;l=r[s+92>>2]|0;o=r[s+204>>2]|0;if((h|0)==(c|0)){if((l|0)==(o|0))if((r[s+96>>2]|0)==(r[s+208>>2]|0))break t;else o=l;if((l|0)==(o|0)){k=(r[s+96>>2]|0)>(r[s+208>>2]|0);o=k?s+112|0:s;r[o>>2]=o;r[o+4>>2]=o;r[n>>2]=o;r[n+4>>2]=o;r[n+8>>2]=o;r[n+12>>2]=o;s=k?s:s+112|0}else{a=o;o=0;O=9}}else{a=o;o=(l|0)==(o|0);O=9}do{if((O|0)==9){r[s>>2]=s+112;r[s+4>>2]=s+112;r[s+112>>2]=s;r[s+116>>2]=s;O=(l|0)<(a|0);r[n>>2]=(h|0)<(c|0)|(h|0)==(c|0)&O?s:s+112|0;r[n+4>>2]=(h|0)<(c|0)|(h|0)==(c|0)&O?s+112|0:s;if(O|(h|0)<(c|0)&o){r[n+8>>2]=s;r[n+12>>2]=s+112;o=s;s=s+112|0;break}else{r[n+8>>2]=s+112;r[n+12>>2]=s;o=s;s=s+112|0;break}}}while(0);t=k_(t,o,s)|0;r[t>>2]=t;r[t+4>>2]=t;r[o+8>>2]=t;t=r[t+8>>2]|0;r[t>>2]=t;r[t+4>>2]=t;r[s+8>>2]=t;_=F;return}case 1:{s=r[(r[t+92>>2]|0)+(e<<2)>>2]|0;break}default:{d=((i-e|0)/2|0)+e|0;a=r[t+92>>2]|0;u=r[a+(d+-1<<2)>>2]|0;l=r[u+88>>2]|0;h=r[u+92>>2]|0;u=r[u+96>>2]|0;e:do{if((d|0)<(i|0)){s=d;do{o=r[a+(s<<2)>>2]|0;if((r[o+88>>2]|0)!=(l|0))break e;if((r[o+92>>2]|0)!=(h|0))break e;if((r[o+96>>2]|0)!=(u|0))break e;s=s+1|0}while((s|0)<(i|0))}else s=d}while(0);O_(t,e,d,n);r[F+96>>2]=0;r[F+96+4>>2]=0;r[F+96+8>>2]=0;r[F+96+12>>2]=0;O_(t,s,i,F+96|0);u=r[F+96+4>>2]|0;e:do{if(u|0){A=r[n+4>>2]|0;if(!A){r[n>>2]=r[F+96>>2];r[n+4>>2]=r[F+96+4>>2];r[n+8>>2]=r[F+96+8>>2];r[n+12>>2]=r[F+96+12>>2];break}r[t+100>>2]=(r[t+100>>2]|0)+-1;a=r[n+12>>2]|0;h=r[F+96+8>>2]|0;l=r[a+88>>2]|0;i:do{if((l|0)==(r[h+88>>2]|0)?(c=r[a+92>>2]|0,(c|0)==(r[h+92>>2]|0)):0){d=r[h+4>>2]|0;if((d|0)==(h|0)){s=r[h+8>>2]|0;if(s){h=r[s+12>>2]|0;c=r[h+92>>2]|0;l=r[h+88>>2]|0}o=a;L=h;s=h;d=l+1|0;i=r[h+96>>2]|0;break}a=r[h>>2]|0;r[d>>2]=a;r[a+4>>2]=d;n:do{if((h|0)==(r[F+96>>2]|0)){s=r[a+88>>2]|0;o=r[d+88>>2]|0;do{if((s|0)>=(o|0)){if((s|0)==(o|0)?(r[a+92>>2]|0)<(r[d+92>>2]|0):0)break;r[F+96>>2]=d;break n}}while(0);r[F+96>>2]=a}}while(0);if((h|0)==(u|0)){s=r[a+88>>2]|0;o=r[d+88>>2]|0;do{if((s|0)<=(o|0)){if((s|0)==(o|0)?(r[a+92>>2]|0)>(r[d+92>>2]|0):0)break;r[F+96+4>>2]=d;a=d;O=39;break i}}while(0);r[F+96+4>>2]=a;O=39}else{a=u;O=39}}else{a=u;O=39}}while(0);if((O|0)==39){x=r[n>>2]|0;w=r[F+96>>2]|0;C=0;T=1;e=A;o=0;s=a;l=0;while(1){h=r[s+88>>2]|0;i=r[e+88>>2]|0;c=et(h-i|0,T)|0;i:do{if((c|0)<=0){if((c|0)<0){S=(C|0)!=0;d=r[e+92>>2]|0;v=r[s+92>>2]|0;u=c;c=e;while(1){g=r[(S?s+4|0:s)>>2]|0;b=(g|0)==(s|0);y=s+88|0;m=u;while(1){u=c+88|0;p=v-d|0;if(!b?(E=r[g+88>>2]|0,M=et(E-h|0,T)|0,R=r[g+92>>2]|0,I=R-v|0,(I|0)>-1):0){if(!M)break;if((M|0)<0?(et(I,m)|0)<=(et(M,p)|0):0)break}f=r[(S?c+4|0:c)>>2]|0;if((f|0)==(c|0))break i;L=r[f+88>>2]|0;i=et(L-(r[u>>2]|0)|0,T)|0;e=r[f+92>>2]|0;u=e-d|0;h=r[y>>2]|0;d=m;m=et(h-L|0,T)|0;if(!((u|0)>0&(m|0)<0))break i;if(!i){d=e;c=f;continue}if((i|0)>=0)break i;if((et(u,d)|0)>=(et(i,p)|0))break i;else{d=e;c=f}}h=E;v=R;u=et(E-(r[u>>2]|0)|0,T)|0;s=g}}h=r[e+92>>2]|0;d=(C|0)!=0;n:do{if(d){u=e;while(1){c=r[u>>2]|0;if((c|0)==(e|0))break n;if((r[c+88>>2]|0)!=(i|0))break n;L=h;h=r[c+92>>2]|0;if((h|0)>(L|0))break;else u=c}}else{u=e;while(1){c=r[u+4>>2]|0;if((c|0)==(e|0))break n;if((r[c+88>>2]|0)!=(i|0))break n;L=h;h=r[c+92>>2]|0;if((h|0)>(L|0))break;else u=c}}}while(0);c=r[s+92>>2]|0;if(d){d=s;while(1){h=r[d+4>>2]|0;if((h|0)==(s|0)){c=u;s=d;break i}if((r[h+88>>2]|0)!=(i|0)){c=u;s=d;break i}L=c;c=r[h+92>>2]|0;if((c|0)<(L|0)){c=u;s=d;break}else d=h}}else{d=s;while(1){h=r[d>>2]|0;if((h|0)==(s|0)){c=u;s=d;break i}if((r[h+88>>2]|0)!=(i|0)){c=u;s=d;break i}L=c;c=r[h+92>>2]|0;if((c|0)<(L|0)){c=u;s=d;break}else d=h}}}else{v=(C|0)!=0;b=i;y=r[s+92>>2]|0;g=c;while(1){m=s+88|0;u=r[e+92>>2]|0;h=y-u|0;c=r[(v?e:e+4|0)>>2]|0;n:do{if((c|0)!=(e|0))if(v){f=b;p=u;i=g;while(1){u=f;f=r[c+88>>2]|0;u=et(f-u|0,T)|0;d=p;p=r[c+92>>2]|0;d=p-d|0;if((d|0)>=1){p=h;c=e;break n}if(u|0){if((u|0)>=0){p=h;c=e;break n}if((et(d,i)|0)>(et(u,h)|0)){p=h;c=e;break n}}d=et((r[m>>2]|0)-f|0,T)|0;h=y-p|0;u=r[c>>2]|0;if((u|0)==(c|0)){p=h;i=d;break}else{e=c;c=u;i=d}}}else{f=b;p=u;i=g;while(1){u=f;f=r[c+88>>2]|0;u=et(f-u|0,T)|0;d=p;p=r[c+92>>2]|0;d=p-d|0;if((d|0)>=1){p=h;c=e;break n}if(u|0){if((u|0)>=0){p=h;c=e;break n}if((et(d,i)|0)>(et(u,h)|0)){p=h;c=e;break n}}d=et((r[m>>2]|0)-f|0,T)|0;h=y-p|0;u=r[c+4>>2]|0;if((u|0)==(c|0)){p=h;i=d;break}else{e=c;c=u;i=d}}}else{p=h;i=g;c=e}}while(0);d=r[(v?s:s+4|0)>>2]|0;if((d|0)==(s|0))break i;g=r[d+88>>2]|0;h=et(g-(r[m>>2]|0)|0,T)|0;u=y;y=r[d+92>>2]|0;u=y-u|0;b=r[c+88>>2]|0;g=et(g-b|0,T)|0;if(!((u|0)<0&(g|0)>0))break i;if(!h){e=c;s=d;continue}if((h|0)>=0)break i;if((et(u,i)|0)>=(et(h,p)|0))break;else{e=c;s=d}}}}while(0);h=(C|0)==0;l=h?s:l;o=h?c:o;s=h?w:s;e=h?x:c;C=C+1|0;if((C|0)==2)break;else T=h?-1:T}r[e+4>>2]=s;r[s>>2]=e;r[o>>2]=l;r[l+4>>2]=o;if((r[w+88>>2]|0)<(r[x+88>>2]|0))r[n>>2]=w;if((r[a+88>>2]|0)>=(r[A+88>>2]|0))r[n+4>>2]=a;r[n+12>>2]=r[F+96+12>>2];a=o;I=l;b=r[l+88>>2]|0;i=r[o+88>>2]|0;y=r[l+92>>2]|0;v=r[o+92>>2]|0;S=r[l+96>>2]|0;e=r[o+96>>2]|0;x=((y-v|0)<0)<<31>>31;w=0-(b-i)|0;C=Rh(0,0,w|0,((w|0)<0)<<31>>31|0)|0;C=Gh(S-e|0,((S-e|0)<0)<<31>>31|0,C|0,P|0)|0;T=P;A=Gh(S-e|0,((S-e|0)<0)<<31>>31|0,y-v|0,x|0)|0;E=P;p=Gh(b-i|0,((b-i|0)<0)<<31>>31|0,w|0,((w|0)<0)<<31>>31|0)|0;R=P;M=Gh(y-v|0,x|0,y-v|0,x|0)|0;M=Rh(p|0,R|0,M|0,P|0)|0;R=P;p=r[o+8>>2]|0;r[F+120>>2]=0;if(!p)f=0;else{f=Rh(0,0,y-v|0,x|0)|0;m=P;s=0;g=p;while(1){u=r[g+12>>2]|0;h=r[u+88>>2]|0;c=r[u+92>>2]|0;u=r[u+96>>2]|0;d=Gh(c-v|0,((c-v|0)<0)<<31>>31|0,w|0,((w|0)<0)<<31>>31|0)|0;L=P;n=Gh(h-i|0,((h-i|0)<0)<<31>>31|0,f|0,m|0)|0;i:do{if((d|0)==(n|0)&(L|0)==(P|0)?(n=Gh(h-i|0,((h-i|0)<0)<<31>>31|0,C|0,T|0)|0,d=P,L=Gh(c-v|0,((c-v|0)<0)<<31>>31|0,A|0,E|0)|0,d=Ih(L|0,P|0,n|0,d|0)|0,n=P,L=Gh(u-e|0,((u-e|0)<0)<<31>>31|0,M|0,R|0)|0,L=Ih(d|0,n|0,L|0,P|0)|0,n=P,(n|0)>0|(n|0)==0&L>>>0>0):0){do{if(s|0){d=(r[s+4>>2]|0)==(g|0);if((r[s>>2]|0)!=(g|0))if(d)break;else break i;if(!d)break i;n=r[s+12>>2]|0;B=r[(r[g+8>>2]|0)+12>>2]|0;L=r[B+88>>2]|0;d=r[B+92>>2]|0;B=r[B+96>>2]|0;N=(r[n+96>>2]|0)-B|0;d=(et(u-B|0,(r[n+92>>2]|0)-d|0)|0)-(et(N,c-d|0)|0)|0;L=(et(N,h-L|0)|0)-(et(u-B|0,(r[n+88>>2]|0)-L|0)|0)|0;d=Gh(d|0,((d|0)<0)<<31>>31|0,y-v|0,x|0)|0;n=P;L=Gh(L|0,((L|0)<0)<<31>>31|0,w|0,((w|0)<0)<<31>>31|0)|0;L=Ih(d|0,n|0,L|0,P|0)|0;n=P;if((n|0)>0|(n|0)==0&L>>>0>0)break i}}while(0);r[F+120>>2]=g;s=g}}while(0);g=r[g>>2]|0;if((g|0)==(p|0)){f=s;break}}}d=r[l+8>>2]|0;r[F+72>>2]=0;if(!d)s=0;else{i=Rh(0,0,y-v|0,x|0)|0;e=P;s=0;p=d;do{u=r[p+12>>2]|0;h=r[u+88>>2]|0;c=r[u+92>>2]|0;u=r[u+96>>2]|0;L=Gh(c-y|0,((c-y|0)<0)<<31>>31|0,w|0,((w|0)<0)<<31>>31|0)|0;N=P;B=Gh(h-b|0,((h-b|0)<0)<<31>>31|0,i|0,e|0)|0;do{if((L|0)==(B|0)&(N|0)==(P|0)?(B=Gh(h-b|0,((h-b|0)<0)<<31>>31|0,C|0,T|0)|0,L=P,N=Gh(c-y|0,((c-y|0)<0)<<31>>31|0,A|0,E|0)|0,L=Ih(N|0,P|0,B|0,L|0)|0,B=P,N=Gh(u-S|0,((u-S|0)<0)<<31>>31|0,M|0,R|0)|0,N=Ih(L|0,B|0,N|0,P|0)|0,B=P,(B|0)>0|(B|0)==0&N>>>0>0):0){if(s|0){if((r[s>>2]|0)!=(p|0))break;if((r[s+4>>2]|0)==(p|0)?(B=r[s+12>>2]|0,n=r[(r[p+8>>2]|0)+12>>2]|0,N=r[n+88>>2]|0,L=r[n+92>>2]|0,n=r[n+96>>2]|0,g=(r[B+96>>2]|0)-n|0,L=(et(u-n|0,(r[B+92>>2]|0)-L|0)|0)-(et(g,c-L|0)|0)|0,N=(et(g,h-N|0)|0)-(et(u-n|0,(r[B+88>>2]|0)-N|0)|0)|0,L=Gh(L|0,((L|0)<0)<<31>>31|0,y-v|0,x|0)|0,B=P,N=Gh(N|0,((N|0)<0)<<31>>31|0,w|0,((w|0)<0)<<31>>31|0)|0,N=Ih(L|0,B|0,N|0,P|0)|0,B=P,!((B|0)>0|(B|0)==0&N>>>0>0)):0)break}r[F+72>>2]=p;s=p}}while(0);p=r[p>>2]|0}while((p|0)!=(d|0))}if((f|0)!=0|(s|0)!=0){F_(t,o,l,F+120|0,F+72|0);s=r[F+120>>2]|0;if(s){a=r[s+12>>2]|0;o=a}s=r[F+72>>2]|0;if(!s)s=I;else{s=r[s+12>>2]|0;l=s}}else s=I;L=l;d=r[l+88>>2]|0;i=(r[l+96>>2]|0)+1|0;c=r[l+92>>2]|0}x=L;w=o;l=0;M=0;n=1;h=0;u=0;C=0;A=0;E=d;p=i;I=0;d=0;while(1){T=w+88|0;v=(r[x+88>>2]|0)-(r[T>>2]|0)|0;N=w+92|0;R=(r[x+92>>2]|0)-(r[N>>2]|0)|0;y=w+96|0;g=(r[x+96>>2]|0)-(r[y>>2]|0)|0;r[F+120>>2]=v;r[F+120+4>>2]=R;r[F+120+8>>2]=g;r[F+120+12>>2]=-1;T=E-(r[T>>2]|0)|0;N=c-(r[N>>2]|0)|0;y=p-(r[y>>2]|0)|0;b=(et(g,N)|0)-(et(R,y)|0)|0;y=(et(v,y)|0)-(et(g,T)|0)|0;N=(et(R,T)|0)-(et(v,N)|0)|0;r[F+72>>2]=b;r[F+72+4>>2]=((b|0)<0)<<31>>31;r[F+72+8>>2]=y;r[F+72+8+4>>2]=((y|0)<0)<<31>>31;r[F+72+16>>2]=N;r[F+72+16+4>>2]=((N|0)<0)<<31>>31;T=Gh(R|0,((R|0)<0)<<31>>31|0,N|0,((N|0)<0)<<31>>31|0)|0;B=P;S=Gh(g|0,((g|0)<0)<<31>>31|0,y|0,((y|0)<0)<<31>>31|0)|0;S=Rh(T|0,B|0,S|0,P|0)|0;B=P;g=Gh(b|0,((b|0)<0)<<31>>31|0,g|0,((g|0)<0)<<31>>31|0)|0;T=P;N=Gh(v|0,((v|0)<0)<<31>>31|0,N|0,((N|0)<0)<<31>>31|0)|0;N=Rh(g|0,T|0,N|0,P|0)|0;T=P;y=Gh(v|0,((v|0)<0)<<31>>31|0,y|0,((y|0)<0)<<31>>31|0)|0;v=P;R=Gh(b|0,((b|0)<0)<<31>>31|0,R|0,((R|0)<0)<<31>>31|0)|0;R=Rh(y|0,v|0,R|0,P|0)|0;r[F+48>>2]=S;r[F+48+4>>2]=B;r[F+48+8>>2]=N;r[F+48+8+4>>2]=T;r[F+48+16>>2]=R;r[F+48+16+4>>2]=P;r[F+24>>2]=0;r[F+24+4>>2]=0;r[F+24+8>>2]=0;r[F+24+12>>2]=0;r[F+24+16>>2]=0;R=B_(t,0,w,F+120|0,F+72|0,F+48|0,F+24|0)|0;r[F>>2]=0;r[F+4>>2]=0;r[F+8>>2]=0;r[F+12>>2]=0;r[F+16>>2]=0;T=B_(t,1,x,F+120|0,F+72|0,F+48|0,F)|0;do{if((R|0)!=0|(T|0)!=0){i=R|0?-1:1;do{if((R|0)!=0&(T|0)!=0){S=r[F+24+16>>2]|0;i=r[F+16>>2]|0;if((S|0)!=(i|0)){v=S-i|0;break}if(!S)v=0;else{N=r[F+24>>2]|0;y=r[F+24+4>>2]|0;f=r[F+8>>2]|0;U=r[F+8+4>>2]|0;e=Gh(f|0,0,N|0,0)|0;i=P;N=Gh(U|0,0,N|0,0)|0;B=P;f=Gh(f|0,0,y|0,0)|0;m=P;y=Gh(U|0,0,y|0,0)|0;U=P;f=Ih(N|0,0,f|0,0)|0;N=P;U=Ih(B|0,0,y|0,U|0)|0;m=Ih(U|0,P|0,m|0,0)|0;N=Ih(m|0,P|0,N|0,0)|0;m=P;i=Ih(0,f|0,e|0,i|0)|0;e=P;f=Ih(N|0,m|0,(e>>>0<f>>>0|(e|0)==(f|0)&i>>>0<0)&1|0,0)|0;m=P;N=r[F+24+8>>2]|0;U=r[F+24+8+4>>2]|0;y=r[F>>2]|0;B=r[F+4>>2]|0;b=Gh(y|0,0,N|0,0)|0;g=P;N=Gh(B|0,0,N|0,0)|0;V=P;y=Gh(y|0,0,U|0,0)|0;v=P;U=Gh(B|0,0,U|0,0)|0;B=P;y=Ih(N|0,0,y|0,0)|0;N=P;B=Ih(V|0,0,U|0,B|0)|0;v=Ih(B|0,P|0,v|0,0)|0;N=Ih(v|0,P|0,N|0,0)|0;v=P;g=Ih(0,y|0,b|0,g|0)|0;b=P;y=Ih(N|0,v|0,(b>>>0<y>>>0|(b|0)==(y|0)&g>>>0<0)&1|0,0)|0;v=P;if(!(m>>>0<v>>>0|(m|0)==(v|0)&f>>>0<y>>>0))if(!(m>>>0>v>>>0|(m|0)==(v|0)&f>>>0>y>>>0))if(e>>>0<b>>>0|(e|0)==(b|0)&i>>>0<g>>>0)i=-1;else i=(e>>>0>b>>>0|(e|0)==(b|0)&i>>>0>g>>>0)&1;else i=1;else i=-1;v=et(i,S)|0}}else v=i}while(0);do{if(!n)if((v|0)>-1)if((r[F+16>>2]|0)<0&((r[F+8>>2]|0)==0?(r[F+8+4>>2]|0)==0:0)){e=C;y=A;break}else{O=136;break}else if((r[F+24+16>>2]|0)<0&((r[F+24+8>>2]|0)==0?(r[F+24+8+4>>2]|0)==0:0)){e=C;y=A;break}else{O=136;break}else O=136}while(0);if((O|0)==136){O=0;e=k_(t,w,x)|0;if(!C)h=e;else r[C+4>>2]=e;r[e>>2]=C;i=r[e+8>>2]|0;if(!A)u=i;else r[A>>2]=i;r[i+4>>2]=A;y=i}r[F+116>>2]=R;r[F+112>>2]=T;if(!v){F_(t,a,s,F+116|0,F+112|0);b=r[F+112>>2]|0}else b=T;if((v|0)>-1&(b|0)!=0){g=(d|0)!=0;if(g?(D=r[d>>2]|0,(D|0)!=(T|0)):0){f=D;do{m=f;f=r[f>>2]|0;p=r[m+8>>2]|0;i=r[p+12>>2]|0;if((f|0)==(m|0))c=0;else{r[f+4>>2]=r[m+4>>2];r[r[m+4>>2]>>2]=f;c=f}r[i+8>>2]=c;c=r[p>>2]|0;i=r[m+12>>2]|0;if((c|0)==(p|0))c=0;else{r[c+4>>2]=r[p+4>>2];r[r[p+4>>2]>>2]=c}r[i+8>>2]=c;r[m>>2]=0;r[m+4>>2]=0;r[m+8>>2]=0;r[m+12>>2]=0;r[m+16>>2]=0;r[m>>2]=r[t+56>>2];r[t+56>>2]=m;r[p>>2]=0;r[p+4>>2]=0;r[p+8>>2]=0;r[p+12>>2]=0;r[p+16>>2]=0;r[p>>2]=r[t+56>>2];r[t+56>>2]=p;r[t+116>>2]=(r[t+116>>2]|0)+-1}while((f|0)!=(T|0))}if(!y){d=b;c=g?M:T}else{if(g){r[d>>2]=u;i=T+4|0;c=M}else{d=r[T+4>>2]|0;r[d>>2]=u;i=T+4|0;c=u}r[u+4>>2]=d;r[y>>2]=T;r[i>>2]=y;d=r[F+112>>2]|0;u=0}C=s;s=r[d+12>>2]|0;M=c;y=0;i=r[C+88>>2]|0;p=r[C+96>>2]|0;c=r[C+92>>2]|0;C=r[d+8>>2]|0}else{i=E;C=d}b=r[F+116>>2]|0;if((v|0)<1&(b|0)!=0){g=(I|0)!=0;if(g?(k=r[I+4>>2]|0,(k|0)!=(R|0)):0){f=k;do{d=f+4|0;m=f;f=r[d>>2]|0;c=r[m>>2]|0;p=r[m+8>>2]|0;i=r[p+12>>2]|0;if((c|0)==(m|0))c=0;else{r[c+4>>2]=f;r[r[d>>2]>>2]=c}r[i+8>>2]=c;c=r[p>>2]|0;d=r[m+12>>2]|0;if((c|0)==(p|0))c=0;else{r[c+4>>2]=r[p+4>>2];r[r[p+4>>2]>>2]=c}r[d+8>>2]=c;r[m>>2]=0;r[m+4>>2]=0;r[m+8>>2]=0;r[m+12>>2]=0;r[m+16>>2]=0;r[m>>2]=r[t+56>>2];r[t+56>>2]=m;r[p>>2]=0;r[p+4>>2]=0;r[p+8>>2]=0;r[p+12>>2]=0;r[p+16>>2]=0;r[p>>2]=r[t+56>>2];r[t+56>>2]=p;r[t+116>>2]=(r[t+116>>2]|0)+-1}while((f|0)!=(R|0))}if(!e){d=b;l=g?l:R}else{if(g){r[I+4>>2]=h;d=R;c=I}else{c=r[R>>2]|0;r[c+4>>2]=h;d=R;l=h}r[h>>2]=c;r[d>>2]=e;r[e+4>>2]=R;d=r[F+116>>2]|0;h=0}c=a;a=r[d+12>>2]|0;v=0;x=r[c+88>>2]|0;w=r[c+96>>2]|0;c=r[c+92>>2]|0;S=r[d+8>>2]|0}else{v=e;x=i;w=p;S=I}if((a|0)==(o|0)&(s|0)==(L|0)){if(S){g=S+4|0;d=r[g>>2]|0;if((d|0)!=(l|0))do{e=d+4|0;m=d;d=r[e>>2]|0;i=r[m>>2]|0;f=r[m+8>>2]|0;p=r[f+12>>2]|0;if((i|0)==(m|0))i=0;else{r[i+4>>2]=d;r[r[e>>2]>>2]=i}r[p+8>>2]=i;i=r[f>>2]|0;e=r[m+12>>2]|0;if((i|0)==(f|0))i=0;else{r[i+4>>2]=r[f+4>>2];r[r[f+4>>2]>>2]=i}r[e+8>>2]=i;r[m>>2]=0;r[m+4>>2]=0;r[m+8>>2]=0;r[m+12>>2]=0;r[m+16>>2]=0;r[m>>2]=r[t+56>>2];r[t+56>>2]=m;r[f>>2]=0;r[f+4>>2]=0;r[f+8>>2]=0;r[f+12>>2]=0;r[f+16>>2]=0;r[f>>2]=r[t+56>>2];r[t+56>>2]=f;r[t+116>>2]=(r[t+116>>2]|0)+-1}while((d|0)!=(l|0));if(v|0){r[h>>2]=S;r[g>>2]=h;r[l>>2]=v;r[v+4>>2]=l}}else{r[h>>2]=v;r[v+4>>2]=h;r[a+8>>2]=v}if(!C){r[y>>2]=u;r[u+4>>2]=y;r[L+8>>2]=y;b=0;m=M;g=n;f=v;e=x;p=w;i=S;d=0;break}d=r[C>>2]|0;if((d|0)!=(M|0))do{f=d;d=r[d>>2]|0;p=r[f+8>>2]|0;e=r[p+12>>2]|0;if((d|0)==(f|0))i=0;else{r[d+4>>2]=r[f+4>>2];r[r[f+4>>2]>>2]=d;i=d}r[e+8>>2]=i;i=r[p>>2]|0;e=r[f+12>>2]|0;if((i|0)==(p|0))i=0;else{r[i+4>>2]=r[p+4>>2];r[r[p+4>>2]>>2]=i}r[e+8>>2]=i;r[f>>2]=0;r[f+4>>2]=0;r[f+8>>2]=0;r[f+12>>2]=0;r[f+16>>2]=0;r[f>>2]=r[t+56>>2];r[t+56>>2]=f;r[p>>2]=0;r[p+4>>2]=0;r[p+8>>2]=0;r[p+12>>2]=0;r[p+16>>2]=0;r[p>>2]=r[t+56>>2];r[t+56>>2]=p;r[t+116>>2]=(r[t+116>>2]|0)+-1}while((d|0)!=(M|0));if(!y){b=0;m=M;g=n;f=v;y=0;e=x;p=w;i=S;d=C}else{r[C>>2]=u;r[u+4>>2]=C;r[y>>2]=M;r[M+4>>2]=y;b=0;m=M;g=n;f=v;e=x;p=w;i=S;d=C}}else{b=1;m=M;g=0;f=v;e=x;p=w;i=S;d=C}}else{b=k_(t,w,x)|0;r[b>>2]=b;r[b+4>>2]=b;r[w+8>>2]=b;b=r[b+8>>2]|0;r[b>>2]=b;r[b+4>>2]=b;r[s+8>>2]=b;b=0;m=M;g=n;f=C;y=A;e=E;i=I}}while(0);if(!b)break e;x=s;w=a;M=m;n=g;C=f;A=y;E=e;I=i}}}while(0);_=F;return}}}while(0);r[s+8>>2]=0;r[s>>2]=s;r[s+4>>2]=s;r[n>>2]=s;r[n+4>>2]=s;r[n+8>>2]=s;r[n+12>>2]=s;_=F;return}function F_(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var o=0,a=0,l=0,h=0,c=0,_=0,u=0,d=0,p=0,f=0,m=0,g=0,b=0,y=0,v=0,S=0,x=0,w=0,C=0,T=0,A=0,E=0,M=0,R=0,I=0,L=0,D=0,k=0,O=0,F=0,B=0,N=0,U=0,V=0,z=0,W=0,G=0,j=0,H=0,X=0,Y=0,q=0,K=0,Z=0,Q=0,$=0,J=0,tt=0,it=0,nt=0,st=0,rt=0,ot=0,at=0,lt=0,ht=0;X=r[n>>2]|0;rt=r[s>>2]|0;if(X|0)o=r[X+12>>2]|0;else o=e;l=r[o+88>>2]|0;h=r[o+92>>2]|0;a=r[o+96>>2]|0;if(!rt)o=i;else o=r[rt+12>>2]|0;b=r[o+88>>2]|0;d=r[o+92>>2]|0;f=r[o+96>>2]|0;$=r[e+88>>2]|0;nt=(r[i+88>>2]|0)-$|0;v=r[e+92>>2]|0;st=(r[i+92>>2]|0)-v|0;e=r[e+96>>2]|0;K=(r[i+96>>2]|0)-e|0;Q=r[(X|0?X:rt)+12>>2]|0;J=(r[Q+88>>2]|0)-$|0;H=(r[Q+92>>2]|0)-v|0;Q=(r[Q+96>>2]|0)-e|0;Z=(et(H,K)|0)-(et(Q,st)|0)|0;Q=(et(Q,nt)|0)-(et(J,K)|0)|0;H=(et(J,st)|0)-(et(H,nt)|0)|0;$=Gh(Z|0,((Z|0)<0)<<31>>31|0,$|0,(($|0)<0)<<31>>31|0)|0;J=P;v=Gh(Q|0,((Q|0)<0)<<31>>31|0,v|0,((v|0)<0)<<31>>31|0)|0;y=P;e=Gh(H|0,((H|0)<0)<<31>>31|0,e|0,((e|0)<0)<<31>>31|0)|0;e=Ih($|0,J|0,e|0,P|0)|0;y=Ih(e|0,P|0,v|0,y|0)|0;v=P;e=Gh(H|0,((H|0)<0)<<31>>31|0,st|0,((st|0)<0)<<31>>31|0)|0;J=P;$=Gh(Q|0,((Q|0)<0)<<31>>31|0,K|0,((K|0)<0)<<31>>31|0)|0;$=Rh(e|0,J|0,$|0,P|0)|0;J=P;e=Gh(Z|0,((Z|0)<0)<<31>>31|0,K|0,((K|0)<0)<<31>>31|0)|0;it=P;tt=Gh(H|0,((H|0)<0)<<31>>31|0,nt|0,((nt|0)<0)<<31>>31|0)|0;tt=Rh(e|0,it|0,tt|0,P|0)|0;it=P;e=Gh(Q|0,((Q|0)<0)<<31>>31|0,nt|0,((nt|0)<0)<<31>>31|0)|0;q=P;Y=Gh(Z|0,((Z|0)<0)<<31>>31|0,st|0,((st|0)<0)<<31>>31|0)|0;Y=Rh(e|0,q|0,Y|0,P|0)|0;q=P;e=Gh($|0,J|0,l|0,((l|0)<0)<<31>>31|0)|0;j=P;o=Gh(tt|0,it|0,h|0,((h|0)<0)<<31>>31|0)|0;j=Ih(o|0,P|0,e|0,j|0)|0;e=P;o=Gh(Y|0,q|0,a|0,((a|0)<0)<<31>>31|0)|0;o=Ih(j|0,e|0,o|0,P|0)|0;e=P;if((X|0)!=0?(r[X+12>>2]|0)!=0:0){g=X;m=l;p=h;u=a;while(1){g=r[(r[g+8>>2]|0)+4>>2]|0;h=g+12|0;l=r[h>>2]|0;i=r[l+88>>2]|0;G=Gh(i|0,((i|0)<0)<<31>>31|0,Z|0,((Z|0)<0)<<31>>31|0)|0;W=P;a=r[l+92>>2]|0;j=Gh(a|0,((a|0)<0)<<31>>31|0,Q|0,((Q|0)<0)<<31>>31|0)|0;W=Ih(j|0,P|0,G|0,W|0)|0;G=P;l=r[l+96>>2]|0;j=Gh(l|0,((l|0)<0)<<31>>31|0,H|0,((H|0)<0)<<31>>31|0)|0;j=Ih(W|0,G|0,j|0,P|0)|0;G=P;if((G|0)<(v|0)|(G|0)==(v|0)&j>>>0<y>>>0){i=m;l=p;a=u;break}if((r[g+20>>2]|0)==(r[t+100>>2]|0)){i=m;l=p;a=u;break}_=Gh(i|0,((i|0)<0)<<31>>31|0,$|0,J|0)|0;j=P;c=Gh(a|0,((a|0)<0)<<31>>31|0,tt|0,it|0)|0;j=Ih(c|0,P|0,_|0,j|0)|0;_=P;c=Gh(l|0,((l|0)<0)<<31>>31|0,Y|0,q|0)|0;c=Ih(j|0,_|0,c|0,P|0)|0;_=P;if(!((_|0)>(e|0)|(_|0)==(e|0)&c>>>0>o>>>0)){i=m;l=p;a=u;break}r[n>>2]=g;j=r[h>>2]|0;i=r[j+88>>2]|0;l=r[j+92>>2]|0;a=r[j+96>>2]|0;if(!j){o=c;e=_;break}else{e=_;o=c;m=i;p=l;u=a}}p=r[s>>2]|0;j=l}else{p=rt;i=l;j=h}h=Gh($|0,J|0,b|0,((b|0)<0)<<31>>31|0)|0;G=P;l=Gh(tt|0,it|0,d|0,((d|0)<0)<<31>>31|0)|0;G=Ih(l|0,P|0,h|0,G|0)|0;h=P;l=Gh(Y|0,q|0,f|0,((f|0)<0)<<31>>31|0)|0;l=Ih(G|0,h|0,l|0,P|0)|0;h=P;t:do{if(p)if(!(r[p+12>>2]|0))c=b;else{g=p;m=b;while(1){p=r[r[g+8>>2]>>2]|0;u=r[p+12>>2]|0;c=r[u+88>>2]|0;W=Gh(c|0,((c|0)<0)<<31>>31|0,Z|0,((Z|0)<0)<<31>>31|0)|0;z=P;_=r[u+92>>2]|0;G=Gh(_|0,((_|0)<0)<<31>>31|0,Q|0,((Q|0)<0)<<31>>31|0)|0;z=Ih(G|0,P|0,W|0,z|0)|0;W=P;u=r[u+96>>2]|0;G=Gh(u|0,((u|0)<0)<<31>>31|0,H|0,((H|0)<0)<<31>>31|0)|0;G=Ih(z|0,W|0,G|0,P|0)|0;W=P;if((W|0)<(v|0)|(W|0)==(v|0)&G>>>0<y>>>0){p=g;c=m;break t}if((r[p+20>>2]|0)==(r[t+100>>2]|0)){p=g;c=m;break t}G=Gh(c|0,((c|0)<0)<<31>>31|0,$|0,J|0)|0;W=P;_=Gh(_|0,((_|0)<0)<<31>>31|0,tt|0,it|0)|0;W=Ih(_|0,P|0,G|0,W|0)|0;G=P;_=Gh(u|0,((u|0)<0)<<31>>31|0,Y|0,q|0)|0;_=Ih(W|0,G|0,_|0,P|0)|0;u=P;if(!((u|0)>(h|0)|(u|0)==(h|0)&_>>>0>l>>>0)){p=g;c=m;break t}r[s>>2]=p;G=r[p+12>>2]|0;c=r[G+88>>2]|0;d=r[G+92>>2]|0;f=r[G+96>>2]|0;if(!G){l=_;h=u;break}else{g=p;h=u;l=_;m=c}}}else{p=0;c=b}}while(0);l=Rh(l|0,h|0,o|0,e|0)|0;e=P;if((e|0)>0|(e|0)==0&l>>>0>0){W=Rh(0,0,H|0,((H|0)<0)<<31>>31|0)|0;G=P;h=p;m=l;u=e;g=i;b=j;y=a;U=c;V=d;z=f;while(1){_=(et(V-b|0,st)|0)+(et(U-g|0,nt)|0)+(et(z-y|0,K)|0)|0;o=r[n>>2]|0;if(!o){R=_;M=_;E=((_|0)<0)<<31>>31;_=m;k=g;D=b;L=y}else{F=_;v=_;B=((_|0)<0)<<31>>31;_=m;D=g;k=b;O=y;t:while(1){if(!(r[o+12>>2]|0)){b=F;y=B;g=D;m=k;o=O;break}L=r[(r[o>>2]|0)+8>>2]|0;if((r[L+20>>2]|0)<=(r[t+100>>2]|0)){b=F;y=B;g=D;m=k;o=O;break}N=r[L+12>>2]|0;g=r[N+88>>2]|0;I=g-D|0;m=r[N+92>>2]|0;R=m-k|0;N=r[N+96>>2]|0;h=N-O|0;y=Gh(I|0,((I|0)<0)<<31>>31|0,$|0,J|0)|0;M=P;b=Gh(R|0,((R|0)<0)<<31>>31|0,tt|0,it|0)|0;M=Ih(b|0,P|0,y|0,M|0)|0;y=P;b=Gh(h|0,((h|0)<0)<<31>>31|0,Y|0,q|0)|0;b=Ih(M|0,y|0,b|0,P|0)|0;y=P;h=(et(R,st)|0)+(et(I,nt)|0)+(et(h,K)|0)|0;do{if((b|0)==0&(y|0)==0){if((h|0)>=0){b=F;y=B;g=D;m=k;o=O;break t}}else{if((y|0)>=0){b=F;y=B;g=D;m=k;o=O;break t}if((h|0)>0){x=1;w=h;S=((h|0)<0)<<31>>31}else{w=Rh(0,0,h|0,((h|0)<0)<<31>>31|0)|0;x=h>>31;w=(h|0)<0?w:0;S=(h|0)<0?P:0}I=0-x|0;A=Rh(0,0,b|0,y|0)|0;E=P;if((F|0)>0){h=1;M=v;R=B}else{R=(F|0)<0;M=Rh(0,0,v|0,B|0)|0;h=F>>31;M=R?M:0;R=R?P:0}if(!((u|0)>0|(u|0)==0&_>>>0>0))if((u|0)<0){b=Rh(0,0,_|0,u|0)|0;h=0-h|0;y=P}else{b=0;y=0}else{b=_;y=u}if((h|0)==(I|0)){if(!x)break;h=Gh(b|0,0,w|0,0)|0;x=P;ht=Gh(y|0,0,w|0,0)|0;lt=P;C=Gh(b|0,0,S|0,0)|0;T=P;at=Gh(y|0,0,S|0,0)|0;w=P;C=Ih(ht|0,0,C|0,0)|0;b=P;w=Ih(lt|0,0,at|0,w|0)|0;T=Ih(w|0,P|0,T|0,0)|0;b=Ih(T|0,P|0,b|0,0)|0;T=P;x=Ih(0,C|0,h|0,x|0)|0;w=P;C=Ih(b|0,T|0,(w>>>0<C>>>0|(w|0)==(C|0)&x>>>0<0)&1|0,0)|0;T=P;b=Gh(M|0,0,A|0,0)|0;h=P;at=Gh(R|0,0,A|0,0)|0;A=P;y=Gh(M|0,0,E|0,0)|0;S=P;E=Gh(R|0,0,E|0,0)|0;M=P;y=Ih(at|0,0,y|0,0)|0;R=P;M=Ih(A|0,0,E|0,M|0)|0;S=Ih(M|0,P|0,S|0,0)|0;R=Ih(S|0,P|0,R|0,0)|0;S=P;h=Ih(0,y|0,b|0,h|0)|0;b=P;y=Ih(R|0,S|0,(b>>>0<y>>>0|(b|0)==(y|0)&h>>>0<0)&1|0,0)|0;S=P;do{if(T>>>0<S>>>0|(T|0)==(S|0)&C>>>0<y>>>0)h=-1;else{if(T>>>0>S>>>0|(T|0)==(S|0)&C>>>0>y>>>0){h=1;break}if(w>>>0<b>>>0|(w|0)==(b|0)&x>>>0<h>>>0){h=-1;break}h=(w>>>0>b>>>0|(w|0)==(b|0)&x>>>0>h>>>0)&1}}while(0);h=et(h,I)|0}else h=I-h|0;if((h|0)<=-1){b=F;y=B;g=D;m=k;o=O;break t}}}while(0);ht=U-g|0;lt=V-m|0;h=z-N|0;u=Gh(ht|0,((ht|0)<0)<<31>>31|0,$|0,J|0)|0;at=P;_=Gh(lt|0,((lt|0)<0)<<31>>31|0,tt|0,it|0)|0;at=Ih(_|0,P|0,u|0,at|0)|0;u=P;_=Gh(h|0,((h|0)<0)<<31>>31|0,Y|0,q|0)|0;_=Ih(at|0,u|0,_|0,P|0)|0;u=P;o=(o|0)==(X|0)?0:L;r[n>>2]=o;h=(et(lt,st)|0)+(et(ht,nt)|0)+(et(h,K)|0)|0;if(!o){b=h;v=h;y=((h|0)<0)<<31>>31;o=N;break}else{F=h;v=h;B=((h|0)<0)<<31>>31;D=g;k=m;O=N}}R=b;h=r[s>>2]|0;M=v;E=y;k=g;D=m;L=o}if(!h){o=122;break}if(!(r[h+12>>2]|0)){o=122;break}I=r[r[h+8>>2]>>2]|0;if((r[I+20>>2]|0)<=(r[t+100>>2]|0)){o=122;break}g=r[I+12>>2]|0;y=r[g+88>>2]|0;m=y-U|0;b=r[g+92>>2]|0;h=b-V|0;g=r[g+96>>2]|0;o=g-z|0;ht=Gh(m|0,((m|0)<0)<<31>>31|0,Z|0,((Z|0)<0)<<31>>31|0)|0;at=P;lt=Gh(h|0,((h|0)<0)<<31>>31|0,Q|0,((Q|0)<0)<<31>>31|0)|0;at=Ih(lt|0,P|0,ht|0,at|0)|0;ht=P;lt=Gh(o|0,((o|0)<0)<<31>>31|0,W|0,G|0)|0;if(!((at|0)==(lt|0)&(ht|0)==(P|0))){o=122;break}S=Gh(m|0,((m|0)<0)<<31>>31|0,$|0,J|0)|0;A=P;v=Gh(h|0,((h|0)<0)<<31>>31|0,tt|0,it|0)|0;A=Ih(v|0,P|0,S|0,A|0)|0;S=P;v=Gh(o|0,((o|0)<0)<<31>>31|0,Y|0,q|0)|0;v=Ih(A|0,S|0,v|0,P|0)|0;S=P;o=(et(h,st)|0)+(et(m,nt)|0)+(et(o,K)|0)|0;A=y-k|0;lt=b-D|0;T=g-L|0;A=Gh(A|0,((A|0)<0)<<31>>31|0,$|0,J|0)|0;ht=P;lt=Gh(lt|0,((lt|0)<0)<<31>>31|0,tt|0,it|0)|0;ht=Ih(lt|0,P|0,A|0,ht|0)|0;A=P;T=Gh(T|0,((T|0)<0)<<31>>31|0,Y|0,q|0)|0;T=Ih(ht|0,A|0,T|0,P|0)|0;A=P;if(!((A|0)>0|(A|0)==0&T>>>0>0)){o=122;break}if((v|0)==0&(S|0)==0){if((o|0)>=0){o=122;break}}else{if((S|0)>=0){o=122;break}if((o|0)>0){g=1;b=o;m=((o|0)<0)<<31>>31}else{b=Rh(0,0,o|0,((o|0)<0)<<31>>31|0)|0;g=o>>31;b=(o|0)<0?b:0;m=(o|0)<0?P:0}C=0-g|0;x=Rh(0,0,v|0,S|0)|0;w=P;if((R|0)>0){o=1;S=M;v=E}else{v=(R|0)<0;S=Rh(0,0,M|0,E|0)|0;o=R>>31;S=v?S:0;v=v?P:0}do{if((u|0)>0|(u|0)==0&_>>>0>0){h=o;o=u}else{if((u|0)>=0){h=o;_=0;o=0;break}_=Rh(0,0,_|0,u|0)|0;h=0-o|0;o=P}}while(0);if((h|0)==(C|0)){if(!g){o=122;break}ht=Gh(_|0,0,b|0,0)|0;g=P;h=Gh(o|0,0,b|0,0)|0;z=P;b=Gh(_|0,0,m|0,0)|0;y=P;o=Gh(o|0,0,m|0,0)|0;m=P;b=Ih(h|0,0,b|0,0)|0;h=P;m=Ih(z|0,0,o|0,m|0)|0;y=Ih(m|0,P|0,y|0,0)|0;h=Ih(y|0,P|0,h|0,0)|0;y=P;m=Ih(0,b|0,ht|0,g|0)|0;g=P;b=Ih(h|0,y|0,(g>>>0<b>>>0|(g|0)==(b|0)&m>>>0<0)&1|0,0)|0;y=P;h=Gh(S|0,0,x|0,0)|0;o=P;ht=Gh(v|0,0,x|0,0)|0;z=P;_=Gh(S|0,0,w|0,0)|0;u=P;at=Gh(v|0,0,w|0,0)|0;lt=P;_=Ih(ht|0,0,_|0,0)|0;ht=P;lt=Ih(z|0,0,at|0,lt|0)|0;u=Ih(lt|0,P|0,u|0,0)|0;ht=Ih(u|0,P|0,ht|0,0)|0;u=P;o=Ih(0,_|0,h|0,o|0)|0;h=P;_=Ih(ht|0,u|0,(h>>>0<_>>>0|(h|0)==(_|0)&o>>>0<0)&1|0,0)|0;u=P;do{if(y>>>0<u>>>0|(y|0)==(u|0)&b>>>0<_>>>0)o=-1;else{if(y>>>0>u>>>0|(y|0)==(u|0)&b>>>0>_>>>0){o=1;break}if(g>>>0<h>>>0|(g|0)==(h|0)&m>>>0<o>>>0){o=-1;break}o=(g>>>0>h>>>0|(g|0)==(h|0)&m>>>0>o>>>0)&1}}while(0);o=et(o,C)|0}else o=C-h|0;if((o|0)<=0){o=122;break}}r[s>>2]=I;z=r[I+12>>2]|0;h=I;m=T;u=A;g=k;b=D;y=L;U=r[z+88>>2]|0;V=r[z+92>>2]|0;z=r[z+96>>2]|0}if((o|0)==122)return}if((e|0)>=0)return;I=Rh(0,0,H|0,((H|0)<0)<<31>>31|0)|0;L=P;o=j;R=c;t:while(1){M=e;E=l;T=o;e:while(1){A=(et(d-T|0,st)|0)+(et(R-i|0,nt)|0)+(et(f-a|0,K)|0)|0;do{if((p|0?r[p+12>>2]|0:0)?(ot=r[(r[p+4>>2]|0)+8>>2]|0,(r[ot+20>>2]|0)>(r[t+100>>2]|0)):0){C=r[ot+12>>2]|0;x=r[C+88>>2]|0;ht=x-R|0;w=r[C+92>>2]|0;lt=w-d|0;C=r[C+96>>2]|0;o=C-f|0;l=Gh(ht|0,((ht|0)<0)<<31>>31|0,$|0,J|0)|0;at=P;e=Gh(lt|0,((lt|0)<0)<<31>>31|0,tt|0,it|0)|0;at=Ih(e|0,P|0,l|0,at|0)|0;l=P;e=Gh(o|0,((o|0)<0)<<31>>31|0,Y|0,q|0)|0;e=Ih(at|0,l|0,e|0,P|0)|0;l=P;o=(et(lt,st)|0)+(et(ht,nt)|0)+(et(o,K)|0)|0;if((e|0)==0&(l|0)==0)if((o|0)>0)break e;else break;if((l|0)<0){if((o|0)>0){c=1;_=o;h=((o|0)<0)<<31>>31}else{_=Rh(0,0,o|0,((o|0)<0)<<31>>31|0)|0;c=o>>31;_=(o|0)<0?_:0;h=(o|0)<0?P:0}S=0-c|0;g=Rh(0,0,e|0,l|0)|0;b=P;if((A|0)>0){o=1;y=A;v=((A|0)<0)<<31>>31}else{y=Rh(0,0,A|0,((A|0)<0)<<31>>31|0)|0;o=A>>31;y=(A|0)<0?y:0;v=(A|0)<0?P:0}if(!((M|0)>0|(M|0)==0&E>>>0>0))if((M|0)<0){e=Rh(0,0,E|0,M|0)|0;o=0-o|0;l=P}else{e=0;l=0}else{e=E;l=M}if((o|0)==(S|0)){if(!c)break e;o=Gh(e|0,0,_|0,0)|0;c=P;at=Gh(l|0,0,_|0,0)|0;X=P;u=Gh(e|0,0,h|0,0)|0;m=P;ht=Gh(l|0,0,h|0,0)|0;_=P;u=Ih(at|0,0,u|0,0)|0;e=P;_=Ih(X|0,0,ht|0,_|0)|0;m=Ih(_|0,P|0,m|0,0)|0;e=Ih(m|0,P|0,e|0,0)|0;m=P;c=Ih(0,u|0,o|0,c|0)|0;_=P;u=Ih(e|0,m|0,(_>>>0<u>>>0|(_|0)==(u|0)&c>>>0<0)&1|0,0)|0;m=P;e=Gh(y|0,0,g|0,0)|0;o=P;ht=Gh(v|0,0,g|0,0)|0;X=P;l=Gh(y|0,0,b|0,0)|0;h=P;at=Gh(v|0,0,b|0,0)|0;lt=P;l=Ih(ht|0,0,l|0,0)|0;ht=P;lt=Ih(X|0,0,at|0,lt|0)|0;h=Ih(lt|0,P|0,h|0,0)|0;ht=Ih(h|0,P|0,ht|0,0)|0;h=P;o=Ih(0,l|0,e|0,o|0)|0;e=P;l=Ih(ht|0,h|0,(e>>>0<l>>>0|(e|0)==(l|0)&o>>>0<0)&1|0,0)|0;h=P;do{if(m>>>0<h>>>0|(m|0)==(h|0)&u>>>0<l>>>0)o=-1;else{if(m>>>0>h>>>0|(m|0)==(h|0)&u>>>0>l>>>0){o=1;break}if(_>>>0<e>>>0|(_|0)==(e|0)&c>>>0<o>>>0){o=-1;break}o=(_>>>0>e>>>0|(_|0)==(e|0)&c>>>0>o>>>0)&1}}while(0);o=et(o,S)|0}else o=S-o|0;if((o|0)<1)break e}}}while(0);o=r[n>>2]|0;if(!o){o=122;break t}if(!(r[o+12>>2]|0)){o=122;break t}v=r[(r[o+8>>2]|0)+4>>2]|0;if((r[v+20>>2]|0)<=(r[t+100>>2]|0)){o=122;break t}l=r[v+12>>2]|0;c=r[l+88>>2]|0;i=c-i|0;h=r[l+92>>2]|0;e=h-T|0;l=r[l+96>>2]|0;o=l-a|0;ht=Gh(i|0,((i|0)<0)<<31>>31|0,Z|0,((Z|0)<0)<<31>>31|0)|0;at=P;lt=Gh(e|0,((e|0)<0)<<31>>31|0,Q|0,((Q|0)<0)<<31>>31|0)|0;at=Ih(lt|0,P|0,ht|0,at|0)|0;ht=P;lt=Gh(o|0,((o|0)<0)<<31>>31|0,I|0,L|0)|0;if(!((at|0)==(lt|0)&(ht|0)==(P|0))){o=122;break t}_=Gh(i|0,((i|0)<0)<<31>>31|0,$|0,J|0)|0;y=P;a=Gh(e|0,((e|0)<0)<<31>>31|0,tt|0,it|0)|0;y=Ih(a|0,P|0,_|0,y|0)|0;_=P;a=Gh(o|0,((o|0)<0)<<31>>31|0,Y|0,q|0)|0;a=Ih(y|0,_|0,a|0,P|0)|0;_=P;o=(et(e,st)|0)+(et(i,nt)|0)+(et(o,K)|0)|0;y=R-c|0;lt=d-h|0;b=f-l|0;y=Gh(y|0,((y|0)<0)<<31>>31|0,$|0,J|0)|0;ht=P;lt=Gh(lt|0,((lt|0)<0)<<31>>31|0,tt|0,it|0)|0;ht=Ih(lt|0,P|0,y|0,ht|0)|0;y=P;b=Gh(b|0,((b|0)<0)<<31>>31|0,Y|0,q|0)|0;b=Ih(ht|0,y|0,b|0,P|0)|0;y=P;if((y|0)>=0){o=122;break t}if((a|0)==0&(_|0)==0){if((o|0)<=0){o=122;break t}}else{if((_|0)>=0){o=122;break t}if((o|0)>0){h=o;c=((o|0)<0)<<31>>31;l=1}else{h=Rh(0,0,o|0,((o|0)<0)<<31>>31|0)|0;h=(o|0)<0?h:0;c=(o|0)<0?P:0;l=o>>31}g=0-l|0;p=Rh(0,0,a|0,_|0)|0;m=P;if((A|0)>0){o=1;u=A;a=((A|0)<0)<<31>>31}else{u=Rh(0,0,A|0,((A|0)<0)<<31>>31|0)|0;o=A>>31;u=(A|0)<0?u:0;a=(A|0)<0?P:0}do{if((M|0)>0|(M|0)==0&E>>>0>0){i=o;e=E;o=M}else{if((M|0)>=0){i=o;e=0;o=0;break}e=Rh(0,0,E|0,M|0)|0;i=0-o|0;o=P}}while(0);if((i|0)==(g|0)){if(!l){o=122;break t}ht=Gh(e|0,0,h|0,0)|0;l=P;i=Gh(o|0,0,h|0,0)|0;X=P;e=Gh(e|0,0,c|0,0)|0;_=P;o=Gh(o|0,0,c|0,0)|0;h=P;c=Ih(i|0,0,e|0,0)|0;e=P;h=Ih(X|0,0,o|0,h|0)|0;_=Ih(h|0,P|0,_|0,0)|0;e=Ih(_|0,P|0,e|0,0)|0;_=P;l=Ih(0,c|0,ht|0,l|0)|0;h=P;c=Ih(e|0,_|0,(h>>>0<c>>>0|(h|0)==(c|0)&l>>>0<0)&1|0,0)|0;_=P;e=Gh(u|0,0,p|0,0)|0;o=P;ht=Gh(a|0,0,p|0,0)|0;X=P;i=Gh(u|0,0,m|0,0)|0;lt=P;at=Gh(a|0,0,m|0,0)|0;a=P;i=Ih(ht|0,0,i|0,0)|0;ht=P;a=Ih(X|0,0,at|0,a|0)|0;a=Ih(a|0,P|0,lt|0,0)|0;ht=Ih(a|0,P|0,ht|0,0)|0;a=P;o=Ih(0,i|0,e|0,o|0)|0;e=P;i=Ih(ht|0,a|0,(e>>>0<i>>>0|(e|0)==(i|0)&o>>>0<0)&1|0,0)|0;a=P;do{if(_>>>0<a>>>0|(_|0)==(a|0)&c>>>0<i>>>0)o=-1;else{if(_>>>0>a>>>0|(_|0)==(a|0)&c>>>0>i>>>0){o=1;break}if(h>>>0<e>>>0|(h|0)==(e|0)&l>>>0<o>>>0){o=-1;break}o=(h>>>0>e>>>0|(h|0)==(e|0)&l>>>0>o>>>0)&1}}while(0);o=et(o,g)|0}else o=g-i|0;if((o|0)>=0){o=122;break t}}r[n>>2]=v;a=r[v+12>>2]|0;p=r[s>>2]|0;M=y;E=b;i=r[a+88>>2]|0;T=r[a+92>>2]|0;a=r[a+96>>2]|0}e=x-i|0;R=w-T|0;l=C-a|0;e=Gh(e|0,((e|0)<0)<<31>>31|0,$|0,J|0)|0;o=P;R=Gh(R|0,((R|0)<0)<<31>>31|0,tt|0,it|0)|0;o=Ih(R|0,P|0,e|0,o|0)|0;e=P;l=Gh(l|0,((l|0)<0)<<31>>31|0,Y|0,q|0)|0;l=Ih(o|0,e|0,l|0,P|0)|0;p=(p|0)==(rt|0)?0:ot;r[s>>2]=p;e=P;o=T;R=x;d=w;f=C}if((o|0)==122)return}function B_(t,e,i,n,s,o,a){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;var l=0,h=0,c=0,_=0,u=0,d=0,p=0,f=0,m=0,g=0,b=0,y=0,v=0,S=0,x=0,w=0,C=0,T=0,A=0,E=0,M=0,R=0,I=0,L=0,D=0;l=r[i+8>>2]|0;if(!l){t=0;return t|0}h=l;M=l;l=0;do{if((r[M+20>>2]|0)>(r[t+100>>2]|0)){A=r[M+12>>2]|0;x=r[A+88>>2]|0;w=x-(r[i+88>>2]|0)|0;C=r[A+92>>2]|0;T=C-(r[i+92>>2]|0)|0;A=r[A+96>>2]|0;E=A-(r[i+96>>2]|0)|0;c=Gh(r[o>>2]|0,r[o+4>>2]|0,w|0,((w|0)<0)<<31>>31|0)|0;_=P;h=Gh(r[o+8>>2]|0,r[o+8+4>>2]|0,T|0,((T|0)<0)<<31>>31|0)|0;_=Ih(h|0,P|0,c|0,_|0)|0;c=P;h=Gh(r[o+16>>2]|0,r[o+16+4>>2]|0,E|0,((E|0)<0)<<31>>31|0)|0;h=Ih(_|0,c|0,h|0,P|0)|0;c=P;_=Gh(r[s>>2]|0,r[s+4>>2]|0,w|0,((w|0)<0)<<31>>31|0)|0;S=P;u=Gh(r[s+8>>2]|0,r[s+8+4>>2]|0,T|0,((T|0)<0)<<31>>31|0)|0;S=Ih(u|0,P|0,_|0,S|0)|0;_=P;u=Gh(r[s+16>>2]|0,r[s+16+4>>2]|0,E|0,((E|0)<0)<<31>>31|0)|0;u=Ih(S|0,_|0,u|0,P|0)|0;_=P;if((c|0)>0|(c|0)==0&h>>>0>0){S=c;c=1}else{y=Rh(0,0,h|0,c|0)|0;S=P;v=Dh(h|0,c|0,63)|0;h=(c|0)<0?y:0;S=(c|0)<0?S:0;c=v}if(!((_|0)>0|(_|0)==0&u>>>0>0)){v=Rh(0,0,u|0,_|0)|0;d=(_|0)<0?0-c|0:c;c=(_|0)<0?v:0;_=(_|0)<0?P:0;if(!((d|0)==0&((c|0)==0&(_|0)==0))){u=c;p=8}}else{d=c;p=8}t:do{if((p|0)==8){p=0;if(!l){r[a>>2]=h;r[a+4>>2]=S;r[a+8>>2]=u;r[a+8+4>>2]=_;r[a+16>>2]=d;l=M;break}c=r[a+16>>2]|0;if((d|0)==(c|0)){if(d|0){f=r[a+8>>2]|0;b=r[a+8+4>>2]|0;p=Gh(f|0,0,h|0,0)|0;c=P;y=Gh(b|0,0,h|0,0)|0;g=P;f=Gh(f|0,0,S|0,0)|0;m=P;b=Gh(b|0,0,S|0,0)|0;L=P;f=Ih(y|0,0,f|0,0)|0;y=P;L=Ih(g|0,0,b|0,L|0)|0;m=Ih(L|0,P|0,m|0,0)|0;y=Ih(m|0,P|0,y|0,0)|0;m=P;c=Ih(0,f|0,p|0,c|0)|0;p=P;f=Ih(y|0,m|0,(p>>>0<f>>>0|(p|0)==(f|0)&c>>>0<0)&1|0,0)|0;m=P;y=r[a>>2]|0;L=r[a+4>>2]|0;b=Gh(y|0,0,u|0,0)|0;g=P;R=Gh(L|0,0,u|0,0)|0;D=P;y=Gh(y|0,0,_|0,0)|0;v=P;L=Gh(L|0,0,_|0,0)|0;I=P;y=Ih(R|0,0,y|0,0)|0;R=P;I=Ih(D|0,0,L|0,I|0)|0;v=Ih(I|0,P|0,v|0,0)|0;R=Ih(v|0,P|0,R|0,0)|0;v=P;g=Ih(0,y|0,b|0,g|0)|0;b=P;y=Ih(R|0,v|0,(b>>>0<y>>>0|(b|0)==(y|0)&g>>>0<0)&1|0,0)|0;v=P;if(!(m>>>0<v>>>0|(m|0)==(v|0)&f>>>0<y>>>0))if(!(m>>>0>v>>>0|(m|0)==(v|0)&f>>>0>y>>>0))if(p>>>0<b>>>0|(p|0)==(b|0)&c>>>0<g>>>0)c=-1;else c=(p>>>0>b>>>0|(p|0)==(b|0)&c>>>0>g>>>0)&1;else c=1;else c=-1;c=et(c,d)|0;p=18}}else{c=d-c|0;p=18}do{if((p|0)==18){p=0;if((c|0)>=0)if(!c)break;else break t;else{r[a>>2]=h;r[a+4>>2]=S;r[a+8>>2]=u;r[a+8+4>>2]=_;r[a+16>>2]=d;l=M;break t}}}while(0);h=(r[l+4>>2]|0)==(M|0);if((r[l>>2]|0)==(M|0))if(h){D=r[n+8>>2]|0;R=et(D,T)|0;v=r[n+4>>2]|0;R=R-(et(v,E)|0)|0;L=r[n>>2]|0;D=(et(L,E)|0)-(et(D,w)|0)|0;L=(et(v,w)|0)-(et(L,T)|0)|0;v=r[l+12>>2]|0;h=r[(r[M+8>>2]|0)+12>>2]|0;T=r[h+88>>2]|0;w=(r[v+88>>2]|0)-T|0;S=r[h+92>>2]|0;E=(r[v+92>>2]|0)-S|0;h=r[h+96>>2]|0;v=(r[v+96>>2]|0)-h|0;I=(et(A-h|0,E)|0)-(et(C-S|0,v)|0)|0;h=(et(x-T|0,v)|0)-(et(A-h|0,w)|0)|0;E=(et(C-S|0,w)|0)-(et(x-T|0,E)|0)|0;R=Gh(I|0,((I|0)<0)<<31>>31|0,R|0,((R|0)<0)<<31>>31|0)|0;I=P;D=Gh(h|0,((h|0)<0)<<31>>31|0,D|0,((D|0)<0)<<31>>31|0)|0;h=P;L=Gh(E|0,((E|0)<0)<<31>>31|0,L|0,((L|0)<0)<<31>>31|0)|0;L=Ih(R|0,I|0,L|0,P|0)|0;h=Ih(L|0,P|0,D|0,h|0)|0;D=P;h=(D|0)>0|(D|0)==0&h>>>0>0?2:1}else h=2;else h=h&1;l=(h|0)==2^e?l:M}}while(0);h=r[i+8>>2]|0}M=r[M>>2]|0}while((M|0)!=(h|0));return l|0}function N_(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0,a=0,l=0,h=0,c=0,u=0;u=_;_=_+16|0;a=r[t+12>>2]|0;l=r[a+(((i+e|0)/2|0)<<4)>>2]|0;h=r[a+(((i+e|0)/2|0)<<4)+4>>2]|0;c=r[a+(((i+e|0)/2|0)<<4)+8>>2]|0;n=e;s=i;while(1){o=n;while(1){n=r[a+(o<<4)+4>>2]|0;if((n|0)>=(h|0)){if((n|0)!=(h|0))break;n=r[a+(o<<4)>>2]|0;if((n|0)>=(l|0)){if((n|0)!=(l|0))break;if((r[a+(o<<4)+8>>2]|0)>=(c|0))break}}o=o+1|0}while(1){n=r[a+(s<<4)+4>>2]|0;if((h|0)>=(n|0)){if((h|0)!=(n|0))break;n=r[a+(s<<4)>>2]|0;if((l|0)>=(n|0)){if((l|0)!=(n|0))break;if((c|0)>=(r[a+(s<<4)+8>>2]|0))break}}s=s+-1|0}if((o|0)>(s|0))n=o;else{n=a+(o<<4)|0;r[u>>2]=r[n>>2];r[u+4>>2]=r[n+4>>2];r[u+8>>2]=r[n+8>>2];r[u+12>>2]=r[n+12>>2];a=a+(s<<4)|0;r[n>>2]=r[a>>2];r[n+4>>2]=r[a+4>>2];r[n+8>>2]=r[a+8>>2];r[n+12>>2]=r[a+12>>2];n=(r[t+12>>2]|0)+(s<<4)|0;r[n>>2]=r[u>>2];r[n+4>>2]=r[u+4>>2];r[n+8>>2]=r[u+8>>2];r[n+12>>2]=r[u+12>>2];n=o+1|0;s=s+-1|0}if((n|0)>(s|0))break;a=r[t+12>>2]|0}if((s|0)>(e|0))N_(t,e,s);if((n|0)>=(i|0)){_=u;return}N_(t,n,i);_=u;return}function U_(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,r=0,o=0;if((n|0)>-1|(n|0)==-1&i>>>0>4294967295){s=(+(i>>>0)+4294967296.0*+(n>>>0))*18446744073709551616.0+(+(t>>>0)+4294967296.0*+(e>>>0));return+s}else{o=Rh(0,0,t|0,e|0)|0;r=P;n=Ih((t|0)==0&(e|0)==0&1|0,0,~i|0,~n|0)|0;s=-+U_(o,r,n,P);return+s}return 0.0}function V_(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0.0,l=0,c=0,u=0,p=0,f=0.0,m=0.0,g=0,b=0,y=0.0,v=0,S=0,x=0.0,w=0.0,C=0.0,T=0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0,L=0,D=0,k=0,O=0,F=0;O=_;_=_+240|0;if((i|0)<1){s=r[t+12>>2]|0;if(s|0){if(n[t+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[t+12>>2]=0}n[t+16>>0]=1;r[t+12>>2]=0;r[t+4>>2]=0;r[t+8>>2]=0;s=r[t+32>>2]|0;if(s|0){if(n[t+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[t+32>>2]=0}n[t+36>>0]=1;r[t+32>>2]=0;r[t+24>>2]=0;r[t+28>>2]=0;s=r[t+52>>2]|0;if(s|0){if(n[t+56>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[t+52>>2]=0}n[t+56>>0]=1;r[t+52>>2]=0;r[t+44>>2]=0;r[t+48>>2]=0;_=O;return}r[O+40+32>>2]=0;r[O+40+36>>2]=0;r[O+40+40>>2]=0;r[O+40+44>>2]=256;r[O+40+48>>2]=0;r[O+40+52>>2]=0;r[O+40+56>>2]=0;r[O+40+60>>2]=256;r[O+40+64>>2]=0;r[O+40+68>>2]=0;r[O+40+72>>2]=0;r[O+40+76>>2]=256;n[O+40+96>>0]=1;P=O+40+92|0;r[P>>2]=0;r[O+40+84>>2]=0;r[O+40+88>>2]=0;c=0;u=-246811958;S=-246811958;b=-246811958;g=1900671690;T=1900671690;v=1900671690;p=e;while(1){I=+h[p>>2];a=+h[p+4>>2];f=+h[p+8>>2];L=I<(r[d>>2]=g,+h[d>>2]);s=(h[d>>2]=I,r[d>>2]|0);g=L?s:g;L=a<(r[d>>2]=v,+h[d>>2]);o=(h[d>>2]=a,r[d>>2]|0);v=L?o:v;L=f<(r[d>>2]=T,+h[d>>2]);l=(h[d>>2]=f,r[d>>2]|0);T=L?l:T;u=(r[d>>2]=u,+h[d>>2])<I?s:u;b=(r[d>>2]=b,+h[d>>2])<a?o:b;S=(r[d>>2]=S,+h[d>>2])<f?l:S;c=c+1|0;if((c|0)==(i|0))break;else p=p+16|0}E=(r[d>>2]=u,+h[d>>2]);A=(r[d>>2]=g,+h[d>>2]);C=(r[d>>2]=b,+h[d>>2]);w=(r[d>>2]=v,+h[d>>2]);x=(r[d>>2]=S,+h[d>>2]);y=(r[d>>2]=T,+h[d>>2]);o=E-A<C-w?C-w<x-y?2:1:E-A<x-y?2:0;r[O+40+112>>2]=o;s=E-A<C-w?E-A<x-y?0:2:C-w<x-y?1:2;if((s|0)==(o|0))s=((o+1|0)>>>0)%3|0;r[O+40+104>>2]=s;L=(o^3)-s|0;r[O+40+108>>2]=L;if(((L+1|0)%3|0|0)==(o|0)){a=(E-A)*9.788566967472434e-05;f=(C-w)*9.788566967472434e-05;m=(x-y)*9.788566967472434e-05}else{a=-((E-A)*9.788566967472434e-05);f=-((C-w)*9.788566967472434e-05);m=-((x-y)*9.788566967472434e-05)}h[O+40>>2]=a;h[O+40+4>>2]=f;h[O+40+8>>2]=m;h[O+40+12>>2]=0.0;I=a!=0.0?1.0/a:a;R=f!=0.0?1.0/f:f;M=m!=0.0?1.0/m:m;h[O+40+16>>2]=(E+A)*.5;h[O+40+20>>2]=(C+w)*.5;h[O+40+24>>2]=(x+y)*.5;h[O+40+28>>2]=0.0;g=O+216+16|0;n[g>>0]=1;b=O+216+12|0;r[b>>2]=0;r[O+216+4>>2]=0;r[O+216+8>>2]=0;r[5637]=(r[5637]|0)+1;s=Zl((i<<4|3)+16|0)|0;if(!s)c=0;else{r[(s+4+15&-16)+-4>>2]=s;c=s+4+15&-16}o=r[O+216+4>>2]|0;l=r[b>>2]|0;if((o|0)<=0){if(l|0)k=26}else{s=0;do{k=c+(s<<4)|0;L=l+(s<<4)|0;r[k>>2]=r[L>>2];r[k+4>>2]=r[L+4>>2];r[k+8>>2]=r[L+8>>2];r[k+12>>2]=r[L+12>>2];s=s+1|0}while((s|0)!=(o|0));k=26}if((k|0)==26){if(n[g>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0)}r[b>>2]=0}n[g>>0]=1;r[b>>2]=c;r[O+216+8>>2]=i;r[c>>2]=r[O+200>>2];r[c+4>>2]=r[O+200+4>>2];r[c+8>>2]=r[O+200+8>>2];r[c+12>>2]=r[O+200+12>>2];if((i|0)!=1){s=1;do{L=(r[b>>2]|0)+(s<<4)|0;r[L>>2]=r[O+200>>2];r[L+4>>2]=r[O+200+4>>2];r[L+8>>2]=r[O+200+8>>2];r[L+12>>2]=r[O+200+12>>2];s=s+1|0}while((s|0)!=(i|0))}r[O+216+4>>2]=i;o=O+184+(r[O+40+108>>2]<<2)|0;l=r[b>>2]|0;c=O+184+(r[O+40+112>>2]<<2)|0;u=O+184+(r[O+40+104>>2]<<2)|0;a=+h[O+40+16>>2];f=+h[O+40+20>>2];m=+h[O+40+24>>2];p=0;s=e;while(1){e=r[s>>2]|0;r[O+184>>2]=e;L=r[s+4>>2]|0;r[O+184+4>>2]=L;C=(r[d>>2]=e,+h[d>>2])-a;A=R*((r[d>>2]=L,+h[d>>2])-f);E=M*(+h[s+8>>2]-m);h[O+184>>2]=I*C;h[O+184+4>>2]=A;h[O+184+8>>2]=E;h[O+184+12>>2]=0.0;r[l+(p<<4)>>2]=~~+h[o>>2];r[l+(p<<4)+4>>2]=~~+h[c>>2];r[l+(p<<4)+8>>2]=~~+h[u>>2];r[l+(p<<4)+12>>2]=p;p=p+1|0;if((p|0)==(i|0))break;else s=s+16|0}if((i|0)>1)N_(O+216|0,0,i+-1|0);r[O+40+36>>2]=r[O+40+32>>2];r[O+40+40>>2]=0;r[O+40+44>>2]=i;s=r[O+40+84>>2]|0;if((s|0)<(i|0)){if((r[O+40+88>>2]|0)<(i|0)){if(!i){o=0;l=s}else{r[5637]=(r[5637]|0)+1;o=Zl((i<<2|3)+16|0)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}l=r[O+40+84>>2]|0}if((l|0)>0){c=0;do{r[o+(c<<2)>>2]=r[(r[P>>2]|0)+(c<<2)>>2];c=c+1|0}while((c|0)!=(l|0))}l=r[P>>2]|0;if(l|0){if(n[O+40+96>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0)}r[P>>2]=0}n[O+40+96>>0]=1;r[P>>2]=o;r[O+40+88>>2]=i}do{r[(r[P>>2]|0)+(s<<2)>>2]=0;s=s+1|0}while((s|0)!=(i|0))}r[O+40+84>>2]=i;u=0;do{s=r[O+40+40>>2]|0;if(!s){s=r[O+40+36>>2]|0;if(!s){r[5637]=(r[5637]|0)+1;s=Zl(31)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}o=r[O+40+44>>2]|0;r[s+4>>2]=o;l=s+8|0;r[l>>2]=0;r[5637]=(r[5637]|0)+1;o=Zl((o*112|3)+16|0)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}r[s>>2]=o;r[l>>2]=r[O+40+32>>2];r[O+40+32>>2]=s}else r[O+40+36>>2]=r[s+8>>2];c=r[s+4>>2]|0;s=r[s>>2]|0;if((c|0)>0){o=0;l=s;do{o=o+1|0;L=l;l=l+112|0;r[L>>2]=(o|0)<(c|0)?l:0}while((o|0)!=(c|0))}}r[O+40+40>>2]=r[s>>2];L=s+104|0;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;r[s+16>>2]=0;r[L>>2]=-1;r[s+8>>2]=0;e=s+88|0;T=(r[b>>2]|0)+(u<<4)|0;r[e>>2]=r[T>>2];r[e+4>>2]=r[T+4>>2];r[e+8>>2]=r[T+8>>2];r[e+12>>2]=r[T+12>>2];r[L>>2]=-1;r[(r[P>>2]|0)+(u<<2)>>2]=s;u=u+1|0}while((u|0)<(i|0));s=r[b>>2]|0;if(s|0){if(n[g>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[b>>2]=0}n[g>>0]=1;r[b>>2]=0;r[O+216+4>>2]=0;r[O+216+8>>2]=0;r[O+40+52>>2]=r[O+40+48>>2];r[O+40+56>>2]=0;r[O+40+60>>2]=i*6;r[O+40+116>>2]=0;r[O+40+120>>2]=0;r[O+40+100>>2]=-3;r[O+184>>2]=0;r[O+184+4>>2]=0;r[O+184+8>>2]=0;r[O+184+12>>2]=0;O_(O+40|0,0,i,O+184|0);r[O+40+124>>2]=r[O+184>>2];s=r[b>>2]|0;if(s|0){if(n[g>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[b>>2]=0}s=r[t+4>>2]|0;if((s|0)<0){if((r[t+8>>2]|0)<0){o=r[t+12>>2]|0;if(o|0){if(n[t+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+12>>2]=0}n[t+16>>0]=1;r[t+12>>2]=0;r[t+8>>2]=0}do{L=(r[t+12>>2]|0)+(s<<4)|0;r[L>>2]=r[O+168>>2];r[L+4>>2]=r[O+168+4>>2];r[L+8>>2]=r[O+168+8>>2];r[L+12>>2]=r[O+168+12>>2];s=s+1|0}while((s|0)!=0)}r[t+4>>2]=0;r[O+24>>2]=0;r[O+24+4>>2]=0;r[O+24+8>>2]=0;s=r[t+24>>2]|0;if((s|0)<0){if((r[t+28>>2]|0)<0){o=r[t+32>>2]|0;if(o|0){if(n[t+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+32>>2]=0}n[t+36>>0]=1;r[t+32>>2]=0;r[t+28>>2]=0}do{L=(r[t+32>>2]|0)+(s*12|0)|0;r[L>>2]=r[O+24>>2];r[L+4>>2]=r[O+24+4>>2];r[L+8>>2]=r[O+24+8>>2];s=s+1|0}while((s|0)!=0)}r[t+24>>2]=0;o=r[t+44>>2]|0;if((o|0)<0){s=r[t+52>>2]|0;do{if((r[t+48>>2]|0)<0){if(!s){n[t+56>>0]=1;r[t+52>>2]=0;r[t+48>>2]=0;s=0;break}if(n[t+56>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}n[t+56>>0]=1;r[t+52>>2]=0;r[t+48>>2]=0;s=0}}while(0);Ph(s+(o<<2)|0,0,et(o,-4)|0)|0}r[t+44>>2]=0;s=r[O+40+124>>2]|0;if((r[s+104>>2]|0)<0){r[s+104>>2]=0;r[5637]=(r[5637]|0)+1;g=Zl(23)|0;r[(g+4+15&-16)+-4>>2]=g;r[(g+4+15&-16)>>2]=s;L=0;c=1;l=1;g=g+4+15&-16;while(1){if((r[s+100>>2]|0)>-1){h[O+216+(r[O+40+108>>2]<<2)>>2]=+(r[s+88>>2]|0);h[O+216+(r[O+40+112>>2]<<2)>>2]=+(r[s+92>>2]|0);a=+(r[s+96>>2]|0)}else{i=s+24|0;e=s+32|0;a=+U_(r[i>>2]|0,r[i+4>>2]|0,r[e>>2]|0,r[e+4>>2]|0);e=s+72|0;i=s+80|0;P=r[i>>2]|0;i=r[i+4>>2]|0;a=a/+U_(r[e>>2]|0,r[e+4>>2]|0,P,i);h[O+216+(r[O+40+108>>2]<<2)>>2]=a;T=s+40|0;S=s+48|0;a=+U_(r[T>>2]|0,r[T+4>>2]|0,r[S>>2]|0,r[S+4>>2]|0);a=a/+U_(r[e>>2]|0,r[e+4>>2]|0,P,i);h[O+216+(r[O+40+112>>2]<<2)>>2]=a;S=s+56|0;T=s+64|0;a=+U_(r[S>>2]|0,r[S+4>>2]|0,r[T>>2]|0,r[T+4>>2]|0);a=a/+U_(r[e>>2]|0,r[e+4>>2]|0,P,i)}h[O+216+(r[O+40+104>>2]<<2)>>2]=a;a=+h[O+216>>2]*+h[O+40>>2]+ +h[O+40+16>>2];f=+h[O+216+4>>2]*+h[O+40+4>>2]+ +h[O+40+20>>2];m=+h[O+216+8>>2]*+h[O+40+8>>2]+ +h[O+40+24>>2];o=r[t+4>>2]|0;if((o|0)==(r[t+8>>2]|0)?(D=o|0?o<<1:1,(o|0)<(D|0)):0){if(!D)p=0;else{r[5637]=(r[5637]|0)+1;o=Zl((D<<4|3)+16|0)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}p=o;o=r[t+4>>2]|0}if((o|0)>0){u=0;do{i=p+(u<<4)|0;P=(r[t+12>>2]|0)+(u<<4)|0;r[i>>2]=r[P>>2];r[i+4>>2]=r[P+4>>2];r[i+8>>2]=r[P+8>>2];r[i+12>>2]=r[P+12>>2];u=u+1|0}while((u|0)!=(o|0))}o=r[t+12>>2]|0;if(o|0){if(n[t+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+12>>2]=0}n[t+16>>0]=1;r[t+12>>2]=p;r[t+8>>2]=D;o=r[t+4>>2]|0}P=r[t+12>>2]|0;h[P+(o<<4)>>2]=a;h[P+(o<<4)+4>>2]=f;h[P+(o<<4)+8>>2]=m;h[P+(o<<4)+12>>2]=0.0;r[t+4>>2]=(r[t+4>>2]|0)+1;P=r[s+8>>2]|0;if(!P)u=g;else{i=P;s=-1;T=g;e=-1;while(1){S=i+20|0;o=r[S>>2]|0;if((o|0)<0){v=r[t+24>>2]|0;r[O+12>>2]=0;r[O+12+4>>2]=0;r[O+12+8>>2]=0;do{if((v|0)==(r[t+28>>2]|0)){g=v|0?v<<1:1;if((v|0)>=(g|0)){o=v;break}if(!g){o=0;u=v}else{r[5637]=(r[5637]|0)+1;o=Zl((g*12|3)+16|0)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}u=r[t+24>>2]|0}if((u|0)>0){p=0;do{b=o+(p*12|0)|0;F=(r[t+32>>2]|0)+(p*12|0)|0;r[b>>2]=r[F>>2];r[b+4>>2]=r[F+4>>2];r[b+8>>2]=r[F+8>>2];p=p+1|0}while((p|0)!=(u|0))}u=r[t+32>>2]|0;if(u|0){if(n[t+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0)}r[t+32>>2]=0}n[t+36>>0]=1;r[t+32>>2]=o;r[t+28>>2]=g;o=r[t+24>>2]|0}else o=v}while(0);o=(r[t+32>>2]|0)+(o*12|0)|0;r[o>>2]=r[O+12>>2];r[o+4>>2]=r[O+12+4>>2];r[o+8>>2]=r[O+12+8>>2];o=(r[t+24>>2]|0)+1|0;r[t+24>>2]=o;r[O>>2]=0;r[O+4>>2]=0;r[O+8>>2]=0;do{if((o|0)==(r[t+28>>2]|0)){g=o|0?o<<1:1;if((o|0)>=(g|0))break;if(!g)p=0;else{r[5637]=(r[5637]|0)+1;o=Zl((g*12|3)+16|0)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}p=o;o=r[t+24>>2]|0}if((o|0)>0){u=0;do{F=p+(u*12|0)|0;b=(r[t+32>>2]|0)+(u*12|0)|0;r[F>>2]=r[b>>2];r[F+4>>2]=r[b+4>>2];r[F+8>>2]=r[b+8>>2];u=u+1|0}while((u|0)!=(o|0))}o=r[t+32>>2]|0;if(o|0){if(n[t+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+32>>2]=0}n[t+36>>0]=1;r[t+32>>2]=p;r[t+28>>2]=g;o=r[t+24>>2]|0}}while(0);b=(r[t+32>>2]|0)+(o*12|0)|0;r[b>>2]=r[O>>2];r[b+4>>2]=r[O+4>>2];r[b+8>>2]=r[O+8>>2];r[t+24>>2]=(r[t+24>>2]|0)+1;b=r[t+32>>2]|0;r[S>>2]=v;r[(r[i+8>>2]|0)+20>>2]=v+1;r[b+(v*12|0)+4>>2]=1;r[b+((v+1|0)*12|0)+4>>2]=-1;g=r[i+12>>2]|0;o=r[g+104>>2]|0;if((o|0)<0){r[g+104>>2]=l;do{if((l|0)==(c|0)){p=c|0?c<<1:1;if((c|0)>=(p|0)){u=T;break}do{if(!p)u=0;else{r[5637]=(r[5637]|0)+1;o=Zl((p<<2|3)+16|0)|0;if(!o){u=0;break}r[(o+4+15&-16)+-4>>2]=o;u=o+4+15&-16}}while(0);if((c|0)<=0){if(!T){c=p;break}}else{o=0;do{r[u+(o<<2)>>2]=r[T+(o<<2)>>2];o=o+1|0}while((o|0)!=(c|0))}r[5638]=(r[5638]|0)+1;Ql(r[T+-4>>2]|0);c=p}else u=T}while(0);r[u+(l<<2)>>2]=g;o=l;l=l+1|0}else u=T;r[b+(v*12|0)+8>>2]=o;r[b+((v+1|0)*12|0)+8>>2]=L;o=r[S>>2]|0}else u=T;if((e|0)>-1)r[(r[t+32>>2]|0)+(o*12|0)>>2]=e-o;else s=o;i=r[i>>2]|0;if((i|0)==(P|0))break;else{T=u;e=o}}r[(r[t+32>>2]|0)+(s*12|0)>>2]=o-s}o=L+1|0;if((o|0)>=(l|0))break;s=r[u+(o<<2)>>2]|0;L=o;g=u}if((L|0)>-1){S=0;while(1){b=r[(r[u+(S<<2)>>2]|0)+8>>2]|0;if(b|0){v=b;do{g=v+20|0;s=r[g>>2]|0;if((s|0)>-1){o=r[t+44>>2]|0;do{if((o|0)==(r[t+48>>2]|0)){p=o|0?o<<1:1;if((o|0)>=(p|0))break;if(!p)s=0;else{r[5637]=(r[5637]|0)+1;s=Zl((p<<2|3)+16|0)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}o=r[t+44>>2]|0}c=r[t+52>>2]|0;if((o|0)<=0){if(c)k=173}else{l=0;do{r[s+(l<<2)>>2]=r[c+(l<<2)>>2];l=l+1|0}while((l|0)!=(o|0));k=173}if((k|0)==173){k=0;if(n[t+56>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[c+-4>>2]|0)}r[t+52>>2]=0;o=r[t+44>>2]|0}n[t+56>>0]=1;r[t+52>>2]=s;r[t+48>>2]=p;s=r[g>>2]|0}}while(0);r[(r[t+52>>2]|0)+(o<<2)>>2]=s;r[t+44>>2]=(r[t+44>>2]|0)+1;s=v;do{r[s+20>>2]=-1;s=r[(r[s+8>>2]|0)+4>>2]|0}while((s|0)!=(v|0))}v=r[v>>2]|0}while((v|0)!=(b|0))}if((S|0)==(L|0))break;else S=S+1|0}}if(u|0){r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0)}}z_(O+40|0);_=O;return}function z_(t){t=t|0;var e=0,i=0;e=r[t+92>>2]|0;if(e|0){if(n[t+96>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+92>>2]=0}n[t+96>>0]=1;r[t+92>>2]=0;r[t+84>>2]=0;r[t+88>>2]=0;e=r[t+64>>2]|0;if(e|0)do{r[t+64>>2]=r[e+8>>2];i=r[e>>2]|0;if(i|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);e=r[t+64>>2]|0}while((e|0)!=0);e=r[t+48>>2]|0;if(e|0)do{r[t+48>>2]=r[e+8>>2];i=r[e>>2]|0;if(i|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);e=r[t+48>>2]|0}while((e|0)!=0);e=r[t+32>>2]|0;if(!e)return;do{r[t+32>>2]=r[e+8>>2];i=r[e>>2]|0;if(i|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);e=r[t+32>>2]|0}while((e|0)!=0);return}function W_(){var t=0,e=0;while(1){t=Zl(8)|0;if(t|0){e=6;break}t=r[5831]|0;r[5831]=t+0;if(!t){e=5;break}zk[t&3]()}if((e|0)==5){e=Zt(4)|0;r[e>>2]=8308;ce(e|0,2416,215)}else if((e|0)==6){r[5649]=t;de(t|0,0)|0;r[5639]=16373;r[5640]=0;r[5641]=0;r[5642]=0;r[5643]=0;r[5644]=0;r[5645]=0;r[5646]=0;r[5647]=0;G_(22556);return}}function G_(t){t=t|0;var e=0;do{r[t+4>>2]=0;h[t+8>>2]=0.0;e=r[t+24>>2]|0;if(e|0)G_(e);t=r[t+28>>2]|0}while((t|0)!=0);return}function j_(t){t=t|0;var e=0,i=0,n=0,s=0;s=_;_=_+16|0;i=r[2006]|0;if((r[i>>2]|0)==(t|0))e=i;else{e=r[i+24>>2]|0;t:do{if(!e)n=5;else while(1){if((r[e>>2]|0)==(t|0))break t;e=r[e+28>>2]|0;if(!e){n=5;break}}}while(0);do{if((n|0)==5){while(1){e=Zl(36)|0;if(e|0){n=9;break}e=r[5831]|0;r[5831]=e+0;if(!e){n=8;break}zk[e&3]();n=5}if((n|0)==8){s=Zt(4)|0;r[s>>2]=8308;ce(s|0,2416,215)}else if((n|0)==9){r[e>>2]=t;r[e+4>>2]=0;r[e+4+4>>2]=0;r[e+4+8>>2]=0;r[e+4+12>>2]=0;r[e+20>>2]=i;r[e+24>>2]=0;r[e+28>>2]=0;r[e+32>>2]=0;G_(e);r[e+28>>2]=r[i+24>>2];r[i+24>>2]=e;break}}}while(0);r[2006]=e}t=e+4|0;r[t>>2]=(r[t>>2]|0)+1;t=e+16|0;n=r[t>>2]|0;r[t>>2]=n+1;if(n|0){_=s;return}de(s|0,0)|0;n=r[5649]|0;r[e+12>>2]=(r[s+4>>2]|0)-(r[n+4>>2]|0)+(((r[s>>2]|0)-(r[n>>2]|0)|0)*1e6|0);_=s;return}function H_(t,e){t=t|0;e=e|0;var i=0,n=0;while(1){i=Zl(80)|0;if(i|0){n=6;break}i=r[5831]|0;r[5831]=i+0;if(!i){n=5;break}zk[i&3]()}if((n|0)==5){e=Zt(4)|0;r[e>>2]=8308;ce(e|0,2416,215)}else if((n|0)==6){h[i+4>>2]=1.0;s[i+8>>1]=1;s[i+10>>1]=-1;r[i>>2]=7848;r[i+12>>2]=r[t>>2];r[i+12+4>>2]=r[t+4>>2];r[i+12+8>>2]=r[t+8>>2];r[i+12+12>>2]=r[t+12>>2];r[i+28>>2]=r[e>>2];r[i+28+4>>2]=r[e+4>>2];r[i+28+8>>2]=r[e+8>>2];r[i+28+12>>2]=r[e+12>>2];r[i+76>>2]=0;return i|0}return 0}function X_(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Y_(t){t=t|0;return+ +h[t+4>>2]}function q_(t){t=t|0;return s[t+8>>1]|0}function K_(t){t=t|0;return s[t+10>>1]|0}function Z_(t){t=t|0;return t+12|0}function Q_(t){t=t|0;return t+28|0}function $_(t){t=t|0;return t+44|0}function J_(t){t=t|0;return t+60|0}function tu(t){t=t|0;return+h[t+4>>2]<1.0|0}function eu(t,e){t=t|0;e=+e;h[t+4>>2]=e;return}function iu(t,e){t=t|0;e=e|0;s[t+8>>1]=e;return}function nu(t,e){t=t|0;e=e|0;s[t+10>>1]=e;return}function su(t,e){t=t|0;e=e|0;r[t+12>>2]=r[e>>2];r[t+12+4>>2]=r[e+4>>2];r[t+12+8>>2]=r[e+8>>2];r[t+12+12>>2]=r[e+12>>2];return}function ru(t,e){t=t|0;e=e|0;r[t+28>>2]=r[e>>2];r[t+28+4>>2]=r[e+4>>2];r[t+28+8>>2]=r[e+8>>2];r[t+28+12>>2]=r[e+12>>2];return}function ou(t,e){t=t|0;e=e|0;r[t+44>>2]=r[e>>2];r[t+44+4>>2]=r[e+4>>2];r[t+44+8>>2]=r[e+8>>2];r[t+44+12>>2]=r[e+12>>2];return}function au(t,e){t=t|0;e=e|0;r[t+60>>2]=r[e>>2];r[t+60+4>>2]=r[e+4>>2];r[t+60+8>>2]=r[e+8>>2];r[t+60+12>>2]=r[e+12>>2];return}function lu(t,e){t=t|0;e=e|0;var i=0,n=0;while(1){i=Zl(84)|0;if(i|0){n=6;break}i=r[5831]|0;r[5831]=i+0;if(!i){n=5;break}zk[i&3]()}if((n|0)==5){e=Zt(4)|0;r[e>>2]=8308;ce(e|0,2416,215)}else if((n|0)==6){h[i+4>>2]=1.0;r[i+8>>2]=0;s[i+12>>1]=1;s[i+14>>1]=-1;r[i+16>>2]=0;r[i>>2]=8008;r[i+20>>2]=r[t>>2];r[i+20+4>>2]=r[t+4>>2];r[i+20+8>>2]=r[t+8>>2];r[i+20+12>>2]=r[t+12>>2];r[i+36>>2]=r[e>>2];r[i+36+4>>2]=r[e+4>>2];r[i+36+8>>2]=r[e+8>>2];r[i+36+12>>2]=r[e+12>>2];return i|0}return 0}function hu(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function cu(t){t=t|0;return s[t+12>>1]|0}function _u(t){t=t|0;return s[t+14>>1]|0}function uu(t){t=t|0;return r[t+8>>2]|0}function du(t){t=t|0;return t+52|0}function pu(t){t=t|0;return t+68|0}function fu(t){t=t|0;return t+20|0}function mu(t){t=t|0;return t+36|0}function gu(t){t=t|0;return(r[t+8>>2]|0)!=0|0}function bu(t,e){t=t|0;e=e|0;s[t+12>>1]=e;return}function yu(t,e){t=t|0;e=e|0;s[t+14>>1]=e;return}function vu(t,e){t=t|0;e=e|0;r[t+8>>2]=e;return}function Su(t,e){t=t|0;e=e|0;r[t+52>>2]=r[e>>2];r[t+52+4>>2]=r[e+4>>2];r[t+52+8>>2]=r[e+8>>2];r[t+52+12>>2]=r[e+12>>2];return}function xu(t,e){t=t|0;e=e|0;r[t+68>>2]=r[e>>2];r[t+68+4>>2]=r[e+4>>2];r[t+68+8>>2]=r[e+8>>2];r[t+68+12>>2]=r[e+12>>2];return}function wu(t,e){t=t|0;e=e|0;r[t+20>>2]=r[e>>2];r[t+20+4>>2]=r[e+4>>2];r[t+20+8>>2]=r[e+8>>2];r[t+20+12>>2]=r[e+12>>2];return}function Cu(t,e){t=t|0;e=e|0;r[t+36>>2]=r[e>>2];r[t+36+4>>2]=r[e+4>>2];r[t+36+8>>2]=r[e+8>>2];r[t+36+12>>2]=r[e+12>>2];return}function Tu(){var t=0,e=0;while(1){t=Zl(8)|0;if(t|0){e=6;break}t=r[5831]|0;r[5831]=t+0;if(!t){e=5;break}zk[t&3]()}if((e|0)==5){e=Zt(4)|0;r[e>>2]=8308;ce(e|0,2416,215)}else if((e|0)==6){r[t>>2]=0;r[t+4>>2]=0;s[t+4>>1]=1;s[t+6>>1]=-1;r[t>>2]=8036;return t|0}return 0}function Au(t){t=t|0;return}function Eu(t){t=t|0;Ql(t);return}function Mu(t,e){t=t|0;e=e|0;e=r[e+4>>2]|0;if(!((s[t+6>>1]&(e&65535))<<16>>16)){t=0;return t|0}t=(e>>>16&65535&s[t+4>>1])<<16>>16!=0;return t|0}function Ru(t,e,i,n,s,r,o,a){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=r|0;o=o|0;a=a|0;return+ +le(0,t|0,e|0,i|0,n|0,s|0,r|0,o|0,a|0)}function Iu(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Pu(t,e,i,n,s,o,a,l){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;l=l|0;return+ +mk[r[(r[t>>2]|0)+12>>2]&1](t,e,i,n,s,o,a,l)}function Lu(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Du(t,e,i,n,s,o,a,l){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;l=l|0;return+ +mk[r[(r[t>>2]|0)+12>>2]&1](t,e,i,n,s,o,a,l)}function ku(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Ou(t){t=t|0;return+ +h[t+4>>2]}function Fu(t){t=t|0;return s[t+8>>1]|0}function Bu(t){t=t|0;return s[t+10>>1]|0}function Nu(t){t=t|0;return+h[t+4>>2]<1.0|0}function Uu(t,e){t=t|0;e=+e;h[t+4>>2]=e;return}function Vu(t,e){t=t|0;e=e|0;s[t+8>>1]=e;return}function zu(t,e){t=t|0;e=e|0;s[t+10>>1]=e;return}function Wu(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=+s;var o=0,a=0;while(1){o=Zl(44)|0;if(o|0){a=6;break}o=r[5831]|0;r[5831]=o+0;if(!o){a=5;break}zk[o&3]()}if((a|0)==5){n=Zt(4)|0;r[n>>2]=8308;ce(n|0,2416,215)}else if((a|0)==6){r[o>>2]=t;r[o+4>>2]=e;r[o+8>>2]=r[i>>2];r[o+8+4>>2]=r[i+4>>2];r[o+8+8>>2]=r[i+8>>2];r[o+8+12>>2]=r[i+12>>2];r[o+24>>2]=r[n>>2];r[o+24+4>>2]=r[n+4>>2];r[o+24+8>>2]=r[n+8>>2];r[o+24+12>>2]=r[n+12>>2];h[o+40>>2]=s;return o|0}return 0}function Gu(t){t=t|0;if(!t)return;Ql(t);return}function ju(t){t=t|0;return r[t>>2]|0}function Hu(t){t=t|0;return+ +h[t+40>>2]}function Xu(t){t=t|0;return t+8|0}function Yu(t){t=t|0;return t+24|0}function qu(t){t=t|0;return r[t+4>>2]|0}function Ku(t,e){t=t|0;e=e|0;r[t>>2]=e;return}function Zu(t,e){t=t|0;e=+e;h[t+40>>2]=e;return}function Qu(t,e){t=t|0;e=e|0;r[t+8>>2]=r[e>>2];r[t+8+4>>2]=r[e+4>>2];r[t+8+8>>2]=r[e+8>>2];r[t+8+12>>2]=r[e+12>>2];return}function $u(t,e){t=t|0;e=e|0;r[t+24>>2]=r[e>>2];r[t+24+4>>2]=r[e+4>>2];r[t+24+8>>2]=r[e+8>>2];r[t+24+12>>2]=r[e+12>>2];return}function Ju(t,e){t=t|0;e=e|0;r[t+4>>2]=e;return}function td(t){t=t|0;if(!t)return;Ql(t);return}function ed(t){t=t|0;return r[t>>2]|0}function id(t){t=t|0;return r[t+4>>2]|0}function nd(t,e){t=t|0;e=e|0;r[t>>2]=e;return}function sd(t,e){t=t|0;e=e|0;r[t+4>>2]=e;return}function rd(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function od(t){t=t|0;return s[t+12>>1]|0}function ad(t){t=t|0;return s[t+14>>1]|0}function ld(t){t=t|0;return r[t+8>>2]|0}function hd(t){t=t|0;return(r[t+8>>2]|0)!=0|0}function cd(t,e){t=t|0;e=e|0;s[t+12>>1]=e;return}function _d(t,e){t=t|0;e=e|0;s[t+14>>1]=e;return}function ud(t,e){t=t|0;e=e|0;r[t+8>>2]=e;return}function dd(t){t=t|0;if(!t)return;Ql(t);return}function pd(t){t=t|0;return t|0}function fd(t){t=t|0;return t+16|0}function md(t){t=t|0;return r[t+88>>2]|0}function gd(t){t=t|0;return t+36|0}function bd(t){t=t|0;return(n[t+84>>0]|0)!=0|0}function yd(t){t=t|0;return+ +h[t+32>>2]}function vd(t){t=t|0;return t+68|0}function Sd(t){t=t|0;return t+52|0}function xd(t,e){t=t|0;e=e|0;r[t>>2]=r[e>>2];r[t+4>>2]=r[e+4>>2];r[t+8>>2]=r[e+8>>2];r[t+12>>2]=r[e+12>>2];return}function wd(t,e){t=t|0;e=e|0;r[t+16>>2]=r[e>>2];r[t+16+4>>2]=r[e+4>>2];r[t+16+8>>2]=r[e+8>>2];r[t+16+12>>2]=r[e+12>>2];return}function Cd(t,e){t=t|0;e=e|0;r[t+88>>2]=e;return}function Td(t,e){t=t|0;e=e|0;r[t+36>>2]=r[e>>2];r[t+36+4>>2]=r[e+4>>2];r[t+36+8>>2]=r[e+8>>2];r[t+36+12>>2]=r[e+12>>2];return}function Ad(t,e){t=t|0;e=e|0;n[t+84>>0]=e&1;return}function Ed(t,e){t=t|0;e=+e;h[t+32>>2]=e;return}function Md(t,e){t=t|0;e=e|0;r[t+68>>2]=r[e>>2];r[t+68+4>>2]=r[e+4>>2];r[t+68+8>>2]=r[e+8>>2];r[t+68+12>>2]=r[e+12>>2];return}function Rd(t,e){t=t|0;e=e|0;r[t+52>>2]=r[e>>2];r[t+52+4>>2]=r[e+4>>2];r[t+52+8>>2]=r[e+8>>2];r[t+52+12>>2]=r[e+12>>2];return}function Id(t){t=t|0;if(!t)return;Ql(t);return}function Pd(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Ld(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Dd(t,e){t=t|0;e=e|0;var i=0;r[5637]=(r[5637]|0)+1;i=Zl(135)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}ZI(i,t,e,16384,0,0);return i|0}function kd(t,e,i){t=t|0;e=e|0;i=i|0;var n=0;r[5637]=(r[5637]|0)+1;n=Zl(135)|0;if(!n)n=0;else{r[(n+4+15&-16)+-4>>2]=n;n=n+4+15&-16}ZI(n,t,e,i&65535,0,0);return n|0}function Od(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0;r[5637]=(r[5637]|0)+1;s=Zl(135)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}ZI(s,t,e,i&65535,n,0);return s|0}function Fd(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var o=0;r[5637]=(r[5637]|0)+1;o=Zl(135)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}ZI(o,t,e,i&65535,n,s);return o|0}function Bd(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Nd(t){t=t|0;var e=0;r[5637]=(r[5637]|0)+1;e=Zl(79)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}CI(e,t);return e|0}function Ud(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function Vd(t){t=t|0;return+ +xk[r[(r[t>>2]|0)+48>>2]&15](t)}function zd(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function Wd(t,e){t=t|0;e=+e;rk[r[(r[t>>2]|0)+44>>2]&31](t,e);return}function Gd(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function jd(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Hd(t,e){t=t|0;e=e|0;var i=0;r[5637]=(r[5637]|0)+1;i=Zl(99)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}UI(i,t,e,1);return i|0}function Xd(t,e,i){t=t|0;e=e|0;i=i|0;var n=0;r[5637]=(r[5637]|0)+1;n=Zl(99)|0;if(!n)n=0;else{r[(n+4+15&-16)+-4>>2]=n;n=n+4+15&-16}UI(n,t,e,i);return n|0}function Yd(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function qd(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function Kd(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Zd(t,e){t=+t;e=+e;var i=0;r[5637]=(r[5637]|0)+1;i=Zl(79)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[i+8>>2]=0;r[i+12>>2]=-1;r[i+16>>2]=1065353216;r[i+20>>2]=1065353216;r[i+24>>2]=1065353216;h[i+28>>2]=0.0;h[i+48>>2]=.03999999910593033;r[i+4>>2]=10;r[i>>2]=4976;r[i+56>>2]=0;h[i+32>>2]=e*.5;h[i+36>>2]=t;h[i+40>>2]=t;h[i+44>>2]=0.0;return i|0}function Qd(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function $d(t){t=t|0;return+ +xk[r[(r[t>>2]|0)+48>>2]&15](t)}function Jd(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function tp(t,e){t=t|0;e=+e;rk[r[(r[t>>2]|0)+44>>2]&31](t,e);return}function ep(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function ip(t,e){t=+t;e=+e;var i=0;r[5637]=(r[5637]|0)+1;i=Zl(79)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[i+8>>2]=0;r[i+12>>2]=-1;r[i+16>>2]=1065353216;r[i+20>>2]=1065353216;r[i+24>>2]=1065353216;h[i+28>>2]=0.0;h[i+48>>2]=.03999999910593033;r[i+4>>2]=10;r[i>>2]=5076;r[i+56>>2]=2;h[i+32>>2]=t;h[i+36>>2]=t;h[i+40>>2]=e*.5;h[i+44>>2]=0.0;return i|0}function np(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function sp(t){t=t|0;return+ +xk[r[(r[t>>2]|0)+48>>2]&15](t)}function rp(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function op(t,e){t=t|0;e=+e;rk[r[(r[t>>2]|0)+44>>2]&31](t,e);return}function ap(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function lp(t,e){t=+t;e=+e;var i=0;r[5637]=(r[5637]|0)+1;i=Zl(79)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[i+8>>2]=0;r[i+12>>2]=-1;r[i+16>>2]=1065353216;r[i+20>>2]=1065353216;r[i+24>>2]=1065353216;h[i+28>>2]=0.0;h[i+48>>2]=.03999999910593033;r[i>>2]=4876;r[i+4>>2]=10;r[i+56>>2]=1;h[i+32>>2]=t;h[i+36>>2]=e*.5;h[i+40>>2]=t;h[i+44>>2]=0.0;return i|0}function hp(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function cp(t){t=t|0;return+ +xk[r[(r[t>>2]|0)+48>>2]&15](t)}function _p(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function up(t,e){t=t|0;e=+e;rk[r[(r[t>>2]|0)+44>>2]&31](t,e);return}function dp(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function pp(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function fp(t){t=t|0;var e=0,i=0;while(1){e=Zl(5260)|0;if(e|0){i=6;break}e=r[5831]|0;r[5831]=e+0;if(!e){i=5;break}zk[e&3]()}if((i|0)==5){t=Zt(4)|0;r[t>>2]=8308;ce(t|0,2416,215)}else if((i|0)==6){VS(e,t);return e|0}return 0}function mp(t,e){t=t|0;e=e|0;return Rk[r[(r[t>>2]|0)+40>>2]&31](t,e)|0}function gp(t){t=t|0;return ck[r[(r[t>>2]|0)+36>>2]&127](t)|0}function bp(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function yp(t){t=t|0;if(r[t+204>>2]&3|0)return;if((r[t+216>>2]&-2|0)!=4)r[t+216>>2]=1;h[t+220>>2]=0.0;return}function vp(t,e){t=t|0;e=e|0;if(!e?r[t+204>>2]&3|0:0)return;if((r[t+216>>2]&-2|0)!=4)r[t+216>>2]=1;h[t+220>>2]=0.0;return}function Sp(t,e){t=t|0;e=e|0;r[t+216>>2]=e;return}function xp(t){t=t|0;return r[t+204>>2]|0}function wp(t){t=t|0;return r[t+192>>2]|0}function Cp(t){t=t|0;return t+4|0}function Tp(t){t=t|0;t=r[t+216>>2]|0;return(t|0)!=5&(t|0)!=2|0}function Ap(t){t=t|0;return(r[t+204>>2]&2|0)!=0|0}function Ep(t,e){t=t|0;e=e|0;if((r[t+216>>2]&-2|0)==4)return;r[t+216>>2]=e;return}function Mp(t,e,i){t=t|0;e=e|0;i=i|0;r[t+164>>2]=r[e>>2];r[t+164+4>>2]=r[e+4>>2];r[t+164+8>>2]=r[e+8>>2];r[t+164+12>>2]=r[e+12>>2];if(!(+h[e>>2]!=1.0)?!(+h[e+4>>2]!=1.0):0)i=+h[e+8>>2]!=1.0?i:0;r[t+180>>2]=i;return}function Rp(t,e){t=t|0;e=+e;h[t+256>>2]=e;return}function Ip(t,e){t=t|0;e=+e;h[t+252>>2]=e;return}function Pp(t,e){t=t|0;e=e|0;r[t+204>>2]=e;return}function Lp(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+8>>2]&127](t,e);return}function Dp(t,e){t=t|0;e=+e;h[t+184>>2]=e;return}function kp(t,e){t=t|0;e=+e;r[t+284>>2]=(r[t+284>>2]|0)+1;h[t+224>>2]=e;return}function Op(t,e){t=t|0;e=+e;r[t+284>>2]=(r[t+284>>2]|0)+1;h[t+228>>2]=e;return}function Fp(t,e){t=t|0;e=+e;r[t+284>>2]=(r[t+284>>2]|0)+1;h[t+232>>2]=e;return}function Bp(t,e){t=t|0;e=e|0;r[t+284>>2]=(r[t+284>>2]|0)+1;r[t+4>>2]=r[e>>2];r[t+4+4>>2]=r[e+4>>2];r[t+4+8>>2]=r[e+8>>2];r[t+4+12>>2]=r[e+12>>2];r[t+20>>2]=r[e+16>>2];r[t+20+4>>2]=r[e+16+4>>2];r[t+20+8>>2]=r[e+16+8>>2];r[t+20+12>>2]=r[e+16+12>>2];r[t+36>>2]=r[e+32>>2];r[t+36+4>>2]=r[e+32+4>>2];r[t+36+8>>2]=r[e+32+8>>2];r[t+36+12>>2]=r[e+32+12>>2];r[t+52>>2]=r[e+48>>2];r[t+52+4>>2]=r[e+48+4>>2];r[t+52+8>>2]=r[e+48+8>>2];r[t+52+12>>2]=r[e+48+12>>2];return}function Np(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Up(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function Vp(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function zp(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Wp(t,e){t=t|0;e=e|0;jk[r[(r[t>>2]|0)+36>>2]&127](t,e,1,-1);return}function Gp(t,e,i){t=t|0;e=e|0;i=i|0;jk[r[(r[t>>2]|0)+36>>2]&127](t,e,i,-1);return}function jp(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;jk[r[(r[t>>2]|0)+36>>2]&127](t,e,i,n);return}function Hp(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;rw(t,e,i,n);return}function Xp(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0;n=_;_=_+48|0;s=r[e+192>>2]|0;jk[r[(r[s>>2]|0)+8>>2]&127](s,e+4|0,n+32|0,n+16|0);r[n>>2]=3544;r[n+4>>2]=e;r[n+8>>2]=t;r[n+12>>2]=i;t=r[t+68>>2]|0;jk[r[(r[t>>2]|0)+28>>2]&127](t,n+32|0,n+16|0,n);_=n;return}function Yp(t,e,i,n,s,r){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=+r;Yx(t,e,i,n,s,r);return}function qp(t){t=t|0;return r[t+68>>2]|0}function Kp(t){t=t|0;return t+28|0}function Zp(t){t=t|0;return r[t+24>>2]|0}function Qp(t){t=t|0;t=r[t+68>>2]|0;return ck[r[(r[t>>2]|0)+36>>2]&127](t)|0}function $p(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;jk[r[(r[t>>2]|0)+32>>2]&127](t,e,i,n);return}function Jp(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function tf(t,e,i){t=t|0;e=e|0;i=i|0;var s=0.0,o=0,a=0,l=0,c=0,u=0,d=0,p=0.0,f=0,m=0,g=0,b=0;f=_;_=_+128|0;r[t+72>>2]=(r[t+72>>2]|0)+1;r[f>>2]=r[e>>2];r[f+4>>2]=r[e+4>>2];r[f+8>>2]=r[e+8>>2];r[f+12>>2]=r[e+12>>2];r[f+16>>2]=r[e+16>>2];r[f+16+4>>2]=r[e+16+4>>2];r[f+16+8>>2]=r[e+16+8>>2];r[f+16+12>>2]=r[e+16+12>>2];r[f+32>>2]=r[e+32>>2];r[f+32+4>>2]=r[e+32+4>>2];r[f+32+8>>2]=r[e+32+8>>2];r[f+32+12>>2]=r[e+32+12>>2];r[f+48>>2]=r[e+48>>2];r[f+48+4>>2]=r[e+48+4>>2];r[f+48+8>>2]=r[e+48+8>>2];r[f+48+12>>2]=r[e+48+12>>2];d=r[i+4>>2]|0;p=+xk[r[(r[i>>2]|0)+48>>2]&15](i);jk[r[(r[i>>2]|0)+8>>2]&127](i,e,f+112|0,f+96|0);s=+h[f+112>>2];if(+h[t+36>>2]>s)h[t+36>>2]=s;s=+h[f+96>>2];if(+h[t+52>>2]<s)h[t+52>>2]=s;s=+h[f+112+4>>2];if(+h[t+40>>2]>s)h[t+40>>2]=s;s=+h[f+96+4>>2];if(+h[t+56>>2]<s)h[t+56>>2]=s;s=+h[f+112+8>>2];if(+h[t+44>>2]>s)h[t+44>>2]=s;s=+h[f+96+8>>2];if(+h[t+60>>2]<s)h[t+60>>2]=s;c=r[t+68>>2]|0;if(!c){c=t+20|0;l=0}else{r[f+64>>2]=r[f+112>>2];r[f+64+4>>2]=r[f+112+4>>2];r[f+64+8>>2]=r[f+112+8>>2];r[f+64+12>>2]=r[f+112+12>>2];r[f+64+16>>2]=r[f+96>>2];r[f+64+16+4>>2]=r[f+96+4>>2];r[f+64+16+8>>2]=r[f+96+8>>2];r[f+64+16+12>>2]=r[f+96+12>>2];l=r[t+20>>2]|0;e=r[c+4>>2]|0;if(!e){r[5637]=(r[5637]|0)+1;e=Zl(63)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}o=e;a=o+44|0;do{r[o>>2]=0;o=o+4|0}while((o|0)<(a|0))}else r[c+4>>2]=0;r[e+32>>2]=0;r[e+36>>2]=l;r[e+40>>2]=0;r[e>>2]=r[f+64>>2];r[e+4>>2]=r[f+64+4>>2];r[e+8>>2]=r[f+64+8>>2];r[e+12>>2]=r[f+64+12>>2];r[e+16>>2]=r[f+64+16>>2];r[e+20>>2]=r[f+64+20>>2];r[e+24>>2]=r[f+64+24>>2];r[e+28>>2]=r[f+64+28>>2];VP(c,r[c>>2]|0,e);r[c+12>>2]=(r[c+12>>2]|0)+1;c=t+20|0;l=e}e=r[c>>2]|0;if((e|0)==(r[t+24>>2]|0)?(u=e|0?e<<1:1,(e|0)<(u|0)):0){if(!u)a=0;else{r[5637]=(r[5637]|0)+1;e=Zl((u*80|3)+16|0)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}a=e;e=r[c>>2]|0}if((e|0)>0){o=0;do{m=a+(o*80|0)|0;g=r[t+28>>2]|0;b=g+(o*80|0)|0;r[m>>2]=r[b>>2];r[m+4>>2]=r[b+4>>2];r[m+8>>2]=r[b+8>>2];r[m+12>>2]=r[b+12>>2];m=a+(o*80|0)+16|0;b=g+(o*80|0)+16|0;r[m>>2]=r[b>>2];r[m+4>>2]=r[b+4>>2];r[m+8>>2]=r[b+8>>2];r[m+12>>2]=r[b+12>>2];m=a+(o*80|0)+32|0;b=g+(o*80|0)+32|0;r[m>>2]=r[b>>2];r[m+4>>2]=r[b+4>>2];r[m+8>>2]=r[b+8>>2];r[m+12>>2]=r[b+12>>2];m=a+(o*80|0)+48|0;b=g+(o*80|0)+48|0;r[m>>2]=r[b>>2];r[m+4>>2]=r[b+4>>2];r[m+8>>2]=r[b+8>>2];r[m+12>>2]=r[b+12>>2];m=a+(o*80|0)+64|0;g=g+(o*80|0)+64|0;r[m>>2]=r[g>>2];r[m+4>>2]=r[g+4>>2];r[m+8>>2]=r[g+8>>2];r[m+12>>2]=r[g+12>>2];o=o+1|0}while((o|0)!=(e|0))}e=r[t+28>>2]|0;if(e|0){if(n[t+32>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+28>>2]=0}n[t+32>>0]=1;r[t+28>>2]=a;r[t+24>>2]=u;e=r[c>>2]|0}b=r[t+28>>2]|0;g=b+(e*80|0)|0;r[g>>2]=r[f>>2];r[g+4>>2]=r[f+4>>2];r[g+8>>2]=r[f+8>>2];r[g+12>>2]=r[f+12>>2];g=b+(e*80|0)+16|0;r[g>>2]=r[f+16>>2];r[g+4>>2]=r[f+16+4>>2];r[g+8>>2]=r[f+16+8>>2];r[g+12>>2]=r[f+16+12>>2];g=b+(e*80|0)+32|0;r[g>>2]=r[f+32>>2];r[g+4>>2]=r[f+32+4>>2];r[g+8>>2]=r[f+32+8>>2];r[g+12>>2]=r[f+32+12>>2];g=b+(e*80|0)+48|0;r[g>>2]=r[f+48>>2];r[g+4>>2]=r[f+48+4>>2];r[g+8>>2]=r[f+48+8>>2];r[g+12>>2]=r[f+48+12>>2];b=b+(e*80|0)+64|0;r[b>>2]=i;r[b+4>>2]=d;h[b+8>>2]=p;r[b+12>>2]=l;r[c>>2]=(r[c>>2]|0)+1;_=f;return}function ef(){var t=0;r[5637]=(r[5637]|0)+1;t=Zl(115)|0;if(!t)t=0;else{r[(t+4+15&-16)+-4>>2]=t;t=t+4+15&-16}OC(t,1,0);return t|0}function nf(t){t=t|0;var e=0;r[5637]=(r[5637]|0)+1;e=Zl(115)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}OC(e,t,0);return e|0}function sf(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function rf(t,e){t=t|0;e=e|0;return r[(r[t+28>>2]|0)+(e*80|0)+64>>2]|0}function of(t){t=t|0;return+ +xk[r[(r[t>>2]|0)+48>>2]&15](t)}function af(t){t=t|0;return r[t+20>>2]|0}function lf(t,e){t=t|0;e=e|0;DC(t,e);return}function hf(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function cf(t,e){t=t|0;e=+e;rk[r[(r[t>>2]|0)+44>>2]&31](t,e);return}function _f(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function uf(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function df(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function pf(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function ff(t,e){t=+t;e=+e;var i=0;r[5637]=(r[5637]|0)+1;i=Zl(99)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[i+8>>2]=0;r[i+12>>2]=-1;r[i+16>>2]=1065353216;r[i+20>>2]=1065353216;r[i+24>>2]=1065353216;h[i+28>>2]=0.0;h[i+48>>2]=.03999999910593033;h[i+60>>2]=t;h[i+64>>2]=e;r[i+4>>2]=11;h[i+56>>2]=t/+G(+(t*t+e*e));r[i>>2]=5456;r[i+68>>2]=1;r[i+72>>2]=0;r[i+76>>2]=2;h[i+36>>2]=t;h[i+32>>2]=e;h[i+40>>2]=t;return i|0}function mf(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function gf(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function bf(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function yf(t,e){t=+t;e=+e;var i=0;r[5637]=(r[5637]|0)+1;i=Zl(99)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[i+8>>2]=0;r[i+12>>2]=-1;r[i+16>>2]=1065353216;r[i+20>>2]=1065353216;r[i+24>>2]=1065353216;h[i+28>>2]=0.0;h[i+48>>2]=.03999999910593033;h[i+60>>2]=t;h[i+64>>2]=e;r[i+4>>2]=11;h[i+56>>2]=t/+G(+(t*t+e*e));r[i>>2]=5356;r[i+68>>2]=0;r[i+72>>2]=2;r[i+76>>2]=1;h[i+32>>2]=t;h[i+40>>2]=e;h[i+36>>2]=t;return i|0}function vf(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function Sf(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function xf(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function wf(t,e){t=+t;e=+e;var i=0;r[5637]=(r[5637]|0)+1;i=Zl(99)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[i+8>>2]=0;r[i+12>>2]=-1;r[i+16>>2]=1065353216;r[i+20>>2]=1065353216;r[i+24>>2]=1065353216;h[i+28>>2]=0.0;h[i+48>>2]=.03999999910593033;r[i>>2]=5256;h[i+60>>2]=t;h[i+64>>2]=e;r[i+4>>2]=11;r[i+68>>2]=0;r[i+72>>2]=1;r[i+76>>2]=2;h[i+32>>2]=t;h[i+36>>2]=e;h[i+40>>2]=t;h[i+56>>2]=t/+G(+(t*t+e*e));return i|0}function Cf(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function Tf(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function Af(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Ef(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0;r[5637]=(r[5637]|0)+1;i=Zl(627)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}Bb(i,5,t);r[i>>2]=7132;o=i+300|0;r[o>>2]=r[e>>2];r[o+4>>2]=r[e+4>>2];r[o+8>>2]=r[e+8>>2];r[o+12>>2]=r[e+12>>2];s=i+316|0;r[s>>2]=r[e+16>>2];r[s+4>>2]=r[e+16+4>>2];r[s+8>>2]=r[e+16+8>>2];r[s+12>>2]=r[e+16+12>>2];t=i+332|0;r[t>>2]=r[e+32>>2];r[t+4>>2]=r[e+32+4>>2];r[t+8>>2]=r[e+32+8>>2];r[t+12>>2]=r[e+32+12>>2];a=i+348|0;r[a>>2]=r[e+48>>2];r[a+4>>2]=r[e+48+4>>2];r[a+8>>2]=r[e+48+8>>2];r[a+12>>2]=r[e+48+12>>2];e=i+364|0;n[i+527>>0]=0;r[e>>2]=r[o>>2];r[e+4>>2]=r[o+4>>2];r[e+8>>2]=r[o+8>>2];r[e+12>>2]=r[o+12>>2];e=i+380|0;r[e>>2]=r[s>>2];r[e+4>>2]=r[s+4>>2];r[e+8>>2]=r[s+8>>2];r[e+12>>2]=r[s+12>>2];e=i+396|0;r[e>>2]=r[t>>2];r[e+4>>2]=r[t+4>>2];r[e+8>>2]=r[t+8>>2];r[e+12>>2]=r[t+12>>2];e=i+412|0;n[i+524>>0]=0;n[i+525>>0]=0;n[i+526>>0]=0;n[i+552>>0]=0;r[e>>2]=0;r[e+4>>2]=0;r[e+8>>2]=0;r[e+12>>2]=0;h[i+572>>2]=-1.0;h[i+444>>2]=999999984306749440.0;h[i+448>>2]=999999984306749440.0;h[i+452>>2]=999999984306749440.0;h[i+428>>2]=1.0;h[i+432>>2]=.30000001192092896;h[i+436>>2]=1.0;h[i+440>>2]=.009999999776482582;h[i+456>>2]=.05000000074505806;r[i+592>>2]=0;h[i+596>>2]=0.0;h[i+600>>2]=.699999988079071;h[i+604>>2]=0.0;return i|0}function Mf(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0;r[5637]=(r[5637]|0)+1;o=Zl(627)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}r[o+4>>2]=5;r[o+8>>2]=-1;r[o+12>>2]=-1;h[o+16>>2]=3402823466385288598117041.0e14;n[o+20>>0]=1;n[o+21>>0]=0;r[o+24>>2]=-1;r[o+28>>2]=t;r[o+32>>2]=e;h[o+36>>2]=0.0;h[o+40>>2]=.30000001192092896;r[o+44>>2]=0;r[o>>2]=7132;e=o+300|0;r[e>>2]=r[i>>2];r[e+4>>2]=r[i+4>>2];r[e+8>>2]=r[i+8>>2];r[e+12>>2]=r[i+12>>2];e=o+316|0;r[e>>2]=r[i+16>>2];r[e+4>>2]=r[i+16+4>>2];r[e+8>>2]=r[i+16+8>>2];r[e+12>>2]=r[i+16+12>>2];e=o+332|0;r[e>>2]=r[i+32>>2];r[e+4>>2]=r[i+32+4>>2];r[e+8>>2]=r[i+32+8>>2];r[e+12>>2]=r[i+32+12>>2];e=o+348|0;r[e>>2]=r[i+48>>2];r[e+4>>2]=r[i+48+4>>2];r[e+8>>2]=r[i+48+8>>2];r[e+12>>2]=r[i+48+12>>2];i=o+364|0;r[i>>2]=r[s>>2];r[i+4>>2]=r[s+4>>2];r[i+8>>2]=r[s+8>>2];r[i+12>>2]=r[s+12>>2];i=o+380|0;r[i>>2]=r[s+16>>2];r[i+4>>2]=r[s+16+4>>2];r[i+8>>2]=r[s+16+8>>2];r[i+12>>2]=r[s+16+12>>2];i=o+396|0;r[i>>2]=r[s+32>>2];r[i+4>>2]=r[s+32+4>>2];r[i+8>>2]=r[s+32+8>>2];r[i+12>>2]=r[s+32+12>>2];i=o+412|0;r[i>>2]=r[s+48>>2];r[i+4>>2]=r[s+48+4>>2];r[i+8>>2]=r[s+48+8>>2];r[i+12>>2]=r[s+48+12>>2];n[o+552>>0]=0;r[o+524>>2]=0;h[o+572>>2]=-1.0;h[o+444>>2]=999999984306749440.0;h[o+448>>2]=999999984306749440.0;h[o+452>>2]=999999984306749440.0;h[o+428>>2]=1.0;h[o+432>>2]=.30000001192092896;h[o+436>>2]=1.0;h[o+440>>2]=.009999999776482582;h[o+456>>2]=.05000000074505806;r[o+592>>2]=0;h[o+596>>2]=0.0;h[o+600>>2]=.699999988079071;h[o+604>>2]=0.0;return o|0}function Rf(t,e){t=t|0;e=e|0;n[t+21>>0]=e&1;return}function If(t,e){t=t|0;e=e|0;n[t+552>>0]=e&1;return}function Pf(t){t=t|0;return+ +h[t+16>>2]}function Lf(t,e){t=t|0;e=e|0;n[t+524>>0]=e&1;return}function Df(t,e){t=t|0;e=+e;h[t+16>>2]=e;return}function kf(t,e){t=t|0;e=+e;h[t+440>>2]=e;return}function Of(t,e,i){t=t|0;e=e|0;i=+i;switch(e|0){case 3:{h[t+452>>2]=i;return}case 4:{h[t+448>>2]=i;return}case 5:{h[t+444>>2]=i;return}default:return}}function Ff(t,e){t=t|0;e=+e;h[t+572>>2]=e;n[t+553>>0]=1;return}function Bf(t,e){t=t|0;e=+e;h[t+572>>2]=e;n[t+553>>0]=0;return}function Nf(t,e){t=t|0;e=e|0;VE(t,e);return}function Uf(t,e){t=t|0;e=e|0;var i=0,n=0.0,s=0.0,r=0.0,o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0;i=_;_=_+48|0;Kx(t+364|0,i+16|0);o=-+h[i+16>>2];s=-+h[i+16+4>>2];u=-+h[i+16+8>>2];c=+h[i+16+12>>2];r=+h[e>>2];d=+h[e+12>>2];l=+h[e+8>>2];a=+h[e+4>>2];Kx(t+300|0,i);f=+h[i>>2];m=+h[i+12>>2];n=+h[i+8>>2];p=+h[i+4>>2];h[i+32>>2]=f*(c*d-r*o-a*s-l*u)+(c*r+d*o+l*s-a*u)*m+(r*u+(d*s+c*a)-l*o)*n-(d*u+c*l+a*o-r*s)*p;h[i+32+4>>2]=f*(d*u+c*l+a*o-r*s)+(m*(r*u+(d*s+c*a)-l*o)+(c*d-r*o-a*s-l*u)*p)-(c*r+d*o+l*s-a*u)*n;h[i+32+8>>2]=m*(d*u+c*l+a*o-r*s)+(c*d-r*o-a*s-l*u)*n+(c*r+d*o+l*s-a*u)*p-f*(r*u+(d*s+c*a)-l*o);h[i+32+12>>2]=(c*d-r*o-a*s-l*u)*m-f*(c*r+d*o+l*s-a*u)-(r*u+(d*s+c*a)-l*o)*p-(d*u+c*l+a*o-r*s)*n;VE(t,i+32|0);_=i;return}function Vf(t){t=t|0;if(!t)return;Ql(t);return}function zf(){var t=0,e=0;while(1){t=Zl(12)|0;if(t|0){e=6;break}t=r[5831]|0;r[5831]=t+0;if(!t){e=5;break}zk[t&3]()}if((e|0)==5){e=Zt(4)|0;r[e>>2]=8308;ce(e|0,2416,215)}else if((e|0)==6){h[t>>2]=.30000001192092896;h[t+4>>2]=1.0;h[t+8>>2]=0.0;return t|0}return 0}function Wf(t){t=t|0;return+ +h[t+4>>2]}function Gf(t){t=t|0;return+ +h[t+8>>2]}function jf(t){t=t|0;return+ +h[t>>2]}function Hf(t,e){t=t|0;e=+e;h[t+4>>2]=e;return}function Xf(t,e){t=t|0;e=+e;h[t+8>>2]=e;return}function Yf(t,e){t=t|0;e=+e;h[t>>2]=e;return}function qf(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Kf(t){t=t|0;if(!t)return;Ql(t);return}function Zf(t){t=t|0;return~~+h[t+48>>2]|0}function Qf(t){t=t|0;return(r[t+44>>2]|0)!=0|0}function $f(t,e){t=t|0;e=e|0;h[t+48>>2]=+(e|0);return}function Jf(t,e){t=t|0;e=e|0;r[t+44>>2]=e&1;return}function tm(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function em(t,e){t=t|0;e=e|0;gT(t,e,1);return}function im(t,e,i){t=t|0;e=e|0;i=i|0;gT(t,e,i);return}function nm(){var t=0;r[5637]=(r[5637]|0)+1;t=Zl(135)|0;if(!t)t=0;else{r[(t+4+15&-16)+-4>>2]=t;t=t+4+15&-16}mT(t,0,0,16);return t|0}function sm(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function rm(t){t=t|0;return+ +xk[r[(r[t>>2]|0)+48>>2]&15](t)}function om(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function am(t,e){t=t|0;e=+e;rk[r[(r[t>>2]|0)+44>>2]&31](t,e);return}function lm(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function hm(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function cm(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function _m(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function um(t){t=t|0;var e=0;r[5637]=(r[5637]|0)+1;e=Zl(119)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}HT(e,t,1);return e|0}function dm(t,e){t=t|0;e=e|0;var i=0;r[5637]=(r[5637]|0)+1;i=Zl(119)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}HT(i,t,e);return i|0}function pm(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function fm(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function mm(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function gm(t){t=t|0;var e=0;r[5637]=(r[5637]|0)+1;e=Zl(79)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}fA(e,t);r[e>>2]=5960;r[e+56>>2]=0;return e|0}function bm(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function ym(t){t=t|0;return+ +xk[r[(r[t>>2]|0)+48>>2]&15](t)}function vm(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function Sm(t,e){t=t|0;e=+e;rk[r[(r[t>>2]|0)+44>>2]&31](t,e);return}function xm(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function wm(t){t=t|0;var e=0;r[5637]=(r[5637]|0)+1;e=Zl(79)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}fA(e,t);r[e>>2]=6064;r[e+56>>2]=2;return e|0}function Cm(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function Tm(t){t=t|0;return+ +xk[r[(r[t>>2]|0)+48>>2]&15](t)}function Am(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function Em(t,e){t=t|0;e=+e;rk[r[(r[t>>2]|0)+44>>2]&31](t,e);return}function Mm(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Rm(t){t=t|0;var e=0;r[5637]=(r[5637]|0)+1;e=Zl(79)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}fA(e,t);return e|0}function Im(t,e,i){t=t|0;e=+e;i=i|0;fk[r[(r[t>>2]|0)+32>>2]&15](t,e,i);return}function Pm(t){t=t|0;return+ +xk[r[(r[t>>2]|0)+48>>2]&15](t)}function Lm(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+24>>2]&127](t,e);return}function Dm(t,e){t=t|0;e=+e;rk[r[(r[t>>2]|0)+44>>2]&31](t,e);return}function km(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Om(){var t=0,e=0;while(1){t=Zl(196)|0;if(t|0){e=6;break}t=r[5831]|0;r[5831]=t+0;if(!t){e=5;break}zk[t&3]()}if((e|0)==5){e=Zt(4)|0;r[e>>2]=8308;ce(e|0,2416,215)}else if((e|0)==6){gL(t,0);return t|0}return 0}function Fm(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Bm(){var t=0,e=0,i=0;i=_;_=_+32|0;while(1){t=Zl(92)|0;if(t|0){e=6;break}t=r[5831]|0;r[5831]=t+0;if(!t){e=5;break}zk[t&3]()}if((e|0)==5){i=Zt(4)|0;r[i>>2]=8308;ce(i|0,2416,215)}else if((e|0)==6){r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=4096;r[i+12>>2]=4096;r[i+16>>2]=0;r[i+20>>2]=1;KM(t,i);_=i;return t|0}return 0}function Nm(t){t=t|0;var e=0,i=0;while(1){e=Zl(92)|0;if(e|0){i=6;break}e=r[5831]|0;r[5831]=e+0;if(!e){i=5;break}zk[e&3]()}if((i|0)==5){t=Zt(4)|0;r[t>>2]=8308;ce(t|0,2416,215)}else if((i|0)==6){KM(e,t);return e|0}return 0}function Um(t){t=t|0;if(!t)return;Ql(t);return}function Vm(){var t=0,e=0;while(1){t=Zl(24)|0;if(t|0){e=6;break}t=r[5831]|0;r[5831]=t+0;if(!t){e=5;break}zk[t&3]()}if((e|0)==5){e=Zt(4)|0;r[e>>2]=8308;ce(e|0,2416,215)}else if((e|0)==6){r[t>>2]=0;r[t+4>>2]=0;r[t+8>>2]=4096;r[t+12>>2]=4096;r[t+16>>2]=0;r[t+20>>2]=1;return t|0}return 0}function zm(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Wm(){var t=0,e=0;r[5637]=(r[5637]|0)+1;t=Zl(219)|0;if(!t)t=0;else{r[(t+4+15&-16)+-4>>2]=t;t=t+4+15&-16}if(!(n[19848]|0)){n[19848]=1;if(!(n[19856]|0)){n[19856]=1;r[5017]=1065353216;r[5018]=0;r[5019]=0;r[5020]=0;r[5021]=0;r[5022]=1065353216;r[5023]=0;r[5024]=0;r[5025]=0;r[5026]=0;r[5027]=1065353216;h[5028]=0.0}r[5029]=r[5017];r[5030]=r[5018];r[5031]=r[5019];r[5032]=r[5020];r[5033]=r[5021];r[5034]=r[5022];r[5035]=r[5023];r[5036]=r[5024];r[5037]=r[5025];r[5038]=r[5026];r[5039]=r[5027];r[5040]=r[5028];r[5041]=0;r[5042]=0;r[5043]=0;r[5044]=0}if(!(n[19848]|0)){n[19848]=1;if(!(n[19856]|0)){n[19856]=1;r[5017]=1065353216;r[5018]=0;r[5019]=0;r[5020]=0;r[5021]=0;r[5022]=1065353216;r[5023]=0;r[5024]=0;r[5025]=0;r[5026]=0;r[5027]=1065353216;h[5028]=0.0}r[5029]=r[5017];r[5030]=r[5018];r[5031]=r[5019];r[5032]=r[5020];r[5033]=r[5021];r[5034]=r[5022];r[5035]=r[5023];r[5036]=r[5024];r[5037]=r[5025];r[5038]=r[5026];r[5039]=r[5027];r[5040]=r[5028];r[5041]=0;r[5042]=0;r[5043]=0;r[5044]=0}r[t>>2]=8060;e=t+4|0;r[e>>2]=r[5029];r[e+4>>2]=r[5030];r[e+8>>2]=r[5031];r[e+12>>2]=r[5032];e=t+20|0;r[e>>2]=r[5033];r[e+4>>2]=r[5034];r[e+8>>2]=r[5035];r[e+12>>2]=r[5036];e=t+36|0;r[e>>2]=r[5037];r[e+4>>2]=r[5038];r[e+8>>2]=r[5039];r[e+12>>2]=r[5040];e=t+52|0;r[e>>2]=r[5041];r[e+4>>2]=r[5042];r[e+8>>2]=r[5043];r[e+12>>2]=r[5044];e=t+68|0;r[e>>2]=r[5029];r[e+4>>2]=r[5030];r[e+8>>2]=r[5031];r[e+12>>2]=r[5032];e=t+84|0;r[e>>2]=r[5033];r[e+4>>2]=r[5034];r[e+8>>2]=r[5035];r[e+12>>2]=r[5036];e=t+100|0;r[e>>2]=r[5037];r[e+4>>2]=r[5038];r[e+8>>2]=r[5039];r[e+12>>2]=r[5040];e=t+116|0;r[e>>2]=r[5041];r[e+4>>2]=r[5042];r[e+8>>2]=r[5043];r[e+12>>2]=r[5044];e=t+132|0;r[e>>2]=r[5029];r[e+4>>2]=r[5030];r[e+8>>2]=r[5031];r[e+12>>2]=r[5032];e=t+148|0;r[e>>2]=r[5033];r[e+4>>2]=r[5034];r[e+8>>2]=r[5035];r[e+12>>2]=r[5036];e=t+164|0;r[e>>2]=r[5037];r[e+4>>2]=r[5038];r[e+8>>2]=r[5039];r[e+12>>2]=r[5040];e=t+180|0;r[e>>2]=r[5041];r[e+4>>2]=r[5042];r[e+8>>2]=r[5043];r[e+12>>2]=r[5044];r[t+196>>2]=0;return t|0}function Gm(t){t=t|0;return}function jm(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function Hm(t,e){t=t|0;e=e|0;var i=0.0,n=0.0,s=0.0,r=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0;g=+h[t+68>>2];p=+h[t+84>>2];_=+h[t+100>>2];m=+h[t+72>>2];d=+h[t+88>>2];l=+h[t+104>>2];f=+h[t+76>>2];u=+h[t+92>>2];o=+h[t+108>>2];T=-+h[t+116>>2];C=-+h[t+120>>2];i=-+h[t+124>>2];w=+h[t+4>>2];x=+h[t+8>>2];S=+h[t+12>>2];v=+h[t+20>>2];y=+h[t+24>>2];b=+h[t+28>>2];c=+h[t+36>>2];a=+h[t+40>>2];r=+h[t+44>>2];s=w*(g*T+p*C+_*i)+(m*T+d*C+l*i)*x+(f*T+u*C+o*i)*S+ +h[t+52>>2];n=(g*T+p*C+_*i)*v+(m*T+d*C+l*i)*y+(f*T+u*C+o*i)*b+ +h[t+56>>2];i=(g*T+p*C+_*i)*c+(m*T+d*C+l*i)*a+(f*T+u*C+o*i)*r+ +h[t+60>>2];h[e>>2]=g*w+m*x+f*S;h[e+4>>2]=p*w+d*x+u*S;h[e+8>>2]=_*w+l*x+o*S;h[e+12>>2]=0.0;h[e+16>>2]=g*v+m*y+f*b;h[e+20>>2]=p*v+d*y+u*b;h[e+24>>2]=_*v+l*y+o*b;h[e+28>>2]=0.0;h[e+32>>2]=g*c+m*a+f*r;h[e+36>>2]=p*c+d*a+u*r;h[e+40>>2]=_*c+l*a+o*r;h[e+44>>2]=0.0;h[e+48>>2]=s;h[e+52>>2]=n;h[e+56>>2]=i;h[e+60>>2]=0.0;return}function Xm(t,e){t=t|0;e=e|0;var i=0.0,n=0.0,s=0.0,r=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0;g=+h[t+68>>2];w=+h[e>>2];m=+h[t+84>>2];x=+h[e+4>>2];f=+h[t+100>>2];S=+h[e+8>>2];p=+h[t+72>>2];d=+h[t+88>>2];u=+h[t+104>>2];_=+h[t+76>>2];l=+h[t+92>>2];o=+h[t+108>>2];v=+h[e+16>>2];y=+h[e+20>>2];b=+h[e+24>>2];c=+h[e+32>>2];a=+h[e+36>>2];r=+h[e+40>>2];T=+h[t+116>>2];C=+h[t+120>>2];i=+h[t+124>>2];s=+h[e+48>>2]+(w*T+x*C+S*i);n=v*T+y*C+b*i+ +h[e+52>>2];i=c*T+a*C+r*i+ +h[e+56>>2];h[t+4>>2]=g*w+m*x+f*S;h[t+8>>2]=w*p+x*d+S*u;h[t+12>>2]=w*_+x*l+S*o;h[t+16>>2]=0.0;h[t+20>>2]=g*v+m*y+f*b;h[t+24>>2]=p*v+d*y+u*b;h[t+28>>2]=_*v+l*y+o*b;h[t+32>>2]=0.0;h[t+36>>2]=g*c+m*a+f*r;h[t+40>>2]=p*c+d*a+u*r;h[t+44>>2]=_*c+l*a+o*r;h[t+48>>2]=0.0;h[t+52>>2]=s;h[t+56>>2]=n;h[t+60>>2]=i;h[t+64>>2]=0.0;return}function Ym(t){t=t|0;var e=0,i=0;r[5637]=(r[5637]|0)+1;e=Zl(219)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}if(!(n[19848]|0)){n[19848]=1;if(!(n[19856]|0)){n[19856]=1;r[5017]=1065353216;r[5018]=0;r[5019]=0;r[5020]=0;r[5021]=0;r[5022]=1065353216;r[5023]=0;r[5024]=0;r[5025]=0;r[5026]=0;r[5027]=1065353216;h[5028]=0.0}r[5029]=r[5017];r[5030]=r[5018];r[5031]=r[5019];r[5032]=r[5020];r[5033]=r[5021];r[5034]=r[5022];r[5035]=r[5023];r[5036]=r[5024];r[5037]=r[5025];r[5038]=r[5026];r[5039]=r[5027];r[5040]=r[5028];r[5041]=0;r[5042]=0;r[5043]=0;r[5044]=0}r[e>>2]=8060;i=e+4|0;r[i>>2]=r[t>>2];r[i+4>>2]=r[t+4>>2];r[i+8>>2]=r[t+8>>2];r[i+12>>2]=r[t+12>>2];i=e+20|0;r[i>>2]=r[t+16>>2];r[i+4>>2]=r[t+16+4>>2];r[i+8>>2]=r[t+16+8>>2];r[i+12>>2]=r[t+16+12>>2];i=e+36|0;r[i>>2]=r[t+32>>2];r[i+4>>2]=r[t+32+4>>2];r[i+8>>2]=r[t+32+8>>2];r[i+12>>2]=r[t+32+12>>2];i=e+52|0;r[i>>2]=r[t+48>>2];r[i+4>>2]=r[t+48+4>>2];r[i+8>>2]=r[t+48+8>>2];r[i+12>>2]=r[t+48+12>>2];i=e+68|0;r[i>>2]=r[5029];r[i+4>>2]=r[5030];r[i+8>>2]=r[5031];r[i+12>>2]=r[5032];i=e+84|0;r[i>>2]=r[5033];r[i+4>>2]=r[5034];r[i+8>>2]=r[5035];r[i+12>>2]=r[5036];i=e+100|0;r[i>>2]=r[5037];r[i+4>>2]=r[5038];r[i+8>>2]=r[5039];r[i+12>>2]=r[5040];i=e+116|0;r[i>>2]=r[5041];r[i+4>>2]=r[5042];r[i+8>>2]=r[5043];r[i+12>>2]=r[5044];i=e+132|0;r[i>>2]=r[t>>2];r[i+4>>2]=r[t+4>>2];r[i+8>>2]=r[t+8>>2];r[i+12>>2]=r[t+12>>2];i=e+148|0;r[i>>2]=r[t+16>>2];r[i+4>>2]=r[t+16+4>>2];r[i+8>>2]=r[t+16+8>>2];r[i+12>>2]=r[t+16+12>>2];i=e+164|0;r[i>>2]=r[t+32>>2];r[i+4>>2]=r[t+32+4>>2];r[i+8>>2]=r[t+32+8>>2];r[i+12>>2]=r[t+32+12>>2];i=e+180|0;r[i>>2]=r[t+48>>2];r[i+4>>2]=r[t+48+4>>2];r[i+8>>2]=r[t+48+8>>2];r[i+12>>2]=r[t+48+12>>2];r[e+196>>2]=0;return e|0}function qm(t,e){t=t|0;e=e|0;var i=0,n=0;r[5637]=(r[5637]|0)+1;i=Zl(219)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[i>>2]=8060;n=i+4|0;r[n>>2]=r[t>>2];r[n+4>>2]=r[t+4>>2];r[n+8>>2]=r[t+8>>2];r[n+12>>2]=r[t+12>>2];n=i+20|0;r[n>>2]=r[t+16>>2];r[n+4>>2]=r[t+16+4>>2];r[n+8>>2]=r[t+16+8>>2];r[n+12>>2]=r[t+16+12>>2];n=i+36|0;r[n>>2]=r[t+32>>2];r[n+4>>2]=r[t+32+4>>2];r[n+8>>2]=r[t+32+8>>2];r[n+12>>2]=r[t+32+12>>2];n=i+52|0;r[n>>2]=r[t+48>>2];r[n+4>>2]=r[t+48+4>>2];r[n+8>>2]=r[t+48+8>>2];r[n+12>>2]=r[t+48+12>>2];n=i+68|0;r[n>>2]=r[e>>2];r[n+4>>2]=r[e+4>>2];r[n+8>>2]=r[e+8>>2];r[n+12>>2]=r[e+12>>2];n=i+84|0;r[n>>2]=r[e+16>>2];r[n+4>>2]=r[e+16+4>>2];r[n+8>>2]=r[e+16+8>>2];r[n+12>>2]=r[e+16+12>>2];n=i+100|0;r[n>>2]=r[e+32>>2];r[n+4>>2]=r[e+32+4>>2];r[n+8>>2]=r[e+32+8>>2];r[n+12>>2]=r[e+32+12>>2];n=i+116|0;r[n>>2]=r[e+48>>2];r[n+4>>2]=r[e+48+4>>2];r[n+8>>2]=r[e+48+8>>2];r[n+12>>2]=r[e+48+12>>2];e=i+132|0;r[e>>2]=r[t>>2];r[e+4>>2]=r[t+4>>2];r[e+8>>2]=r[t+8>>2];r[e+12>>2]=r[t+12>>2];e=i+148|0;r[e>>2]=r[t+16>>2];r[e+4>>2]=r[t+16+4>>2];r[e+8>>2]=r[t+16+8>>2];r[e+12>>2]=r[t+16+12>>2];e=i+164|0;r[e>>2]=r[t+32>>2];r[e+4>>2]=r[t+32+4>>2];r[e+8>>2]=r[t+32+8>>2];r[e+12>>2]=r[t+32+12>>2];e=i+180|0;r[e>>2]=r[t+48>>2];r[e+4>>2]=r[t+48+4>>2];r[e+8>>2]=r[t+48+8>>2];r[e+12>>2]=r[t+48+12>>2];r[i+196>>2]=0;return i|0}function Km(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+8>>2]&127](t,e);return}function Zm(t){t=t|0;return t+4|0}function Qm(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+12>>2]&127](t,e);return}function $m(t,e){t=t|0;e=e|0;r[t+4>>2]=r[e>>2];r[t+4+4>>2]=r[e+4>>2];r[t+4+8>>2]=r[e+8>>2];r[t+4+12>>2]=r[e+12>>2];r[t+20>>2]=r[e+16>>2];r[t+20+4>>2]=r[e+16+4>>2];r[t+20+8>>2]=r[e+16+8>>2];r[t+20+12>>2]=r[e+16+12>>2];r[t+36>>2]=r[e+32>>2];r[t+36+4>>2]=r[e+32+4>>2];r[t+36+8>>2]=r[e+32+8>>2];r[t+36+12>>2]=r[e+32+12>>2];r[t+52>>2]=r[e+48>>2];r[t+52+4>>2]=r[e+48+4>>2];r[t+52+8>>2]=r[e+48+8>>2];r[t+52+12>>2]=r[e+48+12>>2];return}function Jm(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function tg(t){t=t|0;var e=0,i=0;while(1){e=Zl(8)|0;if(e|0){i=6;break}e=r[5831]|0;r[5831]=e+0;if(!e){i=5;break}zk[e&3]()}if((i|0)==5){t=Zt(4)|0;r[t>>2]=8308;ce(t|0,2416,215)}else if((i|0)==6){r[e>>2]=7988;r[e+4>>2]=t;return e|0}return 0}function eg(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function ig(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+64>>2]&127](t,e);return}function ng(t,e){t=t|0;e=e|0;jk[r[(r[t>>2]|0)+36>>2]&127](t,e,2,-3);return}function sg(t,e,i){t=t|0;e=e|0;i=i|0;jk[r[(r[t>>2]|0)+36>>2]&127](t,e,i,-3);return}function rg(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;jk[r[(r[t>>2]|0)+36>>2]&127](t,e,i,n);return}function og(t,e){t=t|0;e=e|0;Vk[r[(r[t>>2]|0)+56>>2]&127](t,e,0);return}function ag(t,e,i){t=t|0;e=e|0;i=i|0;Vk[r[(r[t>>2]|0)+56>>2]&127](t,e,i);return}function lg(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+84>>2]&127](t,e);return}function hg(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;jk[r[(r[t>>2]|0)+88>>2]&127](t,e,i,n);return}function cg(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0;r[5637]=(r[5637]|0)+1;s=Zl(343)|0;if(!s)a=0;else{r[(s+4+15&-16)+-4>>2]=s;a=s+4+15&-16}n[a+20>>0]=1;r[a+16>>2]=0;r[a+8>>2]=0;r[a+12>>2]=0;r[a+24>>2]=t;h[a+28>>2]=0.0;r[a+32>>2]=0;r[a+36>>2]=1;h[a+40>>2]=1.0;n[a+44>>0]=1;r[a+48>>2]=0;n[a+52>>0]=0;n[a+53>>0]=1;n[a+54>>0]=1;h[a+56>>2]=.03999999910593033;n[a+60>>0]=0;h[a+64>>2]=0.0;r[a+68>>2]=e;r[a+72>>2]=0;n[a+76>>0]=1;r[a+80>>2]=0;r[a+84>>2]=0;r[a+88>>2]=0;h[a+92>>2]=.6000000238418579;h[a+96>>2]=1.0;h[a+100>>2]=.30000001192092896;h[a+104>>2]=.01666666753590107;h[a+108>>2]=0.0;h[a+116>>2]=20.0;r[a+112>>2]=10;h[a+124>>2]=.20000000298023224;h[a+128>>2]=.800000011920929;h[a+132>>2]=0.0;h[a+120>>2]=1.0;r[a+136>>2]=1;h[a+140>>2]=-.03999999910593033;h[a+144>>2]=.10000000149011612;h[a+148>>2]=0.0;h[a+152>>2]=.8500000238418579;r[a+156>>2]=260;r[a+160>>2]=2;r[a+164>>2]=128;h[a+168>>2]=100.0;h[a+172>>2]=1000000015047466219876688.0e6;r[a>>2]=7656;n[a+192>>0]=1;r[a+188>>2]=0;r[a+180>>2]=0;r[a+184>>2]=0;e=a+196|0;r[e>>2]=0;o=a+200|0;r[o>>2]=i;n[a+224>>0]=1;r[a+220>>2]=0;r[a+212>>2]=0;r[a+216>>2]=0;n[a+244>>0]=1;r[a+240>>2]=0;r[a+232>>2]=0;r[a+236>>2]=0;r[a+248>>2]=0;r[a+252>>2]=-1054867456;s=a+256|0;n[a+274>>0]=0;n[a+275>>0]=0;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;n[a+292>>0]=1;r[a+288>>2]=0;r[a+280>>2]=0;r[a+284>>2]=0;r[a+296>>2]=0;n[a+300>>0]=1;n[a+320>>0]=1;r[a+316>>2]=0;r[a+308>>2]=0;r[a+312>>2]=0;if(!i){r[5637]=(r[5637]|0)+1;s=Zl(223)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}r[s>>2]=7540;n[s+20>>0]=1;r[s+16>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;n[s+40>>0]=1;r[s+36>>2]=0;r[s+28>>2]=0;r[s+32>>2]=0;n[s+60>>0]=1;r[s+56>>2]=0;r[s+48>>2]=0;r[s+52>>2]=0;n[s+80>>0]=1;r[s+76>>2]=0;r[s+68>>2]=0;r[s+72>>2]=0;n[s+100>>0]=1;r[s+96>>2]=0;r[s+88>>2]=0;r[s+92>>2]=0;n[s+120>>0]=1;r[s+116>>2]=0;r[s+108>>2]=0;r[s+112>>2]=0;n[s+140>>0]=1;r[s+136>>2]=0;r[s+128>>2]=0;r[s+132>>2]=0;n[s+160>>0]=1;r[s+156>>2]=0;r[s+148>>2]=0;r[s+152>>2]=0;n[s+180>>0]=1;r[s+176>>2]=0;r[s+168>>2]=0;r[s+172>>2]=0;r[s+192>>2]=13;r[s+196>>2]=14;r[s+200>>2]=0;r[o>>2]=s;n[a+273>>0]=1}else n[a+273>>0]=0;r[5637]=(r[5637]|0)+1;s=Zl(87)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}r[s>>2]=4488;n[s+20>>0]=1;r[s+16>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;n[s+40>>0]=1;r[s+36>>2]=0;r[s+28>>2]=0;r[s+32>>2]=0;n[s+60>>0]=1;r[s+56>>2]=0;r[s+48>>2]=0;r[s+52>>2]=0;n[s+64>>0]=1;r[a+204>>2]=s;n[a+272>>0]=1;r[5637]=(r[5637]|0)+1;s=Zl(107)|0;if(!s){i=0;s=r[o>>2]|0;r[i>>2]=7896;o=i+4|0;r[o>>2]=0;o=i+8|0;r[o>>2]=s;o=i+12|0;r[o>>2]=0;o=i+16|0;r[o>>2]=0;o=i+20|0;r[o>>2]=0;o=i+24|0;r[o>>2]=t;t=i+44|0;n[t>>0]=1;t=i+40|0;r[t>>2]=0;t=i+32|0;r[t>>2]=0;t=i+36|0;r[t>>2]=0;t=i+64|0;n[t>>0]=1;t=i+60|0;r[t>>2]=0;t=i+52|0;r[t>>2]=0;t=i+56|0;r[t>>2]=0;t=i+84|0;n[t>>0]=1;t=i+80|0;r[t>>2]=0;t=i+72|0;r[t>>2]=0;t=i+76|0;r[t>>2]=0;r[e>>2]=i;return a|0}r[(s+4+15&-16)+-4>>2]=s;i=s+4+15&-16;s=r[o>>2]|0;r[i>>2]=7896;o=i+4|0;r[o>>2]=0;o=i+8|0;r[o>>2]=s;o=i+12|0;r[o>>2]=0;o=i+16|0;r[o>>2]=0;o=i+20|0;r[o>>2]=0;o=i+24|0;r[o>>2]=t;t=i+44|0;n[t>>0]=1;t=i+40|0;r[t>>2]=0;t=i+32|0;r[t>>2]=0;t=i+36|0;r[t>>2]=0;t=i+64|0;n[t>>0]=1;t=i+60|0;r[t>>2]=0;t=i+52|0;r[t>>2]=0;t=i+56|0;r[t>>2]=0;t=i+84|0;n[t>>0]=1;t=i+80|0;r[t>>2]=0;t=i+72|0;r[t>>2]=0;t=i+76|0;r[t>>2]=0;r[e>>2]=i;return a|0}function _g(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;rw(t,e,i,n);return}function ug(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0;n=_;_=_+48|0;s=r[e+192>>2]|0;jk[r[(r[s>>2]|0)+8>>2]&127](s,e+4|0,n+32|0,n+16|0);r[n>>2]=3544;r[n+4>>2]=e;r[n+8>>2]=t;r[n+12>>2]=i;t=r[t+68>>2]|0;jk[r[(r[t>>2]|0)+28>>2]&127](t,n+32|0,n+16|0,n);_=n;return}function dg(t,e,i,n,s,r){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=+r;Yx(t,e,i,n,s,r);return}function pg(t){t=t|0;return r[t+68>>2]|0}function fg(t){t=t|0;return t+28|0}function mg(t){t=t|0;return r[t+24>>2]|0}function gg(t){t=t|0;var e=0;e=_;_=_+16|0;if(!(n[19896]|0))n[19896]=1;lk[r[(r[t>>2]|0)+76>>2]&127](e,t);r[5650]=r[e>>2];r[5651]=r[e+4>>2];r[5652]=r[e+8>>2];r[5653]=r[e+12>>2];_=e;return 22600}function bg(t){t=t|0;t=r[t+68>>2]|0;return ck[r[(r[t>>2]|0)+36>>2]&127](t)|0}function yg(t){t=t|0;var e=0,i=0;if(n[19904]|0){e=t+92|0;t=22616;i=t+84|0;do{r[t>>2]=r[e>>2];t=t+4|0;e=e+4|0}while((t|0)<(i|0));return 22616}n[19904]=1;h[5654]=.6000000238418579;h[5655]=1.0;h[5656]=.30000001192092896;h[5657]=.01666666753590107;h[5658]=0.0;h[5660]=20.0;r[5659]=10;h[5662]=.20000000298023224;h[5663]=.800000011920929;h[5664]=0.0;h[5661]=1.0;r[5665]=1;h[5666]=-.03999999910593033;h[5667]=.10000000149011612;h[5668]=0.0;h[5669]=.8500000238418579;r[5670]=260;r[5671]=2;r[5672]=128;h[5673]=100.0;h[5674]=1000000015047466219876688.0e6;e=t+92|0;t=22616;i=t+84|0;do{r[t>>2]=r[e>>2];t=t+4|0;e=e+4|0}while((t|0)<(i|0));return 22616}function vg(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;jk[r[(r[t>>2]|0)+32>>2]&127](t,e,i,n);return}function Sg(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+68>>2]&127](t,e);return}function xg(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+60>>2]&127](t,e);return}function wg(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+92>>2]&127](t,e);return}function Cg(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+72>>2]&127](t,e);return}function Tg(t,e){t=t|0;e=+e;return Gk[r[(r[t>>2]|0)+52>>2]&1](t,e,1,.01666666753590107)|0}function Ag(t,e,i){t=t|0;e=+e;i=i|0;return Gk[r[(r[t>>2]|0)+52>>2]&1](t,e,i,.01666666753590107)|0}function Eg(t,e,i,n){t=t|0;e=+e;i=i|0;n=+n;return Gk[r[(r[t>>2]|0)+52>>2]&1](t,e,i,n)|0}function Mg(t){t=t|0;if(!t)return;Ql(t);return}function Rg(t){t=t|0;return+ +h[t+28>>2]}function Ig(t){t=t|0;return+ +h[t+36>>2]}function Pg(t){t=t|0;return r[t+8>>2]|0}function Lg(t){t=t|0;return(n[t+25>>0]|0)!=0|0}function Dg(t){t=t|0;return(n[t+24>>0]|0)!=0|0}function kg(t){t=t|0;return r[t+4>>2]|0}function Og(t){t=t|0;return+ +h[t+12>>2]}function Fg(t){t=t|0;return+ +h[t>>2]}function Bg(t){t=t|0;return(n[t+16>>0]|0)!=0|0}function Ng(t){t=t|0;return(n[t+32>>0]|0)!=0|0}function Ug(t){t=t|0;return(n[t+26>>0]|0)!=0|0}function Vg(t,e){t=t|0;e=+e;h[t+28>>2]=e;return}function zg(t,e){t=t|0;e=+e;h[t+36>>2]=e;return}function Wg(t,e){t=t|0;e=e|0;r[t+8>>2]=e;return}function Gg(t,e){t=t|0;e=e|0;n[t+25>>0]=e&1;return}function jg(t,e){t=t|0;e=e|0;n[t+24>>0]=e&1;return}function Hg(t,e){t=t|0;e=e|0;r[t+4>>2]=e;return}function Xg(t,e){t=t|0;e=+e;h[t+12>>2]=e;return}function Yg(t,e){t=t|0;e=+e;h[t>>2]=e;return}function qg(t,e){t=t|0;e=e|0;n[t+16>>0]=e&1;return}function Kg(t,e){t=t|0;e=e|0;n[t+32>>0]=e&1;return}function Zg(t,e){t=t|0;e=e|0;n[t+26>>0]=e&1;return}function Qg(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function $g(t,e){t=t|0;e=e|0;return Rk[r[(r[t>>2]|0)+40>>2]&31](t,e)|0}function Jg(t){t=t|0;return ck[r[(r[t>>2]|0)+36>>2]&127](t)|0}function tb(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function eb(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+64>>2]&127](t,e);return}function ib(t,e){t=t|0;e=e|0;jk[r[(r[t>>2]|0)+36>>2]&127](t,e,1,-1);return}function nb(t,e,i){t=t|0;e=e|0;i=i|0;jk[r[(r[t>>2]|0)+36>>2]&127](t,e,i,-1);return}function sb(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;jk[r[(r[t>>2]|0)+36>>2]&127](t,e,i,n);return}function rb(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;rw(t,e,i,n);return}function ob(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0;n=_;_=_+48|0;s=r[e+192>>2]|0;jk[r[(r[s>>2]|0)+8>>2]&127](s,e+4|0,n+32|0,n+16|0);r[n>>2]=3544;r[n+4>>2]=e;r[n+8>>2]=t;r[n+12>>2]=i;t=r[t+68>>2]|0;jk[r[(r[t>>2]|0)+28>>2]&127](t,n+32|0,n+16|0,n);_=n;return}function ab(t,e,i,n,s,r){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;r=+r;Yx(t,e,i,n,s,r);return}function lb(t){t=t|0;return r[t+68>>2]|0}function hb(t){t=t|0;return t+28|0}function cb(t){t=t|0;return r[t+24>>2]|0}function _b(t){t=t|0;t=r[t+68>>2]|0;return ck[r[(r[t>>2]|0)+36>>2]&127](t)|0}function ub(t){t=t|0;var e=0,i=0;if(n[19912]|0){e=t+92|0;t=22700;i=t+84|0;do{r[t>>2]=r[e>>2];t=t+4|0;e=e+4|0}while((t|0)<(i|0));return 22700}n[19912]=1;h[5675]=.6000000238418579;h[5676]=1.0;h[5677]=.30000001192092896;h[5678]=.01666666753590107;h[5679]=0.0;h[5681]=20.0;r[5680]=10;h[5683]=.20000000298023224;h[5684]=.800000011920929;h[5685]=0.0;h[5682]=1.0;r[5686]=1;h[5687]=-.03999999910593033;h[5688]=.10000000149011612;h[5689]=0.0;h[5690]=.8500000238418579;r[5691]=260;r[5692]=2;r[5693]=128;h[5694]=100.0;h[5695]=1000000015047466219876688.0e6;e=t+92|0;t=22700;i=t+84|0;do{r[t>>2]=r[e>>2];t=t+4|0;e=e+4|0}while((t|0)<(i|0));return 22700}function db(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;jk[r[(r[t>>2]|0)+32>>2]&127](t,e,i,n);return}function pb(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+68>>2]&127](t,e);return}function fb(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function mb(t,e,i){t=t|0;e=e|0;i=i|0;var n=0;r[5637]=(r[5637]|0)+1;n=Zl(1331)|0;if(!n)n=0;else{r[(n+4+15&-16)+-4>>2]=n;n=n+4+15&-16}aM(n,t,e,i);return n|0}function gb(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var o=0;r[5637]=(r[5637]|0)+1;o=Zl(1331)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}oM(o,t,e,i,n,s);return o|0}function bb(t,e){t=t|0;e=e|0;n[t+21>>0]=e&1;return}function yb(t){t=t|0;return+ +h[t+16>>2]}function vb(t,e){t=t|0;e=e|0;var i=0.0;i=+ql(+h[e>>2]);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;h[t+868>>2]=i;i=+ql(+h[e+4>>2]);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;h[t+932>>2]=i;i=+ql(+h[e+8>>2]);if(i<-3.1415927410125732){i=i+6.2831854820251465;t=t+996|0;h[t>>2]=i;return}if(!(i>3.1415927410125732)){t=t+996|0;h[t>>2]=i;return}i=i+-6.2831854820251465;t=t+996|0;h[t>>2]=i;return}function Sb(t,e){t=t|0;e=e|0;var i=0.0;i=+ql(+h[e>>2]);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;h[t+872>>2]=i;i=+ql(+h[e+4>>2]);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;h[t+936>>2]=i;i=+ql(+h[e+8>>2]);if(i<-3.1415927410125732){i=i+6.2831854820251465;t=t+1e3|0;h[t>>2]=i;return}if(!(i>3.1415927410125732)){t=t+1e3|0;h[t>>2]=i;return}i=i+-6.2831854820251465;t=t+1e3|0;h[t>>2]=i;return}function xb(t,e){t=t|0;e=+e;h[t+16>>2]=e;return}function wb(t,e){t=t|0;e=e|0;r[t+680>>2]=r[e>>2];r[t+680+4>>2]=r[e+4>>2];r[t+680+8>>2]=r[e+8>>2];r[t+680+12>>2]=r[e+12>>2];return}function Cb(t,e){t=t|0;e=e|0;r[t+696>>2]=r[e>>2];r[t+696+4>>2]=r[e+4>>2];r[t+696+8>>2]=r[e+8>>2];r[t+696+12>>2]=r[e+12>>2];return}function Tb(t){t=t|0;if(!t)return;ok[r[(r[t>>2]|0)+4>>2]&255](t);return}function Ab(t,e,i,s,o,a,l,c,u){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;l=l|0;c=c|0;u=u|0;var p=0,f=0,m=0,g=0.0,b=0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0,R=0,I=0,P=0,L=0,D=0,k=0,O=0,F=0,B=0,N=0,U=0,V=0,z=0,j=0,H=0,X=0,Y=0,q=0,K=0,Z=0,Q=0.0,$=0.0,J=0.0,tt=0.0,et=0.0,it=0.0,nt=0.0,st=0.0,rt=0.0,ot=0.0,at=0.0,lt=0.0,ht=0.0,ct=0.0,_t=0.0,ut=0.0;Z=_;_=_+304|0;r[t+188>>2]=-1;j_(15532);r[t+184>>2]=0;if((i|0)>0){u=0;do{r[(r[e+(u<<2)>>2]|0)+212>>2]=-1;u=u+1|0}while((u|0)!=(i|0))}p=r[t+12>>2]|0;if((p|0)>(i|0))f=t+8|0;else{if((i+1|0)!=0?(r[5637]=(r[5637]|0)+1,f=Zl(((i+1|0)*244|3)+16|0)|0,(f|0)!=0):0){r[(f+4+15&-16)+-4>>2]=f;f=f+4+15&-16}else f=0;u=r[t+8>>2]|0;if((u|0)>0){p=0;do{Y=f+(p*244|0)|0;q=r[t+16>>2]|0;X=q+(p*244|0)|0;r[Y>>2]=r[X>>2];r[Y+4>>2]=r[X+4>>2];r[Y+8>>2]=r[X+8>>2];r[Y+12>>2]=r[X+12>>2];Y=f+(p*244|0)+16|0;X=q+(p*244|0)+16|0;r[Y>>2]=r[X>>2];r[Y+4>>2]=r[X+4>>2];r[Y+8>>2]=r[X+8>>2];r[Y+12>>2]=r[X+12>>2];Y=f+(p*244|0)+32|0;X=q+(p*244|0)+32|0;r[Y>>2]=r[X>>2];r[Y+4>>2]=r[X+4>>2];r[Y+8>>2]=r[X+8>>2];r[Y+12>>2]=r[X+12>>2];Y=f+(p*244|0)+48|0;X=q+(p*244|0)+48|0;r[Y>>2]=r[X>>2];r[Y+4>>2]=r[X+4>>2];r[Y+8>>2]=r[X+8>>2];r[Y+12>>2]=r[X+12>>2];Oh(f+(p*244|0)+64|0,q+(p*244|0)+64|0,180)|0;p=p+1|0}while((p|0)!=(u|0))}u=r[t+16>>2]|0;if(u|0){if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0)}r[t+16>>2]=0}n[t+20>>0]=1;r[t+16>>2]=f;r[t+12>>2]=i+1;f=t+8|0;p=i+1|0}Ph(Z|0,0,244)|0;u=r[f>>2]|0;if((u|0)<0){if((p|0)<0){p=r[t+16>>2]|0;if(p|0){if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[p+-4>>2]|0)}r[t+16>>2]=0}n[t+20>>0]=1;r[t+16>>2]=0;r[t+12>>2]=0}do{q=r[t+16>>2]|0;Y=q+(u*244|0)|0;r[Y>>2]=r[Z>>2];r[Y+4>>2]=r[Z+4>>2];r[Y+8>>2]=r[Z+8>>2];r[Y+12>>2]=r[Z+12>>2];Y=q+(u*244|0)+16|0;r[Y>>2]=r[Z+16>>2];r[Y+4>>2]=r[Z+16+4>>2];r[Y+8>>2]=r[Z+16+8>>2];r[Y+12>>2]=r[Z+16+12>>2];Y=q+(u*244|0)+32|0;r[Y>>2]=r[Z+32>>2];r[Y+4>>2]=r[Z+32+4>>2];r[Y+8>>2]=r[Z+32+8>>2];r[Y+12>>2]=r[Z+32+12>>2];Y=q+(u*244|0)+48|0;r[Y>>2]=r[Z+48>>2];r[Y+4>>2]=r[Z+48+4>>2];r[Y+8>>2]=r[Z+48+8>>2];r[Y+12>>2]=r[Z+48+12>>2];Oh(q+(u*244|0)+64|0,Z+64|0,180)|0;u=u+1|0}while((u|0)!=0)}r[f>>2]=0;if((i|0)>0){b=0;do{f=e+(b<<2)|0;p=YD(t,r[f>>2]|0,+h[c+12>>2])|0;f=r[f>>2]|0;if(!((f|0)==0?1:(r[f+236>>2]&2|0)==0)?+h[f+368>>2]!=0.0:0){m=r[t+16>>2]|0;u=r[f+528>>2]|0;if(u&2){g=+h[c+76>>2];$=+h[f+420>>2];v=+h[f+424>>2];y=+h[f+428>>2];st=+h[f+4>>2];$=$!=0.0?1.0/$:0.0;nt=+h[f+8>>2];v=v!=0.0?1.0/v:0.0;it=+h[f+12>>2];y=y!=0.0?1.0/y:0.0;et=+h[f+20>>2];tt=+h[f+24>>2];J=+h[f+28>>2];Q=+h[f+36>>2];E=+h[f+40>>2];x=+h[f+44>>2];w=+h[f+352>>2];C=+h[f+356>>2];S=+h[f+360>>2];T=($*st*st+v*nt*nt+y*it*it)*w+($*st*et+v*nt*tt+y*it*J)*C+($*st*Q+v*nt*E+y*it*x)*S;A=($*et*st+v*tt*nt+y*J*it)*w+($*et*et+v*tt*tt+y*J*J)*C+($*et*Q+v*tt*E+y*J*x)*S;x=($*Q*st+v*E*nt+y*x*it)*w+($*Q*et+v*E*tt+y*x*J)*C+($*Q*Q+v*E*E+y*x*x)*S;y=(C*x-S*A)*(C*x-S*A)+(S*T-w*x)*(S*T-w*x)+(w*A-C*T)*(w*A-C*T);if(y>g*g){g=1.0/+G(+y)*g;v=(C*x-S*A)*g;y=g*(S*T-w*x);g=g*(w*A-C*T)}else{v=C*x-S*A;y=S*T-w*x;g=w*A-C*T}it=+h[c+12>>2];nt=(v*+h[f+292>>2]+y*+h[f+308>>2]+g*+h[f+324>>2])*it;st=it*(v*+h[f+296>>2]+y*+h[f+312>>2]+g*+h[f+328>>2]);h[m+(p*244|0)+224>>2]=+h[m+(p*244|0)+224>>2]-(v*+h[f+288>>2]+y*+h[f+304>>2]+g*+h[f+320>>2])*it;h[m+(p*244|0)+228>>2]=+h[m+(p*244|0)+228>>2]-nt;h[m+(p*244|0)+232>>2]=+h[m+(p*244|0)+232>>2]-st;u=r[f+528>>2]|0}if(u&4){E=+h[c+12>>2];lt=+h[f+420>>2];it=+h[f+424>>2];tt=+h[f+428>>2];C=+h[f+352>>2];y=+h[f+356>>2];st=+h[f+360>>2];J=+h[f+4>>2];lt=lt!=0.0?1.0/lt:0.0;g=+h[f+8>>2];it=it!=0.0?1.0/it:0.0;v=+h[f+12>>2];tt=tt!=0.0?1.0/tt:0.0;ht=+h[f+20>>2];$=+h[f+24>>2];w=+h[f+28>>2];et=+h[f+36>>2];Q=+h[f+40>>2];at=+h[f+44>>2];S=lt*J*J+it*g*g+tt*v*v;A=lt*J*ht+it*g*$+tt*v*w;ot=lt*J*et+it*g*Q+tt*v*at;x=lt*ht*J+it*$*g+tt*w*v;T=lt*ht*ht+it*$*$+tt*w*w;rt=lt*ht*et+it*$*Q+tt*w*at;v=lt*et*J+it*Q*g+tt*at*v;w=lt*et*ht+it*Q*$+tt*at*w;at=lt*et*et+it*Q*Q+tt*at*at;tt=C*S+y*A+st*ot+(y*(C*v+y*w+st*at)-st*(C*x+y*T+st*rt))*E-(E*0.0+(C*S+y*A+st*ot));Q=C*x+y*T+st*rt+(st*(C*S+y*A+st*ot)-C*(C*v+y*w+st*at))*E-(E*0.0+(C*x+y*T+st*rt));it=C*v+y*w+st*at+(C*(C*x+y*T+st*rt)-y*(C*S+y*A+st*ot))*E-(E*0.0+(C*v+y*w+st*at));et=A+(C*v+y*w+st*at+(y*w+(A*0.0+T*-st)))*E;lt=ot+(y*at+(ot*0.0+rt*-st)-(C*x+y*T+st*rt))*E;$=x+(v*-C+(x*0.0+st*S)-(C*v+y*w+st*at))*E;ht=rt+(C*S+y*A+st*ot+(at*-C+(rt*0.0+st*ot)))*E;g=v+(v*0.0+(S*-y+C*x)+(C*x+y*T+st*rt))*E;J=w+(w*0.0+(A*-y+C*T)-(C*S+y*A+st*ot))*E;_t=(T+(w*-C+(T*0.0+st*A))*E)*(at+(at*0.0+(ot*-y+C*rt))*E)-J*ht;ct=J*lt-et*(at+(at*0.0+(ot*-y+C*rt))*E);ut=et*ht-(T+(w*-C+(T*0.0+st*A))*E)*lt;nt=g*ut+((S+(y*v+(S*0.0+x*-st))*E)*_t+$*ct);u=+W(+nt)>1.1920928955078125e-07;nt=u?1.0/nt:nt;h[m+(p*244|0)+224>>2]=C-(it*ut+(tt*_t+Q*ct))*nt-C+ +h[m+(p*244|0)+224>>2];h[m+(p*244|0)+228>>2]=y-(g*(ht*tt-lt*Q)+((S+(y*v+(S*0.0+x*-st))*E)*((at+(at*0.0+(ot*-y+C*rt))*E)*Q-ht*it)+$*(lt*it-(at+(at*0.0+(ot*-y+C*rt))*E)*tt)))*nt-y+ +h[m+(p*244|0)+228>>2];h[m+(p*244|0)+232>>2]=st-(g*(et*Q-(T+(w*-C+(T*0.0+st*A))*E)*tt)+((S+(y*v+(S*0.0+x*-st))*E)*((T+(w*-C+(T*0.0+st*A))*E)*it-J*Q)+$*(J*tt-et*it)))*nt-st+ +h[m+(p*244|0)+232>>2];u=r[f+528>>2]|0}if(u&8|0){lt=+h[c+12>>2];A=+h[f+420>>2];E=+h[f+424>>2];w=+h[f+428>>2];nt=+h[f+352>>2];st=+h[f+356>>2];ut=+h[f+360>>2];Kx(f+4|0,Z+248|0);_t=+h[Z+248>>2];rt=+h[Z+248+4>>2];ot=+h[Z+248+8>>2];Q=+h[Z+248+12>>2];J=ot*(nt*-ot+st*Q-ut*-_t)+(_t*(-(nt*-_t)-st*-rt-ut*-ot)+Q*(ut*-rt+nt*Q-st*-ot))-rt*(st*-_t+ut*Q-nt*-rt);et=_t*(st*-_t+ut*Q-nt*-rt)+(rt*(-(nt*-_t)-st*-rt-ut*-ot)+Q*(nt*-ot+st*Q-ut*-_t))-ot*(ut*-rt+nt*Q-st*-ot);Q=rt*(ut*-rt+nt*Q-st*-ot)+(ot*(-(nt*-_t)-st*-rt-ut*-ot)+Q*(st*-_t+ut*Q-nt*-rt))-_t*(nt*-ot+st*Q-ut*-_t);A=A!=0.0?1.0/A:0.0;it=Q*0.0+(A*J+et*0.0);E=E!=0.0?1.0/E:0.0;tt=Q*0.0+(J*0.0+E*et);w=w!=0.0?1.0/w:0.0;$=w*Q+(J*0.0+et*0.0);C=A+(et*0.0+(A*0.0+Q*-0.0))*lt;T=E+(J*-0.0+(E*0.0+Q*0.0))*lt;ht=w+(w*0.0+(et*-0.0+J*0.0))*lt;x=T*ht-((et*-0.0+E*J+0.0-it)*lt+0.0)*((Q*0.0+0.0-w*J+it)*lt+0.0);at=((et*-0.0+E*J+0.0-it)*lt+0.0)*((w*et+(Q*-0.0+0.0)-tt)*lt+0.0)-ht*((et*0.0+(0.0-E*Q)+$)*lt+0.0);S=((et*0.0+(0.0-E*Q)+$)*lt+0.0)*((Q*0.0+0.0-w*J+it)*lt+0.0)-T*((w*et+(Q*-0.0+0.0)-tt)*lt+0.0);ct=((J*0.0-A*et+0.0+tt)*lt+0.0)*S+(C*x+((J*-0.0+(A*Q+0.0)-$)*lt+0.0)*at);q=+W(+ct)>1.1920928955078125e-07;ct=q?1.0/ct:ct;at=J-((J*tt-et*it)*lt*S+((et*$-Q*tt)*lt*x+(Q*it-J*$)*lt*at))*ct;ht=et-(((J*0.0-A*et+0.0+tt)*lt+0.0)*(((Q*0.0+0.0-w*J+it)*lt+0.0)*((et*$-Q*tt)*lt)-((w*et+(Q*-0.0+0.0)-tt)*lt+0.0)*((Q*it-J*$)*lt))+(C*(ht*((Q*it-J*$)*lt)-((Q*0.0+0.0-w*J+it)*lt+0.0)*((J*tt-et*it)*lt))+((J*-0.0+(A*Q+0.0)-$)*lt+0.0)*(((w*et+(Q*-0.0+0.0)-tt)*lt+0.0)*((J*tt-et*it)*lt)-ht*((et*$-Q*tt)*lt))))*ct;ct=Q-(((J*0.0-A*et+0.0+tt)*lt+0.0)*(((et*0.0+(0.0-E*Q)+$)*lt+0.0)*((Q*it-J*$)*lt)-T*((et*$-Q*tt)*lt))+(C*(T*((J*tt-et*it)*lt)-((et*-0.0+E*J+0.0-it)*lt+0.0)*((Q*it-J*$)*lt))+((J*-0.0+(A*Q+0.0)-$)*lt+0.0)*(((et*-0.0+E*J+0.0-it)*lt+0.0)*((et*$-Q*tt)*lt)-((et*0.0+(0.0-E*Q)+$)*lt+0.0)*((J*tt-et*it)*lt))))*ct;lt=+h[Z+248+12>>2];h[m+(p*244|0)+224>>2]=(ot*at+lt*ht-_t*ct)*-ot+(lt*(lt*at+rt*ct-ot*ht)+(-(_t*at)-rt*ht-ot*ct)*-_t)-(lt*ct+_t*ht-rt*at)*-rt-nt+ +h[m+(p*244|0)+224>>2];h[m+(p*244|0)+228>>2]=(lt*ct+_t*ht-rt*at)*-_t+(lt*(ot*at+lt*ht-_t*ct)+(-(_t*at)-rt*ht-ot*ct)*-rt)-(lt*at+rt*ct-ot*ht)*-ot-st+ +h[m+(p*244|0)+228>>2];h[m+(p*244|0)+232>>2]=(lt*at+rt*ct-ot*ht)*-rt+((-(_t*at)-rt*ht-ot*ct)*-ot+lt*(lt*ct+_t*ht-rt*at))-(ot*at+lt*ht-_t*ct)*-_t-ut+ +h[m+(p*244|0)+232>>2]}}b=b+1|0}while((b|0)!=(i|0))}if((l|0)>0){u=0;do{q=r[a+(u<<2)>>2]|0;ok[r[(r[q>>2]|0)+8>>2]&255](q);h[q+36>>2]=0.0;u=u+1|0}while((u|0)<(l|0))}p=r[t+168>>2]|0;if((p|0)<(l|0)?(r[t+172>>2]|0)<(l|0):0){if(!l)u=0;else{r[5637]=(r[5637]|0)+1;u=Zl((l<<3|3)+16|0)|0;if(!u)u=0;else{r[(u+4+15&-16)+-4>>2]=u;u=u+4+15&-16}p=r[t+168>>2]|0}if((p|0)>0){f=0;do{X=(r[t+176>>2]|0)+(f<<3)|0;Y=r[X+4>>2]|0;q=u+(f<<3)|0;r[q>>2]=r[X>>2];r[q+4>>2]=Y;f=f+1|0}while((f|0)!=(p|0))}p=r[t+176>>2]|0;if(p|0){if(n[t+180>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[p+-4>>2]|0)}r[t+176>>2]=0}n[t+180>>0]=1;r[t+176>>2]=u;r[t+172>>2]=l}r[t+168>>2]=l;if((l|0)>0){i=0;u=0;do{b=r[t+176>>2]|0;e=b+(i<<3)|0;m=a+(i<<2)|0;p=r[m>>2]|0;f=r[p+44>>2]|0;if(f){p=f+64|0;do{r[f>>2]=0;f=f+4|0}while((f|0)<(p|0));p=r[m>>2]|0}if(!(n[p+20>>0]|0)){r[e>>2]=0;r[b+(i<<3)+4>>2]=0;p=0}else{lk[r[(r[p>>2]|0)+16>>2]&127](p,e);p=r[e>>2]|0}u=p+u|0;i=i+1|0}while((i|0)<(l|0))}else u=0;f=r[t+48>>2]|0;if((f|0)<(u|0)?(r[t+52>>2]|0)<(u|0):0){if(!u)p=0;else{r[5637]=(r[5637]|0)+1;p=Zl((u*152|3)+16|0)|0;if(!p)p=0;else{r[(p+4+15&-16)+-4>>2]=p;p=p+4+15&-16}f=r[t+48>>2]|0}if((f|0)>0){m=0;do{Oh(p+(m*152|0)|0,(r[t+56>>2]|0)+(m*152|0)|0,152)|0;m=m+1|0}while((m|0)!=(f|0))}f=r[t+56>>2]|0;if(f|0){if(n[t+60>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[f+-4>>2]|0)}r[t+56>>2]=0}n[t+60>>0]=1;r[t+56>>2]=p;r[t+52>>2]=u}r[t+48>>2]=u;if((l|0)>0){u=r[t+176>>2]|0;Y=0;q=0;while(1){X=u+(q<<3)|0;if(!(r[X>>2]|0))p=0;else{u=r[t+56>>2]|0;F=u+(Y*152|0)|0;B=a+(q<<2)|0;N=r[B>>2]|0;U=r[N+28>>2]|0;V=r[N+32>>2]|0;z=YD(t,U,+h[c+12>>2])|0;j=YD(t,V,+h[c+12>>2])|0;H=r[t+16>>2]|0;p=r[N+24>>2]|0;p=(p|0)>0?p:r[c+20>>2]|0;if((p|0)>(r[t+184>>2]|0))r[t+184>>2]=p;if((r[X>>2]|0)>0){f=0;do{Ph(F+(f*152|0)|0,0,152)|0;h[F+(f*152|0)+120>>2]=-3402823466385288598117041.0e14;h[F+(f*152|0)+124>>2]=3402823466385288598117041.0e14;h[F+(f*152|0)+100>>2]=0.0;h[F+(f*152|0)+96>>2]=0.0;r[F+(f*152|0)+144>>2]=z;r[F+(f*152|0)+148>>2]=j;r[F+(f*152|0)+136>>2]=p;f=f+1|0}while((f|0)<(r[X>>2]|0))}r[H+(z*244|0)+64>>2]=0;r[H+(z*244|0)+64+4>>2]=0;r[H+(z*244|0)+64+8>>2]=0;r[H+(z*244|0)+64+12>>2]=0;r[H+(z*244|0)+64+16>>2]=0;r[H+(z*244|0)+64+20>>2]=0;r[H+(z*244|0)+64+24>>2]=0;r[H+(z*244|0)+64+28>>2]=0;r[H+(z*244|0)+144>>2]=0;r[H+(z*244|0)+144+4>>2]=0;r[H+(z*244|0)+144+8>>2]=0;r[H+(z*244|0)+144+12>>2]=0;r[H+(z*244|0)+144+16>>2]=0;r[H+(z*244|0)+144+20>>2]=0;r[H+(z*244|0)+144+24>>2]=0;r[H+(z*244|0)+144+28>>2]=0;r[H+(j*244|0)+64>>2]=0;r[H+(j*244|0)+64+4>>2]=0;r[H+(j*244|0)+64+8>>2]=0;r[H+(j*244|0)+64+12>>2]=0;r[H+(j*244|0)+64+16>>2]=0;r[H+(j*244|0)+64+20>>2]=0;r[H+(j*244|0)+64+24>>2]=0;r[H+(j*244|0)+64+28>>2]=0;r[H+(j*244|0)+144>>2]=0;r[H+(j*244|0)+144+4>>2]=0;r[H+(j*244|0)+144+8>>2]=0;r[H+(j*244|0)+144+12>>2]=0;r[H+(j*244|0)+144+16>>2]=0;r[H+(j*244|0)+144+20>>2]=0;r[H+(j*244|0)+144+24>>2]=0;r[H+(j*244|0)+144+28>>2]=0;h[Z+248>>2]=1.0/+h[c+12>>2];r[Z+248+4>>2]=r[c+32>>2];r[Z+248+8>>2]=u+(Y*152|0)+16;r[Z+248+12>>2]=F;r[Z+248+16>>2]=u+(Y*152|0)+48;r[Z+248+20>>2]=u+(Y*152|0)+32;r[Z+248+24>>2]=38;r[Z+248+28>>2]=u+(Y*152|0)+112;O=u+(Y*152|0)+116|0;r[O>>2]=r[c+40>>2];r[Z+248+52>>2]=r[c+4>>2];r[Z+248+32>>2]=O;r[Z+248+36>>2]=u+(Y*152|0)+120;r[Z+248+40>>2]=u+(Y*152|0)+124;r[Z+248+48>>2]=r[c+20>>2];O=r[B>>2]|0;lk[r[(r[O>>2]|0)+20>>2]&127](O,Z+248|0);if((r[X>>2]|0)>0){O=0;do{u=F+(O*152|0)+124|0;g=+h[(r[B>>2]|0)+16>>2];if(+h[u>>2]>=g)h[u>>2]=g;u=F+(O*152|0)+120|0;if(+h[u>>2]<=-g)h[u>>2]=-g;r[F+(O*152|0)+132>>2]=N;k=F+(O*152|0)|0;u=F+(O*152|0)+64|0;p=r[N+28>>2]|0;_t=+h[k>>2];ht=+h[k+4>>2];E=+h[k+8>>2];ct=(_t*+h[p+304>>2]+ht*+h[p+308>>2]+E*+h[p+312>>2])*+h[p+572>>2];g=(_t*+h[p+320>>2]+ht*+h[p+324>>2]+E*+h[p+328>>2])*+h[p+576>>2];h[u>>2]=(+h[p+288>>2]*_t+ +h[p+292>>2]*ht+ +h[p+296>>2]*E)*+h[p+568>>2];h[u+4>>2]=ct;h[u+8>>2]=g;h[u+12>>2]=0.0;u=F+(O*152|0)+32|0;p=F+(O*152|0)+80|0;D=r[N+32>>2]|0;g=+h[u>>2];ct=+h[u+4>>2];E=+h[u+8>>2];ht=(g*+h[D+304>>2]+ct*+h[D+308>>2]+E*+h[D+312>>2])*+h[D+572>>2];_t=(g*+h[D+320>>2]+ct*+h[D+324>>2]+E*+h[D+328>>2])*+h[D+576>>2];h[p>>2]=(+h[D+288>>2]*g+ +h[D+292>>2]*ct+ +h[D+296>>2]*E)*+h[D+568>>2];h[p+4>>2]=ht;h[p+8>>2]=_t;h[p+12>>2]=0.0;p=F+(O*152|0)+16|0;_t=+h[U+368>>2];ht=+h[p>>2];ct=+h[p+4>>2];g=+h[p+8>>2];y=+h[k>>2];v=+h[k+4>>2];S=+h[k+8>>2];k=F+(O*152|0)+48|0;ut=+h[V+368>>2];x=+h[k>>2];w=+h[k+4>>2];C=+h[k+8>>2];T=+h[u>>2];A=+h[u+4>>2];E=ht*(_t*ht)+ct*(_t*ct)+g*(_t*g)+(y*(+h[U+288>>2]*y+ +h[U+292>>2]*v+ +h[U+296>>2]*S)+v*(y*+h[U+304>>2]+v*+h[U+308>>2]+S*+h[U+312>>2])+S*(y*+h[U+320>>2]+v*+h[U+324>>2]+S*+h[U+328>>2]))+(x*(ut*x)+w*(ut*w)+C*(ut*C))+(T*(+h[V+288>>2]*T+ +h[V+292>>2]*A+ +h[V+296>>2]*E)+A*(T*+h[V+304>>2]+A*+h[V+308>>2]+E*+h[V+312>>2])+E*(T*+h[V+320>>2]+A*+h[V+324>>2]+E*+h[V+328>>2]));k=+W(+E)>1.1920928955078125e-07;E=k?1.0/E:0.0;h[F+(O*152|0)+108>>2]=E;if(!(r[H+(z*244|0)+240>>2]|0)){f=0;m=0;b=0;R=0;I=0;P=0}else{f=r[H+(z*244|0)+208>>2]|0;m=r[H+(z*244|0)+212>>2]|0;b=r[H+(z*244|0)+216>>2]|0;R=r[H+(z*244|0)+224>>2]|0;I=r[H+(z*244|0)+228>>2]|0;P=r[H+(z*244|0)+232>>2]|0}if(!(r[H+(j*244|0)+240>>2]|0)){e=0;i=0;M=0;L=0;D=0;k=0}else{e=r[H+(j*244|0)+208>>2]|0;i=r[H+(j*244|0)+212>>2]|0;M=r[H+(j*244|0)+216>>2]|0;L=r[H+(j*244|0)+224>>2]|0;D=r[H+(j*244|0)+228>>2]|0;k=r[H+(j*244|0)+232>>2]|0}_t=(r[d>>2]=f,+h[d>>2])+ +h[U+336>>2];ct=(r[d>>2]=m,+h[d>>2])+ +h[U+340>>2];ct=_t*+h[p>>2]+ct*+h[p+4>>2]+((r[d>>2]=b,+h[d>>2])+ +h[U+344>>2])*g;_t=(r[d>>2]=R,+h[d>>2])+ +h[U+352>>2];ht=(r[d>>2]=I,+h[d>>2])+ +h[U+356>>2];ht=ct+(_t*y+ht*v+((r[d>>2]=P,+h[d>>2])+ +h[U+360>>2])*S);_t=(r[d>>2]=e,+h[d>>2])+ +h[V+336>>2];ct=(r[d>>2]=i,+h[d>>2])+ +h[V+340>>2];ct=_t*x+ct*w+((r[d>>2]=M,+h[d>>2])+ +h[V+344>>2])*C;_t=(r[d>>2]=L,+h[d>>2])+ +h[V+352>>2];ut=(r[d>>2]=D,+h[d>>2])+ +h[V+356>>2];D=F+(O*152|0)+112|0;h[D>>2]=+h[D>>2]*E+E*(0.0-+h[Z+248+52>>2]*(ht+(ct+(_t*T+ut*A+((r[d>>2]=k,+h[d>>2])+ +h[V+360>>2])*+h[u+8>>2]))));h[F+(O*152|0)+100>>2]=0.0;O=O+1|0}while((O|0)<(r[X>>2]|0))}u=r[t+176>>2]|0;p=r[u+(q<<3)>>2]|0}q=q+1|0;if((q|0)>=(l|0))break;else Y=p+Y|0}}jk[r[(r[t>>2]|0)+28>>2]&127](t,s,o,c);b=r[t+48>>2]|0;e=r[t+28>>2]|0;i=r[t+68>>2]|0;p=r[t+128>>2]|0;if((p|0)<(b|0)?(r[t+132>>2]|0)<(b|0):0){if(!b)u=0;else{r[5637]=(r[5637]|0)+1;u=Zl((b<<2|3)+16|0)|0;if(!u)u=0;else{r[(u+4+15&-16)+-4>>2]=u;u=u+4+15&-16}p=r[t+128>>2]|0}m=r[t+136>>2]|0;if((p|0)<=0)if(!m)p=t+140|0;else K=103;else{f=0;do{r[u+(f<<2)>>2]=r[m+(f<<2)>>2];f=f+1|0}while((f|0)!=(p|0));K=103}if((K|0)==103){if(n[t+140>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[m+-4>>2]|0)}r[t+136>>2]=0;p=t+140|0}n[p>>0]=1;r[t+136>>2]=u;r[t+132>>2]=b}r[t+128>>2]=b;if(!(r[c+64>>2]&16)){p=r[t+108>>2]|0;if((p|0)<(e|0)?(r[t+112>>2]|0)<(e|0):0){if(!e)u=0;else{r[5637]=(r[5637]|0)+1;u=Zl((e<<2|3)+16|0)|0;if(!u)u=0;else{r[(u+4+15&-16)+-4>>2]=u;u=u+4+15&-16}p=r[t+108>>2]|0}m=r[t+116>>2]|0;if((p|0)<=0)if(!m)p=t+120|0;else K=133;else{f=0;do{r[u+(f<<2)>>2]=r[m+(f<<2)>>2];f=f+1|0}while((f|0)!=(p|0));K=133}if((K|0)==133){if(n[t+120>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[m+-4>>2]|0)}r[t+116>>2]=0;p=t+120|0}n[p>>0]=1;r[t+116>>2]=u;r[t+112>>2]=e}r[t+108>>2]=e}else{p=r[t+108>>2]|0;if((p|0)<(e<<1|0)?(r[t+112>>2]|0)<(e<<1|0):0){if(!e)u=0;else{r[5637]=(r[5637]|0)+1;u=Zl((e<<3|3)+16|0)|0;if(!u)u=0;else{r[(u+4+15&-16)+-4>>2]=u;u=u+4+15&-16}p=r[t+108>>2]|0}m=r[t+116>>2]|0;if((p|0)<=0)if(!m)p=t+120|0;else K=118;else{f=0;do{r[u+(f<<2)>>2]=r[m+(f<<2)>>2];f=f+1|0}while((f|0)!=(p|0));K=118}if((K|0)==118){if(n[t+120>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[m+-4>>2]|0)}r[t+116>>2]=0;p=t+120|0}n[p>>0]=1;r[t+116>>2]=u;r[t+112>>2]=e<<1}r[t+108>>2]=e<<1}p=r[t+148>>2]|0;if((p|0)<(i|0)?(r[t+152>>2]|0)<(i|0):0){if(!i)u=0;else{r[5637]=(r[5637]|0)+1;u=Zl((i<<2|3)+16|0)|0;if(!u)u=0;else{r[(u+4+15&-16)+-4>>2]=u;u=u+4+15&-16}p=r[t+148>>2]|0}m=r[t+156>>2]|0;if((p|0)<=0)if(!m)p=t+160|0;else K=148;else{f=0;do{r[u+(f<<2)>>2]=r[m+(f<<2)>>2];f=f+1|0}while((f|0)!=(p|0));K=148}if((K|0)==148){if(n[t+160>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[m+-4>>2]|0)}r[t+156>>2]=0;p=t+160|0}n[p>>0]=1;r[t+156>>2]=u;r[t+152>>2]=i}r[t+148>>2]=i;if((b|0)>0){u=r[t+136>>2]|0;p=0;do{r[u+(p<<2)>>2]=p;p=p+1|0}while((p|0)!=(b|0))}if((e|0)>0){u=r[t+116>>2]|0;p=0;do{r[u+(p<<2)>>2]=p;p=p+1|0}while((p|0)!=(e|0))}if((i|0)>0){u=r[t+156>>2]|0;p=0;do{r[u+(p<<2)>>2]=p;p=p+1|0}while((p|0)!=(i|0))}u=r[2006]|0;t=(r[u+16>>2]|0)+-1|0;r[u+16>>2]=t;if(t|0){_=Z;return 0.0}do{if(r[u+4>>2]|0){de(Z+248|0,0)|0;t=r[5649]|0;h[u+8>>2]=+h[u+8>>2]+ +(((r[Z+248+4>>2]|0)-(r[t+4>>2]|0)+(((r[Z+248>>2]|0)-(r[t>>2]|0)|0)*1e6|0)-(r[u+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[u+16>>2]|0)){u=r[2006]|0;break}else{_=Z;return 0.0}}}while(0);r[2006]=r[u+20>>2];_=Z;return 0.0}function Eb(t,e,i,n,s,o,a,l,c){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;l=l|0;c=c|0;var u=0,d=0,p=0;p=_;_=_+16|0;j_(15561);Ek[r[(r[t>>2]|0)+32>>2]&1](t,e,i,n,s,o,a,l,c);d=r[t+184>>2]|0;u=r[l+20>>2]|0;u=(d|0)>(u|0)?d:u;if((u|0)>0){d=0;do{+Pk[r[(r[t>>2]|0)+40>>2]&3](t,d,e,i,n,s,o,a,l,c);d=d+1|0}while((d|0)<(u|0))}u=r[2006]|0;t=(r[u+16>>2]|0)+-1|0;r[u+16>>2]=t;if(t|0){_=p;return 0.0}do{if(r[u+4>>2]|0){de(p|0,0)|0;t=r[5649]|0;h[u+8>>2]=+h[u+8>>2]+ +(((r[p+4>>2]|0)-(r[t+4>>2]|0)+(((r[p>>2]|0)-(r[t>>2]|0)|0)*1e6|0)-(r[u+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[u+16>>2]|0)){u=r[2006]|0;break}else{_=p;return 0.0}}}while(0);r[2006]=r[u+20>>2];_=p;return 0.0}function Mb(t){t=t|0;r[t>>2]=7188;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function Rb(t,e){t=t|0;e=e|0;var i=0,s=0.0,o=0.0,a=0.0,l=0,c=0.0,_=0.0;if(n[t+48>>0]|0){r[e>>2]=0;r[e+4>>2]=0;return}r[e>>2]=4;r[e+4>>2]=2;Ib(t,(r[t+28>>2]|0)+4|0,(r[t+32>>2]|0)+4|0);h[t+1088>>2]=0.0;n[t+297>>0]=0;s=+h[t+192>>2];o=+h[t+196>>2];do{if(s<=o){_=+h[t+892>>2];c=+h[t+908>>2];a=+h[t+924>>2];a=+KE(+Q(+(+h[t+832>>2]*_+ +h[t+848>>2]*c+ +h[t+864>>2]*a),+(+h[t+828>>2]*_+ +h[t+844>>2]*c+ +h[t+860>>2]*a)),s,o);h[t+1084>>2]=a;if(a<s){h[t+1088>>2]=a-s;n[t+297>>0]=1;l=1;break}if(a>o){h[t+1088>>2]=a-o;n[t+297>>0]=1;l=1}else l=0}else l=0}while(0);n[t+296>>0]=0;i=r[t+1032>>2]|0;r[t+1080>>2]=i;s=+h[t+184>>2];o=+h[t+188>>2];a=(r[d>>2]=i,+h[d>>2]);do{if(s<=o){if(a>o){h[t+1032>>2]=a-o;n[t+296>>0]=1;i=14;break}if(a<s){h[t+1032>>2]=a-s;n[t+296>>0]=1;i=14}else i=13}else i=13}while(0);if((i|0)==13?(h[t+1032>>2]=0.0,n[t+1096>>0]|0):0)i=14;if((i|0)==14){r[e>>2]=(r[e>>2]|0)+1;r[e+4>>2]=(r[e+4>>2]|0)+-1}if(l<<24>>24==0?(n[t+1112>>0]|0)==0:0)return;r[e>>2]=(r[e>>2]|0)+1;r[e+4>>2]=(r[e+4>>2]|0)+-1;return}function Ib(t,e,i){t=t|0;e=e|0;i=i|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0,P=0;if((n[t+180>>0]|0)==0?(n[t+48>>0]|0)!=0:0){x=+h[t+116>>2];a=+h[i>>2];w=+h[t+132>>2];M=+h[i+4>>2];C=+h[t+148>>2];R=+h[i+8>>2];c=+h[t+120>>2];u=+h[t+136>>2];f=+h[t+152>>2];m=+h[t+124>>2];b=+h[t+140>>2];y=+h[t+156>>2];l=+h[i+16>>2];_=+h[i+20>>2];p=+h[i+24>>2];g=+h[i+32>>2];T=+h[i+36>>2];A=+h[i+40>>2];o=+h[t+164>>2];s=+h[t+168>>2];S=+h[t+172>>2];v=+h[i+48>>2]+(a*o+M*s+R*S);E=l*o+_*s+p*S+ +h[i+52>>2];S=g*o+T*s+A*S+ +h[i+56>>2];h[t+824>>2]=x*a+w*M+C*R;h[t+828>>2]=a*c+M*u+R*f;h[t+832>>2]=a*m+M*b+R*y;h[t+836>>2]=0.0;h[t+840>>2]=x*l+w*_+C*p;h[t+844>>2]=c*l+u*_+f*p;h[t+848>>2]=m*l+b*_+y*p;h[t+852>>2]=0.0;h[t+856>>2]=x*g+w*T+C*A;h[t+860>>2]=c*g+u*T+f*A;h[t+864>>2]=m*g+b*T+y*A;h[t+868>>2]=0.0;h[t+872>>2]=v;h[t+876>>2]=E;h[t+880>>2]=S;h[t+884>>2]=0.0;S=+h[t+52>>2];E=+h[e>>2];v=+h[t+68>>2];A=+h[e+4>>2];y=+h[t+84>>2];T=+h[e+8>>2];b=+h[t+56>>2];g=+h[t+72>>2];m=+h[t+88>>2];f=+h[t+60>>2];u=+h[t+76>>2];c=+h[t+92>>2];C=+h[e+16>>2];w=+h[e+20>>2];x=+h[e+24>>2];p=+h[e+32>>2];_=+h[e+36>>2];l=+h[e+40>>2];R=+h[t+100>>2];M=+h[t+104>>2];a=+h[t+108>>2];s=+h[e+48>>2]+(E*R+A*M+T*a);o=C*R+w*M+x*a+ +h[e+52>>2];a=p*R+_*M+l*a+ +h[e+56>>2];h[t+888>>2]=S*E+v*A+y*T;h[t+892>>2]=E*b+A*g+T*m;h[t+896>>2]=E*f+A*u+T*c;h[t+900>>2]=0.0;h[t+904>>2]=S*C+v*w+y*x;h[t+908>>2]=b*C+g*w+m*x;h[t+912>>2]=f*C+u*w+c*x;h[t+916>>2]=0.0;h[t+920>>2]=S*p+v*_+y*l;h[t+924>>2]=b*p+g*_+m*l;h[t+928>>2]=f*p+u*_+c*l;h[t+932>>2]=0.0;h[t+936>>2]=s;h[t+940>>2]=o;h[t+944>>2]=a;h[t+948>>2]=0.0;e=t+856|0;i=t+840|0}else{p=+h[t+52>>2];R=+h[e>>2];u=+h[t+68>>2];o=+h[e+4>>2];_=+h[t+84>>2];s=+h[e+8>>2];T=+h[t+56>>2];w=+h[t+72>>2];S=+h[t+88>>2];v=+h[t+60>>2];b=+h[t+76>>2];g=+h[t+92>>2];A=+h[e+16>>2];C=+h[e+20>>2];x=+h[e+24>>2];y=+h[e+32>>2];c=+h[e+36>>2];l=+h[e+40>>2];M=+h[t+100>>2];E=+h[t+104>>2];f=+h[t+108>>2];m=+h[e+48>>2]+(R*M+o*E+s*f);a=A*M+C*E+x*f+ +h[e+52>>2];f=y*M+c*E+l*f+ +h[e+56>>2];h[t+824>>2]=p*R+u*o+_*s;h[t+828>>2]=R*T+o*w+s*S;h[t+832>>2]=R*v+o*b+s*g;h[t+836>>2]=0.0;h[t+840>>2]=p*A+u*C+_*x;h[t+844>>2]=T*A+w*C+S*x;h[t+848>>2]=v*A+b*C+g*x;h[t+852>>2]=0.0;h[t+856>>2]=p*y+u*c+_*l;h[t+860>>2]=T*y+w*c+S*l;h[t+864>>2]=v*y+b*c+g*l;h[t+868>>2]=0.0;h[t+872>>2]=m;h[t+876>>2]=a;h[t+880>>2]=f;h[t+884>>2]=0.0;f=+h[t+116>>2];a=+h[i>>2];m=+h[t+132>>2];l=+h[i+4>>2];g=+h[t+148>>2];c=+h[i+8>>2];b=+h[t+120>>2];y=+h[t+136>>2];v=+h[t+152>>2];S=+h[t+124>>2];w=+h[t+140>>2];T=+h[t+156>>2];_=+h[i+16>>2];u=+h[i+20>>2];p=+h[i+24>>2];x=+h[i+32>>2];C=+h[i+36>>2];A=+h[i+40>>2];s=+h[t+164>>2];o=+h[t+168>>2];R=+h[t+172>>2];E=+h[i+48>>2]+(a*s+l*o+c*R);M=_*s+u*o+p*R+ +h[i+52>>2];R=x*s+C*o+A*R+ +h[i+56>>2];h[t+888>>2]=f*a+m*l+g*c;h[t+892>>2]=a*b+l*y+c*v;h[t+896>>2]=a*S+l*w+c*T;h[t+900>>2]=0.0;h[t+904>>2]=f*_+m*u+g*p;h[t+908>>2]=b*_+y*u+v*p;h[t+912>>2]=S*_+w*u+T*p;h[t+916>>2]=0.0;h[t+920>>2]=f*x+m*C+g*A;h[t+924>>2]=b*x+y*C+v*A;h[t+928>>2]=S*x+w*C+T*A;h[t+932>>2]=0.0;h[t+936>>2]=E;h[t+940>>2]=M;h[t+944>>2]=R;h[t+948>>2]=0.0;e=t+856|0;i=t+840|0}r[t+968>>2]=r[t+872>>2];r[t+968+4>>2]=r[t+872+4>>2];r[t+968+8>>2]=r[t+872+8>>2];r[t+968+12>>2]=r[t+872+12>>2];r[t+984>>2]=r[t+936>>2];r[t+984+4>>2]=r[t+936+4>>2];r[t+984+8>>2]=r[t+936+8>>2];r[t+984+12>>2]=r[t+936+12>>2];P=r[t+824>>2]|0;I=r[i>>2]|0;i=r[e>>2]|0;r[t+952>>2]=P;r[t+956>>2]=I;r[t+960>>2]=i;h[t+964>>2]=0.0;s=(r[d>>2]=P,+h[d>>2]);o=(r[d>>2]=I,+h[d>>2]);a=(r[d>>2]=i,+h[d>>2]);if((n[t+180>>0]|0)==0?(n[t+48>>0]|0)==0:0){v=+h[t+968>>2];A=v-+h[t+984>>2];S=+h[t+972>>2];M=S-+h[t+988>>2];x=+h[t+976>>2];R=x-+h[t+992>>2];h[t+1016>>2]=A;h[t+1020>>2]=M;h[t+1024>>2]=R;h[t+1028>>2]=0.0;E=s*A;w=o*M;w=E+w;E=a*R;E=w+E;w=s*E;C=o*E;T=a*E;w=v+w;C=S+C;T=x+T;P=t+1e3|0;h[P>>2]=w;P=t+1004|0;h[P>>2]=C;P=t+1008|0;h[P>>2]=T;P=t+1012|0;h[P>>2]=0.0;P=t+1032|0;h[P>>2]=E;P=t+828|0;I=t+844|0;i=t+860|0;E=+h[P>>2];T=+h[I>>2];C=+h[i>>2];E=E*A;T=T*M;T=E+T;C=C*R;C=T+C;i=t+1036|0;h[i>>2]=C;i=t+832|0;I=t+848|0;P=t+864|0;C=+h[i>>2];T=+h[I>>2];E=+h[P>>2];A=C*A;M=T*M;M=A+M;R=E*R;R=M+R;P=t+1040|0;h[P>>2]=R;return}v=+h[t+968>>2];A=+h[t+984>>2]-v;S=+h[t+972>>2];M=+h[t+988>>2]-S;x=+h[t+976>>2];R=+h[t+992>>2]-x;h[t+1016>>2]=A;h[t+1020>>2]=M;h[t+1024>>2]=R;h[t+1028>>2]=0.0;E=s*A;w=o*M;w=E+w;E=a*R;E=w+E;w=s*E;C=o*E;T=a*E;w=v+w;C=S+C;T=x+T;P=t+1e3|0;h[P>>2]=w;P=t+1004|0;h[P>>2]=C;P=t+1008|0;h[P>>2]=T;P=t+1012|0;h[P>>2]=0.0;P=t+1032|0;h[P>>2]=E;P=t+828|0;I=t+844|0;i=t+860|0;E=+h[P>>2];T=+h[I>>2];C=+h[i>>2];E=E*A;T=T*M;T=E+T;C=C*R;C=T+C;i=t+1036|0;h[i>>2]=C;i=t+832|0;I=t+848|0;P=t+864|0;C=+h[i>>2];T=+h[I>>2];E=+h[P>>2];A=C*A;M=T*M;M=A+M;R=E*R;R=M+R;P=t+1040|0;h[P>>2]=R;return}function Pb(t,e){t=t|0;e=e|0;var i=0.0,o=0,a=0.0,l=0,c=0.0,u=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0,v=0.0,S=0.0,x=0.0,w=0,C=0,T=0,A=0,E=0.0,M=0.0,R=0,I=0,P=0.0,L=0.0,D=0,k=0.0,O=0,F=0,B=0,N=0,U=0,V=0,z=0,j=0,H=0,X=0,Y=0,q=0.0,K=0.0,Z=0.0,Q=0,$=0.0,J=0.0,tt=0.0,it=0,nt=0,st=0.0,rt=0,ot=0,at=0.0,lt=0.0;ot=_;_=_+16|0;nt=r[t+28>>2]|0;rt=r[t+32>>2]|0;$=+h[nt+368>>2];J=+h[rt+368>>2];Q=r[e+24>>2]|0;st=n[t+180>>0]|0?1.0:-1.0;q=+h[t+936>>2]-+h[t+872>>2];K=+h[t+940>>2]-+h[t+876>>2];Z=+h[t+944>>2]-+h[t+880>>2];tt=$+J>0.0?J/($+J):.5;D=r[t+824>>2]|0;O=r[t+840>>2]|0;F=r[t+856>>2]|0;B=r[t+888>>2]|0;N=r[t+904>>2]|0;U=r[t+920>>2]|0;V=(n[t+49>>0]|0)==0;if(V){C=r[t+828>>2]|0;l=r[t+844>>2]|0;y=r[t+860>>2]|0;r[ot+4>>2]=l;w=r[t+832>>2]|0;R=r[t+848>>2]|0;it=r[t+864>>2]|0;r[ot>>2]=w;x=(r[d>>2]=y,+h[d>>2]);S=(r[d>>2]=w,+h[d>>2]);m=(r[d>>2]=R,+h[d>>2]);I=it;v=(r[d>>2]=it,+h[d>>2]);it=D;T=O;A=F}else{i=tt*(r[d>>2]=D,+h[d>>2]);u=tt*(r[d>>2]=O,+h[d>>2]);c=tt*(r[d>>2]=F,+h[d>>2]);a=(1.0-tt)*(r[d>>2]=B,+h[d>>2]);p=(1.0-tt)*(r[d>>2]=N,+h[d>>2]);c=c+(1.0-tt)*(r[d>>2]=U,+h[d>>2]);f=1.0/+G(+((i+a)*(i+a)+(u+p)*(u+p)+c*c));C=(h[d>>2]=(i+a)*f,r[d>>2]|0);T=(h[d>>2]=(u+p)*f,r[d>>2]|0);A=(h[d>>2]=c*f,r[d>>2]|0);if(+W(+(c*f))>.7071067690849304){k=1.0/+G(+(c*f*(c*f)+(u+p)*f*((u+p)*f)));h[ot+4>>2]=-(c*f*k);m=-((i+a)*f*((u+p)*f*k));g=(i+a)*f*-(c*f*k);a=(c*f*(c*f)+(u+p)*f*((u+p)*f))*k;i=(u+p)*f*k;o=0}else{g=(i+a)*f*((i+a)*f)+(u+p)*f*((u+p)*f);k=1.0/+G(+g);o=(h[d>>2]=-((u+p)*f*k),r[d>>2]|0);h[ot+4>>2]=(i+a)*f*k;m=c*f*-((u+p)*f*k);g=g*k;a=-(c*f*((i+a)*f*k));i=0.0}y=(h[d>>2]=i,r[d>>2]|0);w=(h[d>>2]=a,r[d>>2]|0);h[ot>>2]=a;R=(h[d>>2]=m,r[d>>2]|0);l=r[ot+4>>2]|0;I=(h[d>>2]=g,r[d>>2]|0);x=i;S=a;v=g;it=C;C=o}o=r[e+12>>2]|0;r[o>>2]=C;r[o+4>>2]=l;r[o+8>>2]=y;r[o+(Q<<2)>>2]=w;r[o+(Q+1<<2)>>2]=R;r[o+(Q+2<<2)>>2]=I;g=(r[d>>2]=C,+h[d>>2]);o=r[e+20>>2]|0;h[o>>2]=-g;b=+h[ot+4>>2];h[o+4>>2]=-b;h[o+8>>2]=-x;h[o+(Q<<2)>>2]=-S;h[o+(Q+1<<2)>>2]=-m;h[o+(Q+2<<2)>>2]=-v;o=r[t+300>>2]|0;i=+h[t+280>>2];if(!(o&128))i=i*+h[e+4>>2];p=i*+h[e>>2];L=(r[d>>2]=O,+h[d>>2]);E=(r[d>>2]=U,+h[d>>2]);f=(r[d>>2]=F,+h[d>>2]);P=(r[d>>2]=N,+h[d>>2]);k=(r[d>>2]=B,+h[d>>2]);M=(r[d>>2]=D,+h[d>>2]);Y=r[e+28>>2]|0;h[Y>>2]=p*((L*E-f*P)*g+(f*k-M*E)*b+(M*P-L*k)*x);h[Y+(Q<<2)>>2]=p*((L*E-f*P)*S+(f*k-M*E)*m+(M*P-L*k)*v);if(o&64|0){Y=r[e+32>>2]|0;r[Y>>2]=r[t+292>>2];r[Y+(Q<<2)>>2]=r[t+292>>2]}u=+h[nt+52>>2];p=+h[nt+56>>2];f=+h[nt+60>>2];i=+h[rt+52>>2];a=+h[rt+56>>2];c=+h[rt+60>>2];if(V){j=(h[d>>2]=a-p,r[d>>2]|0);L=(a-p)*x-(c-f)*b;k=(c-f)*g-(i-u)*x;V=r[e+12>>2]|0;h[V+(Q<<1<<2)>>2]=tt*L;h[V+((Q<<1|1)<<2)>>2]=tt*k;h[V+((Q<<1)+2<<2)>>2]=tt*((i-u)*b-(a-p)*g);V=(h[d>>2]=i-u,r[d>>2]|0);z=(h[d>>2]=c-f,r[d>>2]|0);H=r[e+20>>2]|0;h[H+(Q<<1<<2)>>2]=(1.0-tt)*L;h[H+((Q<<1|1)<<2)>>2]=(1.0-tt)*k;h[H+((Q<<1)+2<<2)>>2]=(1.0-tt)*((i-u)*b-(a-p)*g);k=(a-p)*v-(c-f)*m;c=(c-f)*S-(i-u)*v;f=(i-u)*m-(a-p)*S;H=r[e+12>>2]|0;h[H+(Q*3<<2)>>2]=tt*k;h[H+((Q*3|0)+1<<2)>>2]=tt*c;h[H+((Q*3|0)+2<<2)>>2]=tt*f;H=r[e+20>>2]|0;h[H+(Q*3<<2)>>2]=(1.0-tt)*k;h[H+((Q*3|0)+1<<2)>>2]=(1.0-tt)*c;h[H+((Q*3|0)+2<<2)>>2]=(1.0-tt)*f;O=r[e+8>>2]|0;r[O+(Q<<1<<2)>>2]=C;h[O+((Q<<1|1)<<2)>>2]=b;h[O+((Q<<1)+2<<2)>>2]=x;O=r[e+8>>2]|0;N=r[ot>>2]|0;r[O+(Q*3<<2)>>2]=N;r[O+((Q*3|0)+1<<2)>>2]=R;r[O+((Q*3|0)+2<<2)>>2]=I;U=r[e+16>>2]|0;h[U+(Q<<1<<2)>>2]=-g;f=+h[ot+4>>2];h[U+((Q<<1|1)<<2)>>2]=-f;h[U+((Q<<1)+2<<2)>>2]=-x;U=r[e+16>>2]|0;u=(r[d>>2]=N,+h[d>>2]);h[U+(Q*3<<2)>>2]=-u;c=(r[d>>2]=R,+h[d>>2]);h[U+((Q*3|0)+1<<2)>>2]=-c;a=(r[d>>2]=I,+h[d>>2]);h[U+((Q*3|0)+2<<2)>>2]=-a;p=x;N=0;B=0;F=0;y=0;l=0;o=0}else{lt=+h[t+936>>2]-i;at=+h[t+940>>2]-a;P=+h[t+944>>2]-c;g=(r[d>>2]=it,+h[d>>2]);b=(r[d>>2]=T,+h[d>>2]);m=(r[d>>2]=A,+h[d>>2]);L=+h[t+872>>2]-u;k=+h[t+876>>2]-p;c=+h[t+880>>2]-f;p=+h[t+1080>>2]-+h[t+1032>>2];v=g*(g*L+b*k+m*c)+g*p-g*(g*lt+b*at+m*P);S=b*(g*L+b*k+m*c)+b*p-b*(g*lt+b*at+m*P);p=m*(g*L+b*k+m*c)+m*p-m*(g*lt+b*at+m*P);E=L-g*(g*L+b*k+m*c)+tt*v;x=k-b*(g*L+b*k+m*c)+tt*S;M=c-m*(g*L+b*k+m*c)+tt*p;N=(h[d>>2]=E,r[d>>2]|0);B=(h[d>>2]=x,r[d>>2]|0);F=(h[d>>2]=M,r[d>>2]|0);v=lt-g*(g*lt+b*at+m*P)-(1.0-tt)*v;S=at-b*(g*lt+b*at+m*P)-(1.0-tt)*S;p=P-m*(g*lt+b*at+m*P)-(1.0-tt)*p;y=(h[d>>2]=v,r[d>>2]|0);w=(h[d>>2]=S,r[d>>2]|0);C=(h[d>>2]=p,r[d>>2]|0);a=tt*(lt-g*(g*lt+b*at+m*P))+(1.0-tt)*(L-g*(g*L+b*k+m*c));i=tt*(at-b*(g*lt+b*at+m*P))+(1.0-tt)*(k-b*(g*L+b*k+m*c));c=tt*(P-m*(g*lt+b*at+m*P))+(1.0-tt)*(c-m*(g*L+b*k+m*c));h[ot+4>>2]=i;if(c*c+(a*a+i*i)>1.1920928955078125e-07){lt=1.0/+G(+(c*c+(a*a+i*i)));l=(h[d>>2]=a*lt,r[d>>2]|0);h[ot+4>>2]=lt*i;k=lt*c;u=lt*i;i=a*lt;o=(h[d>>2]=lt*c,r[d>>2]|0)}else{l=r[t+828>>2]|0;Y=r[t+844>>2]|0;o=r[t+860>>2]|0;r[ot+4>>2]=Y;k=(r[d>>2]=o,+h[d>>2]);u=(r[d>>2]=Y,+h[d>>2]);i=(r[d>>2]=l,+h[d>>2])}P=b*k-m*u;L=m*i-g*k;m=g*u-b*i;h[ot>>2]=P;Y=(r[e+12>>2]|0)+(Q<<1<<2)|0;h[Y>>2]=x*k-M*u;h[Y+4>>2]=M*i-E*k;h[Y+8>>2]=E*u-x*i;Y=r[e+20>>2]|0;h[Y+(Q<<1<<2)>>2]=-(S*k-p*u);h[Y+((Q<<1|1)<<2)>>2]=-(p*i-v*k);h[Y+((Q<<1)+2<<2)>>2]=-(v*u-S*i);if($<1.1920928955078125e-07|J<1.1920928955078125e-07?(n[t+297>>0]|0)!=0:0){f=(1.0-tt)*(S*m-p*L);p=(1.0-tt)*(p*P-v*m);c=(1.0-tt)*(v*L-S*P);u=tt*(x*m-M*L);a=tt*(E*L-x*P);i=tt*(M*P-E*m)}else{f=S*m-p*L;p=p*P-v*m;c=v*L-S*P;u=x*m-M*L;a=E*L-x*P;i=M*P-E*m}H=(r[e+12>>2]|0)+(Q*3<<2)|0;h[H>>2]=u;h[H+4>>2]=i;h[H+8>>2]=a;H=r[e+20>>2]|0;h[H+(Q*3<<2)>>2]=-f;h[H+((Q*3|0)+1<<2)>>2]=-p;h[H+((Q*3|0)+2<<2)>>2]=-c;O=r[e+8>>2]|0;r[O+(Q<<1<<2)>>2]=l;r[O+((Q<<1|1)<<2)>>2]=r[ot+4>>2];r[O+((Q<<1)+2<<2)>>2]=o;O=r[e+8>>2]|0;h[O+(Q*3<<2)>>2]=P;h[O+((Q*3|0)+1<<2)>>2]=L;h[O+((Q*3|0)+2<<2)>>2]=m;U=r[e+16>>2]|0;g=(r[d>>2]=l,+h[d>>2]);h[U+(Q<<1<<2)>>2]=-g;f=+h[ot+4>>2];h[U+((Q<<1|1)<<2)>>2]=-f;h[U+((Q<<1)+2<<2)>>2]=-k;U=r[e+16>>2]|0;h[U+(Q*3<<2)>>2]=-P;h[U+((Q*3|0)+1<<2)>>2]=-L;h[U+((Q*3|0)+2<<2)>>2]=-m;p=k;u=P;c=L;a=m;V=0;z=0;j=0;l=w;o=C}X=r[t+300>>2]|0;i=+h[t+264>>2];if(!(X&32))i=i*+h[e+4>>2];lt=i*+h[e>>2];Y=r[e+28>>2]|0;h[Y+(Q<<1<<2)>>2]=lt*(q*g+K*f+Z*p);h[Y+(Q*3<<2)>>2]=lt*(q*u+K*c+Z*a);if(X&16|0){D=r[e+32>>2]|0;r[D+(Q<<1<<2)>>2]=r[t+276>>2];r[D+(Q*3<<2)>>2]=r[t+276>>2]}D=s[t+296>>1]|0;if(!((D&255)<<24>>24)){I=0;v=0.0}else{v=st*+h[t+1032>>2];I=v>0.0?2:1}w=n[t+1096>>0]|0;C=(I|0)!=0;if(w&255|I){R=r[e+24>>2]<<2;r[O+(R<<2)>>2]=it;r[O+((R|1)<<2)>>2]=T;r[O+((R|2)<<2)>>2]=A;m=(r[d>>2]=it,+h[d>>2]);h[U+(R<<2)>>2]=-m;g=(r[d>>2]=T,+h[d>>2]);h[U+((R|1)<<2)>>2]=-g;b=(r[d>>2]=A,+h[d>>2]);h[U+((R|2)<<2)>>2]=-b;if(n[t+49>>0]|0){if(!($<1.1920928955078125e-07|J<1.1920928955078125e-07)){J=(r[d>>2]=B,+h[d>>2]);Z=(r[d>>2]=F,+h[d>>2]);$=(r[d>>2]=N,+h[d>>2]);lt=(r[d>>2]=l,+h[d>>2]);tt=(r[d>>2]=o,+h[d>>2]);at=(r[d>>2]=y,+h[d>>2]);Q=r[e+12>>2]|0;h[Q+(R<<2)>>2]=b*J-g*Z;h[Q+((R|1)<<2)>>2]=m*Z-b*$;h[Q+((R|2)<<2)>>2]=g*$-m*J;h[H+(R<<2)>>2]=-(b*lt-g*tt);h[H+((R|1)<<2)>>2]=-(m*tt-b*at);h[H+((R|2)<<2)>>2]=-(g*at-m*lt)}}else{lt=(r[d>>2]=j,+h[d>>2]);J=(r[d>>2]=z,+h[d>>2]);at=(r[d>>2]=V,+h[d>>2]);Q=r[e+12>>2]|0;h[Q+(R<<2)>>2]=tt*(b*lt-g*J);h[Q+((R|1)<<2)>>2]=tt*(m*J-b*at);h[Q+((R|2)<<2)>>2]=tt*(g*at-m*lt);h[H+(R<<2)>>2]=(1.0-tt)*(b*lt-g*J);h[H+((R|1)<<2)>>2]=(1.0-tt)*(m*J-b*at);h[H+((R|2)<<2)>>2]=(1.0-tt)*(g*at-m*lt)}o=+h[t+184>>2]==+h[t+188>>2];h[Y+(R<<2)>>2]=0.0;l=(r[e+36>>2]|0)+(R<<2)|0;h[l>>2]=0.0;y=(r[e+40>>2]|0)+(R<<2)|0;h[y>>2]=0.0;f=+h[((X&512|0)==0?e+4|0:t+232|0)>>2];if(!(w<<24>>24==0|C&o)){if(X&1|0)r[(r[e+32>>2]|0)+(R<<2)>>2]=r[t+212>>2];p=+h[t+1100>>2];i=+h[t+1080>>2];a=+h[t+184>>2];c=+h[t+188>>2];u=f*+h[e>>2];do{if(!(a>c))if(!(a==c)){if(p/u<0.0)if(i>=a?a-p/u>i:0){i=(a-i)/(p/u);break}else{i=i<a?0.0:1.0;break}if(p/u>0.0)if(i<=c?c-p/u<i:0){i=(c-i)/(p/u);break}else{i=i>c?0.0:1.0;break}else i=0.0}else i=0.0;else i=1.0}while(0);h[Y+(R<<2)>>2]=+h[Y+(R<<2)>>2]-st*i*p;h[l>>2]=-+h[t+1104>>2]/+h[e>>2]+ +h[l>>2];h[y>>2]=+h[t+1104>>2]/+h[e>>2]+ +h[y>>2]}if(C){h[Y+(R<<2)>>2]=+h[Y+(R<<2)>>2]+v*(f*+h[e>>2]);if(X&256|0)r[(r[e+32>>2]|0)+(R<<2)>>2]=r[t+244>>2];do{if(!o)if((I|0)==1){h[l>>2]=-3402823466385288598117041.0e14;h[y>>2]=0.0;break}else{h[l>>2]=0.0;h[y>>2]=3402823466385288598117041.0e14;break}else{h[l>>2]=-3402823466385288598117041.0e14;h[y>>2]=3402823466385288598117041.0e14}}while(0);lt=1.0-+h[t+240>>2];a=+W(+lt);do{if(!(lt!=lt|0.0!=0.0|lt==0.0)){i=st*(m*+h[nt+336>>2]+g*+h[nt+340>>2]+b*+h[nt+344>>2]-(m*+h[rt+336>>2]+g*+h[rt+340>>2]+b*+h[rt+344>>2]));if((I|0)==1){if(!(i<0.0))break;if(!(+h[Y+(R<<2)>>2]<-(a*i)))break;h[Y+(R<<2)>>2]=-(a*i);break}else{if(!(i>0.0))break;if(!(+h[Y+(R<<2)>>2]>-(a*i)))break;h[Y+(R<<2)>>2]=-(a*i);break}}}while(0);h[Y+(R<<2)>>2]=+h[t+232>>2]*+h[Y+(R<<2)>>2];o=5}else o=5}else o=4;if((D&65535)<256){C=0;S=0.0}else{S=+h[t+1088>>2];C=S>0.0?1:2}l=n[t+1112>>0]|0;y=(C|0)!=0;if(!(l&255|C)){_=ot;return}w=et(r[e+24>>2]|0,o)|0;rt=r[e+12>>2]|0;r[rt+(w<<2)>>2]=it;r[rt+(w+1<<2)>>2]=T;r[rt+(w+2<<2)>>2]=A;x=(r[d>>2]=it,+h[d>>2]);h[H+(w<<2)>>2]=-x;v=(r[d>>2]=T,+h[d>>2]);h[H+(w+1<<2)>>2]=-v;b=(r[d>>2]=A,+h[d>>2]);h[H+(w+2<<2)>>2]=-b;f=+h[t+192>>2];m=+h[t+196>>2];g=+h[((X&2048|0)==0?e+4|0:t+248|0)>>2];if(!(l<<24>>24==0|y&f==m)){if(!(X&4)){c=f;u=m}else{r[(r[e+32>>2]|0)+(w<<2)>>2]=r[t+228>>2];c=+h[t+192>>2];u=+h[t+196>>2]}i=+h[t+1084>>2];p=+h[t+1116>>2];a=g*+h[e>>2];do{if(!(c>u))if(!(c==u)){if(p/a<0.0)if(i>=c?c-p/a>i:0){i=(c-i)/(p/a);break}else{i=i<c?0.0:1.0;break}if(p/a>0.0)if(i<=u?u-p/a<i:0){i=(u-i)/(p/a);break}else{i=i>u?0.0:1.0;break}else i=0.0}else i=0.0;else i=1.0}while(0);h[Y+(w<<2)>>2]=i*p;h[(r[e+36>>2]|0)+(w<<2)>>2]=-+h[t+1120>>2]/+h[e>>2];h[(r[e+40>>2]|0)+(w<<2)>>2]=+h[t+1120>>2]/+h[e>>2]}if(!y){_=ot;return}h[Y+(w<<2)>>2]=+h[Y+(w<<2)>>2]+S*(g*+h[e>>2]);if(X&1024|0)r[(r[e+32>>2]|0)+(w<<2)>>2]=r[t+260>>2];do{if(!(f==m)){l=(r[e+36>>2]|0)+(w<<2)|0;o=r[e+40>>2]|0;if((C|0)==1){h[l>>2]=0.0;h[o+(w<<2)>>2]=3402823466385288598117041.0e14;break}else{h[l>>2]=-3402823466385288598117041.0e14;h[o+(w<<2)>>2]=0.0;break}}else{h[(r[e+36>>2]|0)+(w<<2)>>2]=-3402823466385288598117041.0e14;h[(r[e+40>>2]|0)+(w<<2)>>2]=3402823466385288598117041.0e14}}while(0);lt=1.0-+h[t+256>>2];a=+W(+lt);do{if(!(lt!=lt|0.0!=0.0|lt==0.0)){rt=r[t+28>>2]|0;e=r[t+32>>2]|0;i=x*+h[rt+352>>2]+v*+h[rt+356>>2]+b*+h[rt+360>>2]-(x*+h[e+352>>2]+v*+h[e+356>>2]+b*+h[e+360>>2]);if((C|0)==1){if(!(i<0.0))break;if(!(+h[Y+(w<<2)>>2]<-(a*i)))break;h[Y+(w<<2)>>2]=-(a*i);break}else{if(!(i>0.0))break;if(!(+h[Y+(w<<2)>>2]>-(a*i)))break;h[Y+(w<<2)>>2]=-(a*i);break}}}while(0);h[Y+(w<<2)>>2]=+h[t+248>>2]*+h[Y+(w<<2)>>2];_=ot;return}function Lb(t,e,i,n){t=t|0;e=e|0;i=+i;n=n|0;switch(e|0){case 2:{if((n|0)<1){h[t+232>>2]=i;r[t+300>>2]=r[t+300>>2]|512;return}if((n|0)<3){h[t+264>>2]=i;r[t+300>>2]=r[t+300>>2]|32;return}if((n|0)==3){h[t+248>>2]=i;r[t+300>>2]=r[t+300>>2]|2048;return}if((n|0)>=6)return;h[t+280>>2]=i;r[t+300>>2]=r[t+300>>2]|128;return}case 3:{if((n|0)<1){h[t+212>>2]=i;r[t+300>>2]=r[t+300>>2]|1;return}if((n|0)!=3)return;h[t+228>>2]=i;r[t+300>>2]=r[t+300>>2]|4;return}case 4:{if((n|0)<1){h[t+244>>2]=i;r[t+300>>2]=r[t+300>>2]|256;return}if((n|0)<3){h[t+276>>2]=i;r[t+300>>2]=r[t+300>>2]|16;return}if((n|0)==3){h[t+260>>2]=i;r[t+300>>2]=r[t+300>>2]|1024;return}if((n|0)>=6)return;h[t+292>>2]=i;r[t+300>>2]=r[t+300>>2]|64;return}default:return}}function Db(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0;t:do{switch(e|0){case 2:{if((i|0)<1){n=+h[t+232>>2];break t}if((i|0)<3){n=+h[t+264>>2];break t}if((i|0)==3){n=+h[t+248>>2];break t}if((i|0)<6)n=+h[t+280>>2];else n=3402823466385288598117041.0e14;break}case 3:{if((i|0)<1){n=+h[t+212>>2];break t}if((i|0)==3)n=+h[t+228>>2];else n=3402823466385288598117041.0e14;break}case 4:{if((i|0)<1){n=+h[t+244>>2];break t}if((i|0)<3){n=+h[t+276>>2];break t}if((i|0)==3){n=+h[t+260>>2];break t}if((i|0)<6)n=+h[t+292>>2];else n=3402823466385288598117041.0e14;break}default:n=3402823466385288598117041.0e14}}while(0);return+n}function kb(t){t=t|0;return 204}function Ob(t,e,i){t=t|0;e=e|0;i=i|0;Ub(t,e,i)|0;r[e+52>>2]=r[t+52>>2];r[e+56>>2]=r[t+56>>2];r[e+60>>2]=r[t+60>>2];r[e+64>>2]=r[t+64>>2];r[e+68>>2]=r[t+68>>2];r[e+72>>2]=r[t+72>>2];r[e+76>>2]=r[t+76>>2];r[e+80>>2]=r[t+80>>2];r[e+84>>2]=r[t+84>>2];r[e+88>>2]=r[t+88>>2];r[e+92>>2]=r[t+92>>2];r[e+96>>2]=r[t+96>>2];r[e+100>>2]=r[t+100>>2];r[e+104>>2]=r[t+104>>2];r[e+108>>2]=r[t+108>>2];r[e+112>>2]=r[t+112>>2];r[e+116>>2]=r[t+116>>2];r[e+120>>2]=r[t+120>>2];r[e+124>>2]=r[t+124>>2];r[e+128>>2]=r[t+128>>2];r[e+132>>2]=r[t+132>>2];r[e+136>>2]=r[t+136>>2];r[e+140>>2]=r[t+140>>2];r[e+144>>2]=r[t+144>>2];r[e+148>>2]=r[t+148>>2];r[e+152>>2]=r[t+152>>2];r[e+156>>2]=r[t+156>>2];r[e+160>>2]=r[t+160>>2];r[e+164>>2]=r[t+164>>2];r[e+168>>2]=r[t+168>>2];r[e+172>>2]=r[t+172>>2];r[e+176>>2]=r[t+176>>2];r[e+180>>2]=r[t+188>>2];r[e+184>>2]=r[t+184>>2];r[e+188>>2]=r[t+196>>2];r[e+192>>2]=r[t+192>>2];r[e+196>>2]=o[t+180>>0];r[e+200>>2]=o[t+49>>0];return 15616}function Fb(t){t=t|0;return r[t+300>>2]|0}function Bb(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0.0,a=0.0;s=_;_=_+16|0;r[t+4>>2]=e;r[t>>2]=7188;r[t+8>>2]=-1;r[t+12>>2]=-1;h[t+16>>2]=3402823466385288598117041.0e14;n[t+20>>0]=1;n[t+21>>0]=0;r[t+24>>2]=-1;r[t+28>>2]=i;if(!(n[19880]|0)){n[19880]=1;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;zy(21260,0.0,0,0,s)}r[5366]=r[5366]|1;h[5407]=0.0;o=+h[5417]*0.0;a=+h[5418]*0.0;h[5412]=+h[5416]*0.0;h[5413]=o;h[5414]=a;h[5415]=0.0;r[5420]=0;r[5421]=0;r[5422]=0;r[5423]=0;a=+h[5409]*0.0;o=+h[5410]*0.0;h[5461]=+h[5408]*0.0;h[5462]=a;h[5463]=o;h[5464]=0.0;r[t+32>>2]=21260;h[t+36>>2]=0.0;h[t+40>>2]=.30000001192092896;r[t+44>>2]=0;_=s;return}function Nb(t){t=t|0;var e=0;r[t>>2]=7916;e=r[t+520>>2]|0;if(e|0){if(n[t+524>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+520>>2]=0}n[t+524>>0]=1;r[t+520>>2]=0;r[t+512>>2]=0;r[t+516>>2]=0;r[t>>2]=3156;e=r[t+276>>2]|0;if(!e){n[t+280>>0]=1;r[t+276>>2]=0;r[t+268>>2]=0;t=t+272|0;r[t>>2]=0;return}if(n[t+280>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+276>>2]=0;n[t+280>>0]=1;r[t+276>>2]=0;r[t+268>>2]=0;t=t+272|0;r[t>>2]=0;return}function Ub(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0;r[e>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,r[t+28>>2]|0)|0;r[e+4>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,r[t+32>>2]|0)|0;n=Rk[r[(r[i>>2]|0)+40>>2]&31](i,t)|0;s=Rk[r[(r[i>>2]|0)+28>>2]&31](i,n)|0;r[e+8>>2]=s;if(s|0)lk[r[(r[i>>2]|0)+48>>2]&127](i,n);r[e+12>>2]=r[t+4>>2];r[e+24>>2]=o[t+21>>0];r[e+40>>2]=r[t+24>>2];r[e+44>>2]=r[t+16>>2];r[e+48>>2]=o[t+20>>0];r[e+20>>2]=r[t+12>>2];r[e+16>>2]=r[t+8>>2];r[e+28>>2]=r[t+36>>2];r[e+32>>2]=r[t+40>>2];r[e+36>>2]=0;n=r[t+28>>2]|0;if((r[n+512>>2]|0)>0){i=0;do{if((r[(r[n+520>>2]|0)+(i<<2)>>2]|0)==(t|0)){r[e+36>>2]=1;n=r[t+28>>2]|0}i=i+1|0}while((i|0)<(r[n+512>>2]|0))}n=r[t+32>>2]|0;if((r[n+512>>2]|0)>0)i=0;else return 15639;do{if((r[(r[n+520>>2]|0)+(i<<2)>>2]|0)==(t|0)){r[e+36>>2]=1;n=r[t+32>>2]|0}i=i+1|0}while((i|0)<(r[n+512>>2]|0));return 15639}function Vb(t){t=t|0;var e=0,i=0,s=0;r[t>>2]=7656;if(n[t+272>>0]|0?(e=r[t+204>>2]|0,ok[r[r[e>>2]>>2]&255](e),e=r[t+204>>2]|0,e|0):0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+196>>2]|0;if(e|0?(ok[r[r[e>>2]>>2]&255](e),i=r[t+196>>2]|0,i|0):0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}if(n[t+273>>0]|0?(s=r[t+200>>2]|0,ok[r[r[s>>2]>>2]&255](s),s=r[t+200>>2]|0,s|0):0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}e=r[t+316>>2]|0;if(e|0){if(n[t+320>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+316>>2]=0}n[t+320>>0]=1;r[t+316>>2]=0;r[t+308>>2]=0;r[t+312>>2]=0;e=r[t+288>>2]|0;if(e|0){if(n[t+292>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+288>>2]=0}n[t+292>>0]=1;r[t+288>>2]=0;r[t+280>>2]=0;r[t+284>>2]=0;e=r[t+240>>2]|0;if(e|0){if(n[t+244>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+240>>2]=0}n[t+244>>0]=1;r[t+240>>2]=0;r[t+232>>2]=0;r[t+236>>2]=0;e=r[t+220>>2]|0;if(e|0){if(n[t+224>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+220>>2]=0}n[t+224>>0]=1;r[t+220>>2]=0;r[t+212>>2]=0;r[t+216>>2]=0;e=r[t+188>>2]|0;if(!e){n[t+192>>0]=1;r[t+188>>2]=0;r[t+180>>2]=0;s=t+184|0;r[s>>2]=0;KS(t);return}if(n[t+192>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+188>>2]=0;n[t+192>>0]=1;r[t+188>>2]=0;r[t+180>>2]=0;s=t+184|0;r[s>>2]=0;KS(t);return}function zb(t){t=t|0;Vb(t);if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function Wb(t){t=t|0;var e=0,i=0,n=0;n=_;_=_+16|0;j_(15710);ex(t);t:do{if(ck[r[(r[t>>2]|0)+20>>2]&127](t)|0?(i=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0,(ck[r[(r[i>>2]|0)+56>>2]&127](i)|0)&6144|0):0){i=ck[r[(r[t>>2]|0)+104>>2]&127](t)|0;while(1){e=i+-1|0;if((i|0)<=0)break t;i=Rk[r[(r[t>>2]|0)+108>>2]&31](t,e)|0;lk[r[(r[t>>2]|0)+168>>2]&127](t,i);i=e}}}while(0);if((((ck[r[(r[t>>2]|0)+20>>2]&127](t)|0?(i=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0,(ck[r[(r[i>>2]|0)+56>>2]&127](i)|0)&16387|0):0)?ck[r[(r[t>>2]|0)+20>>2]&127](t)|0:0)?(i=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0,ck[r[(r[i>>2]|0)+56>>2]&127](i)|0):0)?(r[t+280>>2]|0)>0:0){e=0;do{i=r[(r[t+288>>2]|0)+(e<<2)>>2]|0;lk[r[(r[i>>2]|0)+12>>2]&127](i,r[t+72>>2]|0);e=e+1|0}while((e|0)<(r[t+280>>2]|0))}if(ck[r[(r[t>>2]|0)+20>>2]&127](t)|0){t=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;ok[r[(r[t>>2]|0)+100>>2]&255](t)}e=r[2006]|0;t=(r[e+16>>2]|0)+-1|0;r[e+16>>2]=t;if(t|0){_=n;return}do{if(r[e+4>>2]|0){de(n|0,0)|0;t=r[5649]|0;h[e+8>>2]=+h[e+8>>2]+ +(((r[n+4>>2]|0)-(r[t+4>>2]|0)+(((r[n>>2]|0)-(r[t>>2]|0)|0)*1e6|0)-(r[e+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[e+16>>2]|0)){e=r[2006]|0;break}else{_=n;return}}}while(0);r[2006]=r[e+20>>2];_=n;return}function Gb(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;Lx(t,e,i,n);return}function jb(t,e){t=t|0;e=e|0;if((e|0)==0?1:(r[e+236>>2]&2|0)==0){Dx(t,e);return}else{lk[r[(r[t>>2]|0)+92>>2]&127](t,e);return}}function Hb(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0;ok[r[(r[e>>2]|0)+32>>2]&255](e);i=yk[r[(r[e>>2]|0)+16>>2]&63](e,104,1)|0;n=r[i+8>>2]|0;s=n;o=s+104|0;do{r[s>>2]=0;s=s+4|0}while((s|0)<(o|0));r[n+88>>2]=r[t+248>>2];r[n+92>>2]=r[t+252>>2];r[n+96>>2]=r[t+256>>2];r[n+100>>2]=r[t+260>>2];r[n>>2]=r[t+92>>2];r[n+4>>2]=r[t+96>>2];r[n+8>>2]=r[t+100>>2];r[n+12>>2]=r[t+104>>2];r[n+16>>2]=r[t+108>>2];r[n+20>>2]=r[t+116>>2];r[n+24>>2]=r[t+120>>2];r[n+28>>2]=r[t+124>>2];r[n+32>>2]=r[t+128>>2];r[n+36>>2]=r[t+132>>2];r[n+40>>2]=r[t+140>>2];r[n+44>>2]=r[t+144>>2];r[n+48>>2]=r[t+148>>2];r[n+52>>2]=r[t+152>>2];r[n+56>>2]=r[t+168>>2];r[n+60>>2]=r[t+172>>2];r[n+64>>2]=r[t+112>>2];r[n+68>>2]=r[t+156>>2];r[n+72>>2]=r[t+160>>2];r[n+76>>2]=r[t+164>>2];r[n+80>>2]=r[t+136>>2];sk[r[(r[e>>2]|0)+20>>2]&31](e,i,15725,1145853764,n);Fx(t,e);Xb(t,e);ok[r[(r[e>>2]|0)+36>>2]&255](e);return}function Xb(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0;i=r[t+8>>2]|0;if((i|0)>0){s=0;do{n=r[(r[t+16>>2]|0)+(s<<2)>>2]|0;if(r[n+236>>2]&2){o=ck[r[(r[n>>2]|0)+16>>2]&127](n)|0;o=yk[r[(r[e>>2]|0)+16>>2]&63](e,o,1)|0;i=yk[r[(r[n>>2]|0)+20>>2]&63](n,r[o+8>>2]|0,e)|0;sk[r[(r[e>>2]|0)+20>>2]&31](e,o,i,1497645650,n);i=r[t+8>>2]|0}s=s+1|0}while((s|0)<(i|0))}if((r[t+212>>2]|0)<=0)return;i=0;do{o=r[(r[t+220>>2]|0)+(i<<2)>>2]|0;n=ck[r[(r[o>>2]|0)+36>>2]&127](o)|0;n=yk[r[(r[e>>2]|0)+16>>2]&63](e,n,1)|0;s=yk[r[(r[o>>2]|0)+40>>2]&63](o,r[n+8>>2]|0,e)|0;sk[r[(r[e>>2]|0)+20>>2]&31](e,n,s,1397641027,o);i=i+1|0}while((i|0)<(r[t+212>>2]|0));return}function Yb(t,e,i,s){t=t|0;e=+e;i=i|0;s=+s;var o=0,a=0.0,l=0,c=0;c=_;_=_+16|0;de(r[5649]|0,0)|0;G_(22556);r[5640]=(r[5640]|0)+1;l=r[5643]|0;r[5643]=l+1;if(!l){de(c|0,0)|0;l=r[5649]|0;r[5642]=(r[c+4>>2]|0)-(r[l+4>>2]|0)+(((r[c>>2]|0)-(r[l>>2]|0)|0)*1e6|0)}r[5648]=0;de(c|0,0)|0;j_(15750);if(i){h[t+268>>2]=s;a=+h[t+264>>2]+e;h[t+264>>2]=a;if(!(a>=s)){e=s;l=0}else{h[t+264>>2]=a-+(~~(a/s)|0)*s;e=s;l=~~(a/s)}}else{h[t+264>>2]=n[t+300>>0]|0?0.0:e;h[t+268>>2]=0.0;l=!(+W(+e)<1.1920928955078125e-07)&1;i=l}if(ck[r[(r[t>>2]|0)+20>>2]&127](t)|0){o=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;n[23328]=(ck[r[(r[o>>2]|0)+56>>2]&127](o)|0)>>>4&1}if(l){i=(l|0)>(i|0)?i:l;rk[r[(r[t>>2]|0)+164>>2]&31](t,e*+(i|0));ok[r[(r[t>>2]|0)+172>>2]&255](t);if((i|0)>0){o=0;do{rk[r[(r[t>>2]|0)+160>>2]&31](t,e);ok[r[(r[t>>2]|0)+80>>2]&255](t);o=o+1|0}while((o|0)<(i|0));i=t}else i=t}else{ok[r[(r[t>>2]|0)+80>>2]&255](t);i=t}ok[r[(r[i>>2]|0)+120>>2]&255](t);r[5648]=(r[5648]|0)+1;i=r[2006]|0;t=(r[i+16>>2]|0)+-1|0;r[i+16>>2]=t;if(t|0){_=c;return l|0}do{if(r[i+4>>2]|0){de(c|0,0)|0;t=r[5649]|0;h[i+8>>2]=+h[i+8>>2]+ +(((r[c+4>>2]|0)-(r[t+4>>2]|0)+(((r[c>>2]|0)-(r[t>>2]|0)|0)*1e6|0)-(r[i+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[i+16>>2]|0)){i=r[2006]|0;break}else{_=c;return l|0}}}while(0);r[2006]=r[i+20>>2];_=c;return l|0}function qb(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0,l=0;s=r[t+212>>2]|0;if((s|0)==(r[t+216>>2]|0)?(l=s|0?s<<1:1,(s|0)<(l|0)):0){if(!l)a=0;else{r[5637]=(r[5637]|0)+1;s=Zl((l<<2|3)+16|0)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}a=s;s=r[t+212>>2]|0}if((s|0)>0){o=0;do{r[a+(o<<2)>>2]=r[(r[t+220>>2]|0)+(o<<2)>>2];o=o+1|0}while((o|0)!=(s|0))}o=r[t+220>>2]|0;if(o){if(n[t+224>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0);s=r[t+212>>2]|0}r[t+220>>2]=0}n[t+224>>0]=1;r[t+220>>2]=a;r[t+216>>2]=l}r[(r[t+220>>2]|0)+(s<<2)>>2]=e;r[t+212>>2]=s+1;if(!i)return;jy(r[e+28>>2]|0,e);jy(r[e+32>>2]|0,e);return}function Kb(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0;s=r[t+212>>2]|0;t:do{if((s|0)>0){o=r[t+220>>2]|0;i=0;while(1){n=o+(i<<2)|0;if((r[n>>2]|0)==(e|0))break;i=i+1|0;if((i|0)>=(s|0))break t}if((i|0)<(s|0)){r[n>>2]=r[o+(s+-1<<2)>>2];r[(r[t+220>>2]|0)+(s+-1<<2)>>2]=e;r[t+212>>2]=s+-1}}}while(0);Hy(r[e+28>>2]|0,e);Hy(r[e+32>>2]|0,e);return}function Zb(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0;i=r[t+280>>2]|0;if((i|0)==(r[t+284>>2]|0)?(a=i|0?i<<1:1,(i|0)<(a|0)):0){if(!a)o=0;else{r[5637]=(r[5637]|0)+1;i=Zl((a<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=i;i=r[t+280>>2]|0}if((i|0)>0){s=0;do{r[o+(s<<2)>>2]=r[(r[t+288>>2]|0)+(s<<2)>>2];s=s+1|0}while((s|0)!=(i|0))}s=r[t+288>>2]|0;if(s){if(n[t+292>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0);i=r[t+280>>2]|0}r[t+288>>2]=0}n[t+292>>0]=1;r[t+288>>2]=o;r[t+284>>2]=a}r[(r[t+288>>2]|0)+(i<<2)>>2]=e;r[t+280>>2]=i+1;return}function Qb(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0,a=0;s=r[t+280>>2]|0;if((s|0)<=0)return;o=r[t+288>>2]|0;i=0;while(1){n=o+(i<<2)|0;if((r[n>>2]|0)==(e|0))break;i=i+1|0;if((i|0)>=(s|0)){a=7;break}}if((a|0)==7)return;if((i|0)>=(s|0))return;r[n>>2]=r[o+(s+-1<<2)>>2];r[(r[t+288>>2]|0)+(s+-1<<2)>>2]=e;r[t+280>>2]=s+-1;return}function $b(t,e){t=t|0;e=e|0;var i=0,n=0.0,s=0,o=0,a=0.0,l=0.0;r[t+248>>2]=r[e>>2];r[t+248+4>>2]=r[e+4>>2];r[t+248+8>>2]=r[e+8>>2];r[t+248+12>>2]=r[e+12>>2];i=r[t+232>>2]|0;if((i|0)<=0)return;o=0;do{s=r[(r[t+240>>2]|0)+(o<<2)>>2]|0;switch(r[s+216>>2]|0){case 2:case 5:break;default:if(!(r[s+528>>2]&1)){n=+h[s+368>>2];if(n!=0.0){l=1.0/n*+h[e+4>>2];a=1.0/n*+h[e+8>>2];h[s+388>>2]=1.0/n*+h[e>>2];h[s+392>>2]=l;h[s+396>>2]=a;h[s+400>>2]=0.0}r[s+404>>2]=r[e>>2];r[s+404+4>>2]=r[e+4>>2];r[s+404+8>>2]=r[e+8>>2];r[s+404+12>>2]=r[e+12>>2];i=r[t+232>>2]|0}}o=o+1|0}while((o|0)<(i|0));return}function Jb(t,e){t=t|0;e=e|0;r[t>>2]=r[e+248>>2];r[t+4>>2]=r[e+248+4>>2];r[t+8>>2]=r[e+248+8>>2];r[t+12>>2]=r[e+248+12>>2];return}function ty(t){t=t|0;var e=0,i=0.0,s=0,o=0,a=0.0,l=0.0,c=0;c=_;_=_+64|0;j_(15765);t:do{if(!(n[t+274>>0]|0)){e=r[t+232>>2]|0;if((e|0)>0){o=0;while(1){s=r[(r[t+240>>2]|0)+(o<<2)>>2]|0;switch(r[s+216>>2]|0){case 2:case 5:break;default:if((r[s+504>>2]|0)!=0?(r[s+204>>2]&3|0)==0:0){if((n[t+300>>0]|0)!=0?(l=+h[t+268>>2],l!=0.0):0)i=+h[t+264>>2]-l;else i=+h[t+264>>2]*+h[s+248>>2];Vv(s+68|0,+h[s+132>>2],+h[s+136>>2],+h[s+140>>2],s+148|0,i,c);e=r[s+504>>2]|0;lk[r[(r[e>>2]|0)+12>>2]&127](e,c);e=r[t+232>>2]|0}}o=o+1|0;if((o|0)>=(e|0))break t}}}else{e=r[t+8>>2]|0;if((e|0)>0){o=0;do{s=r[(r[t+16>>2]|0)+(o<<2)>>2]|0;if((!((s|0)==0?1:(r[s+236>>2]&2|0)==0)?(r[s+504>>2]|0)!=0:0)?(r[s+204>>2]&3|0)==0:0){if((n[t+300>>0]|0)!=0?(a=+h[t+268>>2],a!=0.0):0)i=+h[t+264>>2]-a;else i=+h[t+264>>2]*+h[s+248>>2];Vv(s+68|0,+h[s+132>>2],+h[s+136>>2],+h[s+140>>2],s+148|0,i,c);e=r[s+504>>2]|0;lk[r[(r[e>>2]|0)+12>>2]&127](e,c);e=r[t+8>>2]|0}o=o+1|0}while((o|0)<(e|0))}}}while(0);e=r[2006]|0;t=(r[e+16>>2]|0)+-1|0;r[e+16>>2]=t;if(t|0){_=c;return}do{if(r[e+4>>2]|0){de(c|0,0)|0;t=r[5649]|0;h[e+8>>2]=+h[e+8>>2]+ +(((r[c+4>>2]|0)-(r[t+4>>2]|0)+(((r[c>>2]|0)-(r[t>>2]|0)|0)*1e6|0)-(r[e+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[e+16>>2]|0)){e=r[2006]|0;break}else{_=c;return}}}while(0);r[2006]=r[e+20>>2];_=c;return}function ey(t,e){t=t|0;e=e|0;var i=0,s=0,o=0.0,a=0,l=0,c=0.0,_=0.0;i=r[e+204>>2]|0;if((i&3|0)==0?(r[e+528>>2]&1|0)==0:0){o=+h[e+368>>2];if(o!=0.0){_=1.0/o*+h[t+252>>2];c=1.0/o*+h[t+256>>2];h[e+388>>2]=1.0/o*+h[t+248>>2];h[e+392>>2]=_;h[e+396>>2]=c;h[e+400>>2]=0.0}r[e+404>>2]=r[t+248>>2];r[e+404+4>>2]=r[t+248+4>>2];r[e+404+8>>2]=r[t+248+8>>2];r[e+404+12>>2]=r[t+248+12>>2]}if(!(r[e+192>>2]|0))return;if(i&1){if((r[e+216>>2]&-2|0)!=4)r[e+216>>2]=2}else{s=r[t+232>>2]|0;if((s|0)==(r[t+236>>2]|0)?(l=s|0?s<<1:1,(s|0)<(l|0)):0){if(!l)i=0;else{r[5637]=(r[5637]|0)+1;i=Zl((l<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}s=r[t+232>>2]|0}if((s|0)>0){a=0;do{r[i+(a<<2)>>2]=r[(r[t+240>>2]|0)+(a<<2)>>2];a=a+1|0}while((a|0)!=(s|0))}a=r[t+240>>2]|0;if(a){if(n[t+244>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0);s=r[t+232>>2]|0}r[t+240>>2]=0}n[t+244>>0]=1;r[t+240>>2]=i;r[t+236>>2]=l;i=r[e+204>>2]|0}r[(r[t+240>>2]|0)+(s<<2)>>2]=e;r[t+232>>2]=s+1}l=(i&3|0)==0;jk[r[(r[t>>2]|0)+36>>2]&127](t,e,l?1:2,l?-1:-3);return}function iy(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0.0,l=0,c=0,_=0,u=0.0,d=0.0;o=r[e+204>>2]|0;if((o&3|0)==0?(r[e+528>>2]&1|0)==0:0){a=+h[e+368>>2];if(a!=0.0){d=1.0/a*+h[t+252>>2];u=1.0/a*+h[t+256>>2];h[e+388>>2]=1.0/a*+h[t+248>>2];h[e+392>>2]=d;h[e+396>>2]=u;h[e+400>>2]=0.0}r[e+404>>2]=r[t+248>>2];r[e+404+4>>2]=r[t+248+4>>2];r[e+404+8>>2]=r[t+248+8>>2];r[e+404+12>>2]=r[t+248+12>>2]}if(!(r[e+192>>2]|0))return;if(o&1){if((r[e+216>>2]&-2|0)!=4)r[e+216>>2]=2}else{o=r[t+232>>2]|0;if((o|0)==(r[t+236>>2]|0)?(_=o|0?o<<1:1,(o|0)<(_|0)):0){if(!_)c=0;else{r[5637]=(r[5637]|0)+1;o=Zl((_<<2|3)+16|0)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}c=o;o=r[t+232>>2]|0}if((o|0)>0){l=0;do{r[c+(l<<2)>>2]=r[(r[t+240>>2]|0)+(l<<2)>>2];l=l+1|0}while((l|0)!=(o|0))}l=r[t+240>>2]|0;if(l){if(n[t+244>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0);o=r[t+232>>2]|0}r[t+240>>2]=0}n[t+244>>0]=1;r[t+240>>2]=c;r[t+236>>2]=_}r[(r[t+240>>2]|0)+(o<<2)>>2]=e;r[t+232>>2]=o+1}jk[r[(r[t>>2]|0)+36>>2]&127](t,e,i,s);return}function ny(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0,a=0;s=r[t+232>>2]|0;t:do{if((s|0)>0){o=r[t+240>>2]|0;i=0;while(1){n=o+(i<<2)|0;if((r[n>>2]|0)==(e|0))break;i=i+1|0;if((i|0)>=(s|0))break t}if((i|0)<(s|0)){r[n>>2]=r[o+(s+-1<<2)>>2];r[(r[t+240>>2]|0)+(s+-1<<2)>>2]=e;r[t+232>>2]=s+-1}}}while(0);i=r[e+188>>2]|0;if(i|0){o=r[t+68>>2]|0;o=ck[r[(r[o>>2]|0)+36>>2]&127](o)|0;Vk[r[(r[o>>2]|0)+40>>2]&127](o,i,r[t+24>>2]|0);o=r[t+68>>2]|0;Vk[r[(r[o>>2]|0)+12>>2]&127](o,i,r[t+24>>2]|0);r[e+188>>2]=0}s=r[t+8>>2]|0;if((s|0)<=0)return;o=r[t+16>>2]|0;i=0;while(1){n=o+(i<<2)|0;if((r[n>>2]|0)==(e|0))break;i=i+1|0;if((i|0)>=(s|0)){a=15;break}}if((a|0)==15)return;if((i|0)>=(s|0))return;r[n>>2]=r[o+(s+-1<<2)>>2];r[(r[t+16>>2]|0)+(s+-1<<2)>>2]=e;r[t+8>>2]=s+-1;return}function sy(t,e){t=t|0;e=e|0;var i=0;if(n[t+273>>0]|0?(i=r[t+200>>2]|0,i|0):0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}n[t+273>>0]=0;r[t+200>>2]=e;r[(r[t+196>>2]|0)+8>>2]=e;return}function ry(t){t=t|0;return r[t+200>>2]|0}function oy(t){t=t|0;return r[t+212>>2]|0}function ay(t,e){t=t|0;e=e|0;return r[(r[t+220>>2]|0)+(e<<2)>>2]|0}function ly(t,e){t=t|0;e=e|0;return r[(r[t+220>>2]|0)+(e<<2)>>2]|0}function hy(t){t=t|0;return 2}function cy(t){t=t|0;var e=0,i=0;if((r[t+232>>2]|0)<=0)return;e=0;do{i=(r[(r[t+240>>2]|0)+(e<<2)>>2]|0)+436|0;r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;r[i+12>>2]=0;r[i+16>>2]=0;r[i+20>>2]=0;r[i+24>>2]=0;r[i+28>>2]=0;e=e+1|0}while((e|0)<(r[t+232>>2]|0));return}function _y(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+64>>2]&127](t,e);return}function uy(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+68>>2]&127](t,e);return}function dy(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+64>>2]&127](t,e);return}function py(t,e){t=t|0;e=e|0;lk[r[(r[t>>2]|0)+68>>2]&127](t,e);return}function fy(t,e){t=t|0;e=+e;var i=0,n=0,s=0,o=0;o=_;_=_+16|0;j_(15789);i=r[t+232>>2]|0;if((i|0)>0){s=0;do{n=r[(r[t+240>>2]|0)+(s<<2)>>2]|0;if(!(r[n+204>>2]&3)){Wy(n,e);Vv(n+4|0,+h[n+336>>2],+h[n+340>>2],+h[n+344>>2],n+352|0,e,n+68|0);i=r[t+232>>2]|0}s=s+1|0}while((s|0)<(i|0))}i=r[2006]|0;t=(r[i+16>>2]|0)+-1|0;r[i+16>>2]=t;if(t|0){_=o;return}do{if(r[i+4>>2]|0){de(o|0,0)|0;t=r[5649]|0;h[i+8>>2]=+h[i+8>>2]+ +(((r[o+4>>2]|0)-(r[t+4>>2]|0)+(((r[o>>2]|0)-(r[t>>2]|0)|0)*1e6|0)-(r[i+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[i+16>>2]|0)){i=r[2006]|0;break}else{_=o;return}}}while(0);r[2006]=r[i+20>>2];_=o;return}function my(t,e){t=t|0;e=+e;var i=0,o=0.0,a=0,l=0.0,c=0.0,u=0,d=0,p=0,f=0,m=0.0,g=0.0,b=0,y=0.0,v=0;b=_;_=_+304|0;j_(15815);t:do{if((r[t+232>>2]|0)>0){d=b+136+48|0;p=0;while(1){u=r[(r[t+240>>2]|0)+(p<<2)>>2]|0;h[u+248>>2]=1.0;e:do{switch(r[u+216>>2]|0){case 2:case 5:break;default:if(!(r[u+204>>2]&3)){Vv(u+4|0,+h[u+336>>2],+h[u+340>>2],+h[u+344>>2],u+352|0,e,b+136|0);o=+h[d>>2]-+h[u+52>>2];l=+h[b+136+52>>2]-+h[u+56>>2];c=+h[b+136+56>>2]-+h[u+60>>2];if(n[t+44>>0]|0?(y=+h[u+256>>2],y*y!=0.0?y*y<o*o+l*l+c*c:0):0){j_(15835);if((r[(r[u+192>>2]|0)+4>>2]|0)<20){r[5475]=(r[5475]|0)+1;i=r[t+68>>2]|0;i=ck[r[(r[i>>2]|0)+36>>2]&127](i)|0;a=r[t+24>>2]|0;h[b+200+4>>2]=1.0;s[b+200+8>>1]=1;s[b+200+10>>1]=-1;r[b+200>>2]=7848;r[b+200+12>>2]=r[u+52>>2];r[b+200+12+4>>2]=r[u+52+4>>2];r[b+200+12+8>>2]=r[u+52+8>>2];r[b+200+12+12>>2]=r[u+52+12>>2];r[b+200+28>>2]=r[d>>2];r[b+200+28+4>>2]=r[d+4>>2];r[b+200+28+8>>2]=r[d+8>>2];r[b+200+28+12>>2]=r[d+12>>2];r[b+200+76>>2]=0;r[b+200>>2]=7872;r[b+200+80>>2]=u;r[b+200+88>>2]=i;r[b+200+92>>2]=a;a=r[u+252>>2]|0;r[b+64+8>>2]=0;r[b+64+12>>2]=-1;r[b+64+16>>2]=1065353216;r[b+64+20>>2]=1065353216;r[b+64+24>>2]=1065353216;h[b+64+28>>2]=0.0;r[b+64>>2]=6380;r[b+64+4>>2]=8;r[b+64+32>>2]=a;r[b+64+48>>2]=a;r[b+200+84>>2]=r[t+56>>2];a=r[(r[u+188>>2]|0)+4>>2]|0;s[b+200+8>>1]=a;s[b+200+10>>1]=a>>>16;r[b+48>>2]=r[d>>2];r[b+48+4>>2]=r[d+4>>2];r[b+48+8>>2]=r[d+8>>2];r[b+48+12>>2]=r[d+12>>2];r[b>>2]=r[u+4>>2];r[b+4>>2]=r[u+4+4>>2];r[b+8>>2]=r[u+4+8>>2];r[b+12>>2]=r[u+4+12>>2];r[b+16>>2]=r[u+20>>2];r[b+16+4>>2]=r[u+20+4>>2];r[b+16+8>>2]=r[u+20+8>>2];r[b+16+12>>2]=r[u+20+12>>2];r[b+32>>2]=r[u+36>>2];r[b+32+4>>2]=r[u+36+4>>2];r[b+32+8>>2]=r[u+36+8>>2];r[b+32+12>>2]=r[u+36+12>>2];Yx(t,b+64|0,u+4|0,b,b+200|0,0.0);o=+h[b+200+4>>2];if(o<1.0){h[u+248>>2]=o;Vv(u+4|0,+h[u+336>>2],+h[u+340>>2],+h[u+344>>2],u+352|0,o*e,b+136|0);h[u+248>>2]=0.0;Gy(u,b+136|0);i=4}else i=0;if(!i)f=12}else f=12;if((f|0)==12){f=0;i=0}a=r[2006]|0;v=(r[a+16>>2]|0)+-1|0;r[a+16>>2]=v;do{if(!v){if(r[a+4>>2]|0){de(b+200|0,0)|0;v=r[5649]|0;h[a+8>>2]=+h[a+8>>2]+ +(((r[b+200+4>>2]|0)-(r[v+4>>2]|0)+(((r[b+200>>2]|0)-(r[v>>2]|0)|0)*1e6|0)-(r[a+12>>2]|0)|0)>>>0)/1.0e3;if(r[a+16>>2]|0)break;a=r[2006]|0}r[2006]=r[a+20>>2]}}while(0);if(i|0)break e}Gy(u,b+136|0)}}}while(0);p=p+1|0;if((p|0)>=(r[t+232>>2]|0))break t}}}while(0);do{if(n[t+275>>0]|0){j_(15892);if((r[t+308>>2]|0)>0){f=0;do{p=r[(r[t+316>>2]|0)+(f<<2)>>2]|0;u=r[p+740>>2]|0;u=(r[u+236>>2]&2|0)==0?0:u;d=r[p+744>>2]|0;d=(r[d+236>>2]&2|0)==0?0:d;i=r[p+748>>2]|0;if((i|0)>0)if(!u){a=0;do{o=+h[57]*+h[d+228>>2];if(o>0.0?(m=+h[p+4+(a*184|0)+120>>2],m!=0.0):0){c=o*(+h[p+4+(a*184|0)+64>>2]*m);e=o*(+h[p+4+(a*184|0)+68>>2]*m);y=o*(+h[p+4+(a*184|0)+72>>2]*m);o=+h[p+4+(a*184|0)+36>>2]-+h[d+56>>2];l=+h[p+4+(a*184|0)+40>>2]-+h[d+60>>2];h[b>>2]=+h[p+4+(a*184|0)+32>>2]-+h[d+52>>2];h[b+4>>2]=o;h[b+8>>2]=l;h[b+12>>2]=0.0;h[b+120>>2]=c;h[b+120+4>>2]=e;h[b+120+8>>2]=y;h[b+120+12>>2]=0.0;zE(d,b+120|0,b);i=r[p+748>>2]|0}a=a+1|0}while((a|0)<(i|0))}else{a=0;do{o=+h[u+228>>2]*+h[d+228>>2];if(o>0.0?(g=+h[p+4+(a*184|0)+120>>2],g!=0.0):0){c=o*(+h[p+4+(a*184|0)+64>>2]*g);e=o*(+h[p+4+(a*184|0)+68>>2]*g);y=o*(+h[p+4+(a*184|0)+72>>2]*g);h[b+200>>2]=-c;h[b+200+4>>2]=-e;h[b+200+8>>2]=-y;h[b+200+12>>2]=0.0;l=+h[p+4+(a*184|0)+52>>2]-+h[u+56>>2];o=+h[p+4+(a*184|0)+56>>2]-+h[u+60>>2];h[b+64>>2]=+h[p+4+(a*184|0)+48>>2]-+h[u+52>>2];h[b+64+4>>2]=l;h[b+64+8>>2]=o;h[b+64+12>>2]=0.0;o=+h[p+4+(a*184|0)+36>>2]-+h[d+56>>2];l=+h[p+4+(a*184|0)+40>>2]-+h[d+60>>2];h[b>>2]=+h[p+4+(a*184|0)+32>>2]-+h[d+52>>2];h[b+4>>2]=o;h[b+8>>2]=l;h[b+12>>2]=0.0;zE(u,b+200|0,b+64|0);h[b+120>>2]=c;h[b+120+4>>2]=e;h[b+120+8>>2]=y;h[b+120+12>>2]=0.0;zE(d,b+120|0,b);i=r[p+748>>2]|0}a=a+1|0}while((a|0)<(i|0))}f=f+1|0}while((f|0)<(r[t+308>>2]|0))}i=r[2006]|0;v=(r[i+16>>2]|0)+-1|0;r[i+16>>2]=v;if(!v){if(r[i+4>>2]|0){de(b+200|0,0)|0;v=r[5649]|0;h[i+8>>2]=+h[i+8>>2]+ +(((r[b+200+4>>2]|0)-(r[v+4>>2]|0)+(((r[b+200>>2]|0)-(r[v>>2]|0)|0)*1e6|0)-(r[i+12>>2]|0)|0)>>>0)/1.0e3;if(r[i+16>>2]|0)break;i=r[2006]|0}r[2006]=r[i+20>>2]}}}while(0);i=r[2006]|0;v=(r[i+16>>2]|0)+-1|0;r[i+16>>2]=v;if(v|0){_=b;return}do{if(r[i+4>>2]|0){de(b+200|0,0)|0;v=r[5649]|0;h[i+8>>2]=+h[i+8>>2]+ +(((r[b+200+4>>2]|0)-(r[v+4>>2]|0)+(((r[b+200>>2]|0)-(r[v>>2]|0)|0)*1e6|0)-(r[i+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[i+16>>2]|0)){i=r[2006]|0;break}else{_=b;return}}}while(0);r[2006]=r[i+20>>2];_=b;return}function gy(t){t=t|0;Ql(t);return}function by(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0;r[t+4>>2]=r[e+40>>2];n=r[e>>2]|0;r[t+76>>2]=n;if(i){r[t+44>>2]=r[e+8>>2];r[t+44+4>>2]=r[e+8+4>>2];r[t+44+8>>2]=r[e+8+8>>2];r[t+44+12>>2]=r[e+8+12>>2];t=t+60|0;i=e+24|0;r[t>>2]=r[i>>2];r[t+4>>2]=r[i+4>>2];r[t+8>>2]=r[i+8>>2];r[t+12>>2]=r[i+12>>2];s=+h[e+40>>2];return+s}else{c=+h[e+8>>2];l=+h[e+12>>2];a=+h[e+16>>2];o=c*+h[n+20>>2]+l*+h[n+24>>2]+a*+h[n+28>>2];s=c*+h[n+36>>2]+l*+h[n+40>>2]+a*+h[n+44>>2];h[t+44>>2]=+h[n+4>>2]*c+ +h[n+8>>2]*l+ +h[n+12>>2]*a;h[t+48>>2]=o;h[t+52>>2]=s;h[t+56>>2]=0.0;t=t+60|0;i=e+24|0;r[t>>2]=r[i>>2];r[t+4>>2]=r[i+4>>2];r[t+8>>2]=r[i+8>>2];r[t+12>>2]=r[i+12>>2];s=+h[e+40>>2];return+s}return 0.0}function yy(t){t=t|0;Ql(t);return}function vy(t,e){t=t|0;e=e|0;var i=0,n=0;i=r[e>>2]|0;n=r[t+80>>2]|0;if((i|0)==(n|0)){t=0;return t|0}e=r[e+4>>2]|0;if(!((s[t+10>>1]&(e&65535))<<16>>16)){t=0;return t|0}if(!((s[t+8>>1]&(e>>>16&65535))<<16>>16)){t=0;return t|0}t=r[t+92>>2]|0;t=yk[r[(r[t>>2]|0)+28>>2]&63](t,n,i)|0;return t|0}function Sy(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0;n=r[e>>2]|0;if((n|0)==(r[t+80>>2]|0)){s=1.0;return+s}if(r[n+204>>2]&4|0){s=1.0;return+s}if((+h[t+28>>2]-+h[t+12>>2])*+h[e+8>>2]+(+h[t+32>>2]-+h[t+16>>2])*+h[e+12>>2]+(+h[t+36>>2]-+h[t+20>>2])*+h[e+16>>2]>=-+h[t+84>>2]){s=1.0;return+s}r[t+4>>2]=r[e+40>>2];r[t+76>>2]=n;if(i){r[t+44>>2]=r[e+8>>2];r[t+44+4>>2]=r[e+8+4>>2];r[t+44+8>>2]=r[e+8+8>>2];r[t+44+12>>2]=r[e+8+12>>2]}else{c=+h[e+8>>2];l=+h[e+12>>2];a=+h[e+16>>2];o=c*+h[n+20>>2]+l*+h[n+24>>2]+a*+h[n+28>>2];s=c*+h[n+36>>2]+l*+h[n+40>>2]+a*+h[n+44>>2];h[t+44>>2]=+h[n+4>>2]*c+ +h[n+8>>2]*l+ +h[n+12>>2]*a;h[t+48>>2]=o;h[t+52>>2]=s;h[t+56>>2]=0.0}r[t+60>>2]=r[e+24>>2];r[t+60+4>>2]=r[e+24+4>>2];r[t+60+8>>2]=r[e+24+8>>2];r[t+60+12>>2]=r[e+24+12>>2];c=+h[e+40>>2];return+c}function xy(t){t=t|0;var e=0,i=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0,p=0,f=0;f=_;_=_+16|0;j_(16195);c=r[t+204>>2]|0;Vk[r[(r[c>>2]|0)+8>>2]&127](c,t,r[t+24>>2]|0);c=r[t+308>>2]|0;if((c|0)>0){l=r[t+316>>2]|0;u=0;do{i=r[l+(u<<2)>>2]|0;e=r[i+740>>2]|0;i=r[i+744>>2]|0;if((e|0?i|0?(r[e+204>>2]&3|0)==0:0:0)?(r[i+204>>2]&3|0)==0:0){o=r[e+208>>2]|0;e=r[i+208>>2]|0;a=r[(r[t+204>>2]|0)+16>>2]|0;i=r[a+(o<<3)>>2]|0;if((i|0)!=(o|0)){s=a+(o<<3)|0;do{o=a+(i<<3)|0;r[s>>2]=r[o>>2];o=r[o>>2]|0;s=a+(o<<3)|0;i=r[s>>2]|0}while((o|0)!=(i|0))}i=r[a+(e<<3)>>2]|0;if((i|0)!=(e|0)){s=a+(e<<3)|0;do{e=a+(i<<3)|0;r[s>>2]=r[e>>2];e=r[e>>2]|0;s=a+(e<<3)|0;i=r[s>>2]|0}while((e|0)!=(i|0))}if((o|0)!=(e|0)){r[a+(o<<3)>>2]=e;s=a+(e<<3)+4|0;r[s>>2]=(r[s>>2]|0)+(r[a+(o<<3)+4>>2]|0)}}u=u+1|0}while((u|0)!=(c|0))}c=r[t+212>>2]|0;if((c|0)>0){l=r[t+220>>2]|0;u=0;do{e=r[l+(u<<2)>>2]|0;if((n[e+20>>0]|0?(d=r[e+28>>2]|0,(r[d+204>>2]&3|0)==0):0)?(p=r[e+32>>2]|0,(r[p+204>>2]&3|0)==0):0){s=r[d+208>>2]|0;e=r[p+208>>2]|0;a=r[(r[t+204>>2]|0)+16>>2]|0;i=r[a+(s<<3)>>2]|0;if((i|0)==(s|0))o=s;else{s=a+(s<<3)|0;do{o=a+(i<<3)|0;r[s>>2]=r[o>>2];o=r[o>>2]|0;s=a+(o<<3)|0;i=r[s>>2]|0}while((o|0)!=(i|0))}i=r[a+(e<<3)>>2]|0;if((i|0)!=(e|0)){s=a+(e<<3)|0;do{e=a+(i<<3)|0;r[s>>2]=r[e>>2];e=r[e>>2]|0;s=a+(e<<3)|0;i=r[s>>2]|0}while((e|0)!=(i|0))}if((o|0)!=(e|0)){r[a+(o<<3)>>2]=e;s=a+(e<<3)+4|0;r[s>>2]=(r[s>>2]|0)+(r[a+(o<<3)+4>>2]|0)}}u=u+1|0}while((u|0)!=(c|0))}e=r[t+204>>2]|0;lk[r[(r[e>>2]|0)+12>>2]&127](e,t);e=r[2006]|0;t=(r[e+16>>2]|0)+-1|0;r[e+16>>2]=t;if(t|0){_=f;return}do{if(r[e+4>>2]|0){de(f|0,0)|0;t=r[5649]|0;h[e+8>>2]=+h[e+8>>2]+ +(((r[f+4>>2]|0)-(r[t+4>>2]|0)+(((r[f>>2]|0)-(r[t>>2]|0)|0)*1e6|0)-(r[e+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[e+16>>2]|0)){e=r[2006]|0;break}else{_=f;return}}}while(0);r[2006]=r[e+20>>2];_=f;return}function wy(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0,l=0,c=0;c=_;_=_+16|0;j_(16222);l=r[t+212>>2]|0;a=r[t+180>>2]|0;if((a|0)<(l|0)){if((r[t+184>>2]|0)<(l|0)){if(!l){i=0;s=a}else{r[5637]=(r[5637]|0)+1;i=Zl((l<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}s=r[t+180>>2]|0}if((s|0)>0){o=0;do{r[i+(o<<2)>>2]=r[(r[t+188>>2]|0)+(o<<2)>>2];o=o+1|0}while((o|0)!=(s|0))}s=r[t+188>>2]|0;if(s|0){if(n[t+192>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[t+188>>2]=0}n[t+192>>0]=1;r[t+188>>2]=i;r[t+184>>2]=l;s=t+188|0}else s=t+188|0;i=a;do{r[(r[s>>2]|0)+(i<<2)>>2]=0;i=i+1|0}while((i|0)!=(l|0))}else s=t+188|0;r[t+180>>2]=l;i=0;while(1){if((i|0)>=(ck[r[(r[t>>2]|0)+104>>2]&127](t)|0))break;r[(r[s>>2]|0)+(i<<2)>>2]=r[(r[t+220>>2]|0)+(i<<2)>>2];i=i+1|0}i=r[t+180>>2]|0;if((i|0)>1)Cy(t+176|0,0,i+-1|0);if(!(ck[r[(r[t>>2]|0)+104>>2]&127](t)|0))i=0;else i=r[s>>2]|0;o=r[t+196>>2]|0;a=r[t+180>>2]|0;l=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;r[o+4>>2]=e;r[o+12>>2]=i;r[o+16>>2]=a;r[o+20>>2]=l;i=r[o+32>>2]|0;if((i|0)<0){if((r[o+36>>2]|0)<0){s=r[o+40>>2]|0;if(s|0){if(n[o+44>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[o+40>>2]=0}n[o+44>>0]=1;r[o+40>>2]=0;r[o+36>>2]=0}do{r[(r[o+40>>2]|0)+(i<<2)>>2]=0;i=i+1|0}while((i|0)!=0)}r[o+32>>2]=0;i=r[o+52>>2]|0;if((i|0)<0){if((r[o+56>>2]|0)<0){s=r[o+60>>2]|0;if(s|0){if(n[o+64>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[o+60>>2]=0}n[o+64>>0]=1;r[o+60>>2]=0;r[o+56>>2]=0}do{r[(r[o+60>>2]|0)+(i<<2)>>2]=0;i=i+1|0}while((i|0)!=0)}r[o+52>>2]=0;i=r[o+72>>2]|0;if((i|0)<0){if((r[o+76>>2]|0)<0){s=r[o+80>>2]|0;if(s|0){if(n[o+84>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[o+80>>2]=0}n[o+84>>0]=1;r[o+80>>2]=0;r[o+76>>2]=0}do{r[(r[o+80>>2]|0)+(i<<2)>>2]=0;i=i+1|0}while((i|0)!=0)}r[o+72>>2]=0;a=r[t+200>>2]|0;o=r[(r[a>>2]|0)+8>>2]|0;l=r[t+8>>2]|0;i=r[t+24>>2]|0;i=ck[r[(r[i>>2]|0)+36>>2]&127](i)|0;Vk[o&127](a,l,i);jR(r[t+204>>2]|0,r[t+24>>2]|0,t,r[t+196>>2]|0);Ty(r[t+196>>2]|0);i=r[t+200>>2]|0;Vk[r[(r[i>>2]|0)+16>>2]&127](i,e,r[t+72>>2]|0);i=r[2006]|0;t=(r[i+16>>2]|0)+-1|0;r[i+16>>2]=t;if(t|0){_=c;return}do{if(r[i+4>>2]|0){de(c|0,0)|0;t=r[5649]|0;h[i+8>>2]=+h[i+8>>2]+ +(((r[c+4>>2]|0)-(r[t+4>>2]|0)+(((r[c>>2]|0)-(r[t>>2]|0)|0)*1e6|0)-(r[i+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[i+16>>2]|0)){i=r[2006]|0;break}else{_=c;return}}}while(0);r[2006]=r[i+20>>2];_=c;return}function Cy(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0,a=0,l=0,h=0,c=0,_=0;while(1){c=r[t+12>>2]|0;_=r[c+(((e+i|0)/2|0)<<2)>>2]|0;n=e;s=i;while(1){h=r[(r[_+28>>2]|0)+208>>2]|0;if((h|0)>-1)while(1){a=r[c+(n<<2)>>2]|0;o=r[(r[a+28>>2]|0)+208>>2]|0;if((o|0)<=-1)o=r[(r[a+32>>2]|0)+208>>2]|0;if((o|0)<(h|0))n=n+1|0;else break}else{l=r[(r[_+32>>2]|0)+208>>2]|0;while(1){a=r[c+(n<<2)>>2]|0;o=r[(r[a+28>>2]|0)+208>>2]|0;if((o|0)<=-1)o=r[(r[a+32>>2]|0)+208>>2]|0;if((o|0)<(l|0))n=n+1|0;else break}}if((h|0)>-1)while(1){a=r[c+(s<<2)>>2]|0;o=r[(r[a+28>>2]|0)+208>>2]|0;if((o|0)<=-1)o=r[(r[a+32>>2]|0)+208>>2]|0;if((h|0)<(o|0))s=s+-1|0;else break}else{l=r[(r[_+32>>2]|0)+208>>2]|0;while(1){a=r[c+(s<<2)>>2]|0;o=r[(r[a+28>>2]|0)+208>>2]|0;if((o|0)<=-1)o=r[(r[a+32>>2]|0)+208>>2]|0;if((l|0)<(o|0))s=s+-1|0;else break}}if((n|0)<=(s|0)){l=c+(n<<2)|0;h=r[l>>2]|0;r[l>>2]=r[c+(s<<2)>>2];r[(r[t+12>>2]|0)+(s<<2)>>2]=h;n=n+1|0;s=s+-1|0}if((n|0)>(s|0))break;c=r[t+12>>2]|0}if((s|0)>(e|0))Cy(t,e,s);if((n|0)<(i|0))e=n;else break}return}function Ty(t){t=t|0;var e=0,i=0,s=0,o=0,a=0,l=0,h=0;e=r[t+32>>2]|0;if(!e)s=0;else s=r[t+40>>2]|0;l=r[t+52>>2]|0;if(!l)o=0;else o=r[t+60>>2]|0;i=r[t+72>>2]|0;if(!i)a=0;else a=r[t+80>>2]|0;h=r[t+8>>2]|0;+Pk[r[(r[h>>2]|0)+12>>2]&3](h,s,e,o,l,a,i,r[t+4>>2]|0,r[t+20>>2]|0,r[t+24>>2]|0);e=r[t+32>>2]|0;if((e|0)<0){if((r[t+36>>2]|0)<0){i=r[t+40>>2]|0;if(i|0){if(n[t+44>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[t+40>>2]=0}n[t+44>>0]=1;r[t+40>>2]=0;r[t+36>>2]=0}do{r[(r[t+40>>2]|0)+(e<<2)>>2]=0;e=e+1|0}while((e|0)!=0)}r[t+32>>2]=0;e=r[t+52>>2]|0;if((e|0)<0){if((r[t+56>>2]|0)<0){i=r[t+60>>2]|0;if(i|0){if(n[t+64>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[t+60>>2]=0}n[t+64>>0]=1;r[t+60>>2]=0;r[t+56>>2]=0}do{r[(r[t+60>>2]|0)+(e<<2)>>2]=0;e=e+1|0}while((e|0)!=0)}r[t+52>>2]=0;e=r[t+72>>2]|0;if((e|0)>=0){r[t+72>>2]=0;return}if((r[t+76>>2]|0)<0){i=r[t+80>>2]|0;if(i|0){if(n[t+84>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[t+80>>2]=0}n[t+84>>0]=1;r[t+80>>2]=0;r[t+76>>2]=0}do{r[(r[t+80>>2]|0)+(e<<2)>>2]=0;e=e+1|0}while((e|0)!=0);r[t+72>>2]=0;return}function Ay(t,e){t=t|0;e=+e;var i=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0.0,p=0.0,f=0.0,m=0.0;u=_;_=_+16|0;j_(15930);i=r[t+232>>2]|0;if((i|0)>0){c=(n[23328]|0)==0;l=0;do{a=r[(r[t+240>>2]|0)+(l<<2)>>2]|0;t:do{if(a){s=r[a+216>>2]|0;e:do{switch(s|0){case 4:case 2:{if((s|0)==4)break t;break}default:{m=+h[a+336>>2];f=+h[a+340>>2];p=+h[a+344>>2];d=+h[a+496>>2];if(m*m+f*f+p*p<d*d?(d=+h[a+352>>2],p=+h[a+356>>2],f=+h[a+360>>2],m=+h[a+500>>2],d*d+p*p+f*f<m*m):0){h[a+220>>2]=+h[a+220>>2]+e;break e}h[a+220>>2]=0.0;if((s&-2|0)!=4){r[a+216>>2]=0;s=0}}}}while(0);o=s&-2;do{if(c){if((o|0)!=2?!(+h[a+220>>2]>2.0):0)break;if(r[a+204>>2]&3|0){if((o|0)==4)break t;r[a+216>>2]=2;break t}if((s|0)==1){if((o|0)==4)break t;r[a+216>>2]=3;break t}else{if((s|0)!=2)break t;i=(r[a+284>>2]|0)+2|0;r[a+352>>2]=0;r[a+352+4>>2]=0;r[a+352+8>>2]=0;r[a+352+12>>2]=0;r[a+284>>2]=i;r[a+336>>2]=0;r[a+336+4>>2]=0;r[a+336+8>>2]=0;r[a+336+12>>2]=0;i=r[t+232>>2]|0;break t}}}while(0);if((o|0)!=4)r[a+216>>2]=1}}while(0);l=l+1|0}while((l|0)<(i|0))}i=r[2006]|0;t=(r[i+16>>2]|0)+-1|0;r[i+16>>2]=t;if(t|0){_=u;return}do{if(r[i+4>>2]|0){de(u|0,0)|0;t=r[5649]|0;h[i+8>>2]=+h[i+8>>2]+ +(((r[u+4>>2]|0)-(r[t+4>>2]|0)+(((r[u>>2]|0)-(r[t>>2]|0)|0)*1e6|0)-(r[i+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[i+16>>2]|0)){i=r[2006]|0;break}else{_=u;return}}}while(0);r[2006]=r[i+20>>2];_=u;return}function Ey(t,e){t=t|0;e=+e;var i=0,o=0,a=0,l=0,c=0.0,u=0.0,d=0.0,p=0.0,f=0,m=0,g=0,b=0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0,E=0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0;E=_;_=_+464|0;j_(15952);i=r[t+84>>2]|0;if(i|0)rk[i&31](t,e);rk[r[(r[t>>2]|0)+140>>2]&31](t,e);h[t+28>>2]=e;r[t+32>>2]=0;r[t+48>>2]=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;j_(15981);j_(16006);i=r[t+316>>2]|0;if((r[t+308>>2]|0)>0){o=0;do{b=r[t+24>>2]|0;lk[r[(r[b>>2]|0)+16>>2]&127](b,r[i+(o<<2)>>2]|0);o=o+1|0;i=r[t+316>>2]|0}while((o|0)<(r[t+308>>2]|0))}if(i|0){if(n[t+320>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[t+316>>2]=0}n[t+320>>0]=1;r[t+316>>2]=0;r[t+308>>2]=0;r[t+312>>2]=0;i=r[2006]|0;b=(r[i+16>>2]|0)+-1|0;r[i+16>>2]=b;do{if(!b){if(r[i+4>>2]|0){de(E+368|0,0)|0;b=r[5649]|0;h[i+8>>2]=+h[i+8>>2]+ +(((r[E+368+4>>2]|0)-(r[b+4>>2]|0)+(((r[E+368>>2]|0)-(r[b>>2]|0)|0)*1e6|0)-(r[i+12>>2]|0)|0)>>>0)/1.0e3;if(r[i+16>>2]|0)break;i=r[2006]|0}r[2006]=r[i+20>>2]}}while(0);t:do{if((r[t+232>>2]|0)>0){m=E+304+48|0;g=E+368+44|0;b=0;while(1){l=r[(r[t+240>>2]|0)+(b<<2)>>2]|0;h[l+248>>2]=1.0;e:do{switch(r[l+216>>2]|0){case 2:case 5:break;default:if(((r[l+204>>2]&3|0)==0?(Vv(l+4|0,+h[l+336>>2],+h[l+340>>2],+h[l+344>>2],l+352|0,e,E+304|0),y=+h[m>>2],v=y-+h[l+52>>2],S=+h[E+304+52>>2],x=S-+h[l+56>>2],w=+h[E+304+56>>2],C=w-+h[l+60>>2],n[t+44>>0]|0):0)?(p=+h[l+256>>2],p*p!=0.0?p*p<v*v+x*x+C*C:0):0){j_(16043);if((r[(r[l+192>>2]|0)+4>>2]|0)<20?(r[5475]=(r[5475]|0)+1,a=r[t+68>>2]|0,a=ck[r[(r[a>>2]|0)+36>>2]&127](a)|0,f=r[t+24>>2]|0,h[E+368+4>>2]=1.0,s[E+368+8>>1]=1,s[E+368+10>>1]=-1,r[E+368>>2]=7848,r[E+368+12>>2]=r[l+52>>2],r[E+368+12+4>>2]=r[l+52+4>>2],r[E+368+12+8>>2]=r[l+52+8>>2],r[E+368+12+12>>2]=r[l+52+12>>2],r[E+368+28>>2]=r[m>>2],r[E+368+28+4>>2]=r[m+4>>2],r[E+368+28+8>>2]=r[m+8>>2],r[E+368+28+12>>2]=r[m+12>>2],r[E+368+76>>2]=0,r[E+368>>2]=7872,r[E+368+80>>2]=l,r[E+368+88>>2]=a,r[E+368+92>>2]=f,f=r[l+252>>2]|0,r[E+248+8>>2]=0,r[E+248+12>>2]=-1,r[E+248+16>>2]=1065353216,r[E+248+20>>2]=1065353216,r[E+248+24>>2]=1065353216,h[E+248+28>>2]=0.0,r[E+248>>2]=6380,r[E+248+4>>2]=8,r[E+248+32>>2]=f,r[E+248+48>>2]=f,r[E+368+84>>2]=r[t+56>>2],f=r[(r[l+188>>2]|0)+4>>2]|0,s[E+368+8>>1]=f,s[E+368+10>>1]=f>>>16,r[E+184+48>>2]=r[m>>2],r[E+184+48+4>>2]=r[m+4>>2],r[E+184+48+8>>2]=r[m+8>>2],r[E+184+48+12>>2]=r[m+12>>2],r[E+184>>2]=r[l+4>>2],r[E+184+4>>2]=r[l+4+4>>2],r[E+184+8>>2]=r[l+4+8>>2],r[E+184+12>>2]=r[l+4+12>>2],r[E+184+16>>2]=r[l+20>>2],r[E+184+16+4>>2]=r[l+20+4>>2],r[E+184+16+8>>2]=r[l+20+8>>2],r[E+184+16+12>>2]=r[l+20+12>>2],r[E+184+32>>2]=r[l+36>>2],r[E+184+32+4>>2]=r[l+36+4>>2],r[E+184+32+8>>2]=r[l+36+8>>2],r[E+184+32+12>>2]=r[l+36+12>>2],Yx(t,E+248|0,l+4|0,E+184|0,E+368|0,0.0),T=+h[E+368+4>>2],T<1.0):0){c=T*(y-+h[l+52>>2]);u=T*(S-+h[l+56>>2]);d=T*(w-+h[l+60>>2]);p=-(u*+h[E+368+48>>2])-c*+h[g>>2]-d*+h[E+368+52>>2];f=r[t+24>>2]|0;f=yk[r[(r[f>>2]|0)+12>>2]&63](f,l,r[E+368+76>>2]|0)|0;i=r[t+308>>2]|0;if((i|0)==(r[t+312>>2]|0)?(A=i|0?i<<1:1,(i|0)<(A|0)):0){if(!A)a=0;else{r[5637]=(r[5637]|0)+1;i=Zl((A<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}a=i;i=r[t+308>>2]|0}if((i|0)>0){o=0;do{r[a+(o<<2)>>2]=r[(r[t+316>>2]|0)+(o<<2)>>2];o=o+1|0}while((o|0)!=(i|0))}o=r[t+316>>2]|0;if(o){if(n[t+320>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0);i=r[t+308>>2]|0}r[t+316>>2]=0}n[t+320>>0]=1;r[t+316>>2]=a;r[t+312>>2]=A}r[(r[t+316>>2]|0)+(i<<2)>>2]=f;r[t+308>>2]=i+1;c=c+ +h[l+52>>2];u=u+ +h[l+56>>2];d=d+ +h[l+60>>2];a=r[E+368+76>>2]|0;U=+h[a+4>>2];N=+h[a+20>>2];B=+h[a+36>>2];F=+h[a+8>>2];O=+h[a+24>>2];k=+h[a+40>>2];D=+h[a+12>>2];P=+h[a+28>>2];R=+h[a+44>>2];L=-+h[a+52>>2];I=-+h[a+56>>2];M=-+h[a+60>>2];r[E>>2]=0;r[E+4>>2]=0;r[E+8>>2]=0;r[E+12>>2]=0;h[E+16>>2]=c*U+u*N+d*B+(U*L+N*I+B*M);h[E+20>>2]=c*F+u*O+d*k+(F*L+O*I+k*M);h[E+24>>2]=c*D+u*P+d*R+(D*L+P*I+R*M);h[E+28>>2]=0.0;r[E+64>>2]=r[g>>2];r[E+64+4>>2]=r[g+4>>2];r[E+64+8>>2]=r[g+8>>2];r[E+64+12>>2]=r[g+12>>2];h[E+80>>2]=p;h[E+84>>2]=0.0;h[E+88>>2]=0.0;h[E+92>>2]=0.0;r[E+112>>2]=0;n[E+116>>0]=0;r[E+120>>2]=0;r[E+120+4>>2]=0;r[E+120+8>>2]=0;r[E+120+12>>2]=0;r[E+120+16>>2]=0;r[E+120+20>>2]=0;r[E+120+24>>2]=0;r[E+120+28>>2]=0;a=_S(f,E)|0;h[f+4+(a*184|0)+92>>2]=0.0;p=+h[l+224>>2]*+h[(r[E+368+76>>2]|0)+224>>2];p=p<-10.0?-10.0:p;h[f+4+(a*184|0)+84>>2]=p>10.0?10.0:p;r[f+4+(a*184|0)+48>>2]=r[l+52>>2];r[f+4+(a*184|0)+48+4>>2]=r[l+52+4>>2];r[f+4+(a*184|0)+48+8>>2]=r[l+52+8>>2];r[f+4+(a*184|0)+48+12>>2]=r[l+52+12>>2];h[f+4+(a*184|0)+32>>2]=c;h[f+4+(a*184|0)+36>>2]=u;h[f+4+(a*184|0)+40>>2]=d;h[f+4+(a*184|0)+44>>2]=0.0}i=r[2006]|0;f=(r[i+16>>2]|0)+-1|0;r[i+16>>2]=f;if(!f){if(r[i+4>>2]|0){de(E+368|0,0)|0;f=r[5649]|0;h[i+8>>2]=+h[i+8>>2]+ +(((r[E+368+4>>2]|0)-(r[f+4>>2]|0)+(((r[E+368>>2]|0)-(r[f>>2]|0)|0)*1e6|0)-(r[i+12>>2]|0)|0)>>>0)/1.0e3;if(r[i+16>>2]|0)break e;i=r[2006]|0}r[2006]=r[i+20>>2]}}}}while(0);b=b+1|0;if((b|0)>=(r[t+232>>2]|0))break t}}}while(0);i=r[2006]|0;A=(r[i+16>>2]|0)+-1|0;r[i+16>>2]=A;do{if(!A){if(r[i+4>>2]|0){de(E+368|0,0)|0;A=r[5649]|0;h[i+8>>2]=+h[i+8>>2]+ +(((r[E+368+4>>2]|0)-(r[A+4>>2]|0)+(((r[E+368>>2]|0)-(r[A>>2]|0)|0)*1e6|0)-(r[i+12>>2]|0)|0)>>>0)/1.0e3;if(r[i+16>>2]|0)break;i=r[2006]|0}r[2006]=r[i+20>>2]}}while(0);ok[r[(r[t>>2]|0)+44>>2]&255](t);ok[r[(r[t>>2]|0)+148>>2]&255](t);h[t+104>>2]=e;lk[r[(r[t>>2]|0)+152>>2]&127](t,t+92|0);rk[r[(r[t>>2]|0)+144>>2]&31](t,e);j_(16070);if((r[t+280>>2]|0)>0){i=0;do{A=r[(r[t+288>>2]|0)+(i<<2)>>2]|0;Wk[r[(r[A>>2]|0)+8>>2]&7](A,t,e);i=i+1|0}while((i|0)<(r[t+280>>2]|0))}i=r[2006]|0;A=(r[i+16>>2]|0)+-1|0;r[i+16>>2]=A;do{if(!A){if(r[i+4>>2]|0){de(E+368|0,0)|0;A=r[5649]|0;h[i+8>>2]=+h[i+8>>2]+ +(((r[E+368+4>>2]|0)-(r[A+4>>2]|0)+(((r[E+368>>2]|0)-(r[A>>2]|0)|0)*1e6|0)-(r[i+12>>2]|0)|0)>>>0)/1.0e3;if(r[i+16>>2]|0)break;i=r[2006]|0}r[2006]=r[i+20>>2]}}while(0);rk[r[(r[t>>2]|0)+156>>2]&31](t,e);i=r[t+80>>2]|0;if(i|0)rk[i&31](t,e);i=r[2006]|0;t=(r[i+16>>2]|0)+-1|0;r[i+16>>2]=t;if(t|0){_=E;return}do{if(r[i+4>>2]|0){de(E+368|0,0)|0;t=r[5649]|0;h[i+8>>2]=+h[i+8>>2]+ +(((r[E+368+4>>2]|0)-(r[t+4>>2]|0)+(((r[E+368>>2]|0)-(r[t>>2]|0)|0)*1e6|0)-(r[i+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[i+16>>2]|0)){i=r[2006]|0;break}else{_=E;return}}}while(0);r[2006]=r[i+20>>2];_=E;return}function My(t,e){t=t|0;e=+e;var i=0,n=0,s=0,o=0,a=0.0,l=0.0,c=0.0;o=_;_=_+32|0;i=r[t+8>>2]|0;if((i|0)<=0){_=o;return}s=0;do{n=r[(r[t+16>>2]|0)+(s<<2)>>2]|0;if((!((n|0)==0?1:(r[n+236>>2]&2|0)==0)?(r[n+216>>2]|0)!=2:0)?!(e==0.0?1:(r[n+204>>2]&2|0)==0):0){i=r[n+504>>2]|0;if(!i)i=n+4|0;else{lk[r[(r[i>>2]|0)+8>>2]&127](i,n+4|0);i=n+4|0}l=1.0/e*(+h[n+56>>2]-+h[n+120>>2]);c=1.0/e*(+h[n+60>>2]-+h[n+124>>2]);h[n+336>>2]=1.0/e*(+h[n+52>>2]-+h[n+116>>2]);h[n+340>>2]=l;h[n+344>>2]=c;h[n+348>>2]=0.0;qx(n+68|0,i,o+8|0,o);c=+h[o>>2];l=1.0/e*(c*+h[o+8+4>>2]);a=1.0/e*(c*+h[o+8+8>>2]);h[n+352>>2]=1.0/e*(+h[o+8>>2]*c);h[n+356>>2]=l;h[n+360>>2]=a;h[n+364>>2]=0.0;r[n+132>>2]=r[n+336>>2];r[n+132+4>>2]=r[n+336+4>>2];r[n+132+8>>2]=r[n+336+8>>2];r[n+132+12>>2]=r[n+336+12>>2];r[n+148>>2]=r[n+352>>2];r[n+148+4>>2]=r[n+352+4>>2];r[n+148+8>>2]=r[n+352+8>>2];r[n+148+12>>2]=r[n+352+12>>2];r[n+68>>2]=r[i>>2];r[n+68+4>>2]=r[i+4>>2];r[n+68+8>>2]=r[i+8>>2];r[n+68+12>>2]=r[i+12>>2];r[n+84>>2]=r[n+20>>2];r[n+84+4>>2]=r[n+20+4>>2];r[n+84+8>>2]=r[n+20+8>>2];r[n+84+12>>2]=r[n+20+12>>2];r[n+100>>2]=r[n+36>>2];r[n+100+4>>2]=r[n+36+4>>2];r[n+100+8>>2]=r[n+36+8>>2];r[n+100+12>>2]=r[n+36+12>>2];r[n+116>>2]=r[n+52>>2];r[n+116+4>>2]=r[n+52+4>>2];r[n+116+8>>2]=r[n+52+8>>2];r[n+116+12>>2]=r[n+52+12>>2];i=r[t+8>>2]|0}s=s+1|0}while((s|0)<(i|0));_=o;return}function Ry(t,e){t=t|0;e=e|0;var i=0.0,s=0.0,o=0,a=0,l=0,c=0.0,u=0.0,p=0,f=0,m=0,g=0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0,R=0,I=0,P=0,L=0,D=0,k=0,O=0,F=0.0,B=0,N=0.0,U=0.0,V=0.0,z=0.0,W=0.0,G=0.0,j=0.0,Y=0.0,q=0.0,K=0.0,Z=0.0;B=_;_=_+384|0;M=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;M=(ck[r[(r[M>>2]|0)+56>>2]&127](M)|0)>>>11;O=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;O=(ck[r[(r[O>>2]|0)+56>>2]&127](O)|0)>>>12;F=+h[e+40>>2];if(F<=0.0){_=B;return}switch(r[e+4>>2]|0){case 3:{r[B+320>>2]=1065353216;r[B+320+4>>2]=0;r[B+320+4+4>>2]=0;r[B+320+4+8>>2]=0;r[B+320+4+12>>2]=0;r[B+320+20>>2]=1065353216;r[B+320+24>>2]=0;r[B+320+24+4>>2]=0;r[B+320+24+8>>2]=0;r[B+320+24+12>>2]=0;r[B+320+40>>2]=1065353216;O=B+320+44|0;r[O>>2]=0;r[O+4>>2]=0;r[O+8>>2]=0;r[O+12>>2]=0;r[O+16>>2]=0;E=+h[e+300>>2];A=+h[e+304>>2];T=+h[e+308>>2];O=r[e+28>>2]|0;C=E*+h[O+20>>2]+A*+h[O+24>>2]+T*+h[O+28>>2]+ +h[O+56>>2];w=E*+h[O+36>>2]+A*+h[O+40>>2]+T*+h[O+44>>2]+ +h[O+60>>2];h[B+320+48>>2]=E*+h[O+4>>2]+A*+h[O+8>>2]+T*+h[O+12>>2]+ +h[O+52>>2];h[B+320+52>>2]=C;h[B+320+56>>2]=w;h[B+320+60>>2]=0.0;O=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Wk[r[(r[O>>2]|0)+64>>2]&7](O,B+320|0,F);w=+h[e+316>>2];C=+h[e+320>>2];T=+h[e+324>>2];e=r[e+32>>2]|0;A=w*+h[e+20>>2]+C*+h[e+24>>2]+T*+h[e+28>>2]+ +h[e+56>>2];E=w*+h[e+36>>2]+C*+h[e+40>>2]+T*+h[e+44>>2]+ +h[e+60>>2];h[B+320+48>>2]=w*+h[e+4>>2]+C*+h[e+8>>2]+T*+h[e+12>>2]+ +h[e+52>>2];h[B+320+52>>2]=A;h[B+320+56>>2]=E;h[B+320+60>>2]=0.0;if(M&1|0){t=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Wk[r[(r[t>>2]|0)+64>>2]&7](t,B+320|0,F)}_=B;return}case 4:{k=r[e+28>>2]|0;N=+h[e+552>>2];j=+h[k+4>>2];i=+h[e+552+16>>2];G=+h[k+8>>2];s=+h[e+552+32>>2];W=+h[k+12>>2];c=+h[e+552+4>>2];u=+h[e+552+20>>2];b=+h[e+552+36>>2];y=+h[e+552+8>>2];S=+h[e+552+24>>2];w=+h[e+552+40>>2];z=+h[k+20>>2];V=+h[k+24>>2];U=+h[k+28>>2];v=+h[k+36>>2];x=+h[k+40>>2];C=+h[k+44>>2];q=+h[e+552+48>>2];Y=+h[e+552+52>>2];E=+h[e+552+56>>2];T=+h[k+52>>2]+(j*q+G*Y+W*E);A=z*q+V*Y+U*E+ +h[k+56>>2];E=v*q+x*Y+C*E+ +h[k+60>>2];h[B+320>>2]=N*j+i*G+s*W;h[B+320+4>>2]=j*c+G*u+W*b;h[B+320+8>>2]=j*y+G*S+W*w;h[B+320+12>>2]=0.0;h[B+320+16>>2]=N*z+i*V+s*U;h[B+320+20>>2]=c*z+u*V+b*U;h[B+320+24>>2]=y*z+S*V+w*U;h[B+320+28>>2]=0.0;h[B+320+32>>2]=N*v+i*x+s*C;h[B+320+36>>2]=c*v+u*x+b*C;h[B+320+40>>2]=y*v+S*x+w*C;h[B+320+44>>2]=0.0;h[B+320+48>>2]=T;h[B+320+52>>2]=A;h[B+320+56>>2]=E;h[B+320+60>>2]=0.0;if(!(M&1)){k=r[e+32>>2]|0;x=+h[e+616>>2];c=+h[k+4>>2];w=+h[e+616+16>>2];u=+h[k+8>>2];C=+h[e+616+32>>2];b=+h[k+12>>2];T=+h[e+616+4>>2];A=+h[e+616+20>>2];E=+h[e+616+36>>2];N=+h[e+616+8>>2];V=+h[e+616+24>>2];W=+h[e+616+40>>2];y=+h[k+20>>2];v=+h[k+24>>2];S=+h[k+28>>2];U=+h[k+36>>2];z=+h[k+40>>2];G=+h[k+44>>2];i=+h[e+616+48>>2];s=+h[e+616+52>>2];q=+h[e+616+56>>2];j=+h[k+52>>2]+(c*i+u*s+b*q);Y=y*i+v*s+S*q+ +h[k+56>>2];q=U*i+z*s+G*q+ +h[k+60>>2];h[B+320>>2]=x*c+w*u+C*b;h[B+320+4>>2]=c*T+u*A+b*E;h[B+320+8>>2]=c*N+u*V+b*W;h[B+320+12>>2]=0.0;h[B+320+16>>2]=x*y+w*v+C*S;h[B+320+20>>2]=T*y+A*v+E*S;h[B+320+24>>2]=N*y+V*v+W*S;h[B+320+28>>2]=0.0;h[B+320+32>>2]=x*U+w*z+C*G;h[B+320+36>>2]=T*U+A*z+E*G;h[B+320+40>>2]=N*U+V*z+W*G;h[B+320+44>>2]=0.0;h[B+320+48>>2]=j;h[B+320+52>>2]=Y;h[B+320+56>>2]=q;h[B+320+60>>2]=0.0}else{k=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Wk[r[(r[k>>2]|0)+64>>2]&7](k,B+320|0,F);k=r[e+32>>2]|0;x=+h[e+616>>2];c=+h[k+4>>2];w=+h[e+616+16>>2];u=+h[k+8>>2];C=+h[e+616+32>>2];b=+h[k+12>>2];T=+h[e+616+4>>2];A=+h[e+616+20>>2];E=+h[e+616+36>>2];N=+h[e+616+8>>2];V=+h[e+616+24>>2];W=+h[e+616+40>>2];y=+h[k+20>>2];v=+h[k+24>>2];S=+h[k+28>>2];U=+h[k+36>>2];z=+h[k+40>>2];G=+h[k+44>>2];i=+h[e+616+48>>2];s=+h[e+616+52>>2];q=+h[e+616+56>>2];j=+h[k+52>>2]+(c*i+u*s+b*q);Y=y*i+v*s+S*q+ +h[k+56>>2];q=U*i+z*s+G*q+ +h[k+60>>2];h[B+320>>2]=x*c+w*u+C*b;h[B+320+4>>2]=c*T+u*A+b*E;h[B+320+8>>2]=c*N+u*V+b*W;h[B+320+12>>2]=0.0;h[B+320+16>>2]=x*y+w*v+C*S;h[B+320+20>>2]=T*y+A*v+E*S;h[B+320+24>>2]=N*y+V*v+W*S;h[B+320+28>>2]=0.0;h[B+320+32>>2]=x*U+w*z+C*G;h[B+320+36>>2]=T*U+A*z+E*G;h[B+320+40>>2]=N*U+V*z+W*G;h[B+320+44>>2]=0.0;h[B+320+48>>2]=j;h[B+320+52>>2]=Y;h[B+320+56>>2]=q;h[B+320+60>>2]=0.0;k=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Wk[r[(r[k>>2]|0)+64>>2]&7](k,B+320|0,F)}c=+h[e+688>>2];u=+h[e+688+4>>2];i=+ql(c-u);if(!(i<-3.1415927410125732))if(i>3.1415927410125732)s=i+-6.2831854820251465;else s=i;else s=i+6.2831854820251465;i=+ql(c+u);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;if(!(s==i)?O&1|0:0){r[B+304>>2]=r[B+320+8>>2];r[B+304+4>>2]=r[B+320+24>>2];r[B+304+8>>2]=r[B+320+40>>2];h[B+304+12>>2]=0.0;r[B+272>>2]=r[B+320>>2];r[B+272+4>>2]=r[B+320+16>>2];r[B+272+8>>2]=r[B+320+32>>2];h[B+272+12>>2]=0.0;t=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;e=r[(r[t>>2]|0)+68>>2]|0;r[B+288>>2]=0;r[B+288+4>>2]=0;r[B+288+8>>2]=0;r[B+288+12>>2]=0;gk[e&0](t,B+320+48|0,B+304|0,B+272|0,F,F,u>0.0?s:0.0,u>0.0?i:6.2831854820251465,B+288|0,u>0.0,10.0)}_=B;return}case 5:{l=r[e+28>>2]|0;x=+h[e+300>>2];c=+h[l+4>>2];w=+h[e+300+16>>2];u=+h[l+8>>2];C=+h[e+300+32>>2];b=+h[l+12>>2];T=+h[e+300+4>>2];A=+h[e+300+20>>2];E=+h[e+300+36>>2];N=+h[e+300+8>>2];V=+h[e+300+24>>2];W=+h[e+300+40>>2];y=+h[l+20>>2];v=+h[l+24>>2];S=+h[l+28>>2];U=+h[l+36>>2];z=+h[l+40>>2];G=+h[l+44>>2];i=+h[e+300+48>>2];s=+h[e+300+52>>2];q=+h[e+300+56>>2];j=+h[l+52>>2]+(c*i+u*s+b*q);Y=y*i+v*s+S*q+ +h[l+56>>2];q=U*i+z*s+G*q+ +h[l+60>>2];h[B+320>>2]=x*c+w*u+C*b;l=B+320+4|0;h[l>>2]=c*T+u*A+b*E;p=B+320+8|0;h[p>>2]=c*N+u*V+b*W;h[B+320+12>>2]=0.0;f=B+320+16|0;h[f>>2]=x*y+w*v+C*S;m=B+320+20|0;h[m>>2]=T*y+A*v+E*S;g=B+320+24|0;h[g>>2]=N*y+V*v+W*S;h[B+320+28>>2]=0.0;R=B+320+32|0;h[R>>2]=x*U+w*z+C*G;I=B+320+36|0;h[I>>2]=T*U+A*z+E*G;P=B+320+40|0;h[P>>2]=N*U+V*z+W*G;h[B+320+44>>2]=0.0;L=B+320+48|0;h[L>>2]=j;D=B+320+52|0;h[D>>2]=Y;k=B+320+56|0;h[k>>2]=q;h[B+320+60>>2]=0.0;if(!(M&1)){M=r[e+32>>2]|0;x=+h[e+364>>2];c=+h[M+4>>2];w=+h[e+364+16>>2];u=+h[M+8>>2];C=+h[e+364+32>>2];b=+h[M+12>>2];T=+h[e+364+4>>2];A=+h[e+364+20>>2];E=+h[e+364+36>>2];N=+h[e+364+8>>2];V=+h[e+364+24>>2];W=+h[e+364+40>>2];y=+h[M+20>>2];v=+h[M+24>>2];S=+h[M+28>>2];U=+h[M+36>>2];z=+h[M+40>>2];G=+h[M+44>>2];i=+h[e+364+48>>2];s=+h[e+364+52>>2];q=+h[e+364+56>>2];j=+h[M+52>>2]+(c*i+u*s+b*q);Y=y*i+v*s+S*q+ +h[M+56>>2];q=U*i+z*s+G*q+ +h[M+60>>2];h[B+320>>2]=x*c+w*u+C*b;h[l>>2]=c*T+u*A+b*E;h[p>>2]=c*N+u*V+b*W;h[B+320+12>>2]=0.0;h[f>>2]=x*y+w*v+C*S;h[m>>2]=T*y+A*v+E*S;h[g>>2]=N*y+V*v+W*S;h[B+320+28>>2]=0.0;h[R>>2]=x*U+w*z+C*G;h[I>>2]=T*U+A*z+E*G;h[P>>2]=N*U+V*z+W*G;h[B+320+44>>2]=0.0;h[L>>2]=j;h[D>>2]=Y;h[k>>2]=q;h[B+320+60>>2]=0.0}else{M=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Wk[r[(r[M>>2]|0)+64>>2]&7](M,B+320|0,F);M=r[e+32>>2]|0;x=+h[e+364>>2];c=+h[M+4>>2];w=+h[e+364+16>>2];u=+h[M+8>>2];C=+h[e+364+32>>2];b=+h[M+12>>2];T=+h[e+364+4>>2];A=+h[e+364+20>>2];E=+h[e+364+36>>2];N=+h[e+364+8>>2];V=+h[e+364+24>>2];W=+h[e+364+40>>2];y=+h[M+20>>2];v=+h[M+24>>2];S=+h[M+28>>2];U=+h[M+36>>2];z=+h[M+40>>2];G=+h[M+44>>2];i=+h[e+364+48>>2];s=+h[e+364+52>>2];q=+h[e+364+56>>2];j=+h[M+52>>2]+(c*i+u*s+b*q);Y=y*i+v*s+S*q+ +h[M+56>>2];q=U*i+z*s+G*q+ +h[M+60>>2];h[B+320>>2]=x*c+w*u+C*b;h[l>>2]=c*T+u*A+b*E;h[p>>2]=c*N+u*V+b*W;h[B+320+12>>2]=0.0;h[f>>2]=x*y+w*v+C*S;h[m>>2]=T*y+A*v+E*S;h[g>>2]=N*y+V*v+W*S;h[B+320+28>>2]=0.0;h[R>>2]=x*U+w*z+C*G;h[I>>2]=T*U+A*z+E*G;h[P>>2]=N*U+V*z+W*G;h[B+320+44>>2]=0.0;h[L>>2]=j;h[D>>2]=Y;h[k>>2]=q;h[B+320+60>>2]=0.0;M=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Wk[r[(r[M>>2]|0)+64>>2]&7](M,B+320|0,F)}if(O&1|0){UE(B+304|0,e,6.0868353843688965,F);W=+h[B+304>>2];G=+h[B+304+4>>2];j=+h[B+304+8>>2];Y=W*+h[f>>2]+G*+h[m>>2]+j*+h[g>>2]+ +h[D>>2];q=W*+h[R>>2]+G*+h[I>>2]+j*+h[P>>2]+ +h[k>>2];h[B+304>>2]=W*+h[B+320>>2]+G*+h[l>>2]+j*+h[p>>2]+ +h[L>>2];h[B+304+4>>2]=Y;h[B+304+8>>2]=q;h[B+304+12>>2]=0.0;a=B+320+48|0;o=0;do{UE(B+272|0,e,+(o|0)*6.283185005187988*.03125,F);W=+h[B+272>>2];G=+h[B+272+4>>2];j=+h[B+272+8>>2];Y=W*+h[f>>2]+G*+h[m>>2]+j*+h[g>>2]+ +h[D>>2];q=W*+h[R>>2]+G*+h[I>>2]+j*+h[P>>2]+ +h[k>>2];h[B+272>>2]=W*+h[B+320>>2]+G*+h[l>>2]+j*+h[p>>2]+ +h[L>>2];h[B+272+4>>2]=Y;h[B+272+8>>2]=q;h[B+272+12>>2]=0.0;O=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;M=r[(r[O>>2]|0)+16>>2]|0;r[B+256>>2]=0;r[B+256+4>>2]=0;r[B+256+8>>2]=0;r[B+256+12>>2]=0;jk[M&127](O,B+304|0,B+272|0,B+256|0);if(!(o&3)){O=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;M=r[(r[O>>2]|0)+16>>2]|0;r[B+240>>2]=0;r[B+240+4>>2]=0;r[B+240+8>>2]=0;r[B+240+12>>2]=0;jk[M&127](O,a,B+272|0,B+240|0)}r[B+304>>2]=r[B+272>>2];r[B+304+4>>2]=r[B+272+4>>2];r[B+304+8>>2]=r[B+272+8>>2];r[B+304+12>>2]=r[B+272+12>>2];o=o+1|0}while((o|0)!=32);A=+h[e+452>>2];E=+h[e+512>>2];o=r[e+32>>2]|0;if(+h[o+368>>2]>0.0){W=+h[e+364>>2];G=+h[o+4>>2];j=+h[e+364+16>>2];Y=+h[o+8>>2];q=+h[e+364+32>>2];w=+h[o+12>>2];V=+h[e+364+4>>2];z=+h[e+364+20>>2];x=+h[e+364+36>>2];N=+h[e+364+8>>2];U=+h[e+364+24>>2];S=+h[e+364+40>>2];Z=+h[o+20>>2];K=+h[o+24>>2];v=+h[o+28>>2];y=+h[o+36>>2];b=+h[o+40>>2];u=+h[o+44>>2];c=+h[e+364+48>>2];s=+h[e+364+52>>2];i=+h[e+364+56>>2];C=y*c+b*s+u*i+ +h[o+60>>2];T=Z*c+K*s+v*i+ +h[o+56>>2];i=+h[o+52>>2]+(G*c+Y*s+w*i);s=N*y+U*b+S*u;c=V*y+z*b+x*u;u=W*y+j*b+q*u;b=N*Z+U*K+S*v;y=V*Z+z*K+x*v;v=W*Z+j*K+q*v;S=G*N+Y*U+w*S;x=G*V+Y*z+w*x;w=W*G+j*Y+q*w}else{O=r[e+28>>2]|0;j=+h[e+300>>2];Y=+h[O+4>>2];q=+h[e+300+16>>2];K=+h[O+8>>2];Z=+h[e+300+32>>2];w=+h[O+12>>2];W=+h[e+300+4>>2];G=+h[e+300+20>>2];x=+h[e+300+36>>2];V=+h[e+300+8>>2];z=+h[e+300+24>>2];S=+h[e+300+40>>2];N=+h[O+20>>2];U=+h[O+24>>2];v=+h[O+28>>2];y=+h[O+36>>2];b=+h[O+40>>2];u=+h[O+44>>2];c=+h[e+300+48>>2];s=+h[e+300+52>>2];i=+h[e+300+56>>2];C=y*c+b*s+u*i+ +h[O+60>>2];T=N*c+U*s+v*i+ +h[O+56>>2];i=+h[O+52>>2]+(Y*c+K*s+w*i);s=V*y+z*b+S*u;c=W*y+G*b+x*u;u=j*y+q*b+Z*u;b=V*N+z*U+S*v;y=W*N+G*U+x*v;v=j*N+q*U+Z*v;S=Y*V+K*z+w*S;x=Y*W+K*G+w*x;w=j*Y+q*K+Z*w}h[B+320>>2]=w;h[l>>2]=x;h[p>>2]=S;h[B+320+12>>2]=0.0;h[f>>2]=v;h[m>>2]=y;h[g>>2]=b;h[B+320+28>>2]=0.0;h[R>>2]=u;h[I>>2]=c;h[P>>2]=s;h[B+320+44>>2]=0.0;h[L>>2]=i;h[D>>2]=T;h[k>>2]=C;h[B+320+60>>2]=0.0;r[B+272>>2]=r[a>>2];r[B+272+4>>2]=r[a+4>>2];r[B+272+8>>2]=r[a+8>>2];r[B+272+12>>2]=r[a+12>>2];h[B+208>>2]=w;h[B+208+4>>2]=v;h[B+208+8>>2]=u;h[B+208+12>>2]=0.0;h[B+176>>2]=x;h[B+176+4>>2]=y;h[B+176+8>>2]=c;h[B+176+12>>2]=0.0;t=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;e=r[(r[t>>2]|0)+68>>2]|0;r[B+224>>2]=0;r[B+224+4>>2]=0;r[B+224+8>>2]=0;r[B+224+12>>2]=0;gk[e&0](t,B+272|0,B+208|0,B+176|0,F,F,-E-A,A-E,B+224|0,1,10.0)}_=B;return}case 6:case 9:{r[B+320>>2]=r[e+1064>>2];r[B+320+4>>2]=r[e+1064+4>>2];r[B+320+8>>2]=r[e+1064+8>>2];r[B+320+12>>2]=r[e+1064+12>>2];a=B+320+16|0;l=e+1064+16|0;r[a>>2]=r[l>>2];r[a+4>>2]=r[l+4>>2];r[a+8>>2]=r[l+8>>2];r[a+12>>2]=r[l+12>>2];p=B+320+32|0;f=e+1064+32|0;r[p>>2]=r[f>>2];r[p+4>>2]=r[f+4>>2];r[p+8>>2]=r[f+8>>2];r[p+12>>2]=r[f+12>>2];m=B+320+48|0;g=e+1064+48|0;r[m>>2]=r[g>>2];r[m+4>>2]=r[g+4>>2];r[m+8>>2]=r[g+8>>2];r[m+12>>2]=r[g+12>>2];if(!(M&1)){r[B+320>>2]=r[e+1128>>2];r[B+320+4>>2]=r[e+1128+4>>2];r[B+320+8>>2]=r[e+1128+8>>2];r[B+320+12>>2]=r[e+1128+12>>2];r[a>>2]=r[e+1128+16>>2];r[a+4>>2]=r[e+1128+16+4>>2];r[a+8>>2]=r[e+1128+16+8>>2];r[a+12>>2]=r[e+1128+16+12>>2];r[p>>2]=r[e+1128+32>>2];r[p+4>>2]=r[e+1128+32+4>>2];r[p+8>>2]=r[e+1128+32+8>>2];r[p+12>>2]=r[e+1128+32+12>>2];r[m>>2]=r[e+1128+48>>2];r[m+4>>2]=r[e+1128+48+4>>2];r[m+8>>2]=r[e+1128+48+8>>2];r[m+12>>2]=r[e+1128+48+12>>2]}else{k=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Wk[r[(r[k>>2]|0)+64>>2]&7](k,B+320|0,F);r[B+320>>2]=r[e+1128>>2];r[B+320+4>>2]=r[e+1128+4>>2];r[B+320+8>>2]=r[e+1128+8>>2];r[B+320+12>>2]=r[e+1128+12>>2];r[a>>2]=r[e+1128+16>>2];r[a+4>>2]=r[e+1128+16+4>>2];r[a+8>>2]=r[e+1128+16+8>>2];r[a+12>>2]=r[e+1128+16+12>>2];r[p>>2]=r[e+1128+32>>2];r[p+4>>2]=r[e+1128+32+4>>2];r[p+8>>2]=r[e+1128+32+8>>2];r[p+12>>2]=r[e+1128+32+12>>2];r[m>>2]=r[e+1128+48>>2];r[m+4>>2]=r[e+1128+48+4>>2];r[m+8>>2]=r[e+1128+48+8>>2];r[m+12>>2]=r[e+1128+48+12>>2];k=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Wk[r[(r[k>>2]|0)+64>>2]&7](k,B+320|0,F)}if(O&1|0){r[B+320>>2]=r[e+1064>>2];r[B+320+4>>2]=r[e+1064+4>>2];r[B+320+8>>2]=r[e+1064+8>>2];r[B+320+12>>2]=r[e+1064+12>>2];r[a>>2]=r[l>>2];r[a+4>>2]=r[l+4>>2];r[a+8>>2]=r[l+8>>2];r[a+12>>2]=r[l+12>>2];r[p>>2]=r[f>>2];r[p+4>>2]=r[f+4>>2];r[p+8>>2]=r[f+8>>2];r[p+12>>2]=r[f+12>>2];r[m>>2]=r[g>>2];r[m+4>>2]=r[g+4>>2];r[m+8>>2]=r[g+8>>2];r[m+12>>2]=r[g+12>>2];o=e+1128+48|0;r[B+304>>2]=r[B+320+8>>2];r[B+304+4>>2]=r[B+320+24>>2];r[B+304+8>>2]=r[B+320+40>>2];h[B+304+12>>2]=0.0;r[B+272>>2]=r[B+320>>2];r[B+272+4>>2]=r[B+320+16>>2];r[B+272+8>>2]=r[B+320+32>>2];h[B+272+12>>2]=0.0;j=+h[e+932>>2];i=+h[e+932+4>>2];K=+h[e+996>>2];q=+h[e+996+4>>2];D=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;k=r[(r[D>>2]|0)+72>>2]|0;r[B+192>>2]=0;r[B+192+4>>2]=0;r[B+192+8>>2]=0;r[B+192+12>>2]=0;Ok[k&0](D,o,B+304|0,B+272|0,F*.8999999761581421,j,i,K,q,B+192|0,10.0,1);D=r[B+320+4>>2]|0;k=r[B+320+20>>2]|0;O=r[B+320+36>>2]|0;r[B+272>>2]=D;r[B+272+4>>2]=k;r[B+272+8>>2]=O;h[B+272+12>>2]=0.0;q=+h[e+1196>>2];K=+h[e+1200>>2];i=+H(+q);q=+X(+q);j=+H(+K);K=+X(+K);Y=(r[d>>2]=D,+h[d>>2]);Z=(r[d>>2]=k,+h[d>>2]);s=(r[d>>2]=O,+h[d>>2]);h[B+208>>2]=i*j*Y+i*K*Z-q*s;h[B+208+4>>2]=j*Z-K*Y;h[B+208+8>>2]=q*j*Y+q*K*Z+i*s;r[B+320>>2]=r[e+1128>>2];r[B+320+4>>2]=r[e+1128+4>>2];r[B+320+8>>2]=r[e+1128+8>>2];r[B+320+12>>2]=r[e+1128+12>>2];r[a>>2]=r[e+1128+16>>2];r[a+4>>2]=r[e+1128+16+4>>2];r[a+8>>2]=r[e+1128+16+8>>2];r[a+12>>2]=r[e+1128+16+12>>2];r[p>>2]=r[e+1128+32>>2];r[p+4>>2]=r[e+1128+32+4>>2];r[p+8>>2]=r[e+1128+32+8>>2];r[p+12>>2]=r[e+1128+32+12>>2];r[m>>2]=r[o>>2];r[m+4>>2]=r[o+4>>2];r[m+8>>2]=r[o+8>>2];r[m+12>>2]=r[o+12>>2];s=-+h[B+320+16>>2];i=-+h[B+320+32>>2];h[B+176>>2]=-+h[B+320>>2];h[B+176+4>>2]=s;h[B+176+8>>2]=i;h[B+176+12>>2]=0.0;i=+h[e+868>>2];s=+h[e+868+4>>2];if(!(i>s)){if(i<s){O=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;k=r[(r[O>>2]|0)+68>>2]|0;r[B+144>>2]=0;r[B+144+4>>2]=0;r[B+144+8>>2]=0;r[B+144+12>>2]=0;gk[k&0](O,o,B+176|0,B+208|0,F,F,i,s,B+144|0,1,10.0)}}else{O=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;k=r[(r[O>>2]|0)+68>>2]|0;r[B+160>>2]=0;r[B+160+4>>2]=0;r[B+160+8>>2]=0;r[B+160+12>>2]=0;gk[k&0](O,o,B+176|0,B+208|0,F,F,-3.1415927410125732,3.1415927410125732,B+160|0,0,10.0)}r[B+320>>2]=r[e+1064>>2];r[B+320+4>>2]=r[e+1064+4>>2];r[B+320+8>>2]=r[e+1064+8>>2];r[B+320+12>>2]=r[e+1064+12>>2];r[a>>2]=r[l>>2];r[a+4>>2]=r[l+4>>2];r[a+8>>2]=r[l+8>>2];r[a+12>>2]=r[l+12>>2];r[p>>2]=r[f>>2];r[p+4>>2]=r[f+4>>2];r[p+8>>2]=r[f+8>>2];r[p+12>>2]=r[f+12>>2];r[m>>2]=r[g>>2];r[m+4>>2]=r[g+4>>2];r[m+8>>2]=r[g+8>>2];r[m+12>>2]=r[g+12>>2];r[B+96>>2]=r[e+680>>2];r[B+96+4>>2]=r[e+680+4>>2];r[B+96+8>>2]=r[e+680+8>>2];r[B+96+12>>2]=r[e+680+12>>2];r[B+64>>2]=r[e+680+16>>2];r[B+64+4>>2]=r[e+680+16+4>>2];r[B+64+8>>2]=r[e+680+16+8>>2];r[B+64+12>>2]=r[e+680+16+12>>2];t=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;e=r[(r[t>>2]|0)+80>>2]|0;r[B+128>>2]=0;r[B+128+4>>2]=0;r[B+128+8>>2]=0;r[B+128+12>>2]=0;sk[e&31](t,B+96|0,B+64|0,B+320|0,B+128|0)}_=B;return}case 12:{r[B+320>>2]=r[e+1236>>2];r[B+320+4>>2]=r[e+1236+4>>2];r[B+320+8>>2]=r[e+1236+8>>2];r[B+320+12>>2]=r[e+1236+12>>2];a=B+320+16|0;l=e+1236+16|0;r[a>>2]=r[l>>2];r[a+4>>2]=r[l+4>>2];r[a+8>>2]=r[l+8>>2];r[a+12>>2]=r[l+12>>2];p=B+320+32|0;f=e+1236+32|0;r[p>>2]=r[f>>2];r[p+4>>2]=r[f+4>>2];r[p+8>>2]=r[f+8>>2];r[p+12>>2]=r[f+12>>2];m=B+320+48|0;g=e+1236+48|0;r[m>>2]=r[g>>2];r[m+4>>2]=r[g+4>>2];r[m+8>>2]=r[g+8>>2];r[m+12>>2]=r[g+12>>2];if(!(M&1)){r[B+320>>2]=r[e+1300>>2];r[B+320+4>>2]=r[e+1300+4>>2];r[B+320+8>>2]=r[e+1300+8>>2];r[B+320+12>>2]=r[e+1300+12>>2];r[a>>2]=r[e+1300+16>>2];r[a+4>>2]=r[e+1300+16+4>>2];r[a+8>>2]=r[e+1300+16+8>>2];r[a+12>>2]=r[e+1300+16+12>>2];r[p>>2]=r[e+1300+32>>2];r[p+4>>2]=r[e+1300+32+4>>2];r[p+8>>2]=r[e+1300+32+8>>2];r[p+12>>2]=r[e+1300+32+12>>2];r[m>>2]=r[e+1300+48>>2];r[m+4>>2]=r[e+1300+48+4>>2];r[m+8>>2]=r[e+1300+48+8>>2];r[m+12>>2]=r[e+1300+48+12>>2]}else{k=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Wk[r[(r[k>>2]|0)+64>>2]&7](k,B+320|0,F);r[B+320>>2]=r[e+1300>>2];r[B+320+4>>2]=r[e+1300+4>>2];r[B+320+8>>2]=r[e+1300+8>>2];r[B+320+12>>2]=r[e+1300+12>>2];r[a>>2]=r[e+1300+16>>2];r[a+4>>2]=r[e+1300+16+4>>2];r[a+8>>2]=r[e+1300+16+8>>2];r[a+12>>2]=r[e+1300+16+12>>2];r[p>>2]=r[e+1300+32>>2];r[p+4>>2]=r[e+1300+32+4>>2];r[p+8>>2]=r[e+1300+32+8>>2];r[p+12>>2]=r[e+1300+32+12>>2];r[m>>2]=r[e+1300+48>>2];r[m+4>>2]=r[e+1300+48+4>>2];r[m+8>>2]=r[e+1300+48+8>>2];r[m+12>>2]=r[e+1300+48+12>>2];k=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Wk[r[(r[k>>2]|0)+64>>2]&7](k,B+320|0,F)}if(O&1|0){r[B+320>>2]=r[e+1236>>2];r[B+320+4>>2]=r[e+1236+4>>2];r[B+320+8>>2]=r[e+1236+8>>2];r[B+320+12>>2]=r[e+1236+12>>2];r[a>>2]=r[l>>2];r[a+4>>2]=r[l+4>>2];r[a+8>>2]=r[l+8>>2];r[a+12>>2]=r[l+12>>2];r[p>>2]=r[f>>2];r[p+4>>2]=r[f+4>>2];r[p+8>>2]=r[f+8>>2];r[p+12>>2]=r[f+12>>2];r[m>>2]=r[g>>2];r[m+4>>2]=r[g+4>>2];r[m+8>>2]=r[g+8>>2];r[m+12>>2]=r[g+12>>2];o=e+1300+48|0;r[B+304>>2]=r[B+320+8>>2];r[B+304+4>>2]=r[B+320+24>>2];r[B+304+8>>2]=r[B+320+40>>2];h[B+304+12>>2]=0.0;r[B+272>>2]=r[B+320>>2];r[B+272+4>>2]=r[B+320+16>>2];r[B+272+8>>2]=r[B+320+32>>2];h[B+272+12>>2]=0.0;j=+h[e+1056>>2];i=+h[e+1060>>2];K=+h[e+1144>>2];q=+h[e+1144+4>>2];D=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;k=r[(r[D>>2]|0)+72>>2]|0;r[B+112>>2]=0;r[B+112+4>>2]=0;r[B+112+8>>2]=0;r[B+112+12>>2]=0;Ok[k&0](D,o,B+304|0,B+272|0,F*.8999999761581421,j,i,K,q,B+112|0,10.0,1);D=r[B+320+4>>2]|0;k=r[B+320+20>>2]|0;O=r[B+320+36>>2]|0;r[B+272>>2]=D;r[B+272+4>>2]=k;r[B+272+8>>2]=O;h[B+272+12>>2]=0.0;q=+h[e+1368>>2];K=+h[e+1372>>2];i=+H(+q);q=+X(+q);j=+H(+K);K=+X(+K);Y=(r[d>>2]=D,+h[d>>2]);Z=(r[d>>2]=k,+h[d>>2]);s=(r[d>>2]=O,+h[d>>2]);h[B+208>>2]=i*j*Y+i*K*Z-q*s;h[B+208+4>>2]=j*Z-K*Y;h[B+208+8>>2]=q*j*Y+q*K*Z+i*s;r[B+320>>2]=r[e+1300>>2];r[B+320+4>>2]=r[e+1300+4>>2];r[B+320+8>>2]=r[e+1300+8>>2];r[B+320+12>>2]=r[e+1300+12>>2];r[a>>2]=r[e+1300+16>>2];r[a+4>>2]=r[e+1300+16+4>>2];r[a+8>>2]=r[e+1300+16+8>>2];r[a+12>>2]=r[e+1300+16+12>>2];r[p>>2]=r[e+1300+32>>2];r[p+4>>2]=r[e+1300+32+4>>2];r[p+8>>2]=r[e+1300+32+8>>2];r[p+12>>2]=r[e+1300+32+12>>2];r[m>>2]=r[o>>2];r[m+4>>2]=r[o+4>>2];r[m+8>>2]=r[o+8>>2];r[m+12>>2]=r[o+12>>2];s=-+h[B+320+16>>2];i=-+h[B+320+32>>2];h[B+176>>2]=-+h[B+320>>2];h[B+176+4>>2]=s;h[B+176+8>>2]=i;h[B+176+12>>2]=0.0;i=+h[e+968>>2];s=+h[e+968+4>>2];if(!(i>s)){if(i<s){O=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;k=r[(r[O>>2]|0)+68>>2]|0;r[B+48>>2]=0;r[B+48+4>>2]=0;r[B+48+8>>2]=0;r[B+48+12>>2]=0;gk[k&0](O,o,B+176|0,B+208|0,F,F,i,s,B+48|0,1,10.0)}}else{O=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;k=r[(r[O>>2]|0)+68>>2]|0;r[B+80>>2]=0;r[B+80+4>>2]=0;r[B+80+8>>2]=0;r[B+80+12>>2]=0;gk[k&0](O,o,B+176|0,B+208|0,F,F,-3.1415927410125732,3.1415927410125732,B+80|0,0,10.0)}r[B+320>>2]=r[e+1236>>2];r[B+320+4>>2]=r[e+1236+4>>2];r[B+320+8>>2]=r[e+1236+8>>2];r[B+320+12>>2]=r[e+1236+12>>2];r[a>>2]=r[l>>2];r[a+4>>2]=r[l+4>>2];r[a+8>>2]=r[l+8>>2];r[a+12>>2]=r[l+12>>2];r[p>>2]=r[f>>2];r[p+4>>2]=r[f+4>>2];r[p+8>>2]=r[f+8>>2];r[p+12>>2]=r[f+12>>2];r[m>>2]=r[g>>2];r[m+4>>2]=r[g+4>>2];r[m+8>>2]=r[g+8>>2];r[m+12>>2]=r[g+12>>2];r[B+96>>2]=r[e+680>>2];r[B+96+4>>2]=r[e+680+4>>2];r[B+96+8>>2]=r[e+680+8>>2];r[B+96+12>>2]=r[e+680+12>>2];r[B+64>>2]=r[e+680+16>>2];r[B+64+4>>2]=r[e+680+16+4>>2];r[B+64+8>>2]=r[e+680+16+8>>2];r[B+64+12>>2]=r[e+680+16+12>>2];t=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;e=r[(r[t>>2]|0)+80>>2]|0;r[B+32>>2]=0;r[B+32+4>>2]=0;r[B+32+8>>2]=0;r[B+32+12>>2]=0;sk[e&31](t,B+96|0,B+64|0,B+320|0,B+32|0)}_=B;return}case 7:{r[B+320>>2]=r[e+824>>2];r[B+320+4>>2]=r[e+824+4>>2];r[B+320+8>>2]=r[e+824+8>>2];r[B+320+12>>2]=r[e+824+12>>2];o=B+320+16|0;r[o>>2]=r[e+824+16>>2];r[o+4>>2]=r[e+824+16+4>>2];r[o+8>>2]=r[e+824+16+8>>2];r[o+12>>2]=r[e+824+16+12>>2];a=B+320+32|0;r[a>>2]=r[e+824+32>>2];r[a+4>>2]=r[e+824+32+4>>2];r[a+8>>2]=r[e+824+32+8>>2];r[a+12>>2]=r[e+824+32+12>>2];l=B+320+48|0;r[l>>2]=r[e+824+48>>2];r[l+4>>2]=r[e+824+48+4>>2];r[l+8>>2]=r[e+824+48+8>>2];r[l+12>>2]=r[e+824+48+12>>2];if(!(M&1)){r[B+320>>2]=r[e+888>>2];r[B+320+4>>2]=r[e+888+4>>2];r[B+320+8>>2]=r[e+888+8>>2];r[B+320+12>>2]=r[e+888+12>>2];r[o>>2]=r[e+888+16>>2];r[o+4>>2]=r[e+888+16+4>>2];r[o+8>>2]=r[e+888+16+8>>2];r[o+12>>2]=r[e+888+16+12>>2];r[a>>2]=r[e+888+32>>2];r[a+4>>2]=r[e+888+32+4>>2];r[a+8>>2]=r[e+888+32+8>>2];r[a+12>>2]=r[e+888+32+12>>2];r[l>>2]=r[e+888+48>>2];r[l+4>>2]=r[e+888+48+4>>2];r[l+8>>2]=r[e+888+48+8>>2];r[l+12>>2]=r[e+888+48+12>>2]}else{k=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Wk[r[(r[k>>2]|0)+64>>2]&7](k,B+320|0,F);r[B+320>>2]=r[e+888>>2];r[B+320+4>>2]=r[e+888+4>>2];r[B+320+8>>2]=r[e+888+8>>2];r[B+320+12>>2]=r[e+888+12>>2];r[o>>2]=r[e+888+16>>2];r[o+4>>2]=r[e+888+16+4>>2];r[o+8>>2]=r[e+888+16+8>>2];r[o+12>>2]=r[e+888+16+12>>2];r[a>>2]=r[e+888+32>>2];r[a+4>>2]=r[e+888+32+4>>2];r[a+8>>2]=r[e+888+32+8>>2];r[a+12>>2]=r[e+888+32+12>>2];r[l>>2]=r[e+888+48>>2];r[l+4>>2]=r[e+888+48+4>>2];r[l+8>>2]=r[e+888+48+8>>2];r[l+12>>2]=r[e+888+48+12>>2];k=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Wk[r[(r[k>>2]|0)+64>>2]&7](k,B+320|0,F)}if(O&1|0){R=n[e+180>>0]|0?e+824|0:e+888|0;I=r[R>>2]|0;D=r[R+4>>2]|0;P=r[R+16>>2]|0;k=r[R+20>>2]|0;L=r[R+32>>2]|0;O=r[R+36>>2]|0;A=+h[R+48>>2];V=+h[R+52>>2];j=+h[R+56>>2];K=+h[e+184>>2];U=(r[d>>2]=I,+h[d>>2]);N=(r[d>>2]=D,+h[d>>2])*0.0;E=+h[R+8>>2]*0.0;G=(r[d>>2]=P,+h[d>>2]);W=(r[d>>2]=k,+h[d>>2])*0.0;z=+h[R+24>>2]*0.0;Z=(r[d>>2]=L,+h[d>>2]);q=(r[d>>2]=O,+h[d>>2])*0.0;Y=+h[R+40>>2]*0.0;h[B+304>>2]=A+(E+(N+U*K));h[B+304+4>>2]=V+(z+(W+G*K));h[B+304+8>>2]=j+(Y+(q+Z*K));h[B+304+12>>2]=0.0;K=+h[e+188>>2];h[B+272>>2]=A+(E+(N+U*K));h[B+272+4>>2]=V+(z+(W+G*K));h[B+272+8>>2]=j+(Y+(q+Z*K));h[B+272+12>>2]=0.0;R=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;M=r[(r[R>>2]|0)+16>>2]|0;r[B+16>>2]=0;r[B+16+4>>2]=0;r[B+16+8>>2]=0;r[B+16+12>>2]=0;jk[M&127](R,B+304|0,B+272|0,B+16|0);r[B+208>>2]=I;r[B+208+4>>2]=P;r[B+208+8>>2]=L;h[B+208+12>>2]=0.0;r[B+176>>2]=D;r[B+176+4>>2]=k;r[B+176+8>>2]=O;h[B+176+12>>2]=0.0;K=+h[e+192>>2];Z=+h[e+196>>2];t=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;O=r[(r[t>>2]|0)+68>>2]|0;r[B>>2]=0;r[B+4>>2]=0;r[B+8>>2]=0;r[B+12>>2]=0;gk[O&0](t,e+888+48|0,B+208|0,B+176|0,F,F,K,Z,B,1,10.0)}_=B;return}default:{_=B;return}}}function Iy(t){t=t|0;var e=0,i=0,n=0,s=0.0,o=0.0;n=r[t+232>>2]|0;if((n|0)<=0)return;t=r[t+240>>2]|0;i=0;do{e=r[t+(i<<2)>>2]|0;switch(r[e+216>>2]|0){case 2:case 5:break;default:if(!(r[e+204>>2]&3)){o=+h[e+392>>2]*+h[e+376>>2];s=+h[e+396>>2]*+h[e+380>>2];h[e+436>>2]=+h[e+388>>2]*+h[e+372>>2]+ +h[e+436>>2];h[e+440>>2]=o+ +h[e+440>>2];h[e+444>>2]=s+ +h[e+444>>2]}}i=i+1|0}while((i|0)!=(n|0));return}function Py(t,e){t=t|0;e=e|0;return}function Ly(t,e){t=t|0;e=+e;var i=0,n=0,s=0;n=_;_=_+16|0;j_(16070);if((r[t+280>>2]|0)>0){i=0;do{s=r[(r[t+288>>2]|0)+(i<<2)>>2]|0;Wk[r[(r[s>>2]|0)+8>>2]&7](s,t,e);i=i+1|0}while((i|0)<(r[t+280>>2]|0))}i=r[2006]|0;s=(r[i+16>>2]|0)+-1|0;r[i+16>>2]=s;if(s|0){_=n;return}do{if(r[i+4>>2]|0){de(n|0,0)|0;s=r[5649]|0;h[i+8>>2]=+h[i+8>>2]+ +(((r[n+4>>2]|0)-(r[s+4>>2]|0)+(((r[n>>2]|0)-(r[s>>2]|0)|0)*1e6|0)-(r[i+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[i+16>>2]|0)){i=r[2006]|0;break}else{_=n;return}}}while(0);r[2006]=r[i+20>>2];_=n;return}function Dy(t){t=t|0;var e=0;r[t>>2]=7896;e=r[t+80>>2]|0;if(e|0){if(n[t+84>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+80>>2]=0}n[t+84>>0]=1;r[t+80>>2]=0;r[t+72>>2]=0;r[t+76>>2]=0;e=r[t+60>>2]|0;if(e|0){if(n[t+64>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+60>>2]=0}n[t+64>>0]=1;r[t+60>>2]=0;r[t+52>>2]=0;r[t+56>>2]=0;e=r[t+40>>2]|0;if(!e){n[t+44>>0]=1;r[t+40>>2]=0;r[t+32>>2]=0;t=t+36|0;r[t>>2]=0;return}if(n[t+44>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+40>>2]=0;n[t+44>>0]=1;r[t+40>>2]=0;r[t+32>>2]=0;t=t+36|0;r[t>>2]=0;return}function ky(t){t=t|0;Dy(t);Ql(t);return}function Oy(t,e,i,s,o,a){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;var l=0,h=0,c=0,_=0,u=0,d=0,p=0;if((a|0)<0){p=r[t+8>>2]|0;+Pk[r[(r[p>>2]|0)+12>>2]&3](p,e,i,s,o,r[t+12>>2]|0,r[t+16>>2]|0,r[t+4>>2]|0,r[t+20>>2]|0,r[t+24>>2]|0);return}d=r[t+16>>2]|0;t:do{if((d|0)>0){u=r[t+12>>2]|0;l=0;while(1){_=u+(l<<2)|0;c=r[_>>2]|0;h=r[(r[c+28>>2]|0)+208>>2]|0;if((h|0)<=-1)h=r[(r[c+32>>2]|0)+208>>2]|0;if((h|0)==(a|0)){p=_;break t}l=l+1|0;if((l|0)>=(d|0)){p=0;break}}}else{l=0;p=0}}while(0);if((l|0)<(d|0)){u=r[t+12>>2]|0;h=0;do{_=r[u+(l<<2)>>2]|0;c=r[(r[_+28>>2]|0)+208>>2]|0;if((c|0)<=-1)c=r[(r[_+32>>2]|0)+208>>2]|0;h=((c|0)==(a|0)&1)+h|0;l=l+1|0}while((l|0)!=(d|0));a=h}else a=0;l=r[t+4>>2]|0;if((r[l+72>>2]|0)<2){d=r[t+8>>2]|0;+Pk[r[(r[d>>2]|0)+12>>2]&3](d,e,i,s,o,p,a,l,r[t+20>>2]|0,r[t+24>>2]|0);return}if((i|0)>0){l=r[t+32>>2]|0;h=r[t+36>>2]|0;d=0;do{u=e+(d<<2)|0;if((l|0)==(h|0)){_=h|0?h<<1:1;if((h|0)<(_|0)){if(!_)l=0;else{r[5637]=(r[5637]|0)+1;l=Zl((_<<2|3)+16|0)|0;if(!l)l=0;else{r[(l+4+15&-16)+-4>>2]=l;l=l+4+15&-16}h=r[t+32>>2]|0}if((h|0)>0){c=0;do{r[l+(c<<2)>>2]=r[(r[t+40>>2]|0)+(c<<2)>>2];c=c+1|0}while((c|0)!=(h|0))}c=r[t+40>>2]|0;if(c){if(n[t+44>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[c+-4>>2]|0);h=r[t+32>>2]|0}r[t+40>>2]=0}n[t+44>>0]=1;r[t+40>>2]=l;r[t+36>>2]=_;l=h;h=_}else l=h}r[(r[t+40>>2]|0)+(l<<2)>>2]=r[u>>2];l=l+1|0;r[t+32>>2]=l;d=d+1|0}while((d|0)!=(i|0))}if((o|0)>0){l=r[t+52>>2]|0;h=r[t+56>>2]|0;d=0;do{u=s+(d<<2)|0;if((l|0)==(h|0)){_=h|0?h<<1:1;if((h|0)<(_|0)){if(!_)l=0;else{r[5637]=(r[5637]|0)+1;l=Zl((_<<2|3)+16|0)|0;if(!l)l=0;else{r[(l+4+15&-16)+-4>>2]=l;l=l+4+15&-16}h=r[t+52>>2]|0}if((h|0)>0){c=0;do{r[l+(c<<2)>>2]=r[(r[t+60>>2]|0)+(c<<2)>>2];c=c+1|0}while((c|0)!=(h|0))}c=r[t+60>>2]|0;if(c){if(n[t+64>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[c+-4>>2]|0);h=r[t+52>>2]|0}r[t+60>>2]=0}n[t+64>>0]=1;r[t+60>>2]=l;r[t+56>>2]=_;l=h;h=_}else l=h}r[(r[t+60>>2]|0)+(l<<2)>>2]=r[u>>2];l=l+1|0;r[t+52>>2]=l;d=d+1|0}while((d|0)!=(o|0))}if((a|0)>0){l=r[t+72>>2]|0;h=r[t+76>>2]|0;d=0;do{u=p+(d<<2)|0;if((l|0)==(h|0)){_=h|0?h<<1:1;if((h|0)<(_|0)){if(!_){c=0;l=h}else{r[5637]=(r[5637]|0)+1;l=Zl((_<<2|3)+16|0)|0;if(!l)l=0;else{r[(l+4+15&-16)+-4>>2]=l;l=l+4+15&-16}c=l;l=r[t+72>>2]|0}if((l|0)>0){h=0;do{r[c+(h<<2)>>2]=r[(r[t+80>>2]|0)+(h<<2)>>2];h=h+1|0}while((h|0)!=(l|0))}h=r[t+80>>2]|0;if(h){if(n[t+84>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[h+-4>>2]|0);l=r[t+72>>2]|0}r[t+80>>2]=0}n[t+84>>0]=1;r[t+80>>2]=c;r[t+76>>2]=_;h=_}else l=h}r[(r[t+80>>2]|0)+(l<<2)>>2]=r[u>>2];l=l+1|0;r[t+72>>2]=l;d=d+1|0}while((d|0)!=(a|0))}else l=r[t+72>>2]|0;if(((r[t+52>>2]|0)+l|0)<=(r[(r[t+4>>2]|0)+72>>2]|0))return;Ty(t);return}function Fy(t){t=t|0;var e=0;r[t>>2]=7916;e=r[t+520>>2]|0;if(e|0){if(n[t+524>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+520>>2]=0}n[t+524>>0]=1;r[t+520>>2]=0;r[t+512>>2]=0;r[t+516>>2]=0;r[t>>2]=3156;e=r[t+276>>2]|0;if(e|0){if(n[t+280>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+276>>2]=0}n[t+280>>0]=1;r[t+276>>2]=0;r[t+268>>2]=0;r[t+272>>2]=0;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function By(t){t=t|0;return 488}function Ny(t,e,i){t=t|0;e=e|0;i=i|0;YS(t,e,i)|0;r[e+256>>2]=r[t+288>>2];r[e+260>>2]=r[t+292>>2];r[e+264>>2]=r[t+296>>2];r[e+268>>2]=r[t+300>>2];r[e+272>>2]=r[t+304>>2];r[e+276>>2]=r[t+308>>2];r[e+280>>2]=r[t+312>>2];r[e+284>>2]=r[t+316>>2];r[e+288>>2]=r[t+320>>2];r[e+292>>2]=r[t+324>>2];r[e+296>>2]=r[t+328>>2];r[e+300>>2]=r[t+332>>2];r[e+304>>2]=r[t+336>>2];r[e+308>>2]=r[t+340>>2];r[e+312>>2]=r[t+344>>2];r[e+316>>2]=r[t+348>>2];r[e+320>>2]=r[t+352>>2];r[e+324>>2]=r[t+356>>2];r[e+328>>2]=r[t+360>>2];r[e+332>>2]=r[t+364>>2];r[e+448>>2]=r[t+368>>2];r[e+336>>2]=r[t+568>>2];r[e+340>>2]=r[t+572>>2];r[e+344>>2]=r[t+576>>2];r[e+348>>2]=r[t+580>>2];r[e+352>>2]=r[t+372>>2];r[e+356>>2]=r[t+376>>2];r[e+360>>2]=r[t+380>>2];r[e+364>>2]=r[t+384>>2];r[e+368>>2]=r[t+388>>2];r[e+372>>2]=r[t+392>>2];r[e+376>>2]=r[t+396>>2];r[e+380>>2]=r[t+400>>2];r[e+384>>2]=r[t+404>>2];r[e+388>>2]=r[t+408>>2];r[e+392>>2]=r[t+412>>2];r[e+396>>2]=r[t+416>>2];r[e+400>>2]=r[t+420>>2];r[e+404>>2]=r[t+424>>2];r[e+408>>2]=r[t+428>>2];r[e+412>>2]=r[t+432>>2];r[e+416>>2]=r[t+436>>2];r[e+420>>2]=r[t+440>>2];r[e+424>>2]=r[t+444>>2];r[e+428>>2]=r[t+448>>2];r[e+432>>2]=r[t+452>>2];r[e+436>>2]=r[t+456>>2];r[e+440>>2]=r[t+460>>2];r[e+444>>2]=r[t+464>>2];r[e+452>>2]=r[t+468>>2];r[e+456>>2]=r[t+472>>2];r[e+484>>2]=o[t+476>>0];r[e+460>>2]=r[t+480>>2];r[e+464>>2]=r[t+484>>2];r[e+468>>2]=r[t+488>>2];r[e+472>>2]=r[t+492>>2];r[e+476>>2]=r[t+496>>2];r[e+480>>2]=r[t+500>>2];return 16174}function Uy(t,e){t=t|0;e=e|0;var i=0,n=0;i=r[(r[e>>2]|0)+16>>2]|0;n=ck[r[(r[t>>2]|0)+16>>2]&127](t)|0;n=yk[i&63](e,n,1)|0;i=yk[r[(r[t>>2]|0)+20>>2]&63](t,r[n+8>>2]|0,e)|0;sk[r[(r[e>>2]|0)+20>>2]&31](e,n,i,1497645650,t);return}function Vy(t,e){t=t|0;e=e|0;var i=0,s=0.0,o=0,a=0,l=0,c=0.0,u=0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0;u=_;_=_+32|0;r[t+236>>2]=2;r[t+336>>2]=0;r[t+336+4>>2]=0;r[t+336+8>>2]=0;r[t+336+12>>2]=0;r[t+336+16>>2]=0;r[t+336+20>>2]=0;r[t+336+24>>2]=0;r[t+336+28>>2]=0;r[t+568>>2]=1065353216;r[t+572>>2]=1065353216;r[t+576>>2]=1065353216;h[t+580>>2]=0.0;r[t+372>>2]=1065353216;r[t+376>>2]=1065353216;r[t+380>>2]=1065353216;i=t+384|0;o=i+36|0;do{r[i>>2]=0;i=i+4|0}while((i|0)<(o|0));r[t+436>>2]=0;r[t+436+4>>2]=0;r[t+436+8>>2]=0;r[t+436+12>>2]=0;r[t+436+16>>2]=0;r[t+436+20>>2]=0;r[t+436+24>>2]=0;r[t+436+28>>2]=0;s=+h[e+92>>2];c=+h[e+96>>2];h[u+20>>2]=s;h[u+16>>2]=c;h[u+12>>2]=0.0;h[u+8>>2]=1.0;r[t+468>>2]=r[(s<0.0?u+12|0:s>1.0?u+8|0:u+20|0)>>2];h[u+4>>2]=0.0;h[u>>2]=1.0;r[t+472>>2]=r[(c<0.0?u+4|0:c>1.0?u:u+16|0)>>2];r[t+496>>2]=r[e+112>>2];r[t+500>>2]=r[e+116>>2];i=r[e+4>>2]|0;r[t+504>>2]=i;r[t+632>>2]=0;r[t+636>>2]=0;n[t+476>>0]=n[e+120>>0]|0;r[t+480>>2]=r[e+124>>2];r[t+484>>2]=r[e+128>>2];r[t+488>>2]=r[e+132>>2];r[t+492>>2]=r[e+136>>2];if(!i){r[t+4>>2]=r[e+8>>2];r[t+4+4>>2]=r[e+8+4>>2];r[t+4+8>>2]=r[e+8+8>>2];r[t+4+12>>2]=r[e+8+12>>2];r[t+20>>2]=r[e+24>>2];r[t+20+4>>2]=r[e+24+4>>2];r[t+20+8>>2]=r[e+24+8>>2];r[t+20+12>>2]=r[e+24+12>>2];r[t+36>>2]=r[e+40>>2];r[t+36+4>>2]=r[e+40+4>>2];r[t+36+8>>2]=r[e+40+8>>2];r[t+36+12>>2]=r[e+40+12>>2];r[t+52>>2]=r[e+56>>2];r[t+52+4>>2]=r[e+56+4>>2];r[t+52+8>>2]=r[e+56+8>>2];r[t+52+12>>2]=r[e+56+12>>2];i=t+4|0;o=t+20|0;a=t+36|0;l=t+52|0}else{lk[r[(r[i>>2]|0)+8>>2]&127](i,t+4|0);i=t+4|0;o=t+20|0;a=t+36|0;l=t+52|0}r[t+68>>2]=r[i>>2];r[t+68+4>>2]=r[i+4>>2];r[t+68+8>>2]=r[i+8>>2];r[t+68+12>>2]=r[i+12>>2];r[t+84>>2]=r[o>>2];r[t+84+4>>2]=r[o+4>>2];r[t+84+8>>2]=r[o+8>>2];r[t+84+12>>2]=r[o+12>>2];r[t+100>>2]=r[a>>2];r[t+100+4>>2]=r[a+4>>2];r[t+100+8>>2]=r[a+8>>2];r[t+100+12>>2]=r[a+12>>2];r[t+116>>2]=r[l>>2];r[t+116+4>>2]=r[l+4>>2];r[t+116+8>>2]=r[l+8>>2];r[t+116+12>>2]=r[l+12>>2];r[t+132>>2]=0;r[t+132+4>>2]=0;r[t+132+8>>2]=0;r[t+132+12>>2]=0;r[t+132+16>>2]=0;r[t+132+20>>2]=0;r[t+132+24>>2]=0;r[t+132+28>>2]=0;r[t+224>>2]=r[e+100>>2];r[t+232>>2]=r[e+104>>2];r[t+228>>2]=r[e+108>>2];lk[r[(r[t>>2]|0)+8>>2]&127](t,r[e+72>>2]|0);i=r[5476]|0;r[5476]=i+1;r[t+532>>2]=i;s=+h[e>>2];i=r[t+204>>2]|0;if(s==0.0){r[t+204>>2]=i|1;c=0.0}else{r[t+204>>2]=i&-2;c=1.0/s}h[t+368>>2]=c;f=s*+h[t+408>>2];p=s*+h[t+412>>2];h[t+388>>2]=s*+h[t+404>>2];h[t+392>>2]=f;h[t+396>>2]=p;h[t+400>>2]=0.0;s=+h[e+76>>2];o=s!=0.0?(h[d>>2]=1.0/s,r[d>>2]|0):0;s=+h[e+80>>2];i=s!=0.0?(h[d>>2]=1.0/s,r[d>>2]|0):0;s=+h[e+84>>2];e=s!=0.0?(h[d>>2]=1.0/s,r[d>>2]|0):0;r[t+420>>2]=o;r[t+424>>2]=i;r[t+428>>2]=e;h[t+432>>2]=0.0;g=c*+h[t+376>>2];w=c*+h[t+380>>2];h[t+584>>2]=c*+h[t+372>>2];h[t+588>>2]=g;h[t+592>>2]=w;h[t+596>>2]=0.0;w=+h[t+4>>2];g=(r[d>>2]=o,+h[d>>2]);x=+h[t+8>>2];s=(r[d>>2]=i,+h[d>>2]);S=+h[t+12>>2];p=(r[d>>2]=e,+h[d>>2]);v=+h[t+20>>2];y=+h[t+24>>2];b=+h[t+28>>2];m=+h[t+36>>2];f=+h[t+40>>2];c=+h[t+44>>2];h[t+288>>2]=w*(w*g)+x*(x*s)+S*(S*p);h[t+292>>2]=w*g*v+x*s*y+S*p*b;h[t+296>>2]=w*g*m+x*s*f+S*p*c;h[t+300>>2]=0.0;h[t+304>>2]=w*(g*v)+x*(s*y)+S*(p*b);h[t+308>>2]=v*(g*v)+y*(s*y)+b*(p*b);h[t+312>>2]=g*v*m+s*y*f+p*b*c;h[t+316>>2]=0.0;h[t+320>>2]=w*(g*m)+x*(s*f)+S*(p*c);h[t+324>>2]=v*(g*m)+y*(s*f)+b*(p*c);h[t+328>>2]=m*(g*m)+f*(s*f)+c*(p*c);h[t+332>>2]=0.0;r[t+528>>2]=8;r[t+536>>2]=0;r[t+536+4>>2]=0;r[t+536+8>>2]=0;r[t+536+12>>2]=0;r[t+536+16>>2]=0;r[t+536+20>>2]=0;r[t+536+24>>2]=0;r[t+536+28>>2]=0;c=+h[t+368>>2];p=c*+h[t+376>>2];f=c*+h[t+380>>2];h[t+584>>2]=+h[t+372>>2]*c;h[t+588>>2]=p;h[t+592>>2]=f;i=t+596|0;o=i+36|0;do{r[i>>2]=0;i=i+4|0}while((i|0)<(o|0));_=u;return}function zy(t,e,i,s,o){t=t|0;e=+e;i=i|0;s=s|0;o=o|0;var a=0;a=_;_=_+144|0;r[t+164>>2]=1065353216;r[t+168>>2]=1065353216;r[t+172>>2]=1065353216;h[t+176>>2]=0.0;r[t+180>>2]=0;h[t+184>>2]=999999984306749440.0;r[t+188>>2]=0;r[t+188+4>>2]=0;r[t+188+8>>2]=0;r[t+188+12>>2]=0;r[t+204>>2]=1;r[t+208>>2]=-1;r[t+212>>2]=-1;r[t+216>>2]=1;h[t+220>>2]=0.0;h[t+224>>2]=.5;h[t+228>>2]=0.0;h[t+232>>2]=0.0;r[t+236>>2]=1;r[t+240>>2]=0;r[t+244>>2]=-1;h[t+248>>2]=1.0;h[t+252>>2]=0.0;h[t+256>>2]=0.0;r[t+260>>2]=0;n[t+280>>0]=1;r[t+276>>2]=0;r[t+268>>2]=0;r[t+272>>2]=0;r[t+284>>2]=0;r[t+4>>2]=1065353216;r[t+8>>2]=0;r[t+8+4>>2]=0;r[t+8+8>>2]=0;r[t+8+12>>2]=0;r[t+24>>2]=1065353216;r[t+28>>2]=0;r[t+28+4>>2]=0;r[t+28+8>>2]=0;r[t+28+12>>2]=0;r[t+44>>2]=1065353216;r[t+48>>2]=0;r[t+48+4>>2]=0;r[t+48+8>>2]=0;r[t+48+12>>2]=0;r[t+48+16>>2]=0;r[t>>2]=7916;n[t+524>>0]=1;r[t+520>>2]=0;r[t+512>>2]=0;r[t+516>>2]=0;h[a>>2]=e;r[a+4>>2]=i;r[a+72>>2]=s;r[a+76>>2]=r[o>>2];r[a+76+4>>2]=r[o+4>>2];r[a+76+8>>2]=r[o+8>>2];r[a+76+12>>2]=r[o+12>>2];h[a+92>>2]=0.0;h[a+96>>2]=0.0;h[a+100>>2]=.5;h[a+104>>2]=0.0;h[a+108>>2]=0.0;h[a+112>>2]=.800000011920929;h[a+116>>2]=1.0;n[a+120>>0]=0;h[a+124>>2]=.004999999888241291;h[a+128>>2]=.009999999776482582;h[a+132>>2]=.009999999776482582;h[a+136>>2]=.009999999776482582;r[a+8>>2]=1065353216;r[a+12>>2]=0;r[a+12+4>>2]=0;r[a+12+8>>2]=0;r[a+12+12>>2]=0;r[a+28>>2]=1065353216;r[a+32>>2]=0;r[a+32+4>>2]=0;r[a+32+8>>2]=0;r[a+32+12>>2]=0;r[a+48>>2]=1065353216;r[a+52>>2]=0;r[a+52+4>>2]=0;r[a+52+8>>2]=0;r[a+52+12>>2]=0;r[a+52+16>>2]=0;Vy(t,a);_=a;return}function Wy(t,e){t=t|0;e=+e;var i=0.0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0;_=+h[t+468>>2];a=+j(+(1.0-_),+e);i=a*+h[t+336>>2];h[t+336>>2]=i;o=a*+h[t+340>>2];h[t+340>>2]=o;a=a*+h[t+344>>2];h[t+344>>2]=a;u=+h[t+472>>2];s=+j(+(1.0-u),+e);e=s*+h[t+352>>2];h[t+352>>2]=e;l=s*+h[t+356>>2];h[t+356>>2]=l;s=s*+h[t+360>>2];h[t+360>>2]=s;if(!(n[t+476>>0]|0))return;if(s*s+(e*e+l*l)<+h[t+488>>2]?i*i+o*o+a*a<+h[t+484>>2]:0){d=+h[t+480>>2];h[t+352>>2]=e*d;h[t+356>>2]=d*l;h[t+360>>2]=d*s;h[t+336>>2]=d*i;h[t+340>>2]=d*o;h[t+344>>2]=d*a;i=d*i;o=d*o;a=d*a;c=e*d;l=d*l;s=d*s}else c=e;e=+G(+(i*i+o*o+a*a));do{if(e<_)if(e>.004999999888241291){h[t+336>>2]=i-i*(1.0/e)*.004999999888241291;h[t+340>>2]=o-o*(1.0/e)*.004999999888241291;h[t+344>>2]=a-a*(1.0/e)*.004999999888241291;break}else{r[t+336>>2]=0;r[t+336+4>>2]=0;r[t+336+8>>2]=0;r[t+336+12>>2]=0;break}}while(0);e=+G(+(c*c+l*l+s*s));if(!(e<u))return;if(e>.004999999888241291){h[t+352>>2]=c-c*(1.0/e)*.004999999888241291;h[t+356>>2]=l-l*(1.0/e)*.004999999888241291;h[t+360>>2]=s-s*(1.0/e)*.004999999888241291;return}else{r[t+352>>2]=0;r[t+352+4>>2]=0;r[t+352+8>>2]=0;r[t+352+12>>2]=0;return}}function Gy(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0,a=0,l=0,c=0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0;if(!(r[t+204>>2]&2)){r[t+68>>2]=r[e>>2];r[t+68+4>>2]=r[e+4>>2];r[t+68+8>>2]=r[e+8>>2];r[t+68+12>>2]=r[e+12>>2];r[t+84>>2]=r[e+16>>2];r[t+84+4>>2]=r[e+16+4>>2];r[t+84+8>>2]=r[e+16+8>>2];r[t+84+12>>2]=r[e+16+12>>2];r[t+100>>2]=r[e+32>>2];r[t+100+4>>2]=r[e+32+4>>2];r[t+100+8>>2]=r[e+32+8>>2];r[t+100+12>>2]=r[e+32+12>>2];r[t+116>>2]=r[e+48>>2];r[t+116+4>>2]=r[e+48+4>>2];r[t+116+8>>2]=r[e+48+8>>2];r[t+116+12>>2]=r[e+48+12>>2];i=t+20|0;n=e+16|0;s=t+36|0;o=e+32|0;a=t+52|0;l=e+48|0;c=t+4|0}else{r[t+68>>2]=r[t+4>>2];r[t+68+4>>2]=r[t+4+4>>2];r[t+68+8>>2]=r[t+4+8>>2];r[t+68+12>>2]=r[t+4+12>>2];r[t+84>>2]=r[t+20>>2];r[t+84+4>>2]=r[t+20+4>>2];r[t+84+8>>2]=r[t+20+8>>2];r[t+84+12>>2]=r[t+20+12>>2];r[t+100>>2]=r[t+36>>2];r[t+100+4>>2]=r[t+36+4>>2];r[t+100+8>>2]=r[t+36+8>>2];r[t+100+12>>2]=r[t+36+12>>2];r[t+116>>2]=r[t+52>>2];r[t+116+4>>2]=r[t+52+4>>2];r[t+116+8>>2]=r[t+52+8>>2];r[t+116+12>>2]=r[t+52+12>>2];i=t+20|0;n=e+16|0;s=t+36|0;o=e+32|0;a=t+52|0;l=e+48|0;c=t+4|0}r[t+132>>2]=r[t+336>>2];r[t+132+4>>2]=r[t+336+4>>2];r[t+132+8>>2]=r[t+336+8>>2];r[t+132+12>>2]=r[t+336+12>>2];r[t+148>>2]=r[t+352>>2];r[t+148+4>>2]=r[t+352+4>>2];r[t+148+8>>2]=r[t+352+8>>2];r[t+148+12>>2]=r[t+352+12>>2];r[c>>2]=r[e>>2];r[c+4>>2]=r[e+4>>2];r[c+8>>2]=r[e+8>>2];r[c+12>>2]=r[e+12>>2];r[i>>2]=r[n>>2];r[i+4>>2]=r[n+4>>2];r[i+8>>2]=r[n+8>>2];r[i+12>>2]=r[n+12>>2];r[s>>2]=r[o>>2];r[s+4>>2]=r[o+4>>2];r[s+8>>2]=r[o+8>>2];r[s+12>>2]=r[o+12>>2];r[a>>2]=r[l>>2];r[a+4>>2]=r[l+4>>2];r[a+8>>2]=r[l+8>>2];r[a+12>>2]=r[l+12>>2];x=+h[t+4>>2];m=+h[t+420>>2];S=+h[t+8>>2];p=+h[t+424>>2];v=+h[t+12>>2];u=+h[t+428>>2];y=+h[t+20>>2];b=+h[t+24>>2];g=+h[t+28>>2];f=+h[t+36>>2];d=+h[t+40>>2];_=+h[t+44>>2];h[t+288>>2]=x*(x*m)+S*(S*p)+v*(v*u);h[t+292>>2]=x*m*y+S*p*b+v*u*g;h[t+296>>2]=x*m*f+S*p*d+v*u*_;h[t+300>>2]=0.0;h[t+304>>2]=x*(m*y)+S*(p*b)+v*(u*g);h[t+308>>2]=y*(m*y)+b*(p*b)+g*(u*g);h[t+312>>2]=m*y*f+p*b*d+u*g*_;h[t+316>>2]=0.0;h[t+320>>2]=x*(m*f)+S*(p*d)+v*(u*_);h[t+324>>2]=y*(m*f)+b*(p*d)+g*(u*_);h[t+328>>2]=f*(m*f)+d*(p*d)+_*(u*_);h[t+332>>2]=0.0;return}function jy(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0,l=0,h=0;i=r[t+512>>2]|0;t:do{if((i|0)>0){o=r[t+520>>2]|0;s=0;while(1){if((r[o+(s<<2)>>2]|0)==(e|0))break;s=s+1|0;if((s|0)>=(i|0))break t}if((s|0)!=(i|0))return}}while(0);if((i|0)==(r[t+516>>2]|0)?(a=i|0?i<<1:1,(i|0)<(a|0)):0){if(!a)o=0;else{r[5637]=(r[5637]|0)+1;i=Zl((a<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=i;i=r[t+512>>2]|0}if((i|0)>0){s=0;do{r[o+(s<<2)>>2]=r[(r[t+520>>2]|0)+(s<<2)>>2];s=s+1|0}while((s|0)!=(i|0))}s=r[t+520>>2]|0;if(s){if(n[t+524>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0);i=r[t+512>>2]|0}r[t+520>>2]=0}n[t+524>>0]=1;r[t+520>>2]=o;r[t+516>>2]=a}r[(r[t+520>>2]|0)+(i<<2)>>2]=e;r[t+512>>2]=i+1;a=r[e+28>>2]|0;e=r[e+32>>2]|0;if((a|0)==(t|0)){i=r[t+268>>2]|0;if((i|0)==(r[t+272>>2]|0)?(h=i|0?i<<1:1,(i|0)<(h|0)):0){if(!h)o=0;else{r[5637]=(r[5637]|0)+1;i=Zl((h<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=i;i=r[t+268>>2]|0}if((i|0)>0){s=0;do{r[o+(s<<2)>>2]=r[(r[t+276>>2]|0)+(s<<2)>>2];s=s+1|0}while((s|0)!=(i|0))}s=r[t+276>>2]|0;if(s){if(n[t+280>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0);i=r[t+268>>2]|0}r[t+276>>2]=0}n[t+280>>0]=1;r[t+276>>2]=o;r[t+272>>2]=h}r[(r[t+276>>2]|0)+(i<<2)>>2]=e;r[t+268>>2]=i+1;r[t+260>>2]=i>>>31^1;return}else{i=r[e+268>>2]|0;if((i|0)==(r[e+272>>2]|0)?(l=i|0?i<<1:1,(i|0)<(l|0)):0){if(!l)o=0;else{r[5637]=(r[5637]|0)+1;i=Zl((l<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=i;i=r[e+268>>2]|0}if((i|0)>0){s=0;do{r[o+(s<<2)>>2]=r[(r[e+276>>2]|0)+(s<<2)>>2];s=s+1|0}while((s|0)!=(i|0))}s=r[e+276>>2]|0;if(s){if(n[e+280>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0);i=r[e+268>>2]|0}r[e+276>>2]=0}n[e+280>>0]=1;r[e+276>>2]=o;r[e+272>>2]=l}r[(r[e+276>>2]|0)+(i<<2)>>2]=a;r[e+268>>2]=i+1;r[e+260>>2]=i>>>31^1;return}}function Hy(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0,a=0,l=0;o=r[t+512>>2]|0;if((o|0)<=0)return;a=r[t+520>>2]|0;i=0;while(1){if((r[a+(i<<2)>>2]|0)==(e|0))break;i=i+1|0;if((i|0)>=(o|0)){l=25;break}}if((l|0)==25)return;if((i|0)<(o|0))s=0;else return;while(1){i=a+(s<<2)|0;if((r[i>>2]|0)==(e|0)){l=8;break}n=s+1|0;if((n|0)<(o|0))s=n;else break}if((l|0)==8?(s|0)<(o|0):0){r[i>>2]=r[a+(o+-1<<2)>>2];r[(r[t+520>>2]|0)+(o+-1<<2)>>2]=e;r[t+512>>2]=o+-1}a=r[e+28>>2]|0;l=r[e+32>>2]|0;if((a|0)==(t|0)){i=r[t+268>>2]|0;t:do{if((i|0)>0){o=r[t+276>>2]|0;n=0;while(1){s=o+(n<<2)|0;if((r[s>>2]|0)==(l|0))break;n=n+1|0;if((n|0)>=(i|0))break t}if((n|0)<(i|0)){r[s>>2]=r[o+(i+-1<<2)>>2];r[(r[t+276>>2]|0)+(i+-1<<2)>>2]=l;r[t+268>>2]=i+-1;i=i+-1|0}}}while(0);r[t+260>>2]=(i|0)>0&1;return}else{i=r[l+268>>2]|0;t:do{if((i|0)>0){o=r[l+276>>2]|0;n=0;while(1){s=o+(n<<2)|0;if((r[s>>2]|0)==(a|0))break;n=n+1|0;if((n|0)>=(i|0))break t}if((n|0)<(i|0)){r[s>>2]=r[o+(i+-1<<2)>>2];r[(r[l+276>>2]|0)+(i+-1<<2)>>2]=a;r[l+268>>2]=i+-1;i=i+-1|0}}}while(0);r[l+260>>2]=(i|0)>0&1;return}}function Xy(t){t=t|0;var e=0;r[t>>2]=7952;e=r[t+136>>2]|0;if(e|0){if(n[t+140>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+136>>2]=0}n[t+140>>0]=1;r[t+136>>2]=0;r[t+128>>2]=0;r[t+132>>2]=0;e=r[t+76>>2]|0;if(e|0){if(n[t+80>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+76>>2]=0}n[t+80>>0]=1;r[t+76>>2]=0;r[t+68>>2]=0;r[t+72>>2]=0;e=r[t+56>>2]|0;if(e|0){if(n[t+60>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+56>>2]=0}n[t+60>>0]=1;r[t+56>>2]=0;r[t+48>>2]=0;r[t+52>>2]=0;e=r[t+36>>2]|0;if(e|0){if(n[t+40>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+36>>2]=0}n[t+40>>0]=1;r[t+36>>2]=0;r[t+28>>2]=0;r[t+32>>2]=0;e=r[t+16>>2]|0;if(!e){n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;t=t+12|0;r[t>>2]=0;return}if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+16>>2]=0;n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;t=t+12|0;r[t>>2]=0;return}function Yy(t){t=t|0;Xy(t);Ql(t);return}function qy(t,e,i){t=t|0;e=e|0;i=+i;rk[r[(r[t>>2]|0)+16>>2]&31](t,i);return}function Ky(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0.0,l=0.0,c=0,u=0;s=_;_=_+48|0;if((r[t+128>>2]|0)<=0){_=s;return}i=0;do{u=r[t+136>>2]|0;r[s+32>>2]=(n[u+(i*284|0)+84>>0]|0)==0?1065353216:0;r[s+32+4>>2]=0;r[s+32+8>>2]=1065353216;h[s+32+12>>2]=0.0;c=u+(i*284|0)+140|0;r[s+16>>2]=r[c>>2];r[s+16+4>>2]=r[c+4>>2];r[s+16+8>>2]=r[c+8>>2];r[s+16+12>>2]=r[c+12>>2];c=r[t+112>>2]|0;o=r[(r[e>>2]|0)+16>>2]|0;l=+h[u+(i*284|0)+108+(c<<2)>>2]+ +h[s+16+4>>2];a=+h[u+(i*284|0)+124+(c<<2)>>2]+ +h[s+16+8>>2];h[s>>2]=+h[u+(i*284|0)+92+(c<<2)>>2]+ +h[s+16>>2];h[s+4>>2]=l;h[s+8>>2]=a;h[s+12>>2]=0.0;jk[o&127](e,s+16|0,s,s+32|0);jk[r[(r[e>>2]|0)+16>>2]&127](e,s+16|0,(r[t+136>>2]|0)+(i*284|0)+16|0,s+32|0);i=i+1|0}while((i|0)<(r[t+128>>2]|0));_=s;return}function Zy(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,l=0.0,u=0.0,d=0,p=0,f=0.0,m=0.0,g=0,b=0,y=0,v=0;p=_;_=_+80|0;i=ck[r[(r[t>>2]|0)+28>>2]&127](t)|0;s=+h[t+4>>2];l=+h[t+8>>2];u=+h[t+12>>2];if((i|0)<=0){_=p;return}d=0;do{Mk[r[(r[t>>2]|0)+16>>2]&3](t,p+76|0,p+52|0,p+64|0,p+56|0,p+72|0,p+68|0,p+48|0,p+60|0,d);t:do{switch(r[p+64>>2]|0){case 0:{switch(r[p+60>>2]|0){case 2:{if((r[p+48>>2]|0)>0)n=0;else break t;do{g=(r[p+72>>2]|0)+(et(r[p+68>>2]|0,n)|0)|0;y=r[p+76>>2]|0;b=r[p+56>>2]|0;v=y+(et(b,r[g>>2]|0)|0)|0;m=l*+h[v+4>>2];f=u*+h[v+8>>2];h[p>>2]=s*+h[v>>2];h[p+4>>2]=m;h[p+8>>2]=f;h[p+12>>2]=0.0;v=y+(et(b,r[g+4>>2]|0)|0)|0;f=l*+h[v+4>>2];m=u*+h[v+8>>2];h[p+16>>2]=s*+h[v>>2];h[p+20>>2]=f;h[p+24>>2]=m;h[p+28>>2]=0.0;g=y+(et(b,r[g+8>>2]|0)|0)|0;m=l*+h[g+4>>2];f=u*+h[g+8>>2];h[p+32>>2]=s*+h[g>>2];h[p+36>>2]=m;h[p+40>>2]=f;h[p+44>>2]=0.0;jk[r[(r[e>>2]|0)+8>>2]&127](e,p,d,n);n=n+1|0}while((n|0)<(r[p+48>>2]|0));break}case 3:{if((r[p+48>>2]|0)>0)n=0;else break t;do{y=(r[p+72>>2]|0)+(et(r[p+68>>2]|0,n)|0)|0;b=r[p+76>>2]|0;v=r[p+56>>2]|0;g=b+(et(a[y>>1]|0,v)|0)|0;f=l*+h[g+4>>2];m=u*+h[g+8>>2];h[p>>2]=s*+h[g>>2];h[p+4>>2]=f;h[p+8>>2]=m;h[p+12>>2]=0.0;g=b+(et(a[y+2>>1]|0,v)|0)|0;m=l*+h[g+4>>2];f=u*+h[g+8>>2];h[p+16>>2]=s*+h[g>>2];h[p+20>>2]=m;h[p+24>>2]=f;h[p+28>>2]=0.0;v=b+(et(a[y+4>>1]|0,v)|0)|0;f=l*+h[v+4>>2];m=u*+h[v+8>>2];h[p+32>>2]=s*+h[v>>2];h[p+36>>2]=f;h[p+40>>2]=m;h[p+44>>2]=0.0;jk[r[(r[e>>2]|0)+8>>2]&127](e,p,d,n);n=n+1|0}while((n|0)<(r[p+48>>2]|0));break}case 5:{if((r[p+48>>2]|0)>0)n=0;else break t;do{y=(r[p+72>>2]|0)+(et(r[p+68>>2]|0,n)|0)|0;b=r[p+76>>2]|0;v=r[p+56>>2]|0;g=b+(et(o[y>>0]|0,v)|0)|0;f=l*+h[g+4>>2];m=u*+h[g+8>>2];h[p>>2]=s*+h[g>>2];h[p+4>>2]=f;h[p+8>>2]=m;h[p+12>>2]=0.0;g=b+(et(o[y+1>>0]|0,v)|0)|0;m=l*+h[g+4>>2];f=u*+h[g+8>>2];h[p+16>>2]=s*+h[g>>2];h[p+20>>2]=m;h[p+24>>2]=f;h[p+28>>2]=0.0;v=b+(et(o[y+2>>0]|0,v)|0)|0;f=l*+h[v+4>>2];m=u*+h[v+8>>2];h[p+32>>2]=s*+h[v>>2];h[p+36>>2]=f;h[p+40>>2]=m;h[p+44>>2]=0.0;jk[r[(r[e>>2]|0)+8>>2]&127](e,p,d,n);n=n+1|0}while((n|0)<(r[p+48>>2]|0));break}default:break t}break}case 1:{switch(r[p+60>>2]|0){case 2:{if((r[p+48>>2]|0)>0)n=0;else break t;do{v=(r[p+72>>2]|0)+(et(r[p+68>>2]|0,n)|0)|0;b=r[p+76>>2]|0;y=r[p+56>>2]|0;g=b+(et(y,r[v>>2]|0)|0)|0;f=l*+c[g+8>>3];m=u*+c[g+16>>3];h[p>>2]=s*+c[g>>3];h[p+4>>2]=f;h[p+8>>2]=m;h[p+12>>2]=0.0;g=b+(et(y,r[v+4>>2]|0)|0)|0;m=l*+c[g+8>>3];f=u*+c[g+16>>3];h[p+16>>2]=s*+c[g>>3];h[p+20>>2]=m;h[p+24>>2]=f;h[p+28>>2]=0.0;v=b+(et(y,r[v+8>>2]|0)|0)|0;f=l*+c[v+8>>3];m=u*+c[v+16>>3];h[p+32>>2]=s*+c[v>>3];h[p+36>>2]=f;h[p+40>>2]=m;h[p+44>>2]=0.0;jk[r[(r[e>>2]|0)+8>>2]&127](e,p,d,n);n=n+1|0}while((n|0)<(r[p+48>>2]|0));break}case 3:{if((r[p+48>>2]|0)>0)n=0;else break t;do{y=(r[p+72>>2]|0)+(et(r[p+68>>2]|0,n)|0)|0;b=r[p+76>>2]|0;v=r[p+56>>2]|0;g=b+(et(a[y>>1]|0,v)|0)|0;f=l*+c[g+8>>3];m=u*+c[g+16>>3];h[p>>2]=s*+c[g>>3];h[p+4>>2]=f;h[p+8>>2]=m;h[p+12>>2]=0.0;g=b+(et(a[y+2>>1]|0,v)|0)|0;m=l*+c[g+8>>3];f=u*+c[g+16>>3];h[p+16>>2]=s*+c[g>>3];h[p+20>>2]=m;h[p+24>>2]=f;h[p+28>>2]=0.0;v=b+(et(a[y+4>>1]|0,v)|0)|0;f=l*+c[v+8>>3];m=u*+c[v+16>>3];h[p+32>>2]=s*+c[v>>3];h[p+36>>2]=f;h[p+40>>2]=m;h[p+44>>2]=0.0;jk[r[(r[e>>2]|0)+8>>2]&127](e,p,d,n);n=n+1|0}while((n|0)<(r[p+48>>2]|0));break}case 5:{if((r[p+48>>2]|0)>0)n=0;else break t;do{y=(r[p+72>>2]|0)+(et(r[p+68>>2]|0,n)|0)|0;b=r[p+76>>2]|0;v=r[p+56>>2]|0;g=b+(et(o[y>>0]|0,v)|0)|0;f=l*+c[g+8>>3];m=u*+c[g+16>>3];h[p>>2]=s*+c[g>>3];h[p+4>>2]=f;h[p+8>>2]=m;h[p+12>>2]=0.0;g=b+(et(o[y+1>>0]|0,v)|0)|0;m=l*+c[g+8>>3];f=u*+c[g+16>>3];h[p+16>>2]=s*+c[g>>3];h[p+20>>2]=m;h[p+24>>2]=f;h[p+28>>2]=0.0;v=b+(et(o[y+2>>0]|0,v)|0)|0;f=l*+c[v+8>>3];m=u*+c[v+16>>3];h[p+32>>2]=s*+c[v>>3];h[p+36>>2]=f;h[p+40>>2]=m;h[p+44>>2]=0.0;jk[r[(r[e>>2]|0)+8>>2]&127](e,p,d,n);n=n+1|0}while((n|0)<(r[p+48>>2]|0));break}default:break t}break}default:{}}}while(0);lk[r[(r[t>>2]|0)+24>>2]&127](t,d);d=d+1|0}while((d|0)!=(i|0));_=p;return}function Qy(t){t=t|0;return 28}function $y(t,e,i){t=t|0;e=e|0;i=i|0;var o=0,a=0,l=0,h=0,u=0,d=0,p=0,f=0,m=0,g=0,b=0,y=0,v=0;y=_;_=_+32|0;o=ck[r[(r[t>>2]|0)+28>>2]&127](t)|0;r[e+20>>2]=o;r[e>>2]=0;if(!o){b=t+4|0;i=e+4|0;b=r[b>>2]|0;r[i>>2]=b;i=t+8|0;i=r[i>>2]|0;b=e+8|0;r[b>>2]=i;b=t+12|0;b=r[b>>2]|0;i=e+12|0;r[i>>2]=b;i=t+16|0;i=r[i>>2]|0;t=e+16|0;r[t>>2]=i;_=y;return 14151}b=yk[r[(r[i>>2]|0)+16>>2]&63](i,32,o)|0;o=r[b+8>>2]|0;r[e>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,o)|0;g=ck[r[(r[t>>2]|0)+28>>2]&127](t)|0;t:do{if((g|0)>0){m=0;while(1){Mk[r[(r[t>>2]|0)+16>>2]&3](t,y+28|0,y+4|0,y+16|0,y+8|0,y+24|0,y+20|0,y,y+12|0,m);r[o+24>>2]=r[y>>2];r[o+28>>2]=r[y+4>>2];l=o+12|0;u=o+16|0;f=o+4|0;r[o>>2]=0;r[o+4>>2]=0;r[o+8>>2]=0;r[o+12>>2]=0;r[o+16>>2]=0;r[o+20>>2]=0;switch(r[y+12>>2]|0){case 2:{a=r[y>>2]|0;if(a|0){a=yk[r[(r[i>>2]|0)+16>>2]&63](i,4,a*3|0)|0;l=r[a+8>>2]|0;r[o+8>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,l)|0;if((r[y>>2]|0)>0){h=r[y+24>>2]|0;u=0;do{d=h+(et(r[y+20>>2]|0,u)|0)|0;p=u*3|0;r[l+(p<<2)>>2]=r[d>>2];r[l+(p+1<<2)>>2]=r[d+4>>2];r[l+(p+2<<2)>>2]=r[d+8>>2];u=u+1|0}while((u|0)<(r[y>>2]|0))}sk[r[(r[i>>2]|0)+20>>2]&31](i,a,14051,1497453121,r[a+8>>2]|0)}break}case 3:{a=r[y>>2]|0;if(a|0){d=yk[r[(r[i>>2]|0)+16>>2]&63](i,8,a)|0;p=r[d+8>>2]|0;r[l>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,p)|0;a=r[y>>2]|0;if((a|0)>0){l=r[y+24>>2]|0;h=r[y+20>>2]|0;u=0;do{v=l+(et(h,u)|0)|0;s[p+(u<<3)>>1]=s[v>>1]|0;s[p+(u<<3)+2>>1]=s[v+2>>1]|0;s[p+(u<<3)+4>>1]=s[v+4>>1]|0;u=u+1|0}while((u|0)!=(a|0))}sk[r[(r[i>>2]|0)+20>>2]&31](i,d,14066,1497453121,r[d+8>>2]|0)}break}case 5:{a=r[y>>2]|0;if(a|0){l=yk[r[(r[i>>2]|0)+16>>2]&63](i,4,a)|0;h=r[l+8>>2]|0;r[u>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,h)|0;if((r[y>>2]|0)>0){a=0;do{v=(r[y+24>>2]|0)+(et(r[y+20>>2]|0,a)|0)|0;n[h+(a<<2)>>0]=n[v>>0]|0;n[h+(a<<2)+1>>0]=n[v+1>>0]|0;n[h+(a<<2)+2>>0]=n[v+2>>0]|0;a=a+1|0}while((a|0)<(r[y>>2]|0))}sk[r[(r[i>>2]|0)+20>>2]&31](i,l,14093,1497453121,r[l+8>>2]|0)}break}default:{}}switch(r[y+16>>2]|0){case 0:{a=r[y+4>>2]|0;if(a|0){a=yk[r[(r[i>>2]|0)+16>>2]&63](i,16,a)|0;l=r[a+8>>2]|0;r[o>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,l)|0;h=r[y+4>>2]|0;if((h|0)>0){u=r[y+28>>2]|0;d=r[y+8>>2]|0;p=0;do{v=u+(et(d,p)|0)|0;r[l+(p<<4)>>2]=r[v>>2];r[l+(p<<4)+4>>2]=r[v+4>>2];r[l+(p<<4)+8>>2]=r[v+8>>2];p=p+1|0}while((p|0)!=(h|0))}sk[r[(r[i>>2]|0)+20>>2]&31](i,a,16354,1497453121,r[a+8>>2]|0)}break}case 1:{a=r[y+4>>2]|0;if(a|0){d=yk[r[(r[i>>2]|0)+16>>2]&63](i,32,a)|0;p=r[d+8>>2]|0;r[f>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,p)|0;a=r[y+4>>2]|0;if((a|0)>0){l=r[y+28>>2]|0;h=r[y+8>>2]|0;u=0;do{v=l+(et(h,u)|0)|0;c[p+(u<<5)>>3]=+c[v>>3];c[p+(u<<5)+8>>3]=+c[v+8>>3];c[p+(u<<5)+16>>3]=+c[v+16>>3];u=u+1|0}while((u|0)!=(a|0))}sk[r[(r[i>>2]|0)+20>>2]&31](i,d,14116,1497453121,r[d+8>>2]|0)}break}default:{}}lk[r[(r[t>>2]|0)+24>>2]&127](t,m);m=m+1|0;if((m|0)==(g|0)){o=i;break t}else o=o+32|0}}else o=i}while(0);sk[r[(r[o>>2]|0)+20>>2]&31](i,b,14136,1497453121,r[b+8>>2]|0);i=t+4|0;v=e+4|0;i=r[i>>2]|0;r[v>>2]=i;v=t+8|0;v=r[v>>2]|0;i=e+8|0;r[i>>2]=v;i=t+12|0;i=r[i>>2]|0;v=e+12|0;r[v>>2]=i;t=t+16|0;t=r[t>>2]|0;v=e+16|0;r[v>>2]=t;_=y;return 14151}function Jy(t){t=t|0;return}function tv(t){t=t|0;return}function ev(t){t=t|0;var e=0;r[t>>2]=6556;e=r[t+32>>2]|0;if(e|0){if(n[t+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+32>>2]=0}n[t+36>>0]=1;r[t+32>>2]=0;r[t+24>>2]=0;r[t+28>>2]=0;return}function iv(t){t=t|0;var e=0;r[t>>2]=6556;e=r[t+32>>2]|0;if(e|0){if(n[t+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+32>>2]=0}n[t+36>>0]=1;r[t+32>>2]=0;r[t+24>>2]=0;r[t+28>>2]=0;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function nv(t,e,i,n,s,o,a,l,h,c){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;l=l|0;h=h|0;c=c|0;t=r[t+32>>2]|0;r[i>>2]=r[t+(c<<5)+12>>2];r[e>>2]=r[t+(c<<5)+16>>2];r[n>>2]=r[t+(c<<5)+28>>2];r[s>>2]=r[t+(c<<5)+20>>2];r[l>>2]=r[t+(c<<5)>>2];r[o>>2]=r[t+(c<<5)+4>>2];r[a>>2]=r[t+(c<<5)+8>>2];r[h>>2]=r[t+(c<<5)+24>>2];return}function sv(t,e,i,n,s,o,a,l,h,c){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;l=l|0;h=h|0;c=c|0;t=r[t+32>>2]|0;r[i>>2]=r[t+(c<<5)+12>>2];r[e>>2]=r[t+(c<<5)+16>>2];r[n>>2]=r[t+(c<<5)+28>>2];r[s>>2]=r[t+(c<<5)+20>>2];r[l>>2]=r[t+(c<<5)>>2];r[o>>2]=r[t+(c<<5)+4>>2];r[a>>2]=r[t+(c<<5)+8>>2];r[h>>2]=r[t+(c<<5)+24>>2];return}function rv(t,e){t=t|0;e=e|0;return}function ov(t,e){t=t|0;e=e|0;return}function av(t){t=t|0;return r[t+24>>2]|0}function lv(t,e){t=t|0;e=e|0;return}function hv(t,e){t=t|0;e=e|0;return}function cv(t){t=t|0;return(r[t+48>>2]|0)==1|0}function _v(t,e,i){t=t|0;e=e|0;i=i|0;r[t+52>>2]=r[e>>2];r[t+52+4>>2]=r[e+4>>2];r[t+52+8>>2]=r[e+8>>2];r[t+52+12>>2]=r[e+12>>2];r[t+68>>2]=r[i>>2];r[t+68+4>>2]=r[i+4>>2];r[t+68+8>>2]=r[i+8>>2];r[t+68+12>>2]=r[i+12>>2];r[t+48>>2]=1;return}function uv(t,e,i){t=t|0;e=e|0;i=i|0;r[e>>2]=r[t+52>>2];r[e+4>>2]=r[t+52+4>>2];r[e+8>>2]=r[t+52+8>>2];r[e+12>>2]=r[t+52+12>>2];r[i>>2]=r[t+68>>2];r[i+4>>2]=r[t+68+4>>2];r[i+8>>2]=r[t+68+8>>2];r[i+12>>2]=r[t+68+12>>2];return}function dv(t){t=t|0;var e=0;r[t>>2]=6624;e=r[t+156>>2]|0;if(e|0){if(n[t+160>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+156>>2]=0}n[t+160>>0]=1;r[t+156>>2]=0;r[t+148>>2]=0;r[t+152>>2]=0;e=r[t+136>>2]|0;if(e|0){if(n[t+140>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+136>>2]=0}n[t+140>>0]=1;r[t+136>>2]=0;r[t+128>>2]=0;r[t+132>>2]=0;e=r[t+116>>2]|0;if(e|0){if(n[t+120>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+116>>2]=0}n[t+120>>0]=1;r[t+116>>2]=0;r[t+108>>2]=0;r[t+112>>2]=0;e=r[t+96>>2]|0;if(e|0){if(n[t+100>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+96>>2]=0}n[t+100>>0]=1;r[t+96>>2]=0;r[t+88>>2]=0;r[t+92>>2]=0;r[t>>2]=6556;e=r[t+32>>2]|0;if(!e){n[t+36>>0]=1;r[t+32>>2]=0;r[t+24>>2]=0;t=t+28|0;r[t>>2]=0;return}if(n[t+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+32>>2]=0;n[t+36>>0]=1;r[t+32>>2]=0;r[t+24>>2]=0;t=t+28|0;r[t>>2]=0;return}function pv(t){t=t|0;dv(t);if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function fv(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0,l=0;if(n[t+165>>0]|0){if((r[t+92>>2]|0)>=(e|0))return;if((e|0)!=0?(r[5637]=(r[5637]|0)+1,i=Zl((e<<4|3)+16|0)|0,(i|0)!=0):0){r[(i+4+15&-16)+-4>>2]=i;o=i+4+15&-16}else o=0;i=r[t+88>>2]|0;if((i|0)>0){s=0;do{l=o+(s<<4)|0;a=(r[t+96>>2]|0)+(s<<4)|0;r[l>>2]=r[a>>2];r[l+4>>2]=r[a+4>>2];r[l+8>>2]=r[a+8>>2];r[l+12>>2]=r[a+12>>2];s=s+1|0}while((s|0)!=(i|0))}i=r[t+96>>2]|0;if(i|0){if(n[t+100>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[t+96>>2]=0}n[t+100>>0]=1;r[t+96>>2]=o;r[t+92>>2]=e;return}if((r[t+112>>2]|0)>=(e|0))return;if((e|0)!=0?(r[5637]=(r[5637]|0)+1,s=Zl((e<<2|3)+16|0)|0,(s|0)!=0):0){r[(s+4+15&-16)+-4>>2]=s;a=s+4+15&-16}else a=0;s=r[t+108>>2]|0;o=r[t+116>>2]|0;if((s|0)<=0)if(!o)i=t+120|0;else l=21;else{i=0;do{r[a+(i<<2)>>2]=r[o+(i<<2)>>2];i=i+1|0}while((i|0)!=(s|0));l=21}if((l|0)==21){if(n[t+120>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+116>>2]=0;i=t+120|0}n[i>>0]=1;r[t+116>>2]=a;r[t+112>>2]=e;return}function mv(t,e){t=t|0;e=e|0;var i=0,o=0,a=0,l=0,h=0;if(!(n[t+164>>0]|0)){if((r[t+152>>2]|0)>=(e|0))return;if((e|0)!=0?(r[5637]=(r[5637]|0)+1,o=Zl((e<<1)+19|0)|0,(o|0)!=0):0){r[(o+4+15&-16)+-4>>2]=o;l=o+4+15&-16}else l=0;o=r[t+148>>2]|0;a=r[t+156>>2]|0;if((o|0)<=0)if(!a)i=t+160|0;else h=22;else{i=0;do{s[l+(i<<1)>>1]=s[a+(i<<1)>>1]|0;i=i+1|0}while((i|0)!=(o|0));h=22}if((h|0)==22){if(n[t+160>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+156>>2]=0;i=t+160|0}n[i>>0]=1;r[t+156>>2]=l;r[t+152>>2]=e;return}else{if((r[t+132>>2]|0)>=(e|0))return;if((e|0)!=0?(r[5637]=(r[5637]|0)+1,i=Zl((e<<2|3)+16|0)|0,(i|0)!=0):0){r[(i+4+15&-16)+-4>>2]=i;l=i+4+15&-16}else l=0;o=r[t+128>>2]|0;a=r[t+136>>2]|0;if((o|0)<=0)if(!a)i=t+140|0;else h=10;else{i=0;do{r[l+(i<<2)>>2]=r[a+(i<<2)>>2];i=i+1|0}while((i|0)!=(o|0));h=10}if((h|0)==10){if(n[t+140>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+136>>2]=0;i=t+140|0}n[i>>0]=1;r[t+136>>2]=l;r[t+132>>2]=e;return}}function gv(t,e,i){t=t|0;e=e|0;i=i|0;var o=0,a=0,l=0;r[t+4>>2]=1065353216;r[t+8>>2]=1065353216;r[t+12>>2]=1065353216;h[t+16>>2]=0.0;n[t+36>>0]=1;r[t+32>>2]=0;r[t+24>>2]=0;r[t+28>>2]=0;r[t+48>>2]=0;r[t>>2]=6624;n[t+100>>0]=1;r[t+96>>2]=0;r[t+88>>2]=0;r[t+92>>2]=0;n[t+120>>0]=1;r[t+116>>2]=0;r[t+108>>2]=0;r[t+112>>2]=0;n[t+140>>0]=1;r[t+136>>2]=0;r[t+128>>2]=0;r[t+132>>2]=0;n[t+160>>0]=1;r[t+156>>2]=0;r[t+148>>2]=0;r[t+152>>2]=0;n[t+164>>0]=e&1;n[t+165>>0]=i&1;h[t+168>>2]=0.0;r[5637]=(r[5637]|0)+1;e=Zl(51)|0;if(!e)o=0;else{r[(e+4+15&-16)+-4>>2]=e;o=e+4+15&-16}e=r[t+24>>2]|0;if((e|0)>0){i=0;do{a=o+(i<<5)|0;l=(r[t+32>>2]|0)+(i<<5)|0;r[a>>2]=r[l>>2];r[a+4>>2]=r[l+4>>2];r[a+8>>2]=r[l+8>>2];r[a+12>>2]=r[l+12>>2];r[a+16>>2]=r[l+16>>2];r[a+20>>2]=r[l+20>>2];r[a+24>>2]=r[l+24>>2];r[a+28>>2]=r[l+28>>2];i=i+1|0}while((i|0)!=(e|0))}e=r[t+32>>2]|0;if(e|0){if(n[t+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+32>>2]=0}n[t+36>>0]=1;r[t+32>>2]=o;r[t+28>>2]=1;e=r[t+24>>2]|0;r[o+(e<<5)>>2]=0;r[o+(e<<5)+4>>2]=0;r[o+(e<<5)+8>>2]=12;r[o+(e<<5)+12>>2]=0;r[o+(e<<5)+16>>2]=0;r[o+(e<<5)+20>>2]=16;r[o+(e<<5)+24>>2]=2;r[o+(e<<5)+28>>2]=0;r[t+24>>2]=(r[t+24>>2]|0)+1;e=s[t+164>>1]|0;if(!((e&255)<<24>>24)){i=r[t+32>>2]|0;r[i>>2]=(r[t+148>>2]|0)/3|0;r[i+4>>2]=0;r[i+24>>2]=3;r[i+8>>2]=6}else{i=r[t+32>>2]|0;r[i>>2]=(r[t+128>>2]|0)/3|0;r[i+4>>2]=0;r[i+24>>2]=2;r[i+8>>2]=12}if((e&65535)<256){a=12;t=(r[t+108>>2]|0)/3|0;l=i+12|0;r[l>>2]=t;l=i+16|0;r[l>>2]=0;l=i+20|0;r[l>>2]=a;return}else{a=16;t=r[t+88>>2]|0;l=i+12|0;r[l>>2]=t;l=i+16|0;r[l>>2]=0;l=i+20|0;r[l>>2]=a;return}}function bv(t,e){t=t|0;e=e|0;var i=0,o=0,a=0,l=0,h=0,c=0;if(!(n[t+164>>0]|0)){i=r[t+148>>2]|0;if((i|0)==(r[t+152>>2]|0)?(c=i|0?i<<1:1,(i|0)<(c|0)):0){if(!c)l=0;else{r[5637]=(r[5637]|0)+1;i=Zl((c<<1)+19|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}l=i;i=r[t+148>>2]|0}a=r[t+156>>2]|0;if((i|0)<=0)if(!a)i=t+160|0;else o=27;else{o=0;do{s[l+(o<<1)>>1]=s[a+(o<<1)>>1]|0;o=o+1|0}while((o|0)!=(i|0));o=27}if((o|0)==27){if(n[t+160>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+156>>2]=0;i=t+160|0}n[i>>0]=1;r[t+156>>2]=l;r[t+152>>2]=c;i=r[t+148>>2]|0}c=r[t+156>>2]|0;s[c+(i<<1)>>1]=e;r[t+148>>2]=i+1;r[(r[t+32>>2]|0)+4>>2]=c;return}else{i=r[t+128>>2]|0;if((i|0)==(r[t+132>>2]|0)?(h=i|0?i<<1:1,(i|0)<(h|0)):0){if(!h)l=0;else{r[5637]=(r[5637]|0)+1;i=Zl((h<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}l=i;i=r[t+128>>2]|0}a=r[t+136>>2]|0;if((i|0)<=0)if(!a)i=t+140|0;else o=12;else{o=0;do{r[l+(o<<2)>>2]=r[a+(o<<2)>>2];o=o+1|0}while((o|0)!=(i|0));o=12}if((o|0)==12){if(n[t+140>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+136>>2]=0;i=t+140|0}n[i>>0]=1;r[t+136>>2]=l;r[t+132>>2]=h;i=r[t+128>>2]|0}c=r[t+136>>2]|0;r[c+(i<<2)>>2]=e;r[t+128>>2]=(r[t+128>>2]|0)+1;r[(r[t+32>>2]|0)+4>>2]=c;return}}function yv(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0,l=0.0,c=0.0,_=0.0,u=0.0,d=0,p=0,f=0.0,m=0.0,g=0.0;if(n[t+165>>0]|0){s=r[t+88>>2]|0;t:do{if((s|0)>0&i){o=r[t+96>>2]|0;u=+h[e>>2];l=+h[e+4>>2];c=+h[e+8>>2];_=+h[t+168>>2];i=0;while(1){g=+h[o+(i<<4)>>2]-u;m=+h[o+(i<<4)+4>>2]-l;f=+h[o+(i<<4)+8>>2]-c;if(g*g+m*m+f*f<=_)break;i=i+1|0;if((i|0)>=(s|0))break t}return i|0}}while(0);p=(r[t+32>>2]|0)+12|0;r[p>>2]=(r[p>>2]|0)+1;if((s|0)==(r[t+92>>2]|0)?(a=s|0?s<<1:1,(s|0)<(a|0)):0){if(!a)i=0;else{r[5637]=(r[5637]|0)+1;i=Zl((a<<4|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}s=r[t+88>>2]|0}if((s|0)>0){o=0;do{p=i+(o<<4)|0;d=(r[t+96>>2]|0)+(o<<4)|0;r[p>>2]=r[d>>2];r[p+4>>2]=r[d+4>>2];r[p+8>>2]=r[d+8>>2];r[p+12>>2]=r[d+12>>2];o=o+1|0}while((o|0)!=(s|0))}s=r[t+96>>2]|0;if(s|0){if(n[t+100>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[t+96>>2]=0}n[t+100>>0]=1;r[t+96>>2]=i;r[t+92>>2]=a;i=r[t+88>>2]|0}else i=s;p=(r[t+96>>2]|0)+(i<<4)|0;r[p>>2]=r[e>>2];r[p+4>>2]=r[e+4>>2];r[p+8>>2]=r[e+8>>2];r[p+12>>2]=r[e+12>>2];e=r[t+88>>2]|0;r[t+88>>2]=e+1;r[(r[t+32>>2]|0)+16>>2]=r[t+96>>2];return e|0}o=r[t+108>>2]|0;t:do{if((o|0)>0&i){i=r[t+116>>2]|0;l=+h[e>>2];c=+h[e+4>>2];_=+h[e+8>>2];u=+h[t+168>>2];a=0;while(1){f=+h[i+(a<<2)>>2]-l;m=+h[i+(a+1<<2)>>2]-c;g=+h[i+(a+2<<2)>>2]-_;s=a+3|0;if(f*f+m*m+g*g<=u)break;if((s|0)<(o|0))a=s;else break t}e=(a|0)/3|0;return e|0}}while(0);i=r[t+112>>2]|0;if((o|0)==(i|0)){d=o|0?o<<1:1;if((o|0)<(d|0)){if(!d)i=0;else{r[5637]=(r[5637]|0)+1;i=Zl((d<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=r[t+108>>2]|0}a=r[t+116>>2]|0;if((o|0)<=0)if(!a)s=t+120|0;else p=34;else{s=0;do{r[i+(s<<2)>>2]=r[a+(s<<2)>>2];s=s+1|0}while((s|0)!=(o|0));p=34}if((p|0)==34){if(n[t+120>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+116>>2]=0;s=t+120|0}n[s>>0]=1;r[t+116>>2]=i;r[t+112>>2]=d;s=r[t+108>>2]|0;o=d}else s=o}else{s=o;o=i}r[(r[t+116>>2]|0)+(s<<2)>>2]=r[e>>2];i=s+1|0;r[t+108>>2]=i;if((i|0)==(o|0)){d=o|0?o<<1:1;if((o|0)<(d|0)){if(!d)i=0;else{r[5637]=(r[5637]|0)+1;i=Zl((d<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=r[t+108>>2]|0}a=r[t+116>>2]|0;if((o|0)<=0)if(!a)s=t+120|0;else p=48;else{s=0;do{r[i+(s<<2)>>2]=r[a+(s<<2)>>2];s=s+1|0}while((s|0)!=(o|0));p=48}if((p|0)==48){if(n[t+120>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+116>>2]=0;s=t+120|0}n[s>>0]=1;r[t+116>>2]=i;r[t+112>>2]=d;i=r[t+108>>2]|0;o=d}else i=o}r[(r[t+116>>2]|0)+(i<<2)>>2]=r[e+4>>2];i=i+1|0;r[t+108>>2]=i;if((i|0)==(o|0)){d=o|0?o<<1:1;if((o|0)<(d|0)){if(!d)i=0;else{r[5637]=(r[5637]|0)+1;i=Zl((d<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=r[t+108>>2]|0}a=r[t+116>>2]|0;if((o|0)<=0)if(!a)s=t+120|0;else p=62;else{s=0;do{r[i+(s<<2)>>2]=r[a+(s<<2)>>2];s=s+1|0}while((s|0)!=(o|0));p=62}if((p|0)==62){if(n[t+120>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+116>>2]=0;s=t+120|0}n[s>>0]=1;r[t+116>>2]=i;r[t+112>>2]=d;i=r[t+108>>2]|0}else i=o}p=r[t+116>>2]|0;r[p+(i<<2)>>2]=r[e+8>>2];e=i+1|0;r[t+108>>2]=e;t=r[t+32>>2]|0;r[t+12>>2]=(r[t+12>>2]|0)+1;r[t+16>>2]=p;e=((e|0)/3|0)+-1|0;return e|0}function vv(t){t=t|0;return}function Sv(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function xv(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0;p=(+h[t+36>>2]-+h[t+20>>2])*.5;_=(+h[t+40>>2]-+h[t+24>>2])*.5;a=(+h[t+44>>2]-+h[t+28>>2])*.5;d=+xk[r[(r[t>>2]|0)+48>>2]&15](t);c=+xk[r[(r[t>>2]|0)+48>>2]&15](t);a=a+ +xk[r[(r[t>>2]|0)+48>>2]&15](t);E=(+h[t+36>>2]+ +h[t+20>>2])*.5;T=(+h[t+40>>2]+ +h[t+24>>2])*.5;w=(+h[t+44>>2]+ +h[t+28>>2])*.5;P=+h[e>>2];x=+W(+P);I=+h[e+4>>2];S=+W(+I);y=+h[e+8>>2];v=+W(+y);R=+h[e+16>>2];b=+W(+R);M=+h[e+20>>2];g=+W(+M);f=+h[e+24>>2];m=+W(+f);A=+h[e+32>>2];u=+W(+A);C=+h[e+36>>2];l=+W(+C);s=+h[e+40>>2];o=+W(+s);y=E*P+T*I+w*y+ +h[e+48>>2];f=E*R+T*M+w*f+ +h[e+52>>2];s=E*A+T*C+w*s+ +h[e+56>>2];h[i>>2]=y-((p+d)*x+(_+c)*S+a*v);h[i+4>>2]=f-((p+d)*b+(_+c)*g+a*m);h[i+8>>2]=s-((p+d)*u+(_+c)*l+a*o);h[i+12>>2]=0.0;h[n>>2]=(p+d)*x+(_+c)*S+a*v+y;h[n+4>>2]=(p+d)*b+(_+c)*g+a*m+f;h[n+8>>2]=(p+d)*u+(_+c)*l+a*o+s;h[n+12>>2]=0.0;return}function wv(t,e){t=t|0;e=e|0;var i=0,n=0;i=_;_=_+48|0;n=(r[t+52>>2]|0)+4|0;r[n>>2]=r[e>>2];r[n+4>>2]=r[e+4>>2];r[n+8>>2]=r[e+8>>2];r[n+12>>2]=r[e+12>>2];r[i+32>>2]=0;r[i+32+4>>2]=0;r[i+32+8>>2]=0;r[i+32+12>>2]=0;h[i+32>>2]=1.0;Vk[r[(r[t>>2]|0)+68>>2]&127](i+16|0,t,i+32|0);h[t+36>>2]=+h[i+16>>2]+ +h[t+16>>2];h[i+32>>2]=-1.0;Vk[r[(r[t>>2]|0)+68>>2]&127](i,t,i+32|0);r[i+16>>2]=r[i>>2];r[i+16+4>>2]=r[i+4>>2];r[i+16+8>>2]=r[i+8>>2];r[i+16+12>>2]=r[i+12>>2];h[t+20>>2]=+h[i+16>>2]-+h[t+16>>2];r[i+32>>2]=0;r[i+32+4>>2]=0;r[i+32+8>>2]=0;r[i+32+12>>2]=0;h[i+32+4>>2]=1.0;Vk[r[(r[t>>2]|0)+68>>2]&127](i+16|0,t,i+32|0);h[t+40>>2]=+h[i+16+4>>2]+ +h[t+16>>2];h[i+32+4>>2]=-1.0;Vk[r[(r[t>>2]|0)+68>>2]&127](i,t,i+32|0);r[i+16>>2]=r[i>>2];r[i+16+4>>2]=r[i+4>>2];r[i+16+8>>2]=r[i+8>>2];r[i+16+12>>2]=r[i+12>>2];h[t+24>>2]=+h[i+16+4>>2]-+h[t+16>>2];r[i+32>>2]=0;r[i+32+4>>2]=0;r[i+32+8>>2]=0;r[i+32+12>>2]=0;h[i+32+8>>2]=1.0;Vk[r[(r[t>>2]|0)+68>>2]&127](i+16|0,t,i+32|0);h[t+44>>2]=+h[i+16+8>>2]+ +h[t+16>>2];h[i+32+8>>2]=-1.0;Vk[r[(r[t>>2]|0)+68>>2]&127](i,t,i+32|0);r[i+16>>2]=r[i>>2];r[i+16+4>>2]=r[i+4>>2];r[i+16+8>>2]=r[i+8>>2];r[i+16+12>>2]=r[i+12>>2];h[t+28>>2]=+h[i+16+8>>2]-+h[t+16>>2];_=i;return}function Cv(t){t=t|0;return(r[t+52>>2]|0)+4|0}function Tv(t,e,i){t=t|0;e=+e;i=i|0;r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;r[i+12>>2]=0;return}function Av(t){t=t|0;return 14302}function Ev(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0;s=_;_=_+48|0;r[s>>2]=6776;r[s+4>>2]=e;r[s+8>>2]=r[i>>2];r[s+8+4>>2]=r[i+4>>2];r[s+8+8>>2]=r[i+8>>2];r[s+8+12>>2]=r[i+12>>2];r[s+24>>2]=r[n>>2];r[s+24+4>>2]=r[n+4>>2];r[s+24+8>>2]=r[n+8>>2];r[s+24+12>>2]=r[n+12>>2];t=r[t+52>>2]|0;jk[r[(r[t>>2]|0)+8>>2]&127](t,s,i,n);_=s;return}function Mv(t){t=t|0;Ql(t);return}function Rv(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0;s=+h[e>>2];o=+h[e+16>>2];l=s<o?s:o;a=+h[e+32>>2];if((l<a?l:a)>+h[t+24>>2])return;c=s>o?e:e+16|0;if(+h[(+h[c>>2]>a?c:e+32|0)>>2]<+h[t+8>>2])return;s=+h[e+8>>2];o=+h[e+24>>2];l=s<o?s:o;a=+h[e+40>>2];if((l<a?l:a)>+h[t+32>>2])return;c=s>o?e+8|0:e+24|0;if(+h[(+h[c>>2]>a?c:e+40|0)>>2]<+h[t+16>>2])return;s=+h[e+4>>2];o=+h[e+20>>2];l=s<o?s:o;a=+h[e+36>>2];if((l<a?l:a)>+h[t+28>>2])return;c=s>o?e+4|0:e+20|0;if(+h[(+h[c>>2]>a?c:e+36|0)>>2]<+h[t+12>>2])return;c=r[t+4>>2]|0;jk[r[(r[c>>2]|0)+8>>2]&127](c,e,i,n);return}function Iv(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0.0,a=0.0,l=0.0;n=_;_=_+160|0;r[n+136>>2]=0;r[n+136+4>>2]=0;r[n+136+8>>2]=0;r[n+136+12>>2]=0;r[n+136+16>>2]=0;r[n+32>>2]=6796;s=n+32+4|0;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;r[n+32+20>>2]=1065353216;r[n+32+24>>2]=0;r[n+32+24+4>>2]=0;r[n+32+24+8>>2]=0;r[n+32+24+12>>2]=0;r[n+32+40>>2]=1065353216;r[n+32+44>>2]=0;r[n+32+44+4>>2]=0;r[n+32+44+8>>2]=0;r[n+32+44+12>>2]=0;r[n+32+60>>2]=1065353216;r[n+32+64>>2]=0;r[n+32+68>>2]=r[n+136+4>>2];r[n+32+68+4>>2]=r[n+136+4+4>>2];r[n+32+68+8>>2]=r[n+136+4+8>>2];r[n+32+68+12>>2]=r[n+136+4+12>>2];h[n+32+84>>2]=-999999984306749440.0;l=+h[i>>2];a=+h[i+4>>2];o=+h[i+8>>2];h[n+32+88>>2]=l+a*0.0+o*0.0;h[n+32+92>>2]=l*0.0+a+o*0.0;h[n+32+96>>2]=l*0.0+a*0.0+o;h[n+32+100>>2]=0.0;r[n+16>>2]=1566444395;r[n+16+4>>2]=1566444395;r[n+16+8>>2]=1566444395;h[n+16+12>>2]=0.0;i=r[(r[e>>2]|0)+64>>2]|0;h[n>>2]=-999999984306749440.0;h[n+4>>2]=-999999984306749440.0;h[n+8>>2]=-999999984306749440.0;h[n+12>>2]=0.0;jk[i&127](e,n+32|0,n,n+16|0);r[t>>2]=r[s>>2];r[t+4>>2]=r[s+4>>2];r[t+8>>2]=r[s+8>>2];r[t+12>>2]=r[s+12>>2];_=n;return}function Pv(t){t=t|0;Ql(t);return}function Lv(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0;l=+h[t+88>>2];c=+h[t+92>>2];a=+h[t+96>>2];s=l*+h[e>>2]+c*+h[e+4>>2]+a*+h[e+8>>2];o=+h[t+84>>2];if(s>o){h[t+84>>2]=s;r[t+4>>2]=r[e>>2];r[t+4+4>>2]=r[e+4>>2];r[t+4+8>>2]=r[e+8>>2];r[t+4+12>>2]=r[e+12>>2]}else s=o;o=l*+h[e+16>>2]+c*+h[e+20>>2]+a*+h[e+24>>2];if(o>s){h[t+84>>2]=o;r[t+4>>2]=r[e+16>>2];r[t+4+4>>2]=r[e+16+4>>2];r[t+4+8>>2]=r[e+16+8>>2];r[t+4+12>>2]=r[e+16+12>>2]}else o=s;s=l*+h[e+32>>2]+c*+h[e+36>>2]+a*+h[e+40>>2];if(!(s>o))return;h[t+84>>2]=s;r[t+4>>2]=r[e+32>>2];r[t+4+4>>2]=r[e+32+4>>2];r[t+4+8>>2]=r[e+32+8>>2];r[t+4+12>>2]=r[e+32+12>>2];return}function Dv(t){t=t|0;Ql(t);return}function kv(t,e,i,s,o,a){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;var l=0,c=0.0,u=0,p=0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0,R=0;M=_;_=_+304|0;E=+h[i+48>>2]-+h[e+48>>2];T=+h[i+52>>2]-+h[e+52>>2];A=+h[i+56>>2]-+h[e+56>>2];qx(e,i,M+288|0,M+240|0);S=+h[M+240>>2];y=+h[M+288>>2]*S;v=S*+h[M+288+4>>2];S=S*+h[M+288+8>>2];h[M+224>>2]=y;h[M+224+4>>2]=v;h[M+224+8>>2]=S;h[M+224+12>>2]=0.0;x=+h[o+48>>2]-+h[s+48>>2];w=+h[o+52>>2]-+h[s+52>>2];C=+h[o+56>>2]-+h[s+56>>2];qx(s,o,M+288|0,M+240|0);g=+h[M+240>>2];f=+h[M+288>>2]*g;m=g*+h[M+288+4>>2];g=g*+h[M+288+8>>2];h[M+192>>2]=f;h[M+192+4>>2]=m;h[M+192+8>>2]=g;h[M+192+12>>2]=0.0;i=r[t+12>>2]|0;b=+xk[r[(r[i>>2]|0)+16>>2]&15](i);i=r[t+16>>2]|0;if(!i)c=0.0;else c=+xk[r[(r[i>>2]|0)+16>>2]&15](i);b=b*+G(+(y*y+v*v+S*S))+c*+G(+(f*f+m*m+g*g));if(b+ +G(+((x-E)*(x-E)+(w-T)*(w-T)+(C-A)*(C-A)))==0.0){a=0;_=M;return a|0}r[M+240>>2]=6836;h[M+240+36>>2]=999999984306749440.0;n[M+240+40>>0]=0;Uv(t,e,s,M+240|0);o=(n[M+240+40>>0]|0)==0;r[M+288>>2]=r[M+240+20>>2];r[M+288+4>>2]=r[M+240+20+4>>2];r[M+288+8>>2]=r[M+240+20+8>>2];r[M+288+12>>2]=r[M+240+20+12>>2];t:do{if(!o?(p=r[M+240+4>>2]|0,l=r[M+240+8>>2]|0,u=r[M+240+12>>2]|0,S=(x-E)*(r[d>>2]=p,+h[d>>2]),S=S+(w-T)*(r[d>>2]=l,+h[d>>2]),!(b+(S+(C-A)*(r[d>>2]=u,+h[d>>2]))<=1.1920928955078125e-07)):0){c=+h[M+240+16>>2];f=+h[M+240+36>>2]+ +h[a+172>>2];e:do{if(f>1.0000000474974513e-03){m=f;g=0.0;o=0;while(1){i=r[a+168>>2]|0;if(i|0){R=r[(r[i>>2]|0)+28>>2]|0;r[M+208>>2]=1065353216;r[M+208+4>>2]=1065353216;r[M+208+8>>2]=1065353216;h[M+208+12>>2]=0.0;_k[R&7](i,M+288|0,.20000000298023224,M+208|0)}c=(x-E)*(r[d>>2]=p,+h[d>>2]);c=c+(w-T)*(r[d>>2]=l,+h[d>>2]);c=b+(c+(C-A)*(r[d>>2]=u,+h[d>>2]));if(c<=1.1920928955078125e-07){l=0;break t}f=g+m/c;if(!(!(f<=g)&(!(f<0.0)&!(f>1.0)))){l=0;break t}Vv(e,E,T,A,M+224|0,f,M+112|0);Vv(s,x,w,C,M+192|0,f,M+48|0);l=r[a+168>>2]|0;if(l|0){R=r[(r[l>>2]|0)+28>>2]|0;r[M+176>>2]=1065353216;r[M+176+4>>2]=0;r[M+176+8>>2]=0;h[M+176+12>>2]=0.0;_k[R&7](l,M+112+48|0,.20000000298023224,M+176|0)}rk[r[r[a>>2]>>2]&31](a,f);r[M>>2]=6836;h[M+36>>2]=999999984306749440.0;n[M+40>>0]=0;Uv(t,M+112|0,M+48|0,M);if(!(n[M+40>>0]|0)){l=15;break}c=+h[M+36>>2];m=+h[a+172>>2];r[M+288>>2]=r[M+20>>2];r[M+288+4>>2]=r[M+20+4>>2];r[M+288+8>>2]=r[M+20+8>>2];r[M+288+12>>2]=r[M+20+12>>2];i=o+1|0;if((o|0)>63){l=16;break}u=r[M+12>>2]|0;l=r[M+8>>2]|0;p=r[M+4>>2]|0;m=c+m;if(!(m>1.0000000474974513e-03)){c=+h[M+16>>2];break e}else{g=f;o=i}}if((l|0)==15)Vk[r[(r[a>>2]|0)+8>>2]&127](a,-1,o);else if((l|0)==16)Vk[r[(r[a>>2]|0)+8>>2]&127](a,-2,i);l=0;break t}else f=0.0}while(0);h[a+164>>2]=f;r[a+132>>2]=p;r[a+136>>2]=l;r[a+140>>2]=u;h[a+144>>2]=c;r[a+148>>2]=r[M+288>>2];r[a+148+4>>2]=r[M+288+4>>2];r[a+148+8>>2]=r[M+288+8>>2];r[a+148+12>>2]=r[M+288+12>>2];l=1}else l=0}while(0);R=l;_=M;return R|0}function Ov(t){t=t|0;Ql(t);return}function Fv(t,e,i){t=t|0;e=e|0;i=i|0;return}function Bv(t,e,i){t=t|0;e=e|0;i=i|0;return}function Nv(t,e,i,s){t=t|0;e=e|0;i=i|0;s=+s;if(!(+h[t+36>>2]>s))return;n[t+40>>0]=1;r[t+4>>2]=r[e>>2];r[t+4+4>>2]=r[e+4>>2];r[t+4+8>>2]=r[e+8>>2];r[t+4+12>>2]=r[e+12>>2];r[t+20>>2]=r[i>>2];r[t+20+4>>2]=r[i+4>>2];r[t+20+8>>2]=r[i+8>>2];r[t+20+12>>2]=r[i+12>>2];h[t+36>>2]=s;return}function Uv(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0,B=0,N=0,U=0,V=0;o=_;_=_+256|0;if(!(r[t+16>>2]|0)){F=r[t+12>>2]|0;t=r[t+20>>2]|0;d=+h[e>>2];m=+h[e+4>>2];v=+h[e+8>>2];l=+h[e+16>>2];g=+h[e+20>>2];a=+h[e+24>>2];u=+h[e+32>>2];b=+h[e+36>>2];c=+h[e+40>>2];P=+h[e+48>>2];I=+h[e+52>>2];R=+h[e+56>>2];O=+h[i>>2];k=+h[i+16>>2];C=+h[i+32>>2];D=+h[i+4>>2];L=+h[i+20>>2];x=+h[i+36>>2];S=+h[i+8>>2];T=+h[i+24>>2];w=+h[i+40>>2];M=-+h[i+48>>2];E=-+h[i+52>>2];f=-+h[i+56>>2];e=r[(r[F>>2]|0)+64>>2]|0;A=-+h[t+52>>2];y=-+h[t+56>>2];p=-+h[t+60>>2];h[o+16>>2]=(d*O+l*k+u*C)*A+(d*D+l*L+u*x)*y+(d*S+l*T+u*w)*p;h[o+16+4>>2]=(m*O+g*k+b*C)*A+(m*D+g*L+b*x)*y+(m*S+g*T+b*w)*p;h[o+16+8>>2]=(v*O+a*k+c*C)*A+(v*D+a*L+c*x)*y+(v*S+a*T+c*w)*p;h[o+16+12>>2]=0.0;Vk[e&127](o+168|0,F,o+16|0);p=+h[o+168>>2];y=+h[o+168+4>>2];A=+h[o+168+8>>2];C=P*O+I*k+R*C+(O*M+k*E+C*f)+((d*O+l*k+u*C)*p+(m*O+g*k+b*C)*y+(v*O+a*k+c*C)*A);x=P*D+I*L+R*x+(D*M+L*E+x*f)+((d*D+l*L+u*x)*p+(m*D+g*L+b*x)*y+(v*D+a*L+c*x)*A);A=P*S+I*T+R*w+(S*M+T*E+w*f)+((d*S+l*T+u*w)*p+(m*S+g*T+b*w)*y+(v*S+a*T+c*w)*A);w=+h[t+52>>2];c=+h[t+56>>2];T=+h[t+60>>2];a=T*A+(w*C+c*x)-+h[t+68>>2];S=+h[i>>2];v=+h[i+4>>2];y=+h[i+8>>2];b=+h[i+16>>2];g=+h[i+20>>2];m=+h[i+24>>2];p=+h[i+32>>2];u=+h[i+36>>2];l=+h[i+40>>2];d=(C-w*a)*b+(x-c*a)*g+(A-T*a)*m+ +h[i+52>>2];f=(C-w*a)*p+(x-c*a)*u+(A-T*a)*l+ +h[i+56>>2];h[o+32>>2]=y*(A-T*a)+(S*(C-w*a)+v*(x-c*a))+ +h[i+48>>2];h[o+32+4>>2]=d;h[o+32+8>>2]=f;h[o+32+12>>2]=0.0;f=+h[t+52>>2];d=+h[t+56>>2];c=+h[t+60>>2];h[o>>2]=S*f+v*d+y*c;h[o+4>>2]=f*b+d*g+c*m;h[o+8>>2]=f*p+d*u+c*l;h[o+12>>2]=0.0;Uk[r[(r[s>>2]|0)+16>>2]&15](s,o,o+32|0,a);_=o;return}else{U=r[t+4>>2]|0;n[U+312>>0]=0;r[U>>2]=0;n[U+356>>0]=1;r[U+292>>2]=1566444395;r[U+296>>2]=1566444395;r[U+300>>2]=1566444395;h[U+304>>2]=0.0;r[U+336>>2]=0;r[U+336+4>>2]=0;r[U+336+8>>2]=0;r[U+336+12>>2]=0;n[U+336+16>>0]=0;n[U+332>>0]=n[U+332>>0]&-16;U=r[t+12>>2]|0;N=r[t+16>>2]|0;B=r[U+4>>2]|0;F=r[N+4>>2]|0;k=+xk[r[(r[U>>2]|0)+48>>2]&15](U);V=r[t+16>>2]|0;O=+xk[r[(r[V>>2]|0)+48>>2]&15](V);V=r[t+4>>2]|0;t=r[t+8>>2]|0;r[o+168>>2]=6928;r[o+168+4>>2]=0;r[o+168+8>>2]=1065353216;r[o+168+12>>2]=0;h[o+168+16>>2]=0.0;r[o+168+20>>2]=t;r[o+168+24>>2]=V;r[o+168+28>>2]=U;r[o+168+32>>2]=N;r[o+168+36>>2]=B;r[o+168+40>>2]=F;h[o+168+44>>2]=k;h[o+168+48>>2]=O;n[o+168+52>>0]=0;r[o+168+60>>2]=-1;r[o+168+72>>2]=1;r[o+168+76>>2]=1;h[o+32+128>>2]=999999984306749440.0;r[o+32>>2]=r[e>>2];r[o+32+4>>2]=r[e+4>>2];r[o+32+8>>2]=r[e+8>>2];r[o+32+12>>2]=r[e+12>>2];r[o+32+16>>2]=r[e+16>>2];r[o+32+16+4>>2]=r[e+16+4>>2];r[o+32+16+8>>2]=r[e+16+8>>2];r[o+32+16+12>>2]=r[e+16+12>>2];r[o+32+32>>2]=r[e+32>>2];r[o+32+32+4>>2]=r[e+32+4>>2];r[o+32+32+8>>2]=r[e+32+8>>2];r[o+32+32+12>>2]=r[e+32+12>>2];r[o+32+48>>2]=r[e+48>>2];r[o+32+48+4>>2]=r[e+48+4>>2];r[o+32+48+8>>2]=r[e+48+8>>2];r[o+32+48+12>>2]=r[e+48+12>>2];r[o+32+64>>2]=r[i>>2];r[o+32+64+4>>2]=r[i+4>>2];r[o+32+64+8>>2]=r[i+8>>2];r[o+32+64+12>>2]=r[i+12>>2];r[o+32+80>>2]=r[i+16>>2];r[o+32+80+4>>2]=r[i+16+4>>2];r[o+32+80+8>>2]=r[i+16+8>>2];r[o+32+80+12>>2]=r[i+16+12>>2];r[o+32+96>>2]=r[i+32>>2];r[o+32+96+4>>2]=r[i+32+4>>2];r[o+32+96+8>>2]=r[i+32+8>>2];r[o+32+96+12>>2]=r[i+32+12>>2];r[o+32+112>>2]=r[i+48>>2];r[o+32+112+4>>2]=r[i+48+4>>2];r[o+32+112+8>>2]=r[i+48+8>>2];r[o+32+112+12>>2]=r[i+48+12>>2];nS(o+168|0,o+32|0,s,0,0);_=o;return}}function Vv(t,e,i,n,s,r,o){t=t|0;e=+e;i=+i;n=+n;s=s|0;r=+r;o=o|0;var a=0.0,l=0.0,c=0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0;c=_;_=_+16|0;l=i*r+ +h[t+52>>2];a=n*r+ +h[t+56>>2];h[o+48>>2]=e*r+ +h[t+48>>2];h[o+52>>2]=l;h[o+56>>2]=a;h[o+60>>2]=0.0;a=+h[s>>2];l=+h[s+4>>2];i=+h[s+8>>2];n=+G(+(a*a+l*l+i*i));n=n*r>.7853981852531433?.7853981852531433/r:n;if(n<1.0000000474974513e-03)e=r*.5-n*(r*r*r*.02083333395421505*n);else e=+X(+(n*.5*r))/n;p=a*e;d=l*e;a=i*e;m=+H(+(n*r*.5));Kx(t,c);e=+h[c>>2];f=+h[c+12>>2];i=+h[c+8>>2];r=+h[c+4>>2];g=1.0/+G(+((m*f-p*e-d*r-a*i)*(m*f-p*e-d*r-a*i)+((a*f+m*i+p*r-d*e)*(a*f+m*i+p*r-d*e)+((m*e+p*f+d*i-a*r)*(m*e+p*f+d*i-a*r)+(a*e+(d*f+m*r)-p*i)*(a*e+(d*f+m*r)-p*i)))));n=(m*e+p*f+d*i-a*r)*g;l=g*(a*e+(d*f+m*r)-p*i);u=g*(a*f+m*i+p*r-d*e);i=g*(m*f-p*e-d*r-a*i);a=n*(2.0/(i*i+(u*u+(n*n+l*l))));r=l*(2.0/(i*i+(u*u+(n*n+l*l))));e=u*(2.0/(i*i+(u*u+(n*n+l*l))));h[o>>2]=1.0-(l*r+u*e);h[o+4>>2]=n*r-i*e;h[o+8>>2]=n*e+i*r;h[o+12>>2]=0.0;h[o+16>>2]=n*r+i*e;h[o+20>>2]=1.0-(n*a+u*e);h[o+24>>2]=l*e-i*a;h[o+28>>2]=0.0;h[o+32>>2]=n*e-i*r;h[o+36>>2]=l*e+i*a;h[o+40>>2]=1.0-(n*a+l*r);h[o+44>>2]=0.0;_=c;return}function zv(t){t=t|0;return}function Wv(t){t=t|0;Ql(t);return}function Gv(t,e,i,s,o,a){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;var l=0.0,c=0,u=0.0,p=0,f=0,m=0,g=0.0,b=0.0,y=0.0,v=0,S=0.0,x=0.0;v=_;_=_+288|0;m=r[t+4>>2]|0;n[m+312>>0]=0;r[m>>2]=0;n[m+356>>0]=1;r[m+292>>2]=1566444395;r[m+296>>2]=1566444395;r[m+300>>2]=1566444395;h[m+304>>2]=0.0;r[m+336>>2]=0;r[m+336+4>>2]=0;r[m+336+8>>2]=0;r[m+336+12>>2]=0;n[m+336+16>>0]=0;n[m+332>>0]=n[m+332>>0]&-16;g=+h[i+48>>2]-+h[e+48>>2]-(+h[o+48>>2]-+h[s+48>>2]);b=+h[i+52>>2]-+h[e+52>>2]-(+h[o+52>>2]-+h[s+52>>2]);y=+h[i+56>>2]-+h[e+56>>2]-(+h[o+56>>2]-+h[s+56>>2]);r[v+216>>2]=6836;h[v+216+36>>2]=999999984306749440.0;n[v+216+40>>0]=0;m=r[t+8>>2]|0;f=r[t+12>>2]|0;p=r[t+4>>2]|0;r[v+136>>2]=6928;r[v+136+4>>2]=0;r[v+136+8>>2]=1065353216;r[v+136+12>>2]=0;h[v+136+16>>2]=0.0;r[v+136+20>>2]=0;r[v+136+24>>2]=p;r[v+136+28>>2]=m;r[v+136+32>>2]=f;r[v+136+36>>2]=r[m+4>>2];r[v+136+40>>2]=r[f+4>>2];h[v+136+44>>2]=+xk[r[(r[m>>2]|0)+48>>2]&15](m);h[v+136+48>>2]=+xk[r[(r[f>>2]|0)+48>>2]&15](f);n[v+136+52>>0]=0;r[v+136+60>>2]=-1;r[v+136+72>>2]=1;r[v+136+76>>2]=1;h[v+128>>2]=999999984306749440.0;r[v>>2]=r[e>>2];r[v+4>>2]=r[e+4>>2];r[v+8>>2]=r[e+8>>2];r[v+12>>2]=r[e+12>>2];r[v+16>>2]=r[e+16>>2];r[v+16+4>>2]=r[e+16+4>>2];r[v+16+8>>2]=r[e+16+8>>2];r[v+16+12>>2]=r[e+16+12>>2];r[v+32>>2]=r[e+32>>2];r[v+32+4>>2]=r[e+32+4>>2];r[v+32+8>>2]=r[e+32+8>>2];r[v+32+12>>2]=r[e+32+12>>2];r[v+48>>2]=r[e+48>>2];r[v+48+4>>2]=r[e+48+4>>2];r[v+48+8>>2]=r[e+48+8>>2];r[v+48+12>>2]=r[e+48+12>>2];r[v+64>>2]=r[s>>2];r[v+64+4>>2]=r[s+4>>2];r[v+64+8>>2]=r[s+8>>2];r[v+64+12>>2]=r[s+12>>2];r[v+80>>2]=r[s+16>>2];r[v+80+4>>2]=r[s+16+4>>2];r[v+80+8>>2]=r[s+16+8>>2];r[v+80+12>>2]=r[s+16+12>>2];r[v+96>>2]=r[s+32>>2];r[v+96+4>>2]=r[s+32+4>>2];r[v+96+8>>2]=r[s+32+8>>2];r[v+96+12>>2]=r[s+32+12>>2];r[v+112>>2]=r[s+48>>2];r[v+112+4>>2]=r[s+48+4>>2];r[v+112+8>>2]=r[s+48+8>>2];r[v+112+12>>2]=r[s+48+12>>2];nS(v+136|0,v,v+216|0,0,0);f=(n[v+216+40>>0]|0)==0;m=v+216+20|0;r[v+264>>2]=r[m>>2];r[v+264+4>>2]=r[m+4>>2];r[v+264+8>>2]=r[m+8>>2];r[v+264+12>>2]=r[m+12>>2];if(f){a=0;_=v;return a|0}u=+h[v+216+36>>2];l=+h[v+216+16>>2];t=r[v+216+12>>2]|0;c=r[v+216+8>>2]|0;p=r[v+216+4>>2]|0;do{if(u>1.0000000474974513e-03){l=0.0;f=0;while(1){if((f|0)>31){t=0;f=13;break}x=g*(r[d>>2]=p,+h[d>>2]);x=b*(r[d>>2]=c,+h[d>>2])+x;S=l;l=l-u/(y*(r[d>>2]=t,+h[d>>2])+x);if(!(!(l<=S)&(!(l<0.0)&!(l>1.0)))){t=0;f=13;break}rk[r[r[a>>2]>>2]&31](a,l);x=1.0-l;h[v+48>>2]=x*+h[e+48>>2]+l*+h[i+48>>2];h[v+52>>2]=x*+h[e+52>>2]+l*+h[i+52>>2];h[v+56>>2]=x*+h[e+56>>2]+l*+h[i+56>>2];h[v+112>>2]=x*+h[s+48>>2]+l*+h[o+48>>2];h[v+116>>2]=x*+h[s+52>>2]+l*+h[o+52>>2];h[v+120>>2]=x*+h[s+56>>2]+l*+h[o+56>>2];nS(v+136|0,v,v+216|0,0,0);if(!(n[v+216+40>>0]|0)){t=0;f=13;break}u=+h[v+216+36>>2];if(u<0.0){f=8;break}r[v+264>>2]=r[m>>2];r[v+264+4>>2]=r[m+4>>2];r[v+264+8>>2]=r[m+8>>2];r[v+264+12>>2]=r[m+12>>2];t=r[v+216+12>>2]|0;c=r[v+216+8>>2]|0;p=r[v+216+4>>2]|0;if(!(u>1.0000000474974513e-03)){f=10;break}else f=f+1|0}if((f|0)==8){h[a+164>>2]=l;s=r[v+216+8>>2]|0;i=r[v+216+12>>2]|0;o=r[v+216+16>>2]|0;r[a+132>>2]=r[v+216+4>>2];r[a+136>>2]=s;r[a+140>>2]=i;r[a+144>>2]=o;r[a+148>>2]=r[m>>2];r[a+148+4>>2]=r[m+4>>2];r[a+148+8>>2]=r[m+8>>2];r[a+148+12>>2]=r[m+12>>2];a=1;_=v;return a|0}else if((f|0)==10){u=l;l=+h[v+216+16>>2];break}else if((f|0)==13){_=v;return t|0}}else u=0.0}while(0);x=g*(r[d>>2]=p,+h[d>>2]);x=b*(r[d>>2]=c,+h[d>>2])+x;if(y*(r[d>>2]=t,+h[d>>2])+x>=-+h[a+172>>2]){a=0;_=v;return a|0}h[a+164>>2]=u;r[a+132>>2]=p;r[a+136>>2]=c;r[a+140>>2]=t;h[a+144>>2]=l;r[a+148>>2]=r[v+264>>2];r[a+148+4>>2]=r[v+264+4>>2];r[a+148+8>>2]=r[v+264+8>>2];r[a+148+12>>2]=r[v+264+12>>2];a=1;_=v;return a|0}function jv(t,e,i,n,s,o){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;var a=0.0,l=0,c=0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0;S=_;_=_+560|0;l=o;c=l+36|0;do{r[l>>2]=0;l=l+4|0}while((l|0)<(c|0));r[S+400>>2]=t;r[S+400+4>>2]=i;p=+h[n>>2];I=+h[e>>2];d=+h[n+16>>2];a=+h[e+16>>2];u=+h[n+32>>2];P=+h[e+32>>2];x=+h[e+4>>2];L=+h[e+20>>2];w=+h[e+36>>2];y=+h[e+8>>2];g=+h[e+24>>2];f=+h[e+40>>2];R=+h[n+4>>2];M=+h[n+20>>2];E=+h[n+36>>2];A=+h[n+8>>2];T=+h[n+24>>2];C=+h[n+40>>2];h[S+400+8>>2]=p*I+d*a+u*P;h[S+400+12>>2]=p*x+d*L+u*w;h[S+400+16>>2]=p*y+d*g+u*f;h[S+400+20>>2]=0.0;h[S+400+24>>2]=I*R+a*M+P*E;h[S+400+28>>2]=x*R+L*M+w*E;h[S+400+32>>2]=y*R+g*M+f*E;h[S+400+36>>2]=0.0;h[S+400+40>>2]=I*A+a*T+P*C;h[S+400+44>>2]=x*A+L*T+w*C;h[S+400+48>>2]=y*A+g*T+f*C;h[S+400+52>>2]=0.0;f=+h[n+48>>2]-+h[e+48>>2];g=+h[n+52>>2]-+h[e+52>>2];y=+h[n+56>>2]-+h[e+56>>2];w=+h[e>>2];L=+h[n>>2];x=+h[e+16>>2];P=+h[n+16>>2];a=+h[e+32>>2];I=+h[n+32>>2];u=+h[e+4>>2];d=+h[e+20>>2];p=+h[e+36>>2];m=+h[e+8>>2];b=+h[e+24>>2];v=+h[e+40>>2];h[S+400+56>>2]=w*L+x*P+a*I;h[S+400+60>>2]=w*R+x*M+a*E;h[S+400+64>>2]=w*A+x*T+a*C;h[S+400+68>>2]=0.0;h[S+400+72>>2]=L*u+P*d+I*p;h[S+400+76>>2]=R*u+M*d+E*p;h[S+400+80>>2]=A*u+T*d+C*p;h[S+400+84>>2]=0.0;h[S+400+88>>2]=L*m+P*b+I*v;h[S+400+92>>2]=R*m+M*b+E*v;h[S+400+96>>2]=A*m+T*b+C*v;h[S+400+100>>2]=0.0;h[S+400+104>>2]=f*w+g*x+y*a;h[S+400+108>>2]=f*u+g*d+y*p;h[S+400+112>>2]=f*m+g*b+y*v;h[S+400+116>>2]=0.0;r[S+400+120>>2]=71;r[S+400+124>>2]=0;r[S+16+364>>2]=0;r[S+16+128>>2]=0;r[S+16+128+4>>2]=0;r[S+16+128+8>>2]=0;r[S+16+128+12>>2]=0;r[S+16+376>>2]=2;r[S+16+368>>2]=0;h[S+16+144>>2]=0.0;s=Hv(S+16|0,S+400|0,s)|0;if(s|0){r[o>>2]=(s|0)==1?1:2;e=0;_=S;return e|0}s=r[S+16+372>>2]|0;if(!(r[s+32>>2]|0)){m=0.0;f=0.0;p=0.0;d=0.0;u=0.0;a=0.0}else{n=0;m=0.0;f=0.0;p=0.0;d=0.0;u=0.0;a=0.0;do{v=+h[s+16+(n<<2)>>2];t=r[S+400+120>>2]|0;c=r[S+400+124>>2]|0;i=(r[S+400>>2]|0)+(c>>1)|0;if(c&1)t=r[(r[i>>2]|0)+t>>2]|0;Vk[t&127](S,i,r[s+(n<<2)>>2]|0);m=m+v*+h[S>>2];p=p+v*+h[S+4>>2];f=f+v*+h[S+8>>2];s=r[(r[S+16+372>>2]|0)+(n<<2)>>2]|0;g=-+h[s>>2];b=-+h[s+4>>2];y=-+h[s+8>>2];s=r[S+400+120>>2]|0;c=r[S+400+124>>2]|0;t=(r[S+400+4>>2]|0)+(c>>1)|0;if(c&1)s=r[(r[t>>2]|0)+s>>2]|0;P=+h[S+400+24>>2]*g+ +h[S+400+28>>2]*b+ +h[S+400+32>>2]*y;I=+h[S+400+40>>2]*g+ +h[S+400+44>>2]*b+ +h[S+400+48>>2]*y;h[S+528>>2]=+h[S+400+8>>2]*g+ +h[S+400+12>>2]*b+ +h[S+400+16>>2]*y;h[S+528+4>>2]=P;h[S+528+8>>2]=I;h[S+528+12>>2]=0.0;Vk[s&127](S+544|0,t,S+528|0);I=+h[S+544>>2];P=+h[S+544+4>>2];L=+h[S+544+8>>2];d=d+v*(I*+h[S+400+56>>2]+P*+h[S+400+60>>2]+L*+h[S+400+64>>2]+ +h[S+400+104>>2]);a=a+v*(I*+h[S+400+72>>2]+P*+h[S+400+76>>2]+L*+h[S+400+80>>2]+ +h[S+400+108>>2]);u=u+v*(I*+h[S+400+88>>2]+P*+h[S+400+92>>2]+L*+h[S+400+96>>2]+ +h[S+400+112>>2]);n=n+1|0;s=r[S+16+372>>2]|0}while(n>>>0<(r[s+32>>2]|0)>>>0)}R=m*+h[e+16>>2]+p*+h[e+20>>2]+f*+h[e+24>>2]+ +h[e+52>>2];I=m*+h[e+32>>2]+p*+h[e+36>>2]+f*+h[e+40>>2]+ +h[e+56>>2];h[o+4>>2]=m*+h[e>>2]+p*+h[e+4>>2]+f*+h[e+8>>2]+ +h[e+48>>2];h[o+8>>2]=R;h[o+12>>2]=I;h[o+16>>2]=0.0;I=d*+h[e+16>>2]+a*+h[e+20>>2]+u*+h[e+24>>2]+ +h[e+52>>2];R=d*+h[e+32>>2]+a*+h[e+36>>2]+u*+h[e+40>>2]+ +h[e+56>>2];h[o+20>>2]=d*+h[e>>2]+a*+h[e+4>>2]+u*+h[e+8>>2]+ +h[e+48>>2];h[o+24>>2]=I;h[o+28>>2]=R;h[o+32>>2]=0.0;R=m-d;I=p-a;L=f-u;h[o+48>>2]=0.0;P=+G(+(R*R+I*I+L*L));h[o+52>>2]=P;P=P>9.999999747378752e-05?1.0/P:1.0;h[o+36>>2]=P*R;h[o+40>>2]=P*I;h[o+44>>2]=P*L;e=1;_=S;return e|0}function Hv(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0,o=0.0,a=0.0,l=0.0,c=0,u=0,p=0.0,f=0.0,m=0.0,g=0.0,b=0,y=0.0,v=0,S=0.0,x=0,w=0,C=0.0,T=0,A=0,E=0.0,M=0.0,R=0.0,I=0.0,P=0;A=_;_=_+176|0;r[t+348>>2]=t+220;r[t+352>>2]=t+252;r[t+356>>2]=t+284;r[t+360>>2]=t+316;r[t+364>>2]=4;r[t+368>>2]=0;r[t+376>>2]=0;w=r[e+4>>2]|0;r[t>>2]=r[e>>2];r[t+4>>2]=w;r[t+8>>2]=r[e+8>>2];r[t+8+4>>2]=r[e+8+4>>2];r[t+8+8>>2]=r[e+8+8>>2];r[t+8+12>>2]=r[e+8+12>>2];r[t+24>>2]=r[e+24>>2];r[t+24+4>>2]=r[e+24+4>>2];r[t+24+8>>2]=r[e+24+8>>2];r[t+24+12>>2]=r[e+24+12>>2];r[t+40>>2]=r[e+40>>2];r[t+40+4>>2]=r[e+40+4>>2];r[t+40+8>>2]=r[e+40+8>>2];r[t+40+12>>2]=r[e+40+12>>2];r[t+56>>2]=r[e+56>>2];r[t+56+4>>2]=r[e+56+4>>2];r[t+56+8>>2]=r[e+56+8>>2];r[t+56+12>>2]=r[e+56+12>>2];r[t+72>>2]=r[e+72>>2];r[t+72+4>>2]=r[e+72+4>>2];r[t+72+8>>2]=r[e+72+8>>2];r[t+72+12>>2]=r[e+72+12>>2];r[t+88>>2]=r[e+88>>2];r[t+88+4>>2]=r[e+88+4>>2];r[t+88+8>>2]=r[e+88+8>>2];r[t+88+12>>2]=r[e+88+12>>2];r[t+104>>2]=r[e+104>>2];r[t+104+4>>2]=r[e+104+4>>2];r[t+104+8>>2]=r[e+104+8>>2];r[t+104+12>>2]=r[e+104+12>>2];w=r[e+124>>2]|0;r[t+120>>2]=r[e+120>>2];r[t+124>>2]=w;h[t+144>>2]=0.0;r[t+180>>2]=0;r[t+128>>2]=r[i>>2];r[t+128+4>>2]=r[i+4>>2];r[t+128+8>>2]=r[i+8>>2];r[t+128+12>>2]=r[i+12>>2];n=+h[t+128>>2];o=+h[t+132>>2];a=+h[t+136>>2];if(n*n+o*o+a*a>0.0){i=(h[d>>2]=-n,r[d>>2]|0);e=(h[d>>2]=-o,r[d>>2]|0);s=(h[d>>2]=-a,r[d>>2]|0)}else{i=1065353216;e=0;s=0}h[t+164>>2]=0.0;r[t+364>>2]=3;r[t+148>>2]=t+316;r[t+180>>2]=1;y=(r[d>>2]=i,+h[d>>2]);S=(r[d>>2]=e,+h[d>>2]);Xv(t,y,S,(r[d>>2]=s,+h[d>>2]),t+316|0);h[t+164>>2]=1.0;x=(r[t+148>>2]|0)+16|0;r[t+128>>2]=r[x>>2];r[t+128+4>>2]=r[x+4>>2];r[t+128+8>>2]=r[x+8>>2];r[t+128+12>>2]=r[x+12>>2];r[A+24+48>>2]=r[x>>2];r[A+24+48+4>>2]=r[x+4>>2];r[A+24+48+8>>2]=r[x+8>>2];r[A+24+48+12>>2]=r[x+12>>2];r[A+24+32>>2]=r[x>>2];r[A+24+32+4>>2]=r[x+4>>2];r[A+24+32+8>>2]=r[x+8>>2];r[A+24+32+12>>2]=r[x+12>>2];r[A+24+16>>2]=r[x>>2];r[A+24+16+4>>2]=r[x+4>>2];r[A+24+16+8>>2]=r[x+8>>2];r[A+24+16+12>>2]=r[x+12>>2];r[A+24>>2]=r[x>>2];r[A+24+4>>2]=r[x+4>>2];r[A+24+8>>2]=r[x+8>>2];r[A+24+12>>2]=r[x+12>>2];S=0.0;x=0;w=0;n=n*n+o*o+a*a;t:do{v=r[t+368>>2]|0;l=+h[t+128>>2];o=+h[t+132>>2];a=+h[t+136>>2];p=+G(+(l*l+o*o+a*a));if(p<9.999999747378752e-05){T=5;break}h[t+148+(v*36|0)+16+(r[t+148+(v*36|0)+32>>2]<<2)>>2]=0.0;i=(r[t+364>>2]|0)+-1|0;r[t+364>>2]=i;r[t+148+(v*36|0)+(r[t+148+(v*36|0)+32>>2]<<2)>>2]=r[t+348+(i<<2)>>2];i=r[t+148+(v*36|0)+32>>2]|0;r[t+148+(v*36|0)+32>>2]=i+1;Xv(t,-l,-o,-a,r[t+148+(v*36|0)+(i<<2)>>2]|0);i=r[t+148+(v*36|0)+32>>2]|0;e=r[t+148+(v*36|0)+(i+-1<<2)>>2]|0;o=+h[e+16>>2];a=+h[e+20>>2];l=+h[e+24>>2];m=o-+h[A+24>>2];g=a-+h[A+24+4>>2];y=l-+h[A+24+8>>2];if(m*m+g*g+y*y<9.999999747378752e-05){T=8;break}m=o-+h[A+24+16>>2];g=a-+h[A+24+20>>2];y=l-+h[A+24+24>>2];if(m*m+g*g+y*y<9.999999747378752e-05){T=8;break}m=o-+h[A+24+32>>2];g=a-+h[A+24+36>>2];y=l-+h[A+24+40>>2];if(m*m+g*g+y*y<9.999999747378752e-05){T=8;break}m=o-+h[A+24+48>>2];g=a-+h[A+24+52>>2];y=l-+h[A+24+56>>2];if(m*m+g*g+y*y<9.999999747378752e-05){T=8;break}x=x+1&3;b=A+24+(x<<4)|0;r[b>>2]=r[e+16>>2];r[b+4>>2]=r[e+16+4>>2];r[b+8>>2]=r[e+16+8>>2];r[b+12>>2]=r[e+16+12>>2];y=(+h[t+128>>2]*o+ +h[t+132>>2]*a+ +h[t+136>>2]*l)/p;S=y>S?y:S;if(p-S-p*9.999999747378752e-05<=0.0){T=9;break}r[A>>2]=0;e:do{switch(i|0){case 2:{b=r[t+148+(v*36|0)>>2]|0;u=r[t+148+(v*36|0)+4>>2]|0;n=+h[u+16>>2];o=+h[b+16>>2];a=+h[u+20>>2];l=+h[b+20>>2];p=+h[u+24>>2];f=+h[b+24>>2];if(!((n-o)*(n-o)+(a-l)*(a-l)+(p-f)*(p-f)>0.0)){T=39;break t}m=-(o*(n-o)+l*(a-l)+f*(p-f))/((n-o)*(n-o)+(a-l)*(a-l)+(p-f)*(p-f));if(m>=1.0){h[A+8>>2]=0.0;h[A+8+4>>2]=1.0;r[A>>2]=2;n=n*n+a*a+p*p;break e}if(!(m<=0.0)){h[A+8+4>>2]=m;h[A+8>>2]=1.0-m;r[A>>2]=3;n=((n-o)*m+o)*((n-o)*m+o)+((a-l)*m+l)*((a-l)*m+l)+((p-f)*m+f)*((p-f)*m+f);break e}else{h[A+8>>2]=1.0;h[A+8+4>>2]=0.0;r[A>>2]=1;n=o*o+l*l+f*f;break e}}case 3:{n=+Yv((r[t+148+(v*36|0)>>2]|0)+16|0,(r[t+148+(v*36|0)+4>>2]|0)+16|0,(r[t+148+(v*36|0)+8>>2]|0)+16|0,A+8|0,A);break}case 4:{s=r[t+148+(v*36|0)>>2]|0;c=r[t+148+(v*36|0)+4>>2]|0;u=r[t+148+(v*36|0)+8>>2]|0;b=r[t+148+(v*36|0)+12>>2]|0;r[A+152>>2]=s+16;r[A+152+4>>2]=c+16;r[A+152+8>>2]=u+16;r[A+152+12>>2]=b+16;a=+h[s+16>>2];l=+h[b+16>>2];n=+h[s+20>>2];p=+h[b+20>>2];o=+h[s+24>>2];f=+h[b+24>>2];h[A+104>>2]=a-l;h[A+104+4>>2]=n-p;h[A+104+8>>2]=o-f;h[A+104+12>>2]=0.0;E=+h[c+16>>2];R=+h[c+20>>2];g=+h[c+24>>2];h[A+104+16>>2]=E-l;h[A+104+20>>2]=R-p;h[A+104+24>>2]=g-f;h[A+104+28>>2]=0.0;m=+h[u+16>>2];I=+h[u+20>>2];M=+h[u+24>>2];h[A+104+32>>2]=m-l;h[A+104+36>>2]=I-p;h[A+104+40>>2]=M-f;h[A+104+44>>2]=0.0;y=(n-p)*(g-f)*(m-l)+(o-f)*(E-l)*(I-p)-(I-p)*((g-f)*(a-l))-(n-p)*(E-l)*(M-f)+(M-f)*((a-l)*(R-p))-(m-l)*((o-f)*(R-p));if(y!=y|0.0!=0.0|y==0.0|!(y*(o*((E-m)*(n-R)-(R-I)*(a-E))+(a*((R-I)*(o-g)-(g-M)*(n-R))+n*((g-M)*(a-E)-(E-m)*(o-g))))<=0.0))n=-1.0;else{r[A+92>>2]=0;r[A+92+4>>2]=0;r[A+92+8>>2]=0;r[A+88>>2]=0;g=n-p;m=o-f;o=a-l;i=0;n=-1.0;while(1){e=r[6876+(i<<2)>>2]|0;M=+h[A+104+(e<<4)+8>>2];R=+h[A+104+(e<<4)+4>>2];I=+h[A+104+(e<<4)>>2];if(y*((g*M-m*R)*l+p*(m*I-M*o)+(R*o-g*I)*f)>0.0?(C=+Yv(r[A+152+(i<<2)>>2]|0,r[A+152+(e<<2)>>2]|0,b+16|0,A+92|0,A+88|0),n<0.0|C<n):0){P=r[A+88>>2]|0;r[A>>2]=(P&2|0?1<<e:0)+(P<<1&8)+(P&1|0?1<<i:0);r[A+8+(i<<2)>>2]=r[A+92>>2];r[A+8+(e<<2)>>2]=r[A+92+4>>2];h[A+8+(r[6876+(e<<2)>>2]<<2)>>2]=0.0;r[A+8+12>>2]=r[A+92+8>>2];n=C}i=i+1|0;if((i|0)==3)break;g=+h[A+104+(i<<4)+4>>2];m=+h[A+104+(i<<4)+8>>2];o=+h[A+104+(i<<4)>>2];l=+h[b+16>>2];p=+h[b+20>>2];f=+h[b+24>>2]}if(n<0.0){r[A>>2]=15;l=+h[u+20>>2];I=+h[c+24>>2];R=+h[b+16>>2];o=+h[u+24>>2];M=+h[c+16>>2];p=+h[b+20>>2];a=+h[u+16>>2];E=+h[b+24>>2];m=+h[c+20>>2];h[A+8>>2]=(l*I*R+o*M*p-p*(I*a)-l*M*E+E*(a*m)-R*(o*m))/y;n=+h[s+20>>2];f=+h[s+24>>2];g=+h[s+16>>2];h[A+8+4>>2]=(n*o*R+f*a*p-p*(o*g)-n*a*E+E*(g*l)-R*(f*l))/y;h[A+8+8>>2]=(m*f*R+I*g*p-p*(f*M)-m*g*E+E*(M*n)-R*(I*n))/y;h[A+8+12>>2]=1.0-((l*I*R+o*M*p-p*(I*a)-l*M*E+E*(a*m)-R*(o*m))/y+(n*o*R+f*a*p-p*(o*g)-n*a*E+E*(g*l)-R*(f*l))/y+(m*f*R+I*g*p-p*(f*M)-m*g*E+E*(M*n)-R*(I*n))/y);n=0.0}}break}default:{}}}while(0);if(!(n>=0.0)){T=39;break}r[t+148+((1-v|0)*36|0)+32>>2]=0;r[t+128>>2]=0;r[t+128+4>>2]=0;r[t+128+8>>2]=0;r[t+128+12>>2]=0;r[t+368>>2]=1-v;i=r[t+148+(v*36|0)+32>>2]|0;e=r[A>>2]|0;if(i|0){u=0;do{s=t+148+(v*36|0)+(u<<2)|0;c=r[s>>2]|0;if(!(e&1<<u)){P=r[t+364>>2]|0;r[t+364>>2]=P+1;r[t+348+(P<<2)>>2]=c}else{r[t+148+((1-v|0)*36|0)+(r[t+148+((1-v|0)*36|0)+32>>2]<<2)>>2]=c;b=r[A+8+(u<<2)>>2]|0;P=r[t+148+((1-v|0)*36|0)+32>>2]|0;r[t+148+((1-v|0)*36|0)+32>>2]=P+1;r[t+148+((1-v|0)*36|0)+16+(P<<2)>>2]=b;P=r[s>>2]|0;M=(r[d>>2]=b,+h[d>>2]);R=M*+h[P+20>>2];I=M*+h[P+24>>2];h[t+128>>2]=+h[P+16>>2]*M+ +h[t+128>>2];h[t+132>>2]=R+ +h[t+132>>2];h[t+136>>2]=I+ +h[t+136>>2]}u=u+1|0}while((u|0)!=(i|0))}if((e|0)==15)r[t+376>>2]=1;w=w+1|0;if(w>>>0>=128){T=38;break}}while(!(r[t+376>>2]|0));if((T|0)==5)r[t+376>>2]=1;else if((T|0)==8){P=r[t+368>>2]|0;T=(r[t+148+(P*36|0)+32>>2]|0)+-1|0;r[t+148+(P*36|0)+32>>2]=T;T=r[t+148+(P*36|0)+(T<<2)>>2]|0;P=r[t+364>>2]|0;r[t+364>>2]=P+1;r[t+348+(P<<2)>>2]=T}else if((T|0)==9){P=r[t+368>>2]|0;T=(r[t+148+(P*36|0)+32>>2]|0)+-1|0;r[t+148+(P*36|0)+32>>2]=T;T=r[t+148+(P*36|0)+(T<<2)>>2]|0;P=r[t+364>>2]|0;r[t+364>>2]=P+1;r[t+348+(P<<2)>>2]=T}else if((T|0)==38)r[t+376>>2]=2;else if((T|0)==39){P=r[t+368>>2]|0;T=(r[t+148+(P*36|0)+32>>2]|0)+-1|0;r[t+148+(P*36|0)+32>>2]=T;T=r[t+148+(P*36|0)+(T<<2)>>2]|0;P=r[t+364>>2]|0;r[t+364>>2]=P+1;r[t+348+(P<<2)>>2]=T}r[t+372>>2]=t+148+((r[t+368>>2]|0)*36|0);i=r[t+376>>2]|0;switch(i|0){case 0:{M=+h[t+128>>2];R=+h[t+132>>2];I=+h[t+136>>2];h[t+144>>2]=+G(+(M*M+R*R+I*I));_=A;return i|0}case 1:{h[t+144>>2]=0.0;_=A;return i|0}default:{_=A;return i|0}}return 0}function Xv(t,e,i,n,s){t=t|0;e=+e;i=+i;n=+n;s=s|0;var o=0,a=0,l=0,c=0,u=0.0,d=0.0;l=_;_=_+48|0;u=1.0/+G(+(e*e+i*i+n*n));h[s>>2]=u*e;h[s+4>>2]=u*i;h[s+8>>2]=u*n;h[s+12>>2]=0.0;o=r[t+120>>2]|0;c=r[t+124>>2]|0;a=(r[t>>2]|0)+(c>>1)|0;if(c&1)o=r[(r[a>>2]|0)+o>>2]|0;Vk[o&127](l,a,s);e=-+h[s>>2];i=-+h[s+4>>2];n=-+h[s+8>>2];o=r[t+120>>2]|0;c=r[t+124>>2]|0;a=(r[t+4>>2]|0)+(c>>1)|0;if(c&1)o=r[(r[a>>2]|0)+o>>2]|0;u=+h[t+24>>2]*e+ +h[t+28>>2]*i+ +h[t+32>>2]*n;d=+h[t+40>>2]*e+ +h[t+44>>2]*i+ +h[t+48>>2]*n;h[l+16>>2]=+h[t+8>>2]*e+ +h[t+12>>2]*i+ +h[t+16>>2]*n;h[l+16+4>>2]=u;h[l+16+8>>2]=d;h[l+16+12>>2]=0.0;Vk[o&127](l+32|0,a,l+16|0);d=+h[l+32>>2];e=+h[l+32+4>>2];i=+h[l+32+8>>2];n=+h[l+4>>2]-(d*+h[t+72>>2]+e*+h[t+76>>2]+i*+h[t+80>>2]+ +h[t+108>>2]);u=+h[l+8>>2]-(d*+h[t+88>>2]+e*+h[t+92>>2]+i*+h[t+96>>2]+ +h[t+112>>2]);h[s+16>>2]=+h[l>>2]-(d*+h[t+56>>2]+e*+h[t+60>>2]+i*+h[t+64>>2]+ +h[t+104>>2]);h[s+20>>2]=n;h[s+24>>2]=u;h[s+28>>2]=0.0;_=l;return}function Yv(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var o=0,a=0,l=0.0,c=0,u=0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0,N=0;B=_;_=_+64|0;r[B+48>>2]=t;r[B+48+4>>2]=e;r[B+48+8>>2]=i;M=+h[t>>2];P=+h[e>>2];O=+h[t+4>>2];F=+h[e+4>>2];T=+h[t+8>>2];A=+h[e+8>>2];h[B>>2]=M-P;h[B+4>>2]=O-F;h[B+8>>2]=T-A;h[B+12>>2]=0.0;E=+h[i>>2];R=+h[i+4>>2];I=+h[i+8>>2];h[B+16>>2]=P-E;h[B+20>>2]=F-R;h[B+24>>2]=A-I;h[B+28>>2]=0.0;h[B+32>>2]=E-M;h[B+36>>2]=R-O;h[B+40>>2]=I-T;h[B+44>>2]=0.0;L=(O-F)*(A-I)-(T-A)*(F-R);D=(T-A)*(P-E)-(A-I)*(M-P);k=(F-R)*(M-P)-(O-F)*(P-E);if(k*k+(L*L+D*D)>0.0){p=O-F;f=T-A;m=M-P;S=M;x=O;w=T;c=0;C=-1.0;u=0;o=0;a=0}else{F=-1.0;_=B;return+F}while(1){if(S*(k*p-D*f)+x*(L*f-k*m)+(D*m-L*p)*w>0.0){v=r[6876+(c<<2)>>2]|0;N=r[B+48+(v<<2)>>2]|0;l=+h[N>>2];f=l-S;m=+h[N+4>>2];g=m-x;b=+h[N+8>>2];y=b-w;do{if(f*f+g*g+y*y>0.0){p=-(S*f+x*g+w*y)/(f*f+g*g+y*y);if(p>=1.0){l=l*l+m*m+b*b;u=2;o=0;a=1065353216;break}if(!(p<=0.0)){a=(h[d>>2]=p,r[d>>2]|0);S=S+f*p;l=x+g*p;w=w+y*p;l=w*w+(S*S+l*l);u=3;o=(h[d>>2]=1.0-p,r[d>>2]|0);break}else{l=S*S+x*x+w*w;u=1;o=1065353216;a=0;break}}else l=-1.0}while(0);if(C<0.0|l<C){r[s>>2]=(u&1|0?1<<c:0)+(u&2|0?1<<v:0);r[n+(c<<2)>>2]=o;r[n+(v<<2)>>2]=a;h[n+(r[6876+(v<<2)>>2]<<2)>>2]=0.0}else l=C}else l=C;c=c+1|0;if((c|0)==3)break;N=r[B+48+(c<<2)>>2]|0;p=+h[B+(c<<4)+4>>2];f=+h[B+(c<<4)+8>>2];m=+h[B+(c<<4)>>2];S=+h[N>>2];x=+h[N+4>>2];w=+h[N+8>>2];C=l}if(!(l<0.0)){F=l;_=B;return+F}w=+G(+(k*k+(L*L+D*D)));C=(L*+h[t>>2]+D*+h[t+4>>2]+k*+h[t+8>>2])/(k*k+(L*L+D*D));r[s>>2]=7;S=+h[e>>2]-L*C;y=+h[e+4>>2]-D*C;x=+h[e+8>>2]-k*C;F=+G(+((y*(P-E)-S*(F-R))*(y*(P-E)-S*(F-R))+(((F-R)*x-y*(A-I))*((F-R)*x-y*(A-I))+(S*(A-I)-x*(P-E))*(S*(A-I)-x*(P-E)))))/w;h[n>>2]=F;A=+h[i>>2]-L*C;x=+h[i+4>>2]-D*C;P=+h[i+8>>2]-k*C;O=+G(+((x*(E-M)-A*(R-O))*(x*(E-M)-A*(R-O))+(((R-O)*P-x*(I-T))*((R-O)*P-x*(I-T))+(A*(I-T)-P*(E-M))*(A*(I-T)-P*(E-M)))))/w;h[n+4>>2]=O;h[n+8>>2]=1.0-(O+F);F=k*C*(k*C)+(L*C*(L*C)+D*C*(D*C));_=B;return+F}function qv(t,e,i,s,a,l,c){t=t|0;e=e|0;i=i|0;s=s|0;a=a|0;l=l|0;c=c|0;var u=0.0,p=0.0,f=0.0,m=0,g=0,b=0.0,y=0,v=0,S=0,x=0,w=0,C=0,T=0,A=0,E=0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,W=0.0,j=0.0,H=0.0,X=0;E=_;_=_+9856|0;m=l;g=m+36|0;do{r[m>>2]=0;m=m+4|0}while((m|0)<(g|0));r[E+9712>>2]=t;r[E+9712+4>>2]=i;I=+h[s>>2];W=+h[e>>2];P=+h[s+16>>2];D=+h[e+16>>2];L=+h[s+32>>2];j=+h[e+32>>2];k=+h[e+4>>2];H=+h[e+20>>2];O=+h[e+36>>2];b=+h[e+8>>2];u=+h[e+24>>2];R=+h[e+40>>2];z=+h[s+4>>2];V=+h[s+20>>2];U=+h[s+36>>2];N=+h[s+8>>2];B=+h[s+24>>2];F=+h[s+40>>2];h[E+9712+8>>2]=I*W+P*D+L*j;h[E+9712+12>>2]=I*k+P*H+L*O;h[E+9712+16>>2]=I*b+P*u+L*R;h[E+9712+20>>2]=0.0;h[E+9712+24>>2]=W*z+D*V+j*U;h[E+9712+28>>2]=k*z+H*V+O*U;h[E+9712+32>>2]=b*z+u*V+R*U;h[E+9712+36>>2]=0.0;h[E+9712+40>>2]=W*N+D*B+j*F;h[E+9712+44>>2]=k*N+H*B+O*F;h[E+9712+48>>2]=b*N+u*B+R*F;h[E+9712+52>>2]=0.0;R=+h[s+48>>2]-+h[e+48>>2];u=+h[s+52>>2]-+h[e+52>>2];b=+h[s+56>>2]-+h[e+56>>2];O=+h[e>>2];H=+h[s>>2];k=+h[e+16>>2];j=+h[s+16>>2];D=+h[e+32>>2];W=+h[s+32>>2];L=+h[e+4>>2];P=+h[e+20>>2];I=+h[e+36>>2];M=+h[e+8>>2];p=+h[e+24>>2];f=+h[e+40>>2];h[E+9712+56>>2]=O*H+k*j+D*W;h[E+9712+60>>2]=O*z+k*V+D*U;h[E+9712+64>>2]=O*N+k*B+D*F;h[E+9712+68>>2]=0.0;h[E+9712+72>>2]=H*L+j*P+W*I;h[E+9712+76>>2]=z*L+V*P+U*I;h[E+9712+80>>2]=N*L+B*P+F*I;h[E+9712+84>>2]=0.0;h[E+9712+88>>2]=H*M+j*p+W*f;h[E+9712+92>>2]=z*M+V*p+U*f;h[E+9712+96>>2]=N*M+B*p+F*f;h[E+9712+100>>2]=0.0;h[E+9712+104>>2]=R*O+u*k+b*D;h[E+9712+108>>2]=R*L+u*P+b*I;h[E+9712+112>>2]=R*M+u*p+b*f;h[E+9712+116>>2]=0.0;r[E+9712+120>>2]=c?72:71;r[E+9712+124>>2]=0;r[E+9328+364>>2]=0;r[E+9328+128>>2]=0;r[E+9328+128+4>>2]=0;r[E+9328+128+8>>2]=0;r[E+9328+128+12>>2]=0;r[E+9328+376>>2]=2;r[E+9328+368>>2]=0;h[E+9328+144>>2]=0.0;f=-+h[a+4>>2];b=-+h[a+8>>2];h[E+16>>2]=-+h[a>>2];h[E+16+4>>2]=f;h[E+16+8>>2]=b;h[E+16+12>>2]=0.0;switch(Hv(E+9328|0,E+9712|0,E+16|0)|0){case 1:{x=E+32+9280|0;w=E+32+9288|0;C=E+32+9292|0;r[x>>2]=0;r[x+4>>2]=0;r[x+8>>2]=0;r[x+12>>2]=0;r[E+32>>2]=9;A=E+32+40|0;r[E+32+9276>>2]=0;r[A>>2]=0;r[A+4>>2]=0;r[A+8>>2]=0;r[A+12>>2]=0;r[A+16>>2]=0;c=0;do{t=128-c+-1|0;r[E+32+2108+(t*56|0)+44>>2]=0;i=r[w>>2]|0;r[E+32+2108+(t*56|0)+48>>2]=i;if(i|0)r[i+44>>2]=E+32+2108+(t*56|0);r[w>>2]=E+32+2108+(t*56|0);r[C>>2]=(r[C>>2]|0)+1;c=c+1|0}while((c|0)!=128);f=+h[a>>2];b=+h[a+4>>2];p=+h[a+8>>2];y=r[E+9328+372>>2]|0;do{if((r[y+32>>2]|0)>>>0>1?Kv(E+9328|0)|0:0){S=E+32+9280|0;t=r[S>>2]|0;if(t|0){m=r[E+32+9284>>2]|0;g=r[C>>2]|0;do{i=t+44|0;s=t+48|0;c=r[s>>2]|0;if(c|0)r[c+44>>2]=r[i>>2];i=r[i>>2]|0;if(i|0)r[i+48>>2]=r[s>>2];if((r[S>>2]|0)==(t|0))r[S>>2]=r[s>>2];m=m+-1|0;r[t+44>>2]=0;r[s>>2]=r[w>>2];i=r[w>>2]|0;if(i|0)r[i+44>>2]=t;r[w>>2]=t;g=g+1|0;t=r[S>>2]|0}while((t|0)!=0);r[E+32+9284>>2]=m;r[C>>2]=g}r[E+32>>2]=0;r[E+32+9276>>2]=0;t=r[y>>2]|0;i=r[y+12>>2]|0;H=+h[i+16>>2];F=+h[t+16>>2]-H;N=+h[i+20>>2];U=+h[t+20>>2]-N;z=+h[i+24>>2];W=+h[t+24>>2]-z;i=r[y+4>>2]|0;V=+h[i+16>>2]-H;j=+h[i+20>>2]-N;B=+h[i+24>>2]-z;c=r[y+8>>2]|0;H=+h[c+16>>2]-H;N=+h[c+20>>2]-N;z=+h[c+24>>2]-z;if(F*j*z+(U*B*H+W*V*N-F*B*N-U*V*z)-W*j*H<0.0){r[y>>2]=i;r[y+4>>2]=t;s=r[y+16>>2]|0;r[y+16>>2]=r[y+20>>2];r[y+20>>2]=s;s=i}else{s=t;t=i}s=Zv(E+32|0,s,t,c,1)|0;m=Zv(E+32|0,r[y+4>>2]|0,r[y>>2]|0,r[y+12>>2]|0,1)|0;g=Zv(E+32|0,r[y+8>>2]|0,r[y+4>>2]|0,r[y+12>>2]|0,1)|0;a=Zv(E+32|0,r[y>>2]|0,r[y+8>>2]|0,r[y+12>>2]|0,1)|0;if((r[E+32+9284>>2]|0)==4){t=r[x>>2]|0;u=+h[t+16>>2];i=r[t+48>>2]|0;if(i){p=u*u;while(1){u=+h[i+16>>2];c=u*u<p;t=c?i:t;i=r[i+48>>2]|0;if(!i)break;else p=c?u*u:p}}b=+h[t>>2];f=+h[t+4>>2];p=+h[t+8>>2];u=+h[t+12>>2];v=r[t+16>>2]|0;X=r[t+20>>2]|0;i=r[t+24>>2]|0;c=r[t+28>>2]|0;n[s+52>>0]=0;r[s+32>>2]=m;n[m+52>>0]=0;r[m+32>>2]=s;n[s+53>>0]=0;r[s+36>>2]=g;n[g+52>>0]=1;r[g+32>>2]=s;n[s+54>>0]=0;r[s+40>>2]=a;n[a+52>>0]=2;r[a+32>>2]=s;n[m+53>>0]=2;r[m+36>>2]=a;n[a+54>>0]=1;r[a+40>>2]=m;n[m+54>>0]=1;r[m+40>>2]=g;n[g+53>>0]=2;r[g+36>>2]=m;n[g+54>>0]=1;r[g+40>>2]=a;n[a+53>>0]=2;r[a+36>>2]=g;r[E+32>>2]=0;y=t;g=X;a=i;m=c;t=v;v=0;while(1){i=r[E+32+9276>>2]|0;if(i>>>0>=64){T=43;break}r[E+9840>>2]=0;r[E+9840+4>>2]=0;r[E+9840+8>>2]=0;r[E+32+9276>>2]=i+1;v=v+1|0;n[y+55>>0]=v;s=y+4|0;X=y+8|0;Xv(E+9328|0,+h[y>>2],+h[s>>2],+h[X>>2],E+32+60+(i<<5)|0);if(+h[y>>2]*+h[E+32+60+(i<<5)+16>>2]+ +h[s>>2]*+h[E+32+60+(i<<5)+20>>2]+ +h[X>>2]*+h[E+32+60+(i<<5)+24>>2]-+h[y+16>>2]>9.999999747378752e-05)s=0;else{i=7;T=42;break}do{c=$v(E+32|0,v,E+32+60+(i<<5)|0,r[y+32+(s<<2)>>2]|0,o[y+52+s>>0]|0,E+9840|0)|0;s=s+1|0}while(c&s>>>0<3);if(!(c&(r[E+9840+8>>2]|0)>>>0>2)){i=4;T=42;break}c=r[E+9840>>2]|0;t=r[E+9840+4>>2]|0;n[c+53>>0]=2;r[c+36>>2]=t;n[t+54>>0]=1;r[t+40>>2]=c;t=y+44|0;c=y+48|0;i=r[c>>2]|0;if(i|0)r[i+44>>2]=r[t>>2];t=r[t>>2]|0;if(t|0)r[t+48>>2]=r[c>>2];if((r[S>>2]|0)==(y|0))r[S>>2]=r[c>>2];r[E+32+9284>>2]=(r[E+32+9284>>2]|0)+-1;r[y+44>>2]=0;r[c>>2]=r[w>>2];t=r[w>>2]|0;if(t|0)r[t+44>>2]=y;r[w>>2]=y;r[C>>2]=(r[C>>2]|0)+1;i=r[x>>2]|0;u=+h[i+16>>2];t=r[i+48>>2]|0;if(t){p=u*u;while(1){u=+h[t+16>>2];c=u*u<p;i=c?t:i;t=r[t+48>>2]|0;if(!t)break;else p=c?u*u:p}}b=+h[i>>2];f=+h[i+4>>2];p=+h[i+8>>2];u=+h[i+12>>2];t=r[i+16>>2]|0;c=r[i+20>>2]|0;s=r[i+24>>2]|0;m=r[i+28>>2]|0;if(v>>>0>=255){i=m;break}else{y=i;g=c;a=s}}if((T|0)==42){r[E+32>>2]=i;c=g;s=a;i=m}else if((T|0)==43){r[E+32>>2]=6;c=g;s=a;i=m}W=(r[d>>2]=t,+h[d>>2]);V=b*W;N=f*W;W=p*W;h[E+32+40>>2]=b;h[E+32+44>>2]=f;h[E+32+48>>2]=p;h[E+32+52>>2]=u;r[E+32+56>>2]=t;r[E+32+36>>2]=3;r[E+32+4>>2]=c;r[E+32+8>>2]=s;r[E+32+12>>2]=i;X=s;z=+h[X+16>>2]-V;F=+h[X+20>>2]-N;U=+h[X+24>>2]-W;C=i;O=+h[C+16>>2]-V;B=+h[C+20>>2]-N;j=+h[C+24>>2]-W;j=+G(+((z*B-F*O)*(z*B-F*O)+((F*j-U*B)*(F*j-U*B)+(U*O-z*j)*(U*O-z*j))));h[E+32+20>>2]=j;z=+h[C+16>>2]-V;O=+h[C+20>>2]-N;U=+h[C+24>>2]-W;C=c;B=+h[C+16>>2]-V;F=+h[C+20>>2]-N;H=+h[C+24>>2]-W;H=+G(+((z*F-O*B)*(z*F-O*B)+((O*H-U*F)*(O*H-U*F)+(U*B-z*H)*(U*B-z*H))));h[E+32+24>>2]=H;z=+h[C+16>>2]-V;B=+h[C+20>>2]-N;U=+h[C+24>>2]-W;V=+h[X+16>>2]-V;N=+h[X+20>>2]-N;W=+h[X+24>>2]-W;W=+G(+((z*N-B*V)*(z*N-B*V)+((B*W-U*N)*(B*W-U*N)+(U*V-z*W)*(U*V-z*W))));h[E+32+20>>2]=j/(W+(j+H));h[E+32+24>>2]=H/(W+(j+H));h[E+32+28>>2]=W/(W+(j+H));if((r[E+32>>2]|0)!=9)if(!(r[E+32+36>>2]|0)){f=0.0;p=0.0;u=0.0;break}else{s=E+32+36|0;T=51;break}r[l>>2]=3;X=0;_=E;return X|0}else T=45}else T=45}while(0);if((T|0)==45){r[E+32>>2]=8;h[E+32+40>>2]=f;h[E+32+44>>2]=b;h[E+32+48>>2]=p;h[E+32+52>>2]=0.0;u=+G(+(f*f+b*b+p*p));if(u>0.0){h[E+32+40>>2]=1.0/u*f;h[E+32+44>>2]=1.0/u*b;h[E+32+48>>2]=1.0/u*p}else{r[A>>2]=1065353216;r[E+32+44>>2]=0;r[E+32+48>>2]=0}h[E+32+52>>2]=0.0;h[E+32+56>>2]=0.0;r[E+32+36>>2]=1;r[E+32+4>>2]=r[y>>2];h[E+32+20>>2]=1.0;s=E+32+36|0;T=51}if((T|0)==51){c=0;f=0.0;p=0.0;u=0.0;do{t=r[E+9712+120>>2]|0;X=r[E+9712+124>>2]|0;i=(r[E+9712>>2]|0)+(X>>1)|0;if(X&1)t=r[(r[i>>2]|0)+t>>2]|0;Vk[t&127](E,i,r[E+32+4+(c<<2)>>2]|0);H=+h[E+32+20+(c<<2)>>2];f=f+ +h[E>>2]*H;u=u+H*+h[E+4>>2];p=p+H*+h[E+8>>2];c=c+1|0}while(c>>>0<(r[s>>2]|0)>>>0)}r[l>>2]=1;H=f*+h[e+16>>2]+u*+h[e+20>>2]+p*+h[e+24>>2]+ +h[e+52>>2];z=f*+h[e+32>>2]+u*+h[e+36>>2]+p*+h[e+40>>2]+ +h[e+56>>2];h[l+4>>2]=f*+h[e>>2]+u*+h[e+4>>2]+p*+h[e+8>>2]+ +h[e+48>>2];h[l+8>>2]=H;h[l+12>>2]=z;h[l+16>>2]=0.0;z=+h[A>>2];H=+h[E+32+56>>2];W=+h[E+32+44>>2];j=+h[E+32+48>>2];F=f-z*H;B=u-H*W;N=p-H*j;U=F*+h[e+16>>2]+B*+h[e+20>>2]+N*+h[e+24>>2]+ +h[e+52>>2];V=F*+h[e+32>>2]+B*+h[e+36>>2]+N*+h[e+40>>2]+ +h[e+56>>2];h[l+20>>2]=F*+h[e>>2]+B*+h[e+4>>2]+N*+h[e+8>>2]+ +h[e+48>>2];h[l+24>>2]=U;h[l+28>>2]=V;h[l+32>>2]=0.0;h[l+36>>2]=-z;h[l+40>>2]=-W;h[l+44>>2]=-j;h[l+48>>2]=0.0;h[l+52>>2]=-H;X=1;_=E;return X|0}case 2:{r[l>>2]=2;X=0;_=E;return X|0}default:{X=0;_=E;return X|0}}return 0}function Kv(t){t=t|0;var e=0,i=0,n=0.0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,u=0,d=0,p=0,f=0.0,m=0.0,g=0.0;d=_;_=_+16|0;u=r[t+372>>2]|0;t:do{switch(r[u+32>>2]|0){case 1:{i=1;e=0;while(1){r[d>>2]=0;r[d+4>>2]=0;r[d+8>>2]=0;r[d+12>>2]=0;h[d+(e<<2)>>2]=1.0;p=u+32|0;h[u+16+(i<<2)>>2]=0.0;i=(r[t+364>>2]|0)+-1|0;r[t+364>>2]=i;r[u+(r[p>>2]<<2)>>2]=r[t+348+(i<<2)>>2];i=r[p>>2]|0;r[p>>2]=i+1;n=+h[d>>2];s=+h[d+4>>2];o=+h[d+8>>2];Xv(t,n,s,o,r[u+(i<<2)>>2]|0);if(Kv(t)|0)break;u=r[t+372>>2]|0;p=(r[u+32>>2]|0)+-1|0;r[u+32>>2]=p;p=r[u+(p<<2)>>2]|0;u=r[t+364>>2]|0;r[t+364>>2]=u+1;r[t+348+(u<<2)>>2]=p;u=r[t+372>>2]|0;h[u+16+(r[u+32>>2]<<2)>>2]=0.0;p=(r[t+364>>2]|0)+-1|0;r[t+364>>2]=p;r[u+(r[u+32>>2]<<2)>>2]=r[t+348+(p<<2)>>2];p=r[u+32>>2]|0;r[u+32>>2]=p+1;Xv(t,-n,-s,-o,r[u+(p<<2)>>2]|0);if(Kv(t)|0)break;p=r[t+372>>2]|0;u=(r[p+32>>2]|0)+-1|0;r[p+32>>2]=u;u=r[p+(u<<2)>>2]|0;p=r[t+364>>2]|0;r[t+364>>2]=p+1;r[t+348+(p<<2)>>2]=u;e=e+1|0;if(e>>>0>=3)break t;u=r[t+372>>2]|0;i=r[u+32>>2]|0}p=1;_=d;return p|0}case 2:{p=r[u+4>>2]|0;e=r[u>>2]|0;n=+h[p+16>>2]-+h[e+16>>2];s=+h[p+20>>2]-+h[e+20>>2];o=+h[p+24>>2]-+h[e+24>>2];e=0;while(1){r[d>>2]=0;r[d+4>>2]=0;r[d+8>>2]=0;r[d+12>>2]=0;h[d+(e<<2)>>2]=1.0;a=+h[d+8>>2];l=+h[d+4>>2];c=+h[d>>2];if((s*a-o*l)*(s*a-o*l)+(o*c-n*a)*(o*c-n*a)+(n*l-s*c)*(n*l-s*c)>0.0){u=r[t+372>>2]|0;h[u+16+(r[u+32>>2]<<2)>>2]=0.0;p=(r[t+364>>2]|0)+-1|0;r[t+364>>2]=p;r[u+(r[u+32>>2]<<2)>>2]=r[t+348+(p<<2)>>2];p=r[u+32>>2]|0;r[u+32>>2]=p+1;Xv(t,s*a-o*l,o*c-n*a,n*l-s*c,r[u+(p<<2)>>2]|0);if(Kv(t)|0)break;u=r[t+372>>2]|0;p=(r[u+32>>2]|0)+-1|0;r[u+32>>2]=p;p=r[u+(p<<2)>>2]|0;u=r[t+364>>2]|0;r[t+364>>2]=u+1;r[t+348+(u<<2)>>2]=p;u=r[t+372>>2]|0;h[u+16+(r[u+32>>2]<<2)>>2]=0.0;p=(r[t+364>>2]|0)+-1|0;r[t+364>>2]=p;r[u+(r[u+32>>2]<<2)>>2]=r[t+348+(p<<2)>>2];p=r[u+32>>2]|0;r[u+32>>2]=p+1;Xv(t,-(s*a-o*l),-(o*c-n*a),-(n*l-s*c),r[u+(p<<2)>>2]|0);if(Kv(t)|0)break;p=r[t+372>>2]|0;u=(r[p+32>>2]|0)+-1|0;r[p+32>>2]=u;u=r[p+(u<<2)>>2]|0;p=r[t+364>>2]|0;r[t+364>>2]=p+1;r[t+348+(p<<2)>>2]=u}e=e+1|0;if(e>>>0>=3)break t}p=1;_=d;return p|0}case 3:{p=r[u+4>>2]|0;i=r[u>>2]|0;a=+h[i+16>>2];n=+h[p+16>>2]-a;l=+h[i+20>>2];s=+h[p+20>>2]-l;c=+h[i+24>>2];o=+h[p+24>>2]-c;p=r[u+8>>2]|0;a=+h[p+16>>2]-a;l=+h[p+20>>2]-l;c=+h[p+24>>2]-c;if((s*c-o*l)*(s*c-o*l)+(o*a-n*c)*(o*a-n*c)+(n*l-s*a)*(n*l-s*a)>0.0){h[u+28>>2]=0.0;p=(r[t+364>>2]|0)+-1|0;r[t+364>>2]=p;r[u+12>>2]=r[t+348+(p<<2)>>2];p=r[u+32>>2]|0;r[u+32>>2]=p+1;Xv(t,s*c-o*l,o*a-n*c,n*l-s*a,r[u+(p<<2)>>2]|0);if(Kv(t)|0){p=1;_=d;return p|0}u=r[t+372>>2]|0;p=(r[u+32>>2]|0)+-1|0;r[u+32>>2]=p;p=r[u+(p<<2)>>2]|0;u=r[t+364>>2]|0;r[t+364>>2]=u+1;r[t+348+(u<<2)>>2]=p;u=r[t+372>>2]|0;h[u+16+(r[u+32>>2]<<2)>>2]=0.0;p=(r[t+364>>2]|0)+-1|0;r[t+364>>2]=p;r[u+(r[u+32>>2]<<2)>>2]=r[t+348+(p<<2)>>2];p=r[u+32>>2]|0;r[u+32>>2]=p+1;Xv(t,-(s*c-o*l),-(o*a-n*c),-(n*l-s*a),r[u+(p<<2)>>2]|0);if(Kv(t)|0){p=1;_=d;return p|0}else{p=r[t+372>>2]|0;u=(r[p+32>>2]|0)+-1|0;r[p+32>>2]=u;u=r[p+(u<<2)>>2]|0;p=r[t+364>>2]|0;r[t+364>>2]=p+1;r[t+348+(p<<2)>>2]=u;break t}}break}case 4:{p=r[u>>2]|0;t=r[u+12>>2]|0;c=+h[t+16>>2];g=+h[p+16>>2]-c;f=+h[t+20>>2];n=+h[p+20>>2]-f;o=+h[t+24>>2];a=+h[p+24>>2]-o;p=r[u+4>>2]|0;s=+h[p+16>>2]-c;l=+h[p+20>>2]-f;m=+h[p+24>>2]-o;p=r[u+8>>2]|0;c=+h[p+16>>2]-c;f=+h[p+20>>2]-f;o=+h[p+24>>2]-o;if(!((0.0!=0.0?1:g*l*o+(n*m*c+a*s*f-g*m*f-n*s*o)-a*l*c!=g*l*o+(n*m*c+a*s*f-g*m*f-n*s*o)-a*l*c)|g*l*o+(n*m*c+a*s*f-g*m*f-n*s*o)-a*l*c==0.0)){p=1;_=d;return p|0}break}default:{}}}while(0);p=0;_=d;return p|0}function Zv(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0;m=r[t+9288>>2]|0;if(!m){r[t>>2]=5;t=0;return t|0}a=r[m+48>>2]|0;if(a|0)r[a+44>>2]=r[m+44>>2];a=r[m+44>>2]|0;if(a|0)r[a+48>>2]=r[m+48>>2];if((r[t+9288>>2]|0)==(m|0))r[t+9288>>2]=r[m+48>>2];r[t+9292>>2]=(r[t+9292>>2]|0)+-1;r[m+44>>2]=0;r[m+48>>2]=r[t+9280>>2];a=r[t+9280>>2]|0;if(a|0)r[a+44>>2]=m;r[t+9280>>2]=m;r[t+9284>>2]=(r[t+9284>>2]|0)+1;n[m+55>>0]=0;r[m+20>>2]=e;r[m+24>>2]=i;r[m+28>>2]=s;u=+h[e+16>>2];l=+h[i+16>>2]-u;d=+h[e+20>>2];c=+h[i+20>>2]-d;p=+h[e+24>>2];_=+h[i+24>>2]-p;u=+h[s+16>>2]-u;d=+h[s+20>>2]-d;p=+h[s+24>>2]-p;h[m>>2]=c*p-_*d;h[m+4>>2]=_*u-l*p;h[m+8>>2]=l*d-c*u;h[m+12>>2]=0.0;f=+G(+((c*p-_*d)*(c*p-_*d)+(_*u-l*p)*(_*u-l*p)+(l*d-c*u)*(l*d-c*u)));do{if(f>9.999999747378752e-05){if((!(Qv(c*p-_*d,_*u-l*p,l*d-c*u,+h[e+16>>2],+h[e+20>>2],+h[e+24>>2],+h[i+16>>2],+h[i+20>>2],+h[i+24>>2],m+16|0)|0)?!(Qv(+h[m>>2],+h[m+4>>2],+h[m+8>>2],+h[i+16>>2],+h[i+20>>2],+h[i+24>>2],+h[s+16>>2],+h[s+20>>2],+h[s+24>>2],m+16|0)|0):0)?!(Qv(+h[m>>2],+h[m+4>>2],+h[m+8>>2],+h[s+16>>2],+h[s+20>>2],+h[s+24>>2],+h[e+16>>2],+h[e+20>>2],+h[e+24>>2],m+16|0)|0):0)h[m+16>>2]=(+h[e+16>>2]*+h[m>>2]+ +h[e+20>>2]*+h[m+4>>2]+ +h[e+24>>2]*+h[m+8>>2])/f;h[m>>2]=1.0/f*+h[m>>2];h[m+4>>2]=1.0/f*+h[m+4>>2];h[m+8>>2]=1.0/f*+h[m+8>>2];if(o){t=m;return t|0}if(!(+h[m+16>>2]>=-9.999999747378752e-06)){r[t>>2]=3;break}else{t=m;return t|0}}else r[t>>2]=2}while(0);a=r[m+48>>2]|0;if(a|0)r[a+44>>2]=r[m+44>>2];a=r[m+44>>2]|0;if(a|0)r[a+48>>2]=r[m+48>>2];if((r[t+9280>>2]|0)==(m|0))r[t+9280>>2]=r[m+48>>2];r[t+9284>>2]=(r[t+9284>>2]|0)+-1;r[m+44>>2]=0;r[m+48>>2]=r[t+9288>>2];a=r[t+9288>>2]|0;if(a|0)r[a+44>>2]=m;r[t+9288>>2]=m;r[t+9292>>2]=(r[t+9292>>2]|0)+1;t=0;return t|0}function Qv(t,e,i,n,s,r,o,a,l,c){t=+t;e=+e;i=+i;n=+n;s=+s;r=+r;o=+o;a=+a;l=+l;c=c|0;if(!(((o-n)*e-(a-s)*t)*r+(((a-s)*i-(l-r)*e)*n+((l-r)*t-(o-n)*i)*s)<0.0)){c=0;return c|0}if((o-n)*n+(a-s)*s+(l-r)*r>0.0){h[c>>2]=+G(+(n*n+s*s+r*r));c=1;return c|0}if((o-n)*o+(a-s)*a+(l-r)*l<0.0){h[c>>2]=+G(+(o*o+a*a+l*l));c=1;return c|0}else{i=((o*o+a*a+l*l)*(n*n+s*s+r*r)-(o*n+a*s+l*r)*(o*n+a*s+l*r))/((o-n)*(o-n)+(a-s)*(a-s)+(l-r)*(l-r));h[c>>2]=+G(+(i>0.0?i:0.0));c=1;return c|0}return 0}function $v(t,e,i,s,a,l){t=t|0;e=e|0;i=i|0;s=s|0;a=a|0;l=l|0;var c=0;if((o[s+55>>0]|0|0)==(e|0)){s=0;return s|0}c=r[6876+(a<<2)>>2]|0;if(+h[s>>2]*+h[i+16>>2]+ +h[s+4>>2]*+h[i+20>>2]+ +h[s+8>>2]*+h[i+24>>2]-+h[s+16>>2]<-9.999999747378752e-06){c=Zv(t,r[s+20+(c<<2)>>2]|0,r[s+20+(a<<2)>>2]|0,i,0)|0;if(!c){s=0;return s|0}n[c+52>>0]=a;r[c+32>>2]=s;n[s+52+a>>0]=0;r[s+32+(a<<2)>>2]=c;a=r[l>>2]|0;if(!a)r[l+4>>2]=c;else{n[a+53>>0]=2;r[a+36>>2]=c;n[c+54>>0]=1;r[c+40>>2]=a}r[l>>2]=c;r[l+8>>2]=(r[l+8>>2]|0)+1;s=1;return s|0}a=r[6888+(a<<2)>>2]|0;n[s+55>>0]=e;if(!($v(t,e,i,r[s+32+(c<<2)>>2]|0,o[s+52+c>>0]|0,l)|0)){s=0;return s|0}if(!($v(t,e,i,r[s+32+(a<<2)>>2]|0,o[s+52+a>>0]|0,l)|0)){s=0;return s|0}a=r[s+48>>2]|0;if(a|0)r[a+44>>2]=r[s+44>>2];a=r[s+44>>2]|0;if(a|0)r[a+48>>2]=r[s+48>>2];if((r[t+9280>>2]|0)==(s|0))r[t+9280>>2]=r[s+48>>2];r[t+9284>>2]=(r[t+9284>>2]|0)+-1;r[s+44>>2]=0;r[s+48>>2]=r[t+9288>>2];a=r[t+9288>>2]|0;if(a|0)r[a+44>>2]=s;r[t+9288>>2]=s;r[t+9292>>2]=(r[t+9292>>2]|0)+1;s=1;return s|0}function Jv(t){t=t|0;return}function tS(t){t=t|0;Ql(t);return}function eS(t,e,i,n,s,o,a,l,c,u){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;l=l|0;c=c|0;u=u|0;var d=0.0,p=0.0;u=_;_=_+80|0;p=+h[o+52>>2]-+h[s+52>>2];d=+h[o+56>>2]-+h[s+56>>2];h[u+56>>2]=+h[o+48>>2]-+h[s+48>>2];h[u+56+4>>2]=p;h[u+56+8>>2]=d;h[u+56+12>>2]=0.0;if(qv(i,s,n,o,u+56|0,u,1)|0){r[l>>2]=r[u+4>>2];r[l+4>>2]=r[u+4+4>>2];r[l+8>>2]=r[u+4+8>>2];r[l+12>>2]=r[u+4+12>>2];r[c>>2]=r[u+20>>2];r[c+4>>2]=r[u+20+4>>2];r[c+8>>2]=r[u+20+8>>2];r[c+12>>2]=r[u+20+12>>2];r[a>>2]=r[u+36>>2];r[a+4>>2]=r[u+36+4>>2];r[a+8>>2]=r[u+36+8>>2];r[a+12>>2]=r[u+36+12>>2];c=1;_=u;return c|0}if(!(jv(i,s,n,o,u+56|0,u)|0)){c=0;_=u;return c|0}r[l>>2]=r[u+4>>2];r[l+4>>2]=r[u+4+4>>2];r[l+8>>2]=r[u+4+8>>2];r[l+12>>2]=r[u+4+12>>2];r[c>>2]=r[u+20>>2];r[c+4>>2]=r[u+20+4>>2];r[c+8>>2]=r[u+20+8>>2];r[c+12>>2]=r[u+20+12>>2];r[a>>2]=r[u+36>>2];r[a+4>>2]=r[u+36+4>>2];r[a+8>>2]=r[u+36+8>>2];r[a+12>>2]=r[u+36+12>>2];c=0;_=u;return c|0}function iS(t){t=t|0;Ql(t);return}function nS(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0,y=0.0,v=0.0,S=0.0,x=0,w=0,C=0.0,T=0,A=0,E=0.0,M=0.0,R=0,I=0,P=0,L=0,D=0,k=0,O=0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,W=0,j=0;W=_;_=_+256|0;h[t+56>>2]=0.0;k=W+240+4|0;O=W+240+8|0;r[W+240>>2]=0;r[W+240+4>>2]=0;r[W+240+8>>2]=0;r[W+240+12>>2]=0;r[W+176>>2]=r[e>>2];r[W+176+4>>2]=r[e+4>>2];r[W+176+8>>2]=r[e+8>>2];r[W+176+12>>2]=r[e+12>>2];r[W+176+16>>2]=r[e+16>>2];r[W+176+16+4>>2]=r[e+16+4>>2];r[W+176+16+8>>2]=r[e+16+8>>2];r[W+176+16+12>>2]=r[e+16+12>>2];r[W+176+32>>2]=r[e+32>>2];r[W+176+32+4>>2]=r[e+32+4>>2];r[W+176+32+8>>2]=r[e+32+8>>2];r[W+176+32+12>>2]=r[e+32+12>>2];T=W+176+48|0;r[T>>2]=r[e+48>>2];r[T+4>>2]=r[e+48+4>>2];r[T+8>>2]=r[e+48+8>>2];r[T+12>>2]=r[e+48+12>>2];r[W+112>>2]=r[e+64>>2];r[W+112+4>>2]=r[e+64+4>>2];r[W+112+8>>2]=r[e+64+8>>2];r[W+112+12>>2]=r[e+64+12>>2];r[W+112+16>>2]=r[e+80>>2];r[W+112+16+4>>2]=r[e+80+4>>2];r[W+112+16+8>>2]=r[e+80+8>>2];r[W+112+16+12>>2]=r[e+80+12>>2];r[W+112+32>>2]=r[e+96>>2];r[W+112+32+4>>2]=r[e+96+4>>2];r[W+112+32+8>>2]=r[e+96+8>>2];r[W+112+32+12>>2]=r[e+96+12>>2];A=W+112+48|0;r[A>>2]=r[e+112>>2];r[A+4>>2]=r[e+112+4>>2];r[A+8>>2]=r[e+112+8>>2];r[A+12>>2]=r[e+112+12>>2];F=+h[T>>2];B=+h[A>>2];I=W+176+52|0;N=+h[I>>2];P=W+112+52|0;U=+h[P>>2];L=W+176+56|0;V=+h[L>>2];D=W+112+56|0;z=+h[D>>2];h[T>>2]=F-(F+B)*.5;h[I>>2]=N-(N+U)*.5;h[L>>2]=V-(V+z)*.5;h[A>>2]=B-(F+B)*.5;h[P>>2]=U-(N+U)*.5;h[D>>2]=z-(V+z)*.5;if(((r[(r[t+28>>2]|0)+4>>2]|0)+-17|0)>>>0<2)T=((r[(r[t+32>>2]|0)+4>>2]|0)+-17|0)>>>0<2;else T=0;S=+h[t+44>>2];v=+h[t+48>>2];r[5046]=(r[5046]|0)+1;A=n[t+52>>0]|0;r[t+64>>2]=0;r[t+4>>2]=0;r[t+8>>2]=1065353216;r[t+12>>2]=0;h[t+16>>2]=0.0;r[t+68>>2]=0;r[t+60>>2]=-1;b=r[t+24>>2]|0;n[b+312>>0]=0;r[b>>2]=0;n[b+356>>0]=1;r[b+292>>2]=1566444395;r[b+296>>2]=1566444395;r[b+300>>2]=1566444395;h[b+304>>2]=0.0;r[b+336>>2]=0;r[b+336+4>>2]=0;r[b+336+8>>2]=0;r[b+336+12>>2]=0;n[b+336+16>>0]=0;n[b+332>>0]=n[b+332>>0]&-16;b=0;u=999999984306749440.0;do{f=+h[t+4>>2];p=+h[t+8>>2];l=+h[t+12>>2];c=+h[e+4>>2]*-f+ +h[e+20>>2]*-p+ +h[e+36>>2]*-l;d=+h[e+8>>2]*-f+ +h[e+24>>2]*-p+ +h[e+40>>2]*-l;h[W+96>>2]=+h[e>>2]*-f+ +h[e+16>>2]*-p+ +h[e+32>>2]*-l;h[W+96+4>>2]=c;h[W+96+8>>2]=d;h[W+96+12>>2]=0.0;d=f*+h[e+68>>2]+p*+h[e+84>>2]+l*+h[e+100>>2];c=f*+h[e+72>>2]+p*+h[e+88>>2]+l*+h[e+104>>2];h[W+80>>2]=+h[e+64>>2]*f+ +h[e+80>>2]*p+ +h[e+96>>2]*l;h[W+80+4>>2]=d;h[W+80+8>>2]=c;h[W+80+12>>2]=0.0;ET(W+64|0,r[t+28>>2]|0,W+96|0);ET(W+48|0,r[t+32>>2]|0,W+80|0);c=+h[W+64>>2];d=+h[W+64+4>>2];l=+h[W+64+8>>2];p=c*+h[W+176>>2]+d*+h[W+176+4>>2]+l*+h[W+176+8>>2]+ +h[W+176+48>>2];f=c*+h[W+176+16>>2]+d*+h[W+176+20>>2]+l*+h[W+176+24>>2]+ +h[I>>2];l=c*+h[W+176+32>>2]+d*+h[W+176+36>>2]+l*+h[W+176+40>>2]+ +h[L>>2];d=+h[W+48>>2];c=+h[W+48+4>>2];y=+h[W+48+8>>2];m=d*+h[W+112>>2]+c*+h[W+112+4>>2]+y*+h[W+112+8>>2]+ +h[W+112+48>>2];g=d*+h[W+112+16>>2]+c*+h[W+112+20>>2]+y*+h[W+112+24>>2]+ +h[P>>2];y=d*+h[W+112+32>>2]+c*+h[W+112+36>>2]+y*+h[W+112+40>>2]+ +h[D>>2];c=T?0.0:y;d=T?0.0:l;y=(T?0.0:l)-(T?0.0:y);l=+h[t+4>>2]*(p-m)+ +h[t+8>>2]*(f-g)+ +h[t+12>>2]*y;if(l>0.0?l*l>u*+h[e+128>>2]:0){r[t+68>>2]=10;o=0;b=1}else j=7;do{if((j|0)==7){j=0;x=r[t+24>>2]|0;w=r[x>>2]|0;t:do{if((w|0)>0){a=+h[x+308>>2];o=0;while(1){C=p-m-+h[x+4+(o<<4)>>2];E=f-g-+h[x+4+(o<<4)+4>>2];M=y-+h[x+4+(o<<4)+8>>2];o=o+1|0;if(C*C+E*E+M*M<=a){o=1;break t}if((o|0)>=(w|0)){o=0;break}}}else o=0}while(0);if((+h[x+304>>2]==0.0?y==+h[x+300>>2]:0)?f-g==+h[x+296>>2]:0){if(p-m==+h[x+292>>2]|o)j=16}else j=15;if((j|0)==15?(j=0,o):0)j=16;if((j|0)==16){j=0;r[t+68>>2]=1;o=0;b=1;break}a=u-l;if(a<=u*9.999999974752427e-07){r[t+68>>2]=!(a<=0.0)?11:2;o=0;b=1;break}h[x+292>>2]=p-m;h[x+296>>2]=f-g;h[x+300>>2]=y;h[x+304>>2]=0.0;n[x+356>>0]=1;h[x+4+(w<<4)>>2]=p-m;h[x+4+(w<<4)+4>>2]=f-g;h[x+4+(w<<4)+8>>2]=y;h[x+4+(w<<4)+12>>2]=0.0;o=r[x>>2]|0;h[x+84+(o<<4)>>2]=p;h[x+84+(o<<4)+4>>2]=f;h[x+84+(o<<4)+8>>2]=d;h[x+84+(o<<4)+12>>2]=0.0;o=r[x>>2]|0;h[x+164+(o<<4)>>2]=m;h[x+164+(o<<4)+4>>2]=g;h[x+164+(o<<4)+8>>2]=c;h[x+164+(o<<4)+12>>2]=0.0;r[x>>2]=(r[x>>2]|0)+1;o=r[t+24>>2]|0;w=vS(o)|0;a=+h[o+276>>2];l=+h[o+280>>2];c=+h[o+284>>2];o=r[o+288>>2]|0;if(!w){r[t+68>>2]=3;o=0;b=1;break}if(a*a+l*l+c*c<9.999999974752427e-07){h[t+4>>2]=a;h[t+8>>2]=l;h[t+12>>2]=c;r[t+16>>2]=o;r[t+68>>2]=6;o=0;b=1;break}if(u-(a*a+l*l+c*c)<=u*1.1920928955078125e-07){r[t+68>>2]=12;o=0;b=1;u=a*a+l*l+c*c;break}h[t+4>>2]=a;h[t+8>>2]=l;h[t+12>>2]=c;r[t+16>>2]=o;w=r[t+64>>2]|0;r[t+64>>2]=w+1;if((w|0)<=1e3)if((r[r[t+24>>2]>>2]|0)==4){r[t+68>>2]=13;o=0;u=a*a+l*l+c*c}else{o=1;u=a*a+l*l+c*c}else{o=0;u=a*a+l*l+c*c}}}while(0)}while(o);v=A<<24>>24==0?v:0.0;y=(A<<24>>24==0?S:0.0)+v;do{if(b){A=r[t+24>>2]|0;vS(A)|0;c=+h[A+260>>2];l=+h[A+264>>2];p=+h[A+268>>2];r[W+240>>2]=r[t+4>>2];r[W+240+4>>2]=r[t+4+4>>2];r[W+240+8>>2]=r[t+4+8>>2];r[W+240+12>>2]=r[t+4+12>>2];a=+h[t+4>>2];d=+h[t+8>>2];f=+h[t+12>>2];if(a*a+d*d+f*f<.0001)r[t+68>>2]=5;if(a*a+d*d+f*f>1.4210854715202004e-14){M=1.0/+G(+(a*a+d*d+f*f));h[W+240>>2]=M*+h[W+240>>2];h[k>>2]=M*+h[k>>2];h[O>>2]=M*+h[O>>2];E=v/+G(+u);r[t+60>>2]=1;u=1.0/M-y;x=1;c=E*a+c;M=E*d+l;E=E*f+p;break}else{r[t+60>>2]=2;u=0.0;x=0;M=l;E=p;break}}else{u=0.0;x=0;c=0.0;M=0.0;E=0.0}}while(0);if(((r[t+72>>2]|0)!=0?(r[t+20>>2]|0)!=0:0)?(r[t+68>>2]|0)!=0:0)o=y+u<.01;else o=0;b=x^1;do{if(o|b?(R=r[t+20>>2]|0,(R|0)!=0):0){r[5045]=(r[5045]|0)+1;r[t+4>>2]=0;r[t+4+4>>2]=0;r[t+4+8>>2]=0;r[t+4+12>>2]=0;if(!(hk[r[(r[R>>2]|0)+8>>2]&3](R,r[t+24>>2]|0,r[t+28>>2]|0,r[t+32>>2]|0,W+176|0,W+112|0,t+4|0,W+96|0,W+80|0,s)|0)){l=+h[t+4>>2];p=+h[t+8>>2];m=+h[t+12>>2];if(!(l*l+p*p+m*m>0.0)){if(x){l=M;a=E;break}_=W;return}d=+h[W+80>>2];S=+h[W+96>>2]-d;f=+h[W+80+4>>2];C=+h[W+96+4>>2]-f;g=+h[W+80+8>>2];a=+h[W+96+8>>2]-g;a=+G(+(S*S+C*C+a*a))-y;if(a<u|b){r[W+240>>2]=r[t+4>>2];r[W+240+4>>2]=r[t+4+4>>2];r[W+240+8>>2]=r[t+4+8>>2];r[W+240+12>>2]=r[t+4+12>>2];E=+h[W+240>>2];M=+h[k>>2];c=+h[O>>2];u=1.0/+G(+(E*E+M*M+c*c));h[W+240>>2]=E*u;h[k>>2]=M*u;h[O>>2]=c*u;r[t+60>>2]=6;u=a;c=v*l+d;l=v*p+f;a=v*m+g;break}r[t+60>>2]=5;if(x){l=M;a=E;break}_=W;return}C=+h[W+80>>2];p=+h[W+96>>2];l=+h[W+80+4>>2];f=+h[W+96+4>>2];a=+h[W+80+8>>2];m=+h[W+96+8>>2];if(!((C-p)*(C-p)+(l-f)*(l-f)+(a-m)*(a-m)<=1.4210854715202004e-14)){d=(C-p)*(C-p)+(l-f)*(l-f)+(a-m)*(a-m);g=C-p;y=a-m;v=0.0;S=l-f}else{g=+h[t+4>>2];S=+h[t+8>>2];y=+h[t+12>>2];d=g*g+S*S+y*y;v=+h[t+16>>2]}if(!(d>1.4210854715202004e-14)){r[t+60>>2]=9;if(x){l=M;a=E;break}_=W;return}d=1.0/+G(+d);p=-+G(+((p-C)*(p-C)+(f-l)*(f-l)+(m-a)*(m-a)));r[t+60>>2]=3;if(!(u>p|b)){r[t+60>>2]=8;if(x){l=M;a=E;break}_=W;return}M=y*d;y=S*d;g=g*d;h[W+240>>2]=g;h[k>>2]=y;h[O>>2]=M;h[W+240+12>>2]=v;u=g*+h[e+4>>2]+y*+h[e+20>>2]+M*+h[e+36>>2];c=g*+h[e+8>>2]+y*+h[e+24>>2]+M*+h[e+40>>2];h[W+64>>2]=+h[e>>2]*g+ +h[e+16>>2]*y+ +h[e+32>>2]*M;h[W+64+4>>2]=u;h[W+64+8>>2]=c;h[W+64+12>>2]=0.0;c=+h[e+68>>2]*-g+ +h[e+84>>2]*-y+ +h[e+100>>2]*-M;u=+h[e+72>>2]*-g+ +h[e+88>>2]*-y+ +h[e+104>>2]*-M;h[W+48>>2]=+h[e+64>>2]*-g+ +h[e+80>>2]*-y+ +h[e+96>>2]*-M;h[W+48+4>>2]=c;h[W+48+8>>2]=u;h[W+48+12>>2]=0.0;ET(W+32|0,r[t+28>>2]|0,W+64|0);ET(W+16|0,r[t+32>>2]|0,W+48|0);u=+h[W+32>>2];c=+h[W+32+4>>2];M=+h[W+32+8>>2];y=+h[W+16>>2];g=+h[W+16+4>>2];m=+h[W+16+8>>2];E=+h[W+240>>2];S=+h[k>>2];v=+h[O>>2];m=-((u*+h[W+176+16>>2]+c*+h[W+176+20>>2]+M*+h[W+176+24>>2]+ +h[I>>2]-(y*+h[W+112+16>>2]+g*+h[W+112+20>>2]+m*+h[W+112+24>>2]+ +h[P>>2]))*S)-(u*+h[W+176>>2]+c*+h[W+176+4>>2]+M*+h[W+176+8>>2]+ +h[W+176+48>>2]-(y*+h[W+112>>2]+g*+h[W+112+4>>2]+m*+h[W+112+8>>2]+ +h[W+112+48>>2]))*E-(u*+h[W+176+32>>2]+c*+h[W+176+36>>2]+M*+h[W+176+40>>2]+ +h[L>>2]-(y*+h[W+112+32>>2]+g*+h[W+112+36>>2]+m*+h[W+112+40>>2]+ +h[D>>2]))*v;g=+h[e+4>>2]*-E+ +h[e+20>>2]*-S+ +h[e+36>>2]*-v;y=+h[e+8>>2]*-E+ +h[e+24>>2]*-S+ +h[e+40>>2]*-v;h[W+64>>2]=+h[e>>2]*-E+ +h[e+16>>2]*-S+ +h[e+32>>2]*-v;h[W+64+4>>2]=g;h[W+64+8>>2]=y;h[W+64+12>>2]=0.0;y=E*+h[e+68>>2]+S*+h[e+84>>2]+v*+h[e+100>>2];g=E*+h[e+72>>2]+S*+h[e+88>>2]+v*+h[e+104>>2];h[W+48>>2]=+h[e+64>>2]*E+ +h[e+80>>2]*S+ +h[e+96>>2]*v;h[W+48+4>>2]=y;h[W+48+8>>2]=g;h[W+48+12>>2]=0.0;ET(W+32|0,r[t+28>>2]|0,W+64|0);ET(W+16|0,r[t+32>>2]|0,W+48|0);g=+h[W+32>>2];y=+h[W+32+4>>2];v=+h[W+32+8>>2];S=+h[W+16>>2];E=+h[W+16+4>>2];M=+h[W+16+8>>2];c=+h[W+240>>2];u=+h[k>>2];d=+h[O>>2];if(m>(g*+h[W+176>>2]+y*+h[W+176+4>>2]+v*+h[W+176+8>>2]+ +h[W+176+48>>2]-(S*+h[W+112>>2]+E*+h[W+112+4>>2]+M*+h[W+112+8>>2]+ +h[W+112+48>>2]))*c+(g*+h[W+176+16>>2]+y*+h[W+176+20>>2]+v*+h[W+176+24>>2]+ +h[I>>2]-(S*+h[W+112+16>>2]+E*+h[W+112+20>>2]+M*+h[W+112+24>>2]+ +h[P>>2]))*u+(g*+h[W+176+32>>2]+y*+h[W+176+36>>2]+v*+h[W+176+40>>2]+ +h[L>>2]-(S*+h[W+112+32>>2]+E*+h[W+112+36>>2]+M*+h[W+112+40>>2]+ +h[D>>2]))*d){r[t+60>>2]=10;h[W+240>>2]=-c;h[k>>2]=-u;h[O>>2]=-d}u=p;c=C}else j=56}while(0);if((j|0)==56)if(x){l=M;a=E}else{_=W;return}if(!(u<0.0)?!(u*u<+h[e+128>>2]):0){_=W;return}r[t+4>>2]=r[W+240>>2];r[t+4+4>>2]=r[W+240+4>>2];r[t+4+8>>2]=r[W+240+8>>2];r[t+4+12>>2]=r[W+240+12>>2];h[t+56>>2]=u;j=r[(r[i>>2]|0)+16>>2]|0;h[W>>2]=(F+B)*.5+c;h[W+4>>2]=(N+U)*.5+l;h[W+8>>2]=(V+z)*.5+a;h[W+12>>2]=0.0;Uk[j&15](i,W+240|0,W,u);_=W;return}function sS(t){t=t|0;Ql(t);return}function rS(t,e,i,s,o,a,l,c,u,p){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;l=l|0;c=c|0;u=u|0;p=p|0;var f=0.0,m=0,g=0,b=0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0,A=0,E=0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0;E=_;_=_+4224|0;if(((r[i+4>>2]|0)+-17|0)>>>0<2)A=((r[s+4>>2]|0)+-17|0)>>>0<2;else A=0;t=0;do{oS();y=+h[20188+(t<<4)>>2];v=+h[20188+(t<<4)+4>>2];S=+h[20188+(t<<4)+8>>2];C=+h[o+4>>2]*-y+ +h[o+20>>2]*-v+ +h[o+36>>2]*-S;x=+h[o+8>>2]*-y+ +h[o+24>>2]*-v+ +h[o+40>>2]*-S;h[E+1248+(t<<4)>>2]=+h[o>>2]*-y+ +h[o+16>>2]*-v+ +h[o+32>>2]*-S;h[E+1248+(t<<4)+4>>2]=C;h[E+1248+(t<<4)+8>>2]=x;h[E+1248+(t<<4)+12>>2]=0.0;x=y*+h[a+4>>2]+v*+h[a+20>>2]+S*+h[a+36>>2];C=y*+h[a+8>>2]+v*+h[a+24>>2]+S*+h[a+40>>2];h[E+256+(t<<4)>>2]=y*+h[a>>2]+v*+h[a+16>>2]+S*+h[a+32>>2];h[E+256+(t<<4)+4>>2]=x;h[E+256+(t<<4)+8>>2]=C;h[E+256+(t<<4)+12>>2]=0.0;t=t+1|0}while((t|0)!=42);t=ck[r[(r[i>>2]|0)+84>>2]&127](i)|0;if((t|0)>0){m=0;g=42;while(1){Vk[r[(r[i>>2]|0)+88>>2]&127](i,m,E+176|0);x=+h[E+176>>2];C=+h[E+176+4>>2];S=+h[E+176+8>>2];v=x*+h[o+16>>2]+C*+h[o+20>>2]+S*+h[o+24>>2];y=x*+h[o+32>>2]+C*+h[o+36>>2]+S*+h[o+40>>2];h[E+176>>2]=+h[o>>2]*x+ +h[o+4>>2]*C+ +h[o+8>>2]*S;h[E+176+4>>2]=v;h[E+176+8>>2]=y;h[E+176+12>>2]=0.0;oS();T=20188+(g<<4)|0;r[T>>2]=r[E+176>>2];r[T+4>>2]=r[E+176+4>>2];r[T+8>>2]=r[E+176+8>>2];r[T+12>>2]=r[E+176+12>>2];y=+h[E+176>>2];v=+h[E+176+4>>2];S=+h[E+176+8>>2];C=+h[o+4>>2]*-y+ +h[o+20>>2]*-v+ +h[o+36>>2]*-S;x=+h[o+8>>2]*-y+ +h[o+24>>2]*-v+ +h[o+40>>2]*-S;h[E+1248+(g<<4)>>2]=+h[o>>2]*-y+ +h[o+16>>2]*-v+ +h[o+32>>2]*-S;h[E+1248+(g<<4)+4>>2]=C;h[E+1248+(g<<4)+8>>2]=x;h[E+1248+(g<<4)+12>>2]=0.0;x=y*+h[a+4>>2]+v*+h[a+20>>2]+S*+h[a+36>>2];C=y*+h[a+8>>2]+v*+h[a+24>>2]+S*+h[a+40>>2];h[E+256+(g<<4)>>2]=+h[a>>2]*y+ +h[a+16>>2]*v+ +h[a+32>>2]*S;h[E+256+(g<<4)+4>>2]=x;h[E+256+(g<<4)+8>>2]=C;h[E+256+(g<<4)+12>>2]=0.0;m=m+1|0;if((m|0)==(t|0))break;else g=g+1|0}g=t+42|0}else g=42;t=ck[r[(r[s>>2]|0)+84>>2]&127](s)|0;if((t|0)>0){m=0;b=g;while(1){Vk[r[(r[s>>2]|0)+88>>2]&127](s,m,E+176|0);x=+h[E+176>>2];C=+h[E+176+4>>2];S=+h[E+176+8>>2];v=x*+h[a+16>>2]+C*+h[a+20>>2]+S*+h[a+24>>2];y=x*+h[a+32>>2]+C*+h[a+36>>2]+S*+h[a+40>>2];h[E+176>>2]=+h[a>>2]*x+ +h[a+4>>2]*C+ +h[a+8>>2]*S;h[E+176+4>>2]=v;h[E+176+8>>2]=y;h[E+176+12>>2]=0.0;oS();T=20188+(b<<4)|0;r[T>>2]=r[E+176>>2];r[T+4>>2]=r[E+176+4>>2];r[T+8>>2]=r[E+176+8>>2];r[T+12>>2]=r[E+176+12>>2];y=+h[E+176>>2];v=+h[E+176+4>>2];S=+h[E+176+8>>2];C=+h[o+4>>2]*-y+ +h[o+20>>2]*-v+ +h[o+36>>2]*-S;x=+h[o+8>>2]*-y+ +h[o+24>>2]*-v+ +h[o+40>>2]*-S;h[E+1248+(b<<4)>>2]=+h[o>>2]*-y+ +h[o+16>>2]*-v+ +h[o+32>>2]*-S;h[E+1248+(b<<4)+4>>2]=C;h[E+1248+(b<<4)+8>>2]=x;h[E+1248+(b<<4)+12>>2]=0.0;x=y*+h[a+4>>2]+v*+h[a+20>>2]+S*+h[a+36>>2];C=y*+h[a+8>>2]+v*+h[a+24>>2]+S*+h[a+40>>2];h[E+256+(b<<4)>>2]=+h[a>>2]*y+ +h[a+16>>2]*v+ +h[a+32>>2]*S;h[E+256+(b<<4)+4>>2]=x;h[E+256+(b<<4)+8>>2]=C;h[E+256+(b<<4)+12>>2]=0.0;m=m+1|0;if((m|0)==(t|0))break;else b=b+1|0}g=t+g|0}jk[r[(r[i>>2]|0)+76>>2]&127](i,E+1248|0,E+3232|0,g);jk[r[(r[s>>2]|0)+76>>2]&127](s,E+256|0,E+2240|0,g);if((g|0)>0){T=0;t=0;m=0;b=0;x=0.0;v=999999984306749440.0;while(1){oS();f=+h[20188+(T<<4)>>2];y=+h[20188+(T<<4)+4>>2];C=+h[20188+(T<<4)+12>>2];S=A?0.0:+h[20188+(T<<4)+8>>2];if(f*f+y*y+S*S>.01?(R=+h[E+3232+(T<<4)>>2],M=+h[E+3232+(T<<4)+4>>2],w=+h[E+3232+(T<<4)+8>>2],L=+h[E+2240+(T<<4)>>2],P=+h[E+2240+(T<<4)+4>>2],I=+h[E+2240+(T<<4)+8>>2],w=f*(L*+h[a>>2]+P*+h[a+4>>2]+I*+h[a+8>>2]+ +h[a+48>>2]-(R*+h[o>>2]+M*+h[o+4>>2]+w*+h[o+8>>2]+ +h[o+48>>2]))+y*(L*+h[a+16>>2]+P*+h[a+20>>2]+I*+h[a+24>>2]+ +h[a+52>>2]-(R*+h[o+16>>2]+M*+h[o+20>>2]+w*+h[o+24>>2]+ +h[o+52>>2]))+S*((A?0.0:L*+h[a+32>>2]+P*+h[a+36>>2]+I*+h[a+40>>2]+ +h[a+56>>2])-(A?0.0:R*+h[o+32>>2]+M*+h[o+36>>2]+w*+h[o+40>>2]+ +h[o+56>>2])),w<v):0){t=(h[d>>2]=f,r[d>>2]|0);m=(h[d>>2]=y,r[d>>2]|0);b=(h[d>>2]=S,r[d>>2]|0);v=w}else C=x;T=T+1|0;if((T|0)==(g|0)){T=t;g=b;break}else x=C}}else{T=0;m=0;g=0;C=0.0;v=999999984306749440.0}switch(r[i+4>>2]|0){case 4:case 5:case 10:case 11:case 13:case 1:case 0:case 8:break;default:+xk[r[(r[i>>2]|0)+48>>2]&15](i)}S=(r[d>>2]=T,+h[d>>2]);x=(r[d>>2]=m,+h[d>>2]);w=(r[d>>2]=g,+h[d>>2]);switch(r[s+4>>2]|0){case 4:case 5:case 10:case 11:case 13:case 1:case 0:case 8:break;default:+xk[r[(r[s>>2]|0)+48>>2]&15](s)}if(v<0.0){l=0;_=E;return l|0}switch(r[i+4>>2]|0){case 8:{f=+h[i+32>>2]*+h[i+16>>2];break}case 0:{f=+h[i+48>>2];break}case 1:{f=+h[i+48>>2];break}case 13:{f=+h[i+48>>2];break}case 11:{f=+h[i+48>>2];break}case 10:{f=+h[i+48>>2];break}case 4:case 5:{f=+h[i+48>>2];break}default:f=+xk[r[(r[i>>2]|0)+48>>2]&15](i)}t=r[s+4>>2]|0;switch(t|0){case 8:{y=+h[s+32>>2]*+h[s+16>>2];t=8;break}case 0:{y=+h[s+48>>2];t=0;break}case 1:{y=+h[s+48>>2];t=1;break}case 13:{y=+h[s+48>>2];t=13;break}case 11:{y=+h[s+48>>2];t=11;break}case 10:{y=+h[s+48>>2];t=10;break}case 4:case 5:{y=+h[s+48>>2];break}default:{y=+xk[r[(r[s>>2]|0)+48>>2]&15](s);t=r[s+4>>2]|0}}f=v+(f+y+.5);r[E+176>>2]=6928;r[E+176+4>>2]=0;r[E+176+8>>2]=1065353216;r[E+176+12>>2]=0;h[E+176+16>>2]=0.0;r[E+176+20>>2]=0;r[E+176+24>>2]=e;r[E+176+28>>2]=i;r[E+176+32>>2]=s;r[E+176+36>>2]=r[i+4>>2];r[E+176+40>>2]=t;h[E+176+44>>2]=+xk[r[(r[i>>2]|0)+48>>2]&15](i);h[E+176+48>>2]=+xk[r[(r[s>>2]|0)+48>>2]&15](s);n[E+176+52>>0]=0;r[E+176+60>>2]=-1;r[E+176+72>>2]=1;r[E+176+76>>2]=1;I=S*f+ +h[o+48>>2];P=x*f+ +h[o+52>>2];L=w*f+ +h[o+56>>2];r[E+44>>2]=r[o>>2];r[E+44+4>>2]=r[o+4>>2];r[E+44+8>>2]=r[o+8>>2];r[E+44+12>>2]=r[o+12>>2];r[E+44+16>>2]=r[o+16>>2];r[E+44+16+4>>2]=r[o+16+4>>2];r[E+44+16+8>>2]=r[o+16+8>>2];r[E+44+16+12>>2]=r[o+16+12>>2];r[E+44+32>>2]=r[o+32>>2];r[E+44+32+4>>2]=r[o+32+4>>2];r[E+44+32+8>>2]=r[o+32+8>>2];r[E+44+32+12>>2]=r[o+32+12>>2];h[E+44+48>>2]=I;h[E+44+52>>2]=P;h[E+44+56>>2]=L;h[E+44+60>>2]=0.0;r[E+44+64>>2]=r[a>>2];r[E+44+64+4>>2]=r[a+4>>2];r[E+44+64+8>>2]=r[a+8>>2];r[E+44+64+12>>2]=r[a+12>>2];r[E+44+80>>2]=r[a+16>>2];r[E+44+80+4>>2]=r[a+16+4>>2];r[E+44+80+8>>2]=r[a+16+8>>2];r[E+44+80+12>>2]=r[a+16+12>>2];r[E+44+96>>2]=r[a+32>>2];r[E+44+96+4>>2]=r[a+32+4>>2];r[E+44+96+8>>2]=r[a+32+8>>2];r[E+44+96+12>>2]=r[a+32+12>>2];r[E+44+112>>2]=r[a+48>>2];r[E+44+112+4>>2]=r[a+48+4>>2];r[E+44+112+8>>2]=r[a+48+8>>2];r[E+44+112+12>>2]=r[a+48+12>>2];h[E+44+128>>2]=999999984306749440.0;r[E>>2]=6968;n[E+40>>0]=0;h[E+176+4>>2]=-S;h[E+176+8>>2]=-x;h[E+176+12>>2]=-w;h[E+176+16>>2]=0.0;nS(E+176|0,E+44|0,E,p,0);f=f-+h[E+36>>2];t=n[E+40>>0]|0;if(t<<24>>24){P=+h[E+24>>2]-x*f;L=+h[E+28>>2]-w*f;h[c>>2]=+h[E+20>>2]-S*f;h[c+4>>2]=P;h[c+8>>2]=L;h[c+12>>2]=0.0;r[u>>2]=r[E+20>>2];r[u+4>>2]=r[E+20+4>>2];r[u+8>>2]=r[E+20+8>>2];r[u+12>>2]=r[E+20+12>>2];r[l>>2]=T;r[l+4>>2]=m;r[l+8>>2]=g;h[l+12>>2]=C}l=t<<24>>24!=0;_=E;return l|0}function oS(){if(n[19864]|0)return;n[19864]=1;r[5047]=0;r[5048]=-2147483648;r[5049]=-1082130432;h[5050]=0.0;r[5051]=1060716128;r[5052]=-1090087446;r[5053]=-1092290076;h[5054]=0.0;r[5055]=-1098022214;r[5056]=-1084636126;r[5057]=-1092290076;h[5058]=0.0;r[5059]=-1083901670;r[5060]=-2147483648;r[5061]=-1092290177;h[5062]=0.0;r[5063]=-1098022214;r[5064]=1062847522;r[5065]=-1092290043;h[5066]=0.0;r[5067]=1060716128;r[5068]=1057396202;r[5069]=-1092290076;h[5070]=0.0;r[5071]=1049461434;r[5072]=-1084636126;r[5073]=1055193605;h[5074]=0.0;r[5075]=-1086767520;r[5076]=-1090087446;r[5077]=1055193572;h[5078]=0.0;r[5079]=-1086767520;r[5080]=1057396202;r[5081]=1055193572;h[5082]=0.0;r[5083]=1049461434;r[5084]=1062847522;r[5085]=1055193572;h[5086]=0.0;r[5087]=1063581978;r[5088]=0;r[5089]=1055193471;h[5090]=0.0;r[5091]=-2147483648;r[5092]=0;r[5093]=1065353216;h[5094]=0.0;r[5095]=1054458864;r[5096]=-1096927567;r[5097]=-1084636042;h[5098]=0.0;r[5099]=-1104782626;r[5100]=-1090519208;r[5101]=-1084636042;h[5102]=0.0;r[5103]=1049007812;r[5104]=-1085334679;r[5105]=-1090087228;h[5106]=0.0;r[5107]=1054458864;r[5108]=1050556081;r[5109]=-1084636042;h[5110]=0.0;r[5111]=1062847505;r[5112]=-2147483648;r[5113]=-1090087262;h[5114]=0.0;r[5115]=-1090087362;r[5116]=-2147483648;r[5117]=-1084636076;h[5118]=0.0;r[5119]=-1087361736;r[5120]=-1090519141;r[5121]=-1090087262;h[5122]=0.0;r[5123]=-1104782626;r[5124]=1056964440;r[5125]=-1084636042;h[5126]=0.0;r[5127]=-1087361736;r[5128]=1056964507;r[5129]=-1090087262;h[5130]=0.0;r[5131]=1049007812;r[5132]=1062148969;r[5133]=-1090087228;h[5134]=0.0;r[5135]=1064532105;r[5136]=1050556148;r[5137]=0;h[5138]=0.0;r[5139]=1064532105;r[5140]=-1096927500;r[5141]=0;h[5142]=0.0;r[5143]=1058437413;r[5144]=-1085334595;r[5145]=0;h[5146]=0.0;r[5147]=0;r[5148]=-1082130432;r[5149]=0;h[5150]=0.0;r[5151]=-1089046235;r[5152]=-1085334595;r[5153]=0;h[5154]=0.0;r[5155]=-1082951543;r[5156]=-1096927500;r[5157]=-2147483648;h[5158]=0.0;r[5159]=-1082951543;r[5160]=1050556148;r[5161]=-2147483648;h[5162]=0.0;r[5163]=-1089046235;r[5164]=1062149053;r[5165]=-2147483648;h[5166]=0.0;r[5167]=-2147483648;r[5168]=1065353216;r[5169]=-2147483648;h[5170]=0.0;r[5171]=1058437413;r[5172]=1062149053;r[5173]=-2147483648;h[5174]=0.0;r[5175]=1060121912;r[5176]=-1090519141;r[5177]=1057396386;h[5178]=0.0;r[5179]=-1098475836;r[5180]=-1085334679;r[5181]=1057396420;h[5182]=0.0;r[5183]=-1084636143;r[5184]=0;r[5185]=1057396386;h[5186]=0.0;r[5187]=-1098475836;r[5188]=1062148969;r[5189]=1057396420;h[5190]=0.0;r[5191]=1060121912;r[5192]=1056964507;r[5193]=1057396386;h[5194]=0.0;r[5195]=1057396286;r[5196]=0;r[5197]=1062847572;h[5198]=0.0;r[5199]=1042701022;r[5200]=-1090519208;r[5201]=1062847606;h[5202]=0.0;r[5203]=-1093024784;r[5204]=-1096927567;r[5205]=1062847606;h[5206]=0.0;r[5207]=-1093024784;r[5208]=1050556081;r[5209]=1062847606;h[5210]=0.0;r[5211]=1042701022;r[5212]=1056964440;r[5213]=1062847606;h[5214]=0.0;return}function aS(t){t=t|0;Ql(t);return}function lS(t,e,i){t=t|0;e=e|0;i=i|0;return}function hS(t,e,i){t=t|0;e=e|0;i=i|0;return}function cS(t,e,i,s){t=t|0;e=e|0;i=i|0;s=+s;r[t+4>>2]=r[e>>2];r[t+4+4>>2]=r[e+4>>2];r[t+4+8>>2]=r[e+8>>2];r[t+4+12>>2]=r[e+12>>2];r[t+20>>2]=r[i>>2];r[t+20+4>>2]=r[i+4>>2];r[t+20+8>>2]=r[i+8>>2];r[t+20+12>>2]=r[i+12>>2];h[t+36>>2]=s;n[t+40>>0]=1;return}function _S(t,e){t=t|0;e=e|0;var i=0,n=0.0,s=0,o=0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0,w=0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0;i=r[t+748>>2]|0;if((i|0)!=4){r[t+748>>2]=i+1;w=i;x=(w|0)<0;w=x?0:w;t=t+4+(w*184|0)|0;Oh(t|0,e|0,184)|0;return w|0}C=+h[e+80>>2];S=+h[t+84>>2];v=S<C?S:C;y=+h[t+268>>2];b=y<v?y:v;g=+h[t+452>>2];x=+h[t+636>>2]<(g<b?g:b);i=x?3:g<b?2:y<v?1:(S<C^1)<<31>>31;C=+h[e>>2];if(i){n=+h[t+188>>2];f=+h[e+4>>2];_=+h[t+192>>2];a=+h[e+8>>2];l=+h[t+196>>2];p=+h[t+556>>2];v=+h[t+372>>2];g=+h[t+560>>2];S=+h[t+376>>2];y=+h[t+564>>2];u=+h[t+380>>2];o=(h[d>>2]=((C-n)*(g-S)-(f-_)*(p-v))*((C-n)*(g-S)-(f-_)*(p-v))+(((f-_)*(y-u)-(a-l)*(g-S))*((f-_)*(y-u)-(a-l)*(g-S))+((a-l)*(p-v)-(C-n)*(y-u))*((a-l)*(p-v)-(C-n)*(y-u))),r[d>>2]|0);if((i|0)==1){c=+h[t+8>>2];m=+h[t+12>>2];b=g;g=+h[t+4>>2];s=0;w=7}else{b=g;w=6}}else{n=+h[t+188>>2];_=+h[t+192>>2];l=+h[t+196>>2];f=+h[e+4>>2];a=+h[e+8>>2];p=+h[t+556>>2];v=+h[t+372>>2];b=+h[t+560>>2];S=+h[t+376>>2];y=+h[t+564>>2];u=+h[t+380>>2];o=0;w=6}if((w|0)==6){g=+h[t+4>>2];c=+h[t+8>>2];R=f-c;m=+h[t+12>>2];E=a-m;A=p-v;M=b-S;T=y-u;s=(h[d>>2]=((C-g)*M-R*A)*((C-g)*M-R*A)+((R*T-E*M)*(R*T-E*M)+(E*A-(C-g)*T)*(E*A-(C-g)*T)),r[d>>2]|0);if((i|0)==2){b=v;p=S;i=0;w=8}else w=7}if((w|0)==7){M=C-g;I=f-c;A=a-m;E=p-n;T=b-_;R=y-l;i=(h[d>>2]=(M*T-I*E)*(M*T-I*E)+((I*R-A*T)*(I*R-A*T)+(A*E-M*R)*(A*E-M*R)),r[d>>2]|0);if(x)n=0.0;else{b=v;p=S;w=8}}if((w|0)==8){I=C-g;A=f-c;M=a-m;R=b-n;E=p-_;n=u-l;n=(I*E-A*R)*(I*E-A*R)+((A*n-M*E)*(A*n-M*E)+(M*R-I*n)*(M*R-I*n))}I=+W(+(r[d>>2]=o,+h[d>>2]));M=+W(+(r[d>>2]=s,+h[d>>2]));A=+W(+(r[d>>2]=i,+h[d>>2]));T=+W(+n);R=I>-999999984306749440.0?I:-999999984306749440.0;E=M>R?M:R;w=T>(A>E?A:E)?3:A>E?2:M>R?1:(I>-999999984306749440.0^1)<<31>>31;x=(w|0)<0;w=x?0:w;t=t+4+(w*184|0)|0;Oh(t|0,e|0,184)|0;return w|0}function uS(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0.0,a=0.0,l=0,c=0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0;s=r[t+748>>2]|0;if((s|0)<=0)return;do{c=s;s=s+-1|0;f=+h[t+4+(s*184|0)>>2];m=+h[t+4+(s*184|0)+4>>2];o=+h[t+4+(s*184|0)+8>>2];p=f*+h[e>>2]+m*+h[e+4>>2]+o*+h[e+8>>2]+ +h[e+48>>2];u=f*+h[e+16>>2]+m*+h[e+20>>2]+o*+h[e+24>>2]+ +h[e+52>>2];o=f*+h[e+32>>2]+m*+h[e+36>>2]+o*+h[e+40>>2]+ +h[e+56>>2];h[t+4+(s*184|0)+48>>2]=p;h[t+4+(s*184|0)+52>>2]=u;h[t+4+(s*184|0)+56>>2]=o;h[t+4+(s*184|0)+60>>2]=0.0;m=+h[t+4+(s*184|0)+16>>2];f=+h[t+4+(s*184|0)+20>>2];a=+h[t+4+(s*184|0)+24>>2];d=m*+h[i>>2]+f*+h[i+4>>2]+a*+h[i+8>>2]+ +h[i+48>>2];_=m*+h[i+16>>2]+f*+h[i+20>>2]+a*+h[i+24>>2]+ +h[i+52>>2];a=m*+h[i+32>>2]+f*+h[i+36>>2]+a*+h[i+40>>2]+ +h[i+56>>2];h[t+4+(s*184|0)+32>>2]=d;h[t+4+(s*184|0)+36>>2]=_;h[t+4+(s*184|0)+40>>2]=a;h[t+4+(s*184|0)+44>>2]=0.0;h[t+4+(s*184|0)+80>>2]=(p-d)*+h[t+4+(s*184|0)+64>>2]+(u-_)*+h[t+4+(s*184|0)+68>>2]+(o-a)*+h[t+4+(s*184|0)+72>>2];l=t+4+(s*184|0)+148|0;r[l>>2]=(r[l>>2]|0)+1}while((c|0)>1);s=r[t+748>>2]|0;if((s|0)<=0)return;i=s;l=s;while(1){c=l;l=l+-1|0;e=t+4+(l*184|0)|0;o=+h[t+4+(l*184|0)+80>>2];a=+h[t+752>>2];if(o<=a){p=+h[t+4+(l*184|0)+32>>2]-(+h[t+4+(l*184|0)+48>>2]-+h[t+4+(l*184|0)+64>>2]*o);f=+h[t+4+(l*184|0)+36>>2]-(+h[t+4+(l*184|0)+52>>2]-o*+h[t+4+(l*184|0)+68>>2]);m=+h[t+4+(l*184|0)+40>>2]-(+h[t+4+(l*184|0)+56>>2]-o*+h[t+4+(l*184|0)+72>>2]);if(p*p+f*f+m*m>a*a){s=i+-1|0;if((s|0)==(l|0))s=i;else{Oh(e|0,t+4+(s*184|0)|0,184)|0;r[t+4+(s*184|0)+112>>2]=0;h[t+4+(s*184|0)+120>>2]=0.0;n[t+4+(s*184|0)+116>>0]=0;h[t+4+(s*184|0)+124>>2]=0.0;h[t+4+(s*184|0)+128>>2]=0.0;r[t+4+(s*184|0)+148>>2]=0;s=r[t+748>>2]|0}s=s+-1|0;r[t+748>>2]=s}else s=i}else{s=i+-1|0;if((s|0)==(l|0))s=i;else{Oh(e|0,t+4+(s*184|0)|0,184)|0;r[t+4+(s*184|0)+112>>2]=0;h[t+4+(s*184|0)+120>>2]=0.0;n[t+4+(s*184|0)+116>>0]=0;h[t+4+(s*184|0)+124>>2]=0.0;h[t+4+(s*184|0)+128>>2]=0.0;r[t+4+(s*184|0)+148>>2]=0;s=r[t+748>>2]|0}s=s+-1|0;r[t+748>>2]=s}if((c|0)<=1)break;else i=s}return}function dS(t,e,i,n,s,r,o,a,l,c,_){t=t|0;e=e|0;i=+i;n=+n;s=+s;r=+r;o=+o;a=+a;l=l|0;c=c|0;_=+_;var u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0;w=+h[t>>2]*r+ +h[t+16>>2]*o+ +h[t+32>>2]*a;S=+h[t+4>>2]*r+ +h[t+20>>2]*o+ +h[t+36>>2]*a;y=+h[t+8>>2]*r+ +h[t+24>>2]*o+ +h[t+40>>2]*a;b=+h[e>>2]*r+ +h[e+16>>2]*o+ +h[e+32>>2]*a;m=+h[e+4>>2]*r+ +h[e+20>>2]*o+ +h[e+36>>2]*a;p=+h[e+8>>2]*r+ +h[e+24>>2]*o+ +h[e+40>>2]*a;x=+h[l+80>>2];v=+h[l+84>>2];f=+h[l+88>>2];g=+h[c+80>>2];u=+h[c+84>>2];d=+h[c+88>>2];f=w*(w<0.0?-x:x)+S*(S<0.0?-v:v)+y*(y<0.0?-f:f);d=b*(b<0.0?-g:g)+m*(m<0.0?-u:u)+p*(p<0.0?-d:d);p=+h[l+96>>2];u=+h[c+96>>2];u=(f>p?f:p)+(d>u?d:u);return!((i*r+n*o+s*a+u<u-(i*r+n*o+s*a)?i*r+n*o+s*a+u:u-(i*r+n*o+s*a))>_)|0}function pS(t,e,i,s,o,a,l){t=t|0;e=e|0;i=i|0;s=s|0;o=+o;a=+a;l=l|0;var c=0,u=0,d=0.0,p=0,f=0.0,m=0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0,R=0,I=0.0,P=0.0,L=0.0,D=0,k=0,O=0,F=0,B=0,N=0,U=0,V=0,z=0,W=0,G=0,j=0,H=0,X=0,Y=0,q=0,K=0,Z=0.0,Q=0.0,$=0.0,J=0.0,tt=0,et=0;K=_;_=_+64|0;n[K+32+16>>0]=1;q=K+32+12|0;r[q>>2]=0;r[K+32+4>>2]=0;r[K+32+8>>2]=0;m=r[s+4>>2]|0;if((m|0)>0){r[5637]=(r[5637]|0)+1;c=Zl((m<<4|3)+16|0)|0;if(!c)p=0;else{r[(c+4+15&-16)+-4>>2]=c;p=c+4+15&-16}c=r[K+32+4>>2]|0;if((c|0)>0){u=0;do{Y=p+(u<<4)|0;X=(r[q>>2]|0)+(u<<4)|0;r[Y>>2]=r[X>>2];r[Y+4>>2]=r[X+4>>2];r[Y+8>>2]=r[X+8>>2];r[Y+12>>2]=r[X+12>>2];u=u+1|0}while((u|0)!=(c|0))}c=r[q>>2]|0;if(c|0){if(n[K+32+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[c+-4>>2]|0)}r[q>>2]=0}n[K+32+16>>0]=1;r[q>>2]=p;r[K+32+8>>2]=m}c=r[e+28>>2]|0;if((c|0)>0){X=r[e+36>>2]|0;A=+h[i>>2];E=+h[i+4>>2];I=+h[i+8>>2];P=+h[i+16>>2];L=+h[i+20>>2];b=+h[i+24>>2];g=+h[i+32>>2];f=+h[i+36>>2];d=+h[i+40>>2];y=+h[t>>2];v=+h[t+4>>2];S=+h[t+8>>2];Y=-1;T=3402823466385288598117041.0e14;p=0;while(1){x=+h[X+(p*36|0)+20>>2];w=+h[X+(p*36|0)+24>>2];C=+h[X+(p*36|0)+28>>2];u=(x*A+w*E+C*I)*y+(x*P+w*L+C*b)*v+(x*g+w*f+C*d)*S<T;Y=u?p:Y;p=p+1|0;if((p|0)==(c|0))break;else T=u?(x*A+w*E+C*I)*y+(x*P+w*L+C*b)*v+(x*g+w*f+C*d)*S:T}if((Y|0)>=0){B=r[X+(Y*36|0)+4>>2]|0;if((B|0)>0){N=X+(Y*36|0)+12|0;U=X+(Y*36|0)+20|0;V=X+(Y*36|0)+24|0;z=X+(Y*36|0)+28|0;y=A;w=E;x=I;S=P;v=L;F=0;O=s;s=K+32|0;while(1){k=r[N>>2]|0;c=r[k+(F<<2)>>2]|0;D=r[e+16>>2]|0;F=F+1|0;k=r[k+(((F|0)==(B|0)?0:F)<<2)>>2]|0;Q=+h[D+(c<<4)>>2];$=Q-+h[D+(k<<4)>>2];Z=+h[D+(c<<4)+4>>2];J=Z-+h[D+(k<<4)+4>>2];C=+h[D+(c<<4)+8>>2];E=C-+h[D+(k<<4)+8>>2];T=$*y+J*w+E*x;A=$*S+J*v+E*b;E=$*g+J*f+E*d;J=+h[U>>2];$=+h[V>>2];L=+h[z>>2];I=y*J+w*$+x*L;P=S*J+v*$+b*L;L=g*J+f*$+d*L;v=(Q*y+Z*w+C*x+ +h[i+48>>2])*-(A*L-E*P)+(Q*S+Z*v+C*b+ +h[i+52>>2])*-(E*I-T*L)+(Q*g+Z*f+C*d+ +h[i+56>>2])*-(T*P-A*I);k=O;D=s;c=r[k+4>>2]|0;if((c|0)>=2){p=r[k+12>>2]|0;f=+h[p+(c+-1<<4)>>2];g=+h[p+(c+-1<<4)+4>>2];b=+h[p+(c+-1<<4)+8>>2];d=f*-(A*L-E*P)+g*-(E*I-T*L)+b*-(T*P-A*I)-v;R=0;while(1){S=+h[p+(R<<4)>>2];x=+h[p+(R<<4)+4>>2];w=+h[p+(R<<4)+8>>2];M=r[p+(R<<4)+12>>2]|0;C=S*-(A*L-E*P)+x*-(E*I-T*L)+w*-(T*P-A*I)-v;do{if(d<0.0)if(C<0.0){u=r[D+4>>2]|0;if((u|0)==(r[D+8>>2]|0)?(W=u|0?u<<1:1,(u|0)<(W|0)):0){if(!W)m=0;else{r[5637]=(r[5637]|0)+1;u=Zl((W<<4|3)+16|0)|0;if(!u)u=0;else{r[(u+4+15&-16)+-4>>2]=u;u=u+4+15&-16}m=u;u=r[D+4>>2]|0}if((u|0)>0){p=0;do{tt=m+(p<<4)|0;et=(r[D+12>>2]|0)+(p<<4)|0;r[tt>>2]=r[et>>2];r[tt+4>>2]=r[et+4>>2];r[tt+8>>2]=r[et+8>>2];r[tt+12>>2]=r[et+12>>2];p=p+1|0}while((p|0)!=(u|0))}u=r[D+12>>2]|0;if(u|0){if(n[D+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0)}r[D+12>>2]=0}n[D+16>>0]=1;r[D+12>>2]=m;r[D+8>>2]=W;u=r[D+4>>2]|0}et=r[D+12>>2]|0;h[et+(u<<4)>>2]=S;h[et+(u<<4)+4>>2]=x;h[et+(u<<4)+8>>2]=w;r[et+(u<<4)+12>>2]=M;r[D+4>>2]=(r[D+4>>2]|0)+1;break}else{d=d/(d-C);y=f+(S-f)*d;f=g+(x-g)*d;d=b+(w-b)*d;u=r[D+4>>2]|0;if((u|0)==(r[D+8>>2]|0)?(G=u|0?u<<1:1,(u|0)<(G|0)):0){if(!G)m=0;else{r[5637]=(r[5637]|0)+1;u=Zl((G<<4|3)+16|0)|0;if(!u)u=0;else{r[(u+4+15&-16)+-4>>2]=u;u=u+4+15&-16}m=u;u=r[D+4>>2]|0}if((u|0)>0){p=0;do{et=m+(p<<4)|0;tt=(r[D+12>>2]|0)+(p<<4)|0;r[et>>2]=r[tt>>2];r[et+4>>2]=r[tt+4>>2];r[et+8>>2]=r[tt+8>>2];r[et+12>>2]=r[tt+12>>2];p=p+1|0}while((p|0)!=(u|0))}u=r[D+12>>2]|0;if(u|0){if(n[D+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0)}r[D+12>>2]=0}n[D+16>>0]=1;r[D+12>>2]=m;r[D+8>>2]=G;u=r[D+4>>2]|0}et=r[D+12>>2]|0;h[et+(u<<4)>>2]=y;h[et+(u<<4)+4>>2]=f;h[et+(u<<4)+8>>2]=d;h[et+(u<<4)+12>>2]=0.0;r[D+4>>2]=(r[D+4>>2]|0)+1;break}else if(C<0.0){d=d/(d-C);y=f+(S-f)*d;f=g+(x-g)*d;d=b+(w-b)*d;u=r[D+4>>2]|0;if((u|0)==(r[D+8>>2]|0)?(j=u|0?u<<1:1,(u|0)<(j|0)):0){if(!j)m=0;else{r[5637]=(r[5637]|0)+1;u=Zl((j<<4|3)+16|0)|0;if(!u)u=0;else{r[(u+4+15&-16)+-4>>2]=u;u=u+4+15&-16}m=u;u=r[D+4>>2]|0}if((u|0)>0){p=0;do{et=m+(p<<4)|0;tt=(r[D+12>>2]|0)+(p<<4)|0;r[et>>2]=r[tt>>2];r[et+4>>2]=r[tt+4>>2];r[et+8>>2]=r[tt+8>>2];r[et+12>>2]=r[tt+12>>2];p=p+1|0}while((p|0)!=(u|0))}u=r[D+12>>2]|0;if(u|0){if(n[D+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0)}r[D+12>>2]=0}n[D+16>>0]=1;r[D+12>>2]=m;r[D+8>>2]=j;u=r[D+4>>2]|0}et=r[D+12>>2]|0;h[et+(u<<4)>>2]=y;h[et+(u<<4)+4>>2]=f;h[et+(u<<4)+8>>2]=d;h[et+(u<<4)+12>>2]=0.0;u=(r[D+4>>2]|0)+1|0;r[D+4>>2]=u;if((u|0)==(r[D+8>>2]|0)?(H=u|0?u<<1:1,(u|0)<(H|0)):0){if(!H)m=0;else{r[5637]=(r[5637]|0)+1;u=Zl((H<<4|3)+16|0)|0;if(!u)u=0;else{r[(u+4+15&-16)+-4>>2]=u;u=u+4+15&-16}m=u;u=r[D+4>>2]|0}if((u|0)>0){p=0;do{et=m+(p<<4)|0;tt=(r[D+12>>2]|0)+(p<<4)|0;r[et>>2]=r[tt>>2];r[et+4>>2]=r[tt+4>>2];r[et+8>>2]=r[tt+8>>2];r[et+12>>2]=r[tt+12>>2];p=p+1|0}while((p|0)!=(u|0))}u=r[D+12>>2]|0;if(u|0){if(n[D+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0)}r[D+12>>2]=0}n[D+16>>0]=1;r[D+12>>2]=m;r[D+8>>2]=H;u=r[D+4>>2]|0}et=r[D+12>>2]|0;h[et+(u<<4)>>2]=S;h[et+(u<<4)+4>>2]=x;h[et+(u<<4)+8>>2]=w;r[et+(u<<4)+12>>2]=M;r[D+4>>2]=(r[D+4>>2]|0)+1}}while(0);u=R+1|0;if((u|0)==(c|0))break;p=r[k+12>>2]|0;d=C;f=S;b=w;g=x;R=u}c=r[k+4>>2]|0}if((c|0)<0){if((r[k+8>>2]|0)<0){u=r[k+12>>2]|0;if(u|0){if(n[k+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0)}r[k+12>>2]=0}n[k+16>>0]=1;r[k+12>>2]=0;r[k+8>>2]=0}do{et=(r[k+12>>2]|0)+(c<<4)|0;r[et>>2]=r[K>>2];r[et+4>>2]=r[K+4>>2];r[et+8>>2]=r[K+8>>2];r[et+12>>2]=r[K+12>>2];c=c+1|0}while((c|0)!=0)}r[k+4>>2]=0;y=+h[i>>2];w=+h[i+4>>2];x=+h[i+8>>2];S=+h[i+16>>2];v=+h[i+20>>2];b=+h[i+24>>2];g=+h[i+32>>2];f=+h[i+36>>2];d=+h[i+40>>2];if((F|0)>=(B|0)){p=U;u=V;c=z;M=i+48|0;R=i+52|0;m=i+56|0;break}else{et=s;s=O;O=et}}}else{p=X+(Y*36|0)+20|0;u=X+(Y*36|0)+24|0;c=X+(Y*36|0)+28|0;M=i+48|0;R=i+52|0;m=i+56|0;y=A;w=E;x=I;S=P;v=L}Q=+h[p>>2];$=+h[u>>2];J=+h[c>>2];y=Q*y+$*w+J*x;b=Q*S+$*v+J*b;g=Q*g+$*f+J*d;f=+h[X+(Y*36|0)+32>>2]-(y*+h[M>>2]+b*+h[R>>2]+g*+h[m>>2]);c=r[s+4>>2]|0;if((c|0)>0){p=0;do{u=r[s+12>>2]|0;d=f+(y*+h[u+(p<<4)>>2]+b*+h[u+(p<<4)+4>>2]+g*+h[u+(p<<4)+8>>2]);d=d<=o?o:d;if(d<=a){c=u+(p<<4)|0;r[K+16>>2]=r[c>>2];r[K+16+4>>2]=r[c+4>>2];r[K+16+8>>2]=r[c+8>>2];r[K+16+12>>2]=r[c+12>>2];Uk[r[(r[l>>2]|0)+16>>2]&15](l,t,K+16|0,d);c=r[s+4>>2]|0}p=p+1|0}while((p|0)<(c|0))}}}c=r[q>>2]|0;if(!c){_=K;return}if(n[K+32+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[c+-4>>2]|0)}r[q>>2]=0;_=K;return}function fS(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0,L=0.0,D=0;D=_;_=_+32|0;l=+h[e+16>>2];s=+h[e>>2];c=+h[e+20>>2];o=+h[e+4>>2];d=+h[e+24>>2];a=+h[e+8>>2];g=+h[e+32>>2];S=+h[e+36>>2];x=+h[e+40>>2];E=(c-o)*(x-a)-(d-a)*(S-o);M=(d-a)*(g-s)-(l-s)*(x-a);R=(l-s)*(S-o)-(c-o)*(g-s);h[D+16>>2]=E;h[D+16+4>>2]=M;h[D+16+8>>2]=R;h[D+16+12>>2]=0.0;p=+h[t+4>>2];b=+h[t+8>>2];w=+h[t+12>>2];I=E*p+M*b+R*w-(s*E+o*M+a*R);f=+h[t+20>>2];y=+h[t+24>>2];C=+h[t+28>>2];if(I*(E*f+M*y+R*C-(s*E+o*M+a*R))>=0.0){_=D;return}P=r[t+36>>2]|0;if(I<=0.0&(P&1|0)!=0){_=D;return}L=I/(I-(E*f+M*y+R*C-(s*E+o*M+a*R)));if(!(L<+h[t+40>>2])){_=D;return}A=(E*E+M*M+R*R)*-9.999999747378752e-05;T=s-(f*L+p*(1.0-L));v=o-(y*L+b*(1.0-L));m=a-(C*L+w*(1.0-L));u=l-(f*L+p*(1.0-L));c=c-(y*L+b*(1.0-L));l=d-(C*L+w*(1.0-L));if(!(R*(T*c-v*u)+(E*(v*l-m*c)+M*(m*u-T*l))>=A)){_=D;return}a=g-(f*L+p*(1.0-L));o=S-(y*L+b*(1.0-L));s=x-(C*L+w*(1.0-L));if(!(R*(u*o-c*a)+(E*(c*s-l*o)+M*(l*a-u*s))>=A)){_=D;return}if(!(R*(v*a-T*o)+(E*(m*o-v*s)+M*(T*s-m*a))>=A)){_=D;return}s=1.0/+G(+(E*E+M*M+R*R));h[D+16>>2]=E*s;h[D+16+4>>2]=M*s;h[D+16+8>>2]=R*s;e=r[(r[t>>2]|0)+12>>2]|0;if(I<=0.0&(P&2|0)==0){h[D>>2]=-(E*s);h[D+4>>2]=-(M*s);h[D+8>>2]=-(R*s);h[D+12>>2]=0.0;h[t+40>>2]=+Fk[e&3](t,D,L,i,n);_=D;return}else{h[t+40>>2]=+Fk[e&3](t,D+16|0,L,i,n);_=D;return}}function mS(t){t=t|0;Ql(t);return}function gS(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0.0,a=0.0,l=0.0,c=0.0,u=0,d=0.0;u=_;_=_+688|0;r[u+568+8>>2]=0;r[u+568+12>>2]=-1;r[u+568+16>>2]=1065353216;r[u+568+20>>2]=1065353216;r[u+568+24>>2]=1065353216;h[u+568+28>>2]=0.0;r[u+568+56>>2]=0;r[u+568>>2]=3768;r[u+568+4>>2]=1;r[u+568+60>>2]=r[e>>2];r[u+568+60+4>>2]=r[e+4>>2];r[u+568+60+8>>2]=r[e+8>>2];r[u+568+60+12>>2]=r[e+12>>2];r[u+568+76>>2]=r[e+16>>2];r[u+568+76+4>>2]=r[e+16+4>>2];r[u+568+76+8>>2]=r[e+16+8>>2];r[u+568+76+12>>2]=r[e+16+12>>2];r[u+568+92>>2]=r[e+32>>2];r[u+568+92+4>>2]=r[e+32+4>>2];r[u+568+92+8>>2]=r[e+32+8>>2];r[u+568+92+12>>2]=r[e+32+12>>2];r[u+568+48>>2]=r[t+204>>2];h[u+208+308>>2]=9.999999747378752e-05;n[u+208+332>>0]=0;r[u+200>>2]=6908;e=r[t+4>>2]|0;r[u+176>>2]=6816;r[u+176+4>>2]=u+208;r[u+176+8>>2]=u+200;r[u+176+12>>2]=e;r[u+176+16>>2]=u+568;r[u+176+20>>2]=0;r[u>>2]=3316;r[u+168>>2]=0;h[u+164>>2]=1.0;r[u+172>>2]=r[t+208>>2];if((kv(u+176|0,t+8|0,t+72|0,t+136|0,t+136|0,u)|0?(o=+h[u+132>>2],a=+h[u+136>>2],l=+h[u+140>>2],o*o+a*a+l*l>9.999999747378752e-05):0)?(c=+h[u+164>>2],c<+h[t+200>>2]):0){d=1.0/+G(+(o*o+a*a+l*l));h[u+132>>2]=o*d;h[u+136>>2]=a*d;h[u+140>>2]=l*d;+Ck[r[(r[t>>2]|0)+12>>2]&3](t,u+132|0,u+148|0,c,i,s)}r[u+568>>2]=6248;i=r[u+568+56>>2]|0;if(!i){_=u;return}ok[r[r[i>>2]>>2]&255](i);i=r[u+568+56>>2]|0;if(!i){_=u;return}r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0);_=u;return}function bS(t){t=t|0;Ql(t);return}function yS(t,e,i,s,o,a){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;var l=0,c=0.0,u=0.0,p=0.0,f=0.0,m=0,g=0,b=0,y=0.0,v=0.0,S=0.0,x=0,w=0.0,C=0,T=0,A=0.0,E=0.0,M=0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,W=0.0,j=0.0,H=0.0,X=0.0,Y=0.0,q=0.0,K=0.0,Z=0.0,Q=0.0,$=0.0,J=0.0,tt=0.0,et=0.0,it=0,nt=0.0,st=0.0,rt=0.0,ot=0,at=0.0;ot=_;_=_+128|0;F=r[t+4>>2]|0;n[F+312>>0]=0;r[F>>2]=0;n[F+356>>0]=1;r[F+292>>2]=1566444395;r[F+296>>2]=1566444395;r[F+300>>2]=1566444395;h[F+304>>2]=0.0;r[F+336>>2]=0;r[F+336+4>>2]=0;r[F+336+8>>2]=0;r[F+336+12>>2]=0;n[F+336+16>>0]=0;n[F+332>>0]=n[F+332>>0]&-16;c=+h[e+48>>2];u=+h[e+52>>2];p=+h[e+56>>2];f=+h[s+48>>2];y=+h[s+52>>2];v=+h[s+56>>2];B=+h[e>>2];N=+h[e+4>>2];U=+h[e+8>>2];V=+h[e+16>>2];z=+h[e+20>>2];W=+h[e+24>>2];j=+h[e+32>>2];H=+h[e+36>>2];X=+h[e+40>>2];Y=+h[s>>2];q=+h[s+4>>2];K=+h[s+8>>2];Z=+h[s+16>>2];Q=+h[s+20>>2];$=+h[s+24>>2];J=+h[s+32>>2];tt=+h[s+36>>2];et=+h[s+40>>2];nt=+h[i+48>>2]-c-(+h[o+48>>2]-f);st=+h[i+52>>2]-u-(+h[o+52>>2]-y);rt=+h[i+56>>2]-p-(+h[o+56>>2]-v);F=r[t+8>>2]|0;M=r[(r[F>>2]|0)+64>>2]|0;h[ot+96>>2]=B*-nt+V*-st+j*-rt;h[ot+96+4>>2]=N*-nt+z*-st+H*-rt;h[ot+96+8>>2]=U*-nt+W*-st+X*-rt;h[ot+96+12>>2]=0.0;Vk[M&127](ot+112|0,F,ot+96|0);k=+h[ot+112>>2];O=+h[ot+112+4>>2];D=+h[ot+112+8>>2];S=k*+h[e>>2]+O*+h[e+4>>2]+D*+h[e+8>>2]+ +h[e+48>>2];A=k*+h[e+16>>2]+O*+h[e+20>>2]+D*+h[e+24>>2]+ +h[e+52>>2];D=k*+h[e+32>>2]+O*+h[e+36>>2]+D*+h[e+40>>2]+ +h[e+56>>2];F=r[t+12>>2]|0;M=r[(r[F>>2]|0)+64>>2]|0;O=nt*+h[s+4>>2]+st*+h[s+20>>2]+rt*+h[s+36>>2];k=nt*+h[s+8>>2]+st*+h[s+24>>2]+rt*+h[s+40>>2];h[ot+64>>2]=nt*+h[s>>2]+st*+h[s+16>>2]+rt*+h[s+32>>2];h[ot+64+4>>2]=O;h[ot+64+8>>2]=k;h[ot+64+12>>2]=0.0;Vk[M&127](ot+80|0,F,ot+64|0);k=+h[ot+80>>2];O=+h[ot+80+4>>2];w=+h[ot+80+8>>2];S=S-(k*+h[s>>2]+O*+h[s+4>>2]+w*+h[s+8>>2]+ +h[s+48>>2]);A=A-(k*+h[s+16>>2]+O*+h[s+20>>2]+w*+h[s+24>>2]+ +h[s+52>>2]);w=D-(k*+h[s+32>>2]+O*+h[s+36>>2]+w*+h[s+40>>2]+ +h[s+56>>2]);t:do{if(S*S+A*A+w*w>9.999999747378752e-05){O=c;c=0.0;F=32;g=0;b=0;m=0;l=0;T=0;while(1){if(!F)break t;F=F+-1|0;x=r[t+8>>2]|0;C=r[(r[x>>2]|0)+64>>2]|0;P=-S;at=-A;E=-w;h[ot+32>>2]=B*P+V*at+j*E;h[ot+32+4>>2]=N*P+z*at+H*E;h[ot+32+8>>2]=U*P+W*at+X*E;h[ot+32+12>>2]=0.0;Vk[C&127](ot+48|0,x,ot+32|0);E=+h[ot+48>>2];at=+h[ot+48+4>>2];P=+h[ot+48+8>>2];R=O+(B*E+N*at+U*P);I=u+(V*E+z*at+W*P);P=p+(j*E+H*at+X*P);x=r[t+12>>2]|0;C=r[(r[x>>2]|0)+64>>2]|0;h[ot>>2]=Y*S+Z*A+J*w;h[ot+4>>2]=q*S+Q*A+tt*w;h[ot+8>>2]=K*S+$*A+et*w;h[ot+12>>2]=0.0;Vk[C&127](ot+16|0,x,ot);at=+h[ot+16>>2];E=+h[ot+16+4>>2];k=+h[ot+16+8>>2];L=f+(Y*at+q*E+K*k);D=y+(Z*at+Q*E+$*k);k=v+(J*at+tt*E+et*k);E=S*(R-L)+A*(I-D)+w*(P-k);x=(h[d>>2]=S,r[d>>2]|0);C=(h[d>>2]=A,r[d>>2]|0);M=(h[d>>2]=w,r[d>>2]|0);if(c>1.0){l=0;it=25;break}if(E>0.0){u=nt*S+st*A+rt*w;if(u>=-1.4210854715202004e-14){l=0;it=25;break}c=c-E/u;E=(1.0-c)*+h[e+48>>2]+c*+h[i+48>>2];u=(1.0-c)*+h[e+52>>2]+c*+h[i+52>>2];p=(1.0-c)*+h[e+56>>2]+c*+h[i+56>>2];f=(1.0-c)*+h[s+48>>2]+c*+h[o+48>>2];y=(1.0-c)*+h[s+52>>2]+c*+h[o+52>>2];v=(1.0-c)*+h[s+56>>2]+c*+h[o+56>>2];g=x;b=T;m=C;l=M}else E=O;C=r[t+4>>2]|0;T=r[C>>2]|0;e:do{if((T|0)>0){S=+h[C+308>>2];x=0;while(1){A=R-L-+h[C+4+(x<<4)>>2];O=I-D-+h[C+4+(x<<4)+4>>2];at=P-k-+h[C+4+(x<<4)+8>>2];x=x+1|0;if(A*A+O*O+at*at<=S){x=1;break e}if((x|0)>=(T|0)){x=0;break}}}else x=0}while(0);if((+h[C+304>>2]==0.0?P-k==+h[C+300>>2]:0)?I-D==+h[C+296>>2]:0){if(!(R-L==+h[C+292>>2]|x))it=17}else if(!x)it=17;if((it|0)==17){it=0;h[C+292>>2]=R-L;h[C+296>>2]=I-D;h[C+300>>2]=P-k;h[C+304>>2]=0.0;n[C+356>>0]=1;h[C+4+(T<<4)>>2]=R-L;h[C+4+(T<<4)+4>>2]=I-D;h[C+4+(T<<4)+8>>2]=P-k;h[C+4+(T<<4)+12>>2]=0.0;M=r[C>>2]|0;h[C+84+(M<<4)>>2]=R;h[C+84+(M<<4)+4>>2]=I;h[C+84+(M<<4)+8>>2]=P;h[C+84+(M<<4)+12>>2]=0.0;M=r[C>>2]|0;h[C+164+(M<<4)>>2]=L;h[C+164+(M<<4)+4>>2]=D;h[C+164+(M<<4)+8>>2]=k;h[C+164+(M<<4)+12>>2]=0.0;r[C>>2]=(r[C>>2]|0)+1;C=r[t+4>>2]|0}M=vS(C)|0;S=+h[C+276>>2];A=+h[C+280>>2];w=+h[C+284>>2];if(!M)break t;if(!(S*S+A*A+w*w>9.999999747378752e-05))break t;else{O=E;T=r[C+288>>2]|0}}if((it|0)==25){_=ot;return l|0}}else{c=0.0;g=0;b=0;m=0;l=0}}while(0);h[a+164>>2]=c;c=(r[d>>2]=g,+h[d>>2]);u=(r[d>>2]=m,+h[d>>2]);f=(r[d>>2]=l,+h[d>>2]);if(!(c*c+u*u+f*f>=1.4210854715202004e-14)){r[a+132>>2]=0;r[a+132+4>>2]=0;r[a+132+8>>2]=0;r[a+132+12>>2]=0;p=0.0;u=0.0;c=0.0}else{at=1.0/+G(+(c*c+u*u+f*f));h[a+132>>2]=c*at;h[a+136>>2]=u*at;h[a+140>>2]=f*at;r[a+144>>2]=b;p=c*at;u=u*at;c=f*at}if(nt*p+st*u+rt*c>=-+h[a+172>>2]){t=0;_=ot;return t|0}t=r[t+4>>2]|0;vS(t)|0;Fh(a+148|0,t+260|0,16)|0;t=1;_=ot;return t|0}function vS(t){t=t|0;var e=0,i=0.0,s=0.0,o=0,a=0.0,l=0.0,c=0.0,u=0.0,d=0,p=0,f=0,m=0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0,D=0,k=0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,W=0.0,G=0.0,j=0.0,H=0.0,X=0.0,Y=0.0,q=0;k=_;_=_+64|0;if(!(n[t+356>>0]|0)){t=n[t+312>>0]|0;t=t<<24>>24!=0;_=k;return t|0}r[t+336>>2]=0;r[t+336+4>>2]=0;r[t+336+8>>2]=0;r[t+336+12>>2]=0;n[t+336+16>>0]=0;o=n[t+332>>0]|0;n[t+332>>0]=o&-16;n[t+356>>0]=0;switch(r[t>>2]|0){case 0:{n[t+312>>0]=0;t=0;t=t<<24>>24!=0;_=k;return t|0}case 1:{r[t+244>>2]=r[t+84>>2];r[t+244+4>>2]=r[t+84+4>>2];r[t+244+8>>2]=r[t+84+8>>2];r[t+244+12>>2]=r[t+84+12>>2];r[t+260>>2]=r[t+164>>2];r[t+260+4>>2]=r[t+164+4>>2];r[t+260+8>>2]=r[t+164+8>>2];r[t+260+12>>2]=r[t+164+12>>2];I=+h[t+248>>2]-+h[t+264>>2];P=+h[t+252>>2]-+h[t+268>>2];h[t+276>>2]=+h[t+244>>2]-+h[t+260>>2];h[t+280>>2]=I;h[t+284>>2]=P;h[t+288>>2]=0.0;r[t+336>>2]=0;r[t+336+4>>2]=0;r[t+336+8>>2]=0;r[t+336+12>>2]=0;n[t+336+16>>0]=0;n[t+332>>0]=o&-16;h[t+336>>2]=1.0;h[t+340>>2]=0.0;h[t+344>>2]=0.0;h[t+348>>2]=0.0;n[t+312>>0]=1;t=1;t=t<<24>>24!=0;_=k;return t|0}case 2:{i=+h[t+4>>2];s=+h[t+8>>2];a=+h[t+12>>2];l=+h[t+20>>2]-i;c=+h[t+24>>2]-s;u=+h[t+28>>2]-a;do{if((0.0-i)*l+(0.0-s)*c+(0.0-a)*u>0.0)if((0.0-i)*l+(0.0-s)*c+(0.0-a)*u<l*l+c*c+u*u){n[t+332>>0]=o&-16|3;o=o&-16|3;s=((0.0-i)*l+(0.0-s)*c+(0.0-a)*u)/(l*l+c*c+u*u);break}else{n[t+332>>0]=o&-16|2;o=o&-16|2;s=1.0;break}else{n[t+332>>0]=o&-16|1;o=o&-16|1;s=0.0}}while(0);i=1.0-s;h[t+336>>2]=i;h[t+340>>2]=s;h[t+344>>2]=0.0;h[t+348>>2]=0.0;A=+h[t+84>>2];M=+h[t+88>>2];I=+h[t+92>>2];A=A+s*(+h[t+100>>2]-A);M=M+s*(+h[t+104>>2]-M);I=I+s*(+h[t+108>>2]-I);h[t+244>>2]=A;h[t+248>>2]=M;h[t+252>>2]=I;h[t+256>>2]=0.0;E=+h[t+164>>2];R=+h[t+168>>2];P=+h[t+172>>2];E=E+s*(+h[t+180>>2]-E);R=R+s*(+h[t+184>>2]-R);P=P+s*(+h[t+188>>2]-P);h[t+260>>2]=E;h[t+264>>2]=R;h[t+268>>2]=P;h[t+272>>2]=0.0;h[t+276>>2]=A-E;h[t+280>>2]=M-R;h[t+284>>2]=I-P;h[t+288>>2]=0.0;if(!(o&2)){r[t>>2]=1;e=0}else e=1;if(!(o&1)){r[t>>2]=e;D=t+4+(e<<4)|0;r[t+4>>2]=r[D>>2];r[t+4+4>>2]=r[D+4>>2];r[t+4+8>>2]=r[D+8>>2];r[t+4+12>>2]=r[D+12>>2];D=t+84+(e<<4)|0;r[t+84>>2]=r[D>>2];r[t+84+4>>2]=r[D+4>>2];r[t+84+8>>2]=r[D+8>>2];r[t+84+12>>2]=r[D+12>>2];D=t+164+(e<<4)|0;r[t+164>>2]=r[D>>2];r[t+164+4>>2]=r[D+4>>2];r[t+164+8>>2]=r[D+8>>2];r[t+164+12>>2]=r[D+12>>2]}D=(!(i>=0.0)|!(s>=0.0))&1^1;n[t+312>>0]=D;t=D;t=t<<24>>24!=0;_=k;return t|0}case 3:{r[k+16>>2]=0;r[k+16+4>>2]=0;r[k+16+8>>2]=0;r[k+16+12>>2]=0;tE(k+16|0,t+4|0,t+20|0,t+36|0,t+316|0);P=+h[t+336>>2];i=+h[t+340>>2];s=+h[t+344>>2];A=+h[t+84>>2]*P+ +h[t+100>>2]*i+ +h[t+116>>2]*s;M=P*+h[t+88>>2]+i*+h[t+104>>2]+s*+h[t+120>>2];I=P*+h[t+92>>2]+i*+h[t+108>>2]+s*+h[t+124>>2];h[t+244>>2]=A;h[t+248>>2]=M;h[t+252>>2]=I;h[t+256>>2]=0.0;E=+h[t+164>>2]*P+ +h[t+180>>2]*i+ +h[t+196>>2]*s;R=P*+h[t+168>>2]+i*+h[t+184>>2]+s*+h[t+200>>2];P=P*+h[t+172>>2]+i*+h[t+188>>2]+s*+h[t+204>>2];h[t+260>>2]=E;h[t+264>>2]=R;h[t+268>>2]=P;h[t+272>>2]=0.0;h[t+276>>2]=A-E;h[t+280>>2]=M-R;h[t+284>>2]=I-P;h[t+288>>2]=0.0;o=r[t>>2]|0;do{if((o|0)>3){e=n[t+332>>0]|0;if(!(e&8)){r[t>>2]=o+-1;D=t+4+(o+-1<<4)|0;r[t+52>>2]=r[D>>2];r[t+52+4>>2]=r[D+4>>2];r[t+52+8>>2]=r[D+8>>2];r[t+52+12>>2]=r[D+12>>2];D=t+84+(o+-1<<4)|0;r[t+132>>2]=r[D>>2];r[t+132+4>>2]=r[D+4>>2];r[t+132+8>>2]=r[D+8>>2];r[t+132+12>>2]=r[D+12>>2];D=t+164+(o+-1<<4)|0;r[t+212>>2]=r[D>>2];r[t+212+4>>2]=r[D+4>>2];r[t+212+8>>2]=r[D+8>>2];r[t+212+12>>2]=r[D+12>>2];o=o+-1|0;D=21}else D=21}else{if((o|0)>2){e=n[t+332>>0]|0;o=3;D=21;break}if((o|0)>1){e=n[t+332>>0]|0;o=2;D=25;break}if((o|0)>0){p=n[t+332>>0]|0;d=1;D=29}}}while(0);if((D|0)==21)if(!(e&4)){o=o+-1|0;r[t>>2]=o;r[t+36>>2]=r[t+4+(o<<4)>>2];r[t+36+4>>2]=r[t+4+(o<<4)+4>>2];r[t+36+8>>2]=r[t+4+(o<<4)+8>>2];r[t+36+12>>2]=r[t+4+(o<<4)+12>>2];r[t+116>>2]=r[t+84+(o<<4)>>2];r[t+116+4>>2]=r[t+84+(o<<4)+4>>2];r[t+116+8>>2]=r[t+84+(o<<4)+8>>2];r[t+116+12>>2]=r[t+84+(o<<4)+12>>2];r[t+196>>2]=r[t+164+(o<<4)>>2];r[t+196+4>>2]=r[t+164+(o<<4)+4>>2];r[t+196+8>>2]=r[t+164+(o<<4)+8>>2];r[t+196+12>>2]=r[t+164+(o<<4)+12>>2];D=25}else D=25;if((D|0)==25)if(!(e&2)){d=o+-1|0;r[t>>2]=d;r[t+20>>2]=r[t+4+(d<<4)>>2];r[t+20+4>>2]=r[t+4+(d<<4)+4>>2];r[t+20+8>>2]=r[t+4+(d<<4)+8>>2];r[t+20+12>>2]=r[t+4+(d<<4)+12>>2];r[t+100>>2]=r[t+84+(d<<4)>>2];r[t+100+4>>2]=r[t+84+(d<<4)+4>>2];r[t+100+8>>2]=r[t+84+(d<<4)+8>>2];r[t+100+12>>2]=r[t+84+(d<<4)+12>>2];r[t+180>>2]=r[t+164+(d<<4)>>2];r[t+180+4>>2]=r[t+164+(d<<4)+4>>2];r[t+180+8>>2]=r[t+164+(d<<4)+8>>2];r[t+180+12>>2]=r[t+164+(d<<4)+12>>2];p=e;D=29}else{p=e;d=o;D=29}if((D|0)==29?(p&1)==0:0){D=d+-1|0;r[t>>2]=D;r[t+4>>2]=r[t+4+(D<<4)>>2];r[t+4+4>>2]=r[t+4+(D<<4)+4>>2];r[t+4+8>>2]=r[t+4+(D<<4)+8>>2];r[t+4+12>>2]=r[t+4+(D<<4)+12>>2];r[t+84>>2]=r[t+84+(D<<4)>>2];r[t+84+4>>2]=r[t+84+(D<<4)+4>>2];r[t+84+8>>2]=r[t+84+(D<<4)+8>>2];r[t+84+12>>2]=r[t+84+(D<<4)+12>>2];r[t+164>>2]=r[t+164+(D<<4)>>2];r[t+164+4>>2]=r[t+164+(D<<4)+4>>2];r[t+164+8>>2]=r[t+164+(D<<4)+8>>2];r[t+164+12>>2]=r[t+164+(D<<4)+12>>2]}if((i>=0.0?!(+h[t+336>>2]>=0.0):1)|!(s>=0.0))e=0;else e=+h[t+348>>2]>=0.0&1;n[t+312>>0]=e;t=e;t=t<<24>>24!=0;_=k;return t|0}case 4:{r[k>>2]=0;r[k+4>>2]=0;r[k+8>>2]=0;r[k+12>>2]=0;m=k+16+16|0;n[m>>0]=0;r[t+316>>2]=0;r[t+316+4>>2]=0;r[t+316+8>>2]=0;r[t+316+12>>2]=0;n[t+332>>0]=o|15;F=+h[t+20>>2];H=+h[t+4>>2];W=+h[t+24>>2];O=+h[t+8>>2];N=+h[t+28>>2];X=+h[t+12>>2];z=+h[t+36>>2];G=+h[t+40>>2];U=+h[t+44>>2];B=+h[t+52>>2];j=+h[t+56>>2];V=+h[t+60>>2];Y=((W-O)*(U-X)-(N-X)*(G-O))*(B-H)+((N-X)*(z-H)-(F-H)*(U-X))*(j-O)+((F-H)*(G-O)-(W-O)*(z-H))*(V-X);o=Y*Y<9.99999905104687e-09?-1:((0.0-H)*((W-O)*(U-X)-(N-X)*(G-O))+(0.0-O)*((N-X)*(z-H)-(F-H)*(U-X))+((F-H)*(G-O)-(W-O)*(z-H))*(0.0-X))*Y<0.0&1;Y=(N-X)*((z-H)*(j-O)-(G-O)*(B-H))+((F-H)*((G-O)*(V-X)-(U-X)*(j-O))+(W-O)*((U-X)*(B-H)-(z-H)*(V-X)));d=Y*Y<9.99999905104687e-09?-1:((0.0-X)*((z-H)*(j-O)-(G-O)*(B-H))+((0.0-H)*((G-O)*(V-X)-(U-X)*(j-O))+(0.0-O)*((U-X)*(B-H)-(z-H)*(V-X))))*Y<0.0&1;Y=(U-X)*((W-O)*(B-H)-(F-H)*(j-O))+((z-H)*((N-X)*(j-O)-(W-O)*(V-X))+(G-O)*((F-H)*(V-X)-(N-X)*(B-H)));p=Y*Y<9.99999905104687e-09?-1:((0.0-X)*((W-O)*(B-H)-(F-H)*(j-O))+((0.0-H)*((N-X)*(j-O)-(W-O)*(V-X))+(0.0-O)*((F-H)*(V-X)-(N-X)*(B-H))))*Y<0.0&1;O=(X-N)*((G-W)*(B-F)-(z-F)*(j-W))+((H-F)*((U-N)*(j-W)-(G-W)*(V-N))+(O-W)*((z-F)*(V-N)-(U-N)*(B-F)));f=O*O<9.99999905104687e-09?-1:((0.0-N)*((G-W)*(B-F)-(z-F)*(j-W))+((0.0-F)*((U-N)*(j-W)-(G-W)*(V-N))+(0.0-W)*((z-F)*(V-N)-(U-N)*(B-F))))*O<0.0&1;do{if((d|o|p|f|0)<0){n[t+352>>0]=1;e=t+312|0;D=70}else{if(!(d|o|p|f)){if(n[t+352>>0]|0){e=t+312|0;D=70;break}n[t+312>>0]=1;r[t+276>>2]=0;r[t+276+4>>2]=0;r[t+276+8>>2]=0;r[t+276+12>>2]=0;e=1;break}if((o|0)!=0?(tE(k,t+4|0,t+20|0,t+36|0,k+16|0),i=+h[k+16>>2],s=+h[k+16+4>>2],a=+h[k+16+8>>2],l=i-+h[k>>2],c=s-+h[k+4>>2],u=a-+h[k+8>>2],l*l+c*c+u*u<3402823466385288598117041.0e14):0){q=r[k+16+12>>2]|0;h[t+316>>2]=i;h[t+320>>2]=s;h[t+324>>2]=a;r[t+328>>2]=q;q=n[m>>0]|0;n[t+332>>0]=q&1|n[t+332>>0]&-16|q&2|q&4;q=r[k+16+24>>2]|0;o=r[k+16+28>>2]|0;r[t+336>>2]=r[k+16+20>>2];r[t+340>>2]=q;r[t+344>>2]=o;h[t+348>>2]=0.0;i=l*l+c*c+u*u}else i=3402823466385288598117041.0e14;if((d|0)!=0?(tE(k,t+4|0,t+36|0,t+52|0,k+16|0),g=+h[k+16>>2],b=+h[k+16+4>>2],y=+h[k+16+8>>2],v=g-+h[k>>2],S=b-+h[k+4>>2],x=y-+h[k+8>>2],v*v+S*S+x*x<i):0){d=r[k+16+12>>2]|0;h[t+316>>2]=g;h[t+320>>2]=b;h[t+324>>2]=y;r[t+328>>2]=d;d=n[m>>0]|0;n[t+332>>0]=d<<1&8|(d&1|n[t+332>>0]&-16|d<<1&4);d=r[k+16+24>>2]|0;q=r[k+16+28>>2]|0;r[t+336>>2]=r[k+16+20>>2];h[t+340>>2]=0.0;r[t+344>>2]=d;r[t+348>>2]=q;i=v*v+S*S+x*x}if((p|0)!=0?(tE(k,t+4|0,t+52|0,t+20|0,k+16|0),w=+h[k+16>>2],C=+h[k+16+4>>2],T=+h[k+16+8>>2],A=w-+h[k>>2],E=C-+h[k+4>>2],M=T-+h[k+8>>2],A*A+E*E+M*M<i):0){p=r[k+16+12>>2]|0;h[t+316>>2]=w;h[t+320>>2]=C;h[t+324>>2]=T;r[t+328>>2]=p;p=n[m>>0]|0;n[t+332>>0]=p<<2&8|(p&1|n[t+332>>0]&-16|(p&255)>>>1&2);p=r[k+16+28>>2]|0;q=r[k+16+24>>2]|0;r[t+336>>2]=r[k+16+20>>2];r[t+340>>2]=p;h[t+344>>2]=0.0;r[t+348>>2]=q;i=A*A+E*E+M*M}if(f|0?(tE(k,t+20|0,t+52|0,t+36|0,k+16|0),R=+h[k+16>>2],I=+h[k+16+4>>2],P=+h[k+16+8>>2],H=R-+h[k>>2],X=I-+h[k+4>>2],Y=P-+h[k+8>>2],H*H+X*X+Y*Y<i):0){f=r[k+16+12>>2]|0;h[t+316>>2]=R;h[t+320>>2]=I;h[t+324>>2]=P;r[t+328>>2]=f;f=n[m>>0]|0;n[t+332>>0]=f&4|n[t+332>>0]&-16|f<<1&2|f<<2&8;f=r[k+16+20>>2]|0;m=r[k+16+28>>2]|0;q=r[k+16+24>>2]|0;h[t+336>>2]=0.0;r[t+340>>2]=f;r[t+344>>2]=m;r[t+348>>2]=q}V=+h[t+336>>2];z=+h[t+340>>2];Y=+h[t+344>>2];i=+h[t+348>>2];W=+h[t+84>>2]*V+ +h[t+100>>2]*z+ +h[t+116>>2]*Y+ +h[t+132>>2]*i;j=V*+h[t+88>>2]+z*+h[t+104>>2]+Y*+h[t+120>>2]+i*+h[t+136>>2];X=V*+h[t+92>>2]+z*+h[t+108>>2]+Y*+h[t+124>>2]+i*+h[t+140>>2];h[t+244>>2]=W;h[t+248>>2]=j;h[t+252>>2]=X;h[t+256>>2]=0.0;G=+h[t+164>>2]*V+ +h[t+180>>2]*z+ +h[t+196>>2]*Y+ +h[t+212>>2]*i;H=V*+h[t+168>>2]+z*+h[t+184>>2]+Y*+h[t+200>>2]+i*+h[t+216>>2];Y=V*+h[t+172>>2]+z*+h[t+188>>2]+Y*+h[t+204>>2]+i*+h[t+220>>2];h[t+260>>2]=G;h[t+264>>2]=H;h[t+268>>2]=Y;h[t+272>>2]=0.0;h[t+276>>2]=W-G;h[t+280>>2]=j-H;h[t+284>>2]=X-Y;h[t+288>>2]=0.0;o=r[t>>2]|0;do{if((o|0)>3){e=n[t+332>>0]|0;if(!(e&8)){r[t>>2]=o+-1;D=t+4+(o+-1<<4)|0;r[t+52>>2]=r[D>>2];r[t+52+4>>2]=r[D+4>>2];r[t+52+8>>2]=r[D+8>>2];r[t+52+12>>2]=r[D+12>>2];D=t+84+(o+-1<<4)|0;r[t+132>>2]=r[D>>2];r[t+132+4>>2]=r[D+4>>2];r[t+132+8>>2]=r[D+8>>2];r[t+132+12>>2]=r[D+12>>2];D=t+164+(o+-1<<4)|0;r[t+212>>2]=r[D>>2];r[t+212+4>>2]=r[D+4>>2];r[t+212+8>>2]=r[D+8>>2];r[t+212+12>>2]=r[D+12>>2];o=o+-1|0;D=54}else D=54}else{if((o|0)>2){e=n[t+332>>0]|0;o=3;D=54;break}if((o|0)>1){e=n[t+332>>0]|0;o=2;D=58;break}if((o|0)>0){e=n[t+332>>0]|0;L=1;D=62}}}while(0);if((D|0)==54)if(!(e&4)){o=o+-1|0;r[t>>2]=o;r[t+36>>2]=r[t+4+(o<<4)>>2];r[t+36+4>>2]=r[t+4+(o<<4)+4>>2];r[t+36+8>>2]=r[t+4+(o<<4)+8>>2];r[t+36+12>>2]=r[t+4+(o<<4)+12>>2];r[t+116>>2]=r[t+84+(o<<4)>>2];r[t+116+4>>2]=r[t+84+(o<<4)+4>>2];r[t+116+8>>2]=r[t+84+(o<<4)+8>>2];r[t+116+12>>2]=r[t+84+(o<<4)+12>>2];r[t+196>>2]=r[t+164+(o<<4)>>2];r[t+196+4>>2]=r[t+164+(o<<4)+4>>2];r[t+196+8>>2]=r[t+164+(o<<4)+8>>2];r[t+196+12>>2]=r[t+164+(o<<4)+12>>2];D=58}else D=58;if((D|0)==58)if(!(e&2)){L=o+-1|0;r[t>>2]=L;r[t+20>>2]=r[t+4+(L<<4)>>2];r[t+20+4>>2]=r[t+4+(L<<4)+4>>2];r[t+20+8>>2]=r[t+4+(L<<4)+8>>2];r[t+20+12>>2]=r[t+4+(L<<4)+12>>2];r[t+100>>2]=r[t+84+(L<<4)>>2];r[t+100+4>>2]=r[t+84+(L<<4)+4>>2];r[t+100+8>>2]=r[t+84+(L<<4)+8>>2];r[t+100+12>>2]=r[t+84+(L<<4)+12>>2];r[t+180>>2]=r[t+164+(L<<4)>>2];r[t+180+4>>2]=r[t+164+(L<<4)+4>>2];r[t+180+8>>2]=r[t+164+(L<<4)+8>>2];r[t+180+12>>2]=r[t+164+(L<<4)+12>>2];D=62}else{L=o;D=62}if((D|0)==62?(e&1)==0:0){q=L+-1|0;r[t>>2]=q;r[t+4>>2]=r[t+4+(q<<4)>>2];r[t+4+4>>2]=r[t+4+(q<<4)+4>>2];r[t+4+8>>2]=r[t+4+(q<<4)+8>>2];r[t+4+12>>2]=r[t+4+(q<<4)+12>>2];r[t+84>>2]=r[t+84+(q<<4)>>2];r[t+84+4>>2]=r[t+84+(q<<4)+4>>2];r[t+84+8>>2]=r[t+84+(q<<4)+8>>2];r[t+84+12>>2]=r[t+84+(q<<4)+12>>2];r[t+164>>2]=r[t+164+(q<<4)>>2];r[t+164+4>>2]=r[t+164+(q<<4)+4>>2];r[t+164+8>>2]=r[t+164+(q<<4)+8>>2];r[t+164+12>>2]=r[t+164+(q<<4)+12>>2]}if((+h[t+336>>2]>=0.0?+h[t+340>>2]>=0.0:0)?+h[t+344>>2]>=0.0:0)e=i>=0.0&1;else e=0;n[t+312>>0]=e}}while(0);if((D|0)==70){n[e>>0]=0;e=0}q=e;q=q<<24>>24!=0;_=k;return q|0}default:{n[t+312>>0]=0;q=0;q=q<<24>>24!=0;_=k;return q|0}}return 0}function SS(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var o=0.0,a=0.0,l=0,c=0.0,u=0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0,P=0,L=0,D=0,k=0,O=0,F=0,B=0,N=0.0,U=0.0,V=0,z=0.0,j=0.0,H=0.0,X=0.0,Y=0,q=0.0,K=0,Z=0.0,$=0,J=0.0,tt=0.0,et=0.0,it=0.0,nt=0,st=0,rt=0.0,ot=0,at=0.0,lt=0.0,ht=0.0,ct=0.0,_t=0.0,ut=0.0,dt=0.0,pt=0.0,ft=0.0,mt=0.0,gt=0.0,bt=0.0,yt=0.0,vt=0.0,St=0.0,xt=0.0,wt=0.0,Ct=0.0,Tt=0.0,At=0,Et=0,Mt=0,Rt=0.0,It=0.0,Pt=0;Pt=_;_=_+592|0;r[Pt+48>>2]=r[e>>2];r[Pt>>2]=r[e+64>>2];I=Pt+48+4|0;r[I>>2]=r[e+4>>2];r[Pt+4>>2]=r[e+68>>2];r[Pt+48+8>>2]=r[e+8>>2];r[Pt+8>>2]=r[e+72>>2];r[Pt+48+16>>2]=r[e+16>>2];r[Pt+16>>2]=r[e+80>>2];r[Pt+48+20>>2]=r[e+20>>2];r[Pt+20>>2]=r[e+84>>2];r[Pt+48+24>>2]=r[e+24>>2];r[Pt+24>>2]=r[e+88>>2];r[Pt+48+32>>2]=r[e+32>>2];r[Pt+32>>2]=r[e+96>>2];r[Pt+48+36>>2]=r[e+36>>2];r[Pt+36>>2]=r[e+100>>2];r[Pt+48+40>>2]=r[e+40>>2];r[Pt+40>>2]=r[e+104>>2];Mt=r[t+4>>2]|0;lt=+h[Mt+32>>2];ht=+h[Mt+36>>2];ut=+h[Mt+40>>2];ct=+xk[r[(r[Mt>>2]|0)+48>>2]&15](Mt);_t=+xk[r[(r[Mt>>2]|0)+48>>2]&15](Mt);ut=(ut+ +xk[r[(r[Mt>>2]|0)+48>>2]&15](Mt))*2.0;Mt=r[t+8>>2]|0;mt=+h[Mt+32>>2];gt=+h[Mt+36>>2];xt=+h[Mt+40>>2];bt=+xk[r[(r[Mt>>2]|0)+48>>2]&15](Mt);ft=+xk[r[(r[Mt>>2]|0)+48>>2]&15](Mt);xt=(xt+ +xk[r[(r[Mt>>2]|0)+48>>2]&15](Mt))*2.0;R=+h[e+112>>2]-+h[e+48>>2];N=+h[e+116>>2]-+h[e+52>>2];U=+h[e+120>>2]-+h[e+56>>2];it=+h[Pt+48>>2];tt=+h[Pt+48+16>>2];et=+h[Pt+48+32>>2];J=+h[I>>2];q=+h[Pt+48+20>>2];Z=+h[Pt+48+36>>2];rt=+h[Pt+48+8>>2];at=+h[Pt+48+24>>2];dt=+h[Pt+48+40>>2];h[Pt+484>>2]=(lt+ct)*2.0*.5;h[Pt+484+4>>2]=(ht+_t)*2.0*.5;h[Pt+484+8>>2]=ut*.5;h[Pt+472>>2]=(mt+bt)*2.0*.5;h[Pt+472+4>>2]=(gt+ft)*2.0*.5;h[Pt+472+8>>2]=xt*.5;Tt=+h[Pt>>2];yt=+h[Pt+16>>2];St=+h[Pt+32>>2];Ct=+h[Pt+4>>2];pt=+h[Pt+20>>2];vt=+h[Pt+36>>2];wt=+h[Pt+8>>2];Rt=+h[Pt+24>>2];It=+h[Pt+40>>2];C=+W(+(it*Tt+tt*yt+et*St));A=+W(+(it*Ct+tt*pt+et*vt));z=+W(+(it*wt+tt*Rt+et*It));T=+W(+(Tt*J+yt*q+St*Z));E=+W(+(Ct*J+pt*q+vt*Z));j=+W(+(wt*J+Rt*q+It*Z));H=+W(+(Tt*rt+yt*at+St*dt));X=+W(+(Ct*rt+pt*at+vt*dt));M=+W(+(wt*rt+Rt*at+It*dt));o=+W(+(R*it+N*tt+U*et))-(xt*.5*z+((lt+ct)*2.0*.5+C*((mt+bt)*2.0*.5)+A*((gt+ft)*2.0*.5)));if(o>0.0){_=Pt;return}if(o>-3402823466385288598117041.0e14){u=1;l=R*it+N*tt+U*et<0.0&1;n=Pt+48|0}else{u=0;l=0;n=0;o=-3402823466385288598117041.0e14}a=+W(+(R*J+N*q+U*Z))-((ht+_t)*2.0*.5+T*((mt+bt)*2.0*.5)+E*((gt+ft)*2.0*.5)+j*(xt*.5));if(a>0.0){_=Pt;return}if(a>o){u=2;l=R*J+N*q+U*Z<0.0&1;n=I;o=a}a=+W(+(R*rt+N*at+U*dt))-(ut*.5+H*((mt+bt)*2.0*.5)+X*((gt+ft)*2.0*.5)+M*(xt*.5));if(a>0.0){_=Pt;return}if(a>o){u=3;l=R*rt+N*at+U*dt<0.0&1;n=Pt+48+8|0;o=a}a=+W(+(R*Tt+N*yt+U*St))-((mt+bt)*2.0*.5+(C*((lt+ct)*2.0*.5)+T*((ht+_t)*2.0*.5)+H*(ut*.5)));if(a>0.0){_=Pt;return}if(a>o){u=4;l=R*Tt+N*yt+U*St<0.0&1;n=Pt;o=a}a=+W(+(R*Ct+N*pt+U*vt))-((gt+ft)*2.0*.5+(A*((lt+ct)*2.0*.5)+E*((ht+_t)*2.0*.5)+X*(ut*.5)));if(a>0.0){_=Pt;return}if(a>o){u=5;l=R*Ct+N*pt+U*vt<0.0&1;n=Pt+4|0}else a=o;o=+W(+(R*wt+N*Rt+U*It))-(xt*.5+(z*((lt+ct)*2.0*.5)+j*((ht+_t)*2.0*.5)+M*(ut*.5)));if(o>0.0){_=Pt;return}if(o>a){u=6;l=R*wt+N*Rt+U*It<0.0&1;v=Pt+8|0}else{v=n;o=a}a=(R*rt+N*at+U*dt)*(Tt*J+yt*q+St*Z)-(R*J+N*q+U*Z)*(Tt*rt+yt*at+St*dt);c=+W(+a)-((H+9.999999747378752e-06)*((ht+_t)*2.0*.5)+(T+9.999999747378752e-06)*(ut*.5)+(z+9.999999747378752e-06)*((gt+ft)*2.0*.5)+(A+9.999999747378752e-06)*(xt*.5));if(c>1.1920928955078125e-07){_=Pt;return}f=(Tt*rt+yt*at+St*dt)*(Tt*rt+yt*at+St*dt)+0.0;S=(Tt*J+yt*q+St*Z)*(Tt*J+yt*q+St*Z);p=+G(+(S+f));if(p>1.1920928955078125e-07?c/p*1.0499999523162842>o:0){t=(h[d>>2]=0.0/p,r[d>>2]|0);s=(h[d>>2]=-(Tt*rt+yt*at+St*dt)/p,r[d>>2]|0);u=7;l=a<0.0&1;n=(h[d>>2]=(Tt*J+yt*q+St*Z)/p,r[d>>2]|0);v=0;o=c/p}else{t=0;s=0;n=0}a=(R*rt+N*at+U*dt)*(Ct*J+pt*q+vt*Z)-(R*J+N*q+U*Z)*(Ct*rt+pt*at+vt*dt);c=+W(+a)-((X+9.999999747378752e-06)*((ht+_t)*2.0*.5)+(E+9.999999747378752e-06)*(ut*.5)+(z+9.999999747378752e-06)*((mt+bt)*2.0*.5)+(C+9.999999747378752e-06)*(xt*.5));if(c>1.1920928955078125e-07){_=Pt;return}m=(Ct*rt+pt*at+vt*dt)*(Ct*rt+pt*at+vt*dt)+0.0;x=(Ct*J+pt*q+vt*Z)*(Ct*J+pt*q+vt*Z);p=+G(+(x+m));if(p>1.1920928955078125e-07?c/p*1.0499999523162842>o:0){t=(h[d>>2]=0.0/p,r[d>>2]|0);s=(h[d>>2]=-(Ct*rt+pt*at+vt*dt)/p,r[d>>2]|0);u=8;l=a<0.0&1;n=(h[d>>2]=(Ct*J+pt*q+vt*Z)/p,r[d>>2]|0);v=0;o=c/p}a=(R*rt+N*at+U*dt)*(wt*J+Rt*q+It*Z)-(R*J+N*q+U*Z)*(wt*rt+Rt*at+It*dt);c=+W(+a)-((M+9.999999747378752e-06)*((ht+_t)*2.0*.5)+(j+9.999999747378752e-06)*(ut*.5)+(A+9.999999747378752e-06)*((mt+bt)*2.0*.5)+(C+9.999999747378752e-06)*((gt+ft)*2.0*.5));if(c>1.1920928955078125e-07){_=Pt;return}b=(wt*rt+Rt*at+It*dt)*(wt*rt+Rt*at+It*dt)+0.0;w=(wt*J+Rt*q+It*Z)*(wt*J+Rt*q+It*Z);p=+G(+(w+b));if(p>1.1920928955078125e-07?c/p*1.0499999523162842>o:0){t=(h[d>>2]=0.0/p,r[d>>2]|0);s=(h[d>>2]=-(wt*rt+Rt*at+It*dt)/p,r[d>>2]|0);u=9;l=a<0.0&1;n=(h[d>>2]=(wt*J+Rt*q+It*Z)/p,r[d>>2]|0);v=0;o=c/p}a=(R*it+N*tt+U*et)*(Tt*rt+yt*at+St*dt)-(R*rt+N*at+U*dt)*(it*Tt+tt*yt+et*St);p=+W(+a)-((H+9.999999747378752e-06)*((lt+ct)*2.0*.5)+(C+9.999999747378752e-06)*(ut*.5)+(j+9.999999747378752e-06)*((gt+ft)*2.0*.5)+(E+9.999999747378752e-06)*(xt*.5));if(p>1.1920928955078125e-07){_=Pt;return}y=(it*Tt+tt*yt+et*St)*(it*Tt+tt*yt+et*St);c=+G(+(y+f));do{if(c>1.1920928955078125e-07){if(!(p/c*1.0499999523162842>o))break;t=(h[d>>2]=(Tt*rt+yt*at+St*dt)/c,r[d>>2]|0);s=(h[d>>2]=0.0/c,r[d>>2]|0);u=10;l=a<0.0&1;n=(h[d>>2]=-(it*Tt+tt*yt+et*St)/c,r[d>>2]|0);v=0;o=p/c}}while(0);a=(R*it+N*tt+U*et)*(Ct*rt+pt*at+vt*dt)-(R*rt+N*at+U*dt)*(it*Ct+tt*pt+et*vt);p=+W(+a)-((X+9.999999747378752e-06)*((lt+ct)*2.0*.5)+(A+9.999999747378752e-06)*(ut*.5)+(j+9.999999747378752e-06)*((mt+bt)*2.0*.5)+(T+9.999999747378752e-06)*(xt*.5));if(p>1.1920928955078125e-07){_=Pt;return}g=(it*Ct+tt*pt+et*vt)*(it*Ct+tt*pt+et*vt);c=+G(+(g+m));do{if(c>1.1920928955078125e-07){if(!(p/c*1.0499999523162842>o))break;t=(h[d>>2]=(Ct*rt+pt*at+vt*dt)/c,r[d>>2]|0);s=(h[d>>2]=0.0/c,r[d>>2]|0);u=11;l=a<0.0&1;n=(h[d>>2]=-(it*Ct+tt*pt+et*vt)/c,r[d>>2]|0);v=0;o=p/c}}while(0);a=(R*it+N*tt+U*et)*(wt*rt+Rt*at+It*dt)-(R*rt+N*at+U*dt)*(it*wt+tt*Rt+et*It);p=+W(+a)-((M+9.999999747378752e-06)*((lt+ct)*2.0*.5)+(z+9.999999747378752e-06)*(ut*.5)+(E+9.999999747378752e-06)*((mt+bt)*2.0*.5)+(T+9.999999747378752e-06)*((gt+ft)*2.0*.5));if(p>1.1920928955078125e-07){_=Pt;return}f=(it*wt+tt*Rt+et*It)*(it*wt+tt*Rt+et*It);c=+G(+(f+b));do{if(c>1.1920928955078125e-07){if(!(p/c*1.0499999523162842>o))break;t=(h[d>>2]=(wt*rt+Rt*at+It*dt)/c,r[d>>2]|0);s=(h[d>>2]=0.0/c,r[d>>2]|0);u=12;l=a<0.0&1;n=(h[d>>2]=-(it*wt+tt*Rt+et*It)/c,r[d>>2]|0);v=0;o=p/c}}while(0);a=(R*J+N*q+U*Z)*(it*Tt+tt*yt+et*St)-(R*it+N*tt+U*et)*(Tt*J+yt*q+St*Z);p=+W(+a)-((T+9.999999747378752e-06)*((lt+ct)*2.0*.5)+(C+9.999999747378752e-06)*((ht+_t)*2.0*.5)+(M+9.999999747378752e-06)*((gt+ft)*2.0*.5)+(X+9.999999747378752e-06)*(xt*.5));if(p>1.1920928955078125e-07){_=Pt;return}c=+G(+(y+S+0.0));do{if(c>1.1920928955078125e-07){if(!(p/c*1.0499999523162842>o))break;t=(h[d>>2]=-(Tt*J+yt*q+St*Z)/c,r[d>>2]|0);s=(h[d>>2]=(it*Tt+tt*yt+et*St)/c,r[d>>2]|0);u=13;l=a<0.0&1;n=(h[d>>2]=0.0/c,r[d>>2]|0);v=0;o=p/c}}while(0);a=(R*J+N*q+U*Z)*(it*Ct+tt*pt+et*vt)-(R*it+N*tt+U*et)*(Ct*J+pt*q+vt*Z);p=+W(+a)-((E+9.999999747378752e-06)*((lt+ct)*2.0*.5)+(A+9.999999747378752e-06)*((ht+_t)*2.0*.5)+(M+9.999999747378752e-06)*((mt+bt)*2.0*.5)+(H+9.999999747378752e-06)*(xt*.5));if(p>1.1920928955078125e-07){_=Pt;return}c=+G(+(g+x+0.0));do{if(c>1.1920928955078125e-07){if(!(p/c*1.0499999523162842>o))break;t=(h[d>>2]=-(Ct*J+pt*q+vt*Z)/c,r[d>>2]|0);s=(h[d>>2]=(it*Ct+tt*pt+et*vt)/c,r[d>>2]|0);u=14;l=a<0.0&1;n=(h[d>>2]=0.0/c,r[d>>2]|0);v=0;o=p/c}}while(0);c=(R*J+N*q+U*Z)*(it*wt+tt*Rt+et*It)-(R*it+N*tt+U*et)*(wt*J+Rt*q+It*Z);p=+W(+c)-((j+9.999999747378752e-06)*((lt+ct)*2.0*.5)+(z+9.999999747378752e-06)*((ht+_t)*2.0*.5)+(X+9.999999747378752e-06)*((mt+bt)*2.0*.5)+(H+9.999999747378752e-06)*((gt+ft)*2.0*.5));if(p>1.1920928955078125e-07){_=Pt;return}a=+G(+(f+w+0.0));do{if(a>1.1920928955078125e-07){if(!(p/a*1.0499999523162842>o)){At=55;break}t=(h[d>>2]=-(wt*J+Rt*q+It*Z)/a,r[d>>2]|0);s=(h[d>>2]=(it*wt+tt*Rt+et*It)/a,r[d>>2]|0);u=15;l=c<0.0&1;n=(h[d>>2]=0.0/a,r[d>>2]|0);o=p/a;At=58}else At=55}while(0);do{if((At|0)==55){if(!u){_=Pt;return}if(!v){At=58;break}n=r[v>>2]|0;t=r[v+16>>2]|0;Mt=r[v+32>>2]|0;a=(r[d>>2]=n,+h[d>>2]);c=(r[d>>2]=t,+h[d>>2]);p=(r[d>>2]=Mt,+h[d>>2]);s=l;l=Mt;R=o}}while(0);if((At|0)==58){it=(r[d>>2]=t,+h[d>>2]);p=(r[d>>2]=s,+h[d>>2]);R=(r[d>>2]=n,+h[d>>2]);a=it*+h[Pt+48>>2]+p*+h[I>>2]+R*rt;n=(h[d>>2]=a,r[d>>2]|0);c=it*+h[Pt+48+16>>2]+p*+h[Pt+48+20>>2]+R*at;t=(h[d>>2]=c,r[d>>2]|0);R=it*+h[Pt+48+32>>2]+p*+h[Pt+48+36>>2]+R*dt;p=R;s=l;l=(h[d>>2]=R,r[d>>2]|0);R=o}if(!s){Et=t;Mt=l}else{n=(h[d>>2]=-a,r[d>>2]|0);Et=(h[d>>2]=-c,r[d>>2]|0);Mt=(h[d>>2]=-p,r[d>>2]|0)}if((u|0)>6){M=(r[d>>2]=n,+h[d>>2]);E=(r[d>>2]=Et,+h[d>>2]);A=(r[d>>2]=Mt,+h[d>>2]);a=+h[Pt+48>>2];y=+h[Pt+48+16>>2];x=+h[Pt+48+32>>2];S=(M*a+E*y+A*x>0.0?1.0:-1.0)*((lt+ct)*2.0*.5);T=+h[I>>2];C=+h[Pt+48+20>>2];o=+h[Pt+48+36>>2];b=(M*T+E*C+A*o>0.0?1.0:-1.0)*((ht+_t)*2.0*.5);w=(M*rt+E*at+A*dt>0.0?1.0:-1.0)*(ut*.5);T=+h[e+48>>2]+S*a+b*T+w*rt;C=+h[e+52>>2]+S*y+b*C+w*at;w=+h[e+56>>2]+S*x+b*o+w*dt;r[Pt+528>>2]=r[e+112>>2];r[Pt+528+4>>2]=r[e+112+4>>2];r[Pt+528+8>>2]=r[e+112+8>>2];o=(M*Tt+E*yt+A*St>0.0?-1.0:1.0)*((mt+bt)*2.0*.5);b=(M*Ct+E*pt+A*vt>0.0?-1.0:1.0)*((gt+ft)*2.0*.5);x=+h[Pt+528+4>>2]+o*yt+b*pt;S=+h[Pt+528+8>>2]+o*St+b*vt;y=(M*wt+E*Rt+A*It>0.0?-1.0:1.0)*(xt*.5);b=+h[Pt+528>>2]+o*Tt+b*Ct+y*wt;h[Pt+528>>2]=b;h[Pt+528+4>>2]=x+y*Rt;h[Pt+528+8>>2]=S+y*It;Mt=u+-7|0;o=+h[Pt+48+(((Mt|0)/3|0)<<2)>>2];a=+h[Pt+48+(((Mt|0)/3|0)+4<<2)>>2];c=+h[Pt+48+(((Mt|0)/3|0)+8<<2)>>2];f=+h[Pt+(((Mt|0)%3|0)<<2)>>2];m=+h[Pt+(((Mt|0)%3|0)+4<<2)>>2];g=+h[Pt+(((Mt|0)%3|0)+8<<2)>>2];p=1.0-(o*f+a*m+c*g)*(o*f+a*m+c*g);if(!(p<=9.999999747378752e-05))o=(((b-T)*o+(x+y*Rt-C)*a+(S+y*It-w)*c)*(o*f+a*m+c*g)-((b-T)*f+(x+y*Rt-C)*m+(S+y*It-w)*g))*(1.0/p);else o=0.0;h[Pt+528>>2]=b+o*f;h[Pt+528+4>>2]=x+y*Rt+o*m;h[Pt+528+8>>2]=S+y*It+o*g;Mt=r[(r[i>>2]|0)+16>>2]|0;h[Pt+456>>2]=-M;h[Pt+456+4>>2]=-E;h[Pt+456+8>>2]=-A;h[Pt+456+12>>2]=0.0;Uk[Mt&15](i,Pt+456|0,Pt+528|0,R);_=Pt;return}nt=(u|0)<4;rt=(r[d>>2]=n,+h[d>>2]);if(nt){l=Pt+48|0;$=Pt;V=Pt+484|0;v=Pt+472|0;it=rt;s=Mt;n=Et;ot=e+48|0;t=e+112|0}else{n=(h[d>>2]=-(r[d>>2]=Et,+h[d>>2]),r[d>>2]|0);l=Pt;$=Pt+48|0;V=Pt+472|0;v=Pt+484|0;it=-rt;s=(h[d>>2]=-(r[d>>2]=Mt,+h[d>>2]),r[d>>2]|0);ot=e+112|0;t=e+48|0}et=(r[d>>2]=n,+h[d>>2]);tt=(r[d>>2]=s,+h[d>>2]);o=it*+h[$>>2]+et*+h[$+16>>2]+tt*+h[$+32>>2];h[Pt+440>>2]=o;a=it*+h[$+4>>2]+et*+h[$+20>>2]+tt*+h[$+36>>2];h[Pt+440+4>>2]=a;f=it*+h[$+8>>2]+et*+h[$+24>>2]+tt*+h[$+40>>2];h[Pt+440+8>>2]=f;o=+W(+o);a=+W(+a);f=+W(+f);n=a>o?a>f?1:2:o>f?0:2;Y=a>o?0:o>f&1;K=(a>o?a>f:o>f)?2:1;f=+h[v+(n<<2)>>2];o=+h[t>>2]-+h[ot>>2];a=f*+h[$+(n<<2)>>2];c=+h[t+4>>2];st=ot+4|0;p=+h[st>>2];if(+h[Pt+440+(n<<2)>>2]<0.0){J=o+a;Z=c-p+f*+h[$+((n|4)<<2)>>2];q=+h[t+8>>2]-+h[ot+8>>2]+f*+h[$+((n|8)<<2)>>2]}else{J=o-a;Z=c-p-f*+h[$+((n|4)<<2)>>2];q=+h[t+8>>2]-+h[ot+8>>2]-f*+h[$+((n|8)<<2)>>2]}F=(nt?-1:-4)+u|0;switch(F|0){case 0:{n=1;s=2;break}case 1:{n=0;s=2;break}default:{n=0;s=1}}O=l+(n<<2)|0;H=+h[O>>2];z=+h[O+16>>2];j=+h[O+32>>2];X=J*H+Z*z+q*j;O=l+(s<<2)|0;N=+h[O>>2];A=+h[O+16>>2];E=+h[O+32>>2];U=J*N+Z*A+q*E;O=$+(Y<<2)|0;R=+h[O>>2];C=+h[O+16>>2];T=+h[O+32>>2];B=$+(K<<2)|0;M=+h[B>>2];x=+h[B+16>>2];w=+h[B+32>>2];Rt=+h[v+(Y<<2)>>2];It=+h[v+(K<<2)>>2];Tt=(H*M+z*x+j*w)*It;It=(N*M+A*x+E*w)*It;h[Pt+408>>2]=X-(H*R+z*C+j*T)*Rt-Tt;h[Pt+408+4>>2]=U-(N*R+A*C+E*T)*Rt-It;h[Pt+408+8>>2]=X-(H*R+z*C+j*T)*Rt+Tt;h[Pt+408+12>>2]=U-(N*R+A*C+E*T)*Rt+It;h[Pt+408+16>>2]=X+(H*R+z*C+j*T)*Rt+Tt;h[Pt+408+20>>2]=U+(N*R+A*C+E*T)*Rt+It;h[Pt+408+24>>2]=X+(H*R+z*C+j*T)*Rt-Tt;h[Pt+408+28>>2]=U+(N*R+A*C+E*T)*Rt-It;r[Pt+400>>2]=r[V+(n<<2)>>2];r[Pt+400+4>>2]=r[V+(s<<2)>>2];k=0;s=4;e=Pt+408|0;D=Pt+336|0;t:while(1){P=Pt+400+(k<<2)|0;L=1-k|0;do{if((s|0)>0){t=0;I=e;n=D;while(1){l=I+(k<<2)|0;o=+h[l>>2];a=+h[P>>2];if(a>-o){r[n>>2]=r[I>>2];r[n+4>>2]=r[I+4>>2];t=t+1|0;if(t&8|0){s=t;n=D;break t}o=+h[l>>2];a=+h[P>>2];u=n+8|0}else u=n;v=(s|0)>1;l=I;I=I+8|0;n=v?I:e;c=+h[n+(k<<2)>>2];if(a>-o^a>-c){It=+h[l+(L<<2)>>2];h[u+(L<<2)>>2]=It+(-a-o)*((+h[n+(L<<2)>>2]-It)/(c-o));h[u+(k<<2)>>2]=-+h[P>>2];n=t+1|0;if(!(n&8)){t=n;n=u+8|0}else{s=n;n=D;break t}}else n=u;if(!v)break;else s=s+-1|0}n=(D|0)==(Pt+336|0)?Pt+528|0:Pt+336|0;if((t|0)<=0){s=0;break}I=t;s=0;e=D;t=n;while(1){l=e+(k<<2)|0;o=+h[l>>2];a=+h[P>>2];if(o<a){r[t>>2]=r[e>>2];r[t+4>>2]=r[e+4>>2];s=s+1|0;if(s&8|0)break t;o=+h[l>>2];a=+h[P>>2];t=t+8|0}v=(I|0)>1;u=e;e=e+8|0;l=v?e:D;c=+h[l+(k<<2)>>2];if(o<a^c<a){It=+h[u+(L<<2)>>2];h[t+(L<<2)>>2]=It+(a-o)*((+h[l+(L<<2)>>2]-It)/(c-o));r[t+(k<<2)>>2]=r[P>>2];s=s+1|0;if(!(s&8))t=t+8|0;else break t}if(!v)break;else I=I+-1|0}}else{n=(D|0)==(Pt+336|0)?Pt+528|0:Pt+336|0;s=0}}while(0);k=k+1|0;if((k|0)>=2)break;else{e=n;D=(n|0)==(Pt+336|0)?Pt+528|0:Pt+336|0}}if((n|0)!=(Pt+336|0))Oh(Pt+336|0,n|0,s<<3|0)|0;if((s|0)>=1){S=1.0/((H*R+z*C+j*T)*(N*M+A*x+E*w)-(N*R+A*C+E*T)*(H*M+z*x+j*w));y=+h[V+(F<<2)>>2];b=+h[O>>2];f=+h[B>>2];m=+h[$+((Y|4)<<2)>>2];g=+h[$+((K|4)<<2)>>2];p=+h[$+((Y|8)<<2)>>2];c=+h[$+((K|8)<<2)>>2];t=0;n=0;do{$=n<<1;o=+h[Pt+336+($<<2)>>2];a=+h[Pt+336+(($|1)<<2)>>2];Ct=(N*M+A*x+E*w)*S*(o-X)-(H*M+z*x+j*w)*S*(a-U);It=(H*R+z*C+j*T)*S*(a-U)-(N*R+A*C+E*T)*S*(o-X);$=t*3|0;Tt=J+Ct*b+It*f;h[Pt+240+($<<2)>>2]=Tt;Rt=Z+Ct*m+It*g;h[Pt+240+($+1<<2)>>2]=Rt;It=q+Ct*p+It*c;h[Pt+240+($+2<<2)>>2]=It;It=y-(it*Tt+et*Rt+tt*It);h[Pt+208+(t<<2)>>2]=It;if(It>=0.0){$=t<<1;h[Pt+336+($<<2)>>2]=o;h[Pt+336+(($|1)<<2)>>2]=a;t=t+1|0}n=n+1|0}while((n|0)!=(s|0));t:do{if((t|0)>=1){I=(t|0)<4?t:4;I=(I|0)<1?1:I;if((t|0)<=(I|0))if(nt){s=ot+8|0;a=-(r[d>>2]=Et,+h[d>>2]);o=-(r[d>>2]=Mt,+h[d>>2]);n=0;while(1){Mt=n*3|0;h[Pt+528>>2]=+h[Pt+240+(Mt<<2)>>2]+ +h[ot>>2];h[Pt+528+4>>2]=+h[Pt+240+(Mt+1<<2)>>2]+ +h[st>>2];h[Pt+528+8>>2]=+h[Pt+240+(Mt+2<<2)>>2]+ +h[s>>2];Mt=r[(r[i>>2]|0)+16>>2]|0;h[Pt+192>>2]=-rt;h[Pt+192+4>>2]=a;h[Pt+192+8>>2]=o;h[Pt+192+12>>2]=0.0;Uk[Mt&15](i,Pt+192|0,Pt+528|0,-+h[Pt+208+(n<<2)>>2]);n=n+1|0;if((n|0)==(t|0))break t}}else{s=ot+8|0;a=(r[d>>2]=Et,+h[d>>2]);o=(r[d>>2]=Mt,+h[d>>2]);n=0;while(1){Mt=n*3|0;It=+h[Pt+208+(n<<2)>>2];h[Pt+528>>2]=+h[Pt+240+(Mt<<2)>>2]+ +h[ot>>2]-rt*It;h[Pt+528+4>>2]=+h[Pt+240+(Mt+1<<2)>>2]+ +h[st>>2]-a*It;h[Pt+528+8>>2]=+h[Pt+240+(Mt+2<<2)>>2]+ +h[s>>2]-o*It;Mt=r[(r[i>>2]|0)+16>>2]|0;h[Pt+176>>2]=-rt;h[Pt+176+4>>2]=-a;h[Pt+176+8>>2]=-o;h[Pt+176+12>>2]=0.0;Uk[Mt&15](i,Pt+176|0,Pt+528|0,-It);n=n+1|0;if((n|0)==(t|0))break t}}e:do{if((t|0)>1){s=1;l=0;a=+h[Pt+208>>2];while(1){o=+h[Pt+208+(s<<2)>>2];n=o>a;l=n?s:l;s=s+1|0;if((s|0)==(t|0))break;else a=n?o:a}switch(t|0){case 1:{n=Pt+144|0;s=Pt+144|0;t=1;At=111;break e}case 2:{n=Pt+144|0;s=Pt+144|0;t=2;a=(+h[Pt+336>>2]+ +h[Pt+336+8>>2])*.5;o=(+h[Pt+336+4>>2]+ +h[Pt+336+12>>2])*.5;At=116;break e}default:{}}n=t+-1|0;o=0.0;a=0.0;g=0.0;s=0;do{$=s<<1;Ct=+h[Pt+336+($<<2)>>2];Tt=+h[Pt+336+($+3<<2)>>2];Rt=+h[Pt+336+($+2<<2)>>2];It=+h[Pt+336+(($|1)<<2)>>2];o=o+(Ct*Tt-Rt*It);a=a+(Ct+Rt)*(Ct*Tt-Rt*It);g=g+(Tt+It)*(Ct*Tt-Rt*It);s=s+1|0}while((s|0)!=(n|0));$=t<<1;c=+h[Pt+336+($+-2<<2)>>2];p=+h[Pt+336+4>>2];f=+h[Pt+336>>2];m=+h[Pt+336+($+-1<<2)>>2];o=o+(c*p-f*m);if(+W(+o)>1.1920928955078125e-07)o=1.0/(o*3.0);else o=999999984306749440.0;if((t|0)>0){v=Pt+144|0;s=Pt+144|0;u=Pt+528|0;a=o*(a+(c*p-f*m)*(c+f));o=o*(g+(c*p-f*m)*(m+p));At=119;break}n=Pt+144|0;s=0;v=t}else{n=Pt+144|0;s=Pt+144|0;l=0;At=111}}while(0);if((At|0)==111){a=+h[Pt+336>>2];o=+h[Pt+336+4>>2];At=116}if((At|0)==116){v=n;u=Pt+528|0;At=119}if((At|0)==119){n=0;do{At=n<<1;h[Pt+528+(n<<2)>>2]=+Q(+(+h[Pt+336+((At|1)<<2)>>2]-o),+(+h[Pt+336+(At<<2)>>2]-a));n=n+1|0}while((n|0)!=(t|0));n=0;do{r[Pt+496+(n<<2)>>2]=1;n=n+1|0}while((n|0)!=(t|0));n=v;s=1;v=t}t=Pt+496+(l<<2)|0;r[t>>2]=0;r[n>>2]=l;e:do{if((I|0)>1){p=+h[Pt+528+(l<<2)>>2];if(s){s=Pt+144+4|0;u=1}else{n=Pt+144+4|0;s=1;while(1){r[n>>2]=l;r[t>>2]=0;s=s+1|0;if((s|0)==(I|0))break e;else n=n+4|0}}while(1){c=6.2831854820251465/+(I|0)*+(u|0)+p;c=c>3.1415927410125732?c+-6.2831854820251465:c;r[s>>2]=l;n=l;t=0;a=1.0e9;while(1){do{if(!(r[Pt+496+(t<<2)>>2]|0))o=a;else{o=+W(+(+h[Pt+528+(t<<2)>>2]-c));o=o>3.1415927410125732?6.2831854820251465-o:o;if(!(o<a)){o=a;break}r[s>>2]=t;n=t}}while(0);t=t+1|0;if((t|0)==(v|0))break;else a=o}r[Pt+496+(n<<2)>>2]=0;u=u+1|0;if((u|0)==(I|0))break;else s=s+4|0}}}while(0);if((I|0)>0){s=ot+8|0;a=(r[d>>2]=Et,+h[d>>2]);o=(r[d>>2]=Mt,+h[d>>2]);if(nt){n=0;do{Mt=r[Pt+144+(n<<2)>>2]|0;h[Pt+528>>2]=+h[Pt+240+(Mt*3<<2)>>2]+ +h[ot>>2];h[Pt+528+4>>2]=+h[Pt+240+((Mt*3|0)+1<<2)>>2]+ +h[st>>2];h[Pt+528+8>>2]=+h[Pt+240+((Mt*3|0)+2<<2)>>2]+ +h[s>>2];Et=r[(r[i>>2]|0)+16>>2]|0;h[Pt+128>>2]=-rt;h[Pt+128+4>>2]=-a;h[Pt+128+8>>2]=-o;h[Pt+128+12>>2]=0.0;Uk[Et&15](i,Pt+128|0,Pt+528|0,-+h[Pt+208+(Mt<<2)>>2]);n=n+1|0}while((n|0)<(I|0))}else{n=0;do{Et=r[Pt+144+(n<<2)>>2]|0;Ct=+h[Pt+240+(Et*3<<2)>>2]+ +h[ot>>2];h[Pt+528>>2]=Ct;Tt=+h[Pt+240+((Et*3|0)+1<<2)>>2]+ +h[st>>2];h[Pt+528+4>>2]=Tt;Rt=+h[Pt+240+((Et*3|0)+2<<2)>>2]+ +h[s>>2];h[Pt+528+8>>2]=Rt;Mt=r[(r[i>>2]|0)+16>>2]|0;h[Pt+112>>2]=-rt;h[Pt+112+4>>2]=-a;h[Pt+112+8>>2]=-o;h[Pt+112+12>>2]=0.0;It=+h[Pt+208+(Et<<2)>>2];h[Pt+96>>2]=Ct-rt*It;h[Pt+96+4>>2]=Tt-It*a;h[Pt+96+8>>2]=Rt-It*o;h[Pt+96+12>>2]=0.0;Uk[Mt&15](i,Pt+112|0,Pt+96|0,-It);n=n+1|0}while((n|0)<(I|0))}}}}while(0)}_=Pt;return}function xS(t){t=t|0;var e=0;r[t>>2]=3064;e=r[t+20>>2]|0;if(e|0){if(n[t+24>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+20>>2]=0}n[t+24>>0]=1;r[t+20>>2]=0;r[t+12>>2]=0;r[t+16>>2]=0;return}function wS(t){t=t|0;var e=0;r[t>>2]=3064;e=r[t+20>>2]|0;if(!e){Ql(t);return}if(!(n[t+24>>0]|0)){Ql(t);return}r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);Ql(t);return}function CS(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0;s=_;_=_+16|0;r[s>>2]=t;r[s+4>>2]=n;t=r[t+72+((r[(r[e+4>>2]|0)+4>>2]|0)*144|0)+(r[(r[i+4>>2]|0)+4>>2]<<2)>>2]|0;t=pk[r[(r[t>>2]|0)+8>>2]&31](t,s,e,i)|0;_=s;return t|0}function TS(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0,l=0.0,c=0,u=0,d=0,p=0.0;d=_;_=_+16|0;r[4989]=(r[4989]|0)+1;if(!(r[t+4>>2]&2))s=6988;else{s=r[e+192>>2]|0;p=+kk[r[(r[s>>2]|0)+20>>2]&1](s,.019999999552965164);h[d+4>>2]=p;s=r[i+192>>2]|0;l=+kk[r[(r[s>>2]|0)+20>>2]&1](s,.019999999552965164);h[d>>2]=l;s=p<l?d+4|0:d}a=r[s>>2]|0;p=+h[e+184>>2];l=+h[i+184>>2];l=p<l?p:l;s=r[t+68>>2]|0;o=r[s+8>>2]|0;if(!o){if(r[t+4>>2]&4|0){t=0;_=d;return t|0}r[5637]=(r[5637]|0)+1;s=Zl(791)|0;if(!s)c=0;else{r[(s+4+15&-16)+-4>>2]=s;c=s+4+15&-16}}else{c=r[s+12>>2]|0;r[s+12>>2]=r[c>>2];r[s+8>>2]=o+-1}r[c>>2]=1025;r[c+116>>2]=0;n[c+120>>0]=0;s=c+124|0;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;r[s+16>>2]=0;r[s+20>>2]=0;r[s+24>>2]=0;r[s+28>>2]=0;r[c+300>>2]=0;n[c+304>>0]=0;s=c+308|0;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;r[s+16>>2]=0;r[s+20>>2]=0;r[s+24>>2]=0;r[s+28>>2]=0;r[c+484>>2]=0;n[c+488>>0]=0;s=c+492|0;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;r[s+16>>2]=0;r[s+20>>2]=0;r[s+24>>2]=0;r[s+28>>2]=0;r[c+668>>2]=0;n[c+672>>0]=0;s=c+676|0;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;r[s+16>>2]=0;r[s+20>>2]=0;r[s+24>>2]=0;r[s+28>>2]=0;r[c+740>>2]=e;r[c+744>>2]=i;r[c+748>>2]=0;r[c+752>>2]=a;h[c+756>>2]=l;e=c;s=r[t+12>>2]|0;r[c+768>>2]=s;if((s|0)==(r[t+16>>2]|0)?(u=s|0?s<<1:1,(s|0)<(u|0)):0){if(!u)a=0;else{r[5637]=(r[5637]|0)+1;s=Zl((u<<2|3)+16|0)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}a=s;s=r[t+12>>2]|0}if((s|0)>0){o=0;do{r[a+(o<<2)>>2]=r[(r[t+20>>2]|0)+(o<<2)>>2];o=o+1|0}while((o|0)!=(s|0))}o=r[t+20>>2]|0;if(o){if(n[t+24>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0);s=r[t+12>>2]|0}r[t+20>>2]=0}n[t+24>>0]=1;r[t+20>>2]=a;r[t+16>>2]=u}r[(r[t+20>>2]|0)+(s<<2)>>2]=e;r[t+12>>2]=s+1;t=c;_=d;return t|0}function AS(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0;r[4989]=(r[4989]|0)+-1;lk[r[(r[t>>2]|0)+20>>2]&127](t,e);n=r[e+768>>2]|0;i=(r[t+12>>2]|0)+-1|0;o=r[t+20>>2]|0;s=r[o+(n<<2)>>2]|0;r[o+(n<<2)>>2]=r[o+(i<<2)>>2];r[(r[t+20>>2]|0)+(i<<2)>>2]=s;r[(r[(r[t+20>>2]|0)+(n<<2)>>2]|0)+768>>2]=n;r[t+12>>2]=i;t=r[t+68>>2]|0;if(!e)return;o=r[t+16>>2]|0;if(o>>>0<=e>>>0?(o+(et(r[t>>2]|0,r[t+4>>2]|0)|0)|0)>>>0>e>>>0:0){r[e>>2]=r[t+12>>2];r[t+12>>2]=e;r[t+8>>2]=(r[t+8>>2]|0)+1;return}r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);return}function ES(t,e){t=t|0;e=e|0;r[e+748>>2]=0;return}function MS(t,e,i){t=t|0;e=e|0;i=i|0;t:do{switch(r[e+216>>2]|0){case 2:case 5:{switch(r[i+216>>2]|0){case 2:case 5:{e=0;break}default:break t}return e|0}default:{}}}while(0);if(!((r[e+260>>2]|0)!=0?!(Rk[r[(r[e>>2]|0)+12>>2]&31](e,i)|0):0)){if(!(r[i+260>>2]|0)){t=1;return t|0}if(Rk[r[(r[i>>2]|0)+12>>2]&31](i,e)|0){t=1;return t|0}}t=0;return t|0}function RS(t,e,i){t=t|0;e=e|0;i=i|0;t=r[e+204>>2]|0;if(t&4|0){i=0;return i|0}e=r[i+204>>2]|0;if(e&4|0){i=0;return i|0}if(!(t&3)){i=1;return i|0}i=(e&3|0)==0;return i|0}function IS(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0;s=_;_=_+16|0;r[s>>2]=3136;r[s+4>>2]=i;r[s+8>>2]=t;Vk[r[(r[e>>2]|0)+48>>2]&127](e,s,n);_=s;return}function PS(t){t=t|0;Ql(t);return}function LS(t,e){t=t|0;e=e|0;var i=0;i=r[t+8>>2]|0;Vk[r[i+60>>2]&127](e,i,r[t+4>>2]|0);return 0}function DS(t){t=t|0;return r[t+12>>2]|0}function kS(t,e){t=t|0;e=e|0;return r[(r[t+20>>2]|0)+(e<<2)>>2]|0}function OS(t){t=t|0;if(!(r[t+12>>2]|0)){t=0;return t|0}t=r[t+20>>2]|0;return t|0}function FS(t){t=t|0;return r[t+68>>2]|0}function BS(t){t=t|0;return r[t+68>>2]|0}function NS(t,e){t=t|0;e=e|0;var i=0;t=r[t+64>>2]|0;i=r[t+8>>2]|0;if(i|0){e=r[t+12>>2]|0;r[t+12>>2]=r[e>>2];r[t+8>>2]=i+-1;return e|0}r[5637]=(r[5637]|0)+1;t=Zl(e+19|0)|0;if(!t){e=0;return e|0}r[(t+4+15&-16)+-4>>2]=t;e=t+4+15&-16;return e|0}function US(t,e){t=t|0;e=e|0;var i=0;t=r[t+64>>2]|0;if(!e)return;i=r[t+16>>2]|0;if(i>>>0<=e>>>0?(i+(et(r[t>>2]|0,r[t+4>>2]|0)|0)|0)>>>0>e>>>0:0){r[e>>2]=r[t+12>>2];r[t+12>>2]=e;r[t+8>>2]=(r[t+8>>2]|0)+1;return}r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);return}function VS(t,e){t=t|0;e=e|0;var i=0,s=0;r[t>>2]=3064;r[t+4>>2]=2;n[t+24>>0]=1;r[t+20>>2]=0;r[t+12>>2]=0;r[t+16>>2]=0;r[t+28>>2]=4460;r[t+5256>>2]=e;r[t+60>>2]=70;r[t+64>>2]=ck[r[(r[e>>2]|0)+12>>2]&127](e)|0;r[t+68>>2]=ck[r[(r[e>>2]|0)+8>>2]&127](e)|0;e=0;do{i=0;do{s=r[t+5256>>2]|0;r[t+72+(e*144|0)+(i<<2)>>2]=yk[r[(r[s>>2]|0)+16>>2]&63](s,e,i)|0;i=i+1|0}while((i|0)<36);e=e+1|0}while((e|0)<36);return}function zS(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0,o=0,a=0,l=0,c=0;c=_;_=_+80|0;o=r[r[t>>2]>>2]|0;a=r[r[t+4>>2]>>2]|0;if(!(yk[r[(r[e>>2]|0)+24>>2]&63](e,o,a)|0)){_=c;return}s=r[o+192>>2]|0;r[c+56>>2]=0;r[c+56+4>>2]=s;r[c+56+8>>2]=o;r[c+56+12>>2]=o+4;r[c+56+16>>2]=-1;r[c+56+20>>2]=-1;s=r[a+192>>2]|0;r[c+32>>2]=0;r[c+32+4>>2]=s;r[c+32+8>>2]=a;r[c+32+12>>2]=a+4;r[c+32+16>>2]=-1;r[c+32+20>>2]=-1;s=r[t+8>>2]|0;if(!s){s=pk[r[(r[e>>2]|0)+8>>2]&31](e,c+56|0,c+32|0,0)|0;r[t+8>>2]=s;if(s|0)l=4}else l=4;if((l|0)==4){r[c>>2]=4460;r[c+4>>2]=0;r[c+8>>2]=c+56;r[c+12>>2]=c+32;if((r[i+8>>2]|0)!=1){n=+bk[r[(r[s>>2]|0)+12>>2]&15](s,o,a,i,c);if(+h[i+12>>2]>n)h[i+12>>2]=n}else sk[r[(r[s>>2]|0)+8>>2]&31](s,c+56|0,c+32|0,i,c)}_=c;return}function WS(t){t=t|0;var e=0;r[t>>2]=3156;e=r[t+276>>2]|0;if(e|0){if(n[t+280>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+276>>2]=0}n[t+280>>0]=1;r[t+276>>2]=0;r[t+268>>2]=0;r[t+272>>2]=0;return}function GS(t){t=t|0;var e=0;r[t>>2]=3156;e=r[t+276>>2]|0;if(e|0){if(n[t+280>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+276>>2]=0}n[t+280>>0]=1;r[t+276>>2]=0;r[t+268>>2]=0;r[t+272>>2]=0;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function jS(t,e){t=t|0;e=e|0;r[t+284>>2]=(r[t+284>>2]|0)+1;r[t+192>>2]=e;r[t+200>>2]=e;return}function HS(t,e){t=t|0;e=e|0;var i=0,n=0;n=r[t+268>>2]|0;t:do{if((n|0)>0){i=r[t+276>>2]|0;t=0;while(1){if((r[i+(t<<2)>>2]|0)==(e|0))break t;t=t+1|0;if((t|0)>=(n|0)){t=n;break}}}else t=n}while(0);return(t|0)>=(n|0)|0}function XS(t){t=t|0;return 256}function YS(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0;r[e+16>>2]=r[t+4>>2];r[e+20>>2]=r[t+8>>2];r[e+24>>2]=r[t+12>>2];r[e+28>>2]=r[t+16>>2];r[e+32>>2]=r[t+20>>2];r[e+36>>2]=r[t+24>>2];r[e+40>>2]=r[t+28>>2];r[e+44>>2]=r[t+32>>2];r[e+48>>2]=r[t+36>>2];r[e+52>>2]=r[t+40>>2];r[e+56>>2]=r[t+44>>2];r[e+60>>2]=r[t+48>>2];r[e+64>>2]=r[t+52>>2];r[e+68>>2]=r[t+56>>2];r[e+72>>2]=r[t+60>>2];r[e+76>>2]=r[t+64>>2];r[e+80>>2]=r[t+68>>2];r[e+84>>2]=r[t+72>>2];r[e+88>>2]=r[t+76>>2];r[e+92>>2]=r[t+80>>2];r[e+96>>2]=r[t+84>>2];r[e+100>>2]=r[t+88>>2];r[e+104>>2]=r[t+92>>2];r[e+108>>2]=r[t+96>>2];r[e+112>>2]=r[t+100>>2];r[e+116>>2]=r[t+104>>2];r[e+120>>2]=r[t+108>>2];r[e+124>>2]=r[t+112>>2];r[e+128>>2]=r[t+116>>2];r[e+132>>2]=r[t+120>>2];r[e+136>>2]=r[t+124>>2];r[e+140>>2]=r[t+128>>2];r[e+144>>2]=r[t+132>>2];r[e+148>>2]=r[t+136>>2];r[e+152>>2]=r[t+140>>2];r[e+156>>2]=r[t+144>>2];r[e+160>>2]=r[t+148>>2];r[e+164>>2]=r[t+152>>2];r[e+168>>2]=r[t+156>>2];r[e+172>>2]=r[t+160>>2];r[e+176>>2]=r[t+164>>2];r[e+180>>2]=r[t+168>>2];r[e+184>>2]=r[t+172>>2];r[e+188>>2]=r[t+176>>2];r[e+224>>2]=r[t+180>>2];r[e+192>>2]=r[t+184>>2];r[e>>2]=0;r[e+4>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,r[t+192>>2]|0)|0;r[e+8>>2]=0;r[e+228>>2]=r[t+204>>2];r[e+232>>2]=r[t+208>>2];r[e+236>>2]=r[t+212>>2];r[e+240>>2]=r[t+216>>2];r[e+196>>2]=r[t+220>>2];r[e+200>>2]=r[t+224>>2];r[e+204>>2]=r[t+232>>2];r[e+208>>2]=r[t+228>>2];r[e+244>>2]=r[t+236>>2];n=Rk[r[(r[i>>2]|0)+40>>2]&31](i,t)|0;s=Rk[r[(r[i>>2]|0)+28>>2]&31](i,n)|0;r[e+12>>2]=s;if(!s){i=t+248|0;i=r[i>>2]|0;s=e+212|0;r[s>>2]=i;s=t+252|0;s=r[s>>2]|0;i=e+216|0;r[i>>2]=s;i=t+256|0;i=r[i>>2]|0;s=e+220|0;r[s>>2]=i;t=t+260|0;t=r[t>>2]|0;s=e+248|0;r[s>>2]=t;return 9250}lk[r[(r[i>>2]|0)+48>>2]&127](i,n);i=t+248|0;i=r[i>>2]|0;s=e+212|0;r[s>>2]=i;s=t+252|0;s=r[s>>2]|0;i=e+216|0;r[i>>2]=s;i=t+256|0;i=r[i>>2]|0;s=e+220|0;r[s>>2]=i;t=t+260|0;t=r[t>>2]|0;s=e+248|0;r[s>>2]=t;return 9250}function qS(t,e){t=t|0;e=e|0;var i=0,n=0;n=ck[r[(r[t>>2]|0)+16>>2]&127](t)|0;n=yk[r[(r[e>>2]|0)+16>>2]&63](e,n,1)|0;i=yk[r[(r[t>>2]|0)+20>>2]&63](t,r[n+8>>2]|0,e)|0;sk[r[(r[e>>2]|0)+20>>2]&31](e,n,i,1245859651,t);return}function KS(t){t=t|0;var e=0,i=0,s=0,o=0,a=0;r[t>>2]=3192;i=r[t+8>>2]|0;e=r[t+16>>2]|0;if((i|0)>0){a=0;do{s=(r[e+(a<<2)>>2]|0)+188|0;o=r[s>>2]|0;if(o){i=r[t+68>>2]|0;i=ck[r[(r[i>>2]|0)+36>>2]&127](i)|0;Vk[r[(r[i>>2]|0)+40>>2]&127](i,o,r[t+24>>2]|0);i=r[t+68>>2]|0;Vk[r[(r[i>>2]|0)+12>>2]&127](i,o,r[t+24>>2]|0);r[s>>2]=0;i=r[t+8>>2]|0;e=r[t+16>>2]|0}a=a+1|0}while((a|0)<(i|0))}if(!e){n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;t=t+12|0;r[t>>2]=0;return}if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+16>>2]=0;n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;t=t+12|0;r[t>>2]=0;return}function ZS(t){t=t|0;KS(t);Ql(t);return}function QS(t){t=t|0;var e=0,i=0.0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0,f=0,m=0,g=0,b=0;b=_;_=_+64|0;j_(9296);e=r[t+8>>2]|0;if((e|0)>0){f=0;do{p=r[(r[t+16>>2]|0)+(f<<2)>>2]|0;if(!(n[t+76>>0]|0))switch(r[p+216>>2]|0){case 2:case 5:break;default:g=11}else g=11;if((g|0)==11){g=0;e=r[p+192>>2]|0;jk[r[(r[e>>2]|0)+8>>2]&127](e,p+4|0,b+48|0,b+32|0);l=+h[b+48>>2]+-.019999999552965164;h[b+48>>2]=l;c=+h[b+48+4>>2]+-.019999999552965164;h[b+48+4>>2]=c;a=+h[b+48+8>>2]+-.019999999552965164;h[b+48+8>>2]=a;i=+h[b+32>>2]+.019999999552965164;h[b+32>>2]=i;s=+h[b+32+4>>2]+.019999999552965164;h[b+32+4>>2]=s;o=+h[b+32+8>>2]+.019999999552965164;h[b+32+8>>2]=o;if(((n[t+44>>0]|0)!=0?(r[p+236>>2]|0)==2:0)?(r[p+204>>2]&3|0)==0:0){e=r[p+192>>2]|0;jk[r[(r[e>>2]|0)+8>>2]&127](e,p+68|0,b+16|0,b);l=+h[b+16>>2]+-.019999999552965164;h[b+16>>2]=l;c=+h[b+16+4>>2]+-.019999999552965164;h[b+16+4>>2]=c;s=+h[b+16+8>>2]+-.019999999552965164;h[b+16+8>>2]=s;o=+h[b>>2]+.019999999552965164;h[b>>2]=o;a=+h[b+4>>2]+.019999999552965164;h[b+4>>2]=a;u=+h[b+8>>2]+.019999999552965164;h[b+8>>2]=u;i=+h[b+48>>2];if(l<i)h[b+48>>2]=l;else l=i;i=+h[b+48+4>>2];if(c<i)h[b+48+4>>2]=c;else c=i;i=+h[b+48+8>>2];if(s<i){h[b+48+8>>2]=s;d=s}else d=i;i=+h[b+16+12>>2];if(i<+h[b+48+12>>2])h[b+48+12>>2]=i;i=+h[b+32>>2];if(i<o){h[b+32>>2]=o;i=o}s=+h[b+32+4>>2];if(s<a){h[b+32+4>>2]=a;s=a}o=+h[b+32+8>>2];if(o<u){h[b+32+8>>2]=u;o=u}a=+h[b+12>>2];if(+h[b+32+12>>2]<a)h[b+32+12>>2]=a;a=d}e=r[t+68>>2]|0;if((r[p+204>>2]&1|0)==0?(l=i-l,u=s-c,d=o-a,!(l*l+u*u+d*d<999999995904.0)):0){if((r[p+216>>2]&-2|0)!=4)r[p+216>>2]=5;if(n[9308]|0?(m=r[t+72>>2]|0,m|0):0){n[9308]=0;lk[r[(r[m>>2]|0)+44>>2]&127](m,9309);p=r[t+72>>2]|0;lk[r[(r[p>>2]|0)+44>>2]&127](p,9358);p=r[t+72>>2]|0;lk[r[(r[p>>2]|0)+44>>2]&127](p,9426);p=r[t+72>>2]|0;lk[r[(r[p>>2]|0)+44>>2]&127](p,9491)}}else sk[r[(r[e>>2]|0)+16>>2]&31](e,r[p+188>>2]|0,b+48|0,b+32|0,r[t+24>>2]|0);e=r[t+8>>2]|0}f=f+1|0}while((f|0)<(e|0))}e=r[2006]|0;g=(r[e+16>>2]|0)+-1|0;r[e+16>>2]=g;if(g|0){_=b;return}do{if(r[e+4>>2]|0){de(b+48|0,0)|0;g=r[5649]|0;h[e+8>>2]=+h[e+8>>2]+ +(((r[b+48+4>>2]|0)-(r[g+4>>2]|0)+(((r[b+48>>2]|0)-(r[g>>2]|0)|0)*1e6|0)-(r[e+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[e+16>>2]|0)){e=r[2006]|0;break}else{_=b;return}}}while(0);r[2006]=r[e+20>>2];_=b;return}function $S(t){t=t|0;var e=0,i=0;e=_;_=_+16|0;j_(9500);i=r[t+68>>2]|0;lk[r[(r[i>>2]|0)+32>>2]&127](i,r[t+24>>2]|0);t=r[2006]|0;i=(r[t+16>>2]|0)+-1|0;r[t+16>>2]=i;if(i|0){_=e;return}do{if(r[t+4>>2]|0){de(e|0,0)|0;i=r[5649]|0;h[t+8>>2]=+h[t+8>>2]+ +(((r[e+4>>2]|0)-(r[i+4>>2]|0)+(((r[e>>2]|0)-(r[i>>2]|0)|0)*1e6|0)-(r[t+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[t+16>>2]|0)){t=r[2006]|0;break}else{_=e;return}}}while(0);r[2006]=r[t+20>>2];_=e;return}function JS(t,e){t=t|0;e=e|0;r[t+72>>2]=e;return}function tx(t){t=t|0;return r[t+72>>2]|0}function ex(t){t=t|0;var e=0.0,i=0,s=0,o=0,a=0,l=0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0,g=0;m=_;_=_+192|0;if(!(ck[r[(r[t>>2]|0)+20>>2]&127](t)|0)){_=m;return}a=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;lk[r[(r[a>>2]|0)+8>>2]&127](m+80|0,a);a=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;if(((ck[r[(r[a>>2]|0)+56>>2]&127](a)|0)&8|0?(i=r[t+24>>2]|0,i|0):0)?(l=ck[r[(r[i>>2]|0)+36>>2]&127](i)|0,(l|0)>0):0){o=0;do{i=r[t+24>>2]|0;i=Rk[r[(r[i>>2]|0)+40>>2]&31](i,o)|0;s=r[i+748>>2]|0;if((s|0)>0){a=0;do{g=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;ak[r[(r[g>>2]|0)+40>>2]&0](g,i+4+(a*184|0)+32|0,i+4+(a*184|0)+64|0,+h[i+4+(a*184|0)+80>>2],r[i+4+(a*184|0)+148>>2]|0,m+80+96|0);a=a+1|0}while((a|0)!=(s|0))}o=o+1|0}while((o|0)!=(l|0))}g=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;if((ck[r[(r[g>>2]|0)+56>>2]&127](g)|0)&3|0?(r[t+8>>2]|0)>0:0){o=0;do{s=r[(r[t+16>>2]|0)+(o<<2)>>2]|0;if(!(r[s+204>>2]&32)){if(ck[r[(r[t>>2]|0)+20>>2]&127](t)|0?(g=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0,(ck[r[(r[g>>2]|0)+56>>2]&127](g)|0)&1|0):0){r[m+64>>2]=1053609165;r[m+64+4>>2]=1053609165;r[m+64+8>>2]=1053609165;h[m+64+12>>2]=0.0;switch(r[s+216>>2]|0){case 1:{r[m+64>>2]=r[m+80>>2];r[m+64+4>>2]=r[m+80+4>>2];r[m+64+8>>2]=r[m+80+8>>2];r[m+64+12>>2]=r[m+80+12>>2];break}case 2:{r[m+64>>2]=r[m+80+16>>2];r[m+64+4>>2]=r[m+80+16+4>>2];r[m+64+8>>2]=r[m+80+16+8>>2];r[m+64+12>>2]=r[m+80+16+12>>2];break}case 3:{r[m+64>>2]=r[m+80+32>>2];r[m+64+4>>2]=r[m+80+32+4>>2];r[m+64+8>>2]=r[m+80+32+8>>2];r[m+64+12>>2]=r[m+80+32+12>>2];break}case 4:{r[m+64>>2]=r[m+80+48>>2];r[m+64+4>>2]=r[m+80+48+4>>2];r[m+64+8>>2]=r[m+80+48+8>>2];r[m+64+12>>2]=r[m+80+48+12>>2];break}case 5:{r[m+64>>2]=r[m+80+64>>2];r[m+64+4>>2]=r[m+80+64+4>>2];r[m+64+8>>2]=r[m+80+64+8>>2];r[m+64+12>>2]=r[m+80+64+12>>2];break}default:{r[m+64>>2]=1050253722;r[m+64+4>>2]=1050253722;r[m+64+8>>2]=1050253722;h[m+64+12>>2]=0.0}}jk[r[(r[t>>2]|0)+28>>2]&127](t,s+4|0,r[s+192>>2]|0,m+64|0)}i=r[t+72>>2]|0;if(i|0?(ck[r[(r[i>>2]|0)+56>>2]&127](i)|0)&2|0:0){r[m+32>>2]=r[m+80+80>>2];r[m+32+4>>2]=r[m+80+80+4>>2];r[m+32+8>>2]=r[m+80+80+8>>2];r[m+32+12>>2]=r[m+80+80+12>>2];g=r[s+192>>2]|0;jk[r[(r[g>>2]|0)+8>>2]&127](g,s+4|0,m+64|0,m+48|0);h[m+64>>2]=+h[m+64>>2]+-.019999999552965164;h[m+64+4>>2]=+h[m+64+4>>2]+-.019999999552965164;h[m+64+8>>2]=+h[m+64+8>>2]+-.019999999552965164;h[m+48>>2]=+h[m+48>>2]+.019999999552965164;h[m+48+4>>2]=+h[m+48+4>>2]+.019999999552965164;h[m+48+8>>2]=+h[m+48+8>>2]+.019999999552965164;do{if((n[t+44>>0]|0?(r[s+236>>2]|0)==2:0)?(r[s+204>>2]&3|0)==0:0){g=r[s+192>>2]|0;jk[r[(r[g>>2]|0)+8>>2]&127](g,s+68|0,m+16|0,m);e=+h[m+16>>2]+-.019999999552965164;h[m+16>>2]=e;c=+h[m+16+4>>2]+-.019999999552965164;h[m+16+4>>2]=c;u=+h[m+16+8>>2]+-.019999999552965164;h[m+16+8>>2]=u;d=+h[m>>2]+.019999999552965164;h[m>>2]=d;p=+h[m+4>>2]+.019999999552965164;h[m+4>>2]=p;f=+h[m+8>>2]+.019999999552965164;h[m+8>>2]=f;if(e<+h[m+64>>2])h[m+64>>2]=e;if(c<+h[m+64+4>>2])h[m+64+4>>2]=c;if(u<+h[m+64+8>>2])h[m+64+8>>2]=u;e=+h[m+16+12>>2];if(e<+h[m+64+12>>2])h[m+64+12>>2]=e;if(+h[m+48>>2]<d)h[m+48>>2]=d;if(+h[m+48+4>>2]<p)h[m+48+4>>2]=p;if(+h[m+48+8>>2]<f)h[m+48+8>>2]=f;e=+h[m+12>>2];if(!(+h[m+48+12>>2]<e))break;h[m+48+12>>2]=e}}while(0);g=r[t+72>>2]|0;jk[r[(r[g>>2]|0)+60>>2]&127](g,m+64|0,m+48|0,m+32|0)}}o=o+1|0}while((o|0)<(r[t+8>>2]|0))}_=m;return}function ix(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0,a=0,l=0,c=0,u=0,p=0,f=0,m=0,g=0,b=0,y=0,v=0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,W=0.0,G=0.0,j=0;v=_;_=_+368|0;if(ck[r[(r[t>>2]|0)+20>>2]&127](t)|0?(b=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0,(ck[r[(r[b>>2]|0)+56>>2]&127](b)|0)&32768|0):0){b=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Wk[r[(r[b>>2]|0)+64>>2]&7](b,e,1.0)}s=r[i+4>>2]|0;switch(s|0){case 31:{s=r[i+20>>2]|0;if((s|0)<=0){_=v;return}do{y=s;s=s+-1|0;b=r[i+28>>2]|0;O=+h[b+(s*80|0)>>2];L=+h[b+(s*80|0)+4>>2];R=+h[b+(s*80|0)+8>>2];k=+h[b+(s*80|0)+16>>2];P=+h[b+(s*80|0)+20>>2];E=+h[b+(s*80|0)+24>>2];D=+h[b+(s*80|0)+32>>2];I=+h[b+(s*80|0)+36>>2];T=+h[b+(s*80|0)+40>>2];G=+h[b+(s*80|0)+48>>2];W=+h[b+(s*80|0)+52>>2];S=+h[b+(s*80|0)+56>>2];b=r[b+(s*80|0)+64>>2]|0;g=r[(r[t>>2]|0)+28>>2]|0;z=+h[e>>2];V=+h[e+4>>2];U=+h[e+8>>2];N=+h[e+16>>2];B=+h[e+20>>2];F=+h[e+24>>2];M=+h[e+32>>2];A=+h[e+36>>2];C=+h[e+40>>2];w=G*z+W*V+S*U+ +h[e+48>>2];x=G*N+W*B+S*F+ +h[e+52>>2];S=G*M+W*A+S*C+ +h[e+56>>2];h[v+304>>2]=O*z+k*V+D*U;h[v+304+4>>2]=L*z+P*V+I*U;h[v+304+8>>2]=R*z+E*V+T*U;h[v+304+12>>2]=0.0;h[v+304+16>>2]=O*N+k*B+D*F;h[v+304+20>>2]=L*N+P*B+I*F;h[v+304+24>>2]=R*N+E*B+T*F;h[v+304+28>>2]=0.0;h[v+304+32>>2]=O*M+k*A+D*C;h[v+304+36>>2]=L*M+P*A+I*C;h[v+304+40>>2]=R*M+E*A+T*C;h[v+304+44>>2]=0.0;h[v+304+48>>2]=w;h[v+304+52>>2]=x;h[v+304+56>>2]=S;h[v+304+60>>2]=0.0;jk[g&127](t,v+304|0,b,n)}while((y|0)>1);_=v;return}case 0:{r[v+288>>2]=r[i+32>>2];r[v+288+4>>2]=r[i+32+4>>2];r[v+288+8>>2]=r[i+32+8>>2];r[v+288+12>>2]=r[i+32+12>>2];z=+xk[r[(r[i>>2]|0)+48>>2]&15](i);W=+xk[r[(r[i>>2]|0)+48>>2]&15](i);G=+xk[r[(r[i>>2]|0)+48>>2]&15](i);z=z+ +h[v+288>>2];h[v+288>>2]=z;W=W+ +h[v+288+4>>2];h[v+288+4>>2]=W;G=G+ +h[v+288+8>>2];h[v+288+8>>2]=G;t=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;i=r[(r[t>>2]|0)+80>>2]|0;h[v+272>>2]=-z;h[v+272+4>>2]=-W;h[v+272+8>>2]=-G;h[v+272+12>>2]=0.0;sk[i&31](t,v+272|0,v+288|0,e,n);_=v;return}case 8:{G=+xk[r[(r[i>>2]|0)+48>>2]&15](i);t=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;dk[r[(r[t>>2]|0)+24>>2]&0](t,G,e,n);_=v;return}case 9:{s=r[i+96>>2]|0;if((s|0)<=0){_=v;return}do{y=s;s=s+-1|0;b=r[i+104>>2]|0;R=+h[b+(s<<4)>>2];I=+h[b+(s<<4)+4>>2];W=+h[b+(s<<4)+8>>2];b=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;g=r[(r[b>>2]|0)+24>>2]|0;G=+h[(r[i+124>>2]|0)+(s<<2)>>2];L=+h[e>>2];D=+h[e+4>>2];P=+h[e+8>>2];O=+h[e+16>>2];F=+h[e+20>>2];k=+h[e+24>>2];N=+h[e+32>>2];U=+h[e+36>>2];B=+h[e+40>>2];V=R*L+I*D+W*P+ +h[e+48>>2];z=R*O+I*F+W*k+ +h[e+52>>2];W=R*N+I*U+W*B+ +h[e+56>>2];h[v+192>>2]=L+D*0.0+P*0.0;h[v+192+4>>2]=L*0.0+D+P*0.0;h[v+192+8>>2]=P+(L*0.0+D*0.0);h[v+192+12>>2]=0.0;h[v+192+16>>2]=O+F*0.0+k*0.0;h[v+192+20>>2]=O*0.0+F+k*0.0;h[v+192+24>>2]=k+(O*0.0+F*0.0);h[v+192+28>>2]=0.0;h[v+192+32>>2]=N+U*0.0+B*0.0;h[v+192+36>>2]=N*0.0+U+B*0.0;h[v+192+40>>2]=B+(N*0.0+U*0.0);h[v+192+44>>2]=0.0;h[v+192+48>>2]=V;h[v+192+52>>2]=z;h[v+192+56>>2]=W;h[v+192+60>>2]=0.0;dk[g&0](b,G,v+192|0,n)}while((y|0)>1);_=v;return}case 10:{y=r[i+56>>2]|0;W=+h[i+32+(((y+2|0)%3|0)<<2)>>2];G=+h[i+32+(y<<2)>>2];t=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;uk[r[(r[t>>2]|0)+84>>2]&0](t,W,G,y,e,n);_=v;return}case 11:{W=+h[i+60>>2];G=+h[i+64>>2];i=r[i+72>>2]|0;t=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;uk[r[(r[t>>2]|0)+92>>2]&0](t,W,G,i,e,n);_=v;return}case 13:{y=r[i+56>>2]|0;W=+xk[r[(r[i>>2]|0)+92>>2]&15](i);r[v+176>>2]=r[i+32>>2];r[v+176+4>>2]=r[i+32+4>>2];r[v+176+8>>2]=r[i+32+8>>2];r[v+176+12>>2]=r[i+32+12>>2];V=+xk[r[(r[i>>2]|0)+48>>2]&15](i);z=+xk[r[(r[i>>2]|0)+48>>2]&15](i);G=+xk[r[(r[i>>2]|0)+48>>2]&15](i);h[v+176>>2]=V+ +h[v+176>>2];h[v+176+4>>2]=z+ +h[v+176+4>>2];h[v+176+8>>2]=G+ +h[v+176+8>>2];G=+h[v+176+(y<<2)>>2];t=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;uk[r[(r[t>>2]|0)+88>>2]&0](t,W,G,y,e,n);_=v;return}case 28:{G=+h[i+68>>2];t=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;Tk[r[(r[t>>2]|0)+96>>2]&0](t,i+52|0,G,e,n);_=v;return}default:{t:do{if((s|0)<7){m=r[i+56>>2]|0;if(!m){if((ck[r[(r[i>>2]|0)+100>>2]&127](i)|0)<=0)break;s=0;while(1){jk[r[(r[i>>2]|0)+104>>2]&127](i,s,v+288|0,v+256|0);z=+h[v+288>>2];R=+h[e>>2];U=+h[v+288+4>>2];I=+h[e+4>>2];B=+h[v+288+8>>2];P=+h[e+8>>2];D=+h[e+16>>2];k=+h[e+20>>2];O=+h[e+24>>2];N=+h[e+32>>2];V=+h[e+36>>2];W=+h[e+40>>2];L=+h[e+48>>2];F=+h[e+52>>2];G=+h[e+56>>2];h[v+80>>2]=z*R+U*I+B*P+L;h[v+80+4>>2]=z*D+U*k+B*O+F;h[v+80+8>>2]=z*N+U*V+B*W+G;h[v+80+12>>2]=0.0;B=+h[v+256>>2];U=+h[v+256+4>>2];z=+h[v+256+8>>2];h[v+48>>2]=B*R+U*I+z*P+L;h[v+48+4>>2]=B*D+U*k+z*O+F;h[v+48+8>>2]=B*N+U*V+z*W+G;h[v+48+12>>2]=0.0;y=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;jk[r[(r[y>>2]|0)+16>>2]&127](y,v+80|0,v+48|0,n);s=s+1|0;if((s|0)>=(ck[r[(r[i>>2]|0)+100>>2]&127](i)|0))break t}}if((r[m+28>>2]|0)>0){b=0;do{s=r[m+36>>2]|0;g=r[s+(b*36|0)+4>>2]|0;e:do{if((g|0)!=0?(y=r[s+(b*36|0)+12>>2]|0,(g|0)>0):0){c=y;a=0;o=0;s=0;p=r[y+(g+-1<<2)>>2]|0;l=0;while(1){f=r[c+(l<<2)>>2]|0;u=r[m+16>>2]|0;a=(h[d>>2]=(r[d>>2]=a,+h[d>>2])+ +h[u+(f<<4)>>2],r[d>>2]|0);s=(h[d>>2]=(r[d>>2]=s,+h[d>>2])+ +h[u+(f<<4)+4>>2],r[d>>2]|0);o=(h[d>>2]=(r[d>>2]=o,+h[d>>2])+ +h[u+(f<<4)+8>>2],r[d>>2]|0);u=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;c=r[(r[u>>2]|0)+16>>2]|0;j=r[m+16>>2]|0;z=+h[j+(p<<4)>>2];R=+h[e>>2];U=+h[j+(p<<4)+4>>2];I=+h[e+4>>2];B=+h[j+(p<<4)+8>>2];P=+h[e+8>>2];D=+h[e+16>>2];k=+h[e+20>>2];O=+h[e+24>>2];N=+h[e+32>>2];V=+h[e+36>>2];W=+h[e+40>>2];L=+h[e+48>>2];F=+h[e+52>>2];G=+h[e+56>>2];h[v+64>>2]=z*R+U*I+B*P+L;h[v+64+4>>2]=z*D+U*k+B*O+F;h[v+64+8>>2]=z*N+U*V+B*W+G;h[v+64+12>>2]=0.0;B=+h[j+(f<<4)>>2];U=+h[j+(f<<4)+4>>2];z=+h[j+(f<<4)+8>>2];h[v+32>>2]=B*R+U*I+z*P+L;h[v+32+4>>2]=B*D+U*k+z*O+F;h[v+32+8>>2]=B*N+U*V+z*W+G;h[v+32+12>>2]=0.0;jk[c&127](u,v+64|0,v+32|0,n);u=l+1|0;l=r[m+36>>2]|0;if((u|0)>=(r[l+(b*36|0)+4>>2]|0))break e;c=r[l+(b*36|0)+12>>2]|0;p=f;l=u}}else{a=0;o=0;s=0}}while(0);j=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;if((ck[r[(r[j>>2]|0)+56>>2]&127](j)|0)&16384|0){V=1.0/+(g|0)*(r[d>>2]=o,+h[d>>2]);B=1.0/+(g|0)*(r[d>>2]=s,+h[d>>2]);k=1.0/+(g|0)*(r[d>>2]=a,+h[d>>2]);r[v+288>>2]=1065353216;r[v+288+4>>2]=1065353216;r[v+288+8>>2]=0;h[v+288+12>>2]=0.0;j=r[m+36>>2]|0;O=+h[j+(b*36|0)+20>>2];N=+h[j+(b*36|0)+24>>2];z=+h[j+(b*36|0)+28>>2];j=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;g=r[(r[j>>2]|0)+16>>2]|0;A=+h[e>>2];E=+h[e+4>>2];M=+h[e+8>>2];I=+h[e+16>>2];P=+h[e+20>>2];L=+h[e+24>>2];F=+h[e+32>>2];U=+h[e+36>>2];W=+h[e+40>>2];R=+h[e+48>>2];D=+h[e+52>>2];G=+h[e+56>>2];h[v+16>>2]=k*A+B*E+V*M+R;h[v+16+4>>2]=k*I+B*P+V*L+D;h[v+16+8>>2]=k*F+B*U+V*W+G;h[v+16+12>>2]=0.0;h[v>>2]=(k+O)*A+(B+N)*E+(V+z)*M+R;h[v+4>>2]=(k+O)*I+(B+N)*P+(V+z)*L+D;h[v+8>>2]=(k+O)*F+(B+N)*U+(V+z)*W+G;h[v+12>>2]=0.0;jk[g&127](j,v+16|0,v,v+288|0)}b=b+1|0}while((b|0)<(r[m+28>>2]|0))}}}while(0);s=r[i+4>>2]|0;if((s+-21|0)>>>0<9){r[v+288>>2]=1566444395;r[v+288+4>>2]=1566444395;r[v+288+8>>2]=1566444395;h[v+288+12>>2]=0.0;r[v+256>>2]=-581039253;r[v+256+4>>2]=-581039253;r[v+256+8>>2]=-581039253;h[v+256+12>>2]=0.0;s=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;r[v+80>>2]=3252;r[v+80+4>>2]=3276;r[v+80+8>>2]=s;r[v+80+12>>2]=r[n>>2];r[v+80+12+4>>2]=r[n+4>>2];r[v+80+12+8>>2]=r[n+8>>2];r[v+80+12+12>>2]=r[n+12>>2];r[v+80+28>>2]=r[e>>2];r[v+80+28+4>>2]=r[e+4>>2];r[v+80+28+8>>2]=r[e+8>>2];r[v+80+28+12>>2]=r[e+12>>2];r[v+80+44>>2]=r[e+16>>2];r[v+80+44+4>>2]=r[e+16+4>>2];r[v+80+44+8>>2]=r[e+16+8>>2];r[v+80+44+12>>2]=r[e+16+12>>2];r[v+80+60>>2]=r[e+32>>2];r[v+80+60+4>>2]=r[e+32+4>>2];r[v+80+60+8>>2]=r[e+32+8>>2];r[v+80+60+12>>2]=r[e+32+12>>2];r[v+80+76>>2]=r[e+48>>2];r[v+80+76+4>>2]=r[e+48+4>>2];r[v+80+76+8>>2]=r[e+48+8>>2];r[v+80+76+12>>2]=r[e+48+12>>2];jk[r[(r[i>>2]|0)+64>>2]&127](i,v+80|0,v+256|0,v+288|0);s=r[i+4>>2]|0}if((s|0)!=3){_=v;return}r[v+288>>2]=1566444395;r[v+288+4>>2]=1566444395;r[v+288+8>>2]=1566444395;h[v+288+12>>2]=0.0;r[v+256>>2]=-581039253;r[v+256+4>>2]=-581039253;r[v+256+8>>2]=-581039253;h[v+256+12>>2]=0.0;j=ck[r[(r[t>>2]|0)+20>>2]&127](t)|0;r[v+80>>2]=3252;r[v+80+4>>2]=3276;r[v+80+8>>2]=j;r[v+80+12>>2]=r[n>>2];r[v+80+12+4>>2]=r[n+4>>2];r[v+80+12+8>>2]=r[n+8>>2];r[v+80+12+12>>2]=r[n+12>>2];r[v+80+28>>2]=r[e>>2];r[v+80+28+4>>2]=r[e+4>>2];r[v+80+28+8>>2]=r[e+8>>2];r[v+80+28+12>>2]=r[e+12>>2];r[v+80+44>>2]=r[e+16>>2];r[v+80+44+4>>2]=r[e+16+4>>2];r[v+80+44+8>>2]=r[e+16+8>>2];r[v+80+44+12>>2]=r[e+16+12>>2];r[v+80+60>>2]=r[e+32>>2];r[v+80+60+4>>2]=r[e+32+4>>2];r[v+80+60+8>>2]=r[e+32+8>>2];r[v+80+60+12>>2]=r[e+32+12>>2];r[v+80+76>>2]=r[e+48>>2];r[v+80+76+4>>2]=r[e+48+4>>2];r[v+80+76+8>>2]=r[e+48+8>>2];r[v+80+76+12>>2]=r[e+48+12>>2];j=r[i+96>>2]|0;jk[r[(r[j>>2]|0)+8>>2]&127](j,v+80+4|0,v+256|0,v+288|0);_=v;return}}}function nx(t){t=t|0;return}function sx(t){t=t|0;Ql(t);return}function rx(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0,L=0.0,D=0.0,k=0.0;i=_;_=_+96|0;c=+h[e>>2];b=+h[t+28>>2];E=+h[e+4>>2];R=+h[t+32>>2];u=+h[e+8>>2];d=+h[t+36>>2];p=+h[t+44>>2];f=+h[t+48>>2];m=+h[t+52>>2];g=+h[t+60>>2];y=+h[t+64>>2];v=+h[t+68>>2];S=+h[t+76>>2];x=+h[t+80>>2];w=+h[t+84>>2];h[i+80>>2]=c*b+E*R+u*d+S;h[i+80+4>>2]=c*p+E*f+u*m+x;h[i+80+8>>2]=c*g+E*y+u*v+w;h[i+80+12>>2]=0.0;C=+h[e+16>>2];T=+h[e+20>>2];A=+h[e+24>>2];h[i+64>>2]=C*b+T*R+A*d+S;h[i+64+4>>2]=C*p+T*f+A*m+x;h[i+64+8>>2]=C*g+T*y+A*v+w;h[i+64+12>>2]=0.0;M=+h[e+32>>2];I=+h[e+36>>2];l=+h[e+40>>2];h[i+48>>2]=M*b+I*R+l*d+S;h[i+48+4>>2]=M*p+I*f+l*m+x;h[i+48+8>>2]=M*g+I*y+l*v+w;h[i+48+12>>2]=0.0;s=(c*b+E*R+u*d+S+(C*b+T*R+A*d+S)+(M*b+I*R+l*d+S))*.3333333432674408;o=(c*p+E*f+u*m+x+(C*p+T*f+A*m+x)+(M*p+I*f+l*m+x))*.3333333432674408;a=(c*g+E*y+u*v+w+(C*g+T*y+A*v+w)+(M*g+I*y+l*v+w))*.3333333432674408;h[i+32>>2]=s;h[i+32+4>>2]=o;h[i+32+8>>2]=a;h[i+32+12>>2]=0.0;e=r[t+8>>2]|0;if(!((ck[r[(r[e>>2]|0)+56>>2]&127](e)|0)&16384)){n=r[t+8>>2]|0;P=r[n>>2]|0;P=P+16|0;P=r[P>>2]|0;e=t+12|0;jk[P&127](n,i+80|0,i+64|0,e);n=r[t+8>>2]|0;P=r[n>>2]|0;P=P+16|0;P=r[P>>2]|0;jk[P&127](n,i+64|0,i+48|0,e);t=r[t+8>>2]|0;n=r[t>>2]|0;n=n+16|0;n=r[n>>2]|0;jk[n&127](t,i+48|0,i+80|0,e);_=i;return}k=+h[i+80>>2];D=C*p+T*f+A*m+x-(c*p+E*f+u*m+x);L=C*g+T*y+A*v+w-(c*g+E*y+u*v+w);x=M*p+I*f+l*m+x-(c*p+E*f+u*m+x);w=M*g+I*y+l*v+w-(c*g+E*y+u*v+w);E=L*(M*b+I*R+l*d+S-k)-(C*b+T*R+A*d+S-k)*w;I=(C*b+T*R+A*d+S-k)*x-D*(M*b+I*R+l*d+S-k);R=1.0/+G(+(I*I+((D*w-L*x)*(D*w-L*x)+E*E)));r[i+16>>2]=1065353216;r[i+16+4>>2]=1065353216;r[i+16+8>>2]=0;h[i+16+12>>2]=0.0;e=r[t+8>>2]|0;n=r[(r[e>>2]|0)+16>>2]|0;h[i>>2]=R*(D*w-L*x)+s;h[i+4>>2]=R*E+o;h[i+8>>2]=R*I+a;h[i+12>>2]=0.0;jk[n&127](e,i+32|0,i,i+16|0);e=r[t+8>>2]|0;n=r[e>>2]|0;n=n+16|0;n=r[n>>2]|0;P=t+12|0;jk[n&127](e,i+80|0,i+64|0,P);e=r[t+8>>2]|0;n=r[e>>2]|0;n=n+16|0;n=r[n>>2]|0;jk[n&127](e,i+64|0,i+48|0,P);t=r[t+8>>2]|0;e=r[t>>2]|0;e=e+16|0;e=r[e>>2]|0;jk[e&127](t,i+48|0,i+80|0,P);_=i;return}function ox(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;jk[r[(r[t>>2]|0)+8>>2]&127](t,e,i,n);return}function ax(t){t=t|0;return}function lx(t){t=t|0;Ql(t+-4|0);return}function hx(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;jk[r[(r[t+-4>>2]|0)+8>>2]&127](t+-4|0,e,i,n);return}function cx(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0.0,a=0.0,l=0.0,c=0,u=0,d=0.0,p=0.0,f=0.0,m=0.0;s=_;_=_+256|0;r[s+32>>2]=3296;c=s+32+36|0;r[c>>2]=r[e>>2];r[c+4>>2]=r[e+4>>2];r[c+8>>2]=r[e+8>>2];r[c+12>>2]=r[e+12>>2];u=s+32+52|0;r[u>>2]=r[i>>2];r[u+4>>2]=r[i+4>>2];r[u+8>>2]=r[i+8>>2];r[u+12>>2]=r[i+12>>2];r[s+32+212>>2]=t;r[s+32+216>>2]=n;r[s+32+68>>2]=1065353216;r[s+32+72>>2]=0;r[s+32+72+4>>2]=0;r[s+32+72+8>>2]=0;r[s+32+72+12>>2]=0;r[s+32+88>>2]=1065353216;r[s+32+92>>2]=0;r[s+32+92+4>>2]=0;r[s+32+92+8>>2]=0;r[s+32+92+12>>2]=0;r[s+32+108>>2]=1065353216;r[s+32+112>>2]=0;r[s+32+116>>2]=r[c>>2];r[s+32+116+4>>2]=r[c+4>>2];r[s+32+116+8>>2]=r[c+8>>2];r[s+32+116+12>>2]=r[c+12>>2];r[s+32+132>>2]=1065353216;r[s+32+136>>2]=0;r[s+32+136+4>>2]=0;r[s+32+136+8>>2]=0;r[s+32+136+12>>2]=0;r[s+32+152>>2]=1065353216;r[s+32+156>>2]=0;r[s+32+156+4>>2]=0;r[s+32+156+8>>2]=0;r[s+32+156+12>>2]=0;r[s+32+172>>2]=1065353216;r[s+32+176>>2]=0;r[s+32+180>>2]=r[i>>2];r[s+32+180+4>>2]=r[i+4>>2];r[s+32+180+8>>2]=r[i+8>>2];r[s+32+180+12>>2]=r[i+12>>2];d=+h[i>>2]-+h[e>>2];l=+h[i+4>>2]-+h[e+4>>2];a=+h[i+8>>2]-+h[e+8>>2];o=1.0/+G(+(d*d+l*l+a*a));m=d*o==0.0?999999984306749440.0:1.0/(d*o);h[s+32+4>>2]=m;f=l*o==0.0?999999984306749440.0:1.0/(l*o);h[s+32+8>>2]=f;p=a*o==0.0?999999984306749440.0:1.0/(a*o);h[s+32+12>>2]=p;r[s+32+20>>2]=m<0.0&1;r[s+32+24>>2]=f<0.0&1;r[s+32+28>>2]=p<0.0&1;h[s+32+32>>2]=d*o*(+h[u>>2]-+h[c>>2])+l*o*(+h[s+32+56>>2]-+h[s+32+40>>2])+a*o*(+h[s+32+60>>2]-+h[s+32+44>>2]);t=r[t+68>>2]|0;n=r[(r[t>>2]|0)+24>>2]|0;r[s+16>>2]=0;r[s+16+4>>2]=0;r[s+16+8>>2]=0;r[s+16+12>>2]=0;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;vk[n&7](t,e,i,s+32|0,s+16|0,s);_=s;return}function _x(t){t=t|0;return}function ux(t){t=t|0;Ql(t);return}function dx(t,e){t=t|0;e=e|0;var i=0,n=0,s=0;n=_;_=_+32|0;i=r[t+216>>2]|0;if(+h[i+4>>2]==0.0){t=0;_=n;return t|0}e=r[e>>2]|0;if(!(Rk[r[(r[i>>2]|0)+8>>2]&31](i,r[e+188>>2]|0)|0)){t=1;_=n;return t|0}s=r[e+192>>2]|0;i=r[t+216>>2]|0;r[n>>2]=0;r[n+4>>2]=s;r[n+8>>2]=e;r[n+12>>2]=e+4;r[n+16>>2]=-1;r[n+20>>2]=-1;px(t+68|0,t+132|0,n,i);t=1;_=n;return t|0}function px(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0,g=0,b=0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0;b=_;_=_+752|0;r[b+136+8>>2]=0;r[b+136+12>>2]=-1;r[b+136+16>>2]=1065353216;r[b+136+20>>2]=1065353216;r[b+136+24>>2]=1065353216;h[b+136+28>>2]=0.0;r[b+136>>2]=6380;r[b+136+4>>2]=8;h[b+136+32>>2]=0.0;h[b+136+48>>2]=0.0;m=r[i+4>>2]|0;g=r[i+12>>2]|0;o=r[m+4>>2]|0;if((o|0)<20){r[b+568>>2]=3316;r[b+568+168>>2]=0;h[b+568+172>>2]=0.0;r[b+568+164>>2]=r[s+4>>2];h[b+208+308>>2]=9.999999747378752e-05;n[b+208+332>>0]=0;r[b+192>>2]=7024;r[b+192+4>>2]=b+208;r[b+192+8>>2]=b+136;r[b+192+12>>2]=m;r[b+120>>2]=6864;r[b+120+4>>2]=b+208;r[b+120+8>>2]=b+136;r[b+120+12>>2]=m;m=(r[s+16>>2]&8|0)==0?b+192|0:b+120|0;if((wk[r[(r[m>>2]|0)+8>>2]&3](m,t,e,g,g,b+568|0)|0?(a=b+568+132|0,l=+h[a>>2],c=+h[b+568+136>>2],u=+h[b+568+140>>2],l*l+c*c+u*u>9.999999747378752e-05):0)?(d=+h[b+568+164>>2],d<+h[s+4>>2]):0){f=1.0/+G(+(l*l+c*c+u*u));h[a>>2]=l*f;h[b+568+136>>2]=c*f;h[b+568+140>>2]=u*f;r[b>>2]=r[i+8>>2];r[b+4>>2]=0;r[b+8>>2]=r[a>>2];r[b+8+4>>2]=r[a+4>>2];r[b+8+8>>2]=r[a+8>>2];r[b+8+12>>2]=r[a+12>>2];h[b+24>>2]=d;+Ik[r[(r[s>>2]|0)+12>>2]&15](s,b,1)}_=b;return}if((o+-21|0)>>>0>=9){if((o|0)!=31){_=b;return}o=r[m+68>>2]|0;i=r[i+8>>2]|0;r[b+568>>2]=3392;r[b+568+4>>2]=i;r[b+568+8>>2]=m;r[b+568+12>>2]=g;r[b+568+16>>2]=t;r[b+568+20>>2]=e;r[b+568+24>>2]=s;if(!o){o=r[m+20>>2]|0;if((o|0)>0){a=0;do{Ax(b+568|0,a);a=a+1|0}while((a|0)<(o|0))}}else{l=+h[g+48>>2];E=+h[t+48>>2]-l;u=+h[g+52>>2];A=+h[t+52>>2]-u;p=+h[g+56>>2];T=+h[t+56>>2]-p;C=+h[g>>2];w=+h[g+16>>2];x=+h[g+32>>2];S=+h[g+4>>2];v=+h[g+20>>2];y=+h[g+36>>2];c=+h[g+8>>2];d=+h[g+24>>2];f=+h[g+40>>2];h[b+208>>2]=E*C+A*w+T*x;h[b+208+4>>2]=E*S+A*v+T*y;h[b+208+8>>2]=E*c+A*d+T*f;h[b+208+12>>2]=0.0;l=+h[e+48>>2]-l;u=+h[e+52>>2]-u;p=+h[e+56>>2]-p;Px(r[o>>2]|0,b+208|0,l*C+u*w+p*x,l*S+u*v+p*y,l*c+u*d+p*f,b+568|0)}_=b;return}I=+h[g>>2];R=+h[g+16>>2];d=+h[g+32>>2];M=+h[g+4>>2];y=+h[g+20>>2];p=+h[g+36>>2];w=+h[g+8>>2];T=+h[g+24>>2];E=+h[g+40>>2];v=-+h[g+48>>2];S=-+h[g+52>>2];x=-+h[g+56>>2];A=+h[t+48>>2];C=+h[t+52>>2];u=+h[t+56>>2];l=I*v+R*S+d*x+(I*A+R*C+d*u);c=M*v+y*S+p*x+(M*A+y*C+p*u);u=w*v+T*S+E*x+(w*A+T*C+E*u);h[b+120>>2]=l;h[b+120+4>>2]=c;h[b+120+8>>2]=u;h[b+120+12>>2]=0.0;C=+h[e+48>>2];A=+h[e+52>>2];f=+h[e+56>>2];d=I*v+R*S+d*x+(I*C+R*A+d*f);p=M*v+y*S+p*x+(M*C+y*A+p*f);f=w*v+T*S+E*x+(w*C+T*A+E*f);if((r[m+4>>2]|0)==21){o=r[i+8>>2]|0;i=r[s+16>>2]|0;r[b+4>>2]=r[b+120>>2];r[b+4+4>>2]=r[b+120+4>>2];r[b+4+8>>2]=r[b+120+8>>2];r[b+4+12>>2]=r[b+120+12>>2];h[b+20>>2]=d;h[b+24>>2]=p;h[b+28>>2]=f;h[b+32>>2]=0.0;r[b+36>>2]=i;h[b+40>>2]=1.0;r[b>>2]=3344;r[b+44>>2]=s;r[b+48>>2]=o;r[b+52>>2]=m;r[b+56>>2]=r[g>>2];r[b+56+4>>2]=r[g+4>>2];r[b+56+8>>2]=r[g+8>>2];r[b+56+12>>2]=r[g+12>>2];r[b+72>>2]=r[g+16>>2];r[b+72+4>>2]=r[g+16+4>>2];r[b+72+8>>2]=r[g+16+8>>2];r[b+72+12>>2]=r[g+16+12>>2];r[b+88>>2]=r[g+32>>2];r[b+88+4>>2]=r[g+32+4>>2];r[b+88+8>>2]=r[g+32+8>>2];r[b+88+12>>2]=r[g+32+12>>2];r[b+104>>2]=r[g+48>>2];r[b+104+4>>2]=r[g+48+4>>2];r[b+104+8>>2]=r[g+48+8>>2];r[b+104+12>>2]=r[g+48+12>>2];r[b+40>>2]=r[s+4>>2];o=r[m+52>>2]|0;r[b+192>>2]=4836;r[b+192+4>>2]=o;r[b+192+8>>2]=b;o=r[m+56>>2]|0;r[b+568>>2]=0;r[b+568+4>>2]=0;r[b+568+8>>2]=0;r[b+568+12>>2]=0;r[b+208>>2]=0;r[b+208+4>>2]=0;r[b+208+8>>2]=0;r[b+208+12>>2]=0;if(!(n[o+60>>0]|0))JL(o,b+192|0,b+120|0,d,p,f,b+568|0,b+208|0);else tD(o,b+192|0,b+120|0,d,p,f,b+568|0,b+208|0,r[o+56>>2]|0)}else{i=r[i+8>>2]|0;e=r[s+16>>2]|0;h[b+568+4>>2]=l;h[b+568+8>>2]=c;h[b+568+12>>2]=u;h[b+568+16>>2]=0.0;h[b+568+20>>2]=d;h[b+568+24>>2]=p;h[b+568+28>>2]=f;h[b+568+32>>2]=0.0;r[b+568+36>>2]=e;h[b+568+40>>2]=1.0;r[b+568>>2]=3368;r[b+568+44>>2]=s;r[b+568+48>>2]=i;r[b+568+52>>2]=m;r[b+568+56>>2]=r[g>>2];r[b+568+56+4>>2]=r[g+4>>2];r[b+568+56+8>>2]=r[g+8>>2];r[b+568+56+12>>2]=r[g+12>>2];r[b+568+72>>2]=r[g+16>>2];r[b+568+72+4>>2]=r[g+16+4>>2];r[b+568+72+8>>2]=r[g+16+8>>2];r[b+568+72+12>>2]=r[g+16+12>>2];r[b+568+88>>2]=r[g+32>>2];r[b+568+88+4>>2]=r[g+32+4>>2];r[b+568+88+8>>2]=r[g+32+8>>2];r[b+568+88+12>>2]=r[g+32+12>>2];r[b+568+104>>2]=r[g+48>>2];r[b+568+104+4>>2]=r[g+48+4>>2];r[b+568+104+8>>2]=r[g+48+8>>2];r[b+568+104+12>>2]=r[g+48+12>>2];r[b+568+40>>2]=r[s+4>>2];h[b+208>>2]=l;h[b+208+4>>2]=c;h[b+208+8>>2]=u;h[b+208+12>>2]=0.0;if(d<l)h[b+208>>2]=d;if(p<c)h[b+208+4>>2]=p;if(f<u)h[b+208+8>>2]=f;h[b+192>>2]=l;h[b+192+4>>2]=c;h[b+192+8>>2]=u;h[b+192+12>>2]=0.0;if(l<d)h[b+192>>2]=d;if(c<p)h[b+192+4>>2]=p;if(u<f)h[b+192+8>>2]=f;jk[r[(r[m>>2]|0)+64>>2]&127](m,b+568|0,b+208|0,b+192|0)}_=b;return}function fx(t,e){t=t|0;e=+e;return}function mx(t,e){t=t|0;e=e|0;return}function gx(t,e,i){t=t|0;e=e|0;i=i|0;return}function bx(t){t=t|0;return}function yx(t){t=t|0;Ql(t);return}function vx(t){t=t|0;Ql(t);return}function Sx(t,e,i,n,s){t=t|0;e=e|0;i=+i;n=n|0;s=s|0;var o=0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0;o=_;_=_+48|0;r[o+32>>2]=n;r[o+32+4>>2]=s;d=+h[e>>2];u=+h[e+4>>2];a=+h[e+8>>2];c=+h[t+56>>2]*d+ +h[t+60>>2]*u+ +h[t+64>>2]*a;l=d*+h[t+72>>2]+u*+h[t+76>>2]+a*+h[t+80>>2];a=d*+h[t+88>>2]+u*+h[t+92>>2]+a*+h[t+96>>2];r[o>>2]=r[t+48>>2];r[o+4>>2]=o+32;h[o+8>>2]=c;h[o+12>>2]=l;h[o+16>>2]=a;h[o+20>>2]=0.0;h[o+24>>2]=i;s=r[t+44>>2]|0;i=+Ik[r[(r[s>>2]|0)+12>>2]&15](s,o,1);_=o;return+i}function xx(t){t=t|0;Ql(t);return}function wx(t,e,i,n,s){t=t|0;e=e|0;i=+i;n=n|0;s=s|0;var o=0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0;o=_;_=_+48|0;r[o+32>>2]=n;r[o+32+4>>2]=s;d=+h[e>>2];u=+h[e+4>>2];a=+h[e+8>>2];c=+h[t+56>>2]*d+ +h[t+60>>2]*u+ +h[t+64>>2]*a;l=d*+h[t+72>>2]+u*+h[t+76>>2]+a*+h[t+80>>2];a=d*+h[t+88>>2]+u*+h[t+92>>2]+a*+h[t+96>>2];r[o>>2]=r[t+48>>2];r[o+4>>2]=o+32;h[o+8>>2]=c;h[o+12>>2]=l;h[o+16>>2]=a;h[o+20>>2]=0.0;h[o+24>>2]=i;s=r[t+44>>2]|0;i=+Ik[r[(r[s>>2]|0)+12>>2]&15](s,o,1);_=o;return+i}function Cx(t){t=t|0;Ql(t);return}function Tx(t,e){t=t|0;e=e|0;Ax(t,r[e+36>>2]|0);return}function Ax(t,e){t=t|0;e=e|0;var i=0,n=0,o=0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0;i=_;_=_+128|0;L=r[(r[t+8>>2]|0)+28>>2]|0;o=r[L+(e*80|0)+64>>2]|0;n=r[t+12>>2]|0;w=+h[L+(e*80|0)>>2];R=+h[n>>2];x=+h[L+(e*80|0)+16>>2];M=+h[n+4>>2];S=+h[L+(e*80|0)+32>>2];E=+h[n+8>>2];v=+h[L+(e*80|0)+4>>2];y=+h[L+(e*80|0)+20>>2];b=+h[L+(e*80|0)+36>>2];g=+h[L+(e*80|0)+8>>2];f=+h[L+(e*80|0)+24>>2];d=+h[L+(e*80|0)+40>>2];A=+h[n+16>>2];T=+h[n+20>>2];C=+h[n+24>>2];m=+h[n+32>>2];p=+h[n+36>>2];u=+h[n+40>>2];P=+h[L+(e*80|0)+48>>2];I=+h[L+(e*80|0)+52>>2];a=+h[L+(e*80|0)+56>>2];c=+h[n+48>>2]+(R*P+M*I+E*a);l=A*P+T*I+C*a+ +h[n+52>>2];a=m*P+p*I+u*a+ +h[n+56>>2];h[i+56>>2]=w*R+x*M+S*E;h[i+56+4>>2]=R*v+M*y+E*b;h[i+56+8>>2]=R*g+M*f+E*d;h[i+56+12>>2]=0.0;h[i+56+16>>2]=w*A+x*T+S*C;h[i+56+20>>2]=v*A+y*T+b*C;h[i+56+24>>2]=g*A+f*T+d*C;h[i+56+28>>2]=0.0;h[i+56+32>>2]=w*m+x*p+S*u;h[i+56+36>>2]=v*m+y*p+b*u;h[i+56+40>>2]=g*m+f*p+d*u;h[i+56+44>>2]=0.0;h[i+56+48>>2]=c;h[i+56+52>>2]=l;h[i+56+56>>2]=a;h[i+56+60>>2]=0.0;n=r[t+4>>2]|0;r[i+32>>2]=0;r[i+32+4>>2]=o;r[i+32+8>>2]=n;r[i+32+12>>2]=i+56;r[i+32+16>>2]=-1;r[i+32+20>>2]=e;n=r[t+24>>2]|0;h[i+4>>2]=1.0;r[i+8>>2]=0;s[i+12>>1]=1;s[i+14>>1]=-1;r[i+16>>2]=0;r[i>>2]=3428;r[i+20>>2]=n;r[i+24>>2]=e;r[i+4>>2]=r[n+4>>2];r[i+16>>2]=r[n+16>>2];px(r[t+16>>2]|0,r[t+20>>2]|0,i+32|0,i);_=i;return}function Ex(t){t=t|0;return}function Mx(t){t=t|0;Ql(t);return}function Rx(t,e){t=t|0;e=e|0;t=r[t+20>>2]|0;return Rk[r[(r[t>>2]|0)+8>>2]&31](t,e)|0}function Ix(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0.0,o=0;n=_;_=_+16|0;r[n>>2]=-1;r[n+4>>2]=r[t+24>>2];if(!(r[e+4>>2]|0))r[e+4>>2]=n;o=r[t+20>>2]|0;s=+Ik[r[(r[o>>2]|0)+12>>2]&15](o,e,i);r[t+4>>2]=r[(r[t+20>>2]|0)+4>>2];_=n;return+s}function Px(t,e,i,n,s,o){t=t|0;e=e|0;i=+i;n=+n;s=+s;o=o|0;var a=0,l=0,c=0.0,u=0,d=0,p=0,f=0,m=0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0,R=0;R=_;_=_+32|0;if(!t){_=R;return}w=i-+h[e>>2];x=n-+h[e+4>>2];S=s-+h[e+8>>2];g=1.0/+G(+(w*w+x*x+S*S));b=w*g==0.0?999999984306749440.0:1.0/(w*g);y=x*g==0.0?999999984306749440.0:1.0/(x*g);v=S*g==0.0?999999984306749440.0:1.0/(S*g);r[5637]=(r[5637]|0)+1;a=Zl(531)|0;if(!a)a=0;else{r[(a+4+15&-16)+-4>>2]=a;a=a+4+15&-16}Ph(a|0,0,512)|0;r[a>>2]=t;m=1;t=128;u=128;l=126;while(1){d=m+-1|0;f=r[a+(d<<2)>>2]|0;r[R>>2]=r[f>>2];r[R+4>>2]=r[f+4>>2];r[R+8>>2]=r[f+8>>2];r[R+12>>2]=r[f+12>>2];r[R+16>>2]=r[f+16>>2];r[R+16+4>>2]=r[f+16+4>>2];r[R+16+8>>2]=r[f+16+8>>2];r[R+16+12>>2]=r[f+16+12>>2];n=+h[e>>2];i=b*(+h[R+((b<0.0&1)<<4)>>2]-n);n=b*(+h[R+((b<0.0^1)<<4)>>2]-n);c=+h[e+4>>2];s=y*(+h[R+((y<0.0&1)<<4)+4>>2]-c);c=y*(+h[R+((y<0.0^1)<<4)+4>>2]-c);do{if((!(s>n|i>c)?(C=s>i?s:i,E=c<n?c:n,A=+h[e+8>>2],T=v*(+h[R+((v<0.0&1)<<4)+8>>2]-A),A=v*(+h[R+((v<0.0^1)<<4)+8>>2]-A),!(T>E|C>A)):0)?(A<E?A:E)>0.0?(T>C?T:C)<w*g*w+x*g*x+S*g*S:0:0){if(!(r[f+40>>2]|0)){lk[r[(r[o>>2]|0)+12>>2]&127](o,f);break}if((d|0)>(l|0)){p=u<<1;if((u|0)<(p|0)){do{if((t|0)<(p|0)){if(u){r[5637]=(r[5637]|0)+1;t=Zl((u<<3|3)+16|0)|0;if(!t)t=0;else{r[(t+4+15&-16)+-4>>2]=t;t=t+4+15&-16}if((u|0)>0){l=0;do{r[t+(l<<2)>>2]=r[a+(l<<2)>>2];l=l+1|0}while((l|0)!=(u|0))}else M=17}else{t=0;M=17}if((M|0)==17){M=0;if(!a){l=p;a=t;break}}r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0);l=p;a=t}else l=t}while(0);Ph(a+(u<<2)|0,0,u<<2|0)|0;t=l}u=p;l=p+-2|0}r[a+(d<<2)>>2]=r[f+36>>2];r[a+(m<<2)>>2]=r[f+40>>2];d=m+1|0}}while(0);if(!d)break;else m=d}if(!a){_=R;return}r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0);_=R;return}function Lx(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0,l=0,h=0,c=0;c=_;_=_+96|0;o=r[t+8>>2]|0;if((o|0)==(r[t+12>>2]|0)?(h=o|0?o<<1:1,(o|0)<(h|0)):0){if(!h)l=0;else{r[5637]=(r[5637]|0)+1;o=Zl((h<<2|3)+16|0)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}l=o;o=r[t+8>>2]|0}if((o|0)>0){a=0;do{r[l+(a<<2)>>2]=r[(r[t+16>>2]|0)+(a<<2)>>2];a=a+1|0}while((a|0)!=(o|0))}a=r[t+16>>2]|0;if(a){if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0);o=r[t+8>>2]|0}r[t+16>>2]=0}n[t+20>>0]=1;r[t+16>>2]=l;r[t+12>>2]=h}r[(r[t+16>>2]|0)+(o<<2)>>2]=e;r[t+8>>2]=o+1;r[c+32>>2]=r[e+4>>2];r[c+32+4>>2]=r[e+4+4>>2];r[c+32+8>>2]=r[e+4+8>>2];r[c+32+12>>2]=r[e+4+12>>2];r[c+32+16>>2]=r[e+20>>2];r[c+32+16+4>>2]=r[e+20+4>>2];r[c+32+16+8>>2]=r[e+20+8>>2];r[c+32+16+12>>2]=r[e+20+12>>2];r[c+32+32>>2]=r[e+36>>2];r[c+32+32+4>>2]=r[e+36+4>>2];r[c+32+32+8>>2]=r[e+36+8>>2];r[c+32+32+12>>2]=r[e+36+12>>2];r[c+32+48>>2]=r[e+52>>2];r[c+32+48+4>>2]=r[e+52+4>>2];r[c+32+48+8>>2]=r[e+52+8>>2];r[c+32+48+12>>2]=r[e+52+12>>2];h=r[e+192>>2]|0;jk[r[(r[h>>2]|0)+8>>2]&127](h,c+32|0,c+16|0,c);h=r[t+68>>2]|0;r[e+188>>2]=Nk[r[(r[h>>2]|0)+8>>2]&3](h,c+16|0,c,r[(r[e+192>>2]|0)+4>>2]|0,e,i,s,r[t+24>>2]|0,0)|0;_=c;return}function Dx(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0,a=0;i=r[e+188>>2]|0;if(i|0){o=r[t+68>>2]|0;o=ck[r[(r[o>>2]|0)+36>>2]&127](o)|0;Vk[r[(r[o>>2]|0)+40>>2]&127](o,i,r[t+24>>2]|0);o=r[t+68>>2]|0;Vk[r[(r[o>>2]|0)+12>>2]&127](o,i,r[t+24>>2]|0);r[e+188>>2]=0}s=r[t+8>>2]|0;if((s|0)<=0)return;o=r[t+16>>2]|0;i=0;while(1){n=o+(i<<2)|0;if((r[n>>2]|0)==(e|0))break;i=i+1|0;if((i|0)>=(s|0)){a=9;break}}if((a|0)==9)return;if((i|0)>=(s|0))return;r[n>>2]=r[o+(s+-1<<2)>>2];r[(r[t+16>>2]|0)+(s+-1<<2)>>2]=e;r[t+8>>2]=s+-1;return}function kx(t){t=t|0;var e=0,i=0,n=0,s=0;i=_;_=_+16|0;j_(10245);ok[r[(r[t>>2]|0)+8>>2]&255](t);ok[r[(r[t>>2]|0)+12>>2]&255](t);e=r[t+24>>2]|0;j_(10279);if(e|0){s=r[(r[e>>2]|0)+32>>2]|0;n=r[t+68>>2]|0;n=ck[r[(r[n>>2]|0)+36>>2]&127](n)|0;jk[s&127](e,n,t+28|0,r[t+24>>2]|0)}t=r[2006]|0;s=(r[t+16>>2]|0)+-1|0;r[t+16>>2]=s;do{if(!s){if(r[t+4>>2]|0){de(i|0,0)|0;e=r[5649]|0;h[t+8>>2]=+h[t+8>>2]+ +(((r[i+4>>2]|0)-(r[e+4>>2]|0)+(((r[i>>2]|0)-(r[e>>2]|0)|0)*1e6|0)-(r[t+12>>2]|0)|0)>>>0)/1.0e3;e=r[2006]|0;if(r[t+16>>2]|0)break}else e=t;e=r[e+20>>2]|0;r[2006]=e}else e=t}while(0);t=e+16|0;s=(r[t>>2]|0)+-1|0;r[t>>2]=s;if(s|0){_=i;return}do{if(r[e+4>>2]|0){de(i|0,0)|0;n=r[5649]|0;s=e+8|0;h[s>>2]=+h[s>>2]+ +(((r[i+4>>2]|0)-(r[n+4>>2]|0)+(((r[i>>2]|0)-(r[n>>2]|0)|0)*1e6|0)-(r[e+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[t>>2]|0)){e=r[2006]|0;break}else{_=i;return}}}while(0);r[2006]=r[e+20>>2];_=i;return}function Ox(t,e){t=t|0;e=e|0;ok[r[(r[e>>2]|0)+32>>2]&255](e);Fx(t,e);ok[r[(r[e>>2]|0)+36>>2]&255](e);return}function Fx(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0,l=0,h=0,c=0,u=0,d=0,p=0,f=0,m=0,g=0,b=0,y=0,v=0,S=0,x=0,w=0;w=_;_=_+80|0;n[w+16>>0]=1;r[w+12>>2]=0;r[w+4>>2]=0;r[w+8>>2]=0;n[w+36>>0]=1;r[w+32>>2]=0;r[w+24>>2]=0;r[w+28>>2]=0;n[w+56>>0]=1;r[w+52>>2]=0;r[w+44>>2]=0;r[w+48>>2]=0;n[w+76>>0]=1;r[w+72>>2]=0;r[w+64>>2]=0;r[w+68>>2]=0;i=r[t+8>>2]|0;if((i|0)<=0){Bx(w);_=w;return}l=0;h=0;o=0;s=0;g=0;while(1){m=r[(r[(r[t+16>>2]|0)+(g<<2)>>2]|0)+192>>2]|0;f=(m+~(m<<15)>>10^m+~(m<<15))*9|0;f=(f>>6^f)+~((f>>6^f)<<11)>>16^(f>>6^f)+~((f>>6^f)<<11);p=f&l+-1;c=p>>>0<h>>>0;t:do{if(c){a=r[o+(p<<2)>>2]|0;if((a|0)!=-1){u=r[w+72>>2]|0;while(1){if((m|0)==(r[u+(a<<3)>>2]|0)){d=9;break}h=r[s+(a<<2)>>2]|0;if((h|0)==-1)break;else a=h}if((d|0)==9?(d=0,(r[w+52>>2]|0)+(a<<2)|0):0)break;if(!c){d=16;break}}i=r[o+(p<<2)>>2]|0;if((i|0)!=-1){a=r[w+72>>2]|0;while(1){if((m|0)==(r[a+(i<<3)>>2]|0))break;i=r[s+(i<<2)>>2]|0;if((i|0)==-1){d=16;break t}}r[(r[w+52>>2]|0)+(i<<2)>>2]=m;i=l;d=78}else d=16}else d=16}while(0);if((d|0)==16){c=r[w+44>>2]|0;if((c|0)==(l|0)){i=l|0?l<<1:1;if((l|0)<(i|0)){if((i|0)!=0?(r[5637]=(r[5637]|0)+1,x=Zl((i<<2|3)+16|0)|0,(x|0)!=0):0){r[(x+4+15&-16)+-4>>2]=x;o=x+4+15&-16}else o=0;if((l|0)>0){s=0;do{r[o+(s<<2)>>2]=r[(r[w+52>>2]|0)+(s<<2)>>2];s=s+1|0}while((s|0)!=(l|0))}s=r[w+52>>2]|0;if(s|0){if(n[w+56>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[w+52>>2]=0}n[w+56>>0]=1;r[w+52>>2]=o;r[w+48>>2]=i;s=l}else{s=l;i=l}}else{s=c;i=l}r[(r[w+52>>2]|0)+(s<<2)>>2]=m;r[w+44>>2]=s+1;s=r[w+64>>2]|0;if((s|0)==(r[w+68>>2]|0)?(b=s|0?s<<1:1,(s|0)<(b|0)):0){if((b|0)!=0?(r[5637]=(r[5637]|0)+1,y=Zl((b<<3|3)+16|0)|0,(y|0)!=0):0){r[(y+4+15&-16)+-4>>2]=y;o=y+4+15&-16}else o=0;if((s|0)>0){i=0;do{h=(r[w+72>>2]|0)+(i<<3)|0;u=r[h+4>>2]|0;d=o+(i<<3)|0;r[d>>2]=r[h>>2];r[d+4>>2]=u;i=i+1|0}while((i|0)!=(s|0))}i=r[w+72>>2]|0;if(i|0){if(n[w+76>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[w+72>>2]=0}n[w+76>>0]=1;r[w+72>>2]=o;r[w+68>>2]=b;s=r[w+64>>2]|0;i=r[w+48>>2]|0}d=(r[w+72>>2]|0)+(s<<3)|0;r[d>>2]=m;r[d+4>>2]=0;r[w+64>>2]=s+1;if((l|0)<(i|0)){h=r[w+4>>2]|0;do{if((i|0)>(h|0)){if((i|0)>=(h|0)){do{if((r[w+8>>2]|0)<(i|0)){if((i|0)!=0?(r[5637]=(r[5637]|0)+1,v=Zl((i<<2|3)+16|0)|0,(v|0)!=0):0){r[(v+4+15&-16)+-4>>2]=v;s=v+4+15&-16}else s=0;o=r[w+12>>2]|0;if((h|0)<=0){if(!o){n[w+16>>0]=1;r[w+12>>2]=s;r[w+8>>2]=i;break}}else{a=0;do{r[s+(a<<2)>>2]=r[o+(a<<2)>>2];a=a+1|0}while((a|0)!=(h|0))}if(n[w+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}n[w+16>>0]=1;r[w+12>>2]=s;r[w+8>>2]=i}else s=r[w+12>>2]|0}while(0);Ph(s+(h<<2)|0,0,i-h<<2|0)|0}r[w+4>>2]=i;l=r[w+24>>2]|0;if((i|0)>(l|0)){do{if((r[w+28>>2]|0)<(i|0)){if((i|0)!=0?(r[5637]=(r[5637]|0)+1,S=Zl((i<<2|3)+16|0)|0,(S|0)!=0):0){r[(S+4+15&-16)+-4>>2]=S;s=S+4+15&-16}else s=0;o=r[w+32>>2]|0;if((l|0)<=0){if(!o){n[w+36>>0]=1;r[w+32>>2]=s;r[w+28>>2]=i;break}}else{a=0;do{r[s+(a<<2)>>2]=r[o+(a<<2)>>2];a=a+1|0}while((a|0)!=(l|0))}if(n[w+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}n[w+36>>0]=1;r[w+32>>2]=s;r[w+28>>2]=i}else s=r[w+32>>2]|0}while(0);Ph(s+(l<<2)|0,0,i-l<<2|0)|0}r[w+24>>2]=i;if((i|0)>0){p=i<<2;Ph(r[w+12>>2]|0,-1,p|0)|0;Ph(r[w+32>>2]|0,-1,p|0)|0}if((h|0)<=0){i=r[w+48>>2]|0;break}s=r[w+72>>2]|0;o=r[w+12>>2]|0;a=r[w+32>>2]|0;i=r[w+48>>2]|0;l=0;do{p=r[s+(l<<3)>>2]|0;p=(p+~(p<<15)>>10^p+~(p<<15))*9|0;p=o+((((p>>6^p)+~((p>>6^p)<<11)>>16^(p>>6^p)+~((p>>6^p)<<11))&i+-1)<<2)|0;r[a+(l<<2)>>2]=r[p>>2];r[p>>2]=l;l=l+1|0}while((l|0)!=(h|0))}}while(0);s=i;i=f&i+-1}else{s=i;i=p}o=r[w+12>>2]|0;i=o+(i<<2)|0;d=r[w+32>>2]|0;r[d+(c<<2)>>2]=r[i>>2];r[i>>2]=c;i=s;s=d;d=78}if((d|0)==78){d=0;lk[r[(r[m>>2]|0)+60>>2]&127](m,e);l=i;i=r[t+8>>2]|0}a=g+1|0;if((a|0)>=(i|0))break;h=r[w+4>>2]|0;g=a}if((i|0)>0)o=0;else{Bx(w);_=w;return}do{s=r[(r[t+16>>2]|0)+(o<<2)>>2]|0;switch(r[s+236>>2]|0){case 64:case 1:{lk[r[(r[s>>2]|0)+24>>2]&127](s,e);i=r[t+8>>2]|0;break}default:{}}o=o+1|0}while((o|0)<(i|0));Bx(w);_=w;return}function Bx(t){t=t|0;var e=0;e=r[t+72>>2]|0;if(e|0){if(n[t+76>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+72>>2]=0}n[t+76>>0]=1;r[t+72>>2]=0;r[t+64>>2]=0;r[t+68>>2]=0;e=r[t+52>>2]|0;if(e|0){if(n[t+56>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+52>>2]=0}n[t+56>>0]=1;r[t+52>>2]=0;r[t+44>>2]=0;r[t+48>>2]=0;e=r[t+32>>2]|0;if(e|0){if(n[t+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+32>>2]=0}n[t+36>>0]=1;r[t+32>>2]=0;r[t+24>>2]=0;r[t+28>>2]=0;e=r[t+12>>2]|0;if(!e){n[t+16>>0]=1;r[t+12>>2]=0;r[t+4>>2]=0;t=t+8|0;r[t>>2]=0;return}if(n[t+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+12>>2]=0;n[t+16>>0]=1;r[t+12>>2]=0;r[t+4>>2]=0;t=t+8|0;r[t>>2]=0;return}function Nx(t,e,i,o,a,l){t=t|0;e=e|0;i=i|0;o=o|0;a=a|0;l=+l;var c=0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0,S=0.0,x=0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0,I=0,P=0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0;P=_;_=_+896|0;I=r[o+4>>2]|0;R=r[o+12>>2]|0;x=r[I+4>>2]|0;if((x|0)<20){r[P+712>>2]=3316;r[P+712+168>>2]=0;h[P+712+172>>2]=l;r[P+712+164>>2]=r[a+4>>2];h[P+352+308>>2]=9.999999747378752e-05;n[P+352+332>>0]=0;r[P+288>>2]=6908;r[P+64>>2]=6816;r[P+64+4>>2]=P+352;r[P+64+8>>2]=P+288;r[P+64+12>>2]=t;r[P+64+16>>2]=I;r[P+64+20>>2]=0;if((kv(P+64|0,e,i,R,R,P+712|0)|0?(c=P+712+132|0,u=+h[c>>2],d=+h[P+712+136>>2],f=+h[P+712+140>>2],u*u+d*d+f*f>9.999999747378752e-05):0)?(y=+h[P+712+164>>2],y<+h[a+4>>2]):0){l=1.0/+G(+(u*u+d*d+f*f));h[c>>2]=u*l;h[P+712+136>>2]=d*l;h[P+712+140>>2]=f*l;r[P+16>>2]=r[o+8>>2];r[P+16+4>>2]=0;r[P+16+8>>2]=r[c>>2];r[P+16+8+4>>2]=r[c+4>>2];r[P+16+8+8>>2]=r[c+8>>2];r[P+16+8+12>>2]=r[c+12>>2];r[P+16+24>>2]=r[P+712+148>>2];r[P+16+24+4>>2]=r[P+712+148+4>>2];r[P+16+24+8>>2]=r[P+712+148+8>>2];r[P+16+24+12>>2]=r[P+712+148+12>>2];h[P+16+40>>2]=y;+Ik[r[(r[a>>2]|0)+12>>2]&15](a,P+16|0,1)}_=P;return}if((x+-21|0)>>>0>=9){if((x|0)!=31){_=P;return}j_(10657);if((r[I+20>>2]|0)>0){c=0;do{v=r[I+28>>2]|0;u=+h[v+(c*80|0)>>2];f=+h[v+(c*80|0)+4>>2];b=+h[v+(c*80|0)+8>>2];d=+h[v+(c*80|0)+16>>2];m=+h[v+(c*80|0)+20>>2];S=+h[v+(c*80|0)+24>>2];p=+h[v+(c*80|0)+32>>2];g=+h[v+(c*80|0)+36>>2];C=+h[v+(c*80|0)+40>>2];U=+h[v+(c*80|0)+48>>2];N=+h[v+(c*80|0)+52>>2];M=+h[v+(c*80|0)+56>>2];v=r[v+(c*80|0)+64>>2]|0;B=+h[R>>2];F=+h[R+4>>2];O=+h[R+8>>2];k=+h[R+16>>2];D=+h[R+20>>2];L=+h[R+24>>2];y=+h[R+32>>2];w=+h[R+36>>2];T=+h[R+40>>2];A=U*B+N*F+M*O+ +h[R+48>>2];E=U*k+N*D+M*L+ +h[R+52>>2];M=U*y+N*w+M*T+ +h[R+56>>2];h[P+712>>2]=u*B+d*F+p*O;h[P+712+4>>2]=f*B+m*F+g*O;h[P+712+8>>2]=b*B+S*F+C*O;h[P+712+12>>2]=0.0;h[P+712+16>>2]=u*k+d*D+p*L;h[P+712+20>>2]=f*k+m*D+g*L;h[P+712+24>>2]=b*k+S*D+C*L;h[P+712+28>>2]=0.0;h[P+712+32>>2]=u*y+d*w+p*T;h[P+712+36>>2]=f*y+m*w+g*T;h[P+712+40>>2]=b*y+S*w+C*T;h[P+712+44>>2]=0.0;h[P+712+48>>2]=A;h[P+712+52>>2]=E;h[P+712+56>>2]=M;h[P+712+60>>2]=0.0;s[P+352+8>>1]=1;s[P+352+10>>1]=-1;r[P+352>>2]=3500;r[P+352+12>>2]=a;r[P+352+16>>2]=c;r[P+352+4>>2]=r[a+4>>2];x=r[o+8>>2]|0;r[P+288>>2]=o;r[P+288+4>>2]=v;r[P+288+8>>2]=x;r[P+288+12>>2]=P+712;r[P+288+16>>2]=-1;r[P+288+20>>2]=c;Nx(t,e,i,P+288|0,P+352|0,l);c=c+1|0}while((c|0)<(r[I+20>>2]|0))}c=r[2006]|0;I=(r[c+16>>2]|0)+-1|0;r[c+16>>2]=I;if(I|0){_=P;return}do{if(r[c+4>>2]|0){de(P+712|0,0)|0;I=r[5649]|0;h[c+8>>2]=+h[c+8>>2]+ +(((r[P+712+4>>2]|0)-(r[I+4>>2]|0)+(((r[P+712>>2]|0)-(r[I>>2]|0)|0)*1e6|0)-(r[c+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[c+16>>2]|0)){c=r[2006]|0;break}else{_=P;return}}}while(0);r[2006]=r[c+20>>2];_=P;return}switch(x|0){case 21:{f=+h[R>>2];m=+h[R+16>>2];g=+h[R+32>>2];b=+h[R+4>>2];y=+h[R+20>>2];S=+h[R+36>>2];w=+h[R+8>>2];C=+h[R+24>>2];T=+h[R+40>>2];A=-+h[R+48>>2];E=-+h[R+52>>2];M=-+h[R+56>>2];p=+h[e+48>>2];d=+h[e+52>>2];u=+h[e+56>>2];h[P+352>>2]=f*A+m*E+g*M+(f*p+m*d+g*u);h[P+352+4>>2]=b*A+y*E+S*M+(b*p+y*d+S*u);h[P+352+8>>2]=w*A+C*E+T*M+(w*p+C*d+T*u);h[P+352+12>>2]=0.0;u=+h[i+48>>2];d=+h[i+52>>2];p=+h[i+56>>2];V=+h[i>>2];L=+h[i+16>>2];D=+h[i+32>>2];k=+h[i+4>>2];O=+h[i+20>>2];F=+h[i+36>>2];B=+h[i+8>>2];N=+h[i+24>>2];U=+h[i+40>>2];h[P+288>>2]=f*V+m*L+g*D;h[P+288+4>>2]=f*k+m*O+g*F;h[P+288+8>>2]=f*B+m*N+g*U;h[P+288+12>>2]=0.0;h[P+288+16>>2]=b*V+y*L+S*D;h[P+288+20>>2]=b*k+y*O+S*F;h[P+288+24>>2]=b*B+y*N+S*U;h[P+288+28>>2]=0.0;h[P+288+32>>2]=w*V+C*L+T*D;h[P+288+36>>2]=w*k+C*O+T*F;h[P+288+40>>2]=w*B+C*N+T*U;c=P+288+44|0;r[c>>2]=0;r[c+4>>2]=0;r[c+8>>2]=0;r[c+12>>2]=0;r[c+16>>2]=0;c=r[o+8>>2]|0;U=+xk[r[(r[I>>2]|0)+48>>2]&15](I);r[P+64>>2]=7e3;r[P+64+4>>2]=t;r[P+64+8>>2]=r[e>>2];r[P+64+8+4>>2]=r[e+4>>2];r[P+64+8+8>>2]=r[e+8>>2];r[P+64+8+12>>2]=r[e+12>>2];r[P+64+24>>2]=r[e+16>>2];r[P+64+24+4>>2]=r[e+16+4>>2];r[P+64+24+8>>2]=r[e+16+8>>2];r[P+64+24+12>>2]=r[e+16+12>>2];r[P+64+40>>2]=r[e+32>>2];r[P+64+40+4>>2]=r[e+32+4>>2];r[P+64+40+8>>2]=r[e+32+8>>2];r[P+64+40+12>>2]=r[e+32+12>>2];r[P+64+56>>2]=r[e+48>>2];r[P+64+56+4>>2]=r[e+48+4>>2];r[P+64+56+8>>2]=r[e+48+8>>2];r[P+64+56+12>>2]=r[e+48+12>>2];r[P+64+72>>2]=r[i>>2];r[P+64+72+4>>2]=r[i+4>>2];r[P+64+72+8>>2]=r[i+8>>2];r[P+64+72+12>>2]=r[i+12>>2];r[P+64+88>>2]=r[i+16>>2];r[P+64+88+4>>2]=r[i+16+4>>2];r[P+64+88+8>>2]=r[i+16+8>>2];r[P+64+88+12>>2]=r[i+16+12>>2];r[P+64+104>>2]=r[i+32>>2];r[P+64+104+4>>2]=r[i+32+4>>2];r[P+64+104+8>>2]=r[i+32+8>>2];r[P+64+104+12>>2]=r[i+32+12>>2];r[P+64+120>>2]=r[i+48>>2];r[P+64+120+4>>2]=r[i+48+4>>2];r[P+64+120+8>>2]=r[i+48+8>>2];r[P+64+120+12>>2]=r[i+48+12>>2];r[P+64+136>>2]=r[R>>2];r[P+64+136+4>>2]=r[R+4>>2];r[P+64+136+8>>2]=r[R+8>>2];r[P+64+136+12>>2]=r[R+12>>2];r[P+64+152>>2]=r[R+16>>2];r[P+64+152+4>>2]=r[R+16+4>>2];r[P+64+152+8>>2]=r[R+16+8>>2];r[P+64+152+12>>2]=r[R+16+12>>2];r[P+64+168>>2]=r[R+32>>2];r[P+64+168+4>>2]=r[R+32+4>>2];r[P+64+168+8>>2]=r[R+32+8>>2];r[P+64+168+12>>2]=r[R+32+12>>2];r[P+64+184>>2]=r[R+48>>2];r[P+64+184+4>>2]=r[R+48+4>>2];r[P+64+184+8>>2]=r[R+48+8>>2];r[P+64+184+12>>2]=r[R+48+12>>2];h[P+64+204>>2]=U;r[P+64>>2]=3452;r[P+64+212>>2]=a;r[P+64+216>>2]=c;r[P+64+220>>2]=I;r[P+64+200>>2]=r[a+4>>2];h[P+64+208>>2]=l;jk[r[(r[t>>2]|0)+8>>2]&127](t,P+288|0,P+16|0,P);c=r[I+52>>2]|0;r[P+712>>2]=4856;r[P+712+4>>2]=c;r[P+712+8>>2]=P+64;c=r[I+56>>2]|0;if(!(n[c+60>>0]|0))JL(c,P+712|0,P+352|0,f*A+m*E+g*M+(f*u+m*d+g*p),b*A+y*E+S*M+(b*u+y*d+S*p),w*A+C*E+T*M+(w*u+C*d+T*p),P+16|0,P);else tD(c,P+712|0,P+352|0,f*A+m*E+g*M+(f*u+m*d+g*p),b*A+y*E+S*M+(b*u+y*d+S*p),w*A+C*E+T*M+(w*u+C*d+T*p),P+16|0,P,r[c+56>>2]|0);_=P;return}case 28:{r[P+712>>2]=3316;r[P+712+168>>2]=0;h[P+712+172>>2]=l;r[P+712+164>>2]=r[a+4>>2];r[P+352>>2]=6816;r[P+352+4>>2]=0;r[P+352+8>>2]=0;r[P+352+12>>2]=t;r[P+352+16>>2]=0;r[P+352+20>>2]=I;if((kv(P+352|0,e,i,R,R,P+712|0)|0?(v=P+712+132|0,p=+h[v>>2],m=+h[P+712+136>>2],g=+h[P+712+140>>2],p*p+m*m+g*g>9.999999747378752e-05):0)?(b=+h[P+712+164>>2],b<+h[a+4>>2]):0){V=1.0/+G(+(p*p+m*m+g*g));h[v>>2]=p*V;h[P+712+136>>2]=m*V;h[P+712+140>>2]=g*V;r[P+288>>2]=r[o+8>>2];r[P+288+4>>2]=0;r[P+288+8>>2]=r[v>>2];r[P+288+8+4>>2]=r[v+4>>2];r[P+288+8+8>>2]=r[v+8>>2];r[P+288+8+12>>2]=r[v+12>>2];r[P+288+24>>2]=r[P+712+148>>2];r[P+288+24+4>>2]=r[P+712+148+4>>2];r[P+288+24+8>>2]=r[P+712+148+8>>2];r[P+288+24+12>>2]=r[P+712+148+12>>2];h[P+288+40>>2]=b;+Ik[r[(r[a>>2]|0)+12>>2]&15](a,P+288|0,1)}_=P;return}default:{f=+h[R>>2];m=+h[R+16>>2];g=+h[R+32>>2];w=+h[R+4>>2];C=+h[R+20>>2];T=+h[R+36>>2];O=+h[R+8>>2];B=+h[R+24>>2];U=+h[R+40>>2];D=-+h[R+48>>2];L=-+h[R+52>>2];M=-+h[R+56>>2];A=+h[e+48>>2];E=+h[e+52>>2];u=+h[e+56>>2];p=f*D+m*L+g*M+(f*A+m*E+g*u);d=w*D+C*L+T*M+(w*A+C*E+T*u);u=O*D+B*L+U*M+(O*A+B*E+U*u);E=+h[i+48>>2];A=+h[i+52>>2];S=+h[i+56>>2];b=f*D+m*L+g*M+(f*E+m*A+g*S);y=w*D+C*L+T*M+(w*E+C*A+T*S);S=O*D+B*L+U*M+(O*E+B*A+U*S);A=+h[i>>2];E=+h[i+16>>2];M=+h[i+32>>2];L=+h[i+4>>2];D=+h[i+20>>2];k=+h[i+36>>2];F=+h[i+8>>2];N=+h[i+24>>2];V=+h[i+40>>2];h[P+712>>2]=f*A+m*E+g*M;h[P+712+4>>2]=f*L+m*D+g*k;h[P+712+8>>2]=f*F+m*N+g*V;h[P+712+12>>2]=0.0;h[P+712+16>>2]=w*A+C*E+T*M;h[P+712+20>>2]=w*L+C*D+T*k;h[P+712+24>>2]=w*F+C*N+T*V;h[P+712+28>>2]=0.0;h[P+712+32>>2]=O*A+B*E+U*M;h[P+712+36>>2]=O*L+B*D+U*k;h[P+712+40>>2]=O*F+B*N+U*V;x=P+712+44|0;r[x>>2]=0;r[x+4>>2]=0;r[x+8>>2]=0;r[x+12>>2]=0;r[x+16>>2]=0;o=r[o+8>>2]|0;V=+xk[r[(r[I>>2]|0)+48>>2]&15](I);r[P+352>>2]=7e3;r[P+352+4>>2]=t;r[P+352+8>>2]=r[e>>2];r[P+352+8+4>>2]=r[e+4>>2];r[P+352+8+8>>2]=r[e+8>>2];r[P+352+8+12>>2]=r[e+12>>2];r[P+352+24>>2]=r[e+16>>2];r[P+352+24+4>>2]=r[e+16+4>>2];r[P+352+24+8>>2]=r[e+16+8>>2];r[P+352+24+12>>2]=r[e+16+12>>2];r[P+352+40>>2]=r[e+32>>2];r[P+352+40+4>>2]=r[e+32+4>>2];r[P+352+40+8>>2]=r[e+32+8>>2];r[P+352+40+12>>2]=r[e+32+12>>2];r[P+352+56>>2]=r[e+48>>2];r[P+352+56+4>>2]=r[e+48+4>>2];r[P+352+56+8>>2]=r[e+48+8>>2];r[P+352+56+12>>2]=r[e+48+12>>2];r[P+352+72>>2]=r[i>>2];r[P+352+72+4>>2]=r[i+4>>2];r[P+352+72+8>>2]=r[i+8>>2];r[P+352+72+12>>2]=r[i+12>>2];r[P+352+88>>2]=r[i+16>>2];r[P+352+88+4>>2]=r[i+16+4>>2];r[P+352+88+8>>2]=r[i+16+8>>2];r[P+352+88+12>>2]=r[i+16+12>>2];r[P+352+104>>2]=r[i+32>>2];r[P+352+104+4>>2]=r[i+32+4>>2];r[P+352+104+8>>2]=r[i+32+8>>2];r[P+352+104+12>>2]=r[i+32+12>>2];r[P+352+120>>2]=r[i+48>>2];r[P+352+120+4>>2]=r[i+48+4>>2];r[P+352+120+8>>2]=r[i+48+8>>2];r[P+352+120+12>>2]=r[i+48+12>>2];r[P+352+136>>2]=r[R>>2];r[P+352+136+4>>2]=r[R+4>>2];r[P+352+136+8>>2]=r[R+8>>2];r[P+352+136+12>>2]=r[R+12>>2];r[P+352+152>>2]=r[R+16>>2];r[P+352+152+4>>2]=r[R+16+4>>2];r[P+352+152+8>>2]=r[R+16+8>>2];r[P+352+152+12>>2]=r[R+16+12>>2];r[P+352+168>>2]=r[R+32>>2];r[P+352+168+4>>2]=r[R+32+4>>2];r[P+352+168+8>>2]=r[R+32+8>>2];r[P+352+168+12>>2]=r[R+32+12>>2];r[P+352+184>>2]=r[R+48>>2];r[P+352+184+4>>2]=r[R+48+4>>2];r[P+352+184+8>>2]=r[R+48+8>>2];r[P+352+184+12>>2]=r[R+48+12>>2];h[P+352+204>>2]=V;r[P+352>>2]=3476;r[P+352+212>>2]=a;r[P+352+216>>2]=o;r[P+352+220>>2]=I;r[P+352+200>>2]=r[a+4>>2];h[P+352+208>>2]=l;jk[r[(r[t>>2]|0)+8>>2]&127](t,P+712|0,P+288|0,P+64|0);h[P+16>>2]=p;h[P+16+4>>2]=d;h[P+16+8>>2]=u;h[P+16+12>>2]=0.0;if(b<p){h[P+16>>2]=b;f=b}else f=p;if(y<d){h[P+16+4>>2]=y;m=y}else m=d;if(S<u){h[P+16+8>>2]=S;g=S}else g=u;h[P>>2]=p;h[P+4>>2]=d;h[P+8>>2]=u;h[P+12>>2]=0.0;if(p<b){h[P>>2]=b;p=b}if(d<y){h[P+4>>2]=y;d=y}if(u<S){h[P+8>>2]=S;u=S}h[P+16>>2]=+h[P+288>>2]+f;h[P+16+4>>2]=+h[P+288+4>>2]+m;h[P+16+8>>2]=+h[P+288+8>>2]+g;h[P>>2]=+h[P+64>>2]+p;h[P+4>>2]=+h[P+64+4>>2]+d;h[P+8>>2]=+h[P+64+8>>2]+u;jk[r[(r[I>>2]|0)+64>>2]&127](I,P+352|0,P+16|0,P);_=P;return}}}function Ux(t){t=t|0;Ql(t);return}function Vx(t,e,i,n,s,o){t=t|0;e=e|0;i=i|0;n=+n;s=s|0;o=o|0;var a=0;a=_;_=_+64|0;r[a+48>>2]=s;r[a+48+4>>2]=o;s=r[t+212>>2]|0;if(!(+h[s+4>>2]>=n)){_=a;return+n}r[a>>2]=r[t+216>>2];r[a+4>>2]=a+48;r[a+8>>2]=r[e>>2];r[a+8+4>>2]=r[e+4>>2];r[a+8+8>>2]=r[e+8>>2];r[a+8+12>>2]=r[e+12>>2];r[a+24>>2]=r[i>>2];r[a+24+4>>2]=r[i+4>>2];r[a+24+8>>2]=r[i+8>>2];r[a+24+12>>2]=r[i+12>>2];h[a+40>>2]=n;n=+Ik[r[(r[s>>2]|0)+12>>2]&15](s,a,1);_=a;return+n}function zx(t){t=t|0;Ql(t);return}function Wx(t,e,i,n,s,o){t=t|0;e=e|0;i=i|0;n=+n;s=s|0;o=o|0;var a=0;a=_;_=_+64|0;r[a+48>>2]=s;r[a+48+4>>2]=o;s=r[t+212>>2]|0;if(!(+h[s+4>>2]>=n)){_=a;return+n}r[a>>2]=r[t+216>>2];r[a+4>>2]=a+48;r[a+8>>2]=r[e>>2];r[a+8+4>>2]=r[e+4>>2];r[a+8+8>>2]=r[e+8>>2];r[a+8+12>>2]=r[e+12>>2];r[a+24>>2]=r[i>>2];r[a+24+4>>2]=r[i+4>>2];r[a+24+8>>2]=r[i+8>>2];r[a+24+12>>2]=r[i+12>>2];h[a+40>>2]=n;n=+Ik[r[(r[s>>2]|0)+12>>2]&15](s,a,1);_=a;return+n}function Gx(t){t=t|0;return}function jx(t){t=t|0;Ql(t);return}function Hx(t,e){t=t|0;e=e|0;t=r[t+12>>2]|0;return Rk[r[(r[t>>2]|0)+8>>2]&31](t,e)|0}function Xx(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0.0,o=0;n=_;_=_+16|0;r[n>>2]=-1;r[n+4>>2]=r[t+16>>2];if(!(r[e+4>>2]|0))r[e+4>>2]=n;o=r[t+12>>2]|0;s=+Ik[r[(r[o>>2]|0)+12>>2]&15](o,e,i);r[t+4>>2]=r[(r[t+12>>2]|0)+4>>2];_=n;return+s}function Yx(t,e,i,n,s,o){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=+o;var a=0,l=0,c=0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0,y=0.0;a=_;_=_+464|0;j_(10877);r[a+128>>2]=r[i>>2];r[a+128+4>>2]=r[i+4>>2];r[a+128+8>>2]=r[i+8>>2];r[a+128+12>>2]=r[i+12>>2];r[a+128+16>>2]=r[i+16>>2];r[a+128+16+4>>2]=r[i+16+4>>2];r[a+128+16+8>>2]=r[i+16+8>>2];r[a+128+16+12>>2]=r[i+16+12>>2];r[a+128+32>>2]=r[i+32>>2];r[a+128+32+4>>2]=r[i+32+4>>2];r[a+128+32+8>>2]=r[i+32+8>>2];r[a+128+32+12>>2]=r[i+32+12>>2];c=a+128+48|0;r[c>>2]=r[i+48>>2];r[c+4>>2]=r[i+48+4>>2];r[c+8>>2]=r[i+48+8>>2];r[c+12>>2]=r[i+48+12>>2];r[a+64>>2]=r[n>>2];r[a+64+4>>2]=r[n+4>>2];r[a+64+8>>2]=r[n+8>>2];r[a+64+12>>2]=r[n+12>>2];r[a+64+16>>2]=r[n+16>>2];r[a+64+16+4>>2]=r[n+16+4>>2];r[a+64+16+8>>2]=r[n+16+8>>2];r[a+64+16+12>>2]=r[n+16+12>>2];r[a+64+32>>2]=r[n+32>>2];r[a+64+32+4>>2]=r[n+32+4>>2];r[a+64+32+8>>2]=r[n+32+8>>2];r[a+64+32+12>>2]=r[n+32+12>>2];l=a+64+48|0;r[l>>2]=r[n+48>>2];r[l+4>>2]=r[n+48+4>>2];r[l+8>>2]=r[n+48+8>>2];r[l+12>>2]=r[n+48+12>>2];qx(a+128|0,a+64|0,a+256|0,a+192|0);y=+h[a+192>>2];u=y*+h[a+256+4>>2];g=y*+h[a+256+8>>2];h[a+16>>2]=+h[a+256>>2]*y;h[a+16+4>>2]=u;h[a+16+8>>2]=g;h[a+16+12>>2]=0.0;r[a+256>>2]=0;r[a+256+4>>2]=0;r[a+256+8>>2]=0;r[a+256+12>>2]=0;r[a+192+4>>2]=0;r[a+192+4+4>>2]=0;r[a+192+24>>2]=0;r[a+192+24+4>>2]=0;b=a+192+44|0;r[b>>2]=0;r[b+4>>2]=0;r[b+8>>2]=0;r[b+12>>2]=0;r[b+16>>2]=0;Kx(a+128|0,a);g=+h[a>>2];u=+h[a+4>>2];y=+h[a+8>>2];m=+h[a+12>>2];p=g*(2.0/(g*g+u*u+y*y+m*m));d=u*(2.0/(g*g+u*u+y*y+m*m));f=y*(2.0/(g*g+u*u+y*y+m*m));h[a+192>>2]=1.0-(u*d+y*f);h[a+192+4>>2]=g*d-m*f;h[a+192+8>>2]=g*f+m*d;h[a+192+12>>2]=0.0;h[a+192+16>>2]=g*d+m*f;h[a+192+20>>2]=1.0-(g*p+y*f);h[a+192+24>>2]=u*f-m*p;h[a+192+28>>2]=0.0;h[a+192+32>>2]=g*f-m*d;h[a+192+36>>2]=u*f+m*p;h[a+192+40>>2]=1.0-(g*p+u*d);h[b>>2]=0.0;vC(e,a+192|0,a+256|0,a+16|0,a+48|0,a+32|0);r[a+256>>2]=3524;r[a+256+36>>2]=r[i>>2];r[a+256+36+4>>2]=r[i+4>>2];r[a+256+36+8>>2]=r[i+8>>2];r[a+256+36+12>>2]=r[i+12>>2];r[a+256+52>>2]=r[i+16>>2];r[a+256+52+4>>2]=r[i+16+4>>2];r[a+256+52+8>>2]=r[i+16+8>>2];r[a+256+52+12>>2]=r[i+16+12>>2];r[a+256+68>>2]=r[i+32>>2];r[a+256+68+4>>2]=r[i+32+4>>2];r[a+256+68+8>>2]=r[i+32+8>>2];r[a+256+68+12>>2]=r[i+32+12>>2];b=a+256+84|0;r[b>>2]=r[i+48>>2];r[b+4>>2]=r[i+48+4>>2];r[b+8>>2]=r[i+48+8>>2];r[b+12>>2]=r[i+48+12>>2];r[a+256+100>>2]=r[n>>2];r[a+256+100+4>>2]=r[n+4>>2];r[a+256+100+8>>2]=r[n+8>>2];r[a+256+100+12>>2]=r[n+12>>2];r[a+256+116>>2]=r[n+16>>2];r[a+256+116+4>>2]=r[n+16+4>>2];r[a+256+116+8>>2]=r[n+16+8>>2];r[a+256+116+12>>2]=r[n+16+12>>2];r[a+256+132>>2]=r[n+32>>2];r[a+256+132+4>>2]=r[n+32+4>>2];r[a+256+132+8>>2]=r[n+32+8>>2];r[a+256+132+12>>2]=r[n+32+12>>2];i=a+256+148|0;r[i>>2]=r[n+48>>2];r[i+4>>2]=r[n+48+4>>2];r[i+8>>2]=r[n+48+8>>2];r[i+12>>2]=r[n+48+12>>2];r[a+256+180>>2]=t;r[a+256+184>>2]=s;h[a+256+188>>2]=o;r[a+256+192>>2]=e;d=+h[i>>2]-+h[b>>2];u=+h[a+256+152>>2]-+h[a+256+88>>2];p=+h[a+256+156>>2]-+h[a+256+92>>2];o=1.0/+G(+(d*d+u*u+p*p));g=d*o==0.0?999999984306749440.0:1.0/(d*o);h[a+256+4>>2]=g;m=u*o==0.0?999999984306749440.0:1.0/(u*o);h[a+256+8>>2]=m;f=p*o==0.0?999999984306749440.0:1.0/(p*o);h[a+256+12>>2]=f;r[a+256+20>>2]=g<0.0&1;r[a+256+24>>2]=m<0.0&1;r[a+256+28>>2]=f<0.0&1;h[a+256+32>>2]=p*(p*o)+(d*(d*o)+u*(u*o));e=r[t+68>>2]|0;vk[r[(r[e>>2]|0)+24>>2]&7](e,c,l,a+256|0,a+48|0,a+32|0);e=r[2006]|0;t=(r[e+16>>2]|0)+-1|0;r[e+16>>2]=t;if(t|0){_=a;return}do{if(r[e+4>>2]|0){de(a+256|0,0)|0;b=r[5649]|0;h[e+8>>2]=+h[e+8>>2]+ +(((r[a+256+4>>2]|0)-(r[b+4>>2]|0)+(((r[a+256>>2]|0)-(r[b>>2]|0)|0)*1e6|0)-(r[e+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[e+16>>2]|0)){e=r[2006]|0;break}else{_=a;return}}}while(0);r[2006]=r[e+20>>2];_=a;return}function qx(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0;c=_;_=_+64|0;d=+h[t+20>>2];v=+h[t+40>>2];f=+h[t+24>>2];b=+h[t+36>>2];y=+h[t+32>>2];u=+h[t+16>>2];l=+h[t>>2];a=+h[t+4>>2];m=+h[t+8>>2];o=1.0/((d*v-f*b)*l+a*(f*y-v*u)+(b*u-d*y)*m);T=+h[e>>2];C=+h[e+4>>2];A=+h[e+8>>2];w=+h[e+16>>2];x=+h[e+20>>2];S=+h[e+24>>2];g=+h[e+32>>2];p=+h[e+36>>2];s=+h[e+40>>2];h[c+16>>2]=A*((b*u-d*y)*o)+(T*((d*v-f*b)*o)+C*((f*y-v*u)*o));h[c+16+4>>2]=A*((y*a-b*l)*o)+(T*((b*m-v*a)*o)+C*((v*l-y*m)*o));h[c+16+8>>2]=A*((d*l-u*a)*o)+(T*((f*a-d*m)*o)+C*((u*m-f*l)*o));h[c+16+12>>2]=0.0;h[c+16+16>>2]=(d*v-f*b)*o*w+(f*y-v*u)*o*x+(b*u-d*y)*o*S;h[c+16+20>>2]=(b*m-v*a)*o*w+(v*l-y*m)*o*x+(y*a-b*l)*o*S;h[c+16+24>>2]=(f*a-d*m)*o*w+(u*m-f*l)*o*x+(d*l-u*a)*o*S;h[c+16+28>>2]=0.0;h[c+16+32>>2]=(d*v-f*b)*o*g+(f*y-v*u)*o*p+(b*u-d*y)*o*s;h[c+16+36>>2]=(b*m-v*a)*o*g+(v*l-y*m)*o*p+(y*a-b*l)*o*s;h[c+16+40>>2]=(f*a-d*m)*o*g+(u*m-f*l)*o*p+(d*l-u*a)*o*s;h[c+16+44>>2]=0.0;Kx(c+16|0,c);s=+h[c>>2];o=+h[c+4>>2];a=+h[c+8>>2];u=+h[c+12>>2];l=1.0/+G(+(s*s+o*o+a*a+u*u));h[c>>2]=s*l;h[c+4>>2]=o*l;h[c+8>>2]=a*l;h[c+12>>2]=u*l;u=u*l<-1.0?-1.0:u*l;h[n>>2]=+q(+(u>1.0?1.0:u))*2.0;h[i>>2]=s*l;h[i+4>>2]=o*l;h[i+8>>2]=a*l;h[i+12>>2]=0.0;if(s*l*(s*l)+o*l*(o*l)+a*l*(a*l)<1.4210854715202004e-14){r[i>>2]=1065353216;r[i+4>>2]=0;r[i+8>>2]=0;h[i+12>>2]=0.0;_=c;return}else{A=1.0/+G(+(s*l*(s*l)+o*l*(o*l)+a*l*(a*l)));h[i>>2]=s*l*A;h[i+4>>2]=A*(o*l);h[i+8>>2]=A*(a*l);_=c;return}}function Kx(t,e){t=t|0;e=e|0;var i=0.0,n=0.0,s=0.0,o=0,a=0,l=0,c=0,u=0.0;o=_;_=_+16|0;i=+h[t>>2];n=+h[t+20>>2];s=+h[t+40>>2];if(i+n+s>0.0){s=+G(+(i+n+s+1.0));h[o+12>>2]=s*.5;u=.5/s*(+h[t+36>>2]-+h[t+24>>2]);h[o>>2]=u;i=.5/s*(+h[t+8>>2]-+h[t+32>>2]);h[o+4>>2]=i;n=.5/s*(+h[t+16>>2]-+h[t+4>>2]);h[o+8>>2]=n;t=(h[d>>2]=u,r[d>>2]|0);c=(h[d>>2]=i,r[d>>2]|0);l=(h[d>>2]=n,r[d>>2]|0);a=(h[d>>2]=s*.5,r[d>>2]|0);r[e>>2]=t;t=e+4|0;r[t>>2]=c;t=e+8|0;r[t>>2]=l;t=e+12|0;r[t>>2]=a;_=o;return}else{c=i<n?n<s?2:1:i<s?2:0;u=+G(+(+h[t+(c<<4)+(c<<2)>>2]-+h[t+((((c+1|0)>>>0)%3|0)<<4)+((((c+1|0)>>>0)%3|0)<<2)>>2]-+h[t+((((c+2|0)>>>0)%3|0)<<4)+((((c+2|0)>>>0)%3|0)<<2)>>2]+1.0));h[o+(c<<2)>>2]=u*.5;h[o+12>>2]=.5/u*(+h[t+((((c+2|0)>>>0)%3|0)<<4)+((((c+1|0)>>>0)%3|0)<<2)>>2]-+h[t+((((c+1|0)>>>0)%3|0)<<4)+((((c+2|0)>>>0)%3|0)<<2)>>2]);h[o+((((c+1|0)>>>0)%3|0)<<2)>>2]=.5/u*(+h[t+((((c+1|0)>>>0)%3|0)<<4)+(c<<2)>>2]+ +h[t+(c<<4)+((((c+1|0)>>>0)%3|0)<<2)>>2]);h[o+((((c+2|0)>>>0)%3|0)<<2)>>2]=.5/u*(+h[t+((((c+2|0)>>>0)%3|0)<<4)+(c<<2)>>2]+ +h[t+(c<<4)+((((c+2|0)>>>0)%3|0)<<2)>>2]);c=r[o>>2]|0;t=r[o+4>>2]|0;a=r[o+8>>2]|0;l=r[o+12>>2]|0;r[e>>2]=c;c=e+4|0;r[c>>2]=t;c=e+8|0;r[c>>2]=a;c=e+12|0;r[c>>2]=l;_=o;return}}function Zx(t){t=t|0;Ql(t);return}function Qx(t,e){t=t|0;e=e|0;var i=0,n=0,s=0.0,o=0,a=0;n=_;_=_+32|0;i=r[t+184>>2]|0;if(+h[i+4>>2]==0.0){t=0;_=n;return t|0}e=r[e>>2]|0;if(!(Rk[r[(r[i>>2]|0)+8>>2]&31](i,r[e+188>>2]|0)|0)){t=1;_=n;return t|0}o=r[t+192>>2]|0;a=r[e+192>>2]|0;i=r[t+184>>2]|0;s=+h[t+188>>2];r[n>>2]=0;r[n+4>>2]=a;r[n+8>>2]=e;r[n+12>>2]=e+4;r[n+16>>2]=-1;r[n+20>>2]=-1;Nx(o,t+36|0,t+100|0,n,i,s);t=1;_=n;return t|0}function $x(t){t=t|0;Ql(t);return}function Jx(t,e){t=t|0;e=e|0;var i=0,n=0,s=0;i=_;_=_+96|0;e=r[e>>2]|0;if((e|0)==(r[t+4>>2]|0)){_=i;return 1}n=r[t+12>>2]|0;if(!(Rk[r[(r[n>>2]|0)+8>>2]&31](n,r[e+188>>2]|0)|0)){_=i;return 1}n=r[t+4>>2]|0;s=r[n+192>>2]|0;r[i+64>>2]=0;r[i+64+4>>2]=s;r[i+64+8>>2]=n;r[i+64+12>>2]=n+4;r[i+64+16>>2]=-1;r[i+64+20>>2]=-1;n=r[e+192>>2]|0;r[i+40>>2]=0;r[i+40+4>>2]=n;r[i+40+8>>2]=e;r[i+40+12>>2]=e+4;r[i+40+16>>2]=-1;r[i+40+20>>2]=-1;e=r[(r[t+8>>2]|0)+24>>2]|0;e=pk[r[(r[e>>2]|0)+8>>2]&31](e,i+64|0,i+40|0,0)|0;if(e|0){s=r[t+12>>2]|0;r[i+4>>2]=0;r[i+8>>2]=i+64;r[i+12>>2]=i+40;r[i>>2]=3564;r[i+32>>2]=s;sk[r[(r[e>>2]|0)+8>>2]&31](e,i+64|0,i+40|0,(r[t+8>>2]|0)+28|0,i);ok[r[r[e>>2]>>2]&255](e);s=r[(r[t+8>>2]|0)+24>>2]|0;lk[r[(r[s>>2]|0)+60>>2]&127](s,e)}_=i;return 1}function tw(t){t=t|0;return}function ew(t){t=t|0;Ql(t);return}function iw(t,e,i){t=t|0;e=e|0;i=i|0;r[t+16>>2]=e;r[t+24>>2]=i;return}function nw(t,e,i){t=t|0;e=e|0;i=i|0;r[t+20>>2]=e;r[t+28>>2]=i;return}function sw(t,e,i,s){t=t|0;e=e|0;i=i|0;s=+s;var o=0.0,a=0.0,l=0.0,c=0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0,w=0,C=0,T=0,A=0;C=_;_=_+192|0;x=r[(r[t+4>>2]|0)+740>>2]|0;w=r[(r[t+8>>2]|0)+8>>2]|0;a=+h[i>>2];y=+h[e>>2]*s+a;l=+h[i+4>>2];v=+h[e+4>>2]*s+l;o=+h[i+8>>2];S=+h[e+8>>2]*s+o;c=r[(r[t+12>>2]|0)+8>>2]|0;u=+h[c+52>>2];d=+h[c+56>>2];if((x|0)!=(w|0)){m=S-+h[c+60>>2];a=a-+h[w+52>>2];l=l-+h[w+56>>2];o=o-+h[w+60>>2];p=(y-u)*+h[c+4>>2]+(v-d)*+h[c+20>>2]+m*+h[c+36>>2];f=(y-u)*+h[c+8>>2]+(v-d)*+h[c+24>>2]+m*+h[c+40>>2];m=(y-u)*+h[c+12>>2]+(v-d)*+h[c+28>>2]+m*+h[c+44>>2];g=a*+h[w+4>>2]+l*+h[w+20>>2]+o*+h[w+36>>2];b=a*+h[w+8>>2]+l*+h[w+24>>2]+o*+h[w+40>>2];o=a*+h[w+12>>2]+l*+h[w+28>>2]+o*+h[w+44>>2]}else{b=y-+h[x+52>>2];g=v-+h[x+56>>2];m=S-+h[x+60>>2];o=o-+h[c+60>>2];p=b*+h[x+4>>2]+g*+h[x+20>>2]+m*+h[x+36>>2];f=b*+h[x+8>>2]+g*+h[x+24>>2]+m*+h[x+40>>2];m=b*+h[x+12>>2]+g*+h[x+28>>2]+m*+h[x+44>>2];g=(a-u)*+h[c+4>>2]+(l-d)*+h[c+20>>2]+o*+h[c+36>>2];b=(a-u)*+h[c+8>>2]+(l-d)*+h[c+24>>2]+o*+h[c+40>>2];o=(a-u)*+h[c+12>>2]+(l-d)*+h[c+28>>2]+o*+h[c+44>>2]}h[C>>2]=p;h[C+4>>2]=f;h[C+8>>2]=m;h[C+12>>2]=0.0;h[C+16>>2]=g;h[C+20>>2]=b;h[C+24>>2]=o;h[C+28>>2]=0.0;r[C+64>>2]=r[e>>2];r[C+64+4>>2]=r[e+4>>2];r[C+64+8>>2]=r[e+8>>2];r[C+64+12>>2]=r[e+12>>2];h[C+80>>2]=s;h[C+84>>2]=0.0;h[C+88>>2]=0.0;h[C+92>>2]=0.0;r[C+112>>2]=0;n[C+116>>0]=0;r[C+120>>2]=0;r[C+120+4>>2]=0;r[C+120+8>>2]=0;r[C+120+12>>2]=0;r[C+120+16>>2]=0;r[C+120+20>>2]=0;r[C+120+24>>2]=0;r[C+120+28>>2]=0;h[C+48>>2]=y;h[C+52>>2]=v;h[C+56>>2]=S;h[C+60>>2]=0.0;r[C+32>>2]=r[i>>2];r[C+32+4>>2]=r[i+4>>2];r[C+32+8>>2]=r[i+8>>2];r[C+32+12>>2]=r[i+12>>2];e=r[t+20>>2]|0;c=r[t+16>>2]|0;i=r[t+28>>2]|0;A=r[t+24>>2]|0;T=(x|0)!=(w|0)?e:c;e=(x|0)!=(w|0)?c:e;c=(x|0)!=(w|0)?i:A;i=(x|0)!=(w|0)?A:i;r[C+96>>2]=T;r[C+100>>2]=e;r[C+104>>2]=c;r[C+108>>2]=i;A=r[t+32>>2]|0;+mk[r[(r[A>>2]|0)+12>>2]&1](A,C,r[((x|0)!=(w|0)?t+12|0:t+8|0)>>2]|0,T,c,r[((x|0)!=(w|0)?t+8|0:t+12|0)>>2]|0,e,i);_=C;return}function rw(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0;s=_;_=_+96|0;o=r[e+192>>2]|0;r[s+64>>2]=0;r[s+64+4>>2]=o;r[s+64+8>>2]=e;r[s+64+12>>2]=e+4;r[s+64+16>>2]=-1;r[s+64+20>>2]=-1;e=r[i+192>>2]|0;r[s+40>>2]=0;r[s+40+4>>2]=e;r[s+40+8>>2]=i;r[s+40+12>>2]=i+4;r[s+40+16>>2]=-1;r[s+40+20>>2]=-1;e=r[t+24>>2]|0;e=pk[r[(r[e>>2]|0)+8>>2]&31](e,s+64|0,s+40|0,0)|0;if(!e){_=s;return}r[s+4>>2]=0;r[s+8>>2]=s+64;r[s+12>>2]=s+40;r[s>>2]=3564;r[s+32>>2]=n;sk[r[(r[e>>2]|0)+8>>2]&31](e,s+64|0,s+40|0,t+28|0,s);ok[r[r[e>>2]>>2]&255](e);o=r[t+24>>2]|0;lk[r[(r[o>>2]|0)+60>>2]&127](o,e);_=s;return}function ow(t){t=t|0;var e=0,i=0,s=0;r[t>>2]=3592;e=r[t+12>>2]|0;if((e|0)>0){s=0;do{i=r[(r[t+20>>2]|0)+(s<<2)>>2]|0;if(i|0){ok[r[r[i>>2]>>2]&255](i);i=r[t+4>>2]|0;lk[r[(r[i>>2]|0)+60>>2]&127](i,r[(r[t+20>>2]|0)+(s<<2)>>2]|0)}s=s+1|0}while((s|0)!=(e|0))}e=r[t+20>>2]|0;if(!e){n[t+24>>0]=1;r[t+20>>2]=0;r[t+12>>2]=0;t=t+16|0;r[t>>2]=0;return}if(n[t+24>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+20>>2]=0;n[t+24>>0]=1;r[t+20>>2]=0;r[t+12>>2]=0;t=t+16|0;r[t>>2]=0;return}function aw(t){t=t|0;ow(t);Ql(t);return}function lw(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0,l=0,c=0,u=0,d=0,p=0,f=0,m=0,g=0,b=0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,W=0.0;b=_;_=_+224|0;m=(n[t+28>>0]|0)!=0;f=m?i:e;m=m?e:i;g=r[f+4>>2]|0;if((r[g+72>>2]|0)!=(r[t+40>>2]|0)){a=r[t+12>>2]|0;if((a|0)>0){c=0;do{l=r[(r[t+20>>2]|0)+(c<<2)>>2]|0;if(l|0){ok[r[r[l>>2]>>2]&255](l);d=r[t+4>>2]|0;lk[r[(r[d>>2]|0)+60>>2]&127](d,r[(r[t+20>>2]|0)+(c<<2)>>2]|0)}c=c+1|0}while((c|0)!=(a|0))}hw(t,e,i);r[t+40>>2]=r[g+72>>2]}a=r[t+12>>2]|0;if(!a){_=b;return}d=r[g+68>>2]|0;c=r[t+4>>2]|0;l=r[t+20>>2]|0;u=r[t+32>>2]|0;r[b+192>>2]=3620;r[b+192+4>>2]=f;r[b+192+8>>2]=m;r[b+192+12>>2]=c;r[b+192+16>>2]=s;r[b+192+20>>2]=o;r[b+192+24>>2]=l;r[b+192+28>>2]=u;n[b+128+16>>0]=1;u=b+128+12|0;r[u>>2]=0;r[b+128+4>>2]=0;r[b+128+8>>2]=0;if((a|0)>0){e=l;s=0;while(1){l=r[e+(s<<2)>>2]|0;if(l){lk[r[(r[l>>2]|0)+16>>2]&127](l,b+128|0);a=r[b+128+4>>2]|0;if((a|0)>0){c=0;do{i=r[(r[u>>2]|0)+(c<<2)>>2]|0;if(r[i+748>>2]|0){r[o+4>>2]=i;a=r[i+740>>2]|0;l=r[(r[o+8>>2]|0)+8>>2]|0;e=r[(r[o+12>>2]|0)+8>>2]|0;if((a|0)==(l|0))uS(i,a+4|0,e+4|0);else uS(i,e+4|0,l+4|0);r[o+4>>2]=0;a=r[b+128+4>>2]|0}c=c+1|0}while((c|0)<(a|0))}if((a|0)<0){if((r[b+128+8>>2]|0)<0){l=r[u>>2]|0;if(l|0){if(n[b+128+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0)}r[u>>2]=0}n[b+128+16>>0]=1;r[u>>2]=0;r[b+128+8>>2]=0}do{r[(r[u>>2]|0)+(a<<2)>>2]=0;a=a+1|0}while((a|0)!=0)}r[b+128+4>>2]=0;a=r[t+12>>2]|0}l=s+1|0;if((l|0)>=(a|0))break;e=r[t+20>>2]|0;s=l}a=r[u>>2]|0;if(a|0){if(n[b+128+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[u>>2]=0}}if(!d){l=r[t+12>>2]|0;if((l|0)>0){a=0;do{uw(b+192|0,r[(r[g+28>>2]|0)+(a*80|0)+64>>2]|0,a);a=a+1|0}while((a|0)<(l|0));p=39}}else{p=r[f+12>>2]|0;D=+h[p>>2];L=+h[p+16>>2];P=+h[p+32>>2];I=+h[p+4>>2];R=+h[p+20>>2];M=+h[p+36>>2];C=+h[p+8>>2];x=+h[p+24>>2];v=+h[p+40>>2];E=-+h[p+48>>2];A=-+h[p+52>>2];T=-+h[p+56>>2];p=r[m+12>>2]|0;W=+h[p>>2];z=+h[p+16>>2];V=+h[p+32>>2];U=+h[p+4>>2];N=+h[p+20>>2];B=+h[p+36>>2];F=+h[p+8>>2];O=+h[p+24>>2];k=+h[p+40>>2];w=+h[p+48>>2];S=+h[p+52>>2];y=+h[p+56>>2];h[b+48>>2]=D*W+L*z+P*V;h[b+48+4>>2]=D*U+L*N+P*B;h[b+48+8>>2]=D*F+L*O+P*k;h[b+48+12>>2]=0.0;h[b+48+16>>2]=I*W+R*z+M*V;h[b+48+20>>2]=I*U+R*N+M*B;h[b+48+24>>2]=I*F+R*O+M*k;h[b+48+28>>2]=0.0;h[b+48+32>>2]=C*W+x*z+v*V;h[b+48+36>>2]=C*U+x*N+v*B;h[b+48+40>>2]=C*F+x*O+v*k;h[b+48+44>>2]=0.0;h[b+48+48>>2]=D*E+L*A+P*T+(D*w+L*S+P*y);h[b+48+52>>2]=I*E+R*A+M*T+(I*w+R*S+M*y);h[b+48+56>>2]=C*E+x*A+v*T+(C*w+x*S+v*y);h[b+48+60>>2]=0.0;p=r[m+4>>2]|0;jk[r[(r[p>>2]|0)+8>>2]&127](p,b+48|0,b+128|0,b+112|0);r[b+16>>2]=r[b+128>>2];r[b+16+4>>2]=r[b+128+4>>2];r[b+16+8>>2]=r[b+128+8>>2];r[b+16+12>>2]=r[b+128+12>>2];r[b+16+16>>2]=r[b+112>>2];r[b+16+16+4>>2]=r[b+112+4>>2];r[b+16+16+8>>2]=r[b+112+8>>2];r[b+16+16+12>>2]=r[b+112+12>>2];JP(r[d>>2]|0,b+16|0,b+192|0);p=39}if((p|0)==39)l=r[t+12>>2]|0;if((l|0)>0){e=0;do{do{if(r[(r[t+20>>2]|0)+(e<<2)>>2]|0){d=r[g+28>>2]|0;p=r[d+(e*80|0)+64>>2]|0;o=r[f+12>>2]|0;x=+h[o>>2];w=+h[o+4>>2];C=+h[o+8>>2];T=+h[o+16>>2];A=+h[o+20>>2];E=+h[o+24>>2];k=+h[o+32>>2];F=+h[o+36>>2];N=+h[o+40>>2];M=+h[d+(e*80|0)>>2];R=+h[d+(e*80|0)+16>>2];I=+h[d+(e*80|0)+32>>2];P=+h[d+(e*80|0)+4>>2];L=+h[d+(e*80|0)+20>>2];D=+h[d+(e*80|0)+36>>2];O=+h[d+(e*80|0)+8>>2];B=+h[d+(e*80|0)+24>>2];U=+h[d+(e*80|0)+40>>2];v=+h[d+(e*80|0)+48>>2];S=+h[d+(e*80|0)+52>>2];W=+h[d+(e*80|0)+56>>2];V=+h[o+48>>2]+(x*v+w*S+C*W);z=+h[o+52>>2]+(T*v+A*S+E*W);W=+h[o+56>>2]+(k*v+F*S+N*W);h[b+128>>2]=x*M+w*R+C*I;h[b+128+4>>2]=x*P+w*L+C*D;h[b+128+8>>2]=x*O+w*B+C*U;h[b+128+12>>2]=0.0;h[b+128+16>>2]=T*M+A*R+E*I;h[b+128+20>>2]=T*P+A*L+E*D;h[b+128+24>>2]=T*O+A*B+E*U;h[b+128+28>>2]=0.0;h[b+128+32>>2]=k*M+F*R+N*I;h[b+128+36>>2]=k*P+F*L+N*D;h[b+128+40>>2]=k*O+F*B+N*U;h[b+128+44>>2]=0.0;h[b+128+48>>2]=V;h[b+128+52>>2]=z;h[b+128+56>>2]=W;h[b+128+60>>2]=0.0;jk[r[(r[p>>2]|0)+8>>2]&127](p,b+128|0,b+112|0,b+48|0);p=r[m+4>>2]|0;jk[r[(r[p>>2]|0)+8>>2]&127](p,r[m+12>>2]|0,b+16|0,b);if(!(+h[b+112>>2]>+h[b>>2])?!(+h[b+48>>2]<+h[b+16>>2]):0)a=1;else a=0;if(!(!(+h[b+112+8>>2]>+h[b+8>>2])?!(+h[b+48+8>>2]<+h[b+16+8>>2]):0))a=0;if(!(+h[b+112+4>>2]>+h[b+4>>2])?!(+h[b+48+4>>2]<+h[b+16+4>>2]|a^1):0)break;p=r[(r[t+20>>2]|0)+(e<<2)>>2]|0;ok[r[r[p>>2]>>2]&255](p);p=r[t+4>>2]|0;lk[r[(r[p>>2]|0)+60>>2]&127](p,r[(r[t+20>>2]|0)+(e<<2)>>2]|0);r[(r[t+20>>2]|0)+(e<<2)>>2]=0}}while(0);e=e+1|0}while((e|0)<(l|0))}_=b;return}function hw(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0,l=0,h=0,c=0,u=0;u=_;_=_+32|0;a=(n[t+28>>0]|0)!=0;c=a?i:e;a=a?e:i;l=r[c+4>>2]|0;h=r[l+20>>2]|0;o=r[t+12>>2]|0;if((o|0)<(h|0)){if((r[t+16>>2]|0)<(h|0)){if(!h){e=0;i=o}else{r[5637]=(r[5637]|0)+1;e=Zl((h<<2|3)+16|0)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}i=r[t+12>>2]|0}if((i|0)>0){s=0;do{r[e+(s<<2)>>2]=r[(r[t+20>>2]|0)+(s<<2)>>2];s=s+1|0}while((s|0)!=(i|0))}i=r[t+20>>2]|0;if(i|0){if(n[t+24>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[t+20>>2]=0}n[t+24>>0]=1;r[t+20>>2]=e;r[t+16>>2]=h;i=t+20|0}else i=t+20|0;e=o;do{r[(r[i>>2]|0)+(e<<2)>>2]=0;e=e+1|0}while((e|0)!=(h|0))}r[t+12>>2]=h;if((h|0)<=0){_=u;return}e=0;do{if(!(r[l+68>>2]|0)){i=r[(r[l+28>>2]|0)+(e*80|0)+64>>2]|0;s=r[c+8>>2]|0;o=r[c+12>>2]|0;r[u>>2]=c;r[u+4>>2]=i;r[u+8>>2]=s;r[u+12>>2]=o;r[u+16>>2]=-1;r[u+20>>2]=e;o=r[t+4>>2]|0;o=pk[r[(r[o>>2]|0)+8>>2]&31](o,u,a,r[t+32>>2]|0)|0;r[(r[t+20>>2]|0)+(e<<2)>>2]=o}else r[(r[t+20>>2]|0)+(e<<2)>>2]=0;e=e+1|0}while((e|0)!=(h|0));_=u;return}function cw(t){t=t|0;Ql(t);return}function _w(t,e){t=t|0;e=e|0;e=r[e+36>>2]|0;uw(t,r[(r[(r[(r[t+4>>2]|0)+4>>2]|0)+28>>2]|0)+(e*80|0)+64>>2]|0,e);return}function uw(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0;o=_;_=_+160|0;n=r[t+4>>2]|0;s=r[n+12>>2]|0;R=+h[s>>2];M=+h[s+4>>2];E=+h[s+8>>2];A=+h[s+16>>2];T=+h[s+20>>2];C=+h[s+24>>2];g=+h[s+32>>2];f=+h[s+36>>2];d=+h[s+40>>2];n=r[(r[n+4>>2]|0)+28>>2]|0;w=+h[n+(i*80|0)>>2];x=+h[n+(i*80|0)+16>>2];S=+h[n+(i*80|0)+32>>2];v=+h[n+(i*80|0)+4>>2];y=+h[n+(i*80|0)+20>>2];b=+h[n+(i*80|0)+36>>2];m=+h[n+(i*80|0)+8>>2];p=+h[n+(i*80|0)+24>>2];u=+h[n+(i*80|0)+40>>2];P=+h[n+(i*80|0)+48>>2];I=+h[n+(i*80|0)+52>>2];a=+h[n+(i*80|0)+56>>2];c=+h[s+48>>2]+(R*P+M*I+E*a);l=+h[s+52>>2]+(A*P+T*I+C*a);a=+h[s+56>>2]+(g*P+f*I+d*a);h[o+88>>2]=R*w+M*x+E*S;h[o+88+4>>2]=R*v+M*y+E*b;h[o+88+8>>2]=R*m+M*p+E*u;h[o+88+12>>2]=0.0;h[o+88+16>>2]=A*w+T*x+C*S;h[o+88+20>>2]=A*v+T*y+C*b;h[o+88+24>>2]=A*m+T*p+C*u;h[o+88+28>>2]=0.0;h[o+88+32>>2]=g*w+f*x+d*S;h[o+88+36>>2]=g*v+f*y+d*b;h[o+88+40>>2]=g*m+f*p+d*u;h[o+88+44>>2]=0.0;h[o+88+48>>2]=c;h[o+88+52>>2]=l;h[o+88+56>>2]=a;h[o+88+60>>2]=0.0;jk[r[(r[e>>2]|0)+8>>2]&127](e,o+88|0,o+72|0,o+56|0);s=r[t+8>>2]|0;n=r[s+4>>2]|0;jk[r[(r[n>>2]|0)+8>>2]&127](n,r[s+12>>2]|0,o+40|0,o+24|0);if(!(+h[o+72>>2]>+h[o+24>>2])?!(+h[o+56>>2]<+h[o+40>>2]):0)n=1;else n=0;if(!(!(+h[o+72+8>>2]>+h[o+24+8>>2])?!(+h[o+56+8>>2]<+h[o+40+8>>2]):0))n=0;if(+h[o+72+4>>2]>+h[o+24+4>>2]){_=o;return}if(+h[o+56+4>>2]<+h[o+40+4>>2]|n^1){_=o;return}n=r[t+4>>2]|0;s=r[n+8>>2]|0;r[o>>2]=n;r[o+4>>2]=e;r[o+8>>2]=s;r[o+12>>2]=o+88;r[o+16>>2]=-1;r[o+20>>2]=i;if(!(r[(r[t+24>>2]|0)+(i<<2)>>2]|0)){n=r[t+12>>2]|0;n=pk[r[(r[n>>2]|0)+8>>2]&31](n,o,r[t+8>>2]|0,r[t+28>>2]|0)|0;r[(r[t+24>>2]|0)+(i<<2)>>2]=n;n=r[t+4>>2]|0}s=r[t+20>>2]|0;e=r[s+8>>2]|0;if((r[e+8>>2]|0)==(r[n+8>>2]|0)){r[s+8>>2]=o;Vk[r[(r[s>>2]|0)+8>>2]&127](s,-1,i)}else{e=r[s+12>>2]|0;r[s+12>>2]=o;Vk[r[(r[s>>2]|0)+12>>2]&127](s,-1,i)}n=r[(r[t+24>>2]|0)+(i<<2)>>2]|0;sk[r[(r[n>>2]|0)+8>>2]&31](n,o,r[t+8>>2]|0,r[t+16>>2]|0,r[t+20>>2]|0);n=r[t+20>>2]|0;if((r[(r[n+8>>2]|0)+8>>2]|0)==(r[(r[t+4>>2]|0)+8>>2]|0))r[n+8>>2]=e;else r[n+12>>2]=e;_=o;return}function dw(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0,y=0.0,v=0.0,S=0,x=0.0,w=0,C=0,T=0,A=0,E=0,M=0,R=0.0,I=0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0;T=(n[t+28>>0]|0)!=0;M=T?i:e;T=T?e:i;A=r[t+12>>2]|0;if((A|0)<=0){x=1.0;return+x}C=(r[M+192>>2]|0)+28|0;l=+h[M+4>>2];y=+h[M+8>>2];v=+h[M+12>>2];S=r[M+16>>2]|0;x=+h[M+20>>2];c=+h[M+24>>2];_=+h[M+28>>2];e=r[M+32>>2]|0;u=+h[M+36>>2];d=+h[M+40>>2];p=+h[M+44>>2];i=r[M+48>>2]|0;f=+h[M+52>>2];m=+h[M+56>>2];g=+h[M+60>>2];b=r[M+64>>2]|0;w=r[M+284>>2]|0;a=1.0;E=0;do{I=r[C>>2]|0;z=+h[I+(E*80|0)>>2];V=+h[I+(E*80|0)+16>>2];U=+h[I+(E*80|0)+32>>2];N=+h[I+(E*80|0)+4>>2];B=+h[I+(E*80|0)+20>>2];F=+h[I+(E*80|0)+36>>2];O=+h[I+(E*80|0)+8>>2];k=+h[I+(E*80|0)+24>>2];D=+h[I+(E*80|0)+40>>2];L=+h[I+(E*80|0)+48>>2];P=+h[I+(E*80|0)+52>>2];R=+h[I+(E*80|0)+56>>2];r[M+284>>2]=w+1;h[M+4>>2]=l*z+y*V+v*U;h[M+8>>2]=l*N+y*B+v*F;h[M+12>>2]=l*O+y*k+v*D;h[M+16>>2]=0.0;h[M+20>>2]=x*z+c*V+_*U;h[M+24>>2]=x*N+c*B+_*F;h[M+28>>2]=x*O+c*k+_*D;h[M+32>>2]=0.0;h[M+36>>2]=u*z+d*V+p*U;h[M+40>>2]=u*N+d*B+p*F;h[M+44>>2]=u*O+d*k+p*D;h[M+48>>2]=0.0;h[M+52>>2]=f+(l*L+y*P+v*R);h[M+56>>2]=m+(x*L+c*P+_*R);h[M+60>>2]=g+(u*L+d*P+p*R);h[M+64>>2]=0.0;I=r[(r[t+20>>2]|0)+(E<<2)>>2]|0;R=+bk[r[(r[I>>2]|0)+12>>2]&15](I,M,T,s,o);a=R<a?R:a;w=(r[M+284>>2]|0)+1|0;r[M+284>>2]=w;h[M+4>>2]=l;h[M+8>>2]=y;h[M+12>>2]=v;r[M+16>>2]=S;h[M+20>>2]=x;h[M+24>>2]=c;h[M+28>>2]=_;r[M+32>>2]=e;h[M+36>>2]=u;h[M+40>>2]=d;h[M+44>>2]=p;r[M+48>>2]=i;h[M+52>>2]=f;h[M+56>>2]=m;h[M+60>>2]=g;r[M+64>>2]=b;E=E+1|0}while((E|0)!=(A|0));return+a}function pw(t,e){t=t|0;e=e|0;var i=0,n=0,s=0;i=r[t+12>>2]|0;if((i|0)<=0)return;s=0;do{n=r[(r[t+20>>2]|0)+(s<<2)>>2]|0;if(n){lk[r[(r[n>>2]|0)+16>>2]&127](n,e);i=r[t+12>>2]|0}s=s+1|0}while((s|0)<(i|0));return}function fw(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;r[t+4>>2]=r[e>>2];r[t>>2]=3592;n[t+24>>0]=1;r[t+20>>2]=0;r[t+12>>2]=0;r[t+16>>2]=0;n[t+28>>0]=o&1;r[t+32>>2]=r[e+4>>2];n[t+36>>0]=0;r[t+40>>2]=r[(r[(o?s:i)+4>>2]|0)+72>>2];hw(t,i,s);return}function mw(t){t=t|0;var e=0,i=0,s=0,o=0,a=0;r[t>>2]=3656;e=r[t+44>>2]|0;i=r[e+8>>2]|0;if((i|0)>0){o=0;do{s=r[(r[e+16>>2]|0)+(o*12|0)+8>>2]|0;if(s|0){ok[r[r[s>>2]>>2]&255](s);a=r[t+4>>2]|0;lk[r[(r[a>>2]|0)+60>>2]&127](a,s)}o=o+1|0}while((o|0)!=(i|0));e=r[t+44>>2]|0}BR(e);e=r[t+44>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+44>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+60>>2]|0;if(!e){n[t+64>>0]=1;r[t+60>>2]=0;r[t+52>>2]=0;a=t+56|0;r[a>>2]=0;ow(t);return}if(n[t+64>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+60>>2]=0;n[t+64>>0]=1;r[t+60>>2]=0;r[t+52>>2]=0;a=t+56|0;r[a>>2]=0;ow(t);return}function gw(t){t=t|0;mw(t);Ql(t);return}function bw(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0,l=0,c=0,u=0,d=0,p=0,f=0,m=0,g=0,b=0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,G=0.0,j=0.0,H=0.0,X=0.0,Y=0.0,q=0.0,K=0.0,Z=0.0,Q=0.0,$=0.0,J=0,tt=0,et=0,it=0,nt=0,st=0,rt=0.0,ot=0.0,at=0.0,lt=0.0,ht=0.0,ct=0.0,_t=0.0,ut=0.0,dt=0.0,pt=0.0,ft=0.0;st=_;_=_+176|0;et=r[e+4>>2]|0;it=r[i+4>>2]|0;g=r[et+68>>2]|0;b=r[it+68>>2]|0;if(!((g|0)!=0&(b|0)!=0)){lw(t,e,i,s,o);_=st;return}if((r[et+72>>2]|0)==(r[t+68>>2]|0)?(r[it+72>>2]|0)==(r[t+72>>2]|0):0)tt=t+44|0;else{a=r[t+44>>2]|0;l=r[a+8>>2]|0;if((l|0)>0){u=0;do{c=r[(r[a+16>>2]|0)+(u*12|0)+8>>2]|0;if(c|0){ok[r[r[c>>2]>>2]&255](c);tt=r[t+4>>2]|0;lk[r[(r[tt>>2]|0)+60>>2]&127](tt,c)}u=u+1|0}while((u|0)!=(l|0));a=r[t+44>>2]|0}BR(a);r[t+68>>2]=r[et+72>>2];r[t+72>>2]=r[it+72>>2];tt=t+44|0}n[st+128+16>>0]=1;m=st+128+12|0;r[m>>2]=0;r[st+128+4>>2]=0;r[st+128+8>>2]=0;f=r[tt>>2]|0;a=r[f+8>>2]|0;if((a|0)>0){p=0;do{l=r[(r[f+16>>2]|0)+(p*12|0)+8>>2]|0;if(l){lk[r[(r[l>>2]|0)+16>>2]&127](l,st+128|0);a=r[st+128+4>>2]|0;if((a|0)>0){d=0;do{u=r[(r[m>>2]|0)+(d<<2)>>2]|0;if(r[u+748>>2]|0){r[o+4>>2]=u;a=r[u+740>>2]|0;l=r[(r[o+8>>2]|0)+8>>2]|0;c=r[(r[o+12>>2]|0)+8>>2]|0;if((a|0)==(l|0))uS(u,a+4|0,c+4|0);else uS(u,c+4|0,l+4|0);r[o+4>>2]=0;a=r[st+128+4>>2]|0}d=d+1|0}while((d|0)<(a|0))}if((a|0)<0){if((r[st+128+8>>2]|0)<0){l=r[m>>2]|0;if(l|0){if(n[st+128+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0)}r[m>>2]=0}n[st+128+16>>0]=1;r[m>>2]=0;r[st+128+8>>2]=0}do{r[(r[m>>2]|0)+(a<<2)>>2]=0;a=a+1|0}while((a|0)!=0)}r[st+128+4>>2]=0;a=r[f+8>>2]|0}p=p+1|0}while((p|0)<(a|0));a=r[m>>2]|0;if(a|0){if(n[st+128+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[m>>2]=0}}m=r[t+4>>2]|0;l=r[tt>>2]|0;c=r[t+32>>2]|0;r[st+128>>2]=3684;r[st+128+4>>2]=0;r[st+128+8>>2]=e;r[st+128+12>>2]=i;r[st+128+16>>2]=m;r[st+128+20>>2]=s;r[st+128+24>>2]=o;r[st+128+28>>2]=l;r[st+128+32>>2]=c;c=r[e+12>>2]|0;M=+h[c>>2];R=+h[c+16>>2];I=+h[c+32>>2];P=+h[c+4>>2];L=+h[c+20>>2];D=+h[c+36>>2];k=+h[c+8>>2];O=+h[c+24>>2];F=+h[c+40>>2];B=-+h[c+48>>2];N=-+h[c+52>>2];U=-+h[c+56>>2];c=r[i+12>>2]|0;V=+h[c>>2];z=+h[c+16>>2];G=+h[c+32>>2];j=+h[c+4>>2];H=+h[c+20>>2];X=+h[c+36>>2];Y=+h[c+8>>2];q=+h[c+24>>2];K=+h[c+40>>2];Z=+h[c+48>>2];Q=+h[c+52>>2];$=+h[c+56>>2];c=r[g>>2]|0;l=r[b>>2]|0;if((c|0)!=0&(l|0)!=0){r[5637]=(r[5637]|0)+1;a=Zl(1043)|0;if(!a)a=0;else{r[(a+4+15&-16)+-4>>2]=a;a=a+4+15&-16}r[a>>2]=c;r[a+4>>2]=l;y=+W(+(M*V+R*z+I*G));v=+W(+(M*j+R*H+I*X));S=+W(+(M*Y+R*q+I*K));x=+W(+(P*V+L*z+D*G));w=+W(+(P*j+L*H+D*X));C=+W(+(P*Y+L*q+D*K));T=+W(+(k*V+O*z+F*G));A=+W(+(k*j+O*H+F*X));E=+W(+(k*Y+O*q+F*K));g=1;c=128;u=128;l=124;while(1){m=g+-1|0;s=r[a+(m<<3)>>2]|0;o=r[a+(m<<3)+4>>2]|0;ft=+h[o+16>>2];pt=+h[o>>2];dt=+h[o+20>>2];ut=+h[o+4>>2];_t=+h[o+24>>2];rt=+h[o+8>>2];ct=M*B+R*N+I*U+(M*Z+R*Q+I*$)+((M*V+R*z+I*G)*((ft+pt)*.5)+(M*j+R*H+I*X)*((dt+ut)*.5)+(M*Y+R*q+I*K)*((_t+rt)*.5));lt=P*B+L*N+D*U+(P*Z+L*Q+D*$)+((P*V+L*z+D*G)*((ft+pt)*.5)+(P*j+L*H+D*X)*((dt+ut)*.5)+(P*Y+L*q+D*K)*((_t+rt)*.5));ot=k*B+O*N+F*U+(k*Z+O*Q+F*$)+((k*V+O*z+F*G)*((ft+pt)*.5)+(k*j+O*H+F*X)*((dt+ut)*.5)+(k*Y+O*q+F*K)*((_t+rt)*.5));ht=((ft-pt)*.5+0.0)*y+((dt-ut)*.5+0.0)*v+((_t-rt)*.5+0.0)*S;at=((ft-pt)*.5+0.0)*x+((dt-ut)*.5+0.0)*w+((_t-rt)*.5+0.0)*C;rt=((ft-pt)*.5+0.0)*T+((dt-ut)*.5+0.0)*A+((_t-rt)*.5+0.0)*E;do{if(((((+h[s>>2]<=ht+ct?+h[s+16>>2]>=ct-ht:0)?+h[s+4>>2]<=lt+at:0)?+h[s+20>>2]>=lt-at:0)?+h[s+8>>2]<=ot+rt:0)?+h[s+24>>2]>=ot-rt:0){if((m|0)>(l|0)){d=u<<1;do{if((u|0)<(d|0)&(c|0)<(d|0)){do{if(!u){l=0;J=54}else{r[5637]=(r[5637]|0)+1;l=Zl((u<<4|3)+16|0)|0;if(!l)l=0;else{r[(l+4+15&-16)+-4>>2]=l;l=l+4+15&-16}if((u|0)>0)c=0;else{J=54;break}do{p=a+(c<<3)|0;f=r[p+4>>2]|0;b=l+(c<<3)|0;r[b>>2]=r[p>>2];r[b+4>>2]=f;c=c+1|0}while((c|0)!=(u|0))}}while(0);if((J|0)==54){J=0;if(!a){c=d;a=l;break}}r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0);c=d;a=l}}while(0);f=d;l=d+-4|0}else f=u;u=(r[o+40>>2]|0)!=0;if(!(r[s+40>>2]|0))if(u){d=r[o+36>>2]|0;r[a+(m<<3)>>2]=s;r[a+(m<<3)+4>>2]=d;d=r[o+40>>2]|0;r[a+(g<<3)>>2]=s;r[a+(g<<3)+4>>2]=d;d=g+1|0;u=f;break}else{Vk[r[(r[st+128>>2]|0)+8>>2]&127](st+128|0,s,o);d=m;u=f;break}else{d=a+(m<<3)|0;p=r[s+36>>2]|0;if(u){u=r[o+36>>2]|0;r[d>>2]=p;r[a+(m<<3)+4>>2]=u;u=g+1|0;d=r[o+36>>2]|0;r[a+(g<<3)>>2]=r[s+40>>2];r[a+(g<<3)+4>>2]=d;d=g+2|0;b=r[o+40>>2]|0;r[a+(u<<3)>>2]=r[s+36>>2];r[a+(u<<3)+4>>2]=b;u=r[o+40>>2]|0;r[a+(d<<3)>>2]=r[s+40>>2];r[a+(d<<3)+4>>2]=u;d=g+3|0;u=f;break}else{r[d>>2]=p;r[a+(m<<3)+4>>2]=o;r[a+(g<<3)>>2]=r[s+40>>2];r[a+(g<<3)+4>>2]=o;d=g+1|0;u=f;break}}}else d=m}while(0);if(!d)break;else g=d}if(a|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}}p=r[tt>>2]|0;if((r[p+8>>2]|0)>0){f=0;do{a=r[p+16>>2]|0;l=r[a+(f*12|0)+8>>2]|0;do{if(l|0){J=r[a+(f*12|0)>>2]|0;b=r[et+28>>2]|0;g=r[b+(J*80|0)+64>>2]|0;o=r[e+12>>2]|0;ft=+h[o>>2];z=+h[o+4>>2];V=+h[o+8>>2];ut=+h[o+16>>2];ct=+h[o+20>>2];lt=+h[o+24>>2];_t=+h[o+32>>2];at=+h[o+36>>2];Y=+h[o+40>>2];ot=+h[b+(J*80|0)>>2];rt=+h[b+(J*80|0)+16>>2];$=+h[b+(J*80|0)+32>>2];Q=+h[b+(J*80|0)+4>>2];Z=+h[b+(J*80|0)+20>>2];K=+h[b+(J*80|0)+36>>2];ht=+h[b+(J*80|0)+8>>2];q=+h[b+(J*80|0)+24>>2];X=+h[b+(J*80|0)+40>>2];pt=+h[b+(J*80|0)+48>>2];dt=+h[b+(J*80|0)+52>>2];G=+h[b+(J*80|0)+56>>2];H=+h[o+48>>2]+(ft*pt+z*dt+V*G);j=+h[o+52>>2]+(ut*pt+ct*dt+lt*G);G=+h[o+56>>2]+(_t*pt+at*dt+Y*G);h[st>>2]=ft*ot+z*rt+V*$;h[st+4>>2]=ft*Q+z*Z+V*K;h[st+8>>2]=ft*ht+z*q+V*X;h[st+12>>2]=0.0;h[st+16>>2]=ut*ot+ct*rt+lt*$;h[st+20>>2]=ut*Q+ct*Z+lt*K;h[st+24>>2]=ut*ht+ct*q+lt*X;h[st+28>>2]=0.0;h[st+32>>2]=_t*ot+at*rt+Y*$;h[st+36>>2]=_t*Q+at*Z+Y*K;h[st+40>>2]=_t*ht+at*q+Y*X;h[st+44>>2]=0.0;h[st+48>>2]=H;h[st+52>>2]=j;h[st+56>>2]=G;h[st+60>>2]=0.0;jk[r[(r[g>>2]|0)+8>>2]&127](g,st,st+112|0,st+96|0);g=r[(r[p+16>>2]|0)+(f*12|0)+4>>2]|0;o=r[it+28>>2]|0;J=r[o+(g*80|0)+64>>2]|0;b=r[i+12>>2]|0;G=+h[b>>2];j=+h[b+4>>2];H=+h[b+8>>2];X=+h[b+16>>2];Y=+h[b+20>>2];q=+h[b+24>>2];at=+h[b+32>>2];ht=+h[b+36>>2];_t=+h[b+40>>2];K=+h[o+(g*80|0)>>2];Z=+h[o+(g*80|0)+16>>2];Q=+h[o+(g*80|0)+32>>2];$=+h[o+(g*80|0)+4>>2];rt=+h[o+(g*80|0)+20>>2];ot=+h[o+(g*80|0)+36>>2];lt=+h[o+(g*80|0)+8>>2];ct=+h[o+(g*80|0)+24>>2];ut=+h[o+(g*80|0)+40>>2];V=+h[o+(g*80|0)+48>>2];z=+h[o+(g*80|0)+52>>2];ft=+h[o+(g*80|0)+56>>2];dt=+h[b+48>>2]+(G*V+j*z+H*ft);pt=+h[b+52>>2]+(X*V+Y*z+q*ft);ft=+h[b+56>>2]+(at*V+ht*z+_t*ft);h[st>>2]=G*K+j*Z+H*Q;h[st+4>>2]=G*$+j*rt+H*ot;h[st+8>>2]=G*lt+j*ct+H*ut;h[st+12>>2]=0.0;h[st+16>>2]=X*K+Y*Z+q*Q;h[st+20>>2]=X*$+Y*rt+q*ot;h[st+24>>2]=X*lt+Y*ct+q*ut;h[st+28>>2]=0.0;h[st+32>>2]=at*K+ht*Z+_t*Q;h[st+36>>2]=at*$+ht*rt+_t*ot;h[st+40>>2]=at*lt+ht*ct+_t*ut;h[st+44>>2]=0.0;h[st+48>>2]=dt;h[st+52>>2]=pt;h[st+56>>2]=ft;h[st+60>>2]=0.0;jk[r[(r[J>>2]|0)+8>>2]&127](J,st,st+80|0,st+64|0);if(!(+h[st+112>>2]>+h[st+64>>2])?!(+h[st+96>>2]<+h[st+80>>2]):0)a=1;else a=0;if(!(!(+h[st+112+8>>2]>+h[st+64+8>>2])?!(+h[st+96+8>>2]<+h[st+80+8>>2]):0))a=0;if(!(+h[st+112+4>>2]>+h[st+64+4>>2])?!(+h[st+96+4>>2]<+h[st+80+4>>2]|a^1):0)break;ok[r[r[l>>2]>>2]&255](l);d=r[t+4>>2]|0;lk[r[(r[d>>2]|0)+60>>2]&127](d,l);d=r[p+16>>2]|0;u=r[d+(f*12|0)>>2]|0;d=r[d+(f*12|0)+4>>2]|0;a=r[t+52>>2]|0;if((a|0)==(r[t+56>>2]|0)?(nt=a|0?a<<1:1,(a|0)<(nt|0)):0){if(!nt)c=0;else{r[5637]=(r[5637]|0)+1;a=Zl((nt*12|3)+16|0)|0;if(!a)a=0;else{r[(a+4+15&-16)+-4>>2]=a;a=a+4+15&-16}c=a;a=r[t+52>>2]|0}if((a|0)>0){l=0;do{J=c+(l*12|0)|0;b=(r[t+60>>2]|0)+(l*12|0)|0;r[J>>2]=r[b>>2];r[J+4>>2]=r[b+4>>2];r[J+8>>2]=r[b+8>>2];l=l+1|0}while((l|0)!=(a|0))}a=r[t+60>>2]|0;if(a|0){if(n[t+64>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+60>>2]=0}n[t+64>>0]=1;r[t+60>>2]=c;r[t+56>>2]=nt;a=r[t+52>>2]|0}J=r[t+60>>2]|0;r[J+(a*12|0)>>2]=u;r[J+(a*12|0)+4>>2]=d;r[J+(a*12|0)+8>>2]=0;r[t+52>>2]=(r[t+52>>2]|0)+1}}while(0);f=f+1|0}while((f|0)<(r[p+8>>2]|0));l=t+60|0;c=t+52|0}else{l=t+60|0;c=t+52|0}if((r[c>>2]|0)>0){a=0;do{e=r[tt>>2]|0;i=r[l>>2]|0;yk[r[(r[e>>2]|0)+8>>2]&63](e,r[i+(a*12|0)>>2]|0,r[i+(a*12|0)+4>>2]|0)|0;a=a+1|0}while((a|0)<(r[c>>2]|0))}a=r[l>>2]|0;if(a|0){if(n[t+64>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[l>>2]=0}n[t+64>>0]=1;r[l>>2]=0;r[c>>2]=0;r[t+56>>2]=0;_=st;return}function yw(t){t=t|0;Ql(t);return}function vw(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0;u=_;_=_+240|0;r[t+4>>2]=(r[t+4>>2]|0)+1;l=r[e+36>>2]|0;a=r[i+36>>2]|0;s=r[t+8>>2]|0;F=r[(r[s+4>>2]|0)+28>>2]|0;i=r[F+(l*80|0)+64>>2]|0;e=(r[(r[t+12>>2]|0)+4>>2]|0)+28|0;n=r[(r[e>>2]|0)+(a*80|0)+64>>2]|0;s=r[s+12>>2]|0;d=+h[s>>2];k=+h[s+4>>2];O=+h[s+8>>2];m=+h[s+16>>2];b=+h[s+20>>2];v=+h[s+24>>2];g=+h[s+32>>2];S=+h[s+36>>2];R=+h[s+40>>2];x=+h[F+(l*80|0)>>2];w=+h[F+(l*80|0)+16>>2];C=+h[F+(l*80|0)+32>>2];T=+h[F+(l*80|0)+4>>2];A=+h[F+(l*80|0)+20>>2];E=+h[F+(l*80|0)+36>>2];y=+h[F+(l*80|0)+8>>2];M=+h[F+(l*80|0)+24>>2];I=+h[F+(l*80|0)+40>>2];p=+h[F+(l*80|0)+48>>2];f=+h[F+(l*80|0)+52>>2];D=+h[F+(l*80|0)+56>>2];P=+h[s+48>>2]+(d*p+k*f+O*D);L=+h[s+52>>2]+(m*p+b*f+v*D);D=+h[s+56>>2]+(g*p+S*f+R*D);h[u+176>>2]=d*x+k*w+O*C;h[u+176+4>>2]=d*T+k*A+O*E;h[u+176+8>>2]=d*y+k*M+O*I;h[u+176+12>>2]=0.0;h[u+176+16>>2]=m*x+b*w+v*C;h[u+176+20>>2]=m*T+b*A+v*E;h[u+176+24>>2]=m*y+b*M+v*I;h[u+176+28>>2]=0.0;h[u+176+32>>2]=g*x+S*w+R*C;h[u+176+36>>2]=g*T+S*A+R*E;h[u+176+40>>2]=g*y+S*M+R*I;h[u+176+44>>2]=0.0;h[u+176+48>>2]=P;h[u+176+52>>2]=L;h[u+176+56>>2]=D;h[u+176+60>>2]=0.0;s=r[(r[t+12>>2]|0)+12>>2]|0;D=+h[s>>2];L=+h[s+4>>2];P=+h[s+8>>2];I=+h[s+16>>2];R=+h[s+20>>2];M=+h[s+24>>2];S=+h[s+32>>2];y=+h[s+36>>2];g=+h[s+40>>2];e=r[e>>2]|0;E=+h[e+(a*80|0)>>2];A=+h[e+(a*80|0)+16>>2];T=+h[e+(a*80|0)+32>>2];C=+h[e+(a*80|0)+4>>2];w=+h[e+(a*80|0)+20>>2];x=+h[e+(a*80|0)+36>>2];v=+h[e+(a*80|0)+8>>2];b=+h[e+(a*80|0)+24>>2];m=+h[e+(a*80|0)+40>>2];O=+h[e+(a*80|0)+48>>2];k=+h[e+(a*80|0)+52>>2];d=+h[e+(a*80|0)+56>>2];f=+h[s+48>>2]+(D*O+L*k+P*d);p=+h[s+52>>2]+(I*O+R*k+M*d);d=+h[s+56>>2]+(S*O+y*k+g*d);h[u+112>>2]=D*E+L*A+P*T;h[u+112+4>>2]=D*C+L*w+P*x;h[u+112+8>>2]=D*v+L*b+P*m;h[u+112+12>>2]=0.0;h[u+112+16>>2]=I*E+R*A+M*T;h[u+112+20>>2]=I*C+R*w+M*x;h[u+112+24>>2]=I*v+R*b+M*m;h[u+112+28>>2]=0.0;h[u+112+32>>2]=S*E+y*A+g*T;h[u+112+36>>2]=S*C+y*w+g*x;h[u+112+40>>2]=S*v+y*b+g*m;h[u+112+44>>2]=0.0;h[u+112+48>>2]=f;h[u+112+52>>2]=p;h[u+112+56>>2]=d;h[u+112+60>>2]=0.0;jk[r[(r[i>>2]|0)+8>>2]&127](i,u+176|0,u+96|0,u+80|0);jk[r[(r[n>>2]|0)+8>>2]&127](n,u+112|0,u+64|0,u+48|0);if(!(+h[u+96>>2]>+h[u+48>>2])?!(+h[u+80>>2]<+h[u+64>>2]):0)e=1;else e=0;if(!(!(+h[u+96+8>>2]>+h[u+48+8>>2])?!(+h[u+80+8>>2]<+h[u+64+8>>2]):0))e=0;if(+h[u+96+4>>2]>+h[u+48+4>>2]){_=u;return}if(+h[u+80+4>>2]<+h[u+64+4>>2]|e^1){_=u;return}s=r[t+8>>2]|0;e=r[s+8>>2]|0;r[u+24>>2]=s;r[u+24+4>>2]=i;r[u+24+8>>2]=e;r[u+24+12>>2]=u+176;r[u+24+16>>2]=-1;r[u+24+20>>2]=l;e=r[t+12>>2]|0;s=r[e+8>>2]|0;r[u>>2]=e;r[u+4>>2]=n;r[u+8>>2]=s;r[u+12>>2]=u+112;r[u+16>>2]=-1;r[u+20>>2]=a;s=r[t+28>>2]|0;r[4992]=(r[4992]|0)+1;e=((a<<16|l)+~((a<<16|l)<<15)>>10^(a<<16|l)+~((a<<16|l)<<15))*9|0;e=(r[s+12>>2]|0)+-1&((e>>6^e)+~((e>>6^e)<<11)>>16^(e>>6^e)+~((e>>6^e)<<11));t:do{if((e|0)<(r[s+28>>2]|0)?(o=r[(r[s+36>>2]|0)+(e<<2)>>2]|0,(o|0)!=-1):0){n=r[s+16>>2]|0;e=o;while(1){i=n+(e*12|0)|0;if((r[i>>2]|0)==(l|0)?(r[n+(e*12|0)+4>>2]|0)==(a|0):0)break;e=r[(r[s+56>>2]|0)+(e<<2)>>2]|0;if((e|0)==-1){c=16;break t}}if(i)e=r[n+(e*12|0)+8>>2]|0;else c=16}else c=16}while(0);if((c|0)==16){e=r[t+16>>2]|0;e=pk[r[(r[e>>2]|0)+8>>2]&31](e,u+24|0,u,r[t+32>>2]|0)|0;F=r[t+28>>2]|0;r[(yk[r[(r[F>>2]|0)+12>>2]&63](F,l,a)|0)+8>>2]=e}F=r[t+24>>2]|0;o=r[F+8>>2]|0;c=r[F+12>>2]|0;r[F+8>>2]=u+24;r[F+12>>2]=u;Vk[r[(r[F>>2]|0)+8>>2]&127](F,-1,l);F=r[t+24>>2]|0;Vk[r[(r[F>>2]|0)+12>>2]&127](F,-1,a);sk[r[(r[e>>2]|0)+8>>2]&31](e,u+24|0,u,r[t+20>>2]|0,r[t+24>>2]|0);F=r[t+24>>2]|0;r[F+8>>2]=o;r[F+12>>2]=c;_=u;return}function Sw(t,e){t=t|0;e=e|0;return}function xw(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;return 0.0}function ww(t,e){t=t|0;e=e|0;var i=0,n=0,s=0;s=r[t+44>>2]|0;t=r[s+8>>2]|0;if((t|0)<=0)return;n=0;do{i=r[(r[s+16>>2]|0)+(n*12|0)+8>>2]|0;if(i){lk[r[(r[i>>2]|0)+16>>2]&127](i,e);t=r[s+8>>2]|0}n=n+1|0}while((n|0)<(t|0));return}function Cw(t){t=t|0;var e=0;r[t>>2]=3720;r[t+12>>2]=3748;e=r[t+60>>2]|0;lk[r[(r[e>>2]|0)+20>>2]&127](e,r[t+76>>2]|0);e=r[t+60>>2]|0;lk[r[(r[e>>2]|0)+16>>2]&127](e,r[t+76>>2]|0);return}function Tw(t){t=t|0;var e=0;r[t>>2]=3748;e=r[t+48>>2]|0;lk[r[(r[e>>2]|0)+20>>2]&127](e,r[t+64>>2]|0);e=r[t+48>>2]|0;lk[r[(r[e>>2]|0)+16>>2]&127](e,r[t+64>>2]|0);return}function Aw(t){t=t|0;var e=0;r[t>>2]=3748;e=r[t+48>>2]|0;lk[r[(r[e>>2]|0)+20>>2]&127](e,r[t+64>>2]|0);e=r[t+48>>2]|0;lk[r[(r[e>>2]|0)+16>>2]&127](e,r[t+64>>2]|0);Ql(t);return}function Ew(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0.0,a=0.0,l=0.0,c=0,u=0,d=0,p=0,f=0.0,m=0;p=_;_=_+144|0;o=+h[e>>2];a=+h[e+16>>2];f=o<a?o:a;l=+h[e+32>>2];if((f<l?f:l)>+h[t+28>>2]){_=p;return}u=o>a?e:e+16|0;if(+h[(+h[u>>2]>l?u:e+32|0)>>2]<+h[t+12>>2]){_=p;return}o=+h[e+8>>2];a=+h[e+24>>2];f=o<a?o:a;l=+h[e+40>>2];if((f<l?f:l)>+h[t+36>>2]){_=p;return}u=o>a?e+8|0:e+24|0;if(+h[(+h[u>>2]>l?u:e+40|0)>>2]<+h[t+20>>2]){_=p;return}o=+h[e+4>>2];a=+h[e+20>>2];f=o<a?o:a;l=+h[e+36>>2];if((f<l?f:l)>+h[t+32>>2]){_=p;return}u=o>a?e+4|0:e+20|0;if(+h[(+h[u>>2]>l?u:e+36|0)>>2]<+h[t+16>>2]){_=p;return}u=r[t+48>>2]|0;s=r[t+4>>2]|0;if((r[(r[s+4>>2]|0)+4>>2]|0)>=20){_=p;return}r[p+24+8>>2]=0;r[p+24+12>>2]=-1;r[p+24+16>>2]=1065353216;r[p+24+20>>2]=1065353216;r[p+24+24>>2]=1065353216;h[p+24+28>>2]=0.0;r[p+24+56>>2]=0;r[p+24>>2]=3768;r[p+24+4>>2]=1;r[p+24+60>>2]=r[e>>2];r[p+24+60+4>>2]=r[e+4>>2];r[p+24+60+8>>2]=r[e+8>>2];r[p+24+60+12>>2]=r[e+12>>2];r[p+24+76>>2]=r[e+16>>2];r[p+24+76+4>>2]=r[e+16+4>>2];r[p+24+76+8>>2]=r[e+16+8>>2];r[p+24+76+12>>2]=r[e+16+12>>2];r[p+24+92>>2]=r[e+32>>2];r[p+24+92+4>>2]=r[e+32+4>>2];r[p+24+92+8>>2]=r[e+32+8>>2];r[p+24+92+12>>2]=r[e+32+12>>2];r[p+24+48>>2]=r[t+56>>2];m=r[t+8>>2]|0;e=r[m+8>>2]|0;c=r[m+12>>2]|0;r[p>>2]=m;r[p+4>>2]=p+24;r[p+8>>2]=e;r[p+12>>2]=c;r[p+16>>2]=i;r[p+20>>2]=n;c=pk[r[(r[u>>2]|0)+8>>2]&31](u,s,p,r[t+64>>2]|0)|0;s=r[t+44>>2]|0;e=r[s+8>>2]|0;if((r[e+8>>2]|0)==(r[(r[t+8>>2]|0)+8>>2]|0)){r[s+8>>2]=p;Vk[r[(r[s>>2]|0)+8>>2]&127](s,i,n)}else{e=r[s+12>>2]|0;r[s+12>>2]=p;Vk[r[(r[s>>2]|0)+12>>2]&127](s,i,n)}sk[r[(r[c>>2]|0)+8>>2]&31](c,r[t+4>>2]|0,p,r[t+52>>2]|0,r[t+44>>2]|0);s=r[t+44>>2]|0;if((r[(r[s+8>>2]|0)+8>>2]|0)==(r[(r[t+8>>2]|0)+8>>2]|0))r[s+8>>2]=e;else r[s+12>>2]=e;ok[r[r[c>>2]>>2]&255](c);lk[r[(r[u>>2]|0)+60>>2]&127](u,c);r[p+24>>2]=6248;s=r[p+24+56>>2]|0;if(s|0?(ok[r[r[s>>2]>>2]&255](s),d=r[p+24+56>>2]|0,d|0):0){r[5638]=(r[5638]|0)+1;Ql(r[d+-4>>2]|0)}_=p;return}function Mw(t){t=t|0;var e=0,i=0;r[t>>2]=6248;e=r[t+56>>2]|0;if(e|0?(ok[r[r[e>>2]>>2]&255](e),i=r[t+56>>2]|0,i|0):0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function Rw(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;jk[r[(r[t>>2]|0)+80>>2]&127](t,e,i,n);return}function Iw(t){t=t|0;return t+16|0}function Pw(t,e,i){t=t|0;e=+e;i=i|0;r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;r[i+12>>2]=0;return}function Lw(t){t=t|0;return 11211}function Dw(t,e){t=t|0;e=e|0;r[t>>2]=1065353216;r[t+4>>2]=1065353216;r[t+8>>2]=1065353216;h[t+12>>2]=0.0;return}function kw(t,e){t=t|0;e=+e;h[t+48>>2]=e;return}function Ow(t){t=t|0;return+ +h[t+48>>2]}function Fw(t){t=t|0;return 52}function Bw(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0;n=Rk[r[(r[i>>2]|0)+40>>2]&31](i,t)|0;s=Rk[r[(r[i>>2]|0)+28>>2]&31](i,n)|0;r[e>>2]=s;if(s|0)lk[r[(r[i>>2]|0)+48>>2]&127](i,n);r[e+4>>2]=r[t+4>>2];r[e+28>>2]=r[t+32>>2];r[e+32>>2]=r[t+36>>2];r[e+36>>2]=r[t+40>>2];r[e+40>>2]=r[t+44>>2];r[e+12>>2]=r[t+16>>2];r[e+16>>2]=r[t+20>>2];r[e+20>>2]=r[t+24>>2];r[e+24>>2]=r[t+28>>2];r[e+44>>2]=r[t+48>>2];return 11220}function Nw(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0;l=+h[i>>2];a=+h[i+4>>2];n=+h[i+8>>2];s=l*+h[e+60>>2]+a*+h[e+64>>2]+n*+h[e+68>>2];o=l*+h[e+76>>2]+a*+h[e+80>>2]+n*+h[e+84>>2];n=l*+h[e+92>>2]+a*+h[e+96>>2]+n*+h[e+100>>2];e=e+60+((s<o?o<n?2:1:s<n?2:0)<<4)|0;r[t>>2]=r[e>>2];r[t+4>>2]=r[e+4>>2];r[t+8>>2]=r[e+8>>2];r[t+12>>2]=r[e+12>>2];return}function Uw(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0,a=0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0;if((n|0)<=0)return;s=0;do{d=+h[e+(s<<4)>>2];u=+h[e+(s<<4)+4>>2];l=+h[e+(s<<4)+8>>2];c=d*+h[t+60>>2]+u*+h[t+64>>2]+l*+h[t+68>>2];_=d*+h[t+76>>2]+u*+h[t+80>>2]+l*+h[t+84>>2];l=d*+h[t+92>>2]+u*+h[t+96>>2]+l*+h[t+100>>2];o=i+(s<<4)|0;a=t+60+((c<_?_<l?2:1:c<l?2:0)<<4)|0;r[o>>2]=r[a>>2];r[o+4>>2]=r[a+4>>2];r[o+8>>2]=r[a+8>>2];r[o+12>>2]=r[a+12>>2];s=s+1|0}while((s|0)!=(n|0));return}function Vw(t){t=t|0;return 2}function zw(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,r=0.0,o=0.0,a=0.0,l=0.0,c=0.0;o=+h[t+60>>2];l=+h[t+76>>2]-o;a=+h[t+64>>2];c=+h[t+80>>2]-a;n=+h[t+68>>2];r=+h[t+84>>2]-n;o=+h[t+92>>2]-o;a=+h[t+96>>2]-a;n=+h[t+100>>2]-n;h[i+12>>2]=0.0;s=1.0/+G(+((l*a-c*o)*(l*a-c*o)+((c*n-r*a)*(c*n-r*a)+(r*o-l*n)*(r*o-l*n))));h[i>>2]=(c*n-r*a)*s;h[i+4>>2]=(r*o-l*n)*s;h[i+8>>2]=(l*a-c*o)*s;if(!e)return;h[i>>2]=-((c*n-r*a)*s);h[i+4>>2]=-((r*o-l*n)*s);h[i+8>>2]=-((l*a-c*o)*s);return}function Ww(t){t=t|0;return 3}function Gw(t){t=t|0;return 3}function jw(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;Vk[r[(r[t>>2]|0)+108>>2]&127](t,e,i);Vk[r[(r[t>>2]|0)+108>>2]&127](t,(e+1|0)%3|0,n);return}function Hw(t,e,i){t=t|0;e=e|0;i=i|0;r[i>>2]=r[t+60+(e<<4)>>2];r[i+4>>2]=r[t+60+(e<<4)+4>>2];r[i+8>>2]=r[t+60+(e<<4)+8>>2];r[i+12>>2]=r[t+60+(e<<4)+12>>2];return}function Xw(t){t=t|0;return 1}function Yw(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;jk[r[(r[t>>2]|0)+124>>2]&127](t,n,e,i);return}function qw(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,l=0,u=0,d=0,p=0,f=0,m=0,g=0;g=_;_=_+80|0;p=r[t+4>>2]|0;Mk[r[(r[p>>2]|0)+16>>2]&3](p,g+28|0,g+24|0,g+20|0,g+16|0,g+12|0,g+8|0,g+4|0,g,e);p=(r[g+12>>2]|0)+(et(r[g+8>>2]|0,i)|0)|0;m=r[t+4>>2]|0;f=(r[g+20>>2]|0)==0;d=r[g+28>>2]|0;if((r[g>>2]|0)==3){u=r[g+16>>2]|0;l=d+(et(u,a[p+4>>1]|0)|0)|0;if(f){s=+h[l+8>>2]*+h[m+12>>2];o=+h[l+4>>2]*+h[m+8>>2];n=+h[l>>2]*+h[m+4>>2]}else{s=+c[l+16>>3]*+h[m+12>>2];o=+c[l+8>>3]*+h[m+8>>2];n=+c[l>>3]*+h[m+4>>2]}h[g+32+32>>2]=n;h[g+32+36>>2]=o;h[g+32+40>>2]=s;h[g+32+44>>2]=0.0;l=d+(et(u,a[p+2>>1]|0)|0)|0;if(f){s=+h[l+8>>2]*+h[m+12>>2];o=+h[l+4>>2]*+h[m+8>>2];n=+h[l>>2]*+h[m+4>>2]}else{s=+c[l+16>>3]*+h[m+12>>2];o=+c[l+8>>3]*+h[m+8>>2];n=+c[l>>3]*+h[m+4>>2]}h[g+32+16>>2]=n;h[g+32+20>>2]=o;h[g+32+24>>2]=s;h[g+32+28>>2]=0.0;l=d+(et(u,a[p>>1]|0)|0)|0;if(f){s=+h[l+8>>2]*+h[m+12>>2];o=+h[l+4>>2]*+h[m+8>>2];n=+h[l>>2]*+h[m+4>>2]}else{s=+c[l+16>>3]*+h[m+12>>2];o=+c[l+8>>3]*+h[m+8>>2];n=+c[l>>3]*+h[m+4>>2]}h[g+32>>2]=n;h[g+32+4>>2]=o;h[g+32+8>>2]=s;h[g+32+12>>2]=0.0;m=t+8|0;m=r[m>>2]|0;f=r[m>>2]|0;f=f+8|0;f=r[f>>2]|0;jk[f&127](m,g+32|0,e,i);t=r[t+4>>2]|0;i=r[t>>2]|0;i=i+24|0;i=r[i>>2]|0;lk[i&127](t,e);_=g;return}else{u=r[g+16>>2]|0;l=d+(et(u,r[p+8>>2]|0)|0)|0;if(f){s=+h[l+8>>2]*+h[m+12>>2];o=+h[l+4>>2]*+h[m+8>>2];n=+h[l>>2]*+h[m+4>>2]}else{s=+c[l+16>>3]*+h[m+12>>2];o=+c[l+8>>3]*+h[m+8>>2];n=+c[l>>3]*+h[m+4>>2]}h[g+32+32>>2]=n;h[g+32+36>>2]=o;h[g+32+40>>2]=s;h[g+32+44>>2]=0.0;l=d+(et(u,r[p+4>>2]|0)|0)|0;if(f){s=+h[l+8>>2]*+h[m+12>>2];o=+h[l+4>>2]*+h[m+8>>2];n=+h[l>>2]*+h[m+4>>2]}else{s=+c[l+16>>3]*+h[m+12>>2];o=+c[l+8>>3]*+h[m+8>>2];n=+c[l>>3]*+h[m+4>>2]}h[g+32+16>>2]=n;h[g+32+20>>2]=o;h[g+32+24>>2]=s;h[g+32+28>>2]=0.0;l=d+(et(u,r[p>>2]|0)|0)|0;if(f){s=+h[l+8>>2]*+h[m+12>>2];o=+h[l+4>>2]*+h[m+8>>2];n=+h[l>>2]*+h[m+4>>2]}else{s=+c[l+16>>3]*+h[m+12>>2];o=+c[l+8>>3]*+h[m+8>>2];n=+c[l>>3]*+h[m+4>>2]}h[g+32>>2]=n;h[g+32+4>>2]=o;h[g+32+8>>2]=s;h[g+32+12>>2]=0.0;m=t+8|0;m=r[m>>2]|0;f=r[m>>2]|0;f=f+8|0;f=r[f>>2]|0;jk[f&127](m,g+32|0,e,i);t=r[t+4>>2]|0;i=r[t>>2]|0;i=i+24|0;i=r[i>>2]|0;lk[i&127](t,e);_=g;return}}function Kw(t){t=t|0;Ql(t);return}function Zw(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,l=0,u=0,d=0,p=0,f=0,m=0,g=0;g=_;_=_+80|0;p=r[t+4>>2]|0;Mk[r[(r[p>>2]|0)+16>>2]&3](p,g+28|0,g+24|0,g+20|0,g+16|0,g+12|0,g+8|0,g+4|0,g,e);p=(r[g+12>>2]|0)+(et(r[g+8>>2]|0,i)|0)|0;m=r[t+4>>2]|0;f=(r[g+20>>2]|0)==0;d=r[g+28>>2]|0;if((r[g>>2]|0)==3){u=r[g+16>>2]|0;l=d+(et(u,a[p+4>>1]|0)|0)|0;if(f){s=+h[l+8>>2]*+h[m+12>>2];o=+h[l+4>>2]*+h[m+8>>2];n=+h[l>>2]*+h[m+4>>2]}else{s=+c[l+16>>3]*+h[m+12>>2];o=+c[l+8>>3]*+h[m+8>>2];n=+c[l>>3]*+h[m+4>>2]}h[g+32+32>>2]=n;h[g+32+36>>2]=o;h[g+32+40>>2]=s;h[g+32+44>>2]=0.0;l=d+(et(u,a[p+2>>1]|0)|0)|0;if(f){s=+h[l+8>>2]*+h[m+12>>2];o=+h[l+4>>2]*+h[m+8>>2];n=+h[l>>2]*+h[m+4>>2]}else{s=+c[l+16>>3]*+h[m+12>>2];o=+c[l+8>>3]*+h[m+8>>2];n=+c[l>>3]*+h[m+4>>2]}h[g+32+16>>2]=n;h[g+32+20>>2]=o;h[g+32+24>>2]=s;h[g+32+28>>2]=0.0;l=d+(et(u,a[p>>1]|0)|0)|0;if(f){s=+h[l+8>>2]*+h[m+12>>2];o=+h[l+4>>2]*+h[m+8>>2];n=+h[l>>2]*+h[m+4>>2]}else{s=+c[l+16>>3]*+h[m+12>>2];o=+c[l+8>>3]*+h[m+8>>2];n=+c[l>>3]*+h[m+4>>2]}h[g+32>>2]=n;h[g+32+4>>2]=o;h[g+32+8>>2]=s;h[g+32+12>>2]=0.0;m=t+8|0;m=r[m>>2]|0;f=r[m>>2]|0;f=f+8|0;f=r[f>>2]|0;jk[f&127](m,g+32|0,e,i);t=r[t+4>>2]|0;i=r[t>>2]|0;i=i+24|0;i=r[i>>2]|0;lk[i&127](t,e);_=g;return}else{u=r[g+16>>2]|0;l=d+(et(u,r[p+8>>2]|0)|0)|0;if(f){s=+h[l+8>>2]*+h[m+12>>2];o=+h[l+4>>2]*+h[m+8>>2];n=+h[l>>2]*+h[m+4>>2]}else{s=+c[l+16>>3]*+h[m+12>>2];o=+c[l+8>>3]*+h[m+8>>2];n=+c[l>>3]*+h[m+4>>2]}h[g+32+32>>2]=n;h[g+32+36>>2]=o;h[g+32+40>>2]=s;h[g+32+44>>2]=0.0;l=d+(et(u,r[p+4>>2]|0)|0)|0;if(f){s=+h[l+8>>2]*+h[m+12>>2];o=+h[l+4>>2]*+h[m+8>>2];n=+h[l>>2]*+h[m+4>>2]}else{s=+c[l+16>>3]*+h[m+12>>2];o=+c[l+8>>3]*+h[m+8>>2];n=+c[l>>3]*+h[m+4>>2]}h[g+32+16>>2]=n;h[g+32+20>>2]=o;h[g+32+24>>2]=s;h[g+32+28>>2]=0.0;l=d+(et(u,r[p>>2]|0)|0)|0;if(f){s=+h[l+8>>2]*+h[m+12>>2];o=+h[l+4>>2]*+h[m+8>>2];n=+h[l>>2]*+h[m+4>>2]}else{s=+c[l+16>>3]*+h[m+12>>2];o=+c[l+8>>3]*+h[m+8>>2];n=+c[l>>3]*+h[m+4>>2]}h[g+32>>2]=n;h[g+32+4>>2]=o;h[g+32+8>>2]=s;h[g+32+12>>2]=0.0;m=t+8|0;m=r[m>>2]|0;f=r[m>>2]|0;f=f+8|0;f=r[f>>2]|0;jk[f&127](m,g+32|0,e,i);t=r[t+4>>2]|0;i=r[t>>2]|0;i=i+24|0;i=r[i>>2]|0;lk[i&127](t,e);_=g;return}}function Qw(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function $w(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0,T=0;s=_;_=_+16|0;C=r[t+56>>2]|0;T=r[t+32+(((C+2|0)%3|0)<<2)>>2]|0;r[s>>2]=T;r[s+4>>2]=T;r[s+8>>2]=T;h[s+12>>2]=0.0;h[s+(C<<2)>>2]=(r[d>>2]=T,+h[d>>2])+ +h[t+32+(C<<2)>>2];l=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=+xk[r[(r[t>>2]|0)+48>>2]&15](t);p=+xk[r[(r[t>>2]|0)+48>>2]&15](t);l=l+ +h[s>>2];h[s>>2]=l;o=o+ +h[s+4>>2];h[s+4>>2]=o;p=p+ +h[s+8>>2];S=+W(+ +h[e>>2]);v=+W(+ +h[e+4>>2]);x=+W(+ +h[e+8>>2]);g=+W(+ +h[e+16>>2]);m=+W(+ +h[e+20>>2]);b=+W(+ +h[e+24>>2]);c=+W(+ +h[e+32>>2]);a=+W(+ +h[e+36>>2]);u=+W(+ +h[e+40>>2]);w=+h[e+48>>2];y=+h[e+52>>2];f=+h[e+56>>2];h[i>>2]=w-(p*x+(S*l+v*o));h[i+4>>2]=y-(p*b+(g*l+m*o));h[i+8>>2]=f-(p*u+(c*l+a*o));h[i+12>>2]=0.0;h[n>>2]=w+(p*x+(S*l+v*o));h[n+4>>2]=y+(p*b+(g*l+m*o));h[n+8>>2]=f+(p*u+(c*l+a*o));h[n+12>>2]=0.0;_=s;return}function Jw(t,e){t=t|0;e=e|0;var i=0.0,n=0.0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0;c=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=+xk[r[(r[t>>2]|0)+48>>2]&15](t);i=+xk[r[(r[t>>2]|0)+48>>2]&15](t);u=(c+ +h[t+32>>2])/+h[t+16>>2];l=(o+ +h[t+36>>2])/+h[t+20>>2];s=(i+ +h[t+40>>2])/+h[t+24>>2];_=+W(+ +h[e>>2]);a=+W(+ +h[e+4>>2]);n=+W(+ +h[e+8>>2]);h[t+16>>2]=_;h[t+20>>2]=a;h[t+24>>2]=n;h[t+28>>2]=0.0;h[t+32>>2]=u*_-c;h[t+36>>2]=l*a-o;h[t+40>>2]=s*n-i;h[t+44>>2]=0.0;return}function tC(t,e,i){t=t|0;e=+e;i=i|0;var n=0,s=0.0,o=0.0,a=0.0,l=0,c=0;n=_;_=_+16|0;l=r[t+56>>2]|0;c=r[t+32+(((l+2|0)%3|0)<<2)>>2]|0;r[n>>2]=c;r[n+4>>2]=c;r[n+8>>2]=c;h[n+12>>2]=0.0;h[n+(l<<2)>>2]=+h[t+32+(l<<2)>>2]+ +h[n+(l<<2)>>2];o=(+h[n>>2]+.03999999910593033)*2.0;s=(+h[n+4>>2]+.03999999910593033)*2.0;a=(+h[n+8>>2]+.03999999910593033)*2.0;h[i>>2]=e*.0833333283662796*(s*s+a*a);h[i+4>>2]=e*.0833333283662796*(o*o+a*a);h[i+8>>2]=e*.0833333283662796*(o*o+s*s);_=n;return}function eC(t){t=t|0;return 13096}function iC(t,e){t=t|0;e=e|0;r[t>>2]=0;r[t+4>>2]=0;r[t+8>>2]=0;r[t+12>>2]=0;h[t+(r[e+56>>2]<<2)>>2]=1.0;return}function nC(t,e){t=t|0;e=+e;var i=0.0,n=0.0,s=0.0,o=0.0,a=0.0;o=+xk[r[(r[t>>2]|0)+48>>2]&15](t);n=+xk[r[(r[t>>2]|0)+48>>2]&15](t);a=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=o+ +h[t+32>>2];n=n+ +h[t+36>>2];a=a+ +h[t+40>>2];h[t+48>>2]=e;s=+xk[r[(r[t>>2]|0)+48>>2]&15](t);i=+xk[r[(r[t>>2]|0)+48>>2]&15](t);e=a-+xk[r[(r[t>>2]|0)+48>>2]&15](t);h[t+32>>2]=o-s;h[t+36>>2]=n-i;h[t+40>>2]=e;h[t+44>>2]=0.0;return}function sC(t){t=t|0;return 60}function rC(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0;n=Rk[r[(r[i>>2]|0)+40>>2]&31](i,t)|0;s=Rk[r[(r[i>>2]|0)+28>>2]&31](i,n)|0;r[e>>2]=s;if(s|0)lk[r[(r[i>>2]|0)+48>>2]&127](i,n);r[e+4>>2]=r[t+4>>2];r[e+28>>2]=r[t+32>>2];r[e+32>>2]=r[t+36>>2];r[e+36>>2]=r[t+40>>2];r[e+40>>2]=r[t+44>>2];r[e+12>>2]=r[t+16>>2];r[e+16>>2]=r[t+20>>2];r[e+20>>2]=r[t+24>>2];r[e+24>>2]=r[t+28>>2];r[e+44>>2]=r[t+48>>2];r[e+52>>2]=r[t+56>>2];return 13109}function oC(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0;m=_;_=_+16|0;r[t>>2]=0;r[t+4>>2]=0;r[t+8>>2]=0;r[t+12>>2]=0;n=+h[i>>2];s=+h[i+4>>2];o=+h[i+8>>2];if(n*n+s*s+o*o<9.999999747378752e-05){f=1.0;p=0.0;d=0.0}else{d=1.0/+G(+(n*n+s*s+o*o));f=n*d;p=s*d;d=o*d}i=r[e+56>>2]|0;u=+h[e+32+(((i+2|0)%3|0)<<2)>>2];r[m>>2]=0;r[m+4>>2]=0;r[m+8>>2]=0;r[m+12>>2]=0;r[m+(i<<2)>>2]=r[e+32+(i<<2)>>2];l=f*u;c=p*u;u=d*u;n=l+ +h[m>>2];s=c+ +h[m+4>>2];a=u+ +h[m+8>>2];o=+xk[r[(r[e>>2]|0)+48>>2]&15](e);n=n-f*o;s=s-p*o;o=a-d*o;a=d*o+(f*n+p*s);if(a>-999999984306749440.0){h[t>>2]=n;h[t+4>>2]=s;h[t+8>>2]=o;h[t+12>>2]=0.0}else a=-999999984306749440.0;r[m>>2]=0;r[m+4>>2]=0;r[m+8>>2]=0;r[m+12>>2]=0;i=r[e+56>>2]|0;h[m+(i<<2)>>2]=-+h[e+32+(i<<2)>>2];n=l+ +h[m>>2];s=c+ +h[m+4>>2];u=u+ +h[m+8>>2];o=+xk[r[(r[e>>2]|0)+48>>2]&15](e);n=n-f*o;s=s-p*o;o=u-d*o;if(!(d*o+(f*n+p*s)>a)){_=m;return}h[t>>2]=n;h[t+4>>2]=s;h[t+8>>2]=o;h[t+12>>2]=0.0;_=m;return}function aC(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0,S=0,x=0.0,w=0,C=0;w=_;_=_+16|0;s=r[t+56>>2]|0;x=+h[t+32+(((s+2|0)%3|0)<<2)>>2];if((n|0)<=0){_=w;return}o=0;while(1){r[w>>2]=0;r[w+4>>2]=0;r[w+8>>2]=0;r[w+12>>2]=0;r[w+(s<<2)>>2]=r[t+32+(s<<2)>>2];s=e+(o<<4)|0;v=e+(o<<4)+4|0;S=e+(o<<4)+8|0;a=x*+h[s>>2]+ +h[w>>2];l=x*+h[v>>2]+ +h[w+4>>2];c=x*+h[S>>2]+ +h[w+8>>2];u=+xk[r[(r[t>>2]|0)+48>>2]&15](t);d=+h[s>>2];p=+h[v>>2];f=+h[S>>2];if(d*(a-u*d)+p*(l-u*p)+f*(c-u*f)>-999999984306749440.0){h[i+(o<<4)>>2]=a-u*d;h[i+(o<<4)+4>>2]=l-u*p;h[i+(o<<4)+8>>2]=c-u*f;h[i+(o<<4)+12>>2]=0.0;m=+h[s>>2];b=+h[v>>2];y=+h[S>>2];g=d*(a-u*d)+p*(l-u*p)+f*(c-u*f)}else{m=d;b=p;y=f;g=-999999984306749440.0}r[w>>2]=0;r[w+4>>2]=0;r[w+8>>2]=0;r[w+12>>2]=0;C=r[t+56>>2]|0;h[w+(C<<2)>>2]=-+h[t+32+(C<<2)>>2];f=x*m+ +h[w>>2];p=x*b+ +h[w+4>>2];u=x*y+ +h[w+8>>2];d=+xk[r[(r[t>>2]|0)+48>>2]&15](t);c=+h[s>>2];l=+h[v>>2];a=+h[S>>2];if(c*(f-d*c)+l*(p-d*l)+a*(u-d*a)>g){h[i+(o<<4)>>2]=f-d*c;h[i+(o<<4)+4>>2]=p-d*l;h[i+(o<<4)+8>>2]=u-d*a;h[i+(o<<4)+12>>2]=0.0}o=o+1|0;if((o|0)==(n|0))break;s=r[t+56>>2]|0}_=w;return}function lC(t){t=t|0;return 0}function hC(t,e,i){t=t|0;e=e|0;i=i|0;return}function cC(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function _C(t){t=t|0;return 13146}function uC(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function dC(t){t=t|0;return 13173}function pC(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,d=0;n=_;_=_+96|0;r[n+32>>2]=1065353216;r[n+32+4>>2]=0;r[n+32+4+4>>2]=0;r[n+32+4+8>>2]=0;r[n+32+4+12>>2]=0;r[n+32+20>>2]=1065353216;r[n+32+24>>2]=0;r[n+32+24+4>>2]=0;r[n+32+24+8>>2]=0;r[n+32+24+12>>2]=0;r[n+32+40>>2]=1065353216;d=n+32+44|0;r[d>>2]=0;r[d+4>>2]=0;r[d+8>>2]=0;r[d+12>>2]=0;r[d+16>>2]=0;jk[r[(r[t>>2]|0)+8>>2]&127](t,n+32|0,n+16|0,n);c=+h[n>>2];u=+h[n+16>>2];a=+h[n+4>>2];l=+h[n+16+4>>2];s=+h[n+8>>2];o=+h[n+16+8>>2];h[i>>2]=+G(+((c-u)*(c-u)+(a-l)*(a-l)+(s-o)*(s-o)))*.5;h[e>>2]=(u+c)*.5;h[e+4>>2]=(l+a)*.5;h[e+8>>2]=(o+s)*.5;h[e+12>>2]=0.0;_=n;return}function fC(t){t=t|0;var e=0,i=0.0,n=0.0,s=0.0;e=_;_=_+32|0;Vk[r[(r[t>>2]|0)+12>>2]&127](t,e+8|0,e);s=+h[e+8>>2];n=+h[e+8+4>>2];i=+h[e+8+8>>2];i=+G(+(s*s+n*n+i*i));_=e;return+(i+ +h[e>>2])}function mC(t,e){t=t|0;e=+e;return+(+xk[r[(r[t>>2]|0)+16>>2]&15](t)*e)}function gC(t){t=t|0;return 12}function bC(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0;n=Rk[r[(r[i>>2]|0)+40>>2]&31](i,t)|0;s=Rk[r[(r[i>>2]|0)+28>>2]&31](i,n)|0;r[e>>2]=s;if(s|0)lk[r[(r[i>>2]|0)+48>>2]&127](i,n);r[e+4>>2]=r[t+4>>2];return 13201}function yC(t,e){t=t|0;e=e|0;var i=0,n=0;n=ck[r[(r[t>>2]|0)+52>>2]&127](t)|0;n=yk[r[(r[e>>2]|0)+16>>2]&63](e,n,1)|0;i=yk[r[(r[t>>2]|0)+56>>2]&63](t,r[n+8>>2]|0,e)|0;sk[r[(r[e>>2]|0)+20>>2]&31](e,n,i,1346455635,t);return}function vC(t,e,i,n,s,o){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;var a=0,l=0,c=0,_=0.0,u=0,p=0,f=0.0,m=0.0;jk[r[(r[t>>2]|0)+8>>2]&127](t,e,s,o);c=r[o>>2]|0;p=r[o+4>>2]|0;a=r[o+8>>2]|0;u=r[s>>2]|0;l=r[s+4>>2]|0;e=r[s+8>>2]|0;_=+h[i>>2];f=+h[i+4>>2];m=+h[i+8>>2];if(_>0.0)c=(h[d>>2]=(r[d>>2]=c,+h[d>>2])+_,r[d>>2]|0);else u=(h[d>>2]=(r[d>>2]=u,+h[d>>2])+_,r[d>>2]|0);if(f>0.0)i=(h[d>>2]=(r[d>>2]=p,+h[d>>2])+f,r[d>>2]|0);else{i=p;l=(h[d>>2]=(r[d>>2]=l,+h[d>>2])+f,r[d>>2]|0)}if(m>0.0)a=(h[d>>2]=(r[d>>2]=a,+h[d>>2])+m,r[d>>2]|0);else e=(h[d>>2]=(r[d>>2]=e,+h[d>>2])+m,r[d>>2]|0);_=+h[n>>2];f=+h[n+4>>2];m=+h[n+8>>2];m=+G(+(_*_+f*f+m*m));m=m*+xk[r[(r[t>>2]|0)+16>>2]&15](t);r[s>>2]=u;r[s+4>>2]=l;r[s+8>>2]=e;h[s+12>>2]=0.0;r[o>>2]=c;r[o+4>>2]=i;r[o+8>>2]=a;h[o+12>>2]=0.0;h[s>>2]=+h[s>>2]-m;h[s+4>>2]=+h[s+4>>2]-m;h[s+8>>2]=+h[s+8>>2]-m;h[o>>2]=m+ +h[o>>2];h[o+4>>2]=m+ +h[o+4>>2];h[o+8>>2]=m+ +h[o+8>>2];return}function SC(t){t=t|0;var e=0,i=0;r[t>>2]=5176;e=r[t+68>>2]|0;if(e|0?(FP(e),i=r[t+68>>2]|0,i|0):0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}e=r[t+28>>2]|0;if(!e){n[t+32>>0]=1;r[t+28>>2]=0;r[t+20>>2]=0;t=t+24|0;r[t>>2]=0;return}if(n[t+32>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+28>>2]=0;n[t+32>>0]=1;r[t+28>>2]=0;r[t+20>>2]=0;t=t+24|0;r[t>>2]=0;return}function xC(t){t=t|0;SC(t);if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function wC(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0,L=0.0,D=0.0;D=+h[t+52>>2];T=+h[t+36>>2];L=+h[t+56>>2];w=+h[t+40>>2];I=+h[t+60>>2];S=+h[t+44>>2];P=(r[t+20>>2]|0)==0;u=+xk[r[(r[t>>2]|0)+48>>2]&15](t);c=+xk[r[(r[t>>2]|0)+48>>2]&15](t);a=+xk[r[(r[t>>2]|0)+48>>2]&15](t);u=(P?0.0:(D-T)*.5)+u;c=(P?0.0:(L-w)*.5)+c;a=(P?0.0:(I-S)*.5)+a;R=+h[e>>2];v=+W(+R);M=+h[e+4>>2];y=+W(+M);g=+h[e+8>>2];b=+W(+g);E=+h[e+16>>2];m=+W(+E);A=+h[e+20>>2];f=+W(+A);d=+h[e+24>>2];p=+W(+d);C=+h[e+32>>2];_=+W(+C);x=+h[e+36>>2];l=+W(+x);s=+h[e+40>>2];o=+W(+s);T=P?0.0:(D+T)*.5;w=P?0.0:(L+w)*.5;S=P?0.0:(I+S)*.5;g=T*R+w*M+S*g+ +h[e+48>>2];d=T*E+w*A+S*d+ +h[e+52>>2];s=T*C+w*x+S*s+ +h[e+56>>2];h[i>>2]=g-(u*v+c*y+a*b);h[i+4>>2]=d-(u*m+c*f+a*p);h[i+8>>2]=s-(u*_+c*l+a*o);h[i+12>>2]=0.0;h[n>>2]=u*v+c*y+a*b+g;h[n+4>>2]=u*m+c*f+a*p+d;h[n+8>>2]=u*_+c*l+a*o+s;h[n+12>>2]=0.0;return}function CC(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0,p=0,f=0,m=0.0,g=0.0;f=_;_=_+144|0;if((r[t+20>>2]|0)<=0){p=t+80|0;r[p>>2]=r[e>>2];r[p+4>>2]=r[e+4>>2];r[p+8>>2]=r[e+8>>2];r[p+12>>2]=r[e+12>>2];e=r[t>>2]|0;e=e+68|0;e=r[e>>2]|0;ok[e&255](t);_=f;return}a=f+16+16|0;l=f+16+32|0;c=f+16+48|0;p=0;do{d=r[t+28>>2]|0;u=d+(p*80|0)|0;r[f+16>>2]=r[u>>2];r[f+16+4>>2]=r[u+4>>2];r[f+16+8>>2]=r[u+8>>2];r[f+16+12>>2]=r[u+12>>2];u=d+(p*80|0)+16|0;r[a>>2]=r[u>>2];r[a+4>>2]=r[u+4>>2];r[a+8>>2]=r[u+8>>2];r[a+12>>2]=r[u+12>>2];u=d+(p*80|0)+32|0;r[l>>2]=r[u>>2];r[l+4>>2]=r[u+4>>2];r[l+8>>2]=r[u+8>>2];r[l+12>>2]=r[u+12>>2];u=d+(p*80|0)+48|0;r[c>>2]=r[u>>2];r[c+4>>2]=r[u+4>>2];r[c+8>>2]=r[u+8>>2];r[c+12>>2]=r[u+12>>2];d=r[d+(p*80|0)+64>>2]|0;d=ck[r[(r[d>>2]|0)+28>>2]&127](d)|0;r[f>>2]=r[d>>2];r[f+4>>2]=r[d+4>>2];r[f+8>>2]=r[d+8>>2];m=+h[f+4>>2]*+h[e+4>>2]/+h[t+84>>2];g=+h[f+8>>2]*+h[e+8>>2]/+h[t+88>>2];h[f>>2]=+h[f>>2]*+h[e>>2]/+h[t+80>>2];h[f+4>>2]=m;h[f+8>>2]=g;h[f+12>>2]=0.0;d=r[(r[t+28>>2]|0)+(p*80|0)+64>>2]|0;lk[r[(r[d>>2]|0)+24>>2]&127](d,f);g=+h[f+16+52>>2]*+h[e+4>>2]/+h[t+84>>2];m=+h[f+16+56>>2]*+h[e+8>>2]/+h[t+88>>2];h[f+16+48>>2]=+h[c>>2]*+h[e>>2]/+h[t+80>>2];h[f+16+52>>2]=g;h[f+16+56>>2]=m;h[f+16+60>>2]=0.0;d=r[t+28>>2]|0;u=d+(p*80|0)|0;r[u>>2]=r[f+16>>2];r[u+4>>2]=r[f+16+4>>2];r[u+8>>2]=r[f+16+8>>2];r[u+12>>2]=r[f+16+12>>2];u=d+(p*80|0)+16|0;r[u>>2]=r[a>>2];r[u+4>>2]=r[a+4>>2];r[u+8>>2]=r[a+8>>2];r[u+12>>2]=r[a+12>>2];u=d+(p*80|0)+32|0;r[u>>2]=r[l>>2];r[u+4>>2]=r[l+4>>2];r[u+8>>2]=r[l+8>>2];r[u+12>>2]=r[l+12>>2];d=d+(p*80|0)+48|0;r[d>>2]=r[c>>2];r[d+4>>2]=r[c+4>>2];r[d+8>>2]=r[c+8>>2];r[d+12>>2]=r[c+12>>2];if(r[t+68>>2]|0){u=r[(r[t+28>>2]|0)+(p*80|0)+64>>2]|0;jk[r[(r[u>>2]|0)+8>>2]&127](u,f+16|0,f+128|0,f+112|0);r[f+80>>2]=r[f+128>>2];r[f+80+4>>2]=r[f+128+4>>2];r[f+80+8>>2]=r[f+128+8>>2];r[f+80+12>>2]=r[f+128+12>>2];r[f+80+16>>2]=r[f+112>>2];r[f+80+16+4>>2]=r[f+112+4>>2];r[f+80+16+8>>2]=r[f+112+8>>2];r[f+80+16+12>>2]=r[f+112+12>>2];u=r[t+68>>2]|0;d=r[(r[t+28>>2]|0)+(p*80|0)+76>>2]|0;i=UP(u,d)|0;t:do{if(i){s=r[u+8>>2]|0;if((s|0)<=-1){i=r[u>>2]|0;break}if((s|0)>0){o=0;while(1){n=r[i+32>>2]|0;o=o+1|0;if(!n)break t;if((o|0)>=(s|0)){i=n;break}else i=n}}}else i=0}while(0);r[d>>2]=r[f+80>>2];r[d+4>>2]=r[f+80+4>>2];r[d+8>>2]=r[f+80+8>>2];r[d+12>>2]=r[f+80+12>>2];r[d+16>>2]=r[f+80+16>>2];r[d+20>>2]=r[f+80+20>>2];r[d+24>>2]=r[f+80+24>>2];r[d+28>>2]=r[f+80+28>>2];VP(u,i,d)}p=p+1|0}while((p|0)<(r[t+20>>2]|0));p=t+80|0;r[p>>2]=r[e>>2];r[p+4>>2]=r[e+4>>2];r[p+8>>2]=r[e+8>>2];r[p+12>>2]=r[e+12>>2];e=r[t>>2]|0;e=e+68|0;e=r[e>>2]|0;ok[e&255](t);_=f;return}function TC(t){t=t|0;return t+80|0}function AC(t,e,i){t=t|0;e=+e;i=i|0;var n=0,s=0.0,o=0.0,a=0.0,l=0;n=_;_=_+96|0;r[n+32>>2]=1065353216;r[n+32+4>>2]=0;r[n+32+4+4>>2]=0;r[n+32+4+8>>2]=0;r[n+32+4+12>>2]=0;r[n+32+20>>2]=1065353216;r[n+32+24>>2]=0;r[n+32+24+4>>2]=0;r[n+32+24+8>>2]=0;r[n+32+24+12>>2]=0;r[n+32+40>>2]=1065353216;l=n+32+44|0;r[l>>2]=0;r[l+4>>2]=0;r[l+8>>2]=0;r[l+12>>2]=0;r[l+16>>2]=0;jk[r[(r[t>>2]|0)+8>>2]&127](t,n+32|0,n+16|0,n);o=(+h[n>>2]-+h[n+16>>2])*.5*2.0;s=(+h[n+4>>2]-+h[n+16+4>>2])*.5*2.0;a=(+h[n+8>>2]-+h[n+16+8>>2])*.5*2.0;h[i>>2]=e/12.0*(s*s+a*a);h[i+4>>2]=e/12.0*(o*o+a*a);h[i+8>>2]=e/12.0*(o*o+s*s);_=n;return}function EC(t){t=t|0;return 13240}function MC(t,e){t=t|0;e=+e;h[t+76>>2]=e;return}function RC(t){t=t|0;return+ +h[t+76>>2]}function IC(t){t=t|0;return 24}function PC(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0,a=0,l=0;n=Rk[r[(r[i>>2]|0)+40>>2]&31](i,t)|0;o=Rk[r[(r[i>>2]|0)+28>>2]&31](i,n)|0;r[e>>2]=o;if(o|0)lk[r[(r[i>>2]|0)+48>>2]&127](i,n);r[e+4>>2]=r[t+4>>2];r[e+20>>2]=r[t+76>>2];n=r[t+20>>2]|0;r[e+16>>2]=n;r[e+12>>2]=0;if(!n)return 13274;o=yk[r[(r[i>>2]|0)+16>>2]&63](i,76,n)|0;n=r[o+8>>2]|0;r[e+12>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,n)|0;if((r[e+16>>2]|0)>0){s=0;while(1){a=r[t+28>>2]|0;r[n+72>>2]=r[a+(s*80|0)+72>>2];r[n+64>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,r[a+(s*80|0)+64>>2]|0)|0;if(!(Rk[r[(r[i>>2]|0)+24>>2]&31](i,r[(r[t+28>>2]|0)+(s*80|0)+64>>2]|0)|0)){a=r[(r[i>>2]|0)+16>>2]|0;l=r[(r[t+28>>2]|0)+(s*80|0)+64>>2]|0;l=ck[r[(r[l>>2]|0)+52>>2]&127](l)|0;l=yk[a&63](i,l,1)|0;a=r[(r[t+28>>2]|0)+(s*80|0)+64>>2]|0;a=yk[r[(r[a>>2]|0)+56>>2]&63](a,r[l+8>>2]|0,i)|0;sk[r[(r[i>>2]|0)+20>>2]&31](i,l,a,1346455635,r[(r[t+28>>2]|0)+(s*80|0)+64>>2]|0)}l=r[t+28>>2]|0;r[n+68>>2]=r[l+(s*80|0)+68>>2];r[n>>2]=r[l+(s*80|0)>>2];r[n+4>>2]=r[l+(s*80|0)+4>>2];r[n+8>>2]=r[l+(s*80|0)+8>>2];r[n+12>>2]=r[l+(s*80|0)+12>>2];r[n+16>>2]=r[l+(s*80|0)+16>>2];r[n+20>>2]=r[l+(s*80|0)+20>>2];r[n+24>>2]=r[l+(s*80|0)+24>>2];r[n+28>>2]=r[l+(s*80|0)+28>>2];r[n+32>>2]=r[l+(s*80|0)+32>>2];r[n+36>>2]=r[l+(s*80|0)+36>>2];r[n+40>>2]=r[l+(s*80|0)+40>>2];r[n+44>>2]=r[l+(s*80|0)+44>>2];r[n+48>>2]=r[l+(s*80|0)+48>>2];r[n+52>>2]=r[l+(s*80|0)+52>>2];r[n+56>>2]=r[l+(s*80|0)+56>>2];r[n+60>>2]=r[l+(s*80|0)+60>>2];s=s+1|0;if((s|0)>=(r[e+16>>2]|0)){n=i;break}else n=n+76|0}}else n=i;sk[r[(r[n>>2]|0)+20>>2]&31](i,o,13249,1497453121,r[o+8>>2]|0);return 13274}function LC(t,e){t=t|0;e=e|0;var i=0,n=0;r[t+72>>2]=(r[t+72>>2]|0)+1;i=r[t+20>>2]|0;if((i|0)>0)do{n=i;i=i+-1|0;if((r[(r[t+28>>2]|0)+(i*80|0)+64>>2]|0)==(e|0))DC(t,i)}while((n|0)>1);ok[r[(r[t>>2]|0)+68>>2]&255](t);return}function DC(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0;o=_;_=_+80|0;r[t+72>>2]=(r[t+72>>2]|0)+1;n=r[t+68>>2]|0;if(n|0){s=r[(r[t+28>>2]|0)+(e*80|0)+76>>2]|0;UP(n,s)|0;i=r[n+4>>2]|0;if(i|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[n+4>>2]=s;r[n+12>>2]=(r[n+12>>2]|0)+-1}s=(r[t+20>>2]|0)+-1|0;n=r[t+28>>2]|0;r[o>>2]=r[n+(e*80|0)>>2];r[o+4>>2]=r[n+(e*80|0)+4>>2];r[o+8>>2]=r[n+(e*80|0)+8>>2];r[o+12>>2]=r[n+(e*80|0)+12>>2];r[o+16>>2]=r[n+(e*80|0)+16>>2];r[o+16+4>>2]=r[n+(e*80|0)+16+4>>2];r[o+16+8>>2]=r[n+(e*80|0)+16+8>>2];r[o+16+12>>2]=r[n+(e*80|0)+16+12>>2];r[o+32>>2]=r[n+(e*80|0)+32>>2];r[o+32+4>>2]=r[n+(e*80|0)+32+4>>2];r[o+32+8>>2]=r[n+(e*80|0)+32+8>>2];r[o+32+12>>2]=r[n+(e*80|0)+32+12>>2];r[o+48>>2]=r[n+(e*80|0)+48>>2];r[o+48+4>>2]=r[n+(e*80|0)+48+4>>2];r[o+48+8>>2]=r[n+(e*80|0)+48+8>>2];r[o+48+12>>2]=r[n+(e*80|0)+48+12>>2];r[o+64>>2]=r[n+(e*80|0)+64>>2];r[o+64+4>>2]=r[n+(e*80|0)+64+4>>2];r[o+64+8>>2]=r[n+(e*80|0)+64+8>>2];r[o+64+12>>2]=r[n+(e*80|0)+64+12>>2];r[n+(e*80|0)>>2]=r[n+(s*80|0)>>2];r[n+(e*80|0)+4>>2]=r[n+(s*80|0)+4>>2];r[n+(e*80|0)+8>>2]=r[n+(s*80|0)+8>>2];r[n+(e*80|0)+12>>2]=r[n+(s*80|0)+12>>2];r[n+(e*80|0)+16>>2]=r[n+(s*80|0)+16>>2];r[n+(e*80|0)+16+4>>2]=r[n+(s*80|0)+16+4>>2];r[n+(e*80|0)+16+8>>2]=r[n+(s*80|0)+16+8>>2];r[n+(e*80|0)+16+12>>2]=r[n+(s*80|0)+16+12>>2];r[n+(e*80|0)+32>>2]=r[n+(s*80|0)+32>>2];r[n+(e*80|0)+32+4>>2]=r[n+(s*80|0)+32+4>>2];r[n+(e*80|0)+32+8>>2]=r[n+(s*80|0)+32+8>>2];r[n+(e*80|0)+32+12>>2]=r[n+(s*80|0)+32+12>>2];r[n+(e*80|0)+48>>2]=r[n+(s*80|0)+48>>2];r[n+(e*80|0)+48+4>>2]=r[n+(s*80|0)+48+4>>2];r[n+(e*80|0)+48+8>>2]=r[n+(s*80|0)+48+8>>2];r[n+(e*80|0)+48+12>>2]=r[n+(s*80|0)+48+12>>2];r[n+(e*80|0)+64>>2]=r[n+(s*80|0)+64>>2];r[n+(e*80|0)+64+4>>2]=r[n+(s*80|0)+64+4>>2];r[n+(e*80|0)+64+8>>2]=r[n+(s*80|0)+64+8>>2];r[n+(e*80|0)+64+12>>2]=r[n+(s*80|0)+64+12>>2];n=r[t+28>>2]|0;r[n+(s*80|0)>>2]=r[o>>2];r[n+(s*80|0)+4>>2]=r[o+4>>2];r[n+(s*80|0)+8>>2]=r[o+8>>2];r[n+(s*80|0)+12>>2]=r[o+12>>2];r[n+(s*80|0)+16>>2]=r[o+16>>2];r[n+(s*80|0)+16+4>>2]=r[o+16+4>>2];r[n+(s*80|0)+16+8>>2]=r[o+16+8>>2];r[n+(s*80|0)+16+12>>2]=r[o+16+12>>2];r[n+(s*80|0)+32>>2]=r[o+32>>2];r[n+(s*80|0)+32+4>>2]=r[o+32+4>>2];r[n+(s*80|0)+32+8>>2]=r[o+32+8>>2];r[n+(s*80|0)+32+12>>2]=r[o+32+12>>2];r[n+(s*80|0)+48>>2]=r[o+48>>2];r[n+(s*80|0)+48+4>>2]=r[o+48+4>>2];r[n+(s*80|0)+48+8>>2]=r[o+48+8>>2];r[n+(s*80|0)+48+12>>2]=r[o+48+12>>2];r[n+(s*80|0)+64>>2]=r[o+64>>2];r[n+(s*80|0)+64+4>>2]=r[o+64+4>>2];r[n+(s*80|0)+64+8>>2]=r[o+64+8>>2];r[n+(s*80|0)+64+12>>2]=r[o+64+12>>2];if(!(r[t+68>>2]|0)){e=r[t+20>>2]|0;e=e+-1|0;r[t+20>>2]=e;_=o;return}r[(r[(r[t+28>>2]|0)+(e*80|0)+76>>2]|0)+36>>2]=e;e=r[t+20>>2]|0;e=e+-1|0;r[t+20>>2]=e;_=o;return}function kC(t){t=t|0;var e=0.0,i=0,n=0,s=0,o=0;n=_;_=_+32|0;r[t+36>>2]=1566444395;r[t+40>>2]=1566444395;r[t+44>>2]=1566444395;h[t+48>>2]=0.0;r[t+52>>2]=-581039253;r[t+56>>2]=-581039253;r[t+60>>2]=-581039253;h[t+64>>2]=0.0;if((r[t+20>>2]|0)<=0){_=n;return}i=0;do{s=r[t+28>>2]|0;o=r[s+(i*80|0)+64>>2]|0;jk[r[(r[o>>2]|0)+8>>2]&127](o,s+(i*80|0)|0,n+16|0,n);e=+h[n+16>>2];if(+h[t+36>>2]>e)h[t+36>>2]=e;e=+h[n>>2];if(+h[t+52>>2]<e)h[t+52>>2]=e;e=+h[n+16+4>>2];if(+h[t+40>>2]>e)h[t+40>>2]=e;e=+h[n+4>>2];if(+h[t+56>>2]<e)h[t+56>>2]=e;e=+h[n+16+8>>2];if(+h[t+44>>2]>e)h[t+44>>2]=e;e=+h[n+8>>2];if(+h[t+60>>2]<e)h[t+60>>2]=e;i=i+1|0}while((i|0)<(r[t+20>>2]|0));_=n;return}function OC(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0,l=0,c=0;r[t+8>>2]=0;r[t+12>>2]=-1;r[t>>2]=5176;n[t+32>>0]=1;r[t+28>>2]=0;r[t+20>>2]=0;r[t+24>>2]=0;r[t+36>>2]=1566444395;r[t+40>>2]=1566444395;r[t+44>>2]=1566444395;h[t+48>>2]=0.0;r[t+52>>2]=-581039253;r[t+56>>2]=-581039253;r[t+60>>2]=-581039253;h[t+64>>2]=0.0;r[t+68>>2]=0;r[t+72>>2]=1;h[t+76>>2]=0.0;r[t+80>>2]=1065353216;r[t+84>>2]=1065353216;r[t+88>>2]=1065353216;h[t+92>>2]=0.0;r[t+4>>2]=31;if(e){r[5637]=(r[5637]|0)+1;e=Zl(79)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}n[e+36>>0]=1;r[e+32>>2]=0;r[e+24>>2]=0;r[e+28>>2]=0;n[e+56>>0]=1;r[e+52>>2]=0;r[e+44>>2]=0;r[e+48>>2]=0;r[e>>2]=0;r[e+4>>2]=0;r[e+8>>2]=-1;r[e+12>>2]=0;r[e+16>>2]=0;r[t+68>>2]=e;e=r[t+24>>2]|0}else e=0;if((e|0)>=(i|0))return;if((i|0)!=0?(r[5637]=(r[5637]|0)+1,s=Zl((i*80|3)+16|0)|0,(s|0)!=0):0){r[(s+4+15&-16)+-4>>2]=s;o=s+4+15&-16}else o=0;e=r[t+20>>2]|0;if((e|0)>0){s=0;do{a=o+(s*80|0)|0;l=r[t+28>>2]|0;c=l+(s*80|0)|0;r[a>>2]=r[c>>2];r[a+4>>2]=r[c+4>>2];r[a+8>>2]=r[c+8>>2];r[a+12>>2]=r[c+12>>2];a=o+(s*80|0)+16|0;c=l+(s*80|0)+16|0;r[a>>2]=r[c>>2];r[a+4>>2]=r[c+4>>2];r[a+8>>2]=r[c+8>>2];r[a+12>>2]=r[c+12>>2];a=o+(s*80|0)+32|0;c=l+(s*80|0)+32|0;r[a>>2]=r[c>>2];r[a+4>>2]=r[c+4>>2];r[a+8>>2]=r[c+8>>2];r[a+12>>2]=r[c+12>>2];a=o+(s*80|0)+48|0;c=l+(s*80|0)+48|0;r[a>>2]=r[c>>2];r[a+4>>2]=r[c+4>>2];r[a+8>>2]=r[c+8>>2];r[a+12>>2]=r[c+12>>2];a=o+(s*80|0)+64|0;l=l+(s*80|0)+64|0;r[a>>2]=r[l>>2];r[a+4>>2]=r[l+4>>2];r[a+8>>2]=r[l+8>>2];r[a+12>>2]=r[l+12>>2];s=s+1|0}while((s|0)!=(e|0))}e=r[t+28>>2]|0;if(e|0){if(n[t+32>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+28>>2]=0}n[t+32>>0]=1;r[t+28>>2]=o;r[t+24>>2]=i;return}function FC(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function BC(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;jk[r[(r[t>>2]|0)+80>>2]&127](t,e,i,n);return}function NC(t,e){t=t|0;e=e|0;var i=0.0,n=0.0,s=0.0,o=0,a=0,l=0;l=r[t+72>>2]|0;a=r[t+68>>2]|0;o=r[t+76>>2]|0;n=+h[t+64>>2]*(+h[e+(l<<2)>>2]/+h[t+16+(l<<2)>>2]);h[t+64>>2]=n;s=+h[t+60>>2]*((+h[e+(a<<2)>>2]/+h[t+16+(a<<2)>>2]+ +h[e+(o<<2)>>2]/+h[t+16+(o<<2)>>2])*.5);h[t+60>>2]=s;h[t+56>>2]=s/+G(+(n*n+s*s));s=+W(+ +h[e>>2]);n=+W(+ +h[e+4>>2]);i=+W(+ +h[e+8>>2]);h[t+16>>2]=s;h[t+20>>2]=n;h[t+24>>2]=i;h[t+28>>2]=0.0;return}function UC(t,e,i){t=t|0;e=+e;i=i|0;var n=0,s=0.0,o=0.0,a=0.0,l=0.0,c=0;n=_;_=_+96|0;r[n+32>>2]=1065353216;r[n+32+4>>2]=0;r[n+32+4+4>>2]=0;r[n+32+4+8>>2]=0;r[n+32+4+12>>2]=0;r[n+32+20>>2]=1065353216;r[n+32+24>>2]=0;r[n+32+24+4>>2]=0;r[n+32+24+8>>2]=0;r[n+32+24+12>>2]=0;r[n+32+40>>2]=1065353216;c=n+32+44|0;r[c>>2]=0;r[c+4>>2]=0;r[c+8>>2]=0;r[c+12>>2]=0;r[c+16>>2]=0;jk[r[(r[t>>2]|0)+8>>2]&127](t,n+32|0,n+16|0,n);a=(+h[n>>2]-+h[n+16>>2])*.5;o=(+h[n+4>>2]-+h[n+16+4>>2])*.5;l=(+h[n+8>>2]-+h[n+16+8>>2])*.5;s=+xk[r[(r[t>>2]|0)+48>>2]&15](t);h[i>>2]=e*.0833333283662796*((o+s)*2.0*((o+s)*2.0)+(l+s)*2.0*((l+s)*2.0));h[i+4>>2]=e*.0833333283662796*((a+s)*2.0*((a+s)*2.0)+(l+s)*2.0*((l+s)*2.0));h[i+8>>2]=e*.0833333283662796*((a+s)*2.0*((a+s)*2.0)+(o+s)*2.0*((o+s)*2.0));h[i+12>>2]=0.0;_=n;return}function VC(t){t=t|0;return 13325}function zC(t,e){t=t|0;e=e|0;r[t>>2]=0;r[t+4>>2]=1065353216;r[t+8>>2]=0;h[t+12>>2]=0.0;return}function WC(t){t=t|0;return 60}function GC(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0;n=Rk[r[(r[i>>2]|0)+40>>2]&31](i,t)|0;s=Rk[r[(r[i>>2]|0)+28>>2]&31](i,n)|0;r[e>>2]=s;if(s|0)lk[r[(r[i>>2]|0)+48>>2]&127](i,n);r[e+4>>2]=r[t+4>>2];r[e+28>>2]=r[t+32>>2];r[e+32>>2]=r[t+36>>2];r[e+36>>2]=r[t+40>>2];r[e+40>>2]=r[t+44>>2];r[e+12>>2]=r[t+16>>2];r[e+16>>2]=r[t+20>>2];r[e+20>>2]=r[t+24>>2];r[e+24>>2]=r[t+28>>2];r[e+44>>2]=r[t+48>>2];r[e+52>>2]=r[t+72>>2];return 13330}function jC(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0,o=0.0,a=0,l=0.0,c=0.0,_=0,u=0.0;n=+h[e+64>>2]*.5;_=r[e+72>>2]|0;o=+h[i>>2];l=+h[i+4>>2];c=+h[i+8>>2];c=+G(+(o*o+l*l+c*c));s=r[e+68>>2]|0;do{if(!(+h[i+(_<<2)>>2]>c*+h[e+56>>2])){o=+h[i+(s<<2)>>2];a=r[e+76>>2]|0;l=+h[i+(a<<2)>>2];c=+G(+(o*o+l*l));if(c>1.1920928955078125e-07){c=+h[e+60>>2]/c;h[t+(s<<2)>>2]=o*c;h[t+(_<<2)>>2]=-n;h[t+(a<<2)>>2]=l*c;break}else{h[t+(s<<2)>>2]=0.0;h[t+(_<<2)>>2]=-n;h[t+(a<<2)>>2]=0.0;break}}else{h[t+(s<<2)>>2]=0.0;h[t+(_<<2)>>2]=n;h[t+(r[e+76>>2]<<2)>>2]=0.0}}while(0);if(!(+xk[r[(r[e>>2]|0)+48>>2]&15](e)!=0.0))return;o=+h[i>>2];l=+h[i+4>>2];c=+h[i+8>>2];u=o*o+l*l+c*c<1.4210854715202004e-14?-1.0:o;n=o*o+l*l+c*c<1.4210854715202004e-14?-1.0:l;c=o*o+l*l+c*c<1.4210854715202004e-14?-1.0:c;l=1.0/+G(+(c*c+(u*u+n*n)));o=+xk[r[(r[e>>2]|0)+48>>2]&15](e);h[t>>2]=+h[t>>2]+o*(l*u);h[t+4>>2]=o*(l*n)+ +h[t+4>>2];h[t+8>>2]=o*(l*c)+ +h[t+8>>2];return}function HC(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0,l=0.0,c=0,_=0;o=+h[e+64>>2]*.5;_=r[e+72>>2]|0;n=+h[i>>2];s=+h[i+4>>2];l=+h[i+8>>2];l=+G(+(n*n+s*s+l*l));a=r[e+68>>2]|0;if(+h[i+(_<<2)>>2]>l*+h[e+56>>2]){h[t+(a<<2)>>2]=0.0;h[t+(_<<2)>>2]=o;h[t+(r[e+76>>2]<<2)>>2]=0.0;return}l=+h[i+(a<<2)>>2];c=r[e+76>>2]|0;n=+h[i+(c<<2)>>2];s=+G(+(l*l+n*n));if(s>1.1920928955078125e-07){s=+h[e+60>>2]/s;h[t+(a<<2)>>2]=l*s;h[t+(_<<2)>>2]=-o;h[t+(c<<2)>>2]=n*s;return}else{h[t+(a<<2)>>2]=0.0;h[t+(_<<2)>>2]=-o;h[t+(c<<2)>>2]=0.0;return}}function XC(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0,a=0,l=0.0,c=0,u=0.0,d=0.0,p=0,f=0,m=0;m=_;_=_+16|0;if((n|0)<=0){_=m;return}f=0;do{p=i+(f<<4)|0;s=+h[t+64>>2]*.5;o=r[t+72>>2]|0;l=+h[e+(f<<4)>>2];u=+h[e+(f<<4)+4>>2];d=+h[e+(f<<4)+8>>2];d=+G(+(l*l+u*u+d*d));a=r[t+68>>2]|0;do{if(!(+h[e+(f<<4)+(o<<2)>>2]>d*+h[t+56>>2])){l=+h[e+(f<<4)+(a<<2)>>2];c=r[t+76>>2]|0;u=+h[e+(f<<4)+(c<<2)>>2];d=+G(+(l*l+u*u));if(d>1.1920928955078125e-07){d=+h[t+60>>2]/d;h[m+(a<<2)>>2]=l*d;h[m+(o<<2)>>2]=-s;h[m+(c<<2)>>2]=u*d;break}else{h[m+(a<<2)>>2]=0.0;h[m+(o<<2)>>2]=-s;h[m+(c<<2)>>2]=0.0;break}}else{h[m+(a<<2)>>2]=0.0;h[m+(o<<2)>>2]=s;h[m+(r[t+76>>2]<<2)>>2]=0.0}}while(0);r[p>>2]=r[m>>2];r[p+4>>2]=r[m+4>>2];r[p+8>>2]=r[m+8>>2];r[p+12>>2]=r[m+12>>2];f=f+1|0}while((f|0)!=(n|0));_=m;return}function YC(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function qC(t){t=t|0;return 13361}function KC(t,e){t=t|0;e=e|0;r[t>>2]=0;r[t+4>>2]=0;r[t+8>>2]=1065353216;h[t+12>>2]=0.0;return}function ZC(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function QC(t){t=t|0;return 13382}function $C(t,e){t=t|0;e=e|0;r[t>>2]=1065353216;r[t+4>>2]=0;r[t+8>>2]=0;h[t+12>>2]=0.0;return}function JC(t){t=t|0;var e=0;r[t>>2]=5556;e=r[t+108>>2]|0;if(e|0){if(n[t+112>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+108>>2]=0}n[t+112>>0]=1;r[t+108>>2]=0;r[t+100>>2]=0;r[t+104>>2]=0;r[t>>2]=6248;e=r[t+56>>2]|0;if(!e)return;ok[r[r[e>>2]>>2]&255](e);e=r[t+56>>2]|0;if(!e)return;r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);return}function tT(t){t=t|0;var e=0,i=0;r[t>>2]=5556;e=r[t+108>>2]|0;if(e|0){if(n[t+112>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+108>>2]=0}n[t+112>>0]=1;r[t+108>>2]=0;r[t+100>>2]=0;r[t+104>>2]=0;r[t>>2]=6248;e=r[t+56>>2]|0;if(e|0?(ok[r[r[e>>2]>>2]&255](e),i=r[t+56>>2]|0,i|0):0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function eT(t,e){t=t|0;e=e|0;r[t+16>>2]=r[e>>2];r[t+16+4>>2]=r[e+4>>2];r[t+16+8>>2]=r[e+8>>2];r[t+16+12>>2]=r[e+12>>2];kA(t);return}function iT(t){t=t|0;return 13408}function nT(t){t=t|0;return 68}function sT(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0;n=Rk[r[(r[i>>2]|0)+40>>2]&31](i,t)|0;o=Rk[r[(r[i>>2]|0)+28>>2]&31](i,n)|0;r[e>>2]=o;if(o|0)lk[r[(r[i>>2]|0)+48>>2]&127](i,n);r[e+4>>2]=r[t+4>>2];r[e+28>>2]=r[t+32>>2];r[e+32>>2]=r[t+36>>2];r[e+36>>2]=r[t+40>>2];r[e+40>>2]=r[t+44>>2];r[e+12>>2]=r[t+16>>2];r[e+16>>2]=r[t+20>>2];r[e+20>>2]=r[t+24>>2];r[e+24>>2]=r[t+28>>2];r[e+44>>2]=r[t+48>>2];s=r[t+100>>2]|0;r[e+60>>2]=s;if(!s){r[e+52>>2]=0;r[e+56>>2]=0;return 13415}r[e+52>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,r[t+108>>2]|0)|0;r[e+56>>2]=0;o=yk[r[(r[i>>2]|0)+16>>2]&63](i,16,s)|0;if((s|0)>0){n=r[t+108>>2]|0;e=0;t=r[o+8>>2]|0;while(1){r[t>>2]=r[n+(e<<4)>>2];r[t+4>>2]=r[n+(e<<4)+4>>2];r[t+8>>2]=r[n+(e<<4)+8>>2];r[t+12>>2]=r[n+(e<<4)+12>>2];e=e+1|0;if((e|0)==(s|0))break;else t=t+16|0}}else n=r[t+108>>2]|0;sk[r[(r[i>>2]|0)+20>>2]&31](i,o,16354,1497453121,n);return 13415}function rT(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0;Vk[r[(r[e>>2]|0)+68>>2]&127](t,e,i);if(!(+xk[r[(r[e>>2]|0)+48>>2]&15](e)!=0.0))return;o=+h[i>>2];s=+h[i+4>>2];n=+h[i+8>>2];l=o*o+s*s+n*n<1.4210854715202004e-14?-1.0:o;a=o*o+s*s+n*n<1.4210854715202004e-14?-1.0:s;n=o*o+s*s+n*n<1.4210854715202004e-14?-1.0:n;s=1.0/+G(+(n*n+(l*l+a*a)));o=+xk[r[(r[e>>2]|0)+48>>2]&15](e);h[t>>2]=+h[t>>2]+o*(s*l);h[t+4>>2]=o*(s*a)+ +h[t+4>>2];h[t+8>>2]=o*(s*n)+ +h[t+8>>2];return}function oT(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0,o=0.0,a=0,l=0.0,c=0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0;c=r[e+100>>2]|0;if((c|0)<=0){r[t>>2]=0;r[t+4>>2]=0;r[t+8>>2]=0;r[t+12>>2]=0;return}p=+h[e+16>>2];f=+h[i>>2]*p;_=+h[e+20>>2];u=+h[i+4>>2]*_;d=+h[e+24>>2];l=+h[i+8>>2]*d;i=r[e+108>>2]|0;s=0;o=-3402823466385288598117041.0e14;a=-1;while(1){n=f*+h[i+(s<<4)>>2]+u*+h[i+(s<<4)+4>>2]+l*+h[i+(s<<4)+8>>2];e=n>o;a=e?s:a;s=s+1|0;if((s|0)==(c|0))break;else o=e?n:o}u=+h[i+(a<<4)+4>>2]*_;f=+h[i+(a<<4)+8>>2]*d;h[t>>2]=+h[i+(a<<4)>>2]*p;h[t+4>>2]=u;h[t+8>>2]=f;h[t+12>>2]=0.0;return}function aT(t,e,i,n,s,o,a){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;var l=0.0,c=0.0,u=0,p=0.0,f=0.0,m=0,g=0,b=0.0,y=0;g=_;_=_+16|0;h[n>>2]=3402823466385288598117041.0e14;h[s>>2]=-3402823466385288598117041.0e14;u=r[t+100>>2]|0;if((u|0)>0){m=0;do{y=r[t+108>>2]|0;b=+h[y+(m<<4)>>2]*+h[t+16>>2];f=+h[y+(m<<4)+4>>2]*+h[t+20>>2];p=+h[y+(m<<4)+8>>2]*+h[t+24>>2];l=b*+h[e>>2]+f*+h[e+4>>2]+p*+h[e+8>>2]+ +h[e+48>>2];c=b*+h[e+16>>2]+f*+h[e+20>>2]+p*+h[e+24>>2]+ +h[e+52>>2];p=b*+h[e+32>>2]+f*+h[e+36>>2]+p*+h[e+40>>2]+ +h[e+56>>2];f=l*+h[i>>2]+c*+h[i+4>>2]+p*+h[i+8>>2];if(f<+h[n>>2]){h[n>>2]=f;h[o>>2]=l;h[o+4>>2]=c;h[o+8>>2]=p;h[o+12>>2]=0.0}if(f>+h[s>>2]){h[s>>2]=f;h[a>>2]=l;h[a+4>>2]=c;h[a+8>>2]=p;h[a+12>>2]=0.0}m=m+1|0}while((m|0)!=(u|0));b=+h[s>>2];c=b;u=(h[d>>2]=b,r[d>>2]|0)}else{c=-3402823466385288598117041.0e14;u=-8388609}l=+h[n>>2];if(!(l>c)){_=g;return}r[n>>2]=u;h[s>>2]=l;r[g>>2]=r[o>>2];r[g+4>>2]=r[o+4>>2];r[g+8>>2]=r[o+8>>2];r[g+12>>2]=r[o+12>>2];r[o>>2]=r[a>>2];r[o+4>>2]=r[a+4>>2];r[o+8>>2]=r[a+8>>2];r[o+12>>2]=r[a+12>>2];r[a>>2]=r[g>>2];r[a+4>>2]=r[g+4>>2];r[a+8>>2]=r[g+8>>2];r[a+12>>2]=r[g+12>>2];_=g;return}function lT(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0,p=0,f=0,m=0.0,g=0,b=0.0,y=0;if((n|0)>0)s=0;else return;do{h[i+(s<<4)+12>>2]=-999999984306749440.0;s=s+1|0}while((s|0)!=(n|0));f=0;do{o=+h[t+16>>2];a=+h[e+(f<<4)>>2]*o;l=+h[t+20>>2];c=+h[e+(f<<4)+4>>2]*l;_=+h[t+24>>2];u=+h[e+(f<<4)+8>>2]*_;s=r[t+100>>2]|0;if((s|0)>0){d=r[t+108>>2]|0;p=0;m=-3402823466385288598117041.0e14;g=-1;do{b=a*+h[d+(p<<4)>>2]+c*+h[d+(p<<4)+4>>2]+u*+h[d+(p<<4)+8>>2];y=b>m;g=y?p:g;m=y?b:m;p=p+1|0}while((p|0)!=(s|0));u=+h[d+(g<<4)+4>>2]*l;b=+h[d+(g<<4)+8>>2]*_;h[i+(f<<4)>>2]=+h[d+(g<<4)>>2]*o;h[i+(f<<4)+4>>2]=u;h[i+(f<<4)+8>>2]=b;h[i+(f<<4)+12>>2]=m}else h[i+(f<<4)+12>>2]=-999999984306749440.0;f=f+1|0}while((f|0)!=(n|0));return}function hT(t){t=t|0;return r[t+100>>2]|0}function cT(t){t=t|0;return r[t+100>>2]|0}function _T(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0,l=0;a=r[t+100>>2]|0;l=r[t+108>>2]|0;s=+h[l+(((e|0)%(a|0)|0)<<4)+4>>2]*+h[t+20>>2];o=+h[l+(((e|0)%(a|0)|0)<<4)+8>>2]*+h[t+24>>2];h[i>>2]=+h[l+(((e|0)%(a|0)|0)<<4)>>2]*+h[t+16>>2];h[i+4>>2]=s;h[i+8>>2]=o;h[i+12>>2]=0.0;i=r[t+108>>2]|0;o=+h[i+(((e+1|0)%(a|0)|0)<<4)+4>>2]*+h[t+20>>2];s=+h[i+(((e+1|0)%(a|0)|0)<<4)+8>>2]*+h[t+24>>2];h[n>>2]=+h[i+(((e+1|0)%(a|0)|0)<<4)>>2]*+h[t+16>>2];h[n+4>>2]=o;h[n+8>>2]=s;h[n+12>>2]=0.0;return}function uT(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0;o=r[t+108>>2]|0;s=+h[o+(e<<4)+4>>2]*+h[t+20>>2];n=+h[o+(e<<4)+8>>2]*+h[t+24>>2];h[i>>2]=+h[o+(e<<4)>>2]*+h[t+16>>2];h[i+4>>2]=s;h[i+8>>2]=n;h[i+12>>2]=0.0;return}function dT(t){t=t|0;return 0}function pT(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;return}function fT(t,e,i){t=t|0;e=e|0;i=+i;return 0}function mT(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0,l=0,c=0,u=0,d=0;c=_;_=_+16|0;r[t+8>>2]=0;r[t+12>>2]=-1;r[t+16>>2]=1065353216;r[t+20>>2]=1065353216;r[t+24>>2]=1065353216;h[t+28>>2]=0.0;h[t+48>>2]=.03999999910593033;r[t+56>>2]=0;r[t+60>>2]=1065353216;r[t+64>>2]=1065353216;r[t+68>>2]=1065353216;h[t+72>>2]=0.0;r[t+76>>2]=-1082130432;r[t+80>>2]=-1082130432;r[t+84>>2]=-1082130432;h[t+88>>2]=0.0;n[t+92>>0]=0;r[t>>2]=5556;n[t+112>>0]=1;r[t+108>>2]=0;r[t+100>>2]=0;r[t+104>>2]=0;r[t+4>>2]=4;if((i|0)<=0){r[t+100>>2]=i;kA(t);_=c;return}r[5637]=(r[5637]|0)+1;o=Zl((i<<4|3)+16|0)|0;if(!o)l=0;else{r[(o+4+15&-16)+-4>>2]=o;l=o+4+15&-16}o=r[t+100>>2]|0;if((o|0)>0){a=0;do{u=l+(a<<4)|0;d=(r[t+108>>2]|0)+(a<<4)|0;r[u>>2]=r[d>>2];r[u+4>>2]=r[d+4>>2];r[u+8>>2]=r[d+8>>2];r[u+12>>2]=r[d+12>>2];a=a+1|0}while((a|0)!=(o|0))}o=r[t+108>>2]|0;if(o|0){if(n[t+112>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+108>>2]=0}n[t+112>>0]=1;r[t+108>>2]=l;r[t+104>>2]=i;r[l>>2]=r[c>>2];r[l+4>>2]=r[c+4>>2];r[l+8>>2]=r[c+8>>2];r[l+12>>2]=r[c+12>>2];if((i|0)!=1){o=1;do{d=(r[t+108>>2]|0)+(o<<4)|0;r[d>>2]=r[c>>2];r[d+4>>2]=r[c+4>>2];r[d+8>>2]=r[c+8>>2];r[d+12>>2]=r[c+12>>2];o=o+1|0}while((o|0)!=(i|0))}r[t+100>>2]=i;a=0;o=e;while(1){d=r[t+108>>2]|0;e=r[o+4>>2]|0;u=r[o+8>>2]|0;r[d+(a<<4)>>2]=r[o>>2];r[d+(a<<4)+4>>2]=e;r[d+(a<<4)+8>>2]=u;h[d+(a<<4)+12>>2]=0.0;a=a+1|0;if((a|0)==(i|0))break;else o=o+s|0}kA(t);_=c;return}function gT(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0,l=0,h=0,c=0;s=r[t+100>>2]|0;if((s|0)==(r[t+104>>2]|0)?(l=s|0?s<<1:1,(s|0)<(l|0)):0){if(!l)a=0;else{r[5637]=(r[5637]|0)+1;s=Zl((l<<4|3)+16|0)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}a=s;s=r[t+100>>2]|0}if((s|0)>0){o=0;do{h=a+(o<<4)|0;c=(r[t+108>>2]|0)+(o<<4)|0;r[h>>2]=r[c>>2];r[h+4>>2]=r[c+4>>2];r[h+8>>2]=r[c+8>>2];r[h+12>>2]=r[c+12>>2];o=o+1|0}while((o|0)!=(s|0))}s=r[t+108>>2]|0;if(s|0){if(n[t+112>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[t+108>>2]=0}n[t+112>>0]=1;r[t+108>>2]=a;r[t+104>>2]=l;s=r[t+100>>2]|0}c=(r[t+108>>2]|0)+(s<<4)|0;r[c>>2]=r[e>>2];r[c+4>>2]=r[e+4>>2];r[c+8>>2]=r[e+8>>2];r[c+12>>2]=r[e+12>>2];r[t+100>>2]=(r[t+100>>2]|0)+1;if(!i)return;kA(t);return}function bT(t,e){t=t|0;e=e|0;var i=0.0,n=0.0,s=0.0;s=+W(+ +h[e>>2]);n=+W(+ +h[e+4>>2]);i=+W(+ +h[e+8>>2]);h[t+16>>2]=s;h[t+20>>2]=n;h[t+24>>2]=i;h[t+28>>2]=0.0;return}function yT(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0;Vk[r[(r[e>>2]|0)+68>>2]&127](t,e,i);if(!(+xk[r[(r[e>>2]|0)+48>>2]&15](e)!=0.0))return;o=+h[i>>2];s=+h[i+4>>2];n=+h[i+8>>2];l=o*o+s*s+n*n<1.4210854715202004e-14?-1.0:o;a=o*o+s*s+n*n<1.4210854715202004e-14?-1.0:s;n=o*o+s*s+n*n<1.4210854715202004e-14?-1.0:n;s=1.0/+G(+(n*n+(l*l+a*a)));o=+xk[r[(r[e>>2]|0)+48>>2]&15](e);h[t>>2]=+h[t>>2]+o*(s*l);h[t+4>>2]=o*(s*a)+ +h[t+4>>2];h[t+8>>2]=o*(s*n)+ +h[t+8>>2];return}function vT(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0,a=0,l=0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0;a=_;_=_+96|0;s=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=0;do{m=a+80+(o<<2)|0;r[a+80>>2]=0;r[a+80+4>>2]=0;r[a+80+8>>2]=0;r[a+80+12>>2]=0;h[m>>2]=1.0;l=r[(r[t>>2]|0)+64>>2]|0;c=+h[a+80>>2];u=+h[a+80+4>>2];d=+h[a+80+8>>2];p=c*+h[e+4>>2]+u*+h[e+20>>2]+d*+h[e+36>>2];f=c*+h[e+8>>2]+u*+h[e+24>>2]+d*+h[e+40>>2];h[a+32>>2]=+h[e>>2]*c+ +h[e+16>>2]*u+ +h[e+32>>2]*d;h[a+32+4>>2]=p;h[a+32+8>>2]=f;h[a+32+12>>2]=0.0;Vk[l&127](a+64|0,t,a+32|0);f=+h[a+64>>2];p=+h[a+64+4>>2];d=+h[a+64+8>>2];u=f*+h[e+16>>2]+p*+h[e+20>>2]+d*+h[e+24>>2]+ +h[e+52>>2];c=f*+h[e+32>>2]+p*+h[e+36>>2]+d*+h[e+40>>2]+ +h[e+56>>2];h[a+48>>2]=f*+h[e>>2]+p*+h[e+4>>2]+d*+h[e+8>>2]+ +h[e+48>>2];h[a+48+4>>2]=u;h[a+48+8>>2]=c;h[a+48+12>>2]=0.0;l=a+48+(o<<2)|0;h[n+(o<<2)>>2]=s+ +h[l>>2];h[m>>2]=-1.0;m=r[(r[t>>2]|0)+64>>2]|0;c=+h[a+80>>2];u=+h[a+80+4>>2];d=+h[a+80+8>>2];p=c*+h[e+4>>2]+u*+h[e+20>>2]+d*+h[e+36>>2];f=c*+h[e+8>>2]+u*+h[e+24>>2]+d*+h[e+40>>2];h[a>>2]=+h[e>>2]*c+ +h[e+16>>2]*u+ +h[e+32>>2]*d;h[a+4>>2]=p;h[a+8>>2]=f;h[a+12>>2]=0.0;Vk[m&127](a+16|0,t,a);f=+h[a+16>>2];p=+h[a+16+4>>2];d=+h[a+16+8>>2];u=f*+h[e+16>>2]+p*+h[e+20>>2]+d*+h[e+24>>2]+ +h[e+52>>2];c=f*+h[e+32>>2]+p*+h[e+36>>2]+d*+h[e+40>>2]+ +h[e+56>>2];h[a+48>>2]=f*+h[e>>2]+p*+h[e+4>>2]+d*+h[e+8>>2]+ +h[e+48>>2];h[a+48+4>>2]=u;h[a+48+8>>2]=c;h[a+48+12>>2]=0.0;h[i+(o<<2)>>2]=+h[l>>2]-s;o=o+1|0}while((o|0)!=3);_=a;return}function ST(t){t=t|0;var e=0,i=0,s=0,o=0,a=0,l=0,h=0;r[t>>2]=5688;e=r[t+56>>2]|0;if(e|0){if(n[t+60>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+56>>2]=0}n[t+60>>0]=1;r[t+56>>2]=0;r[t+48>>2]=0;r[t+52>>2]=0;i=r[t+28>>2]|0;if((i|0)>0){h=0;do{s=r[t+36>>2]|0;o=s+(h*36|0)+4|0;a=s+(h*36|0)+12|0;l=r[a>>2]|0;e=s+(h*36|0)+16|0;if(l|0){if(n[e>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0)}r[a>>2]=0}n[e>>0]=1;r[a>>2]=0;r[o>>2]=0;r[s+(h*36|0)+8>>2]=0;h=h+1|0}while((h|0)!=(i|0))}e=r[t+36>>2]|0;if(e|0){if(n[t+40>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+36>>2]=0}n[t+40>>0]=1;r[t+36>>2]=0;r[t+28>>2]=0;r[t+32>>2]=0;e=r[t+16>>2]|0;if(!e){n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;t=t+12|0;r[t>>2]=0;return}if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+16>>2]=0;n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;t=t+12|0;r[t>>2]=0;return}function xT(t){t=t|0;ST(t);if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function wT(t){t=t|0;var e=0,i=0,n=0.0,s=0.0,o=0.0,a=0,l=0;a=r[t+28>>2]|0;n=0.0;s=0.0;o=0.0;l=0;t:while(1){switch(l|0){case 0:{n=+h[t+80>>2]+ +h[t+64>>2];s=+h[t+84>>2]+ +h[t+68>>2];o=+h[t+88>>2]+ +h[t+72>>2];break}case 1:{n=+h[t+80>>2]+ +h[t+64>>2];s=+h[t+84>>2]+ +h[t+68>>2];o=+h[t+72>>2]-+h[t+88>>2];break}case 2:{n=+h[t+80>>2]+ +h[t+64>>2];s=+h[t+68>>2]-+h[t+84>>2];o=+h[t+88>>2]+ +h[t+72>>2];break}case 3:{n=+h[t+80>>2]+ +h[t+64>>2];s=+h[t+68>>2]-+h[t+84>>2];o=+h[t+72>>2]-+h[t+88>>2];break}case 4:{n=+h[t+64>>2]-+h[t+80>>2];s=+h[t+84>>2]+ +h[t+68>>2];o=+h[t+88>>2]+ +h[t+72>>2];break}case 5:{n=+h[t+64>>2]-+h[t+80>>2];s=+h[t+84>>2]+ +h[t+68>>2];o=+h[t+72>>2]-+h[t+88>>2];break}case 6:{n=+h[t+64>>2]-+h[t+80>>2];s=+h[t+68>>2]-+h[t+84>>2];o=+h[t+88>>2]+ +h[t+72>>2];break}case 7:{n=+h[t+64>>2]-+h[t+80>>2];s=+h[t+68>>2]-+h[t+84>>2];o=+h[t+72>>2]-+h[t+88>>2];break}default:{}}if((a|0)>0){e=r[t+36>>2]|0;i=0;do{if(+h[e+(i*36|0)+32>>2]+(n*+h[e+(i*36|0)+20>>2]+s*+h[e+(i*36|0)+24>>2]+o*+h[e+(i*36|0)+28>>2])>0.0){e=0;i=16;break t}i=i+1|0}while((i|0)<(a|0))}l=l+1|0;if((l|0)>=8){e=1;i=16;break}}if((i|0)==16)return e|0;return 0}function CT(t,e,i,n,s,o,a){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;var l=0.0,c=0.0,u=0,p=0.0,f=0.0,m=0,g=0,b=0.0,y=0;g=_;_=_+16|0;h[n>>2]=3402823466385288598117041.0e14;h[s>>2]=-3402823466385288598117041.0e14;u=r[t+8>>2]|0;if((u|0)>0){m=0;do{y=r[t+16>>2]|0;b=+h[y+(m<<4)>>2];f=+h[y+(m<<4)+4>>2];p=+h[y+(m<<4)+8>>2];l=b*+h[e>>2]+f*+h[e+4>>2]+p*+h[e+8>>2]+ +h[e+48>>2];c=b*+h[e+16>>2]+f*+h[e+20>>2]+p*+h[e+24>>2]+ +h[e+52>>2];p=b*+h[e+32>>2]+f*+h[e+36>>2]+p*+h[e+40>>2]+ +h[e+56>>2];f=l*+h[i>>2]+c*+h[i+4>>2]+p*+h[i+8>>2];if(f<+h[n>>2]){h[n>>2]=f;h[o>>2]=l;h[o+4>>2]=c;h[o+8>>2]=p;h[o+12>>2]=0.0}if(f>+h[s>>2]){h[s>>2]=f;h[a>>2]=l;h[a+4>>2]=c;h[a+8>>2]=p;h[a+12>>2]=0.0}m=m+1|0}while((m|0)!=(u|0));b=+h[s>>2];c=b;u=(h[d>>2]=b,r[d>>2]|0)}else{c=-3402823466385288598117041.0e14;u=-8388609}l=+h[n>>2];if(!(l>c)){_=g;return}r[n>>2]=u;h[s>>2]=l;r[g>>2]=r[o>>2];r[g+4>>2]=r[o+4>>2];r[g+8>>2]=r[o+8>>2];r[g+12>>2]=r[o+12>>2];r[o>>2]=r[a>>2];r[o+4>>2]=r[a+4>>2];r[o+8>>2]=r[a+8>>2];r[o+12>>2]=r[a+12>>2];r[a>>2]=r[g>>2];r[a+4>>2]=r[g+4>>2];r[a+8>>2]=r[g+8>>2];r[a+12>>2]=r[g+12>>2];_=g;return}function TT(t){t=t|0;return}function AT(t,e,i,n,s,o,a){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;var l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0,y=0;b=_;_=_+64|0;m=+h[i>>2];f=+h[i+4>>2];g=+h[i+8>>2];l=m*+h[e+4>>2]+f*+h[e+20>>2]+g*+h[e+36>>2];c=m*+h[e+8>>2]+f*+h[e+24>>2]+g*+h[e+40>>2];h[b+48>>2]=+h[e>>2]*m+ +h[e+16>>2]*f+ +h[e+32>>2]*g;h[b+48+4>>2]=l;h[b+48+8>>2]=c;h[b+48+12>>2]=0.0;Vk[r[(r[t>>2]|0)+64>>2]&127](b+32|0,t,b+48|0);c=+h[b+32>>2];l=+h[b+32+4>>2];g=+h[b+32+8>>2];f=c*+h[e>>2]+l*+h[e+4>>2]+g*+h[e+8>>2]+ +h[e+48>>2];m=c*+h[e+16>>2]+l*+h[e+20>>2]+g*+h[e+24>>2]+ +h[e+52>>2];g=c*+h[e+32>>2]+l*+h[e+36>>2]+g*+h[e+40>>2]+ +h[e+56>>2];y=r[(r[t>>2]|0)+64>>2]|0;l=-+h[b+48+4>>2];c=-+h[b+48+8>>2];h[b>>2]=-+h[b+48>>2];h[b+4>>2]=l;h[b+8>>2]=c;h[b+12>>2]=0.0;Vk[y&127](b+16|0,t,b);c=+h[b+16>>2];l=+h[b+16+4>>2];u=+h[b+16+8>>2];d=c*+h[e>>2]+l*+h[e+4>>2]+u*+h[e+8>>2]+ +h[e+48>>2];p=c*+h[e+16>>2]+l*+h[e+20>>2]+u*+h[e+24>>2]+ +h[e+52>>2];u=c*+h[e+32>>2]+l*+h[e+36>>2]+u*+h[e+40>>2]+ +h[e+56>>2];h[n>>2]=f*+h[i>>2]+m*+h[i+4>>2]+g*+h[i+8>>2];h[s>>2]=d*+h[i>>2]+p*+h[i+4>>2]+u*+h[i+8>>2];h[a>>2]=d;h[a+4>>2]=p;h[a+8>>2]=u;h[a+12>>2]=0.0;h[o>>2]=f;h[o+4>>2]=m;h[o+8>>2]=g;h[o+12>>2]=0.0;l=+h[n>>2];c=+h[s>>2];if(!(l>c)){_=b;return}h[n>>2]=c;h[s>>2]=l;h[a>>2]=f;h[a+4>>2]=m;h[a+8>>2]=g;h[a+12>>2]=0.0;h[o>>2]=d;h[o+4>>2]=p;h[o+8>>2]=u;h[o+12>>2]=0.0;_=b;return}function ET(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0,o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,p=0,f=0.0,m=0.0,g=0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0;T=_;_=_+48|0;switch(r[e+4>>2]|0){case 8:{r[t>>2]=0;r[t+4>>2]=0;r[t+8>>2]=0;r[t+12>>2]=0;_=T;return}case 0:{x=+h[e+32>>2];w=+h[e+36>>2];w=+h[i+4>>2]>=0.0?w:-w;C=+h[e+40>>2];C=+h[i+8>>2]>=0.0?C:-C;h[t>>2]=+h[i>>2]>=0.0?x:-x;h[t+4>>2]=w;h[t+8>>2]=C;h[t+12>>2]=0.0;_=T;return}case 1:{v=+h[i>>2];S=+h[i+4>>2];C=+h[i+8>>2];w=v*+h[e+60>>2]+S*+h[e+60+4>>2]+C*+h[e+60+8>>2];x=v*+h[e+60+16>>2]+S*+h[e+60+20>>2]+C*+h[e+60+24>>2];C=v*+h[e+60+32>>2]+S*+h[e+60+36>>2]+C*+h[e+60+40>>2];i=w<x?x<C?2:1:w<C?2:0;p=r[e+60+(i<<4)+4>>2]|0;g=r[e+60+(i<<4)+8>>2]|0;r[t>>2]=r[e+60+(i<<4)>>2];r[t+4>>2]=p;r[t+8>>2]=g;h[t+12>>2]=0.0;_=T;return}case 13:{r[T+32>>2]=r[e+32>>2];r[T+32+4>>2]=r[e+32+4>>2];r[T+32+8>>2]=r[e+32+8>>2];r[T+32+12>>2]=r[e+32+12>>2];r[T+16>>2]=r[i>>2];s=r[i+4>>2]|0;r[T+16+4>>2]=s;g=r[i+8>>2]|0;r[T+16+8>>2]=g;h[T+16+12>>2]=0.0;i=r[e+56>>2]|0;n=(r[d>>2]=g,+h[d>>2]);switch(i|0){case 2:{n=(r[d>>2]=s,+h[d>>2]);s=0;e=2;p=1;break}case 1:{s=0;e=1;p=2;break}default:{s=1;e=0;p=2}}u=+h[T+32+(s<<2)>>2];l=+h[T+32+(i<<2)>>2];c=+h[T+16+(s<<2)>>2];o=+G(+(c*c+n*n));a=+h[T+16+(e<<2)>>2];if(o!=0.0){h[T+(s<<2)>>2]=c*(u/o);h[T+(e<<2)>>2]=a<0.0?-l:l;h[T+(p<<2)>>2]=u/o*n;r[t>>2]=r[T>>2];r[t+4>>2]=r[T+4>>2];r[t+8>>2]=r[T+8>>2]}else{h[T+(s<<2)>>2]=u;h[T+(e<<2)>>2]=a<0.0?-l:l;h[T+(p<<2)>>2]=0.0;r[t>>2]=r[T>>2];r[t+4>>2]=r[T+4>>2];r[t+8>>2]=r[T+8>>2]}h[t+12>>2]=0.0;_=T;return}case 10:{n=+h[i>>2];o=+h[i+4>>2];a=+h[i+8>>2];p=r[e+56>>2]|0;S=+h[e+32+(p<<2)>>2];l=+h[e+32+(((p+2|0)%3|0)<<2)>>2];if(n*n+o*o+a*a<9.999999747378752e-05){C=1.0;w=0.0;x=0.0}else{x=1.0/+G(+(n*n+o*o+a*a));C=n*x;w=o*x;x=a*x}r[T+32>>2]=0;r[T+32+4>>2]=0;r[T+32+8>>2]=0;r[T+32+12>>2]=0;h[T+32+(p<<2)>>2]=S;m=l*C;y=l*w;v=l*x;b=+h[e+48>>2];c=C*b;f=w*b;b=x*b;n=m+ +h[T+32>>2]-c;o=y+ +h[T+32+4>>2]-f;l=v+ +h[T+32+8>>2]-b;a=x*l+(C*n+w*o);if(a>-999999984306749440.0){e=(h[d>>2]=n,r[d>>2]|0);s=(h[d>>2]=o,r[d>>2]|0);u=a;i=(h[d>>2]=l,r[d>>2]|0)}else{u=-999999984306749440.0;e=0;i=0;s=0}r[T+32>>2]=0;r[T+32+4>>2]=0;r[T+32+8>>2]=0;r[T+32+12>>2]=0;h[T+32+(p<<2)>>2]=-S;a=m+ +h[T+32>>2]-c;o=y+ +h[T+32+4>>2]-f;n=v+ +h[T+32+8>>2]-b;if(x*n+(C*a+w*o)>u){e=(h[d>>2]=a,r[d>>2]|0);s=(h[d>>2]=o,r[d>>2]|0);i=(h[d>>2]=n,r[d>>2]|0)}r[t>>2]=e;r[t+4>>2]=s;r[t+8>>2]=i;h[t+12>>2]=0.0;_=T;return}case 5:{g=r[e+96>>2]|0;p=r[e+100>>2]|0;f=+h[e+16>>2];m=+h[e+20>>2];u=+h[e+24>>2];l=+h[i>>2]*f;c=+h[i+4>>2]*m;n=+h[i+8>>2]*u;if((p|0)>0){e=0;a=-3402823466385288598117041.0e14;s=-1;while(1){o=l*+h[g+(e<<4)>>2]+c*+h[g+(e<<4)+4>>2]+n*+h[g+(e<<4)+8>>2];i=o>a;s=i?e:s;e=e+1|0;if((e|0)==(p|0))break;else a=i?o:a}}else s=-1;w=m*+h[g+(s<<4)+4>>2];C=u*+h[g+(s<<4)+8>>2];h[t>>2]=f*+h[g+(s<<4)>>2];h[t+4>>2]=w;h[t+8>>2]=C;h[t+12>>2]=0.0;_=T;return}case 4:{g=r[e+108>>2]|0;p=r[e+100>>2]|0;f=+h[e+16>>2];m=+h[e+20>>2];u=+h[e+24>>2];l=+h[i>>2]*f;c=+h[i+4>>2]*m;n=+h[i+8>>2]*u;if((p|0)>0){e=0;a=-3402823466385288598117041.0e14;s=-1;while(1){o=l*+h[g+(e<<4)>>2]+c*+h[g+(e<<4)+4>>2]+n*+h[g+(e<<4)+8>>2];i=o>a;s=i?e:s;e=e+1|0;if((e|0)==(p|0))break;else a=i?o:a}}else s=-1;w=m*+h[g+(s<<4)+4>>2];C=u*+h[g+(s<<4)+8>>2];h[t>>2]=f*+h[g+(s<<4)>>2];h[t+4>>2]=w;h[t+8>>2]=C;h[t+12>>2]=0.0;_=T;return}default:{Vk[r[(r[e>>2]|0)+68>>2]&127](t,e,i);_=T;return}}}function MT(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0,l=0.0;a=_;_=_+32|0;r[a+16>>2]=r[i>>2];r[a+16+4>>2]=r[i+4>>2];r[a+16+8>>2]=r[i+8>>2];r[a+16+12>>2]=r[i+12>>2];n=+h[a+16>>2];o=+h[a+16+4>>2];s=+h[a+16+8>>2];if(n*n+o*o+s*s<1.4210854715202004e-14){r[a+16>>2]=-1082130432;r[a+16+4>>2]=-1082130432;r[a+16+8>>2]=-1082130432;h[a+16+12>>2]=0.0;n=-1.0;o=-1.0;s=-1.0}l=1.0/+G(+(n*n+o*o+s*s));h[a+16>>2]=n*l;h[a+16+4>>2]=o*l;h[a+16+8>>2]=s*l;ET(a,e,a+16|0);switch(r[e+4>>2]|0){case 8:{n=+h[e+32>>2]*+h[e+16>>2];break}case 0:{n=+h[e+48>>2];break}case 1:{n=+h[e+48>>2];break}case 13:{n=+h[e+48>>2];break}case 11:{n=+h[e+48>>2];break}case 10:{n=+h[e+48>>2];break}case 4:case 5:{n=+h[e+48>>2];break}default:n=+xk[r[(r[e>>2]|0)+48>>2]&15](e)}o=n*+h[a+16+4>>2]+ +h[a+4>>2];l=n*+h[a+16+8>>2]+ +h[a+8>>2];h[t>>2]=n*+h[a+16>>2]+ +h[a>>2];h[t+4>>2]=o;h[t+8>>2]=l;h[t+12>>2]=0.0;_=a;return}function RT(t){t=t|0;var e=0,i=0;r[t>>2]=6248;e=r[t+56>>2]|0;if(e|0?(ok[r[r[e>>2]>>2]&255](e),i=r[t+56>>2]|0,i|0):0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function IT(t,e){t=t|0;e=e|0;var i=0;i=(r[t+96>>2]|0)+4|0;r[i>>2]=r[e>>2];r[i+4>>2]=r[e+4>>2];r[i+8>>2]=r[e+8>>2];r[i+12>>2]=r[e+12>>2];kA(t);return}function PT(t){t=t|0;return(r[t+96>>2]|0)+4|0}function LT(t){t=t|0;return 13526}function DT(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0;Vk[r[(r[e>>2]|0)+68>>2]&127](t,e,i);if(!(+xk[r[(r[e>>2]|0)+48>>2]&15](e)!=0.0))return;o=+h[i>>2];s=+h[i+4>>2];n=+h[i+8>>2];l=o*o+s*s+n*n<1.4210854715202004e-14?-1.0:o;a=o*o+s*s+n*n<1.4210854715202004e-14?-1.0:s;n=o*o+s*s+n*n<1.4210854715202004e-14?-1.0:n;s=1.0/+G(+(n*n+(l*l+a*a)));o=+xk[r[(r[e>>2]|0)+48>>2]&15](e);h[t>>2]=+h[t>>2]+o*(s*l);h[t+4>>2]=o*(s*a)+ +h[t+4>>2];h[t+8>>2]=o*(s*n)+ +h[t+8>>2];return}function kT(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0,l=0,c=0,u=0,p=0.0;c=_;_=_+80|0;r[t>>2]=0;r[t+4>>2]=0;r[t+8>>2]=0;r[t+12>>2]=0;n=+h[i>>2];s=+h[i+4>>2];o=+h[i+8>>2];if(n*n+s*s+o*o<9.999999747378752e-05){l=1065353216;a=0;n=0.0;i=0}else{p=1.0/+G(+(n*n+s*s+o*o));l=(h[d>>2]=n*p,r[d>>2]|0);u=(h[d>>2]=s*p,r[d>>2]|0);a=(h[d>>2]=o*p,r[d>>2]|0);n=+h[i+12>>2];i=u}r[c+32>>2]=5836;u=c+32+4|0;r[u>>2]=0;r[u+4>>2]=0;r[u+8>>2]=0;r[u+12>>2]=0;h[c+32+20>>2]=-999999984306749440.0;r[c+32+24>>2]=l;r[c+32+28>>2]=i;r[c+32+32>>2]=a;h[c+32+36>>2]=n;r[c+16>>2]=1566444395;r[c+16+4>>2]=1566444395;r[c+16+8>>2]=1566444395;h[c+16+12>>2]=0.0;e=r[e+96>>2]|0;l=r[(r[e>>2]|0)+8>>2]|0;h[c>>2]=-999999984306749440.0;h[c+4>>2]=-999999984306749440.0;h[c+8>>2]=-999999984306749440.0;h[c+12>>2]=0.0;jk[l&127](e,c+32|0,c,c+16|0);r[t>>2]=r[u>>2];r[t+4>>2]=r[u+4>>2];r[t+8>>2]=r[u+8>>2];r[t+12>>2]=r[u+12>>2];_=c;return}function OT(t){t=t|0;Ql(t);return}function FT(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0;l=+h[t+24>>2];c=+h[t+28>>2];a=+h[t+32>>2];s=l*+h[e>>2]+c*+h[e+4>>2]+a*+h[e+8>>2];o=+h[t+20>>2];if(s>o){h[t+20>>2]=s;r[t+4>>2]=r[e>>2];r[t+4+4>>2]=r[e+4>>2];r[t+4+8>>2]=r[e+8>>2];r[t+4+12>>2]=r[e+12>>2]}else s=o;o=l*+h[e+16>>2]+c*+h[e+20>>2]+a*+h[e+24>>2];if(o>s){h[t+20>>2]=o;r[t+4>>2]=r[e+16>>2];r[t+4+4>>2]=r[e+16+4>>2];r[t+4+8>>2]=r[e+16+8>>2];r[t+4+12>>2]=r[e+16+12>>2]}else o=s;s=l*+h[e+32>>2]+c*+h[e+36>>2]+a*+h[e+40>>2];if(!(s>o))return;h[t+20>>2]=s;r[t+4>>2]=r[e+32>>2];r[t+4+4>>2]=r[e+32+4>>2];r[t+4+8>>2]=r[e+32+8>>2];r[t+4+12>>2]=r[e+32+12>>2];return}function BT(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0,a=0,l=0,c=0;a=_;_=_+80|0;if((n|0)>0)s=0;else{_=a;return}do{h[i+(s<<4)+12>>2]=-999999984306749440.0;s=s+1|0}while((s|0)!=(n|0));s=a+32+4|0;o=0;do{l=e+(o<<4)|0;r[a+32>>2]=5836;r[s>>2]=0;r[s+4>>2]=0;r[s+8>>2]=0;r[s+12>>2]=0;h[a+32+20>>2]=-999999984306749440.0;r[a+32+24>>2]=r[l>>2];r[a+32+24+4>>2]=r[l+4>>2];r[a+32+24+8>>2]=r[l+8>>2];r[a+32+24+12>>2]=r[l+12>>2];r[a+16>>2]=1566444395;r[a+16+4>>2]=1566444395;r[a+16+8>>2]=1566444395;h[a+16+12>>2]=0.0;l=r[t+96>>2]|0;c=r[(r[l>>2]|0)+8>>2]|0;h[a>>2]=-999999984306749440.0;h[a+4>>2]=-999999984306749440.0;h[a+8>>2]=-999999984306749440.0;h[a+12>>2]=0.0;jk[c&127](l,a+32|0,a,a+16|0);l=i+(o<<4)|0;r[l>>2]=r[s>>2];r[l+4>>2]=r[s+4>>2];r[l+8>>2]=r[s+8>>2];r[l+12>>2]=r[s+12>>2];o=o+1|0}while((o|0)<(n|0));_=a;return}function NT(t){t=t|0;return 0}function UT(t){t=t|0;return 0}function VT(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;return}function zT(t,e,i){t=t|0;e=e|0;i=i|0;return}function WT(t){t=t|0;return 0}function GT(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;return}function jT(t,e,i){t=t|0;e=e|0;i=+i;return 0}function HT(t,e,i){t=t|0;e=e|0;i=i|0;r[t+8>>2]=0;r[t+12>>2]=-1;r[t+16>>2]=1065353216;r[t+20>>2]=1065353216;r[t+24>>2]=1065353216;h[t+28>>2]=0.0;h[t+48>>2]=.03999999910593033;r[t+56>>2]=0;r[t+60>>2]=1065353216;r[t+64>>2]=1065353216;r[t+68>>2]=1065353216;h[t+72>>2]=0.0;r[t+76>>2]=-1082130432;r[t+80>>2]=-1082130432;r[t+84>>2]=-1082130432;h[t+88>>2]=0.0;n[t+92>>0]=0;r[t>>2]=5704;r[t+96>>2]=e;r[t+4>>2]=3;if(!i)return;kA(t);return}function XT(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function YT(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0;a=+xk[r[(r[t>>2]|0)+48>>2]&15](t);u=a+ +h[t+32>>2];c=a+ +h[t+36>>2];a=a+ +h[t+40>>2];v=+W(+ +h[e>>2]);y=+W(+ +h[e+4>>2]);b=+W(+ +h[e+8>>2]);m=+W(+ +h[e+16>>2]);f=+W(+ +h[e+20>>2]);p=+W(+ +h[e+24>>2]);_=+W(+ +h[e+32>>2]);l=+W(+ +h[e+36>>2]);o=+W(+ +h[e+40>>2]);g=+h[e+48>>2];d=+h[e+52>>2];s=+h[e+56>>2];h[i>>2]=g-(u*v+c*y+a*b);h[i+4>>2]=d-(u*m+c*f+a*p);h[i+8>>2]=s-(u*_+c*l+a*o);h[i+12>>2]=0.0;h[n>>2]=u*v+c*y+a*b+g;h[n+4>>2]=u*m+c*f+a*p+d;h[n+8>>2]=u*_+c*l+a*o+s;h[n+12>>2]=0.0;return}function qT(t,e){t=t|0;e=e|0;var i=0.0,n=0.0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0;c=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=+xk[r[(r[t>>2]|0)+48>>2]&15](t);i=+xk[r[(r[t>>2]|0)+48>>2]&15](t);u=(c+ +h[t+32>>2])/+h[t+16>>2];l=(o+ +h[t+36>>2])/+h[t+20>>2];s=(i+ +h[t+40>>2])/+h[t+24>>2];_=+W(+ +h[e>>2]);a=+W(+ +h[e+4>>2]);n=+W(+ +h[e+8>>2]);h[t+16>>2]=_;h[t+20>>2]=a;h[t+24>>2]=n;h[t+28>>2]=0.0;h[t+32>>2]=u*_-c;h[t+36>>2]=l*a-o;h[t+40>>2]=s*n-i;h[t+44>>2]=0.0;return}function KT(t,e,i){t=t|0;e=+e;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0;n=+h[t+32>>2];a=+h[t+36>>2];o=+h[t+40>>2];l=+xk[r[(r[t>>2]|0)+48>>2]&15](t);s=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=+xk[r[(r[t>>2]|0)+48>>2]&15](t)+o;switch(r[t+56>>2]|0){case 0:{l=e*.25*((s+a)*(s+a))+e/12.0*((l+n)*((l+n)*4.0));h[i>>2]=e*.5*((s+a)*(s+a));h[i+4>>2]=l;h[i+8>>2]=l;h[i+12>>2]=0.0;return}case 2:{h[i>>2]=e*.25*((l+n)*(l+n))+e/12.0*(o*(o*4.0));h[i+4>>2]=e*.25*((l+n)*(l+n))+e/12.0*(o*(o*4.0));h[i+8>>2]=e*.5*((l+n)*(l+n));h[i+12>>2]=0.0;return}default:{a=e*.25*((l+n)*(l+n))+e/12.0*((s+a)*((s+a)*4.0));h[i>>2]=a;h[i+4>>2]=e*.5*((l+n)*(l+n));h[i+8>>2]=a;h[i+12>>2]=0.0;return}}}function ZT(t){t=t|0;return 13587}function QT(t,e){t=t|0;e=e|0;r[t>>2]=0;r[t+4>>2]=0;r[t+8>>2]=0;r[t+12>>2]=0;h[t+(r[e+56>>2]<<2)>>2]=1.0;return}function $T(t,e){t=t|0;e=+e;var i=0.0,n=0.0,s=0.0,o=0.0,a=0.0;o=+xk[r[(r[t>>2]|0)+48>>2]&15](t);n=+xk[r[(r[t>>2]|0)+48>>2]&15](t);a=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=o+ +h[t+32>>2];n=n+ +h[t+36>>2];a=a+ +h[t+40>>2];h[t+48>>2]=e;s=+xk[r[(r[t>>2]|0)+48>>2]&15](t);i=+xk[r[(r[t>>2]|0)+48>>2]&15](t);e=a-+xk[r[(r[t>>2]|0)+48>>2]&15](t);h[t+32>>2]=o-s;h[t+36>>2]=n-i;h[t+40>>2]=e;h[t+44>>2]=0.0;return}function JT(t){t=t|0;return 60}function tA(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0;n=Rk[r[(r[i>>2]|0)+40>>2]&31](i,t)|0;s=Rk[r[(r[i>>2]|0)+28>>2]&31](i,n)|0;r[e>>2]=s;if(s|0)lk[r[(r[i>>2]|0)+48>>2]&127](i,n);r[e+4>>2]=r[t+4>>2];r[e+28>>2]=r[t+32>>2];r[e+32>>2]=r[t+36>>2];r[e+36>>2]=r[t+40>>2];r[e+40>>2]=r[t+44>>2];r[e+12>>2]=r[t+16>>2];r[e+16>>2]=r[t+20>>2];r[e+20>>2]=r[t+24>>2];r[e+24>>2]=r[t+28>>2];r[e+44>>2]=r[t+48>>2];r[e+52>>2]=r[t+56>>2];return 13597}function eA(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0;n=_;_=_+16|0;Vk[r[(r[e>>2]|0)+68>>2]&127](n,e,i);r[t>>2]=r[n>>2];r[t+4>>2]=r[n+4>>2];r[t+8>>2]=r[n+8>>2];r[t+12>>2]=r[n+12>>2];if(!(+xk[r[(r[e>>2]|0)+48>>2]&15](e)!=0.0)){_=n;return}a=+h[i>>2];o=+h[i+4>>2];s=+h[i+8>>2];c=a*a+o*o+s*s<1.4210854715202004e-14?-1.0:a;l=a*a+o*o+s*s<1.4210854715202004e-14?-1.0:o;s=a*a+o*o+s*s<1.4210854715202004e-14?-1.0:s;o=1.0/+G(+(s*s+(c*c+l*l)));a=+xk[r[(r[e>>2]|0)+48>>2]&15](e);h[t>>2]=+h[t>>2]+a*(o*c);h[t+4>>2]=a*(o*l)+ +h[t+4>>2];h[t+8>>2]=a*(o*s)+ +h[t+8>>2];_=n;return}function iA(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,r=0.0,o=0.0,a=0.0,l=0.0;n=+h[e+32>>2];o=+h[e+36>>2];l=+h[i>>2];r=+h[i+8>>2];a=+G(+(l*l+r*r));s=+h[i+4>>2];if(a!=0.0){r=r*(n/a);s=s<0.0?-o:o;n=l*(n/a)}else{r=0.0;s=s<0.0?-o:o}h[t>>2]=n;h[t+4>>2]=s;h[t+8>>2]=r;return}function nA(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,r=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0;if((n|0)<=0)return;u=0;do{s=+h[t+32>>2];a=+h[t+36>>2];_=+h[e+(u<<4)>>2];r=+h[e+(u<<4)+8>>2];c=+G(+(_*_+r*r));o=+h[e+(u<<4)+4>>2];if(c!=0.0){l=r*(s/c);r=o<0.0?-a:a;s=_*(s/c)}else{l=0.0;r=o<0.0?-a:a}h[i+(u<<4)>>2]=s;h[i+(u<<4)+4>>2]=r;h[i+(u<<4)+8>>2]=l;u=u+1|0}while((u|0)!=(n|0));return}function sA(t){t=t|0;var e=0.0,i=0.0;i=+h[t+32>>2];e=+xk[r[(r[t>>2]|0)+48>>2]&15](t);+xk[r[(r[t>>2]|0)+48>>2]&15](t);+xk[r[(r[t>>2]|0)+48>>2]&15](t);return+(i+e)}function rA(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function oA(t){t=t|0;return 13636}function aA(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,r=0.0,o=0.0,a=0.0,l=0.0;n=+h[e+36>>2];r=+h[e+32>>2];l=+h[i+4>>2];s=+h[i+8>>2];a=+G(+(l*l+s*s));if(a!=0.0){o=s*(n/a);s=+h[i>>2]<0.0?-r:r;n=l*(n/a)}else{o=0.0;s=+h[i>>2]<0.0?-r:r}h[t+4>>2]=n;h[t>>2]=s;h[t+8>>2]=o;return}function lA(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,r=0.0,o=0.0,a=0,l=0.0,c=0.0,_=0.0,u=0;if((n|0)<=0)return;u=0;do{s=+h[t+36>>2];o=+h[t+32>>2];a=e+(u<<4)|0;_=+h[e+(u<<4)+4>>2];r=+h[e+(u<<4)+8>>2];c=+G(+(_*_+r*r));if(c!=0.0){l=r*(s/c);r=+h[a>>2]<0.0?-o:o;s=_*(s/c)}else{l=0.0;r=+h[a>>2]<0.0?-o:o}h[i+(u<<4)>>2]=r;h[i+(u<<4)+4>>2]=s;h[i+(u<<4)+8>>2]=l;u=u+1|0}while((u|0)!=(n|0));return}function hA(t){t=t|0;var e=0.0,i=0.0;i=+h[t+36>>2];+xk[r[(r[t>>2]|0)+48>>2]&15](t);e=+xk[r[(r[t>>2]|0)+48>>2]&15](t);+xk[r[(r[t>>2]|0)+48>>2]&15](t);return+(i+e)}function cA(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function _A(t){t=t|0;return 13665}function uA(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,r=0.0,o=0.0,a=0.0,l=0.0;n=+h[e+32>>2];o=+h[e+40>>2];l=+h[i>>2];r=+h[i+4>>2];a=+G(+(l*l+r*r));s=+h[i+8>>2];if(a!=0.0){r=r*(n/a);s=s<0.0?-o:o;n=l*(n/a)}else{r=0.0;s=s<0.0?-o:o}h[t>>2]=n;h[t+8>>2]=s;h[t+4>>2]=r;return}function dA(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,r=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0;if((n|0)<=0)return;u=0;do{s=+h[t+32>>2];a=+h[t+40>>2];_=+h[e+(u<<4)>>2];r=+h[e+(u<<4)+4>>2];c=+G(+(_*_+r*r));o=+h[e+(u<<4)+8>>2];if(c!=0.0){l=r*(s/c);r=o<0.0?-a:a;s=_*(s/c)}else{l=0.0;r=o<0.0?-a:a}h[i+(u<<4)>>2]=s;h[i+(u<<4)+4>>2]=l;h[i+(u<<4)+8>>2]=r;u=u+1|0}while((u|0)!=(n|0));return}function pA(t){t=t|0;var e=0.0,i=0.0;i=+h[t+32>>2];e=+xk[r[(r[t>>2]|0)+48>>2]&15](t);+xk[r[(r[t>>2]|0)+48>>2]&15](t);+xk[r[(r[t>>2]|0)+48>>2]&15](t);return+(i+e)}function fA(t,e){t=t|0;e=e|0;var i=0.0,n=0,s=0.0,o=0.0,a=0.0,l=0.0;r[t+4>>2]=35;r[t+8>>2]=0;r[t+12>>2]=-1;r[t+16>>2]=1065353216;r[t+20>>2]=1065353216;r[t+24>>2]=1065353216;h[t+28>>2]=0.0;h[t+48>>2]=.03999999910593033;r[t>>2]=5856;r[t+56>>2]=1;o=+h[e>>2];s=+h[e+4>>2];i=+h[e+8>>2];i=+h[e+((o<s?o<i?0:2:s<i?1:2)<<2)>>2]*.10000000149011612;if(i<.03999999910593033){l=+Ow(t);a=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=+xk[r[(r[t>>2]|0)+48>>2]&15](t);l=l+ +h[t+32>>2];a=a+ +h[t+36>>2];o=o+ +h[t+40>>2];h[t+48>>2]=i;i=+xk[r[(r[t>>2]|0)+48>>2]&15](t);s=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=o-+xk[r[(r[t>>2]|0)+48>>2]&15](t);h[t+32>>2]=l-i;h[t+36>>2]=a-s;h[t+40>>2]=o;h[t+44>>2]=0.0;n=r[t>>2]|0}else n=5856;o=+xk[r[n+48>>2]&15](t);a=+xk[r[(r[t>>2]|0)+48>>2]&15](t);l=+xk[r[(r[t>>2]|0)+48>>2]&15](t);a=+h[e+4>>2]*+h[t+20>>2]-a;l=+h[e+8>>2]*+h[t+24>>2]-l;h[t+32>>2]=+h[e>>2]*+h[t+16>>2]-o;h[t+36>>2]=a;h[t+40>>2]=l;h[t+44>>2]=0.0;r[t+4>>2]=13;return}function mA(t){t=t|0;GL(t);return}function gA(t){t=t|0;GL(t);if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function bA(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;HL(t,e,i,n)|0;return 1}function yA(t,e,i,o,a){t=t|0;e=e|0;i=i|0;o=o|0;a=a|0;var l=0.0,c=0.0,u=0,d=0,p=0,f=0.0,m=0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0;A=_;_=_+160|0;n[t+60>>0]=i&1;if(i){g=+h[o>>2]+-1.0;v=+h[o+4>>2]+-1.0;b=+h[o+8>>2]+-1.0;h[t+4>>2]=g;h[t+8>>2]=v;h[t+12>>2]=b;h[t+16>>2]=0.0;S=+h[a>>2]+1.0;w=+h[a+4>>2]+1.0;C=+h[a+8>>2]+1.0;h[t+20>>2]=S;h[t+24>>2]=w;h[t+28>>2]=C;h[t+32>>2]=0.0;h[t+36>>2]=65533.0/(S-g);h[t+40>>2]=65533.0/(w-v);h[t+44>>2]=65533.0/(C-b);h[t+48>>2]=0.0;n[t+60>>0]=1;l=g+ +(~~((g-g)*(65533.0/(S-g)))&65534)/(65533.0/(S-g))+-1.0;c=v+ +(~~((v-v)*(65533.0/(w-v)))&65534)/(65533.0/(w-v))+-1.0;f=b+ +(~~((b-b)*(65533.0/(C-b)))&65534)/(65533.0/(C-b))+-1.0;if(l<g){h[t+4>>2]=l;T=l}else T=g;if(c<v){h[t+8>>2]=c;x=c}else x=v;if(f<b){h[t+12>>2]=f;y=f}else y=b;f=T+ +((~~((S-T)*(65533.0/(S-g))+1.0)&65535|1)&65535)/(65533.0/(S-g))+1.0;c=x+ +((~~((w-x)*(65533.0/(w-v))+1.0)&65535|1)&65535)/(65533.0/(w-v))+1.0;l=y+ +((~~((C-y)*(65533.0/(C-b))+1.0)&65535|1)&65535)/(65533.0/(C-b))+1.0;if(S<f)h[t+20>>2]=f;else f=S;if(w<c)h[t+24>>2]=c;else c=w;if(C<l)h[t+28>>2]=l;else l=C;h[t+36>>2]=65533.0/(f-T);h[t+40>>2]=65533.0/(c-x);h[t+44>>2]=65533.0/(l-y);h[t+48>>2]=0.0;r[A+144>>2]=6208;r[A+144+4>>2]=t+104;r[A+144+8>>2]=t;jk[r[(r[e>>2]|0)+8>>2]&127](e,A+144|0,t+4|0,t+20|0);i=r[t+108>>2]|0;r[A+128>>2]=0;r[A+128+4>>2]=0;r[A+128+8>>2]=0;r[A+128+12>>2]=0;u=r[t+128>>2]|0;if((u|0)<(i<<1|0)){if((r[t+132>>2]|0)<(i<<1|0)){if(!i){o=0;a=u}else{r[5637]=(r[5637]|0)+1;o=Zl(i<<5|19)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}a=r[t+128>>2]|0}if((a|0)>0){e=0;do{m=o+(e<<4)|0;p=(r[t+136>>2]|0)+(e<<4)|0;r[m>>2]=r[p>>2];r[m+4>>2]=r[p+4>>2];r[m+8>>2]=r[p+8>>2];r[m+12>>2]=r[p+12>>2];e=e+1|0}while((e|0)!=(a|0))}a=r[t+136>>2]|0;if(a|0){if(n[t+140>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+136>>2]=0}n[t+140>>0]=1;r[t+136>>2]=o;r[t+132>>2]=i<<1;a=t+136|0}else a=t+136|0;o=u;do{m=(r[a>>2]|0)+(o<<4)|0;r[m>>2]=r[A+128>>2];r[m+4>>2]=r[A+128+4>>2];r[m+8>>2]=r[A+128+8>>2];r[m+12>>2]=r[A+128+12>>2];o=o+1|0}while((o|0)!=(i<<1|0))}r[t+128>>2]=i<<1}else{r[A+144>>2]=6228;r[A+144+4>>2]=t+64;r[A+112>>2]=-581039253;r[A+112+4>>2]=-581039253;r[A+112+8>>2]=-581039253;h[A+112+12>>2]=0.0;r[A+96>>2]=1566444395;r[A+96+4>>2]=1566444395;r[A+96+8>>2]=1566444395;h[A+96+12>>2]=0.0;jk[r[(r[e>>2]|0)+8>>2]&127](e,A+144|0,A+112|0,A+96|0);i=r[t+68>>2]|0;u=A+32|0;p=u+64|0;do{r[u>>2]=0;u=u+4|0}while((u|0)<(p|0));m=r[t+88>>2]|0;if((m|0)<(i<<1|0)){if((r[t+92>>2]|0)<(i<<1|0)){if(!i){o=0;a=m}else{r[5637]=(r[5637]|0)+1;o=Zl(i<<7|19)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}a=r[t+88>>2]|0}if((a|0)>0){e=0;do{u=o+(e<<6)|0;d=(r[t+96>>2]|0)+(e<<6)|0;p=u+64|0;do{r[u>>2]=r[d>>2];u=u+4|0;d=d+4|0}while((u|0)<(p|0));e=e+1|0}while((e|0)!=(a|0))}a=r[t+96>>2]|0;if(a|0){if(n[t+100>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+96>>2]=0}n[t+100>>0]=1;r[t+96>>2]=o;r[t+92>>2]=i<<1;a=t+96|0}else a=t+96|0;o=m;do{u=(r[a>>2]|0)+(o<<6)|0;d=A+32|0;p=u+64|0;do{r[u>>2]=r[d>>2];u=u+4|0;d=d+4|0}while((u|0)<(p|0));o=o+1|0}while((o|0)!=(i<<1|0))}r[t+88>>2]=i<<1}r[t+56>>2]=0;ZL(t,0,i);if(n[t+60>>0]|0?(r[t+152>>2]|0)==0:0){if(!(r[t+156>>2]|0)){r[5637]=(r[5637]|0)+1;i=Zl(51)|0;if(!i)e=0;else{r[(i+4+15&-16)+-4>>2]=i;e=i+4+15&-16}i=r[t+152>>2]|0;if((i|0)>0){o=0;do{m=e+(o<<5)|0;p=(r[t+160>>2]|0)+(o<<5)|0;r[m>>2]=r[p>>2];r[m+4>>2]=r[p+4>>2];r[m+8>>2]=r[p+8>>2];r[m+12>>2]=r[p+12>>2];r[m+16>>2]=r[p+16>>2];r[m+20>>2]=r[p+20>>2];r[m+24>>2]=r[p+24>>2];r[m+28>>2]=r[p+28>>2];o=o+1|0}while((o|0)!=(i|0))}i=r[t+160>>2]|0;if(i|0){if(n[t+164>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[t+160>>2]=0}n[t+164>>0]=1;r[t+160>>2]=e;r[t+156>>2]=1;o=t+160|0;a=(r[t+152>>2]|0)+1|0;i=e}else{o=t+160|0;a=1;i=r[t+160>>2]|0}r[t+152>>2]=a;r[i>>2]=r[A>>2];r[i+4>>2]=r[A+4>>2];r[i+8>>2]=r[A+8>>2];r[i+12>>2]=r[A+12>>2];r[i+16>>2]=r[A+16>>2];r[i+20>>2]=r[A+20>>2];r[i+24>>2]=r[A+24>>2];r[i+28>>2]=r[A+28>>2];m=r[o>>2]|0;p=r[t+136>>2]|0;s[m>>1]=s[p>>1]|0;s[m+2>>1]=s[p+2>>1]|0;s[m+4>>1]=s[p+4>>1]|0;s[m+6>>1]=s[p+6>>1]|0;s[m+8>>1]=s[p+8>>1]|0;s[m+10>>1]=s[p+10>>1]|0;r[m+12>>2]=0;p=r[p+12>>2]|0;r[m+16>>2]=(p|0)>-1?1:0-p|0}r[t+168>>2]=r[t+152>>2];i=r[t+116>>2]|0;if(i|0){if(n[t+120>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[t+116>>2]=0}n[t+120>>0]=1;r[t+116>>2]=0;r[t+108>>2]=0;r[t+112>>2]=0;i=r[t+76>>2]|0;if(!i){n[t+80>>0]=1;r[t+76>>2]=0;r[t+68>>2]=0;t=t+72|0;r[t>>2]=0;_=A;return}if(n[t+80>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[t+76>>2]=0;n[t+80>>0]=1;r[t+76>>2]=0;r[t+68>>2]=0;t=t+72|0;r[t>>2]=0;_=A;return}function vA(t){t=t|0;Ql(t);return}function SA(t,e,i,o){t=t|0;e=e|0;i=i|0;o=o|0;var a=0.0,l=0.0,c=0,_=0,u=0,p=0,f=0,m=0,g=0,b=0,y=0,v=0.0,S=0.0,x=0.0,w=0,C=0.0,T=0,A=0.0,E=0.0;l=+h[e>>2];_=(h[d>>2]=l,r[d>>2]|0);g=l<999999984306749440.0?_:1566444395;a=+h[e+4>>2];p=(h[d>>2]=a,r[d>>2]|0);y=a<999999984306749440.0?p:1566444395;C=+h[e+8>>2];m=(h[d>>2]=C,r[d>>2]|0);T=C<999999984306749440.0?m:1566444395;_=l>-999999984306749440.0?_:-581039253;p=a>-999999984306749440.0?p:-581039253;m=C>-999999984306749440.0?m:-581039253;C=+h[e+16>>2];w=C<(r[d>>2]=g,+h[d>>2]);c=(h[d>>2]=C,r[d>>2]|0);g=w?c:g;a=+h[e+20>>2];w=a<(r[d>>2]=y,+h[d>>2]);u=(h[d>>2]=a,r[d>>2]|0);y=w?u:y;l=+h[e+24>>2];w=l<(r[d>>2]=T,+h[d>>2]);f=(h[d>>2]=l,r[d>>2]|0);T=w?f:T;w=(r[d>>2]=_,+h[d>>2])<C?c:_;b=(r[d>>2]=p,+h[d>>2])<a?u:p;m=(r[d>>2]=m,+h[d>>2])<l?f:m;C=+h[e+32>>2];_=C<(r[d>>2]=g,+h[d>>2]);p=(h[d>>2]=C,r[d>>2]|0);g=_?p:g;l=+h[e+36>>2];_=l<(r[d>>2]=y,+h[d>>2]);f=(h[d>>2]=l,r[d>>2]|0);_=_?f:y;a=+h[e+40>>2];c=a<(r[d>>2]=T,+h[d>>2]);u=(h[d>>2]=a,r[d>>2]|0);c=c?u:T;p=(r[d>>2]=w,+h[d>>2])<C?p:w;f=(r[d>>2]=b,+h[d>>2])<l?f:b;m=(r[d>>2]=m,+h[d>>2])<a?u:m;a=(r[d>>2]=p,+h[d>>2]);l=(r[d>>2]=g,+h[d>>2]);if(a-l<2.0000000949949026e-03){p=(h[d>>2]=a+1.0000000474974513e-03,r[d>>2]|0);u=(h[d>>2]=l+-1.0000000474974513e-03,r[d>>2]|0)}else u=g;a=(r[d>>2]=f,+h[d>>2]);l=(r[d>>2]=_,+h[d>>2]);if(a-l<2.0000000949949026e-03){f=(h[d>>2]=a+1.0000000474974513e-03,r[d>>2]|0);_=(h[d>>2]=l+-1.0000000474974513e-03,r[d>>2]|0)}a=(r[d>>2]=m,+h[d>>2]);l=(r[d>>2]=c,+h[d>>2]);if(a-l<2.0000000949949026e-03){m=(h[d>>2]=a+1.0000000474974513e-03,r[d>>2]|0);c=(h[d>>2]=l+-1.0000000474974513e-03,r[d>>2]|0)}g=r[t+8>>2]|0;l=+h[g+4>>2];C=(r[d>>2]=u,+h[d>>2])-l;a=+h[g+8>>2];v=(r[d>>2]=_,+h[d>>2])-a;E=+h[g+12>>2];S=+h[g+36>>2];x=+h[g+40>>2];A=+h[g+44>>2];g=~~(((r[d>>2]=c,+h[d>>2])-E)*A)&65534;l=(r[d>>2]=p,+h[d>>2])-l;a=(r[d>>2]=f,+h[d>>2])-a;m=(~~(((r[d>>2]=m,+h[d>>2])-E)*A+1.0)&65535|1)&65535;p=r[t+4>>2]|0;_=r[p+4>>2]|0;if((_|0)!=(r[p+8>>2]|0)){t=_;T=p+12|0;T=r[T>>2]|0;w=T+(t<<4)|0;s[w>>1]=~~(C*S)&65534;w=T+(t<<4)+2|0;s[w>>1]=~~(v*x)&65534;w=T+(t<<4)+4|0;s[w>>1]=g;w=T+(t<<4)+6|0;s[w>>1]=~~(l*S+1.0)&65535|1;w=T+(t<<4)+8|0;s[w>>1]=~~(a*x+1.0)&65535|1;w=T+(t<<4)+10|0;s[w>>1]=m;t=T+(t<<4)+12|0;r[t>>2]=i<<21|o;o=r[p+4>>2]|0;o=o+1|0;r[p+4>>2]=o;return}f=_|0?_<<1:1;if((_|0)>=(f|0)){t=_;T=p+12|0;T=r[T>>2]|0;w=T+(t<<4)|0;s[w>>1]=~~(C*S)&65534;w=T+(t<<4)+2|0;s[w>>1]=~~(v*x)&65534;w=T+(t<<4)+4|0;s[w>>1]=g;w=T+(t<<4)+6|0;s[w>>1]=~~(l*S+1.0)&65535|1;w=T+(t<<4)+8|0;s[w>>1]=~~(a*x+1.0)&65535|1;w=T+(t<<4)+10|0;s[w>>1]=m;t=T+(t<<4)+12|0;r[t>>2]=i<<21|o;o=r[p+4>>2]|0;o=o+1|0;r[p+4>>2]=o;return}if(!f)c=0;else{r[5637]=(r[5637]|0)+1;c=Zl((f<<4|3)+16|0)|0;if(!c)c=0;else{r[(c+4+15&-16)+-4>>2]=c;c=c+4+15&-16}_=r[p+4>>2]|0}if((_|0)>0){u=0;do{t=c+(u<<4)|0;T=(r[p+12>>2]|0)+(u<<4)|0;r[t>>2]=r[T>>2];r[t+4>>2]=r[T+4>>2];r[t+8>>2]=r[T+8>>2];r[t+12>>2]=r[T+12>>2];u=u+1|0}while((u|0)!=(_|0))}_=r[p+12>>2]|0;if(_|0){if(n[p+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[_+-4>>2]|0)}r[p+12>>2]=0}n[p+16>>0]=1;r[p+12>>2]=c;r[p+8>>2]=f;t=r[p+4>>2]|0;T=p+12|0;T=r[T>>2]|0;w=T+(t<<4)|0;s[w>>1]=~~(C*S)&65534;w=T+(t<<4)+2|0;s[w>>1]=~~(v*x)&65534;w=T+(t<<4)+4|0;s[w>>1]=g;w=T+(t<<4)+6|0;s[w>>1]=~~(l*S+1.0)&65535|1;w=T+(t<<4)+8|0;s[w>>1]=~~(a*x+1.0)&65535|1;w=T+(t<<4)+10|0;s[w>>1]=m;t=T+(t<<4)+12|0;r[t>>2]=i<<21|o;o=r[p+4>>2]|0;o=o+1|0;r[p+4>>2]=o;return}function xA(t){t=t|0;Ql(t);return}function wA(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0,l=0,c=0,u=0,p=0,f=0.0,m=0.0,g=0.0,b=0.0,y=0,v=0,S=0,x=0,w=0,C=0.0,T=0,A=0,E=0,M=0,R=0,I=0.0;R=_;_=_+32|0;m=+h[e>>2];a=(h[d>>2]=m,r[d>>2]|0);y=m<999999984306749440.0?a:1566444395;f=+h[e+4>>2];c=(h[d>>2]=f,r[d>>2]|0);v=f<999999984306749440.0?c:1566444395;I=+h[e+8>>2];p=(h[d>>2]=I,r[d>>2]|0);x=I<999999984306749440.0?p:1566444395;b=+h[e+12>>2];C=b<0.0?b:0.0;a=m>-999999984306749440.0?a:-581039253;c=f>-999999984306749440.0?c:-581039253;p=I>-999999984306749440.0?p:-581039253;b=b>0.0?b:0.0;I=+h[e+16>>2];E=I<(r[d>>2]=y,+h[d>>2]);o=(h[d>>2]=I,r[d>>2]|0);y=E?o:y;f=+h[e+20>>2];E=f<(r[d>>2]=v,+h[d>>2]);l=(h[d>>2]=f,r[d>>2]|0);v=E?l:v;m=+h[e+24>>2];E=m<(r[d>>2]=x,+h[d>>2]);u=(h[d>>2]=m,r[d>>2]|0);x=E?u:x;g=+h[e+28>>2];C=g<C?g:C;w=(r[d>>2]=a,+h[d>>2])<I?o:a;S=(r[d>>2]=c,+h[d>>2])<f?l:c;c=(r[d>>2]=p,+h[d>>2])<m?u:p;b=b<g?g:b;I=+h[e+32>>2];E=I<(r[d>>2]=y,+h[d>>2]);o=(h[d>>2]=I,r[d>>2]|0);E=E?o:y;m=+h[e+36>>2];A=m<(r[d>>2]=v,+h[d>>2]);a=(h[d>>2]=m,r[d>>2]|0);A=A?a:v;g=+h[e+40>>2];T=g<(r[d>>2]=x,+h[d>>2]);l=(h[d>>2]=g,r[d>>2]|0);T=T?l:x;f=+h[e+44>>2];C=f<C?f:C;x=(r[d>>2]=w,+h[d>>2])<I?o:w;S=(r[d>>2]=S,+h[d>>2])<m?a:S;v=(r[d>>2]=c,+h[d>>2])<g?l:c;f=b<f?f:b;y=r[t+4>>2]|0;o=r[y+4>>2]|0;if((o|0)==(r[y+8>>2]|0)?(M=o|0?o<<1:1,(o|0)<(M|0)):0){if(!M)p=0;else{r[5637]=(r[5637]|0)+1;o=Zl(M<<6|19)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}p=o;o=r[y+4>>2]|0}if((o|0)>0){a=0;do{l=p+(a<<6)|0;c=(r[y+12>>2]|0)+(a<<6)|0;u=l+64|0;do{r[l>>2]=r[c>>2];l=l+4|0;c=c+4|0}while((l|0)<(u|0));a=a+1|0}while((a|0)!=(o|0))}o=r[y+12>>2]|0;if(o|0){if(n[y+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[y+12>>2]=0}n[y+16>>0]=1;r[y+12>>2]=p;r[y+8>>2]=M;o=r[y+4>>2]|0}M=r[y+12>>2]|0;r[M+(o<<6)>>2]=E;r[M+(o<<6)+4>>2]=A;r[M+(o<<6)+8>>2]=T;h[M+(o<<6)+12>>2]=C;r[M+(o<<6)+16>>2]=x;r[M+(o<<6)+20>>2]=S;r[M+(o<<6)+24>>2]=v;h[M+(o<<6)+28>>2]=f;r[M+(o<<6)+32>>2]=-1;r[M+(o<<6)+36>>2]=i;r[M+(o<<6)+40>>2]=s;s=M+(o<<6)+44|0;r[s>>2]=r[R>>2];r[s+4>>2]=r[R+4>>2];r[s+8>>2]=r[R+8>>2];r[s+12>>2]=r[R+12>>2];r[s+16>>2]=r[R+16>>2];r[y+4>>2]=(r[y+4>>2]|0)+1;_=R;return}function CA(t){t=t|0;var e=0;r[t>>2]=6248;e=r[t+56>>2]|0;if(!e)return;ok[r[r[e>>2]>>2]&255](e);e=r[t+56>>2]|0;if(!e)return;r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);return}function TA(t){t=t|0;var e=0,i=0;r[t>>2]=6248;e=r[t+56>>2]|0;if(e|0?(ok[r[r[e>>2]>>2]&255](e),i=r[t+56>>2]|0,i|0):0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function AA(t,e,i){t=t|0;e=+e;i=i|0;var n=0,s=0.0,o=0.0,a=0.0,l=0;n=_;_=_+96|0;a=+xk[r[(r[t>>2]|0)+48>>2]&15](t);r[n+32>>2]=1065353216;r[n+32+4>>2]=0;r[n+32+4+4>>2]=0;r[n+32+4+8>>2]=0;r[n+32+4+12>>2]=0;r[n+32+20>>2]=1065353216;r[n+32+24>>2]=0;r[n+32+24+4>>2]=0;r[n+32+24+8>>2]=0;r[n+32+24+12>>2]=0;r[n+32+40>>2]=1065353216;l=n+32+44|0;r[l>>2]=0;r[l+4>>2]=0;r[l+8>>2]=0;r[l+12>>2]=0;r[l+16>>2]=0;jk[r[(r[t>>2]|0)+8>>2]&127](t,n+32|0,n+16|0,n);o=(a+(+h[n>>2]-+h[n+16>>2])*.5)*2.0;s=(a+(+h[n+4>>2]-+h[n+16+4>>2])*.5)*2.0;a=(a+(+h[n+8>>2]-+h[n+16+8>>2])*.5)*2.0;h[i>>2]=e*.0833333283662796*(s*s+a*a);h[i+4>>2]=e*.0833333283662796*(o*o+a*a);h[i+8>>2]=e*.0833333283662796*(o*o+s*s);h[i+12>>2]=0.0;_=n;return}function EA(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0,l=0,c=0,u=0.0,d=0.0,p=0,f=0,m=0.0,g=0;f=_;_=_+2048|0;r[t>>2]=0;r[t+4>>2]=0;r[t+8>>2]=0;r[t+12>>2]=0;n=+h[i>>2];o=+h[i+4>>2];s=+h[i+8>>2];if(n*n+o*o+s*s<9.999999747378752e-05){d=1.0;u=0.0;o=0.0}else{m=1.0/+G(+(n*n+o*o+s*s));d=n*m;u=s*m;o=o*m}if((ck[r[(r[e>>2]|0)+96>>2]&127](e)|0)<=0){_=f;return}c=0;n=-999999984306749440.0;do{if(((ck[r[(r[e>>2]|0)+96>>2]&127](e)|0)-c|0)<128){i=(ck[r[(r[e>>2]|0)+96>>2]&127](e)|0)-c|0;if((i|0)>0)p=8;else{s=-3402823466385288598117041.0e14;i=-1}}else{i=128;p=8}if((p|0)==8){p=0;a=0;do{Vk[r[(r[e>>2]|0)+108>>2]&127](e,a,f+(a<<4)|0);a=a+1|0}while((a|0)!=(i|0));l=0;s=-3402823466385288598117041.0e14;a=-1;do{m=d*+h[f+(l<<4)>>2]+o*+h[f+(l<<4)+4>>2]+u*+h[f+(l<<4)+8>>2];g=m>s;a=g?l:a;s=g?m:s;l=l+1|0}while((l|0)!=(i|0));i=a}if(s>n){g=f+(i<<4)|0;r[t>>2]=r[g>>2];r[t+4>>2]=r[g+4>>2];r[t+8>>2]=r[g+8>>2];r[t+12>>2]=r[g+12>>2];n=s}c=c+128|0}while((c|0)<(ck[r[(r[e>>2]|0)+96>>2]&127](e)|0));_=f;return}function MA(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0,a=0.0,l=0.0,c=0.0,u=0.0,d=0,p=0,f=0,m=0,g=0,b=0,y=0,v=0,S=0,x=0,w=0.0,C=0;x=_;_=_+2048|0;if((n|0)>0)s=0;else{_=x;return}do{h[i+(s<<4)+12>>2]=-999999984306749440.0;s=s+1|0}while((s|0)!=(n|0));y=0;do{if((ck[r[(r[t>>2]|0)+96>>2]&127](t)|0)>0){g=e+(y<<4)|0;b=e+(y<<4)+4|0;p=e+(y<<4)+8|0;f=i+(y<<4)+12|0;m=i+(y<<4)|0;v=0;do{if(((ck[r[(r[t>>2]|0)+96>>2]&127](t)|0)-v|0)<128){s=(ck[r[(r[t>>2]|0)+96>>2]&127](t)|0)-v|0;if((s|0)>0)S=10;else{a=-3402823466385288598117041.0e14;s=-1}}else{s=128;S=10}if((S|0)==10){S=0;o=0;do{Vk[r[(r[t>>2]|0)+108>>2]&127](t,o,x+(o<<4)|0);o=o+1|0}while((o|0)!=(s|0));l=+h[g>>2];c=+h[b>>2];u=+h[p>>2];d=0;a=-3402823466385288598117041.0e14;o=-1;do{w=l*+h[x+(d<<4)>>2]+c*+h[x+(d<<4)+4>>2]+u*+h[x+(d<<4)+8>>2];C=w>a;o=C?d:o;a=C?w:a;d=d+1|0}while((d|0)!=(s|0));s=o}if(a>+h[f>>2]){C=x+(s<<4)|0;r[m>>2]=r[C>>2];r[m+4>>2]=r[C+4>>2];r[m+8>>2]=r[C+8>>2];r[m+12>>2]=r[C+12>>2];h[f>>2]=a}v=v+128|0}while((v|0)<(ck[r[(r[t>>2]|0)+96>>2]&127](t)|0))}y=y+1|0}while((y|0)!=(n|0));_=x;return}function RA(t,e){t=t|0;e=e|0;var i=0,o=0,l=0,c=0,u=0,p=0,f=0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0,w=0.0,C=0,T=0,A=0,E=0,M=0,R=0,I=0.0,P=0.0,L=0,D=0.0,k=0.0,O=0,F=0,B=0.0,N=0.0,U=0,V=0,z=0,j=0,H=0,X=0,Y=0,q=0,K=0,Z=0,Q=0,$=0,J=0,tt=0,et=0,it=0,nt=0,st=0,rt=0.0,ot=0,at=0;st=_;_=_+288|0;i=r[t+56>>2]|0;if(i|0?(ok[r[r[i>>2]>>2]&255](i),o=r[t+56>>2]|0,o|0):0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[5637]=(r[5637]|0)+1;i=Zl(151)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[i>>2]=5688;n[i+20>>0]=1;r[i+16>>2]=0;r[i+8>>2]=0;r[i+12>>2]=0;n[i+40>>0]=1;r[i+36>>2]=0;r[i+28>>2]=0;r[i+32>>2]=0;n[i+60>>0]=1;r[i+56>>2]=0;r[i+48>>2]=0;r[i+52>>2]=0;r[t+56>>2]=i;p=0;u=0;nt=0;O=0;while(1){if((p|0)>=(ck[r[(r[t>>2]|0)+96>>2]&127](t)|0))break;do{if((O|0)==(u|0)){l=u|0?u<<1:1;if((u|0)<(l|0)){if((l|0)!=0?(r[5637]=(r[5637]|0)+1,f=Zl((l<<4|3)+16|0)|0,(f|0)!=0):0){r[(f+4+15&-16)+-4>>2]=f;i=f+4+15&-16}else i=0;if((u|0)<=0){if(!nt){c=u;o=l;break}}else{o=0;do{it=i+(o<<4)|0;et=nt+(o<<4)|0;r[it>>2]=r[et>>2];r[it+4>>2]=r[et+4>>2];r[it+8>>2]=r[et+8>>2];r[it+12>>2]=r[et+12>>2];o=o+1|0}while((o|0)!=(u|0))}r[5638]=(r[5638]|0)+1;Ql(r[nt+-4>>2]|0);c=u;o=l}else{c=u;o=u;i=nt}}else{c=O;o=u;i=nt}}while(0);u=i+(O<<4)|0;r[u>>2]=r[st+200>>2];r[u+4>>2]=r[st+200+4>>2];r[u+8>>2]=r[st+200+8>>2];r[u+12>>2]=r[st+200+12>>2];Vk[r[(r[t>>2]|0)+108>>2]&127](t,p,u);p=p+1|0;u=o;nt=i;O=c+1|0}n[st+136+16>>0]=1;it=st+136+12|0;r[it>>2]=0;r[st+136+4>>2]=0;r[st+136+8>>2]=0;n[st+136+36>>0]=1;et=st+136+32|0;r[et>>2]=0;r[st+136+24>>2]=0;r[st+136+28>>2]=0;n[st+136+56>>0]=1;tt=st+136+52|0;r[tt>>2]=0;r[st+136+44>>2]=0;r[st+136+48>>2]=0;if(e){if((O|0)>0){L=0;o=0;c=0;l=0;while(1){i=L;L=L+1|0;if((L|0)<(O|0)){M=nt+(i<<4)|0;R=nt+(i<<4)+4|0;A=nt+(i<<4)+8|0;E=L;i=l;do{l=E;E=E+1|0;if((E|0)<(O|0)){C=nt+(l<<4)|0;T=nt+(l<<4)+4|0;e=nt+(l<<4)+8|0;x=E;do{I=+h[M>>2];k=+h[C>>2]-I;P=+h[R>>2];S=+h[T>>2]-P;D=+h[A>>2];w=+h[e>>2]-D;I=+h[nt+(x<<4)>>2]-I;P=+h[nt+(x<<4)+4>>2]-P;D=+h[nt+(x<<4)+8>>2]-D;m=1.0;f=0;while(1){y=(S*D-w*P)*m;v=(w*I-k*D)*m;g=(k*P-S*I)*m;t:do{if(g*g+(y*y+v*v)>9.999999747378752e-05){b=1.0/+G(+(g*g+(y*y+v*v)));if((i|0)>0){l=0;do{if(y*b*+h[c+(l<<4)>>2]+v*b*+h[c+(l<<4)+4>>2]+g*b*+h[c+(l<<4)+8>>2]>.9990000128746033)break t;l=l+1|0}while((l|0)<(i|0))}m=y*b*+h[M>>2]+v*b*+h[R>>2]+g*b*+h[A>>2];l=0;do{if(y*b*+h[nt+(l<<4)>>2]+v*b*+h[nt+(l<<4)+4>>2]+g*b*+h[nt+(l<<4)+8>>2]-m+-.009999999776482582>0.0)break t;l=l+1|0}while((l|0)<(O|0));do{if((i|0)==(o|0)){p=o|0?o<<1:1;if((o|0)<(p|0)){do{if(!p)u=0;else{r[5637]=(r[5637]|0)+1;l=Zl((p<<4|3)+16|0)|0;if(!l){u=0;break}r[(l+4+15&-16)+-4>>2]=l;u=l+4+15&-16}}while(0);if((o|0)<=0){if(!c){l=o;o=p;c=u;break}}else{l=0;do{Q=u+(l<<4)|0;Z=c+(l<<4)|0;r[Q>>2]=r[Z>>2];r[Q+4>>2]=r[Z+4>>2];r[Q+8>>2]=r[Z+8>>2];r[Q+12>>2]=r[Z+12>>2];l=l+1|0}while((l|0)!=(o|0))}r[5638]=(r[5638]|0)+1;Ql(r[c+-4>>2]|0);l=o;o=p;c=u}else l=o}else l=i}while(0);h[c+(l<<4)>>2]=y*b;h[c+(l<<4)+4>>2]=v*b;h[c+(l<<4)+8>>2]=g*b;h[c+(l<<4)+12>>2]=-m;i=i+1|0}}while(0);f=f+1|0;if((f|0)==2)break;else m=-1.0}x=x+1|0}while((x|0)!=(O|0))}}while((E|0)!=(O|0))}else i=l;if((L|0)==(O|0))break;else l=i}if((i|0)>0){p=0;f=0;e=0;while(1){Q=c+(e<<4)|0;r[st+216>>2]=r[Q>>2];r[st+216+4>>2]=r[Q+4>>2];r[st+216+8>>2]=r[Q+8>>2];m=+h[c+(e<<4)+12>>2];m=m-+xk[r[(r[t>>2]|0)+48>>2]&15](t);do{if((e|0)==(p|0)){u=p|0?p<<1:1;if((p|0)<(u|0)){if((u|0)!=0?(r[5637]=(r[5637]|0)+1,F=Zl((u<<4|3)+16|0)|0,(F|0)!=0):0){r[(F+4+15&-16)+-4>>2]=F;l=F+4+15&-16}else l=0;if((p|0)<=0){if(!f){o=p;break}}else{o=0;do{Q=l+(o<<4)|0;Z=f+(o<<4)|0;r[Q>>2]=r[Z>>2];r[Q+4>>2]=r[Z+4>>2];r[Q+8>>2]=r[Z+8>>2];r[Q+12>>2]=r[Z+12>>2];o=o+1|0}while((o|0)!=(p|0))}r[5638]=(r[5638]|0)+1;Ql(r[f+-4>>2]|0);o=p}else{o=p;u=p;l=f}}else{o=e;u=p;l=f}}while(0);Q=l+(o<<4)|0;r[Q>>2]=r[st+216>>2];r[Q+4>>2]=r[st+216+4>>2];r[Q+8>>2]=r[st+216+8>>2];h[l+(o<<4)+12>>2]=m;e=e+1|0;if((e|0)<(i|0)){p=u;f=l}else break}if((e|0)>0){M=0;u=0;o=0;i=0;do{A=M;M=M+1|0;if((M|0)<(e|0)){E=M;do{C=E;E=E+1|0;if((E|0)<(e|0)){T=E;do{y=+h[l+(C<<4)+4>>2];m=+h[l+(T<<4)+8>>2];g=+h[l+(C<<4)+8>>2];v=+h[l+(T<<4)+4>>2];S=+h[l+(T<<4)>>2];w=+h[l+(C<<4)>>2];b=+h[l+(A<<4)+8>>2];I=+h[l+(A<<4)+4>>2];P=+h[l+(A<<4)>>2];t:do{if((((v*w-y*S)*(v*w-y*S)+((y*m-g*v)*(y*m-g*v)+(g*S-m*w)*(g*S-m*w))>9.999999747378752e-05?(S*I-v*P)*(S*I-v*P)+((v*b-m*I)*(v*b-m*I)+(m*P-S*b)*(m*P-S*b))>9.999999747378752e-05:0)?(y*P-w*I)*(y*P-w*I)+((g*I-y*b)*(g*I-y*b)+(w*b-g*P)*(w*b-g*P))>9.999999747378752e-05:0)?(B=b*(v*w-y*S)+(I*(g*S-m*w)+(y*m-g*v)*P),+W(+B)>9.999999974752427e-07):0){k=+h[l+(A<<4)+12>>2];N=+h[l+(C<<4)+12>>2];rt=+h[l+(T<<4)+12>>2];D=-1.0/B*((g*I-y*b)*rt+((y*m-g*v)*k+(v*b-m*I)*N));g=-1.0/B*((w*b-g*P)*rt+((g*S-m*w)*k+(m*P-S*b)*N));m=-1.0/B*((y*P-w*I)*rt+((v*w-y*S)*k+(S*I-v*P)*N));p=0;do{if(+h[l+(p<<4)+12>>2]+(D*+h[l+(p<<4)>>2]+g*+h[l+(p<<4)+4>>2]+m*+h[l+(p<<4)+8>>2])+-.009999999776482582>0.0)break t;p=p+1|0}while((p|0)<(e|0));do{if((i|0)==(u|0)){x=u|0?u<<1:1;if((u|0)>=(x|0)){p=u;break}do{if(!x)f=0;else{r[5637]=(r[5637]|0)+1;p=Zl((x<<4|3)+16|0)|0;if(!p){f=0;break}r[(p+4+15&-16)+-4>>2]=p;f=p+4+15&-16}}while(0);if((u|0)<=0){if(!o){p=u;u=x;o=f;break}}else{p=0;do{Q=f+(p<<4)|0;Z=o+(p<<4)|0;r[Q>>2]=r[Z>>2];r[Q+4>>2]=r[Z+4>>2];r[Q+8>>2]=r[Z+8>>2];r[Q+12>>2]=r[Z+12>>2];p=p+1|0}while((p|0)!=(u|0))}r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0);p=u;u=x;o=f}else p=i}while(0);h[o+(p<<4)>>2]=D;h[o+(p<<4)+4>>2]=g;h[o+(p<<4)+8>>2]=m;h[o+(p<<4)+12>>2]=0.0;i=i+1|0}}while(0);T=T+1|0}while((T|0)!=(e|0))}}while((E|0)!=(e|0))}}while((M|0)!=(e|0))}else{o=0;i=0}}else{l=0;o=0;i=0}}else{c=0;l=0;o=0;i=0}V_(st+136|0,o,i);if(o|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}if(l|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0)}if(c|0){r[5638]=(r[5638]|0)+1;Ql(r[c+-4>>2]|0)}}else V_(st+136|0,nt,O);L=r[st+136+44>>2]|0;if((L|0)>0){r[5637]=(r[5637]|0)+1;i=Zl((L<<4|3)+16|0)|0;if(!i)o=0;else{r[(i+4+15&-16)+-4>>2]=i;o=i+4+15&-16}i=0;do{Q=o+(i<<4)|0;r[Q>>2]=r[st+120>>2];r[Q+4>>2]=r[st+120+4>>2];r[Q+8>>2]=r[st+120+8>>2];r[Q+12>>2]=r[st+120+12>>2];i=i+1|0}while((i|0)!=(L|0))}else o=0;n[st+96+16>>0]=1;Q=st+96+12|0;r[Q>>2]=0;Z=st+96+4|0;r[Z>>2]=0;r[st+96+8>>2]=0;c=st+264|0;p=c+19|0;do{n[c>>0]=0;c=c+1|0}while((c|0)<(p|0));if((L|0)<0)oe();if((L|0)>0){IA(st+96|0,L);i=r[Q>>2]|0;l=0;do{c=i+(l*36|0)|0;n[c+16>>0]=1;r[c+4>>2]=0;r[c+4+4>>2]=0;r[c+4+8>>2]=0;c=c+20|0;u=st+264+3|0;p=c+16|0;do{n[c>>0]=n[u>>0]|0;c=c+1|0;u=u+1|0}while((c|0)<(p|0));l=l+1|0}while((l|0)!=(L|0))}r[Z>>2]=L;f=r[st+136+4>>2]|0;p=r[t+56>>2]|0;u=r[p+8>>2]|0;if((u|0)<(f|0)){if((r[p+12>>2]|0)<(f|0)){if(!f){i=0;l=u}else{r[5637]=(r[5637]|0)+1;i=Zl((f<<4|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}l=r[p+8>>2]|0}if((l|0)>0){c=0;do{K=i+(c<<4)|0;q=(r[p+16>>2]|0)+(c<<4)|0;r[K>>2]=r[q>>2];r[K+4>>2]=r[q+4>>2];r[K+8>>2]=r[q+8>>2];r[K+12>>2]=r[q+12>>2];c=c+1|0}while((c|0)!=(l|0))}l=r[p+16>>2]|0;if(l|0){if(n[p+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0)}r[p+16>>2]=0}n[p+20>>0]=1;r[p+16>>2]=i;r[p+12>>2]=f;l=p+16|0}else l=p+16|0;i=u;do{K=(r[l>>2]|0)+(i<<4)|0;r[K>>2]=r[st+80>>2];r[K+4>>2]=r[st+80+4>>2];r[K+8>>2]=r[st+80+8>>2];r[K+12>>2]=r[st+80+12>>2];i=i+1|0}while((i|0)!=(f|0))}r[p+8>>2]=f;if((f|0)>0){i=0;do{K=(r[(r[t+56>>2]|0)+16>>2]|0)+(i<<4)|0;q=(r[it>>2]|0)+(i<<4)|0;r[K>>2]=r[q>>2];r[K+4>>2]=r[q+4>>2];r[K+8>>2]=r[q+8>>2];r[K+12>>2]=r[q+12>>2];i=i+1|0}while((i|0)!=(f|0))}if((L|0)>0){R=0;do{A=(r[et>>2]|0)+((r[(r[tt>>2]|0)+(R<<2)>>2]|0)*12|0)|0;M=A;l=0;do{E=M+4|0;T=r[M+((r[E>>2]|0)*12|0)+8>>2]|0;x=r[Q>>2]|0;C=x+(R*36|0)+4|0;i=r[C>>2]|0;e=x+(R*36|0)+8|0;if((i|0)==(r[e>>2]|0)?(U=i|0?i<<1:1,(i|0)<(U|0)):0){if(!U)f=0;else{r[5637]=(r[5637]|0)+1;i=Zl((U<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}f=i;i=r[C>>2]|0}p=x+(R*36|0)+12|0;u=r[p>>2]|0;if((i|0)<=0)if(!u)c=x+(R*36|0)+16|0;else J=132;else{c=0;do{r[f+(c<<2)>>2]=r[u+(c<<2)>>2];c=c+1|0}while((c|0)!=(i|0));J=132}if((J|0)==132){J=0;i=x+(R*36|0)+16|0;if(n[i>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0)}r[p>>2]=0;c=i;i=r[C>>2]|0}n[c>>0]=1;r[p>>2]=f;r[e>>2]=U}r[(r[x+(R*36|0)+12>>2]|0)+(i<<2)>>2]=T;r[C>>2]=(r[C>>2]|0)+1;q=r[M+8>>2]|0;K=r[it>>2]|0;b=+h[K+(q<<4)>>2]-+h[K+(T<<4)>>2];y=+h[K+(q<<4)+4>>2]-+h[K+(T<<4)+4>>2];m=+h[K+(q<<4)+8>>2]-+h[K+(T<<4)+8>>2];g=1.0/+G(+(b*b+y*y+m*m));if((l|0)<2){h[st+216+(l<<4)>>2]=b*g;h[st+216+(l<<4)+4>>2]=y*g;h[st+216+(l<<4)+8>>2]=m*g;h[st+216+(l<<4)+12>>2]=0.0;l=l+1|0}K=M+((r[E>>2]|0)*12|0)|0;M=K+((r[K>>2]|0)*12|0)|0}while((M|0)!=(A|0));i=o+(R<<4)|0;if((l|0)==2){D=+h[st+216+4>>2];k=+h[st+216+24>>2];B=+h[st+216+8>>2];N=+h[st+216+20>>2];P=+h[st+216+16>>2];I=+h[st+216>>2];q=o+(R<<4)+4|0;K=o+(R<<4)+8|0;h[o+(R<<4)+12>>2]=0.0;rt=1.0/+G(+((D*k-B*N)*(D*k-B*N)+(B*P-k*I)*(B*P-k*I)+(N*I-D*P)*(N*I-D*P)));h[i>>2]=(D*k-B*N)*rt;h[q>>2]=(B*P-k*I)*rt;h[K>>2]=(N*I-D*P)*rt;p=r[Q>>2]|0;h[p+(R*36|0)+20>>2]=(D*k-B*N)*rt;r[p+(R*36|0)+24>>2]=r[q>>2];r[p+(R*36|0)+28>>2]=r[K>>2];h[p+(R*36|0)+32>>2]=1000000015047466219876688.0e6}else{r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;r[i+12>>2]=0;p=r[Q>>2]|0}c=r[p+(R*36|0)+4>>2]|0;if((c|0)>0){u=r[(r[t+56>>2]|0)+16>>2]|0;g=+h[i>>2];b=+h[o+(R<<4)+4>>2];y=+h[o+(R<<4)+8>>2];i=r[p+(R*36|0)+12>>2]|0;m=1000000015047466219876688.0e6;l=0;do{K=r[i+(l<<2)>>2]|0;rt=+h[u+(K<<4)>>2]*g+ +h[u+(K<<4)+4>>2]*b+ +h[u+(K<<4)+8>>2]*y;m=m>rt?rt:m;l=l+1|0}while((l|0)!=(c|0))}else m=1000000015047466219876688.0e6;h[p+(R*36|0)+32>>2]=-m;R=R+1|0}while((R|0)!=(L|0))}if((r[Z>>2]|0)>0){p=0;i=0;u=0;while(1){do{if((p|0)==(i|0)){i=p|0?p<<1:1;if((p|0)<(i|0)){if((i|0)!=0?(r[5637]=(r[5637]|0)+1,V=Zl((i<<2|3)+16|0)|0,(V|0)!=0):0){r[(V+4+15&-16)+-4>>2]=V;c=V+4+15&-16}else c=0;if((p|0)<=0){if(!u)break}else{l=0;do{r[c+(l<<2)>>2]=r[u+(l<<2)>>2];l=l+1|0}while((l|0)!=(p|0))}r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0)}else{i=p;c=u}}else c=u}while(0);r[c+(p<<2)>>2]=p;p=p+1|0;if((p|0)>=(r[Z>>2]|0))break;else u=c}U=st+56+12|0;V=st+56+4|0;while(1){e=p+-1|0;l=r[c+(e<<2)>>2]|0;r[5637]=(r[5637]|0)+1;i=Zl(23)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[i>>2]=l;K=r[Q>>2]|0;g=+h[K+(l*36|0)+20>>2];b=+h[K+(l*36|0)+24>>2];m=+h[K+(l*36|0)+28>>2];t:do{if((p|0)>1){u=1;f=1;l=i;i=e;T=e;while(1){C=f;e=l;e:while(1){l=r[Q>>2]|0;do{K=i;i=i+-1|0;if((K|0)<=0){i=l;F=C;O=e;p=T;break t}x=r[c+(i<<2)>>2]|0}while(!(g*+h[l+(x*36|0)+20>>2]+b*+h[l+(x*36|0)+24>>2]+m*+h[l+(x*36|0)+28>>2]>.9990000128746033));do{if((C|0)==(u|0)){u=C|0?C<<1:1;if((C|0)<(u|0)){do{if(!u)p=0;else{r[5637]=(r[5637]|0)+1;l=Zl((u<<2|3)+16|0)|0;if(!l){p=0;break}r[(l+4+15&-16)+-4>>2]=l;p=l+4+15&-16}}while(0);if((C|0)<=0){if(!e){e=p;break}}else{l=0;do{r[p+(l<<2)>>2]=r[e+(l<<2)>>2];l=l+1|0}while((l|0)!=(C|0))}r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);e=p}else u=C}}while(0);r[e+(C<<2)>>2]=x;C=C+1|0;l=0;while(1){f=c+(l<<2)|0;if((r[f>>2]|0)==(x|0))break;l=l+1|0;if((l|0)>=(T|0))continue e}if((l|0)<(T|0))break}p=T+-1|0;K=c+(p<<2)|0;r[f>>2]=r[K>>2];r[K>>2]=x;if((T|0)>1){f=C;l=e;T=p}else{f=C;l=e;J=161;break}}}else{u=1;f=1;l=i;i=e;p=e;J=161}}while(0);t:do{if((J|0)==161){J=0;C=f;x=l;while(1){l=r[Q>>2]|0;do{K=i;i=i+-1|0;if((K|0)<=0){i=l;F=C;O=x;break t}e=r[c+(i<<2)>>2]|0}while(!(g*+h[l+(e*36|0)+20>>2]+b*+h[l+(e*36|0)+24>>2]+m*+h[l+(e*36|0)+28>>2]>.9990000128746033));do{if((C|0)==(u|0)){u=C|0?C<<1:1;if((C|0)<(u|0)){do{if(!u)l=0;else{r[5637]=(r[5637]|0)+1;l=Zl((u<<2|3)+16|0)|0;if(!l){l=0;break}r[(l+4+15&-16)+-4>>2]=l;l=l+4+15&-16}}while(0);if((C|0)<=0){if(!x)break}else{f=0;do{r[l+(f<<2)>>2]=r[x+(f<<2)>>2];f=f+1|0}while((f|0)!=(C|0))}r[5638]=(r[5638]|0)+1;Ql(r[x+-4>>2]|0)}else{u=C;l=x}}else l=x}while(0);r[l+(C<<2)>>2]=e;C=C+1|0;x=l}}}while(0);if((F|0)>1){n[st+56+16>>0]=1;r[U>>2]=0;r[V>>2]=0;r[st+56+8>>2]=0;m=0.0;g=0.0;b=0.0;u=0;E=0;do{l=r[O+(E<<2)>>2]|0;m=+h[i+(l*36|0)+20>>2]+m;g=+h[i+(l*36|0)+24>>2]+g;b=+h[i+(l*36|0)+28>>2]+b;A=i+(l*36|0)+4|0;if((r[A>>2]|0)>0){T=i+(l*36|0)+12|0;i=u;C=0;while(1){x=r[(r[T>>2]|0)+(C<<2)>>2]|0;K=(r[(r[t+56>>2]|0)+16>>2]|0)+(x<<4)|0;r[st+216>>2]=r[K>>2];r[st+216+4>>2]=r[K+4>>2];r[st+216+8>>2]=r[K+8>>2];r[st+216+12>>2]=r[K+12>>2];t:do{if((i|0)>0){l=r[U>>2]|0;u=0;while(1){if((r[l+(u*24|0)+20>>2]|0)==(x|0))break t;u=u+1|0;if((u|0)>=(i|0)){J=263;break}}}else J=263}while(0);if((J|0)==263){J=0;r[st>>2]=r[st+216>>2];r[st+4>>2]=r[st+216+4>>2];r[st+8>>2]=r[st+216+8>>2];r[st+12>>2]=r[st+216+12>>2];do{if((i|0)==(r[st+56+8>>2]|0)){e=i|0?i<<1:1;if((i|0)>=(e|0))break;if(!e)f=0;else{r[5637]=(r[5637]|0)+1;i=Zl((e*24|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}f=i;i=r[V>>2]|0}u=r[U>>2]|0;if((i|0)<=0){if(u)J=272}else{l=0;do{J=f+(l*24|0)|0;K=u+(l*24|0)|0;r[J>>2]=r[K>>2];r[J+4>>2]=r[K+4>>2];r[J+8>>2]=r[K+8>>2];r[J+12>>2]=r[K+12>>2];r[J+16>>2]=r[K+16>>2];r[J+20>>2]=r[K+20>>2];l=l+1|0}while((l|0)!=(i|0));J=272}if((J|0)==272){J=0;if(n[st+56+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0);i=r[V>>2]|0}r[U>>2]=0}n[st+56+16>>0]=1;r[U>>2]=f;r[st+56+8>>2]=e}}while(0);K=r[U>>2]|0;q=K+(i*24|0)|0;r[q>>2]=r[st>>2];r[q+4>>2]=r[st+4>>2];r[q+8>>2]=r[st+8>>2];r[q+12>>2]=r[st+12>>2];r[q+16>>2]=r[st+16>>2];r[K+(i*24|0)+20>>2]=x;i=(r[V>>2]|0)+1|0;r[V>>2]=i}C=C+1|0;if((C|0)>=(r[A>>2]|0)){u=i;break}}}E=E+1|0;i=r[Q>>2]|0}while((E|0)<(F|0));n[st+20+16>>0]=1;r[st+20+12>>2]=0;r[st+20+4>>2]=0;r[st+20+8>>2]=0;K=i+20+((r[O>>2]|0)*9<<2)|0;r[st+20+20>>2]=r[K>>2];r[st+20+20+4>>2]=r[K+4>>2];r[st+20+20+8>>2]=r[K+8>>2];r[st+20+20+12>>2]=r[K+12>>2];k=1.0/+G(+(m*m+g*g+b*b));N=m*k;B=g*k;k=b*k;if(+W(+k)>.7071067690849304){D=1.0/+G(+(k*k+B*B));v=N*-(k*D);S=0.0;w=B*D;I=-(k*D);P=(k*k+B*B)*D;D=-(N*(B*D))}else{D=1.0/+G(+(N*N+B*B));v=(N*N+B*B)*D;S=-(B*D);w=0.0;I=N*D;P=-(k*(N*D));D=k*-(B*D)}if((u|0)<2)if((u|0)>0){i=u;u=0;f=0;C=0;while(1){T=r[U>>2]|0;do{if((u|0)==(f|0)){x=f|0?f<<1:1;if((f|0)>=(x|0)){e=f;l=C;break}do{if(!x)l=0;else{r[5637]=(r[5637]|0)+1;i=Zl((x*24|3)+16|0)|0;if(!i){l=0;f=u;break}r[(i+4+15&-16)+-4>>2]=i;l=i+4+15&-16;f=u}}while(0);if((f|0)<=0){if(C|0)J=209}else{i=0;do{J=l+(i*24|0)|0;K=C+(i*24|0)|0;r[J>>2]=r[K>>2];r[J+4>>2]=r[K+4>>2];r[J+8>>2]=r[K+8>>2];r[J+12>>2]=r[K+12>>2];r[J+16>>2]=r[K+16>>2];r[J+20>>2]=r[K+20>>2];i=i+1|0}while((i|0)!=(f|0));J=209}if((J|0)==209){J=0;r[5638]=(r[5638]|0)+1;Ql(r[C+-4>>2]|0)}e=u;i=r[V>>2]|0;f=x}else{e=u;l=C}}while(0);K=l+(e*24|0)|0;r[K>>2]=r[T>>2];r[K+4>>2]=r[T+4>>2];r[K+8>>2]=r[T+8>>2];r[K+12>>2]=r[T+12>>2];r[K+16>>2]=r[T+16>>2];r[K+20>>2]=r[T+20>>2];u=u+1|0;if((u|0)<(i|0))C=l;else{J=278;break}}}else{i=0;l=0;J=307}else{i=r[U>>2]|0;l=u;f=0;do{if(S*+h[i+(f*24|0)>>2]+I*+h[i+(f*24|0)+4>>2]+w*+h[i+(f*24|0)+8>>2]<S*+h[i>>2]+I*+h[i+4>>2]+w*+h[i+8>>2]){r[st+216>>2]=r[i>>2];r[st+216+4>>2]=r[i+4>>2];r[st+216+8>>2]=r[i+8>>2];r[st+216+12>>2]=r[i+12>>2];r[st+216+16>>2]=r[i+16>>2];r[st+216+20>>2]=r[i+20>>2];l=i+(f*24|0)|0;r[i>>2]=r[l>>2];r[i+4>>2]=r[l+4>>2];r[i+8>>2]=r[l+8>>2];r[i+12>>2]=r[l+12>>2];r[i+16>>2]=r[l+16>>2];r[i+20>>2]=r[l+20>>2];l=i+(f*24|0)|0;r[l>>2]=r[st+216>>2];r[l+4>>2]=r[st+216+4>>2];r[l+8>>2]=r[st+216+8>>2];r[l+12>>2]=r[st+216+12>>2];r[l+16>>2]=r[st+216+16>>2];r[l+20>>2]=r[st+216+20>>2];l=u}f=f+1|0}while((f|0)<(l|0));h[i+16>>2]=-1000000015047466219876688.0e6;if((l|0)>1){i=r[U>>2]|0;l=r[V>>2]|0;b=+h[i+4>>2];u=1;do{g=+h[i+(u*24|0)>>2]-+h[i>>2];rt=+h[i+(u*24|0)+4>>2]-b;m=+h[i+(u*24|0)+8>>2]-+h[i+8>>2];y=P*g+D*rt+v*m;m=S*g+I*rt+w*m;if(y*y+m*m<1.1920928955078125e-07)h[i+(u*24|0)+16>>2]=0.0;else{g=+W(+y);if(!(m>=0.0))m=2.356194496154785-(m+g)/(g-m)*.7853981852531433;else m=.7853981852531433-(m-g)/(m+g)*.7853981852531433;h[i+(u*24|0)+16>>2]=y<0.0?-m:m}u=u+1|0}while((u|0)<(l|0))}r[st+216>>2]=r[i>>2];r[st+216+4>>2]=r[i+4>>2];r[st+216+8>>2]=r[i+8>>2];r[st+216+12>>2]=r[i+12>>2];PA(st+56|0,st+216|0,1,(r[V>>2]|0)+-1|0);l=r[U>>2]|0;r[5637]=(r[5637]|0)+1;i=Zl(43)|0;if(!i)f=0;else{r[(i+4+15&-16)+-4>>2]=i;f=i+4+15&-16}u=r[U>>2]|0;r[f>>2]=r[l>>2];r[f+4>>2]=r[l+4>>2];r[f+8>>2]=r[l+8>>2];r[f+12>>2]=r[l+12>>2];r[f+16>>2]=r[l+16>>2];r[f+20>>2]=r[l+20>>2];r[5637]=(r[5637]|0)+1;i=Zl(67)|0;if(!i)l=0;else{r[(i+4+15&-16)+-4>>2]=i;l=i+4+15&-16}r[l>>2]=r[f>>2];r[l+4>>2]=r[f+4>>2];r[l+8>>2]=r[f+8>>2];r[l+12>>2]=r[f+12>>2];r[l+16>>2]=r[f+16>>2];r[l+20>>2]=r[f+20>>2];if(f|0){r[5638]=(r[5638]|0)+1;Ql(r[f+-4>>2]|0)}K=l+24|0;r[K>>2]=r[u+24>>2];r[K+4>>2]=r[u+24+4>>2];r[K+8>>2]=r[u+24+8>>2];r[K+12>>2]=r[u+24+12>>2];r[K+16>>2]=r[u+24+16>>2];r[K+20>>2]=r[u+24+20>>2];if((r[V>>2]|0)==2){i=2;u=2}else{e=2;u=2;x=2;i=2;do{t:do{if((e|0)>1){K=r[U>>2]|0;A=K+(i*24|0)|0;m=+h[A>>2];g=+h[K+(i*24|0)+4>>2];b=+h[K+(i*24|0)+8>>2];while(1){K=e+-2|0;f=e+-1|0;P=+h[l+(K*24|0)>>2];D=P-+h[l+(f*24|0)>>2];w=+h[l+(K*24|0)+4>>2];S=w-+h[l+(f*24|0)+4>>2];rt=+h[l+(K*24|0)+8>>2];I=rt-+h[l+(f*24|0)+8>>2];if((D*(w-g)-S*(P-m))*k+(N*(S*(rt-b)-I*(w-g))+B*(I*(P-m)-D*(rt-b)))>0.0)break;if((f|0)>1){e=f;u=f}else{e=f;u=f;break t}}do{if((e|0)==(x|0)){T=x<<1;if((x|0)>=(T|0)){e=x;break}if(x){r[5637]=(r[5637]|0)+1;f=Zl((x*48|3)+16|0)|0;if(!f)f=0;else{r[(f+4+15&-16)+-4>>2]=f;f=f+4+15&-16}if((u|0)>0){C=f;e=u;J=236}}else{C=0;f=0;e=0;J=236}if((J|0)==236){J=0;x=0;do{K=f+(x*24|0)|0;q=l+(x*24|0)|0;r[K>>2]=r[q>>2];r[K+4>>2]=r[q+4>>2];r[K+8>>2]=r[q+8>>2];r[K+12>>2]=r[q+12>>2];r[K+16>>2]=r[q+16>>2];r[K+20>>2]=r[q+20>>2];x=x+1|0}while((x|0)!=(e|0));f=C}r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0);e=u;x=T;l=f}}while(0);e=l+(e*24|0)|0;r[e>>2]=r[A>>2];r[e+4>>2]=r[A+4>>2];r[e+8>>2]=r[A+8>>2];r[e+12>>2]=r[A+12>>2];r[e+16>>2]=r[A+16>>2];r[e+20>>2]=r[A+20>>2];u=u+1|0;e=u}}while(0);if((e|0)==1){C=(r[U>>2]|0)+(i*24|0)|0;do{if((x|0)==1){r[5637]=(r[5637]|0)+1;f=Zl(67)|0;if(!f)e=0;else{r[(f+4+15&-16)+-4>>2]=f;e=f+4+15&-16}if((u|0)<=0){if(!l){f=u;x=2;l=e;break}}else{f=0;do{K=e+(f*24|0)|0;q=l+(f*24|0)|0;r[K>>2]=r[q>>2];r[K+4>>2]=r[q+4>>2];r[K+8>>2]=r[q+8>>2];r[K+12>>2]=r[q+12>>2];r[K+16>>2]=r[q+16>>2];r[K+20>>2]=r[q+20>>2];f=f+1|0}while((f|0)!=(u|0))}r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0);f=u;x=2;l=e}else f=1}while(0);e=l+(f*24|0)|0;r[e>>2]=r[C>>2];r[e+4>>2]=r[C+4>>2];r[e+8>>2]=r[C+8>>2];r[e+12>>2]=r[C+12>>2];r[e+16>>2]=r[C+16>>2];r[e+20>>2]=r[C+20>>2];u=u+1|0;e=u}i=i+1|0}while((i|0)!=(r[V>>2]|0))}J=278}t:do{if((J|0)==278){J=0;if((u|0)>0){R=0;A=0;e=0;i=0;L=0;while(1){E=l+(L*24|0)+20|0;do{if((R|0)==(A|0)){x=A|0?A<<1:1;if((A|0)>=(x|0)){M=e;break}do{if(!x)f=0;else{r[5637]=(r[5637]|0)+1;i=Zl((x<<2|3)+16|0)|0;if(!i){f=0;break}r[(i+4+15&-16)+-4>>2]=i;f=i+4+15&-16}}while(0);if((A|0)<=0){if(e|0)J=299}else{i=0;do{r[f+(i<<2)>>2]=r[e+(i<<2)>>2];i=i+1|0}while((i|0)!=(A|0));J=299}if((J|0)==299){J=0;r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);r[st+20+12>>2]=0}n[st+20+16>>0]=1;r[st+20+12>>2]=f;r[st+20+8>>2]=x;M=f;i=f;A=x}else M=e}while(0);r[M+(R<<2)>>2]=r[E>>2];R=(r[st+20+4>>2]|0)+1|0;r[st+20+4>>2]=R;C=r[V>>2]|0;e:do{if((C|0)>0){T=r[U>>2]|0;f=r[E>>2]|0;x=0;while(1){e=T+(x*24|0)+20|0;x=x+1|0;if((r[e>>2]|0)==(f|0))break;if((x|0)>=(C|0))break e}r[e>>2]=-1}}while(0);L=L+1|0;if((L|0)>=(u|0)){R=C;break}else e=M}}else{R=i;i=0}if((R|0)<=0){J=307;break}x=r[U>>2]|0;C=r[Z>>2]|0;T=r[Q>>2]|0;if((C|0)>0)E=0;else{J=307;break}while(1){A=r[x+(E*24|0)+20>>2]|0;if((A|0)!=-1){M=0;do{u=0;while(1){if((r[O+(u<<2)>>2]|0)==(M|0))break;u=u+1|0;if((u|0)>=(F|0)){J=285;break}}do{if((J|0)==285){J=0;u=r[T+(M*36|0)+4>>2]|0;if((u|0)<=0)break;f=r[T+(M*36|0)+12>>2]|0;e=0;do{if((r[f+(e<<2)>>2]|0)==(A|0)){u=1;break t}e=e+1|0}while((e|0)<(u|0))}}while(0);M=M+1|0}while((M|0)<(C|0))}E=E+1|0;if((E|0)>=(R|0)){J=307;break}}}}while(0);if((J|0)==307){J=0;LA((r[t+56>>2]|0)+24|0,st+20|0);u=0}if(l|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0)}if(i|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0);r[st+20+12>>2]=0}i=r[U>>2]|0;if(i|0){if(n[st+56+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[U>>2]=0}if(u&(F|0)>0){C=0;J=317}}else if((F|0)>0){C=0;J=317}if((J|0)==317)while(1){J=0;e=r[O+(C<<2)>>2]|0;x=r[Q>>2]|0;n[st+216+16>>0]=1;r[st+216+12>>2]=0;r[st+216+4>>2]=0;r[st+216+8>>2]=0;f=r[x+(e*36|0)+4>>2]|0;if((f|0)>0){r[5637]=(r[5637]|0)+1;i=Zl((f<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}n[st+216+16>>0]=1;r[st+216+12>>2]=i;r[st+216+8>>2]=f;Ph(i|0,0,f<<2|0)|0;l=r[x+(e*36|0)+12>>2]|0;r[st+216+4>>2]=f;u=0;do{r[i+(u<<2)>>2]=r[l+(u<<2)>>2];u=u+1|0}while((u|0)!=(f|0))}else{r[st+216+4>>2]=f;i=0}r[st+216+20>>2]=r[x+(e*36|0)+20>>2];r[st+216+20+4>>2]=r[x+(e*36|0)+20+4>>2];r[st+216+20+8>>2]=r[x+(e*36|0)+20+8>>2];r[st+216+20+12>>2]=r[x+(e*36|0)+20+12>>2];LA((r[t+56>>2]|0)+24|0,st+216|0);if(i|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0);r[st+216+12>>2]=0}C=C+1|0;if((C|0)>=(F|0))break;else J=317}if(O|0){r[5638]=(r[5638]|0)+1;Ql(r[O+-4>>2]|0)}if(!p)break}}else c=0;K=r[t+56>>2]|0;r[K+64>>2]=0;r[K+64+4>>2]=0;r[K+64+8>>2]=0;r[K+64+12>>2]=0;i=r[K+28>>2]|0;if((i|0)>0){T=0;l=0;u=0;R=0;E=0;x=0;p=0;M=0;C=0;f=0;A=0;L=0;q=0;while(1){e=r[K+36>>2]|0;Y=r[e+(q*36|0)+4>>2]|0;if((Y|0)>0){H=q&65535;X=q|-65536;z=x;U=C;F=L;i=0;while(1){j=i+1|0;O=r[e+(q*36|0)+12>>2]|0;x=r[O+(i<<2)>>2]&65535;O=r[O+(((j|0)==(Y|0)?0:j)<<2)>>2]&65535;V=O<<16>>16>x<<16>>16?x:O;t=O<<16>>16>x<<16>>16?O:x;e=O<<16>>16>x<<16>>16?x:O;x=O<<16>>16>x<<16>>16?O:x;O=U+-1|0;t:do{if((((e&65535)<<16)+(x<<16>>16)&O)>>>0<R>>>0?($=r[u+((((e&65535)<<16)+(x<<16>>16)&O)<<2)>>2]|0,($|0)!=-1):0){i=$;while(1){if(x<<16>>16==(s[l+(i<<2)>>1]|0)?e<<16>>16==(s[l+(i<<2)+2>>1]|0):0)break;i=r[p+(i<<2)>>2]|0;if((i|0)==-1){L=0;break t}}L=f+(i<<2)|0}else L=0}while(0);i=r[K+16>>2]|0;v=+h[i+(e<<16>>16<<4)>>2]-+h[i+(x<<16>>16<<4)>>2];S=+h[i+(e<<16>>16<<4)+4>>2]-+h[i+(x<<16>>16<<4)+4>>2];b=+h[i+(e<<16>>16<<4)+8>>2]-+h[i+(x<<16>>16<<4)+8>>2];y=1.0/+G(+(v*v+S*S+b*b));i=r[K+48>>2]|0;t:do{if((i|0)>0){e=r[K+56>>2]|0;x=0;while(1){m=+h[e+(x<<4)>>2];g=+h[e+(x<<4)+8>>2];do{if(!(+W(+(m-v*y))>1.0e-06)){if(+W(+(+h[e+(x<<4)+4>>2]-S*y))>1.0e-06)break;if(!(+W(+(g-b*y))>1.0e-06))break t}}while(0);do{if(!(+W(+(v*y+m))>1.0e-06)){if(+W(+(S*y+ +h[e+(x<<4)+4>>2]))>1.0e-06)break;if(!(+W(+(b*y+g))>1.0e-06))break t}}while(0);x=x+1|0;if((x|0)>=(i|0)){J=353;break}}}else J=353}while(0);if((J|0)==353){J=0;do{if((i|0)==(r[K+52>>2]|0)){C=i|0?i<<1:1;if((i|0)>=(C|0))break;if(!C)x=0;else{r[5637]=(r[5637]|0)+1;i=Zl((C<<4|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}x=i;i=r[K+48>>2]|0}if((i|0)>0){e=0;do{ot=x+(e<<4)|0;at=(r[K+56>>2]|0)+(e<<4)|0;r[ot>>2]=r[at>>2];r[ot+4>>2]=r[at+4>>2];r[ot+8>>2]=r[at+8>>2];r[ot+12>>2]=r[at+12>>2];e=e+1|0}while((e|0)!=(i|0))}i=r[K+56>>2]|0;if(i|0){if(n[K+60>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[K+56>>2]=0}n[K+60>>0]=1;r[K+56>>2]=x;r[K+52>>2]=C;i=r[K+48>>2]|0}}while(0);at=r[K+56>>2]|0;h[at+(i<<4)>>2]=v*y;h[at+(i<<4)+4>>2]=S*y;h[at+(i<<4)+8>>2]=b*y;h[at+(i<<4)+12>>2]=0.0;r[K+48>>2]=(r[K+48>>2]|0)+1}t:do{if(!L){i=((V&65535)<<16)+(t<<16>>16)&O;e:do{if(i>>>0<R>>>0){e=r[u+(i<<2)>>2]|0;if((e|0)==-1)break;while(1){if(t<<16>>16==(s[l+(e<<2)>>1]|0)?V<<16>>16==(s[l+(e<<2)+2>>1]|0):0)break;e=r[p+(e<<2)>>2]|0;if((e|0)==-1)break e}x=f+(e<<2)|0;s[x>>1]=X;s[x+2>>1]=X>>>16;x=z;C=U;L=F;break t}}while(0);do{if((M|0)==(U|0)){C=M|0?M<<1:1;if((M|0)>=(C|0)){C=M;break}do{if(!C)x=0;else{r[5637]=(r[5637]|0)+1;e=Zl((C<<2|3)+16|0)|0;if(!e){x=0;break}r[(e+4+15&-16)+-4>>2]=e;x=e+4+15&-16}}while(0);if((M|0)<=0){if(!f){f=x;break}}else{e=0;do{at=x+(e<<2)|0;ot=f+(e<<2)|0;ot=a[ot>>1]|a[ot+2>>1]<<16;s[at>>1]=ot;s[at+2>>1]=ot>>>16;e=e+1|0}while((e|0)!=(M|0))}r[5638]=(r[5638]|0)+1;Ql(r[f+-4>>2]|0);f=x}else C=U}while(0);O=f+(M<<2)|0;s[O>>1]=X;s[O+2>>1]=X>>>16;O=M+1|0;do{if((F|0)==(T|0)){T=F|0?F<<1:1;if((F|0)>=(T|0)){T=F;break}do{if(!T)x=0;else{r[5637]=(r[5637]|0)+1;e=Zl((T<<2|3)+16|0)|0;if(!e){x=0;break}r[(e+4+15&-16)+-4>>2]=e;x=e+4+15&-16}}while(0);if((F|0)<=0){if(!l){l=x;break}}else{e=0;do{at=x+(e<<2)|0;ot=l+(e<<2)|0;ot=a[ot>>1]|a[ot+2>>1]<<16;s[at>>1]=ot;s[at+2>>1]=ot>>>16;e=e+1|0}while((e|0)!=(F|0))}r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0);l=x}}while(0);L=l+(F<<2)|0;s[L>>1]=(V&65535)<<16|t&65535;s[L+2>>1]=((V&65535)<<16|t&65535)>>>16;L=F+1|0;if((U|0)<(C|0)){do{if((C|0)>(R|0)){if((C|0)>=(R|0)){do{if((A|0)<(C|0)){do{if(!C)i=0;else{r[5637]=(r[5637]|0)+1;i=Zl((C<<2|3)+16|0)|0;if(!i){i=0;break}r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}}while(0);if((R|0)<=0){if(!u){u=i;i=C;break}}else{e=0;do{r[i+(e<<2)>>2]=r[u+(e<<2)>>2];e=e+1|0}while((e|0)!=(R|0))}r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0);u=i;i=C}else i=A}while(0);Ph(u+(R<<2)|0,0,C-R<<2|0)|0;A=i}if((C|0)>(E|0)){do{if((z|0)<(C|0)){do{if(!C)e=0;else{r[5637]=(r[5637]|0)+1;i=Zl((C<<2|3)+16|0)|0;if(!i){e=0;break}r[(i+4+15&-16)+-4>>2]=i;e=i+4+15&-16}}while(0);if((E|0)<=0){if(!p){i=C;p=e;break}}else{i=0;do{r[e+(i<<2)>>2]=r[p+(i<<2)>>2];i=i+1|0}while((i|0)!=(E|0))}r[5638]=(r[5638]|0)+1;Ql(r[p+-4>>2]|0);i=C;p=e}else i=z}while(0);Ph(p+(E<<2)|0,0,C-E<<2|0)|0;x=i}else x=z;if((C|0)>0){at=C<<2;Ph(u|0,-1,at|0)|0;Ph(p|0,-1,at|0)|0}if((R|0)<=0){e=C;E=C;i=A;break}i=C+-1|0;e=0;do{at=u+(((a[l+(e<<2)+2>>1]<<16)+(s[l+(e<<2)>>1]|0)&i)<<2)|0;r[p+(e<<2)>>2]=r[at>>2];r[at>>2]=e;e=e+1|0}while((e|0)!=(R|0));e=C;E=C;i=A}else{e=R;x=z;i=A}}while(0);A=i;i=((V&65535)<<16)+(t<<16>>16)&C+-1}else{e=R;x=z}R=u+(i<<2)|0;r[p+(M<<2)>>2]=r[R>>2];r[R>>2]=M;R=e;M=O}else{s[L+2>>1]=H;x=z;C=U;L=F}}while(0);if((j|0)>=(Y|0))break;e=r[K+36>>2]|0;z=x;U=C;F=L;i=j}i=r[K+28>>2]|0;e=L}else e=L;q=q+1|0;if((q|0)>=(i|0))break;else L=e}if((i|0)>0){A=r[K+36>>2]|0;E=r[K+16>>2]|0;m=0.0;M=0;do{x=r[A+(M*36|0)+4>>2]|0;C=r[A+(M*36|0)+12>>2]|0;T=r[C>>2]|0;if((x+-2|0)>=1){g=+h[K+64>>2];b=+h[K+68>>2];y=+h[K+72>>2];e=1;do{ot=r[C+(e<<2)>>2]|0;e=e+1|0;at=r[C+(((e|0)%(x|0)|0)<<2)>>2]|0;v=+h[E+(T<<4)>>2];S=+h[E+(ot<<4)>>2];I=+h[E+(T<<4)+4>>2];P=+h[E+(ot<<4)+4>>2];k=+h[E+(T<<4)+8>>2];B=+h[E+(ot<<4)+8>>2];w=+h[E+(at<<4)>>2];D=+h[E+(at<<4)+4>>2];N=+h[E+(at<<4)+8>>2];rt=+G(+(((v-S)*(I-D)-(I-P)*(v-w))*((v-S)*(I-D)-(I-P)*(v-w))+(((I-P)*(k-N)-(k-B)*(I-D))*((I-P)*(k-N)-(k-B)*(I-D))+((k-B)*(v-w)-(v-S)*(k-N))*((k-B)*(v-w)-(v-S)*(k-N)))))*.5;g=g+(v+S+w)*.3333333432674408*rt;h[K+64>>2]=g;b=(I+P+D)*.3333333432674408*rt+b;h[K+68>>2]=b;y=rt*((k+B+N)*.3333333432674408)+y;h[K+72>>2]=y;m=m+rt}while((e|0)!=(x+-1|0))}M=M+1|0}while((M|0)!=(i|0));e=K+64|0;x=1;T=l;C=u}else J=332}else{l=0;u=0;p=0;f=0;J=332}if((J|0)==332){e=K+64|0;x=0;m=0.0;T=l;C=u}y=1.0/m;v=y*+h[e>>2];h[e>>2]=v;b=y*+h[K+68>>2];h[K+68>>2]=b;y=y*+h[K+72>>2];h[K+72>>2]=y;h[K+96>>2]=3402823466385288598117041.0e14;if(x){l=r[K+36>>2]|0;g=3402823466385288598117041.0e14;u=0;while(1){m=+W(+(+h[l+(u*36|0)+32>>2]+(+h[l+(u*36|0)+20>>2]*v+ +h[l+(u*36|0)+24>>2]*b+ +h[l+(u*36|0)+28>>2]*y)));if(m<g)h[K+96>>2]=m;else m=g;u=u+1|0;if((u|0)>=(i|0))break;else g=m}}else m=3402823466385288598117041.0e14;i=r[K+8>>2]|0;if((i|0)>0){l=r[K+16>>2]|0;w=-3402823466385288598117041.0e14;S=-3402823466385288598117041.0e14;v=-3402823466385288598117041.0e14;y=3402823466385288598117041.0e14;b=3402823466385288598117041.0e14;g=3402823466385288598117041.0e14;u=0;do{rt=+h[l+(u<<4)>>2];y=rt<y?rt:y;w=rt>w?rt:w;rt=+h[l+(u<<4)+4>>2];b=rt<b?rt:b;S=rt>S?rt:S;rt=+h[l+(u<<4)+8>>2];g=rt<g?rt:g;v=rt>v?rt:v;u=u+1|0}while((u|0)!=(i|0))}else{w=-3402823466385288598117041.0e14;S=-3402823466385288598117041.0e14;v=-3402823466385288598117041.0e14;y=3402823466385288598117041.0e14;b=3402823466385288598117041.0e14;g=3402823466385288598117041.0e14}h[K+100>>2]=w+y;h[K+104>>2]=b+S;h[K+108>>2]=g+v;h[K+112>>2]=0.0;rt=w-y;N=S-b;g=v-g;h[K+116>>2]=rt;h[K+120>>2]=N;h[K+124>>2]=g;h[K+128>>2]=0.0;b=m/1.7320507764816284;e=rt<N?N<g?2:1:rt<g?2:0;m=(+h[K+116+(e<<2)>>2]*.5-b)*.0009765625;h[K+88>>2]=b;h[K+84>>2]=b;h[K+80>>2]=b;g=+h[K+116+(e<<2)>>2]*.5;h[K+80+(e<<2)>>2]=g;i=0;while(1){if(wT(K)|0){J=440;break}g=g-m;h[K+80+(e<<2)>>2]=g;i=i+1|0;if((i|0)>=1024){J=439;break}}t:do{if((J|0)==439){h[K+88>>2]=b;h[K+84>>2]=b;h[K+80>>2]=b}else if((J|0)==440){m=(+h[K+96>>2]-b)*.0009765625;l=r[K+80+((1<<(1<<e&3)&3)<<2)>>2]|0;u=0;while(1){i=r[K+80+((1<<e&3)<<2)>>2]|0;h[K+80+((1<<e&3)<<2)>>2]=m+(r[d>>2]=i,+h[d>>2]);g=m+ +h[K+80+((1<<(1<<e&3)&3)<<2)>>2];h[K+80+((1<<(1<<e&3)&3)<<2)>>2]=g;u=u+1|0;if(!(wT(K)|0))break;if((u|0)>=1024)break t;else l=(h[d>>2]=g,r[d>>2]|0)}r[K+80+((1<<e&3)<<2)>>2]=i;r[K+80+((1<<(1<<e&3)&3)<<2)>>2]=l}}while(0);if(T|0){r[5638]=(r[5638]|0)+1;Ql(r[T+-4>>2]|0)}if(f|0){r[5638]=(r[5638]|0)+1;Ql(r[f+-4>>2]|0)}if(p|0){r[5638]=(r[5638]|0)+1;Ql(r[p+-4>>2]|0)}if(C|0){r[5638]=(r[5638]|0)+1;Ql(r[C+-4>>2]|0)}if(c|0){r[5638]=(r[5638]|0)+1;Ql(r[c+-4>>2]|0)}f=r[Z>>2]|0;e=r[Q>>2]|0;if((f|0)<=0){if(e|0)J=461}else{p=0;do{l=e+(p*36|0)+4|0;c=e+(p*36|0)+12|0;u=r[c>>2]|0;i=e+(p*36|0)+16|0;if(u|0){if(n[i>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0)}r[c>>2]=0}n[i>>0]=1;r[c>>2]=0;r[l>>2]=0;r[e+(p*36|0)+8>>2]=0;p=p+1|0}while((p|0)!=(f|0));J=461}if((J|0)==461){if(n[st+96+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[Q>>2]=0}if(o|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}i=r[tt>>2]|0;if(i|0){if(n[st+136+56>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[tt>>2]=0}n[st+136+56>>0]=1;r[tt>>2]=0;r[st+136+44>>2]=0;r[st+136+48>>2]=0;i=r[et>>2]|0;if(i|0){if(n[st+136+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[et>>2]=0}n[st+136+36>>0]=1;r[et>>2]=0;r[st+136+24>>2]=0;r[st+136+28>>2]=0;i=r[it>>2]|0;if(i|0){if(n[st+136+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[it>>2]=0}if(!nt){_=st;return 1}r[5638]=(r[5638]|0)+1;Ql(r[nt+-4>>2]|0);_=st;return 1}function IA(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0,l=0,h=0,c=0,_=0,u=0,d=0,p=0;if((r[t+8>>2]|0)>=(e|0))return;if((e|0)!=0?(r[5637]=(r[5637]|0)+1,i=Zl((e*36|3)+16|0)|0,(i|0)!=0):0){r[(i+4+15&-16)+-4>>2]=i;p=i+4+15&-16}else p=0;l=r[t+4>>2]|0;if((l|0)>0){u=0;do{h=p+(u*36|0)|0;c=r[t+12>>2]|0;n[h+16>>0]=1;r[h+12>>2]=0;r[h+4>>2]=0;r[h+8>>2]=0;_=r[c+(u*36|0)+4>>2]|0;if((_|0)>0){r[5637]=(r[5637]|0)+1;i=Zl((_<<2|3)+16|0)|0;if(!i)a=0;else{r[(i+4+15&-16)+-4>>2]=i;a=i+4+15&-16}o=r[h+4>>2]|0;s=r[h+12>>2]|0;if((o|0)<=0)if(!s){n[h+16>>0]=1;r[h+12>>2]=a;r[h+8>>2]=_;Ph(a|0,0,_<<2|0)|0}else d=14;else{i=0;do{r[a+(i<<2)>>2]=r[s+(i<<2)>>2];i=i+1|0}while((i|0)!=(o|0));d=14}if((d|0)==14){d=0;if(n[h+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}n[h+16>>0]=1;r[h+12>>2]=a;r[h+8>>2]=_;Ph(a|0,0,_<<2|0)|0}i=r[h+12>>2]|0;r[h+4>>2]=_;s=r[c+(u*36|0)+12>>2]|0;o=0;do{r[i+(o<<2)>>2]=r[s+(o<<2)>>2];o=o+1|0}while((o|0)!=(_|0))}else r[h+4>>2]=_;_=c+(u*36|0)+20|0;r[h+20>>2]=r[_>>2];r[h+20+4>>2]=r[_+4>>2];r[h+20+8>>2]=r[_+8>>2];r[h+20+12>>2]=r[_+12>>2];u=u+1|0}while((u|0)!=(l|0));i=r[t+4>>2]|0;if((i|0)>0){c=0;do{o=r[t+12>>2]|0;a=o+(c*36|0)+4|0;l=o+(c*36|0)+12|0;h=r[l>>2]|0;s=o+(c*36|0)+16|0;if(h|0){if(n[s>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[h+-4>>2]|0)}r[l>>2]=0}n[s>>0]=1;r[l>>2]=0;r[a>>2]=0;r[o+(c*36|0)+8>>2]=0;c=c+1|0}while((c|0)!=(i|0))}}i=r[t+12>>2]|0;if(i|0){if(n[t+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[t+12>>2]=0}n[t+16>>0]=1;r[t+12>>2]=p;r[t+8>>2]=e;return}function PA(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0,b=0,y=0.0,v=0.0,S=0.0,x=0,w=0;x=_;_=_+32|0;b=r[t+12>>2]|0;y=+h[b+(((n+i|0)/2|0)*24|0)>>2];v=+h[b+(((n+i|0)/2|0)*24|0)+4>>2];S=+h[b+(((n+i|0)/2|0)*24|0)+8>>2];m=+h[b+(((n+i|0)/2|0)*24|0)+16>>2];g=r[b+(((n+i|0)/2|0)*24|0)+20>>2]|0;s=i;o=n;while(1){u=+h[e>>2];d=+h[e+4>>2];p=+h[e+8>>2];f=(y-u)*(y-u)+(v-d)*(v-d)+(S-p)*(S-p);t:while(1){a=+h[b+(s*24|0)+16>>2];do{if(a!=m){if(!(a<m))break t}else{a=+h[b+(s*24|0)>>2]-u;l=+h[b+(s*24|0)+4>>2]-d;c=+h[b+(s*24|0)+8>>2]-p;if(a*a+l*l+c*c!=f)if(a*a+l*l+c*c<f)break;else break t;else if((r[b+(s*24|0)+20>>2]|0)<(g|0))break;else break t}}while(0);s=s+1|0}t:while(1){a=+h[b+(o*24|0)+16>>2];do{if(m!=a){if(!(m<a))break t}else{a=+h[b+(o*24|0)>>2]-u;l=+h[b+(o*24|0)+4>>2]-d;c=+h[b+(o*24|0)+8>>2]-p;if(f!=a*a+l*l+c*c)if(f<a*a+l*l+c*c)break;else break t;else if((g|0)<(r[b+(o*24|0)+20>>2]|0))break;else break t}}while(0);o=o+-1|0}if((s|0)<=(o|0)){w=b+(s*24|0)|0;r[x>>2]=r[w>>2];r[x+4>>2]=r[w+4>>2];r[x+8>>2]=r[w+8>>2];r[x+12>>2]=r[w+12>>2];r[x+16>>2]=r[w+16>>2];r[x+20>>2]=r[w+20>>2];b=b+(o*24|0)|0;r[w>>2]=r[b>>2];r[w+4>>2]=r[b+4>>2];r[w+8>>2]=r[b+8>>2];r[w+12>>2]=r[b+12>>2];r[w+16>>2]=r[b+16>>2];r[w+20>>2]=r[b+20>>2];b=(r[t+12>>2]|0)+(o*24|0)|0;r[b>>2]=r[x>>2];r[b+4>>2]=r[x+4>>2];r[b+8>>2]=r[x+8>>2];r[b+12>>2]=r[x+12>>2];r[b+16>>2]=r[x+16>>2];r[b+20>>2]=r[x+20>>2];s=s+1|0;o=o+-1|0}if((s|0)>(o|0))break;b=r[t+12>>2]|0}if((o|0)>(i|0))PA(t,e,i,o);if((s|0)>=(n|0)){_=x;return}PA(t,e,s,n);_=x;return}function LA(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0,l=0,h=0,c=0;i=r[t+4>>2]|0;if((i|0)==(r[t+8>>2]|0)){IA(t,i|0?i<<1:1);i=r[t+4>>2]|0}h=(r[t+12>>2]|0)+(i*36|0)|0;n[h+16>>0]=1;r[h+12>>2]=0;r[h+4>>2]=0;r[h+8>>2]=0;c=r[e+4>>2]|0;if((c|0)<=0){r[h+4>>2]=c;c=h+20|0;e=e+20|0;r[c>>2]=r[e>>2];r[c+4>>2]=r[e+4>>2];r[c+8>>2]=r[e+8>>2];r[c+12>>2]=r[e+12>>2];e=r[t+4>>2]|0;e=e+1|0;r[t+4>>2]=e;return}r[5637]=(r[5637]|0)+1;i=Zl((c<<2|3)+16|0)|0;if(!i)a=0;else{r[(i+4+15&-16)+-4>>2]=i;a=i+4+15&-16}o=r[h+4>>2]|0;s=r[h+12>>2]|0;if((o|0)<=0)if(!s){n[h+16>>0]=1;r[h+12>>2]=a;r[h+8>>2]=c;Ph(a|0,0,c<<2|0)|0}else l=11;else{i=0;do{r[a+(i<<2)>>2]=r[s+(i<<2)>>2];i=i+1|0}while((i|0)!=(o|0));l=11}if((l|0)==11){if(n[h+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}n[h+16>>0]=1;r[h+12>>2]=a;r[h+8>>2]=c;Ph(a|0,0,c<<2|0)|0}i=r[h+12>>2]|0;r[h+4>>2]=c;s=r[e+12>>2]|0;o=0;do{r[i+(o<<2)>>2]=r[s+(o<<2)>>2];o=o+1|0}while((o|0)!=(c|0));c=h+20|0;e=e+20|0;r[c>>2]=r[e>>2];r[c+4>>2]=r[e+4>>2];r[c+8>>2]=r[e+8>>2];r[c+12>>2]=r[e+12>>2];e=r[t+4>>2]|0;e=e+1|0;r[t+4>>2]=e;return}function DA(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0;p=+xk[r[(r[t>>2]|0)+48>>2]&15](t);v=+h[t+76>>2];y=+h[t+60>>2];g=+h[t+80>>2];m=+h[t+64>>2];d=+h[t+84>>2];u=+h[t+68>>2];I=+h[e>>2];C=+W(+I);R=+h[e+4>>2];w=+W(+R);c=+h[e+8>>2];_=+W(+c);M=+h[e+16>>2];x=+W(+M);E=+h[e+20>>2];S=+W(+E);a=+h[e+24>>2];l=+W(+a);A=+h[e+32>>2];b=+W(+A);T=+h[e+36>>2];f=+W(+T);s=+h[e+40>>2];o=+W(+s);c=(v+y)*.5*I+(g+m)*.5*R+(d+u)*.5*c+ +h[e+48>>2];a=(v+y)*.5*M+(g+m)*.5*E+(d+u)*.5*a+ +h[e+52>>2];s=(v+y)*.5*A+(g+m)*.5*T+(d+u)*.5*s+ +h[e+56>>2];_=(p+(v-y)*.5)*C+(p+(g-m)*.5)*w+(p+(d-u)*.5)*_;l=(p+(v-y)*.5)*x+(p+(g-m)*.5)*S+(p+(d-u)*.5)*l;o=(p+(v-y)*.5)*b+(p+(g-m)*.5)*f+(p+(d-u)*.5)*o;h[i>>2]=c-_;h[i+4>>2]=a-l;h[i+8>>2]=s-o;h[i+12>>2]=0.0;h[n>>2]=_+c;h[n+4>>2]=l+a;h[n+8>>2]=o+s;h[n+12>>2]=0.0;return}function kA(t){t=t|0;var e=0,i=0,s=0,o=0.0;i=_;_=_+96|0;n[t+92>>0]=1;if(!(n[19840]|0)){n[19840]=1;r[4993]=1065353216;r[4994]=0;r[4995]=0;r[4996]=0;r[4997]=0;r[4998]=1065353216;r[4999]=0;r[5e3]=0;r[5001]=0;r[5002]=0;r[5003]=1065353216;h[5004]=0.0;r[5005]=-1082130432;r[5006]=0;r[5007]=0;r[5008]=0;r[5009]=0;r[5010]=-1082130432;r[5011]=0;r[5012]=0;r[5013]=0;r[5014]=0;r[5015]=-1082130432;h[5016]=0.0}e=i;s=e+96|0;do{r[e>>2]=0;e=e+4|0}while((e|0)<(s|0));jk[r[(r[t>>2]|0)+76>>2]&127](t,19972,i,6);o=+h[t+48>>2];h[t+76>>2]=+h[i>>2]+o;h[t+60>>2]=+h[i+48>>2]-o;h[t+80>>2]=+h[i+20>>2]+o;h[t+64>>2]=+h[i+68>>2]-o;h[t+84>>2]=+h[i+40>>2]+o;h[t+68>>2]=+h[i+88>>2]-o;_=i;return}function OA(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function FA(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0;a=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=+xk[r[(r[t>>2]|0)+48>>2]&15](t);s=+xk[r[(r[t>>2]|0)+48>>2]&15](t);c=+h[e+52>>2]-o;l=+h[e+56>>2]-s;h[i>>2]=+h[e+48>>2]-a;h[i+4>>2]=c;h[i+8>>2]=l;h[i+12>>2]=0.0;o=o+ +h[e+52>>2];s=s+ +h[e+56>>2];h[n>>2]=a+ +h[e+48>>2];h[n+4>>2]=o;h[n+8>>2]=s;h[n+12>>2]=0.0;return}function BA(t,e,i){t=t|0;e=+e;i=i|0;e=e*.4000000059604645*+xk[r[(r[t>>2]|0)+48>>2]&15](t);e=e*+xk[r[(r[t>>2]|0)+48>>2]&15](t);h[i>>2]=e;h[i+4>>2]=e;h[i+8>>2]=e;h[i+12>>2]=0.0;return}function NA(t){t=t|0;return 13962}function UA(t,e){t=t|0;e=+e;h[t+48>>2]=e;return}function VA(t){t=t|0;return+(+h[t+32>>2]*+h[t+16>>2])}function zA(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0;n=_;_=_+16|0;Vk[r[(r[e>>2]|0)+68>>2]&127](n,e,i);r[t>>2]=r[n>>2];r[t+4>>2]=r[n+4>>2];r[t+8>>2]=r[n+8>>2];r[t+12>>2]=r[n+12>>2];a=+h[i>>2];o=+h[i+4>>2];s=+h[i+8>>2];c=a*a+o*o+s*s<1.4210854715202004e-14?-1.0:a;l=a*a+o*o+s*s<1.4210854715202004e-14?-1.0:o;s=a*a+o*o+s*s<1.4210854715202004e-14?-1.0:s;o=1.0/+G(+(s*s+(c*c+l*l)));a=+xk[r[(r[e>>2]|0)+48>>2]&15](e);h[t>>2]=+h[t>>2]+a*(o*c);h[t+4>>2]=a*(o*l)+ +h[t+4>>2];h[t+8>>2]=a*(o*s)+ +h[t+8>>2];_=n;return}function WA(t,e,i){t=t|0;e=e|0;i=i|0;r[t>>2]=0;r[t+4>>2]=0;r[t+8>>2]=0;r[t+12>>2]=0;return}function GA(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;if((n|0)>0)t=0;else return;do{e=i+(t<<4)|0;t=t+1|0;r[e>>2]=0;r[e+4>>2]=0;r[e+8>>2]=0;r[e+12>>2]=0}while((t|0)!=(n|0));return}function jA(t){t=t|0;return}function HA(t){t=t|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function XA(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;r[i>>2]=-581039253;r[i+4>>2]=-581039253;r[i+8>>2]=-581039253;h[i+12>>2]=0.0;r[n>>2]=1566444395;r[n+4>>2]=1566444395;r[n+8>>2]=1566444395;h[n+12>>2]=0.0;return}function YA(t,e){t=t|0;e=e|0;r[t+72>>2]=r[e>>2];r[t+72+4>>2]=r[e+4>>2];r[t+72+8>>2]=r[e+8>>2];r[t+72+12>>2]=r[e+12>>2];return}function qA(t){t=t|0;return t+72|0}function KA(t,e,i){t=t|0;e=+e;i=i|0;r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;r[i+12>>2]=0;return}function ZA(t){t=t|0;return 13990}function QA(t){t=t|0;return 52}function $A(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0;n=Rk[r[(r[i>>2]|0)+40>>2]&31](i,t)|0;s=Rk[r[(r[i>>2]|0)+28>>2]&31](i,n)|0;r[e>>2]=s;if(s|0)lk[r[(r[i>>2]|0)+48>>2]&127](i,n);r[e+4>>2]=r[t+4>>2];r[e+12>>2]=r[t+72>>2];r[e+16>>2]=r[t+76>>2];r[e+20>>2]=r[t+80>>2];r[e+24>>2]=r[t+84>>2];r[e+28>>2]=r[t+52>>2];r[e+32>>2]=r[t+56>>2];r[e+36>>2]=r[t+60>>2];r[e+40>>2]=r[t+64>>2];r[e+44>>2]=r[t+68>>2];return 14002}function JA(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0,C=0.0;w=_;_=_+48|0;y=+h[n>>2];v=+h[i>>2];S=+h[n+4>>2];x=+h[i+4>>2];b=+h[n+8>>2];o=+h[i+8>>2];a=+G(+((y-v)*.5*((y-v)*.5)+(S-x)*.5*((S-x)*.5)+(b-o)*.5*((b-o)*.5)));l=+h[t+60>>2];i=+W(+l)>.7071067690849304;c=+h[t+56>>2];if(i){g=1.0/+G(+(l*l+c*c));C=+h[t+52>>2];s=C*-(l*g);u=C;d=0.0;p=-(l*g);f=c*g;m=(l*l+c*c)*g;g=-(C*(c*g))}else{m=+h[t+52>>2];g=1.0/+G(+(m*m+c*c));s=(m*m+c*c)*g;u=m;d=-(c*g);p=m*g;f=0.0;m=-(l*(m*g));g=l*-(c*g)}C=(y+v)*.5*u+(S+x)*.5*c+(b+o)*.5*l-+h[t+68>>2];u=(y+v)*.5-u*C;d=a*d;p=a*p;v=a*f;m=a*m;g=a*g;y=a*s;h[w>>2]=m+(d+u);h[w+4>>2]=g+(p+((S+x)*.5-c*C));h[w+8>>2]=y+(v+((b+o)*.5-l*C));h[w+12>>2]=0.0;h[w+16>>2]=d+u-m;h[w+20>>2]=p+((S+x)*.5-c*C)-g;h[w+24>>2]=v+((b+o)*.5-l*C)-y;h[w+28>>2]=0.0;h[w+32>>2]=u-d-m;h[w+36>>2]=(S+x)*.5-c*C-p-g;h[w+40>>2]=(b+o)*.5-l*C-v-y;h[w+44>>2]=0.0;jk[r[(r[e>>2]|0)+8>>2]&127](e,w,0,0);h[w>>2]=u-d-m;h[w+4>>2]=(S+x)*.5-c*C-p-g;h[w+8>>2]=(b+o)*.5-l*C-v-y;h[w+12>>2]=0.0;h[w+16>>2]=m+(u-d);h[w+20>>2]=g+((S+x)*.5-c*C-p);h[w+24>>2]=y+((b+o)*.5-l*C-v);h[w+28>>2]=0.0;h[w+32>>2]=m+(d+u);h[w+36>>2]=g+(p+((S+x)*.5-c*C));h[w+40>>2]=y+(v+((b+o)*.5-l*C));h[w+44>>2]=0.0;jk[r[(r[e>>2]|0)+8>>2]&127](e,w,0,1);_=w;return}function tE(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0;v=n[o+16>>0]&-16;n[o+16>>0]=v;x=+h[i>>2];w=+h[e>>2];C=+h[i+4>>2];T=+h[e+4>>2];m=+h[i+8>>2];g=+h[e+8>>2];b=+h[s>>2];y=+h[s+4>>2];S=+h[s+8>>2];u=+h[t>>2];d=+h[t+4>>2];a=+h[t+8>>2];p=(x-w)*(u-w)+(C-T)*(d-T)+(m-g)*(a-g);f=(b-w)*(u-w)+(y-T)*(d-T)+(S-g)*(a-g);if(p<=0.0&f<=0.0){r[o>>2]=r[e>>2];r[o+4>>2]=r[e+4>>2];r[o+8>>2]=r[e+8>>2];r[o+12>>2]=r[e+12>>2];n[o+16>>0]=v|1;h[o+20>>2]=1.0;h[o+24>>2]=0.0;h[o+28>>2]=0.0;h[o+32>>2]=0.0;return}c=(x-w)*(u-x)+(C-T)*(d-C)+(m-g)*(a-m);_=(b-w)*(u-x)+(y-T)*(d-C)+(S-g)*(a-m);if(!(!(c>=0.0)|!(_<=c))){r[o>>2]=r[i>>2];r[o+4>>2]=r[i+4>>2];r[o+8>>2]=r[i+8>>2];r[o+12>>2]=r[i+12>>2];n[o+16>>0]=v|2;h[o+20>>2]=0.0;h[o+24>>2]=1.0;h[o+28>>2]=0.0;h[o+32>>2]=0.0;return}if(c<=0.0&(p>=0.0?p*_-c*f<=0.0:0)){h[o>>2]=w+(x-w)*(p/(p-c));h[o+4>>2]=T+(C-T)*(p/(p-c));h[o+8>>2]=g+(m-g)*(p/(p-c));h[o+12>>2]=0.0;n[o+16>>0]=v|3;h[o+20>>2]=1.0-p/(p-c);h[o+24>>2]=p/(p-c);h[o+28>>2]=0.0;h[o+32>>2]=0.0;return}l=(x-w)*(u-b)+(C-T)*(d-y)+(m-g)*(a-S);a=(b-w)*(u-b)+(y-T)*(d-y)+(S-g)*(a-S);if(!(!(a>=0.0)|!(l<=a))){r[o>>2]=r[s>>2];r[o+4>>2]=r[s+4>>2];r[o+8>>2]=r[s+8>>2];r[o+12>>2]=r[s+12>>2];n[o+16>>0]=v|4;h[o+20>>2]=0.0;h[o+24>>2]=0.0;h[o+28>>2]=1.0;h[o+32>>2]=0.0;return}if(a<=0.0&(f>=0.0?l*f-p*a<=0.0:0)){h[o>>2]=w+(b-w)*(f/(f-a));h[o+4>>2]=T+(y-T)*(f/(f-a));h[o+8>>2]=g+(S-g)*(f/(f-a));h[o+12>>2]=0.0;n[o+16>>0]=v|5;h[o+20>>2]=1.0-f/(f-a);h[o+24>>2]=0.0;h[o+28>>2]=f/(f-a);h[o+32>>2]=0.0;return}if((c*a-l*_<=0.0?_-c>=0.0:0)?l-a>=0.0:0){T=(_-c)/(_-c+(l-a));h[o>>2]=x+(b-x)*T;h[o+4>>2]=C+(y-C)*T;h[o+8>>2]=m+(S-m)*T;h[o+12>>2]=0.0;n[o+16>>0]=v|6;h[o+20>>2]=0.0;h[o+24>>2]=1.0-T;h[o+28>>2]=T;h[o+32>>2]=0.0;return}u=1.0/(p*_-c*f+(c*a-l*_+(l*f-p*a)));d=(l*f-p*a)*u;f=(p*_-c*f)*u;h[o>>2]=(b-w)*f+((x-w)*d+w);h[o+4>>2]=(y-T)*f+((C-T)*d+T);h[o+8>>2]=(S-g)*f+((m-g)*d+g);h[o+12>>2]=0.0;n[o+16>>0]=v|7;h[o+20>>2]=1.0-d-f;h[o+24>>2]=d;h[o+28>>2]=f;h[o+32>>2]=0.0;return}function eE(t){t=t|0;var e=0;r[t>>2]=7044;e=r[t+140>>2]|0;if(e|0){if(n[t+144>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+140>>2]=0}n[t+144>>0]=1;r[t+140>>2]=0;r[t+132>>2]=0;r[t+136>>2]=0;return}function iE(t){t=t|0;var e=0;r[t>>2]=7044;e=r[t+140>>2]|0;if(e|0){if(n[t+144>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+140>>2]=0}n[t+144>>0]=1;r[t+140>>2]=0;r[t+132>>2]=0;r[t+136>>2]=0;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function nE(t,e,i){t=t|0;e=e|0;i=+i;lk[r[(r[t>>2]|0)+32>>2]&127](t,e);Wk[r[(r[t>>2]|0)+36>>2]&7](t,e,i);return}function sE(t,e){t=t|0;e=e|0;return}function rE(t,e){t=t|0;e=e|0;var i=0.0,s=0.0,o=0.0,a=0.0,l=0.0;n[t+171>>0]=1;r[t+60>>2]=r[e>>2];r[t+60+4>>2]=r[e+4>>2];r[t+60+8>>2]=r[e+8>>2];r[t+60+12>>2]=r[e+12>>2];i=+h[t+60>>2];s=+h[t+64>>2];a=+h[t+68>>2];o=+G(+(i*i+s*s+a*a));if(o>1.1920928955078125e-07){l=i*(1.0/o);s=s*(1.0/o);i=a*(1.0/o);e=r[t+72>>2]|0}else{l=0.0;s=0.0;i=0.0;e=0}h[t+76>>2]=l;h[t+80>>2]=s;h[t+84>>2]=i;r[t+88>>2]=e;return}function oE(t,e,i){t=t|0;e=e|0;i=+i;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0;n[t+171>>0]=0;r[t+60>>2]=r[e>>2];r[t+60+4>>2]=r[e+4>>2];r[t+60+8>>2]=r[e+8>>2];r[t+60+12>>2]=r[e+12>>2];s=+h[t+60>>2];o=+h[t+64>>2];l=+h[t+68>>2];a=+G(+(s*s+o*o+l*l));if(a>1.1920928955078125e-07){c=s*(1.0/a);o=o*(1.0/a);s=l*(1.0/a);e=r[t+72>>2]|0}else{c=0.0;o=0.0;s=0.0;e=0}h[t+76>>2]=c;h[t+80>>2]=o;h[t+84>>2]=s;r[t+88>>2]=e;h[t+172>>2]=+h[t+172>>2]+i;return}function aE(t,e){t=t|0;e=e|0;var i=0,s=0,o=0;h[t+16>>2]=0.0;h[t+20>>2]=0.0;n[t+168>>0]=0;n[t+169>>0]=0;h[t+172>>2]=0.0;r[t+60>>2]=0;r[t+60+4>>2]=0;r[t+60+8>>2]=0;r[t+60+12>>2]=0;t=r[(r[t+8>>2]|0)+308>>2]|0;if((r[(ck[r[(r[t>>2]|0)+28>>2]&127](t)|0)+4>>2]|0)<=0)return;do{s=r[t>>2]|0;o=r[s+12>>2]|0;s=r[r[(ck[r[s+28>>2]&127](t)|0)+12>>2]>>2]|0;i=r[(r[(ck[r[(r[t>>2]|0)+28>>2]&127](t)|0)+12>>2]|0)+4>>2]|0;pk[o&31](t,s,i,r[e+24>>2]|0)|0}while((r[(ck[r[(r[t>>2]|0)+28>>2]&127](t)|0)+4>>2]|0)>0);return}function lE(t,e){t=t|0;e=e|0;var i=0;i=_;_=_+16|0;r[i>>2]=r[e>>2];r[i+4>>2]=r[e+4>>2];r[i+8>>2]=r[e+8>>2];r[i+12>>2]=r[e+12>>2];t=r[t+8>>2]|0;r[t+284>>2]=(r[t+284>>2]|0)+1;r[t+4>>2]=1065353216;r[t+8>>2]=0;r[t+8+4>>2]=0;r[t+8+8>>2]=0;r[t+8+12>>2]=0;r[t+24>>2]=1065353216;r[t+28>>2]=0;r[t+28+4>>2]=0;r[t+28+8>>2]=0;r[t+28+12>>2]=0;r[t+44>>2]=1065353216;r[t+48>>2]=0;r[t+52>>2]=r[i>>2];r[t+52+4>>2]=r[i+4>>2];r[t+52+8>>2]=r[i+8>>2];r[t+52+12>>2]=r[i+12>>2];_=i;return}function hE(t,e){t=t|0;e=e|0;n[t+148>>0]=0;if((((cE(t,e)|0?(n[t+148>>0]=1,cE(t,e)|0):0)?(n[t+148>>0]=1,cE(t,e)|0):0)?(n[t+148>>0]=1,cE(t,e)|0):0)?(n[t+148>>0]=1,cE(t,e)|0):0)n[t+148>>0]=1;e=(r[t+8>>2]|0)+52|0;r[t+92>>2]=r[e>>2];r[t+92+4>>2]=r[e+4>>2];r[t+92+8>>2]=r[e+8>>2];r[t+92+12>>2]=r[e+12>>2];Fh(t+112|0,e|0,16)|0;return}function cE(t,e){t=t|0;e=e|0;var i=0,s=0,o=0.0,a=0,l=0.0,c=0,u=0,d=0.0,p=0,f=0,m=0,g=0,b=0,y=0,v=0,S=0.0,x=0.0;v=_;_=_+96|0;b=r[t+12>>2]|0;jk[r[(r[b>>2]|0)+8>>2]&127](b,(r[t+8>>2]|0)+4|0,v+80|0,v+64|0);b=r[e+68>>2]|0;sk[r[(r[b>>2]|0)+16>>2]&31](b,r[(r[t+8>>2]|0)+188>>2]|0,v+80|0,v+64|0,r[e+24>>2]|0);b=r[e+24>>2]|0;jk[r[(r[b>>2]|0)+32>>2]&127](b,r[(r[t+8>>2]|0)+308>>2]|0,e+28|0,b);b=r[t+8>>2]|0;r[t+92>>2]=r[b+52>>2];r[t+92+4>>2]=r[b+52+4>>2];r[t+92+8>>2]=r[b+52+8>>2];r[t+92+12>>2]=r[b+52+12>>2];b=r[b+308>>2]|0;if((ck[r[(r[b>>2]|0)+36>>2]&127](b)|0)>0){b=0;o=0.0;e=0;do{i=r[t+132>>2]|0;if((i|0)<0){if((r[t+136>>2]|0)<0){s=r[t+140>>2]|0;if(s|0){if(n[t+144>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[t+140>>2]=0}n[t+144>>0]=1;r[t+140>>2]=0;r[t+136>>2]=0}do{r[(r[t+140>>2]|0)+(i<<2)>>2]=0;i=i+1|0}while((i|0)!=0)}r[t+132>>2]=0;i=r[(r[t+8>>2]|0)+308>>2]|0;i=r[(ck[r[(r[i>>2]|0)+28>>2]&127](i)|0)+12>>2]|0;g=r[r[i+(b<<4)>>2]>>2]|0;s=r[r[i+(b<<4)+4>>2]>>2]|0;if(!((g|0)!=0?(r[g+204>>2]&4|0)!=0:0))y=14;do{if((y|0)==14){y=0;if(s|0?r[s+204>>2]&4|0:0)break;i=r[i+(b<<4)+8>>2]|0;if(i|0)lk[r[(r[i>>2]|0)+16>>2]&127](i,t+128|0);m=r[t+132>>2]|0;if((m|0)>0){p=r[t+140>>2]|0;f=r[t+8>>2]|0;g=0;do{u=r[p+(g<<2)>>2]|0;d=(r[u+740>>2]|0)==(f|0)?-1.0:1.0;i=r[u+748>>2]|0;if((i|0)>0){c=0;do{l=+h[u+4+(c*184|0)+80>>2];if(l<0.0){a=u+4+(c*184|0)+64|0;if(l<o){e=u+4+(c*184|0)+68|0;S=d*+h[e>>2];s=u+4+(c*184|0)+72|0;o=d*+h[s>>2];h[t+152>>2]=d*+h[a>>2];h[t+156>>2]=S;h[t+160>>2]=o;h[t+164>>2]=0.0;i=r[u+748>>2]|0;o=l}else{e=u+4+(c*184|0)+68|0;s=u+4+(c*184|0)+72|0}x=l*(d*+h[e>>2])*.20000000298023224;S=l*(d*+h[s>>2])*.20000000298023224;h[t+92>>2]=l*(d*+h[a>>2])*.20000000298023224+ +h[t+92>>2];h[t+96>>2]=x+ +h[t+96>>2];h[t+100>>2]=S+ +h[t+100>>2];e=1}c=c+1|0}while((c|0)<(i|0))}g=g+1|0}while((g|0)!=(m|0))}}}while(0);b=b+1|0;g=r[(r[t+8>>2]|0)+308>>2]|0}while((b|0)<(ck[r[(r[g>>2]|0)+36>>2]&127](g)|0))}else e=0;y=r[t+8>>2]|0;r[v>>2]=r[y+4>>2];r[v+4>>2]=r[y+4+4>>2];r[v+8>>2]=r[y+4+8>>2];r[v+12>>2]=r[y+4+12>>2];r[v+16>>2]=r[y+20>>2];r[v+16+4>>2]=r[y+20+4>>2];r[v+16+8>>2]=r[y+20+8>>2];r[v+16+12>>2]=r[y+20+12>>2];r[v+32>>2]=r[y+36>>2];r[v+32+4>>2]=r[y+36+4>>2];r[v+32+8>>2]=r[y+36+8>>2];r[v+32+12>>2]=r[y+36+12>>2];r[v+48>>2]=r[t+92>>2];r[v+48+4>>2]=r[t+92+4>>2];r[v+48+8>>2]=r[t+92+8>>2];r[v+48+12>>2]=r[t+92+12>>2];r[y+284>>2]=(r[y+284>>2]|0)+1;r[y+4>>2]=r[v>>2];r[y+4+4>>2]=r[v+4>>2];r[y+4+8>>2]=r[v+8>>2];r[y+4+12>>2]=r[v+12>>2];r[y+20>>2]=r[v+16>>2];r[y+20+4>>2]=r[v+16+4>>2];r[y+20+8>>2]=r[v+16+8>>2];r[y+20+12>>2]=r[v+16+12>>2];r[y+36>>2]=r[v+32>>2];r[y+36+4>>2]=r[v+32+4>>2];r[y+36+8>>2]=r[v+32+8>>2];r[y+36+12>>2]=r[v+32+12>>2];r[y+52>>2]=r[v+48>>2];r[y+52+4>>2]=r[v+48+4>>2];r[y+52+8>>2]=r[v+48+8>>2];r[y+52+12>>2]=r[v+48+12>>2];_=v;return e|0}function _E(t,e,i){t=t|0;e=e|0;i=+i;var o=0,a=0.0,l=0.0,c=0,u=0.0,d=0,p=0.0,f=0,m=0.0,g=0.0,b=0.0,y=0,v=0;y=_;_=_+528|0;if(!(n[t+171>>0]|0)){if(+h[t+172>>2]<=0.0){_=y;return}a=+h[t+60>>2];m=+h[t+64>>2];g=+h[t+68>>2];if(a*a+m*m+g*g<1.4210854715202004e-14){_=y;return}}n[t+168>>0]=(ck[r[(r[t>>2]|0)+48>>2]&127](t)|0)&1;a=+h[t+16>>2]-+h[t+44>>2]*i;h[t+16>>2]=a;if(a>0.0?(l=+h[t+28>>2],a>l):0){h[t+16>>2]=l;a=l}if(a<0.0?(g=+W(+a),u=+W(+ +h[t+24>>2]),g>u):0){h[t+16>>2]=-u;a=-u}h[t+20>>2]=a*i;o=r[t+8>>2]|0;r[y>>2]=r[o+4>>2];r[y+4>>2]=r[o+4+4>>2];r[y+8>>2]=r[o+4+8>>2];r[y+12>>2]=r[o+4+12>>2];r[y+16>>2]=r[o+20>>2];r[y+16+4>>2]=r[o+20+4>>2];r[y+16+8>>2]=r[o+20+8>>2];r[y+16+12>>2]=r[o+20+12>>2];r[y+32>>2]=r[o+36>>2];r[y+32+4>>2]=r[o+36+4>>2];r[y+32+8>>2]=r[o+36+8>>2];r[y+32+12>>2]=r[o+36+12>>2];r[y+48>>2]=r[o+52>>2];r[y+48+4>>2]=r[o+52+4>>2];r[y+48+8>>2]=r[o+52+8>>2];r[y+48+12>>2]=r[o+52+12>>2];o=r[t+176>>2]|0;if(!(n[19872]|0)){n[19872]=1;r[5298]=1065353216;r[5299]=0;r[5300]=0;r[5301]=0;r[5302]=0;r[5303]=1065353216;r[5304]=0;r[5305]=0;r[5306]=0;r[5307]=0;r[5308]=1065353216;h[5309]=0.0}u=+h[t+20>>2];u=+h[t+52>>2]+(u>0.0?u:0.0);m=+h[21192+(o<<4)+4>>2]*u+ +h[t+96>>2];g=u*+h[21192+(o<<4)+8>>2]+ +h[t+100>>2];h[t+112>>2]=+h[t+92>>2]+ +h[21192+(o<<4)>>2]*u;h[t+116>>2]=m;h[t+120>>2]=g;h[t+124>>2]=0.0;r[y+456>>2]=1065353216;r[y+456+4>>2]=0;r[y+456+4+4>>2]=0;r[y+456+4+8>>2]=0;r[y+456+4+12>>2]=0;r[y+456+20>>2]=1065353216;r[y+456+24>>2]=0;r[y+456+24+4>>2]=0;r[y+456+24+8>>2]=0;r[y+456+24+12>>2]=0;r[y+456+40>>2]=1065353216;o=y+456+44|0;r[o>>2]=0;r[o+4>>2]=0;r[o+8>>2]=0;r[o+12>>2]=0;r[o+16>>2]=0;r[y+392>>2]=1065353216;r[y+392+4>>2]=0;r[y+392+4+4>>2]=0;r[y+392+4+8>>2]=0;r[y+392+4+12>>2]=0;r[y+392+20>>2]=1065353216;r[y+392+24>>2]=0;r[y+392+24+4>>2]=0;r[y+392+24+8>>2]=0;r[y+392+24+12>>2]=0;r[y+392+40>>2]=1065353216;o=y+392+44|0;r[o>>2]=0;r[o+4>>2]=0;r[o+8>>2]=0;r[o+12>>2]=0;r[o+16>>2]=0;o=r[t+176>>2]|0;if(!(n[19872]|0)){n[19872]=1;r[5298]=1065353216;r[5299]=0;r[5300]=0;r[5301]=0;r[5302]=0;r[5303]=1065353216;r[5304]=0;r[5305]=0;r[5306]=0;r[5307]=0;r[5308]=1065353216;h[5309]=0.0}c=r[t+12>>2]|0;u=+xk[r[(r[c>>2]|0)+48>>2]&15](c);u=u+ +h[t+56>>2];m=u*+h[21192+(o<<4)+4>>2]+ +h[t+96>>2];g=u*+h[21192+(o<<4)+8>>2]+ +h[t+100>>2];h[y+456+48>>2]=+h[21192+(o<<4)>>2]*u+ +h[t+92>>2];h[y+456+52>>2]=m;h[y+456+56>>2]=g;h[y+456+60>>2]=0.0;r[y+392+48>>2]=r[t+112>>2];r[y+392+48+4>>2]=r[t+112+4>>2];r[y+392+48+8>>2]=r[t+112+8>>2];r[y+392+48+12>>2]=r[t+112+12>>2];o=r[t+8>>2]|0;c=r[t+176>>2]|0;if(!(n[19872]|0)){n[19872]=1;r[5298]=1065353216;r[5299]=0;r[5300]=0;r[5301]=0;r[5302]=0;r[5303]=1065353216;r[5304]=0;r[5305]=0;r[5306]=0;r[5307]=0;r[5308]=1065353216;h[5309]=0.0}u=-+h[21192+(c<<4)>>2];m=-+h[21192+(c<<4)+4>>2];g=-+h[21192+(c<<4)+8>>2];h[y+288+4>>2]=1.0;s[y+288+8>>1]=1;s[y+288+10>>1]=-1;f=y+288+12|0;r[y+288+76>>2]=0;r[f>>2]=0;r[f+4>>2]=0;r[f+8>>2]=0;r[f+12>>2]=0;r[f+16>>2]=0;r[f+20>>2]=0;r[f+24>>2]=0;r[f+28>>2]=0;r[y+288>>2]=7108;r[y+288+80>>2]=o;h[y+288+84>>2]=u;h[y+288+88>>2]=m;h[y+288+92>>2]=g;h[y+288+96>>2]=0.0;h[y+288+100>>2]=.707099974155426;o=r[t+8>>2]|0;f=r[(r[o+188>>2]|0)+4>>2]|0;s[y+288+8>>1]=f;s[y+288+10>>1]=f>>>16;if(!(n[t+170>>0]|0))Yx(e,r[t+12>>2]|0,y+456|0,y+392|0,y+288|0,0.0);else IR(o,r[t+12>>2]|0,y+456|0,y+392|0,y+288|0,+h[e+56>>2]);if(+h[y+288+4>>2]<1.0){o=r[t+176>>2]|0;if(!(n[19872]|0)){n[19872]=1;r[5298]=1065353216;r[5299]=0;r[5300]=0;r[5301]=0;r[5302]=0;r[5303]=1065353216;r[5304]=0;r[5305]=0;r[5306]=0;r[5307]=0;r[5308]=1065353216;h[5309]=0.0}do{if(+h[y+288+44>>2]*+h[21192+(o<<4)>>2]+ +h[y+288+48>>2]*+h[21192+(o<<4)+4>>2]+ +h[y+288+52>>2]*+h[21192+(o<<4)+8>>2]>0.0){a=+h[y+288+4>>2];h[t+108>>2]=+h[t+52>>2]*a;if(!(n[t+180>>0]|0)){r[t+92>>2]=r[t+112>>2];r[t+92+4>>2]=r[t+112+4>>2];r[t+92+8>>2]=r[t+112+8>>2];r[t+92+12>>2]=r[t+112+12>>2];break}else{h[t+92>>2]=(1.0-a)*+h[t+92>>2]+a*+h[t+112>>2];h[t+96>>2]=(1.0-a)*+h[t+96>>2]+a*+h[t+116>>2];h[t+100>>2]=(1.0-a)*+h[t+100>>2]+a*+h[t+120>>2];break}}}while(0);h[t+16>>2]=0.0;h[t+20>>2]=0.0}else{r[t+108>>2]=r[t+52>>2];r[t+92>>2]=r[t+112>>2];r[t+92+4>>2]=r[t+112+4>>2];r[t+92+8>>2]=r[t+112+8>>2];r[t+92+12>>2]=r[t+112+12>>2]}if(!(n[t+171>>0]|0)){m=+h[t+172>>2];g=m>i?i:m;h[t+172>>2]=m-i;fE(t,e,g*+h[t+60>>2],g*+h[t+64>>2],g*+h[t+68>>2])}else fE(t,e,+h[t+60>>2],+h[t+64>>2],+h[t+68>>2]);r[y+272>>2]=r[t+112>>2];r[y+272+4>>2]=r[t+112+4>>2];r[y+272+8>>2]=r[t+112+8>>2];r[y+272+12>>2]=r[t+112+12>>2];a=+h[t+16>>2];a=(a<0.0?-a:0.0)*i;if(a>0.0?(p=+h[t+24>>2],a>p):0){f=s[t+168>>1]|0;a=(f&255)<<24>>24!=0|(f&65535)<256?p:a}o=r[t+176>>2]|0;if(!(n[19872]|0)){n[19872]=1;r[5298]=1065353216;r[5299]=0;r[5300]=0;r[5301]=0;r[5302]=0;r[5303]=1065353216;r[5304]=0;r[5305]=0;r[5306]=0;r[5307]=0;r[5308]=1065353216;h[5309]=0.0}p=a+ +h[t+108>>2];m=+h[21192+(o<<4)>>2]*p;g=p*+h[21192+(o<<4)+4>>2];p=p*+h[21192+(o<<4)+8>>2];h[t+112>>2]=+h[t+112>>2]-m;h[t+116>>2]=+h[t+116>>2]-g;h[t+120>>2]=+h[t+120>>2]-p;o=r[t+8>>2]|0;c=r[t+176>>2]|0;if(!(n[19872]|0)){n[19872]=1;r[5298]=1065353216;r[5299]=0;r[5300]=0;r[5301]=0;r[5302]=0;r[5303]=1065353216;r[5304]=0;r[5305]=0;r[5306]=0;r[5307]=0;r[5308]=1065353216;h[5309]=0.0}d=r[t+40>>2]|0;f=y+168+4|0;h[f>>2]=1.0;s[y+168+8>>1]=1;s[y+168+10>>1]=-1;v=y+168+12|0;r[y+168+76>>2]=0;r[v>>2]=0;r[v+4>>2]=0;r[v+8>>2]=0;r[v+12>>2]=0;r[v+16>>2]=0;r[v+20>>2]=0;r[v+24>>2]=0;r[v+28>>2]=0;r[y+168>>2]=7108;r[y+168+80>>2]=o;r[y+168+84>>2]=r[21192+(c<<4)>>2];r[y+168+84+4>>2]=r[21192+(c<<4)+4>>2];r[y+168+84+8>>2]=r[21192+(c<<4)+8>>2];r[y+168+84+12>>2]=r[21192+(c<<4)+12>>2];r[y+168+100>>2]=d;o=r[t+8>>2]|0;c=r[(r[o+188>>2]|0)+4>>2]|0;s[y+168+8>>1]=c;s[y+168+10>>1]=c>>>16;c=r[t+176>>2]|0;if(!(n[19872]|0)){n[19872]=1;r[5298]=1065353216;r[5299]=0;r[5300]=0;r[5301]=0;r[5302]=0;r[5303]=1065353216;r[5304]=0;r[5305]=0;r[5306]=0;r[5307]=0;r[5308]=1065353216;h[5309]=0.0}v=r[t+40>>2]|0;h[y+64+4>>2]=1.0;s[y+64+8>>1]=1;s[y+64+10>>1]=-1;d=y+64+12|0;r[y+64+76>>2]=0;r[d>>2]=0;r[d+4>>2]=0;r[d+8>>2]=0;r[d+12>>2]=0;r[d+16>>2]=0;r[d+20>>2]=0;r[d+24>>2]=0;r[d+28>>2]=0;r[y+64>>2]=7108;r[y+64+80>>2]=o;r[y+64+84>>2]=r[21192+(c<<4)>>2];r[y+64+84+4>>2]=r[21192+(c<<4)+4>>2];r[y+64+84+8>>2]=r[21192+(c<<4)+8>>2];r[y+64+84+12>>2]=r[21192+(c<<4)+12>>2];r[y+64+100>>2]=v;o=r[(r[(r[t+8>>2]|0)+188>>2]|0)+4>>2]|0;s[y+64+8>>1]=o;s[y+64+10>>1]=o>>>16;a=+h[t+112>>2];l=+h[t+116>>2];u=+h[t+120>>2];o=0;while(1){r[y+456>>2]=1065353216;r[y+456+4>>2]=0;r[y+456+4+4>>2]=0;r[y+456+4+8>>2]=0;r[y+456+4+12>>2]=0;r[y+456+20>>2]=1065353216;r[y+456+24>>2]=0;r[y+456+24+4>>2]=0;r[y+456+24+8>>2]=0;r[y+456+24+12>>2]=0;r[y+456+40>>2]=1065353216;r[y+456+44>>2]=0;r[y+392>>2]=1065353216;r[y+392+4>>2]=0;r[y+392+4+4>>2]=0;r[y+392+4+8>>2]=0;r[y+392+4+12>>2]=0;r[y+392+20>>2]=1065353216;r[y+392+24>>2]=0;r[y+392+24+4>>2]=0;r[y+392+24+8>>2]=0;r[y+392+24+12>>2]=0;r[y+392+40>>2]=1065353216;r[y+392+44>>2]=0;r[y+288>>2]=1065353216;r[y+288+4>>2]=0;r[y+288+4+4>>2]=0;r[y+288+4+8>>2]=0;r[y+288+4+12>>2]=0;r[y+288+20>>2]=1065353216;r[y+288+24>>2]=0;r[y+288+24+4>>2]=0;r[y+288+24+8>>2]=0;r[y+288+24+12>>2]=0;r[y+288+40>>2]=1065353216;r[y+288+44>>2]=0;r[y+288+44+4>>2]=0;r[y+288+44+8>>2]=0;r[y+456+48>>2]=r[t+92>>2];r[y+456+48+4>>2]=r[t+92+4>>2];r[y+456+48+8>>2]=r[t+92+8>>2];r[y+456+48+12>>2]=r[t+92+12>>2];r[y+392+48>>2]=r[t+112>>2];r[y+392+48+4>>2]=r[t+112+4>>2];r[y+392+48+8>>2]=r[t+112+8>>2];r[y+392+48+12>>2]=r[t+112+12>>2];h[y+288+48>>2]=a-m;h[y+288+52>>2]=l-g;h[y+288+56>>2]=u-p;h[y+288+60>>2]=0.0;if(!(n[t+170>>0]|0)){Yx(e,r[t+12>>2]|0,y+456|0,y+392|0,y+168|0,+h[e+56>>2]);if(!(+h[f>>2]<1.0))Yx(e,r[t+12>>2]|0,y+456|0,y+288|0,y+64|0,+h[e+56>>2])}else{IR(r[t+8>>2]|0,r[t+12>>2]|0,y+456|0,y+392|0,y+168|0,+h[e+56>>2]);if(!(+h[f>>2]<1.0))IR(r[t+8>>2]|0,r[t+12>>2]|0,y+456|0,y+288|0,y+64|0,+h[e+56>>2])}l=+h[t+16>>2];l=(l<0.0?-l:0.0)*i;d=(n[t+182>>0]|0)==0;if(!d?+h[f>>2]<1.0:0)c=1;else c=+h[y+64+4>>2]<1.0;if(!(l>0.0))break;a=+h[t+52>>2];if(o|(!(l<a)|c^1))break;v=s[t+168>>1]|0;if(!((v&255)<<24>>24!=0|(v&65535)<256)){o=0;break}r[t+112>>2]=r[y+272>>2];r[t+112+4>>2]=r[y+272+4>>2];r[t+112+8>>2]=r[y+272+8>>2];r[t+112+12>>2]=r[y+272+12>>2];o=r[t+176>>2]|0;if(!(n[19872]|0)){n[19872]=1;r[5298]=1065353216;r[5299]=0;r[5300]=0;r[5301]=0;r[5302]=0;r[5303]=1065353216;r[5304]=0;r[5305]=0;r[5306]=0;r[5307]=0;r[5308]=1065353216;h[5309]=0.0}a=a+ +h[t+108>>2];l=a*+h[21192+(o<<4)+4>>2];u=a*+h[21192+(o<<4)+8>>2];a=+h[t+112>>2]-+h[21192+(o<<4)>>2]*a;h[t+112>>2]=a;l=+h[t+116>>2]-l;h[t+116>>2]=l;u=+h[t+120>>2]-u;h[t+120>>2]=u;o=1}u=+h[f>>2];if(o|u<1.0){a=+h[t+96>>2];l=(a-+h[y+168+64>>2])*.5;do{if(!d)if(!(n[t+181>>0]|0)){h[t+92>>2]=(1.0-l)*+h[t+92>>2]+l*+h[t+112>>2];h[t+96>>2]=(1.0-l)*a+l*+h[t+116>>2];h[t+100>>2]=(1.0-l)*+h[t+100>>2]+l*+h[t+120>>2];o=t+181|0;break}else{h[t+92>>2]=(1.0-u)*+h[t+92>>2]+u*+h[t+112>>2];h[t+96>>2]=(1.0-u)*a+u*+h[t+116>>2];h[t+100>>2]=(1.0-u)*+h[t+100>>2]+u*+h[t+120>>2];o=t+181|0;break}else{h[t+92>>2]=(1.0-u)*+h[t+92>>2]+u*+h[t+112>>2];h[t+96>>2]=(1.0-u)*a+u*+h[t+116>>2];h[t+100>>2]=(1.0-u)*+h[t+100>>2]+u*+h[t+120>>2];o=t+181|0}}while(0);n[o>>0]=0;h[t+16>>2]=0.0;h[t+20>>2]=0.0;n[t+169>>0]=0}else{n[t+181>>0]=1;if((!d?(b=+h[t+24>>2],l>b):0)?(v=s[t+168>>1]|0,(v&255)<<24>>24!=0|(v&65535)<256):0){h[t+112>>2]=m+ +h[t+112>>2];h[t+116>>2]=g+ +h[t+116>>2];h[t+120>>2]=p+ +h[t+120>>2];o=r[t+176>>2]|0;if(!(n[19872]|0)){n[19872]=1;r[5298]=1065353216;r[5299]=0;r[5300]=0;r[5301]=0;r[5302]=0;r[5303]=1065353216;r[5304]=0;r[5305]=0;r[5306]=0;r[5307]=0;r[5308]=1065353216;h[5309]=0.0}g=b+ +h[t+108>>2];i=g*+h[21192+(o<<4)+4>>2];b=g*+h[21192+(o<<4)+8>>2];h[t+112>>2]=+h[t+112>>2]-+h[21192+(o<<4)>>2]*g;h[t+116>>2]=+h[t+116>>2]-i;h[t+120>>2]=+h[t+120>>2]-b}r[t+92>>2]=r[t+112>>2];r[t+92+4>>2]=r[t+112+4>>2];r[t+92+8>>2]=r[t+112+8>>2];r[t+92+12>>2]=r[t+112+12>>2]}r[y+48>>2]=r[t+92>>2];r[y+48+4>>2]=r[t+92+4>>2];r[y+48+8>>2]=r[t+92+8>>2];r[y+48+12>>2]=r[t+92+12>>2];v=r[t+8>>2]|0;r[v+284>>2]=(r[v+284>>2]|0)+1;r[v+4>>2]=r[y>>2];r[v+4+4>>2]=r[y+4>>2];r[v+4+8>>2]=r[y+8>>2];r[v+4+12>>2]=r[y+12>>2];r[v+20>>2]=r[y+16>>2];r[v+20+4>>2]=r[y+16+4>>2];r[v+20+8>>2]=r[y+16+8>>2];r[v+20+12>>2]=r[y+16+12>>2];r[v+36>>2]=r[y+32>>2];r[v+36+4>>2]=r[y+32+4>>2];r[v+36+8>>2]=r[y+32+8>>2];r[v+36+12>>2]=r[y+32+12>>2];r[v+52>>2]=r[y+48>>2];r[v+52+4>>2]=r[y+48+4>>2];r[v+52+8>>2]=r[y+48+8>>2];r[v+52+12>>2]=r[y+48+12>>2];_=y;return}function uE(t){t=t|0;Ql(t);return}function dE(t,e){t=t|0;e=e|0;e=r[e+4>>2]|0;if(!((s[t+10>>1]&(e&65535))<<16>>16)){t=0;return t|0}t=(e>>>16&65535&s[t+8>>1])<<16>>16!=0;return t|0}function pE(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0,l=0.0,c=0.0;a=r[e>>2]|0;if((a|0)==(r[t+80>>2]|0)){c=1.0;return+c}if(r[a+204>>2]&4|0){c=1.0;return+c}o=+h[e+8>>2];s=+h[e+12>>2];n=+h[e+16>>2];if(i){l=o;c=s}else{l=+h[a+4>>2]*o+ +h[a+8>>2]*s+ +h[a+12>>2]*n;c=o*+h[a+20>>2]+s*+h[a+24>>2]+n*+h[a+28>>2];n=o*+h[a+36>>2]+s*+h[a+40>>2]+n*+h[a+44>>2]}if(l*+h[t+84>>2]+c*+h[t+88>>2]+n*+h[t+92>>2]<+h[t+100>>2]){c=1.0;return+c}r[t+4>>2]=r[e+40>>2];r[t+76>>2]=a;if(i){r[t+44>>2]=r[e+8>>2];r[t+44+4>>2]=r[e+8+4>>2];r[t+44+8>>2]=r[e+8+8>>2];r[t+44+12>>2]=r[e+8+12>>2]}else{n=+h[e+8>>2];s=+h[e+12>>2];o=+h[e+16>>2];l=n*+h[a+20>>2]+s*+h[a+24>>2]+o*+h[a+28>>2];c=n*+h[a+36>>2]+s*+h[a+40>>2]+o*+h[a+44>>2];h[t+44>>2]=+h[a+4>>2]*n+ +h[a+8>>2]*s+ +h[a+12>>2]*o;h[t+48>>2]=l;h[t+52>>2]=c;h[t+56>>2]=0.0}r[t+60>>2]=r[e+24>>2];r[t+60+4>>2]=r[e+24+4>>2];r[t+60+8>>2]=r[e+24+8>>2];r[t+60+12>>2]=r[e+24+12>>2];c=+h[e+40>>2];return+c}function fE(t,e,i,o,a){t=t|0;e=e|0;i=+i;o=+o;a=+a;var l=0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0,g=0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0;m=_;_=_+240|0;p=+h[t+96>>2]+o;f=+h[t+100>>2]+a;h[t+112>>2]=+h[t+92>>2]+i;h[t+116>>2]=p;h[t+120>>2]=f;h[t+124>>2]=0.0;r[m+168>>2]=1065353216;r[m+168+4>>2]=0;r[m+168+4+4>>2]=0;r[m+168+4+8>>2]=0;r[m+168+4+12>>2]=0;r[m+168+20>>2]=1065353216;r[m+168+24>>2]=0;r[m+168+24+4>>2]=0;r[m+168+24+8>>2]=0;r[m+168+24+12>>2]=0;r[m+168+40>>2]=1065353216;l=m+168+44|0;r[l>>2]=0;r[l+4>>2]=0;r[l+8>>2]=0;r[l+12>>2]=0;r[l+16>>2]=0;r[m+104>>2]=1065353216;r[m+104+4>>2]=0;r[m+104+4+4>>2]=0;r[m+104+4+8>>2]=0;r[m+104+4+12>>2]=0;r[m+104+20>>2]=1065353216;r[m+104+24>>2]=0;r[m+104+24+4>>2]=0;r[m+104+24+8>>2]=0;r[m+104+24+12>>2]=0;r[m+104+40>>2]=1065353216;l=m+104+44|0;r[l>>2]=0;r[l+4>>2]=0;r[l+8>>2]=0;r[l+12>>2]=0;r[l+16>>2]=0;f=1.0;l=10;while(1){if((l|0)<=0){l=14;break}l=l+-1|0;r[m+168+48>>2]=r[t+92>>2];r[m+168+48+4>>2]=r[t+92+4>>2];r[m+168+48+8>>2]=r[t+92+8>>2];r[m+168+48+12>>2]=r[t+92+12>>2];r[m+104+48>>2]=r[t+112>>2];r[m+104+48+4>>2]=r[t+112+4>>2];r[m+104+48+8>>2]=r[t+112+8>>2];r[m+104+48+12>>2]=r[t+112+12>>2];d=+h[t+92>>2]-+h[t+112>>2];p=+h[t+96>>2]-+h[t+116>>2];i=+h[t+100>>2]-+h[t+120>>2];g=r[t+8>>2]|0;h[m+4>>2]=1.0;s[m+8>>1]=1;s[m+10>>1]=-1;r[m+76>>2]=0;r[m+12>>2]=0;r[m+12+4>>2]=0;r[m+12+8>>2]=0;r[m+12+12>>2]=0;r[m+12+16>>2]=0;r[m+12+20>>2]=0;r[m+12+24>>2]=0;r[m+12+28>>2]=0;r[m>>2]=7108;r[m+80>>2]=g;h[m+84>>2]=d;h[m+88>>2]=p;h[m+92>>2]=i;h[m+96>>2]=0.0;h[m+100>>2]=0.0;g=r[(r[g+188>>2]|0)+4>>2]|0;s[m+8>>1]=g;s[m+10>>1]=g>>>16;g=r[t+12>>2]|0;i=+xk[r[(r[g>>2]|0)+48>>2]&15](g);g=r[t+12>>2]|0;rk[r[(r[g>>2]|0)+44>>2]&31](g,i+ +h[t+56>>2]);if(!(n[t+170>>0]|0))Yx(e,r[t+12>>2]|0,m+168|0,m+104|0,m,+h[e+56>>2]);else IR(r[t+8>>2]|0,r[t+12>>2]|0,m+168|0,m+104|0,m,+h[e+56>>2]);g=r[t+12>>2]|0;rk[r[(r[g>>2]|0)+44>>2]&31](g,i);p=+h[m+4>>2];f=f-p;if(p<1.0){o=+h[t+112>>2];u=+h[t+92>>2];a=+h[t+116>>2];d=+h[t+96>>2];c=+h[t+120>>2];p=+h[t+100>>2];i=+G(+((o-u)*(o-u)+(a-d)*(a-d)+(c-p)*(c-p)));if(i>1.1920928955078125e-07){S=+h[m+44>>2];y=+h[m+48>>2];w=+h[m+52>>2];x=((o-u)*(1.0/i)*S+(a-d)*(1.0/i)*y+(c-p)*(1.0/i)*w)*2.0;v=(o-u)*(1.0/i)-S*x;b=(a-d)*(1.0/i)-y*x;x=(c-p)*(1.0/i)-w*x;c=1.0/+G(+(x*x+(v*v+b*b)));r[t+112>>2]=r[t+92>>2];r[t+112+4>>2]=r[t+92+4>>2];r[t+112+8>>2]=r[t+92+8>>2];r[t+112+12>>2]=r[t+92+12>>2];o=i*(c*v-S*(w*(c*x)+(S*(c*v)+y*(c*b))))+ +h[t+112>>2];h[t+112>>2]=o;a=i*(c*b-y*(w*(c*x)+(S*(c*v)+y*(c*b))))+ +h[t+116>>2];h[t+116>>2]=a;c=i*(c*x-w*(w*(c*x)+(S*(c*v)+y*(c*b))))+ +h[t+120>>2];h[t+120>>2]=c;i=a}else i=a;a=o-u;o=i-d;i=c-p;if(!(a*a+o*o+i*i>1.1920928955078125e-07)){l=11;break}w=1.0/+G(+(a*a+o*o+i*i));if(+h[t+76>>2]*(a*w)+o*w*+h[t+80>>2]+i*w*+h[t+84>>2]<=0.0){l=11;break}}else{r[t+92>>2]=r[t+112>>2];r[t+92+4>>2]=r[t+112+4>>2];r[t+92+8>>2]=r[t+112+8>>2];r[t+92+12>>2]=r[t+112+12>>2]}if(!(f>.009999999776482582)){l=14;break}}if((l|0)==11){_=m;return}else if((l|0)==14){_=m;return}}function mE(t){t=t|0;return ck[r[(r[t>>2]|0)+48>>2]&127](t)|0}function gE(t){t=t|0;if(!(ck[r[(r[t>>2]|0)+40>>2]&127](t)|0))return;r[t+16>>2]=r[t+28>>2];n[t+169>>0]=1;return}function bE(t){t=t|0;if(!(+h[t+16>>2]==0.0)){t=0;return t|0}t=+h[t+20>>2]==0.0;return t|0}function yE(t,e){t=t|0;e=e|0;n[t+180>>0]=e&1;return}function vE(t){t=t|0;r[t>>2]=7188;return}function SE(t){t=t|0;r[t>>2]=7188;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function xE(t){t=t|0;return}function wE(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=+s;return}function CE(t,e,i,n){t=t|0;e=e|0;i=i|0;n=+n;return}function TE(t){t=t|0;return 52}function AE(t){t=t|0;r[t>>2]=7188;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function EE(t){t=t|0;var e=0,i=0.0,s=0.0,o=0.0,a=0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0,x=0.0,w=0.0,C=0;S=_;_=_+176|0;if(!(n[t+527>>0]|0)){_=S;return}h[t+36>>2]=0.0;h[t+520>>2]=0.0;h[t+516>>2]=0.0;r[t+576>>2]=0;r[t+576+4>>2]=0;r[t+576+8>>2]=0;r[t+576+12>>2]=0;if(!(n[t+524>>0]|0)){e=r[t+28>>2]|0;l=+h[t+348>>2];c=+h[t+352>>2];g=+h[t+356>>2];y=l*+h[e+20>>2]+c*+h[e+24>>2]+g*+h[e+28>>2]+ +h[e+56>>2];a=r[t+32>>2]|0;u=+h[t+412>>2];d=+h[t+416>>2];b=+h[t+420>>2];p=+h[a+52>>2];i=+h[a+56>>2];v=u*+h[a+20>>2]+d*+h[a+24>>2]+b*+h[a+28>>2]+i;f=u*+h[a+36>>2]+d*+h[a+40>>2]+b*+h[a+44>>2]+ +h[a+60>>2];m=l*+h[e+4>>2]+c*+h[e+8>>2]+g*+h[e+12>>2]+ +h[e+52>>2];g=l*+h[e+36>>2]+c*+h[e+40>>2]+g*+h[e+44>>2]+ +h[e+60>>2];b=u*+h[a+4>>2]+d*+h[a+8>>2]+b*+h[a+12>>2]+p;if((b-m)*(b-m)+(v-y)*(v-y)+(f-g)*(f-g)>1.1920928955078125e-07){o=1.0/+G(+((b-m)*(b-m)+(v-y)*(v-y)+(f-g)*(f-g)));h[S+128>>2]=(b-m)*o;h[S+128+4>>2]=(v-y)*o;h[S+128+8>>2]=(f-g)*o;r[S+128+12>>2]=0;l=(f-g)*o;s=(v-y)*o;o=(b-m)*o}else{r[S+128>>2]=1065353216;r[S+128+4>>2]=0;r[S+128+8>>2]=0;h[S+128+12>>2]=0.0;l=0.0;s=0.0;o=1.0}if(+W(+l)>.7071067690849304){w=l*l+s*s;x=1.0/+G(+w);u=-(x*l);l=x*s;d=-(l*o);c=o*u;s=w*x;o=l;l=0.0}else{u=o*o+s*s;c=1.0/+G(+u);w=-(s*c);s=c*o;d=l*w;c=u*c;u=s;s=-(s*l);o=0.0;l=w}h[S+128+16>>2]=l;h[S+128+20>>2]=u;h[S+128+24>>2]=o;h[S+128+32>>2]=s;h[S+128+36>>2]=d;h[S+128+40>>2]=c;s=p;e=0;while(1){C=r[t+28>>2]|0;r[S+80>>2]=r[C+4>>2];r[S+80+4>>2]=r[C+20>>2];r[S+80+8>>2]=r[C+36>>2];h[S+80+12>>2]=0.0;r[S+80+16>>2]=r[C+8>>2];r[S+80+20>>2]=r[C+24>>2];r[S+80+24>>2]=r[C+40>>2];h[S+80+28>>2]=0.0;r[S+80+32>>2]=r[C+12>>2];r[S+80+36>>2]=r[C+28>>2];r[S+80+40>>2]=r[C+44>>2];h[S+80+44>>2]=0.0;r[S+32>>2]=r[a+4>>2];r[S+32+4>>2]=r[a+20>>2];r[S+32+8>>2]=r[a+36>>2];h[S+32+12>>2]=0.0;r[S+32+16>>2]=r[a+8>>2];r[S+32+20>>2]=r[a+24>>2];r[S+32+24>>2]=r[a+40>>2];h[S+32+28>>2]=0.0;r[S+32+32>>2]=r[a+12>>2];r[S+32+36>>2]=r[a+28>>2];r[S+32+40>>2]=r[a+44>>2];h[S+32+44>>2]=0.0;x=y-+h[C+56>>2];w=g-+h[C+60>>2];h[S+16>>2]=m-+h[C+52>>2];h[S+16+4>>2]=x;h[S+16+8>>2]=w;h[S+16+12>>2]=0.0;w=f-+h[a+60>>2];h[S>>2]=b-s;h[S+4>>2]=v-i;h[S+8>>2]=w;h[S+12>>2]=0.0;C=r[t+28>>2]|0;a=r[t+32>>2]|0;ME(t+48+(e*84|0)|0,S+80|0,S+32|0,S+16|0,S,S+128+(e<<4)|0,C+420|0,+h[C+368>>2],a+420|0,+h[a+368>>2]);e=e+1|0;if((e|0)==3)break;C=r[t+32>>2]|0;a=C;s=+h[C+52>>2];i=+h[C+56>>2]}e=t+32|0}else e=t+32|0;a=r[t+28>>2]|0;C=r[e>>2]|0;RE(t,a+4|0,C+4|0,a+288|0,C+288|0);_=S;return}function ME(t,e,i,n,s,o,a,l,c,_){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;l=+l;c=c|0;_=+_;var u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0;r[t>>2]=r[o>>2];r[t+4>>2]=r[o+4>>2];r[t+8>>2]=r[o+8>>2];r[t+12>>2]=r[o+12>>2];b=+h[n+4>>2];S=+h[t+8>>2];x=+h[n+8>>2];f=+h[t+4>>2];u=+h[t>>2];g=+h[n>>2];v=(b*S-x*f)*+h[e>>2]+ +h[e+4>>2]*(x*u-S*g)+(f*g-b*u)*+h[e+8>>2];y=(b*S-x*f)*+h[e+16>>2]+(x*u-S*g)*+h[e+20>>2]+(f*g-b*u)*+h[e+24>>2];b=(b*S-x*f)*+h[e+32>>2]+(x*u-S*g)*+h[e+36>>2]+(f*g-b*u)*+h[e+40>>2];h[t+16>>2]=v;h[t+20>>2]=y;h[t+24>>2]=b;h[t+28>>2]=0.0;g=+h[s+4>>2];x=+h[s+8>>2];d=+h[s>>2];m=+h[i>>2]*(g*-S-x*-f)+ +h[i+4>>2]*(x*-u-d*-S)+(d*-f-g*-u)*+h[i+8>>2];p=(g*-S-x*-f)*+h[i+16>>2]+(x*-u-d*-S)*+h[i+20>>2]+(d*-f-g*-u)*+h[i+24>>2];u=(g*-S-x*-f)*+h[i+32>>2]+(x*-u-d*-S)*+h[i+36>>2]+(d*-f-g*-u)*+h[i+40>>2];h[t+32>>2]=m;h[t+36>>2]=p;h[t+40>>2]=u;h[t+44>>2]=0.0;v=+h[a>>2]*v;y=+h[a+4>>2]*y;b=+h[a+8>>2]*b;h[t+48>>2]=v;h[t+52>>2]=y;h[t+56>>2]=b;h[t+60>>2]=0.0;g=+h[c>>2]*m;f=+h[c+4>>2]*p;d=+h[c+8>>2]*u;h[t+64>>2]=g;h[t+68>>2]=f;h[t+72>>2]=d;h[t+76>>2]=0.0;h[t+80>>2]=v*+h[t+16>>2]+y*+h[t+20>>2]+b*+h[t+24>>2]+l+_+(g*m+f*p+d*u);return}function RE(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0.0,l=0.0,c=0.0,u=0.0,p=0.0,f=0,m=0.0,g=0.0,b=0,y=0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0,z=0.0,j=0.0,Y=0.0,K=0.0,Z=0.0,$=0.0,J=0.0,tt=0.0,et=0.0,it=0.0,nt=0.0,st=0.0,rt=0.0,ot=0.0,at=0.0,lt=0.0,ht=0.0,ct=0.0,_t=0.0,ut=0.0,dt=0.0,pt=0.0,ft=0.0,mt=0.0,gt=0,bt=0.0,yt=0.0,vt=0.0,St=0.0,xt=0.0;gt=_;_=_+144|0;h[t+504>>2]=0.0;h[t+500>>2]=0.0;n[t+525>>0]=0;n[t+526>>0]=0;if(n[t+552>>0]|0?(n[t+527>>0]|0)==0:0){xt=+h[t+556>>2];vt=+h[t+560>>2];mt=+h[t+564>>2];yt=+h[t+568>>2];rt=xt*(2.0/(xt*xt+vt*vt+mt*mt+yt*yt));St=vt*(2.0/(xt*xt+vt*vt+mt*mt+yt*yt));bt=mt*(2.0/(xt*xt+vt*vt+mt*mt+yt*yt));ot=+h[t+300>>2];K=+h[e>>2];at=+h[t+316>>2];Z=+h[e+4>>2];lt=+h[t+332>>2];$=+h[e+8>>2];ct=+h[t+304>>2];ut=+h[t+320>>2];pt=+h[t+336>>2];it=+h[t+308>>2];nt=+h[t+324>>2];st=+h[t+340>>2];J=+h[e+16>>2];tt=+h[e+20>>2];et=+h[e+24>>2];_t=+h[e+32>>2];dt=+h[e+36>>2];ft=+h[e+40>>2];x=+h[t+348>>2];S=+h[t+352>>2];v=+h[t+356>>2];A=+h[t+364>>2];u=+h[i>>2];E=+h[t+380>>2];p=+h[i+4>>2];M=+h[t+396>>2];c=+h[i+8>>2];R=+h[t+368>>2];I=+h[t+384>>2];P=+h[t+400>>2];w=+h[t+372>>2];C=+h[t+388>>2];T=+h[t+404>>2];m=+h[i+16>>2];g=+h[i+20>>2];l=+h[i+24>>2];L=+h[i+32>>2];k=+h[i+36>>2];F=+h[i+40>>2];D=+h[t+412>>2];O=+h[t+416>>2];a=+h[t+420>>2];N=(1.0-(vt*St+mt*bt))*(A*u+E*p+M*c)+(xt*St+yt*bt)*(u*R+p*I+c*P)+(xt*bt-yt*St)*(u*w+p*C+c*T);U=(xt*St-yt*bt)*(A*u+E*p+M*c)+(1.0-(xt*rt+mt*bt))*(u*R+p*I+c*P)+(vt*bt+yt*rt)*(u*w+p*C+c*T);B=(xt*bt+yt*St)*(A*u+E*p+M*c)+(vt*bt-yt*rt)*(u*R+p*I+c*P)+(1.0-(xt*rt+vt*St))*(u*w+p*C+c*T);j=(xt*bt-yt*St)*(w*m+C*g+T*l)+((1.0-(vt*St+mt*bt))*(A*m+E*g+M*l)+(xt*St+yt*bt)*(R*m+I*g+P*l));Y=(vt*bt+yt*rt)*(w*m+C*g+T*l)+((xt*St-yt*bt)*(A*m+E*g+M*l)+(1.0-(xt*rt+mt*bt))*(R*m+I*g+P*l));z=(1.0-(xt*rt+vt*St))*(w*m+C*g+T*l)+((xt*bt+yt*St)*(A*m+E*g+M*l)+(vt*bt-yt*rt)*(R*m+I*g+P*l));ht=(xt*bt-yt*St)*(w*L+C*k+T*F)+((1.0-(vt*St+mt*bt))*(A*L+E*k+M*F)+(xt*St+yt*bt)*(R*L+I*k+P*F));mt=(vt*bt+yt*rt)*(w*L+C*k+T*F)+((xt*St-yt*bt)*(A*L+E*k+M*F)+(1.0-(xt*rt+mt*bt))*(R*L+I*k+P*F));rt=(1.0-(xt*rt+vt*St))*(w*L+C*k+T*F)+((xt*bt+yt*St)*(A*L+E*k+M*F)+(vt*bt-yt*rt)*(R*L+I*k+P*F));yt=-(+h[e+48>>2]+(K*x+Z*S+$*v));bt=-(J*x+tt*S+et*v+ +h[e+52>>2]);v=-(_t*x+dt*S+ft*v+ +h[e+56>>2]);S=(ot*K+at*Z+lt*$)*yt+(ot*J+at*tt+lt*et)*bt+(ot*_t+at*dt+lt*ft)*v;x=(K*ct+Z*ut+$*pt)*yt+(ct*J+ut*tt+pt*et)*bt+(ct*_t+ut*dt+pt*ft)*v;v=(K*it+Z*nt+$*st)*yt+(it*J+nt*tt+st*et)*bt+(it*_t+nt*dt+st*ft)*v;c=v*B+(S*N+x*U)+((A*u+E*p+M*c)*0.0+(u*R+p*I+c*P)*0.0+(u*w+p*C+c*T)*0.0+(+h[i+48>>2]+(u*D+p*O+c*a)));l=v*z+(S*j+x*Y)+((w*m+C*g+T*l)*0.0+((A*m+E*g+M*l)*0.0+(R*m+I*g+P*l)*0.0)+(m*D+g*O+l*a+ +h[i+52>>2]));a=v*rt+(S*ht+x*mt)+((w*L+C*k+T*F)*0.0+((A*L+E*k+M*F)*0.0+(R*L+I*k+P*F)*0.0)+(L*D+k*O+F*a+ +h[i+56>>2]));h[gt+80>>2]=(K*it+Z*nt+$*st)*B+((ot*K+at*Z+lt*$)*N+(K*ct+Z*ut+$*pt)*U);h[gt+80+4>>2]=(it*J+nt*tt+st*et)*B+((ot*J+at*tt+lt*et)*N+(ct*J+ut*tt+pt*et)*U);h[gt+80+8>>2]=(it*_t+nt*dt+st*ft)*B+((ot*_t+at*dt+lt*ft)*N+(ct*_t+ut*dt+pt*ft)*U);h[gt+80+12>>2]=0.0;h[gt+80+16>>2]=(K*it+Z*nt+$*st)*z+((ot*K+at*Z+lt*$)*j+(K*ct+Z*ut+$*pt)*Y);h[gt+80+20>>2]=(it*J+nt*tt+st*et)*z+((ot*J+at*tt+lt*et)*j+(ct*J+ut*tt+pt*et)*Y);h[gt+80+24>>2]=(it*_t+nt*dt+st*ft)*z+((ot*_t+at*dt+lt*ft)*j+(ct*_t+ut*dt+pt*ft)*Y);h[gt+80+28>>2]=0.0;h[gt+80+32>>2]=(K*it+Z*nt+$*st)*rt+((ot*K+at*Z+lt*$)*ht+(K*ct+Z*ut+$*pt)*mt);h[gt+80+36>>2]=(it*J+nt*tt+st*et)*rt+((ot*J+at*tt+lt*et)*ht+(ct*J+ut*tt+pt*et)*mt);h[gt+80+40>>2]=(it*_t+nt*dt+st*ft)*rt+((ot*_t+at*dt+lt*ft)*ht+(ct*_t+ut*dt+pt*ft)*mt);h[gt+80+44>>2]=0.0;h[gt+80+48>>2]=c;h[gt+80+52>>2]=l;h[gt+80+56>>2]=a;h[gt+80+60>>2]=0.0;Kx(gt+80|0,gt+64|0);a=+h[gt+64>>2];l=+h[gt+64+4>>2];c=+h[gt+64+8>>2];if(!(+W(+(a*a+l*l+c*c))<1.1920928955078125e-07)?(h[t+472>>2]=0.0,xt=1.0/+G(+(a*a+l*l+c*c)),h[t+460>>2]=a*xt,h[t+464>>2]=l*xt,h[t+468>>2]=c*xt,xt=+h[gt+64+12>>2],xt=xt<-1.0?-1.0:xt,xt=+q(+(xt>1.0?1.0:xt))*2.0,h[t+504>>2]=xt,!(+W(+xt)<1.1920928955078125e-07)):0)n[t+526>>0]=1;_=gt;return}Kx(e,gt+48|0);Kx(t+300|0,gt+32|0);$=+h[gt+48+12>>2];J=+h[gt+32>>2];tt=+h[gt+48>>2];et=+h[gt+32+12>>2];it=+h[gt+48+4>>2];nt=+h[gt+32+8>>2];st=+h[gt+48+8>>2];rt=+h[gt+32+4>>2];Kx(i,gt+16|0);Kx(t+364|0,gt);ot=+h[gt+16+12>>2];at=+h[gt>>2];lt=+h[gt+16>>2];ht=+h[gt+12>>2];ct=+h[gt+16+4>>2];_t=+h[gt+8>>2];ut=+h[gt+16+8>>2];dt=+h[gt+4>>2];pt=-(ot*at+lt*ht+ct*_t-ut*dt);ft=-(at*ut+(ht*ct+ot*dt)-lt*_t);mt=-(ot*_t+ht*ut+lt*dt-at*ct);v=($*et-J*tt-it*rt-nt*st)*pt+($*J+tt*et+it*nt-st*rt)*(ot*ht-at*lt-ct*dt-_t*ut)+($*nt+et*st+tt*rt-J*it)*ft-(J*st+(et*it+$*rt)-tt*nt)*mt;S=($*J+tt*et+it*nt-st*rt)*mt+((J*st+(et*it+$*rt)-tt*nt)*(ot*ht-at*lt-ct*dt-_t*ut)+($*et-J*tt-it*rt-nt*st)*ft)-($*nt+et*st+tt*rt-J*it)*pt;x=(J*st+(et*it+$*rt)-tt*nt)*pt+(($*nt+et*st+tt*rt-J*it)*(ot*ht-at*lt-ct*dt-_t*ut)+($*et-J*tt-it*rt-nt*st)*mt)-($*J+tt*et+it*nt-st*rt)*ft;w=($*et-J*tt-it*rt-nt*st)*(ot*ht-at*lt-ct*dt-_t*ut)-($*J+tt*et+it*nt-st*rt)*pt-(J*st+(et*it+$*rt)-tt*nt)*ft-($*nt+et*st+tt*rt-J*it)*mt;c=+h[5310];u=+h[5312];l=+h[5311];p=(c*x+l*w-u*v)*-x+(w*(c*w+u*S-l*x)+(-(c*v)-l*S-u*x)*-v)-(u*w+l*v-c*S)*-S;a=(u*w+l*v-c*S)*-v+(w*(c*x+l*w-u*v)+(-(c*v)-l*S-u*x)*-S)-(c*w+u*S-l*x)*-x;m=(c*w+u*S-l*x)*-S+(w*(u*w+l*v-c*S)+(-(c*v)-l*S-u*x)*-x)-(c*x+l*w-u*v)*-v;g=1.0/+G(+(m*m+(p*p+a*a)));do{if(u*(g*m)+(l*(g*a)+c*(g*p))<-.9999998807907104)if(+W(+u)>.7071067690849304){a=1.0/+G(+(u*u+l*l));f=0;b=(h[d>>2]=l*a,r[d>>2]|0);y=0;a=-(u*a);break}else{a=1.0/+G(+(c*c+l*l));f=(h[d>>2]=-(l*a),r[d>>2]|0);b=0;y=0;a=c*a;break}else{xt=+G(+((u*(g*m)+(l*(g*a)+c*(g*p))+1.0)*2.0));f=(h[d>>2]=(l*(g*m)-u*(g*a))*(1.0/xt),r[d>>2]|0);b=(h[d>>2]=(c*(g*a)-l*(g*p))*(1.0/xt),r[d>>2]|0);y=(h[d>>2]=xt*.5,r[d>>2]|0);a=(u*(g*p)-c*(g*m))*(1.0/xt)}}while(0);c=(r[d>>2]=f,+h[d>>2]);m=(r[d>>2]=b,+h[d>>2]);l=(r[d>>2]=y,+h[d>>2]);u=1.0/+G(+(c*c+a*a+m*m+l*l));p=a*u;Y=x*-p+(v*(l*u)+w*-(c*u))-S*-(m*u);K=v*-(m*u)+(w*-p+S*(l*u))-x*-(c*u);Z=S*-(c*u)+(x*(l*u)+w*-(m*u))-v*-p;z=w*(l*u)-v*-(c*u)-S*-p-x*-(m*u);j=1.0/+G(+(z*z+(Z*Z+(Y*Y+K*K))));v=+h[t+444>>2];a=+h[t+456>>2];f=(h[d>>2]=v,r[d>>2]|0);if(v>=a?(C=+h[t+448>>2],C>=a):0){g=l*u<-1.0?-1.0:l*u;g=+q(+(g>1.0?1.0:g))*2.0;if(g>1.1920928955078125e-07){a=1.0/+G(+(m*u*(m*u)+(c*u*(c*u)+p*p)));if(+W(+(p*a))>1.1920928955078125e-07){xt=+G(+((m*u*a*(m*u*a)/(p*a*(p*a))+1.0)/(1.0/(C*C)+m*u*a*(m*u*a)/(p*a*(p*a))/(v*v))));c=c*u*a;l=m*u*a;a=p*a;f=(h[d>>2]=xt,r[d>>2]|0)}else{c=c*u*a;l=m*u*a;a=p*a}}else{c=0.0;l=0.0;a=0.0;f=0}u=(r[d>>2]=f,+h[d>>2]);p=+h[t+428>>2];if(g>u*p){n[t+526>>0]=1;if(g<u&p<.9999998807907104)m=(g-u*p)/(u-u*p);else m=1.0;h[t+528>>2]=m;h[t+504>>2]=g-u*p;if(+W(+a)>1.1920928955078125e-07){xt=+W(+(a*(-l/a*(C/v))));l=l<-0.0?xt:-xt;xt=1.0/+G(+(c*c+a*a+l*l));c=c*xt;l=-(l*xt);a=a*xt}St=-c;vt=-a;bt=-l;U=(ot*ht-at*lt-ct*dt-_t*ut)*St+(at*ut+(ht*ct+ot*dt)-lt*_t)*bt-(ot*_t+ht*ut+lt*dt-at*ct)*vt;xt=(ot*_t+ht*ut+lt*dt-at*ct)*St+(ot*ht-at*lt-ct*dt-_t*ut)*vt-(ot*at+lt*ht+ct*_t-ut*dt)*bt;yt=(ot*at+lt*ht+ct*_t-ut*dt)*vt+(ot*ht-at*lt-ct*dt-_t*ut)*bt-(at*ut+(ht*ct+ot*dt)-lt*_t)*St;bt=-((ot*at+lt*ht+ct*_t-ut*dt)*St)-(at*ut+(ht*ct+ot*dt)-lt*_t)*vt-(ot*_t+ht*ut+lt*dt-at*ct)*bt;vt=xt*mt+(bt*pt+(ot*ht-at*lt-ct*dt-_t*ut)*U)-yt*ft;St=yt*pt+((ot*ht-at*lt-ct*dt-_t*ut)*xt+bt*ft)-U*mt;xt=U*ft+(bt*mt+(ot*ht-at*lt-ct*dt-_t*ut)*yt)-xt*pt;h[t+460>>2]=vt;h[t+464>>2]=St;h[t+468>>2]=xt;h[t+472>>2]=0.0;r[t+536>>2]=0;r[t+536+4>>2]=0;r[t+536+8>>2]=0;r[t+536+12>>2]=0;h[t+492>>2]=1.0/(vt*(+h[s>>2]*vt+ +h[s+16>>2]*St+ +h[s+32>>2]*xt)+St*(vt*+h[s+4>>2]+St*+h[s+20>>2]+xt*+h[s+36>>2])+xt*(vt*+h[s+8>>2]+St*+h[s+24>>2]+xt*+h[s+40>>2])+(vt*(vt*+h[o>>2]+St*+h[o+16>>2]+xt*+h[o+32>>2])+St*(vt*+h[o+4>>2]+St*+h[o+20>>2]+xt*+h[o+36>>2])+xt*(vt*+h[o+8>>2]+St*+h[o+24>>2]+xt*+h[o+40>>2])))}}else V=23;t:do{if((V|0)==23){L=+h[t+300>>2];D=+h[t+316>>2];k=+h[t+332>>2];g=+h[e>>2];v=+h[e+4>>2];S=+h[e+8>>2];x=+h[e+16>>2];w=+h[e+20>>2];C=+h[e+24>>2];O=+h[e+32>>2];F=+h[e+36>>2];T=+h[e+40>>2];A=+h[t+304>>2];E=+h[t+320>>2];M=+h[t+336>>2];R=+h[t+308>>2];I=+h[t+324>>2];P=+h[t+340>>2];u=+h[t+364>>2];c=+h[t+380>>2];B=+h[t+396>>2];N=u*+h[i>>2]+c*+h[i+4>>2]+B*+h[i+8>>2];U=u*+h[i+16>>2]+c*+h[i+20>>2]+B*+h[i+24>>2];B=u*+h[i+32>>2]+c*+h[i+36>>2]+B*+h[i+40>>2];c=(L*g+D*v+k*S)*N+(L*x+D*w+k*C)*U+(L*O+D*F+k*T)*B;u=(g*A+v*E+S*M)*N+(x*A+w*E+C*M)*U+(O*A+F*E+T*M)*B;m=(g*R+v*I+S*P)*N+(x*R+w*I+C*P)*U+(O*R+F*I+T*P)*B;l=+h[t+444>>2];a=+h[t+456>>2];do{if(l<a){p=+h[t+448>>2];if(p<a){if(+W(+u)<1.1920928955078125e-07?+W(+m)<1.1920928955078125e-07:0)break t;n[t+526>>0]=1;h[t+460>>2]=-((L*O+D*F+k*T)*U-(L*x+D*w+k*C)*B);h[t+464>>2]=-((L*g+D*v+k*S)*B-(L*O+D*F+k*T)*N);h[t+468>>2]=-((L*x+D*w+k*C)*N-(L*g+D*v+k*S)*U);h[t+472>>2]=0.0;break t}if(+W(+c)<1.1920928955078125e-07?+W(+m)<1.1920928955078125e-07:0){l=u;a=m;break}n[t+526>>0]=1;if(p>=a){a=+Q(+m,+c);if(a>p){c=+H(+p);l=0.0;a=+X(+p);break}if(a<-p){c=+H(+p);l=0.0;a=-+X(+p)}else{l=0.0;a=m}}else{l=u;a=m}}else{if(+W(+c)<1.1920928955078125e-07?+W(+u)<1.1920928955078125e-07:0){l=u;a=m;break}n[t+526>>0]=1;if(l>=a){a=+Q(+u,+c);if(a>l){c=+H(+l);l=+X(+l);a=0.0;break}if(a<-l){c=+H(+l);l=-+X(+l);a=0.0}else{l=u;a=0.0}}else{l=u;a=m}}}while(0);p=(g*R+v*I+S*P)*a+((g*A+v*E+S*M)*l+(L*g+D*v+k*S)*c);u=(x*R+w*I+C*P)*a+((x*A+w*E+C*M)*l+(L*x+D*w+k*C)*c);a=(O*R+F*I+T*P)*a+((O*A+F*E+T*M)*l+(L*O+D*F+k*T)*c);l=1.0/+G(+(a*a+(p*p+u*u)));h[t+460>>2]=-(U*(l*a)-B*(l*u));h[t+464>>2]=-(B*(l*p)-N*(l*a));h[t+468>>2]=-(N*(l*u)-U*(l*p));h[t+472>>2]=0.0;c=+G(+((U*(l*a)-B*(l*u))*(U*(l*a)-B*(l*u))+(B*(l*p)-N*(l*a))*(B*(l*p)-N*(l*a))+(N*(l*u)-U*(l*p))*(N*(l*u)-U*(l*p))));h[t+504>>2]=c;if(!(+W(+c)<1.1920928955078125e-07)){h[t+460>>2]=1.0/c*-(U*(l*a)-B*(l*u));h[t+464>>2]=1.0/c*-(B*(l*p)-N*(l*a));h[t+468>>2]=1.0/c*-(N*(l*u)-U*(l*p))}}}while(0);g=+h[t+452>>2];if(!(g>=0.0)){h[t+512>>2]=0.0;_=gt;return}a=j*z<-1.0?-1.0:j*z;a=+q(+(a>1.0?1.0:a))*2.0;if(a>3.1415927410125732){m=-(j*z)<-1.0?-1.0:-(j*z);m=+q(+(m>1.0?1.0:m))*2.0;l=-(j*Y);c=-(j*K);a=-(j*Z)}else{m=a;l=j*Y;c=j*K;a=j*Z}h[t+512>>2]=m;if(m>1.1920928955078125e-07){xt=1.0/+G(+(l*l+c*c+a*a));p=l*xt;u=a*xt;c=c*xt}else{p=l;u=a}a=+h[t+428>>2];if(m>g*a){n[t+525>>0]=1;l=m-g*a;if(m<g&a<.9999998807907104)a=l/(g-g*a);else a=1.0;h[t+532>>2]=a;h[t+508>>2]=l;St=-p;vt=-c;bt=-u;Z=(ot*ht-at*lt-ct*dt-_t*ut)*St+(at*ut+(ht*ct+ot*dt)-lt*_t)*bt-(ot*_t+ht*ut+lt*dt-at*ct)*vt;xt=(ot*_t+ht*ut+lt*dt-at*ct)*St+(ot*ht-at*lt-ct*dt-_t*ut)*vt-(ot*at+lt*ht+ct*_t-ut*dt)*bt;yt=(ot*at+lt*ht+ct*_t-ut*dt)*vt+(ot*ht-at*lt-ct*dt-_t*ut)*bt-(at*ut+(ht*ct+ot*dt)-lt*_t)*St;bt=-((ot*at+lt*ht+ct*_t-ut*dt)*St)-(at*ut+(ht*ct+ot*dt)-lt*_t)*vt-(ot*_t+ht*ut+lt*dt-at*ct)*bt;vt=xt*mt+(bt*pt+(ot*ht-at*lt-ct*dt-_t*ut)*Z)-yt*ft;St=yt*pt+((ot*ht-at*lt-ct*dt-_t*ut)*xt+bt*ft)-Z*mt;xt=Z*ft+(bt*mt+(ot*ht-at*lt-ct*dt-_t*ut)*yt)-xt*pt;h[t+476>>2]=vt;h[t+480>>2]=St;h[t+484>>2]=xt;h[t+488>>2]=0.0;h[t+496>>2]=1.0/(vt*(+h[s>>2]*vt+ +h[s+16>>2]*St+ +h[s+32>>2]*xt)+St*(vt*+h[s+4>>2]+St*+h[s+20>>2]+xt*+h[s+36>>2])+xt*(vt*+h[s+8>>2]+St*+h[s+24>>2]+xt*+h[s+40>>2])+(vt*(vt*+h[o>>2]+St*+h[o+16>>2]+xt*+h[o+32>>2])+St*(vt*+h[o+4>>2]+St*+h[o+20>>2]+xt*+h[o+36>>2])+xt*(vt*+h[o+8>>2]+St*+h[o+24>>2]+xt*+h[o+40>>2])))}if(!(n[t+526>>0]|0)){_=gt;return}mt=-p;xt=-c;bt=-u;ft=($*et-J*tt-it*rt-nt*st)*mt+(J*st+(et*it+$*rt)-tt*nt)*bt-($*nt+et*st+tt*rt-J*it)*xt;St=($*nt+et*st+tt*rt-J*it)*mt+($*et-J*tt-it*rt-nt*st)*xt-($*J+tt*et+it*nt-st*rt)*bt;vt=($*J+tt*et+it*nt-st*rt)*xt+($*et-J*tt-it*rt-nt*st)*bt-(J*st+(et*it+$*rt)-tt*nt)*mt;bt=-(($*J+tt*et+it*nt-st*rt)*mt)-(J*st+(et*it+$*rt)-tt*nt)*xt-($*nt+et*st+tt*rt-J*it)*bt;xt=-($*J+tt*et+it*nt-st*rt);mt=-(J*st+(et*it+$*rt)-tt*nt);yt=-($*nt+et*st+tt*rt-J*it);h[t+536>>2]=St*yt+(bt*xt+($*et-J*tt-it*rt-nt*st)*ft)-vt*mt;h[t+540>>2]=vt*xt+(($*et-J*tt-it*rt-nt*st)*St+bt*mt)-ft*yt;h[t+544>>2]=ft*mt+(bt*yt+($*et-J*tt-it*rt-nt*st)*vt)-St*xt;h[t+548>>2]=0.0;_=gt;return}function IE(t,e){t=t|0;e=e|0;var i=0,s=0,o=0.0,a=0,l=0;if(n[t+527>>0]|0){r[e>>2]=0;r[e+4>>2]=0;return}r[e>>2]=3;r[e+4>>2]=3;l=r[t+28>>2]|0;a=r[t+32>>2]|0;RE(t,l+4|0,a+4|0,l+288|0,a+288|0);if((n[t+526>>0]|0?(i=r[e>>2]|0,r[e>>2]=i+1,s=r[e+4>>2]|0,r[e+4>>2]=s+-1,o=+h[t+456>>2],+h[t+444>>2]<o):0)?+h[t+448>>2]<o:0){r[e>>2]=i+2;r[e+4>>2]=s+-2}if(!(n[t+525>>0]|0))return;r[e>>2]=(r[e>>2]|0)+1;r[e+4>>2]=(r[e+4>>2]|0)+-1;return}function PE(t,e){t=t|0;e=e|0;var i=0,s=0,o=0.0,a=0,l=0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0,m=0,g=0,b=0,y=0.0,v=0.0,S=0.0,x=0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0;f=r[t+28>>2]|0;a=r[t+32>>2]|0;RE(t,f+4|0,a+4|0,f+288|0,a+288|0);g=r[e+8>>2]|0;h[g>>2]=1.0;m=r[e+24>>2]|0;h[g+(m+1<<2)>>2]=1.0;h[g+((m<<1)+2<<2)>>2]=1.0;u=+h[t+348>>2];S=+h[t+352>>2];p=+h[t+356>>2];y=+h[f+4>>2]*u+ +h[f+8>>2]*S+ +h[f+12>>2]*p;d=u*+h[f+20>>2]+S*+h[f+24>>2]+p*+h[f+28>>2];p=u*+h[f+36>>2]+S*+h[f+40>>2]+p*+h[f+44>>2];g=r[e+12>>2]|0;r[g>>2]=0;h[g+4>>2]=p;h[g+8>>2]=-d;h[g+12>>2]=0.0;h[g+(m<<2)>>2]=-p;r[g+(m<<2)+4>>2]=0;h[g+(m<<2)+8>>2]=y;h[g+(m<<2)+12>>2]=0.0;h[g+(m<<1<<2)>>2]=d;h[g+(m<<1<<2)+4>>2]=-y;r[g+(m<<1<<2)+8>>2]=0;h[g+(m<<1<<2)+12>>2]=0.0;g=r[e+16>>2]|0;h[g>>2]=-1.0;h[g+(m+1<<2)>>2]=-1.0;h[g+((m<<1)+2<<2)>>2]=-1.0;S=+h[t+412>>2];u=+h[t+416>>2];_=+h[t+420>>2];v=+h[a+4>>2]*S+ +h[a+8>>2]*u+ +h[a+12>>2]*_;c=S*+h[a+20>>2]+u*+h[a+24>>2]+_*+h[a+28>>2];_=S*+h[a+36>>2]+u*+h[a+40>>2]+_*+h[a+44>>2];m=r[e+20>>2]|0;g=r[e+24>>2]|0;r[m>>2]=0;h[m+4>>2]=-_;h[m+8>>2]=c;h[m+12>>2]=0.0;h[m+(g<<2)>>2]=_;r[m+(g<<2)+4>>2]=0;h[m+(g<<2)+8>>2]=-v;h[m+(g<<2)+12>>2]=0.0;h[m+(g<<1<<2)>>2]=-c;h[m+(g<<1<<2)+4>>2]=v;r[m+(g<<1<<2)+8>>2]=0;h[m+(g<<1<<2)+12>>2]=0.0;g=r[t+592>>2]|0;u=+h[((g&2|0)==0?e+4|0:t+600|0)>>2]*+h[e>>2];b=r[e+24>>2]|0;l=r[e+28>>2]|0;s=r[e+36>>2]|0;i=r[e+40>>2]|0;h[l>>2]=u*(v+ +h[a+52>>2]-y-+h[f+52>>2]);h[s>>2]=-3402823466385288598117041.0e14;h[i>>2]=3402823466385288598117041.0e14;if(!(g&1)){h[l+(b<<2)>>2]=u*(c+ +h[a+56>>2]-d-+h[f+56>>2]);h[s+(b<<2)>>2]=-3402823466385288598117041.0e14;h[i+(b<<2)>>2]=3402823466385288598117041.0e14;h[l+(b<<1<<2)>>2]=u*(_+ +h[a+60>>2]-p-+h[f+60>>2]);h[s+(b<<1<<2)>>2]=-3402823466385288598117041.0e14;h[i+(b<<1<<2)>>2]=3402823466385288598117041.0e14}else{x=r[e+32>>2]|0;r[x>>2]=r[t+596>>2];h[l+(b<<2)>>2]=u*(c+ +h[a+56>>2]-d-+h[f+56>>2]);h[s+(b<<2)>>2]=-3402823466385288598117041.0e14;h[i+(b<<2)>>2]=3402823466385288598117041.0e14;r[x+(b<<2)>>2]=r[t+596>>2];h[l+(b<<1<<2)>>2]=u*(_+ +h[a+60>>2]-p-+h[f+60>>2]);h[s+(b<<1<<2)>>2]=-3402823466385288598117041.0e14;h[i+(b<<1<<2)>>2]=3402823466385288598117041.0e14;r[x+(b<<1<<2)>>2]=r[t+596>>2]}do{if(!(n[t+526>>0]|0))a=b*3|0;else{a=r[e+12>>2]|0;S=+h[t+456>>2];if(+h[t+444>>2]<S?+h[t+448>>2]<S:0){T=+h[f+4>>2];C=+h[f+8>>2];w=+h[f+12>>2];R=+h[t+304>>2];M=+h[t+320>>2];E=+h[t+336>>2];u=+h[t+308>>2];p=+h[t+324>>2];v=+h[t+340>>2];o=+h[f+20>>2];c=+h[f+24>>2];_=+h[f+28>>2];d=+h[f+36>>2];y=+h[f+40>>2];S=+h[f+44>>2];h[a+(b*3<<2)>>2]=T*R+C*M+w*E;h[a+((b*3|0)+1<<2)>>2]=R*o+M*c+E*_;h[a+((b*3|0)+2<<2)>>2]=R*d+M*y+E*S;h[a+(b<<2<<2)>>2]=T*u+C*p+w*v;h[a+((b<<2|1)<<2)>>2]=u*o+p*c+v*_;h[a+((b<<2|2)<<2)>>2]=u*d+p*y+v*S;h[m+(b*3<<2)>>2]=-(T*R+C*M+w*E);h[m+((b*3|0)+1<<2)>>2]=-(R*o+M*c+E*_);h[m+((b*3|0)+2<<2)>>2]=-(R*d+M*y+E*S);h[m+(b<<2<<2)>>2]=-(T*u+C*p+w*v);h[m+((b<<2|1)<<2)>>2]=-(u*o+p*c+v*_);h[m+((b<<2|2)<<2)>>2]=-(u*d+p*y+v*S);A=+h[e>>2]*+h[t+436>>2];l=r[e+28>>2]|0;h[l+(b*3<<2)>>2]=A*((T*R+C*M+w*E)*+h[t+460>>2]+(R*o+M*c+E*_)*+h[t+464>>2]+(R*d+M*y+E*S)*+h[t+468>>2]);h[l+(b<<2<<2)>>2]=A*((T*u+C*p+w*v)*+h[t+460>>2]+(u*o+p*c+v*_)*+h[t+464>>2]+(u*d+p*y+v*S)*+h[t+468>>2]);s=r[e+36>>2]|0;h[s+(b*3<<2)>>2]=-3402823466385288598117041.0e14;i=r[e+40>>2]|0;h[i+(b*3<<2)>>2]=3402823466385288598117041.0e14;h[s+(b<<2<<2)>>2]=-3402823466385288598117041.0e14;h[i+(b<<2<<2)>>2]=3402823466385288598117041.0e14;a=(r[e+24>>2]|0)+(b<<2)|0;break}R=+h[t+436>>2];E=R*(+h[t+460>>2]*R);M=R*(R*+h[t+464>>2]);R=R*(R*+h[t+468>>2]);h[a+(b*3<<2)>>2]=E;h[a+((b*3|0)+1<<2)>>2]=M;h[a+((b*3|0)+2<<2)>>2]=R;h[m+(b*3<<2)>>2]=-E;h[m+((b*3|0)+1<<2)>>2]=-M;h[m+((b*3|0)+2<<2)>>2]=-R;h[l+(b*3<<2)>>2]=+h[e>>2]*+h[t+432>>2]*+h[t+504>>2];if(g&4|0)r[(r[e+32>>2]|0)+(b*3<<2)>>2]=r[t+604>>2];h[s+(b*3<<2)>>2]=0.0;if(!((n[t+552>>0]|0)!=0?(o=+h[t+572>>2],o>=0.0):0))o=3402823466385288598117041.0e14;h[i+(b*3<<2)>>2]=o;a=b<<2}}while(0);if(!(n[t+525>>0]|0))return;R=+h[t+436>>2];E=R*(+h[t+476>>2]*R);M=R*(R*+h[t+480>>2]);R=R*(R*+h[t+484>>2]);m=r[e+12>>2]|0;b=r[e+20>>2]|0;h[m+(a<<2)>>2]=E;g=a+1|0;h[m+(g<<2)>>2]=M;x=a+2|0;h[m+(x<<2)>>2]=R;h[b+(a<<2)>>2]=-E;h[b+(g<<2)>>2]=-M;h[b+(x<<2)>>2]=-R;h[l+(a<<2)>>2]=+h[e>>2]*+h[t+432>>2]*+h[t+508>>2];if(r[t+592>>2]&4|0)r[(r[e+32>>2]|0)+(a<<2)>>2]=r[t+604>>2];if(!(+h[t+452>>2]>0.0)){h[s+(a<<2)>>2]=-3402823466385288598117041.0e14;h[i+(a<<2)>>2]=3402823466385288598117041.0e14;return}s=s+(a<<2)|0;i=r[e+40>>2]|0;if(+h[t+508>>2]>0.0){h[s>>2]=0.0;h[i+(a<<2)>>2]=3402823466385288598117041.0e14;return}else{h[s>>2]=-3402823466385288598117041.0e14;h[i+(a<<2)>>2]=0.0;return}}function LE(t,e,i,s){t=t|0;e=e|0;i=i|0;s=+s;var o=0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0,f=0.0,m=0.0,g=0,b=0,y=0,v=0.0,S=0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0,O=0,F=0,B=0,N=0,U=0,V=0,z=0.0,W=0.0,j=0.0,H=0.0,X=0.0,Y=0.0,q=0.0,K=0.0,Z=0.0,Q=0.0,$=0.0,J=0.0,tt=0.0;V=_;_=_+448|0;if(!(n[t+527>>0]|0)){_=V;return}U=r[t+28>>2]|0;w=+h[t+348>>2];x=+h[t+352>>2];R=+h[t+356>>2];C=+h[U+52>>2];T=w*+h[U+4>>2]+x*+h[U+8>>2]+R*+h[U+12>>2]+C;A=+h[U+56>>2];E=w*+h[U+20>>2]+x*+h[U+24>>2]+R*+h[U+28>>2]+A;M=+h[U+60>>2];R=w*+h[U+36>>2]+x*+h[U+40>>2]+R*+h[U+44>>2]+M;U=r[t+32>>2]|0;x=+h[t+412>>2];w=+h[t+416>>2];c=+h[t+420>>2];I=+h[U+52>>2];P=x*+h[U+4>>2]+w*+h[U+8>>2]+c*+h[U+12>>2]+I;L=+h[U+56>>2];D=x*+h[U+20>>2]+w*+h[U+24>>2]+c*+h[U+28>>2]+L;l=+h[U+60>>2];c=x*+h[U+36>>2]+w*+h[U+40>>2]+c*+h[U+44>>2]+l;if(!(n[t+524>>0]|0)){v=+h[e+192>>2]+ +h[e+80>>2];x=+h[e+196>>2]+ +h[e+84>>2];m=+h[e+200>>2]+ +h[e+88>>2];w=+h[i+192>>2]+ +h[i+80>>2];f=+h[i+196>>2]+ +h[i+84>>2];d=+h[i+200>>2]+ +h[i+88>>2];u=+h[e+176>>2]+ +h[e+64>>2]+((R-M)*x-(E-A)*m)-(+h[i+176>>2]+ +h[i+64>>2]+((c-l)*f-(D-L)*d));d=+h[e+180>>2]+ +h[e+68>>2]+((T-C)*m-(R-M)*v)-(+h[i+180>>2]+ +h[i+68>>2]+((P-I)*d-(c-l)*w));f=+h[e+184>>2]+ +h[e+72>>2]+((E-A)*v-(T-C)*x)-(+h[i+184>>2]+ +h[i+72>>2]+((D-L)*w-(P-I)*f));p=(r[e+240>>2]|0)==0;S=0;do{w=1.0/+h[t+48+(S*84|0)+80>>2];g=t+48+(S*84|0)|0;x=+h[g>>2];b=t+48+(S*84|0)+4|0;v=+h[b>>2];y=t+48+(S*84|0)+8|0;m=+h[y>>2];m=w*(((T-P)*x+(E-D)*v+(R-c)*m)*-.30000001192092896/s)-w*(u*x+d*v+f*m);h[t+36>>2]=+h[t+36>>2]+m;v=+h[y>>2];x=+h[b>>2];w=+h[g>>2];o=r[t+28>>2]|0;a=+h[o+368>>2];if(!p){j=((E-A)*v-(R-M)*x)*+h[o+320>>2]+((R-M)*w-(T-C)*v)*+h[o+324>>2]+((T-C)*x-(E-A)*w)*+h[o+328>>2];z=((E-A)*v-(R-M)*x)*+h[o+304>>2]+((R-M)*w-(T-C)*v)*+h[o+308>>2]+((T-C)*x-(E-A)*w)*+h[o+312>>2];W=((E-A)*v-(R-M)*x)*+h[o+288>>2]+((R-M)*w-(T-C)*v)*+h[o+292>>2]+((T-C)*x-(E-A)*w)*+h[o+296>>2];X=m*(x*a)*+h[e+116>>2];H=m*(v*a)*+h[e+120>>2];h[e+64>>2]=m*(w*a)*+h[e+112>>2]+ +h[e+64>>2];h[e+68>>2]=X+ +h[e+68>>2];h[e+72>>2]=H+ +h[e+72>>2];z=z*(m*+h[e+100>>2]);a=j*(m*+h[e+104>>2]);h[e+80>>2]=W*(m*+h[e+96>>2])+ +h[e+80>>2];h[e+84>>2]=z+ +h[e+84>>2];h[e+88>>2]=a+ +h[e+88>>2]}o=r[t+32>>2]|0;a=+h[o+368>>2];if(r[i+240>>2]|0){X=((D-L)*v-(c-l)*x)*+h[o+320>>2]+((c-l)*w-(P-I)*v)*+h[o+324>>2]+((P-I)*x-(D-L)*w)*+h[o+328>>2];H=((D-L)*v-(c-l)*x)*+h[o+304>>2]+((c-l)*w-(P-I)*v)*+h[o+308>>2]+((P-I)*x-(D-L)*w)*+h[o+312>>2];j=((D-L)*v-(c-l)*x)*+h[o+288>>2]+((c-l)*w-(P-I)*v)*+h[o+292>>2]+((P-I)*x-(D-L)*w)*+h[o+296>>2];z=a*+h[b>>2]*-m*+h[i+116>>2];W=a*+h[y>>2]*-m*+h[i+120>>2];h[i+64>>2]=+h[i+112>>2]*(a*+h[g>>2]*-m)+ +h[i+64>>2];h[i+68>>2]=z+ +h[i+68>>2];h[i+72>>2]=W+ +h[i+72>>2];H=H*(+h[i+100>>2]*-m);X=X*(+h[i+104>>2]*-m);h[i+80>>2]=j*(+h[i+96>>2]*-m)+ +h[i+80>>2];h[i+84>>2]=H+ +h[i+84>>2];h[i+88>>2]=X+ +h[i+88>>2]}S=S+1|0}while((S|0)!=3)}do{if(!(n[t+552>>0]|0)){a=+h[t+440>>2];if(!(a>1.1920928955078125e-07)){k=e+80|0;p=e+196|0;O=e+84|0;g=e+200|0;F=e+88|0;b=i+192|0;B=i+80|0;y=i+196|0;N=i+84|0;S=i+200|0;U=i+88|0;o=e+192|0;break}l=+h[i+192>>2]+ +h[i+80>>2]-(+h[e+192>>2]+ +h[e+80>>2]);c=+h[i+196>>2]+ +h[i+84>>2]-(+h[e+196>>2]+ +h[e+84>>2]);u=+h[i+200>>2]+ +h[i+88>>2]-(+h[e+200>>2]+ +h[e+88>>2]);if(l*l+c*c+u*u>1.1920928955078125e-07){M=1.0/+G(+(l*l+c*c+u*u));o=r[t+28>>2]|0;f=+h[o+288>>2];m=+h[o+304>>2];v=+h[o+320>>2];x=+h[o+292>>2];w=+h[o+308>>2];C=+h[o+324>>2];T=+h[o+296>>2];A=+h[o+312>>2];E=+h[o+328>>2];o=r[t+32>>2]|0;a=a*(1.0/(l*M*(f*(l*M)+c*M*m+u*M*v)+c*M*(l*M*x+c*M*w+u*M*C)+u*M*(l*M*T+c*M*A+u*M*E)+(l*M*(l*M*+h[o+288>>2]+c*M*+h[o+304>>2]+u*M*+h[o+320>>2])+c*M*(l*M*+h[o+292>>2]+c*M*+h[o+308>>2]+u*M*+h[o+324>>2])+u*M*(l*M*+h[o+296>>2]+c*M*+h[o+312>>2]+u*M*+h[o+328>>2]))));M=+G(+(u*a*(u*a)+(l*a*(l*a)+c*a*(c*a))));d=1.0/M*(l*a);l=1.0/M*(c*a);a=1.0/M*(u*a);if(r[e+240>>2]|0){X=M*0.0*+h[e+116>>2];H=M*0.0*+h[e+120>>2];h[e+64>>2]=M*0.0*+h[e+112>>2]+ +h[e+64>>2];h[e+68>>2]=X+ +h[e+68>>2];h[e+72>>2]=H+ +h[e+72>>2];H=(d*m+l*w+a*A)*(M*+h[e+100>>2]);X=(d*v+l*C+a*E)*(M*+h[e+104>>2]);h[e+80>>2]=(d*f+l*x+a*T)*(M*+h[e+96>>2])+ +h[e+80>>2];h[e+84>>2]=H+ +h[e+84>>2];h[e+88>>2]=X+ +h[e+88>>2];o=r[t+32>>2]|0}if(r[i+240>>2]|0){X=d*+h[o+320>>2]+l*+h[o+324>>2]+a*+h[o+328>>2];H=d*+h[o+304>>2]+l*+h[o+308>>2]+a*+h[o+312>>2];j=d*+h[o+288>>2]+l*+h[o+292>>2]+a*+h[o+296>>2];z=M*-0.0*+h[i+116>>2];W=M*-0.0*+h[i+120>>2];h[i+64>>2]=M*-0.0*+h[i+112>>2]+ +h[i+64>>2];h[i+68>>2]=z+ +h[i+68>>2];h[i+72>>2]=W+ +h[i+72>>2];H=H*(+h[i+100>>2]*-M);X=X*(+h[i+104>>2]*-M);h[i+80>>2]=j*(+h[i+96>>2]*-M)+ +h[i+80>>2];h[i+84>>2]=H+ +h[i+84>>2];h[i+88>>2]=X+ +h[i+88>>2];k=e+80|0;p=e+196|0;O=e+84|0;g=e+200|0;F=e+88|0;b=i+192|0;B=i+80|0;y=i+196|0;N=i+84|0;S=i+200|0;U=i+88|0;o=e+192|0}else{k=e+80|0;p=e+196|0;O=e+84|0;g=e+200|0;F=e+88|0;b=i+192|0;B=i+80|0;y=i+196|0;N=i+84|0;S=i+200|0;U=i+88|0;o=e+192|0}}else{k=e+80|0;p=e+196|0;O=e+84|0;g=e+200|0;F=e+88|0;b=i+192|0;B=i+80|0;y=i+196|0;N=i+84|0;S=i+200|0;U=i+88|0;o=e+192|0}}else{N=r[t+28>>2]|0;r[V+352>>2]=r[N+4>>2];r[V+352+4>>2]=r[N+4+4>>2];r[V+352+8>>2]=r[N+4+8>>2];r[V+352+12>>2]=r[N+4+12>>2];r[V+352+16>>2]=r[N+20>>2];r[V+352+16+4>>2]=r[N+20+4>>2];r[V+352+16+8>>2]=r[N+20+8>>2];r[V+352+16+12>>2]=r[N+20+12>>2];r[V+352+32>>2]=r[N+36>>2];r[V+352+32+4>>2]=r[N+36+4>>2];r[V+352+32+8>>2]=r[N+36+8>>2];r[V+352+32+12>>2]=r[N+36+12>>2];r[V+352+48>>2]=r[N+52>>2];r[V+352+48+4>>2]=r[N+52+4>>2];r[V+352+48+8>>2]=r[N+52+8>>2];r[V+352+48+12>>2]=r[N+52+12>>2];N=r[t+32>>2]|0;r[V+288>>2]=r[N+4>>2];r[V+288+4>>2]=r[N+4+4>>2];r[V+288+8>>2]=r[N+4+8>>2];r[V+288+12>>2]=r[N+4+12>>2];r[V+288+16>>2]=r[N+20>>2];r[V+288+16+4>>2]=r[N+20+4>>2];r[V+288+16+8>>2]=r[N+20+8>>2];r[V+288+16+12>>2]=r[N+20+12>>2];r[V+288+32>>2]=r[N+36>>2];r[V+288+32+4>>2]=r[N+36+4>>2];r[V+288+32+8>>2]=r[N+36+8>>2];r[V+288+32+12>>2]=r[N+36+12>>2];r[V+288+48>>2]=r[N+52>>2];r[V+288+48+4>>2]=r[N+52+4>>2];r[V+288+48+8>>2]=r[N+52+8>>2];r[V+288+48+12>>2]=r[N+52+12>>2];j=+h[e+196>>2]+ +h[e+84>>2];v=+h[e+200>>2]+ +h[e+88>>2];h[V+272>>2]=+h[e+192>>2]+ +h[e+80>>2];h[V+272+4>>2]=j;h[V+272+8>>2]=v;h[V+272+12>>2]=0.0;v=+h[i+196>>2]+ +h[i+84>>2];j=+h[i+200>>2]+ +h[i+88>>2];h[V+256>>2]=+h[i+192>>2]+ +h[i+80>>2];h[V+256+4>>2]=v;h[V+256+8>>2]=j;h[V+256+12>>2]=0.0;r[V+192>>2]=1065353216;N=V+192+4|0;r[N>>2]=0;r[N+4>>2]=0;r[N+8>>2]=0;r[N+12>>2]=0;r[V+192+20>>2]=1065353216;U=V+192+24|0;r[U>>2]=0;r[U+4>>2]=0;r[U+8>>2]=0;r[U+12>>2]=0;r[V+192+40>>2]=1065353216;F=V+192+44|0;r[F>>2]=0;r[F+4>>2]=0;r[F+8>>2]=0;r[F+12>>2]=0;r[F+16>>2]=0;Vv(V+352|0,0.0,0.0,0.0,V+272|0,s,V+192|0);r[V+128>>2]=1065353216;F=V+128+4|0;r[F>>2]=0;r[F+4>>2]=0;r[F+8>>2]=0;r[F+12>>2]=0;r[V+128+20>>2]=1065353216;B=V+128+24|0;r[B>>2]=0;r[B+4>>2]=0;r[B+8>>2]=0;r[B+12>>2]=0;r[V+128+40>>2]=1065353216;O=V+128+44|0;r[O>>2]=0;r[O+4>>2]=0;r[O+8>>2]=0;r[O+12>>2]=0;r[O+16>>2]=0;Vv(V+288|0,0.0,0.0,0.0,V+256|0,s,V+128|0);j=+h[t+556>>2];v=+h[t+560>>2];H=+h[t+564>>2];x=+h[t+568>>2];P=j*(2.0/(j*j+v*v+H*H+x*x));A=v*(2.0/(j*j+v*v+H*H+x*x));L=H*(2.0/(j*j+v*v+H*H+x*x));q=+h[t+364>>2];Y=+h[t+368>>2];Q=+h[t+372>>2];l=Q*(j*L-x*A)+(Y*(j*A+x*L)+q*(1.0-(v*A+H*L)));c=Q*(v*L+x*P)+(q*(j*A-x*L)+Y*(1.0-(j*P+H*L)));u=q*(j*L+x*A)+Y*(v*L-x*P)+Q*(1.0-(j*P+v*A));a=+h[t+380>>2];I=+h[t+384>>2];E=+h[t+388>>2];d=(j*L-x*A)*E+(I*(j*A+x*L)+a*(1.0-(v*A+H*L)));f=(v*L+x*P)*E+(a*(j*A-x*L)+I*(1.0-(j*P+H*L)));m=a*(j*L+x*A)+I*(v*L-x*P)+E*(1.0-(j*P+v*A));z=+h[t+396>>2];M=+h[t+400>>2];T=+h[t+404>>2];W=(1.0-(v*A+H*L))*z+(j*A+x*L)*M+(j*L-x*A)*T;H=(j*A-x*L)*z+(1.0-(j*P+H*L))*M+(v*L+x*P)*T;A=(j*L+x*A)*z+(v*L-x*P)*M+(1.0-(j*P+v*A))*T;v=+h[t+300>>2];P=+h[t+316>>2];j=+h[t+332>>2];x=+h[t+304>>2];L=+h[t+320>>2];X=+h[t+336>>2];R=+h[t+308>>2];D=+h[t+324>>2];C=+h[t+340>>2];w=-+h[t+348>>2];tt=-+h[t+352>>2];Z=-+h[t+356>>2];Q=q*0.0+Y*0.0+Q*0.0+ +h[t+412>>2]+(u*(R*w+D*tt+C*Z)+(l*(v*w+P*tt+j*Z)+c*(x*w+L*tt+X*Z)));E=a*0.0+I*0.0+E*0.0+ +h[t+416>>2]+(m*(R*w+D*tt+C*Z)+(d*(v*w+P*tt+j*Z)+f*(x*w+L*tt+X*Z)));Z=z*0.0+M*0.0+T*0.0+ +h[t+420>>2]+(A*(R*w+D*tt+C*Z)+(W*(v*w+P*tt+j*Z)+H*(x*w+L*tt+X*Z)));tt=+h[V+128>>2];w=+h[F>>2];T=+h[V+128+8>>2];M=+h[V+128+16>>2];z=+h[V+128+20>>2];I=+h[B>>2];a=+h[V+128+32>>2];Y=+h[V+128+36>>2];q=+h[V+128+40>>2];K=T*Z+(tt*Q+w*E)+ +h[V+128+48>>2];$=M*Q+E*z+Z*I+ +h[V+128+52>>2];J=Q*a+E*Y+Z*q+ +h[V+128+56>>2];h[V+64>>2]=(l*v+c*x+u*R)*tt+(d*v+f*x+m*R)*w+(W*v+H*x+A*R)*T;h[V+64+4>>2]=(l*P+c*L+u*D)*tt+(d*P+f*L+m*D)*w+(W*P+H*L+A*D)*T;h[V+64+8>>2]=(l*j+c*X+u*C)*tt+(d*j+f*X+m*C)*w+(W*j+H*X+A*C)*T;h[V+64+12>>2]=0.0;h[V+64+16>>2]=(l*v+c*x+u*R)*M+(d*v+f*x+m*R)*z+(W*v+H*x+A*R)*I;h[V+64+20>>2]=(l*P+c*L+u*D)*M+(d*P+f*L+m*D)*z+(W*P+H*L+A*D)*I;h[V+64+24>>2]=(l*j+c*X+u*C)*M+(d*j+f*X+m*C)*z+(W*j+H*X+A*C)*I;h[V+64+28>>2]=0.0;h[V+64+32>>2]=(l*v+c*x+u*R)*a+(d*v+f*x+m*R)*Y+(W*v+H*x+A*R)*q;h[V+64+36>>2]=(l*P+c*L+u*D)*a+(d*P+f*L+m*D)*Y+(W*P+H*L+A*D)*q;h[V+64+40>>2]=(l*j+c*X+u*C)*a+(d*j+f*X+m*C)*Y+(W*j+H*X+A*C)*q;h[V+64+44>>2]=0.0;h[V+64+48>>2]=K;h[V+64+52>>2]=$;h[V+64+56>>2]=J;h[V+64+60>>2]=0.0;J=(W*v+H*x+A*R)*-Z+((l*v+c*x+u*R)*-Q+(d*v+f*x+m*R)*-E);$=(W*P+H*L+A*D)*-Z+((l*P+c*L+u*D)*-Q+(d*P+f*L+m*D)*-E);E=(W*j+H*X+A*C)*-Z+((l*j+c*X+u*C)*-Q+(d*j+f*X+m*C)*-E);Q=+h[V+192>>2];Z=+h[N>>2];K=+h[V+192+8>>2];q=+h[V+192+16>>2];Y=+h[V+192+20>>2];a=+h[U>>2];I=+h[V+192+32>>2];z=+h[V+192+36>>2];M=+h[V+192+40>>2];T=J*Q+$*Z+E*K+ +h[V+192+48>>2];w=J*q+$*Y+E*a+ +h[V+192+52>>2];E=J*I+$*z+E*M+ +h[V+192+56>>2];h[V>>2]=(l*v+c*x+u*R)*Q+(l*P+c*L+u*D)*Z+(l*j+c*X+u*C)*K;h[V+4>>2]=(d*v+f*x+m*R)*Q+(d*P+f*L+m*D)*Z+(d*j+f*X+m*C)*K;h[V+8>>2]=(W*v+H*x+A*R)*Q+(W*P+H*L+A*D)*Z+(W*j+H*X+A*C)*K;h[V+12>>2]=0.0;h[V+16>>2]=(l*v+c*x+u*R)*q+(l*P+c*L+u*D)*Y+(l*j+c*X+u*C)*a;h[V+20>>2]=(d*v+f*x+m*R)*q+(d*P+f*L+m*D)*Y+(d*j+f*X+m*C)*a;h[V+24>>2]=(W*v+H*x+A*R)*q+(W*P+H*L+A*D)*Y+(W*j+H*X+A*C)*a;h[V+28>>2]=0.0;h[V+32>>2]=(l*v+c*x+u*R)*I+(l*P+c*L+u*D)*z+(l*j+c*X+u*C)*M;h[V+36>>2]=(d*v+f*x+m*R)*I+(d*P+f*L+m*D)*z+(d*j+f*X+m*C)*M;h[V+40>>2]=(W*v+H*x+A*R)*I+(W*P+H*L+A*D)*z+(W*j+H*X+A*C)*M;h[V+44>>2]=0.0;h[V+48>>2]=T;h[V+52>>2]=w;h[V+56>>2]=E;h[V+60>>2]=0.0;qx(V+352|0,V+64|0,V+424|0,V+416|0);E=+h[V+416>>2];w=1.0/s*(+h[V+424>>2]*E);T=1.0/s*(E*+h[V+424+4>>2]);E=1.0/s*(E*+h[V+424+8>>2]);qx(V+288|0,V,V+424|0,V+416|0);M=+h[V+416>>2];w=w-+h[V+272>>2];T=T-+h[V+272+4>>2];E=E-+h[V+272+8>>2];C=1.0/s*(+h[V+424>>2]*M)-+h[V+256>>2];A=1.0/s*(M*+h[V+424+4>>2])-+h[V+256+4>>2];M=1.0/s*(M*+h[V+424+8>>2])-+h[V+256+8>>2];if(w*w+T*T+E*E>1.1920928955078125e-07){m=1.0/+G(+(w*w+T*T+E*E));U=r[t+28>>2]|0;a=w*m;c=T*m;d=E*m;m=w*m*(+h[U+288>>2]*(w*m)+T*m*+h[U+304>>2]+E*m*+h[U+320>>2])+T*m*(w*m*+h[U+292>>2]+T*m*+h[U+308>>2]+E*m*+h[U+324>>2])+E*m*(w*m*+h[U+296>>2]+T*m*+h[U+312>>2]+E*m*+h[U+328>>2])}else{a=0.0;c=0.0;d=0.0;m=0.0}if(C*C+A*A+M*M>1.1920928955078125e-07){v=1.0/+G(+(C*C+A*A+M*M));U=r[t+32>>2]|0;l=C*v;u=A*v;f=M*v;v=C*v*(+h[U+288>>2]*(C*v)+A*v*+h[U+304>>2]+M*v*+h[U+320>>2])+A*v*(C*v*+h[U+292>>2]+A*v*+h[U+308>>2]+M*v*+h[U+324>>2])+M*v*(C*v*+h[U+296>>2]+A*v*+h[U+312>>2]+M*v*+h[U+328>>2])}else{l=0.0;u=0.0;f=0.0;v=0.0}x=m*a+v*l;l=m*c+v*u;a=m*d+v*f;if(x*x+l*l+a*a>1.1920928955078125e-07){d=1.0/+G(+(x*x+l*l+a*a));p=r[t+28>>2]|0;c=x*d*(+h[p+288>>2]*(x*d)+l*d*+h[p+304>>2]+a*d*+h[p+320>>2])+l*d*(x*d*+h[p+292>>2]+l*d*+h[p+308>>2]+a*d*+h[p+324>>2])+a*d*(x*d*+h[p+296>>2]+l*d*+h[p+312>>2]+a*d*+h[p+328>>2]);o=r[t+32>>2]|0;d=x*d*(x*d*+h[o+288>>2]+l*d*+h[o+304>>2]+a*d*+h[o+320>>2])+l*d*(x*d*+h[o+292>>2]+l*d*+h[o+308>>2]+a*d*+h[o+324>>2])+a*d*(x*d*+h[o+296>>2]+l*d*+h[o+312>>2]+a*d*+h[o+328>>2]);l=(w*c-C*d)*(1.0/((c+d)*(c+d)));v=(T*c-A*d)*(1.0/((c+d)*(c+d)));d=(E*c-M*d)*(1.0/((c+d)*(c+d)));a=+h[t+572>>2];if(!(a>=0.0))a=v;else{c=(n[t+553>>0]|0)==0?a:a/c;u=+h[t+576>>2];f=+h[t+580>>2];m=+h[t+584>>2];a=+G(+((l+u)*(l+u)+(v+f)*(v+f)+(d+m)*(d+m)));if(a>c){l=c*((l+u)*(1.0/a))-u;d=c*((d+m)*(1.0/a))-m;a=c*((v+f)*(1.0/a))-f}else a=v;h[t+576>>2]=l+u;h[t+580>>2]=a+f;h[t+584>>2]=d+m}u=+G(+(l*l+a*a+d*d));c=l*(1.0/u);l=a*(1.0/u);a=d*(1.0/u);if(r[e+240>>2]|0){tt=c*+h[p+320>>2]+l*+h[p+324>>2]+a*+h[p+328>>2];J=c*+h[p+304>>2]+l*+h[p+308>>2]+a*+h[p+312>>2];$=c*+h[p+288>>2]+l*+h[p+292>>2]+a*+h[p+296>>2];Z=u*0.0*+h[e+116>>2];Q=u*0.0*+h[e+120>>2];h[e+64>>2]=u*0.0*+h[e+112>>2]+ +h[e+64>>2];h[e+68>>2]=Z+ +h[e+68>>2];h[e+72>>2]=Q+ +h[e+72>>2];J=J*(u*+h[e+100>>2]);tt=tt*(u*+h[e+104>>2]);h[e+80>>2]=$*(u*+h[e+96>>2])+ +h[e+80>>2];h[e+84>>2]=J+ +h[e+84>>2];h[e+88>>2]=tt+ +h[e+88>>2];o=r[t+32>>2]|0}if(r[i+240>>2]|0){tt=c*+h[o+320>>2]+l*+h[o+324>>2]+a*+h[o+328>>2];J=c*+h[o+304>>2]+l*+h[o+308>>2]+a*+h[o+312>>2];$=c*+h[o+288>>2]+l*+h[o+292>>2]+a*+h[o+296>>2];Z=u*-0.0*+h[i+116>>2];Q=u*-0.0*+h[i+120>>2];h[i+64>>2]=u*-0.0*+h[i+112>>2]+ +h[i+64>>2];h[i+68>>2]=Z+ +h[i+68>>2];h[i+72>>2]=Q+ +h[i+72>>2];J=J*(+h[i+100>>2]*-u);tt=tt*(+h[i+104>>2]*-u);h[i+80>>2]=$*(+h[i+96>>2]*-u)+ +h[i+80>>2];h[i+84>>2]=J+ +h[i+84>>2];h[i+88>>2]=tt+ +h[i+88>>2]}}k=e+80|0;p=e+196|0;O=e+84|0;g=e+200|0;F=e+88|0;b=i+192|0;B=i+80|0;y=i+196|0;N=i+84|0;S=i+200|0;U=i+88|0;o=e+192|0}}while(0);T=+h[o>>2]+ +h[k>>2];C=+h[p>>2]+ +h[O>>2];w=+h[g>>2]+ +h[F>>2];x=+h[b>>2]+ +h[B>>2];v=+h[y>>2]+ +h[N>>2];m=+h[S>>2]+ +h[U>>2];if(n[t+526>>0]|0){l=+h[t+528>>2];a=l*+h[t+504>>2]*+h[t+432>>2]/s;c=+h[t+460>>2];u=+h[t+464>>2];d=+h[t+468>>2];if((x-T)*c+(v-C)*u+(m-w)*d>0.0)a=a+l*((x-T)*c+(v-C)*u+(m-w)*d)*+h[t+436>>2];J=+h[t+516>>2];$=J+a*+h[t+492>>2];$=$>0.0?$:0.0;h[t+516>>2]=$;Q=+h[t+536>>2];l=+h[t+540>>2];tt=+h[t+544>>2];a=c*($-J)*Q+u*($-J)*l+($-J)*d*tt;f=+G(+((($-J)*d-tt*a)*(($-J)*d-tt*a)+((c*($-J)-Q*a)*(c*($-J)-Q*a)+(u*($-J)-l*a)*(u*($-J)-l*a))));c=1.0/f*(c*($-J)-Q*a);l=1.0/f*(u*($-J)-l*a);a=1.0/f*(($-J)*d-tt*a);o=r[t+28>>2]|0;if(r[e+240>>2]|0){tt=c*+h[o+320>>2]+l*+h[o+324>>2]+a*+h[o+328>>2];J=c*+h[o+304>>2]+l*+h[o+308>>2]+a*+h[o+312>>2];$=c*+h[o+288>>2]+l*+h[o+292>>2]+a*+h[o+296>>2];Z=f*0.0*+h[e+116>>2];Q=f*0.0*+h[e+120>>2];h[e+64>>2]=f*0.0*+h[e+112>>2]+ +h[e+64>>2];h[e+68>>2]=Z+ +h[e+68>>2];h[e+72>>2]=Q+ +h[e+72>>2];J=J*(f*+h[e+100>>2]);tt=tt*(f*+h[e+104>>2]);h[k>>2]=$*(f*+h[e+96>>2])+ +h[k>>2];h[O>>2]=J+ +h[O>>2];h[F>>2]=tt+ +h[F>>2]}o=r[t+32>>2]|0;if(r[i+240>>2]|0){tt=c*+h[o+320>>2]+l*+h[o+324>>2]+a*+h[o+328>>2];J=c*+h[o+304>>2]+l*+h[o+308>>2]+a*+h[o+312>>2];$=c*+h[o+288>>2]+l*+h[o+292>>2]+a*+h[o+296>>2];Z=f*-0.0*+h[i+116>>2];Q=f*-0.0*+h[i+120>>2];h[i+64>>2]=f*-0.0*+h[i+112>>2]+ +h[i+64>>2];h[i+68>>2]=Z+ +h[i+68>>2];h[i+72>>2]=Q+ +h[i+72>>2];J=J*(+h[i+100>>2]*-f);tt=tt*(+h[i+104>>2]*-f);h[B>>2]=$*(+h[i+96>>2]*-f)+ +h[B>>2];h[N>>2]=J+ +h[N>>2];h[U>>2]=tt+ +h[U>>2]}}if(!(n[t+525>>0]|0)){_=V;return}d=+h[t+532>>2];u=d*+h[t+508>>2]*+h[t+432>>2]/s;c=+h[t+476>>2];l=+h[t+480>>2];a=+h[t+484>>2];if((x-T)*c+(v-C)*l+(m-w)*a>0.0)u=u+d*((x-T)*c+(v-C)*l+(m-w)*a)*+h[t+436>>2];d=+h[t+520>>2];u=d+u*+h[t+496>>2];u=u>0.0?u:0.0;h[t+520>>2]=u;o=r[t+28>>2]|0;if(r[e+240>>2]|0){tt=c*+h[o+320>>2]+l*+h[o+324>>2]+a*+h[o+328>>2];J=c*+h[o+304>>2]+l*+h[o+308>>2]+a*+h[o+312>>2];a=c*+h[o+288>>2]+l*+h[o+292>>2]+a*+h[o+296>>2];c=(u-d)*0.0*+h[e+116>>2];l=(u-d)*0.0*+h[e+120>>2];h[e+64>>2]=(u-d)*0.0*+h[e+112>>2]+ +h[e+64>>2];h[e+68>>2]=c+ +h[e+68>>2];h[e+72>>2]=l+ +h[e+72>>2];l=J*((u-d)*+h[e+100>>2]);c=tt*((u-d)*+h[e+104>>2]);h[k>>2]=a*((u-d)*+h[e+96>>2])+ +h[k>>2];h[O>>2]=l+ +h[O>>2];h[F>>2]=c+ +h[F>>2];c=+h[t+476>>2];l=+h[t+480>>2];a=+h[t+484>>2]}o=r[t+32>>2]|0;if(!(r[i+240>>2]|0)){_=V;return}tt=c*+h[o+320>>2]+l*+h[o+324>>2]+a*+h[o+328>>2];J=c*+h[o+304>>2]+l*+h[o+308>>2]+a*+h[o+312>>2];$=c*+h[o+288>>2]+l*+h[o+292>>2]+a*+h[o+296>>2];Z=(u-d)*-0.0*+h[i+116>>2];Q=(u-d)*-0.0*+h[i+120>>2];h[i+64>>2]=(u-d)*-0.0*+h[i+112>>2]+ +h[i+64>>2];h[i+68>>2]=Z+ +h[i+68>>2];h[i+72>>2]=Q+ +h[i+72>>2];J=J*(+h[i+100>>2]*-(u-d));tt=tt*(+h[i+104>>2]*-(u-d));h[B>>2]=$*(+h[i+96>>2]*-(u-d))+ +h[B>>2];h[N>>2]=J+ +h[N>>2];h[U>>2]=tt+ +h[U>>2];_=V;return}function DE(t,e,i,n){t=t|0;e=e|0;i=+i;n=n|0;switch(e|0){case 2:case 1:if(n>>>0<3){h[t+600>>2]=i;r[t+592>>2]=r[t+592>>2]|2;return}else{h[t+432>>2]=i;return}case 4:case 3:if(n>>>0<3){h[t+596>>2]=i;r[t+592>>2]=r[t+592>>2]|1;return}else{h[t+604>>2]=i;r[t+592>>2]=r[t+592>>2]|4;return}default:return}}function kE(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0;t:do{switch(e|0){case 2:case 1:{if(i>>>0<3){n=+h[t+600>>2];break t}if((i+-3|0)>>>0<3)n=+h[t+432>>2];else n=0.0;break}case 4:case 3:{if(i>>>0<3){n=+h[t+596>>2];break t}if((i+-3|0)>>>0<3)n=+h[t+604>>2];else n=0.0;break}default:n=0.0}}while(0);return+n}function OE(t){t=t|0;return 212}function FE(t,e,i){t=t|0;e=e|0;i=i|0;Ub(t,e,i)|0;r[e+52>>2]=r[t+300>>2];r[e+56>>2]=r[t+304>>2];r[e+60>>2]=r[t+308>>2];r[e+64>>2]=r[t+312>>2];r[e+68>>2]=r[t+316>>2];r[e+72>>2]=r[t+320>>2];r[e+76>>2]=r[t+324>>2];r[e+80>>2]=r[t+328>>2];r[e+84>>2]=r[t+332>>2];r[e+88>>2]=r[t+336>>2];r[e+92>>2]=r[t+340>>2];r[e+96>>2]=r[t+344>>2];r[e+100>>2]=r[t+348>>2];r[e+104>>2]=r[t+352>>2];r[e+108>>2]=r[t+356>>2];r[e+112>>2]=r[t+360>>2];r[e+116>>2]=r[t+364>>2];r[e+120>>2]=r[t+368>>2];r[e+124>>2]=r[t+372>>2];r[e+128>>2]=r[t+376>>2];r[e+132>>2]=r[t+380>>2];r[e+136>>2]=r[t+384>>2];r[e+140>>2]=r[t+388>>2];r[e+144>>2]=r[t+392>>2];r[e+148>>2]=r[t+396>>2];r[e+152>>2]=r[t+400>>2];r[e+156>>2]=r[t+404>>2];r[e+160>>2]=r[t+408>>2];r[e+164>>2]=r[t+412>>2];r[e+168>>2]=r[t+416>>2];r[e+172>>2]=r[t+420>>2];r[e+176>>2]=r[t+424>>2];r[e+180>>2]=r[t+444>>2];r[e+184>>2]=r[t+448>>2];r[e+188>>2]=r[t+452>>2];r[e+192>>2]=r[t+428>>2];r[e+196>>2]=r[t+432>>2];r[e+200>>2]=r[t+436>>2];r[e+204>>2]=r[t+440>>2];return 15142}function BE(t,e,i){t=t|0;e=e|0;i=i|0;r[t+300>>2]=r[e>>2];r[t+300+4>>2]=r[e+4>>2];r[t+300+8>>2]=r[e+8>>2];r[t+300+12>>2]=r[e+12>>2];r[t+316>>2]=r[e+16>>2];r[t+316+4>>2]=r[e+16+4>>2];r[t+316+8>>2]=r[e+16+8>>2];r[t+316+12>>2]=r[e+16+12>>2];r[t+332>>2]=r[e+32>>2];r[t+332+4>>2]=r[e+32+4>>2];r[t+332+8>>2]=r[e+32+8>>2];r[t+332+12>>2]=r[e+32+12>>2];r[t+348>>2]=r[e+48>>2];r[t+348+4>>2]=r[e+48+4>>2];r[t+348+8>>2]=r[e+48+8>>2];r[t+348+12>>2]=r[e+48+12>>2];r[t+364>>2]=r[i>>2];r[t+364+4>>2]=r[i+4>>2];r[t+364+8>>2]=r[i+8>>2];r[t+364+12>>2]=r[i+12>>2];r[t+380>>2]=r[i+16>>2];r[t+380+4>>2]=r[i+16+4>>2];r[t+380+8>>2]=r[i+16+8>>2];r[t+380+12>>2]=r[i+16+12>>2];r[t+396>>2]=r[i+32>>2];r[t+396+4>>2]=r[i+32+4>>2];r[t+396+8>>2]=r[i+32+8>>2];r[t+396+12>>2]=r[i+32+12>>2];r[t+412>>2]=r[i+48>>2];r[t+412+4>>2]=r[i+48+4>>2];r[t+412+8>>2]=r[i+48+8>>2];r[t+412+12>>2]=r[i+48+12>>2];ok[r[(r[t>>2]|0)+8>>2]&255](t);return}function NE(){r[5310]=1065353216;r[5311]=0;r[5312]=0;h[5313]=0.0;return}function UE(t,e,i,n){t=t|0;e=e|0;i=+i;n=+n;var s=0,o=0.0,a=0.0,l=0.0,c=0,_=0.0,u=0.0,p=0.0;l=+H(+i);a=+X(+i);s=r[e+444>>2]|0;c=+W(+l)>1.1920928955078125e-07;i=(r[d>>2]=s,+h[d>>2]);if(c){_=+h[e+448>>2];_=+G(+((a*a/(l*l)+1.0)/(1.0/(_*_)+a*a/(l*l)/(i*i))));i=a*a;o=l*l;s=(h[d>>2]=_,r[d>>2]|0)}else{i=a*a;o=l*l}_=+G(+(o+0.0+i));u=(r[d>>2]=s,+h[d>>2])*.5;_=+X(+u)/_;u=+H(+u);p=u*n+l*_*0.0-a*_*-0.0;o=u*0.0-a*_*n-_*0.0*0.0;i=u*0.0+_*0.0*0.0-l*_*n;n=-(_*0.0*n)-l*_*0.0-a*_*-0.0;h[t>>2]=a*_*o+(u*p+n*-(_*0.0))-i*-(l*_);h[t+4>>2]=i*-(_*0.0)+(u*o+n*-(l*_))-a*_*p;h[t+8>>2]=p*-(l*_)+(a*_*n+u*i)-o*-(_*0.0);h[t+12>>2]=0.0;return}function VE(t,e){t=t|0;e=e|0;var i=0.0,n=0,s=0.0,o=0,a=0.0,l=0.0,c=0.0,_=0.0,u=0,p=0,f=0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0,x=0,w=0.0,C=0,T=0.0,A=0.0,E=0.0,M=0.0;r[t+556>>2]=r[e>>2];r[t+556+4>>2]=r[e+4>>2];r[t+556+8>>2]=r[e+8>>2];r[t+556+12>>2]=r[e+12>>2];b=+h[t+568>>2];l=+h[5310];y=+h[t+560>>2];s=+h[5312];m=+h[t+564>>2];a=+h[5311];g=+h[t+556>>2];c=(l*m+b*a-s*g)*-m+(b*(b*l+y*s-m*a)+(-(l*g)-y*a-s*m)*-g)-(b*s+a*g-l*y)*-y;_=(b*s+a*g-l*y)*-g+(b*(l*m+b*a-s*g)+(-(l*g)-y*a-s*m)*-y)-(b*l+y*s-m*a)*-m;i=(b*l+y*s-m*a)*-y+((-(l*g)-y*a-s*m)*-m+b*(b*s+a*g-l*y))-(l*m+b*a-s*g)*-g;do{if(s*i+(a*_+l*c)<-.9999998807907104)if(+W(+s)>.7071067690849304){i=1.0/+G(+(s*s+a*a));n=0;s=-(s*i);e=(h[d>>2]=a*i,r[d>>2]|0);i=0.0;break}else{s=1.0/+G(+(l*l+a*a));n=(h[d>>2]=-(a*s),r[d>>2]|0);s=l*s;e=0;i=0.0;break}else{M=+G(+((s*i+(a*_+l*c)+1.0)*2.0));n=(h[d>>2]=(a*i-s*_)*(1.0/M),r[d>>2]|0);s=(s*c-l*i)*(1.0/M);e=(h[d>>2]=(l*_-a*c)*(1.0/M),r[d>>2]|0);i=M*.5}}while(0);l=(r[d>>2]=n,+h[d>>2]);_=(r[d>>2]=e,+h[d>>2]);v=1.0/+G(+(i*i+(l*l+s*s+_*_)));p=(h[d>>2]=l*v,r[d>>2]|0);w=s*v;x=(h[d>>2]=_*v,r[d>>2]|0);i=i*v;S=(h[d>>2]=i,r[d>>2]|0);A=g*i+b*-(l*v)+m*-w-y*-(_*v);E=g*-(_*v)+(b*-w+i*y)-m*-(l*v);M=b*-(_*v)+i*m+y*-(l*v)-g*-w;m=i*b-g*-(l*v)-y*-w-m*-(_*v);g=1.0/+G(+(m*m+(M*M+(A*A+E*E))));o=(h[d>>2]=A*g,r[d>>2]|0);e=(h[d>>2]=g*E,r[d>>2]|0);n=(h[d>>2]=g*M,r[d>>2]|0);s=+h[t+444>>2];u=(h[d>>2]=s,r[d>>2]|0);if(s>=.05000000074505806?(T=+h[t+448>>2],T>=.05000000074505806):0){i=i<-1.0?-1.0:i;i=+q(+(i>1.0?1.0:i))*2.0;if(i>1.1920928955078125e-07){a=1.0/+G(+(_*v*(_*v)+(l*v*(l*v)+w*w)));if(+W(+(w*a))>1.1920928955078125e-07){T=+G(+((_*v*a*(_*v*a)/(w*a*(w*a))+1.0)/(1.0/(T*T)+_*v*a*(_*v*a)/(w*a*(w*a))/(s*s))));l=l*v*a;c=w*a;a=_*v*a;u=(h[d>>2]=T,r[d>>2]|0)}else{l=l*v*a;c=w*a;a=_*v*a}}else{l=0.0;c=0.0;a=0.0;u=0}if(+W(+i)>1.1920928955078125e-07){s=(r[d>>2]=u,+h[d>>2]);if(!(i>s)){if(i<-s)i=-s}else i=s;T=i*.5;w=+X(+T)/+G(+(l*l+c*c+a*a));T=+H(+T);C=(h[d>>2]=l*w,r[d>>2]|0);x=(h[d>>2]=a*w,r[d>>2]|0);w=c*w;S=(h[d>>2]=T,r[d>>2]|0)}else C=p}else C=p;i=+h[t+452>>2];if(i>=.05000000074505806){s=g*m<-1.0?-1.0:g*m;s=+q(+(s>1.0?1.0:s))*2.0;if(s>3.1415927410125732){f=(h[d>>2]=-(A*g),r[d>>2]|0);p=(h[d>>2]=-(g*E),r[d>>2]|0);s=-(g*m)<-1.0?-1.0:-(g*m);u=(h[d>>2]=-(g*M),r[d>>2]|0);s=+q(+(s>1.0?1.0:s))*2.0}else{f=o;p=e;u=n}a=(r[d>>2]=f,+h[d>>2]);l=(r[d>>2]=p,+h[d>>2]);c=(r[d>>2]=u,+h[d>>2]);if(s>1.1920928955078125e-07){M=1.0/+G(+(a*a+l*l+c*c));f=(h[d>>2]=a*M,r[d>>2]|0);p=(h[d>>2]=l*M,r[d>>2]|0);u=(h[d>>2]=c*M,r[d>>2]|0)}if(+W(+s)>1.1920928955078125e-07){if(!(s>i))if(s<-i)i=-i;else i=s;T=(r[d>>2]=f,+h[d>>2]);A=(r[d>>2]=p,+h[d>>2]);E=(r[d>>2]=u,+h[d>>2]);i=i*.5;M=+X(+i)/+G(+(E*E+(A*A+T*T)));i=+H(+i);o=(h[d>>2]=T*M,r[d>>2]|0);e=(h[d>>2]=A*M,r[d>>2]|0);n=(h[d>>2]=E*M,r[d>>2]|0)}else i=g*m}else i=g*m;y=(r[d>>2]=S,+h[d>>2]);T=(r[d>>2]=o,+h[d>>2]);v=(r[d>>2]=C,+h[d>>2]);M=(r[d>>2]=n,+h[d>>2]);E=(r[d>>2]=x,+h[d>>2]);A=(r[d>>2]=e,+h[d>>2]);h[t+556>>2]=w*M+(y*T+v*i)-E*A;h[t+560>>2]=E*T+(y*A+w*i)-v*M;h[t+564>>2]=v*A+(y*M+E*i)-w*T;h[t+568>>2]=y*i-v*T-w*A-E*M;return}function zE(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,r=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0;n=+h[t+368>>2];if(!(n!=0.0))return;o=+h[t+372>>2];l=+h[t+376>>2];c=+h[t+380>>2];_=n*(+h[e+4>>2]*l);r=n*(+h[e+8>>2]*c);h[t+336>>2]=n*(+h[e>>2]*o)+ +h[t+336>>2];h[t+340>>2]=_+ +h[t+340>>2];h[t+344>>2]=r+ +h[t+344>>2];o=+h[e>>2]*o;l=+h[e+4>>2]*l;c=+h[e+8>>2]*c;r=+h[i+4>>2];_=+h[i+8>>2];a=+h[i>>2];s=((r*c-l*_)*+h[t+304>>2]+(o*_-c*a)*+h[t+308>>2]+(l*a-o*r)*+h[t+312>>2])*+h[t+572>>2];n=((r*c-l*_)*+h[t+320>>2]+(o*_-c*a)*+h[t+324>>2]+(l*a-o*r)*+h[t+328>>2])*+h[t+576>>2];h[t+352>>2]=(+h[t+288>>2]*(r*c-l*_)+ +h[t+292>>2]*(o*_-c*a)+(l*a-o*r)*+h[t+296>>2])*+h[t+568>>2]+ +h[t+352>>2];h[t+356>>2]=s+ +h[t+356>>2];h[t+360>>2]=n+ +h[t+360>>2];return}function WE(t){t=t|0;return}function GE(t){t=t|0;return 644}function jE(t,e,i){t=t|0;e=e|0;i=i|0;Ub(t,e,i)|0;r[e+52>>2]=r[t+48>>2];r[e+56>>2]=r[t+52>>2];r[e+60>>2]=r[t+56>>2];r[e+64>>2]=r[t+60>>2];r[e+68>>2]=r[t+64>>2];r[e+72>>2]=r[t+68>>2];r[e+76>>2]=r[t+72>>2];r[e+80>>2]=r[t+76>>2];r[e+84>>2]=r[t+80>>2];r[e+88>>2]=r[t+84>>2];r[e+92>>2]=r[t+88>>2];r[e+96>>2]=r[t+92>>2];r[e+100>>2]=r[t+96>>2];r[e+104>>2]=r[t+100>>2];r[e+108>>2]=r[t+104>>2];r[e+112>>2]=r[t+108>>2];r[e+116>>2]=r[t+112>>2];r[e+120>>2]=r[t+116>>2];r[e+124>>2]=r[t+120>>2];r[e+128>>2]=r[t+124>>2];r[e+132>>2]=r[t+128>>2];r[e+136>>2]=r[t+132>>2];r[e+140>>2]=r[t+136>>2];r[e+144>>2]=r[t+140>>2];r[e+148>>2]=r[t+144>>2];r[e+152>>2]=r[t+148>>2];r[e+156>>2]=r[t+152>>2];r[e+160>>2]=r[t+156>>2];r[e+164>>2]=r[t+160>>2];r[e+168>>2]=r[t+164>>2];r[e+172>>2]=r[t+168>>2];r[e+176>>2]=r[t+172>>2];i=0;do{r[e+428+(i<<2)>>2]=r[t+968+(i*88|0)>>2];r[e+412+(i<<2)>>2]=r[t+968+(i*88|0)+4>>2];r[e+444+(i<<2)>>2]=r[t+968+(i*88|0)+8>>2];r[e+460+(i<<2)>>2]=r[t+968+(i*88|0)+12>>2];r[e+476+(i<<2)>>2]=r[t+968+(i*88|0)+16>>2];r[e+492+(i<<2)>>2]=r[t+968+(i*88|0)+20>>2];r[e+508+(i<<2)>>2]=r[t+968+(i*88|0)+24>>2];r[e+524+(i<<2)>>2]=r[t+968+(i*88|0)+32>>2];r[e+540+(i<<2)>>2]=r[t+968+(i*88|0)+36>>2];r[e+556+(i<<2)>>2]=r[t+968+(i*88|0)+44>>2];r[e+572+(i<<2)>>2]=r[t+968+(i*88|0)+52>>2];r[e+588+(i<<2)>>2]=r[t+968+(i*88|0)+60>>2];r[e+604+(i<<2)>>2]=r[t+968+(i*88|0)+68>>2];i=i+1|0}while((i|0)!=3);h[e+440>>2]=0.0;h[e+424>>2]=0.0;h[e+456>>2]=0.0;h[e+472>>2]=0.0;h[e+488>>2]=0.0;h[e+504>>2]=0.0;h[e+520>>2]=0.0;h[e+536>>2]=0.0;h[e+552>>2]=0.0;h[e+568>>2]=0.0;h[e+584>>2]=0.0;h[e+600>>2]=0.0;h[e+616>>2]=0.0;n[e+620>>0]=n[t+996>>0]|0;n[e+624>>0]=n[t+1008>>0]|0;n[e+628>>0]=n[t+1016>>0]|0;n[e+632>>0]=n[t+1024>>0]|0;n[e+636>>0]=n[t+1032>>0]|0;n[e+621>>0]=n[t+1084>>0]|0;n[e+625>>0]=n[t+1096>>0]|0;n[e+629>>0]=n[t+1104>>0]|0;n[e+633>>0]=n[t+1112>>0]|0;n[e+637>>0]=n[t+1120>>0]|0;n[e+622>>0]=n[t+1172>>0]|0;n[e+626>>0]=n[t+1184>>0]|0;n[e+630>>0]=n[t+1192>>0]|0;n[e+634>>0]=n[t+1200>>0]|0;n[e+638>>0]=n[t+1208>>0]|0;n[e+623>>0]=0;n[e+627>>0]=0;n[e+631>>0]=0;n[e+635>>0]=0;n[e+639>>0]=0;r[e+196>>2]=r[t+680>>2];r[e+200>>2]=r[t+684>>2];r[e+204>>2]=r[t+688>>2];r[e+208>>2]=r[t+692>>2];r[e+180>>2]=r[t+696>>2];r[e+184>>2]=r[t+700>>2];r[e+188>>2]=r[t+704>>2];r[e+192>>2]=r[t+708>>2];r[e+212>>2]=r[t+712>>2];r[e+216>>2]=r[t+716>>2];r[e+220>>2]=r[t+720>>2];r[e+224>>2]=r[t+724>>2];r[e+228>>2]=r[t+728>>2];r[e+232>>2]=r[t+732>>2];r[e+236>>2]=r[t+736>>2];r[e+240>>2]=r[t+740>>2];r[e+244>>2]=r[t+744>>2];r[e+248>>2]=r[t+748>>2];r[e+252>>2]=r[t+752>>2];r[e+256>>2]=r[t+756>>2];r[e+260>>2]=r[t+760>>2];r[e+264>>2]=r[t+764>>2];r[e+268>>2]=r[t+768>>2];r[e+272>>2]=r[t+772>>2];r[e+276>>2]=r[t+776>>2];r[e+280>>2]=r[t+780>>2];r[e+284>>2]=r[t+784>>2];r[e+288>>2]=r[t+788>>2];r[e+292>>2]=r[t+876>>2];r[e+296>>2]=r[t+880>>2];r[e+300>>2]=r[t+884>>2];r[e+304>>2]=r[t+888>>2];r[e+308>>2]=r[t+892>>2];r[e+312>>2]=r[t+896>>2];r[e+316>>2]=r[t+900>>2];r[e+320>>2]=r[t+904>>2];r[e+324>>2]=r[t+804>>2];r[e+328>>2]=r[t+808>>2];r[e+332>>2]=r[t+812>>2];r[e+336>>2]=r[t+816>>2];r[e+340>>2]=r[t+820>>2];r[e+344>>2]=r[t+824>>2];r[e+348>>2]=r[t+828>>2];r[e+352>>2]=r[t+832>>2];r[e+356>>2]=r[t+840>>2];r[e+360>>2]=r[t+844>>2];r[e+364>>2]=r[t+848>>2];r[e+368>>2]=r[t+852>>2];r[e+372>>2]=r[t+860>>2];r[e+376>>2]=r[t+864>>2];r[e+380>>2]=r[t+868>>2];r[e+384>>2]=r[t+872>>2];n[e+388>>0]=n[t+792>>0]|0;n[e+392>>0]=n[t+795>>0]|0;n[e+396>>0]=n[t+798>>0]|0;n[e+400>>0]=n[t+836>>0]|0;n[e+404>>0]=n[t+856>>0]|0;n[e+389>>0]=n[t+793>>0]|0;n[e+393>>0]=n[t+796>>0]|0;n[e+397>>0]=n[t+799>>0]|0;n[e+401>>0]=n[t+837>>0]|0;n[e+405>>0]=n[t+857>>0]|0;n[e+390>>0]=n[t+794>>0]|0;n[e+394>>0]=n[t+797>>0]|0;n[e+398>>0]=n[t+800>>0]|0;n[e+402>>0]=n[t+838>>0]|0;n[e+406>>0]=n[t+858>>0]|0;n[e+391>>0]=0;n[e+395>>0]=0;n[e+399>>0]=0;n[e+403>>0]=0;n[e+407>>0]=0;r[e+640>>2]=r[t+1232>>2];return 15168}function HE(t){t=t|0;r[t>>2]=7188;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function XE(t){t=t|0;var e=0,i=0.0,s=0.0,o=0.0,a=0,l=0,c=0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0;l=_;_=_+16|0;if(!(n[t+1308>>0]|0)){_=l;return}h[t+928>>2]=0.0;h[t+992>>2]=0.0;h[t+1056>>2]=0.0;r[t+712>>2]=0;r[t+712+4>>2]=0;r[t+712+8>>2]=0;r[t+712+12>>2]=0;YE(t,(r[t+28>>2]|0)+4|0,(r[t+32>>2]|0)+4|0);ok[r[(r[t>>2]|0)+44>>2]&255](t);i=+h[t+1284>>2];s=+h[t+1288>>2];o=+h[t+1292>>2];if(+h[t+696>>2]>=+h[t+680>>2]){c=(n[t+1300>>0]|0)==0;a=r[(c?t+1160|0:t+1096|0)>>2]|0;e=r[(c?t+1144|0:t+1080|0)>>2]|0;r[l>>2]=r[(c?t+1128|0:t+1064|0)>>2];r[l+4>>2]=e;r[l+8>>2]=a;h[l+12>>2]=0.0;qE(r[t+28>>2]|0,r[t+32>>2]|0,t+176|0,l,i,s,o,i,s,o)}if(+h[t+700>>2]>=+h[t+684>>2]){e=(n[t+1300>>0]|0)==0;c=r[(e?t+1164|0:t+1100|0)>>2]|0;a=r[(e?t+1148|0:t+1084|0)>>2]|0;r[l>>2]=r[(e?t+1132|0:t+1068|0)>>2];r[l+4>>2]=a;r[l+8>>2]=c;h[l+12>>2]=0.0;qE(r[t+28>>2]|0,r[t+32>>2]|0,t+260|0,l,i,s,o,i,s,o)}if(+h[t+704>>2]>=+h[t+688>>2]){e=(n[t+1300>>0]|0)==0;c=r[(e?t+1168|0:t+1104|0)>>2]|0;a=r[(e?t+1152|0:t+1088|0)>>2]|0;r[l>>2]=r[(e?t+1136|0:t+1072|0)>>2];r[l+4>>2]=a;r[l+8>>2]=c;h[l+12>>2]=0.0;qE(r[t+28>>2]|0,r[t+32>>2]|0,t+344|0,l,i,s,o,i,s,o)}a=0;do{i=+h[t+868+(a<<6)>>2];s=+h[t+868+(a<<6)+4>>2];o=+KE(+h[t+1192+(a<<2)>>2],i,s);h[t+868+(a<<6)+52>>2]=o;do{if(!(i>s)){if(i>o){r[t+868+(a<<6)+56>>2]=1;e=t+868+(a<<6)+48|0;h[e>>2]=o-i;if(o-i>3.1415927410125732){h[e>>2]=o-i+-6.2831854820251465;e=19;break}if(!(o-i<-3.1415927410125732)){e=19;break}h[e>>2]=o-i+6.2831854820251465;e=19;break}e=t+868+(a<<6)+56|0;if(!(s<o)){r[e>>2]=0;e=18;break}r[e>>2]=2;e=t+868+(a<<6)+48|0;h[e>>2]=o-s;if(o-s>3.1415927410125732){h[e>>2]=o-s+-6.2831854820251465;e=19;break}if(o-s<-3.1415927410125732){h[e>>2]=o-s+6.2831854820251465;e=19}else e=19}else{r[t+868+(a<<6)+56>>2]=0;e=18}}while(0);if((e|0)==18?(e=0,n[t+868+(a<<6)+44>>0]|0):0)e=19;if((e|0)==19){F=t+1208+(a<<4)|0;r[l>>2]=r[F>>2];r[l+4>>2]=r[F+4>>2];r[l+8>>2]=r[F+8>>2];r[l+12>>2]=r[F+12>>2];F=t+428+(a*84|0)|0;e=r[t+28>>2]|0;O=+h[e+4>>2];k=+h[e+20>>2];D=+h[e+36>>2];P=+h[e+8>>2];I=+h[e+24>>2];R=+h[e+40>>2];E=+h[e+12>>2];A=+h[e+28>>2];T=+h[e+44>>2];c=r[t+32>>2]|0;w=+h[c+4>>2];x=+h[c+20>>2];S=+h[c+36>>2];y=+h[c+8>>2];b=+h[c+24>>2];g=+h[c+40>>2];f=+h[c+12>>2];d=+h[c+28>>2];i=+h[c+44>>2];r[F>>2]=0;r[F+4>>2]=0;r[F+8>>2]=0;r[F+12>>2]=0;p=+h[l>>2];u=+h[l+4>>2];s=+h[l+8>>2];h[t+428+(a*84|0)+16>>2]=O*p+k*u+D*s;h[t+428+(a*84|0)+20>>2]=P*p+I*u+R*s;h[t+428+(a*84|0)+24>>2]=E*p+A*u+T*s;h[t+428+(a*84|0)+28>>2]=0.0;h[t+428+(a*84|0)+32>>2]=w*-p+x*-u+S*-s;h[t+428+(a*84|0)+36>>2]=y*-p+b*-u+g*-s;h[t+428+(a*84|0)+40>>2]=f*-p+d*-u+i*-s;h[t+428+(a*84|0)+44>>2]=0.0;L=(O*p+k*u+D*s)*+h[e+420>>2];M=(P*p+I*u+R*s)*+h[e+424>>2];C=(E*p+A*u+T*s)*+h[e+428>>2];h[t+428+(a*84|0)+48>>2]=L;h[t+428+(a*84|0)+52>>2]=M;h[t+428+(a*84|0)+56>>2]=C;h[t+428+(a*84|0)+60>>2]=0.0;v=(w*-p+x*-u+S*-s)*+h[c+420>>2];m=(y*-p+b*-u+g*-s)*+h[c+424>>2];o=(f*-p+d*-u+i*-s)*+h[c+428>>2];h[t+428+(a*84|0)+64>>2]=v;h[t+428+(a*84|0)+68>>2]=m;h[t+428+(a*84|0)+72>>2]=o;h[t+428+(a*84|0)+76>>2]=0.0;h[t+428+(a*84|0)+80>>2]=(O*p+k*u+D*s)*L+(P*p+I*u+R*s)*M+(E*p+A*u+T*s)*C+((w*-p+x*-u+S*-s)*v+(y*-p+b*-u+g*-s)*m+(f*-p+d*-u+i*-s)*o)}a=a+1|0}while((a|0)!=3);_=l;return}function YE(t,e,i){t=t|0;e=e|0;i=i|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0;M=+h[t+48>>2];a=+h[e>>2];R=+h[t+64>>2];l=+h[e+4>>2];I=+h[t+80>>2];f=+h[e+8>>2];b=+h[t+52>>2];g=+h[t+68>>2];m=+h[t+84>>2];x=+h[t+56>>2];C=+h[t+72>>2];T=+h[t+88>>2];S=+h[e+16>>2];v=+h[e+20>>2];y=+h[e+24>>2];w=+h[e+32>>2];P=+h[e+36>>2];L=+h[e+40>>2];c=+h[t+96>>2];o=+h[t+100>>2];E=+h[t+104>>2];A=+h[e+48>>2]+(a*c+l*o+f*E);s=S*c+v*o+y*E+ +h[e+52>>2];E=w*c+P*o+L*E+ +h[e+56>>2];h[t+1064>>2]=M*a+R*l+I*f;h[t+1068>>2]=a*b+l*g+f*m;h[t+1072>>2]=a*x+l*C+f*T;h[t+1076>>2]=0.0;h[t+1080>>2]=M*S+R*v+I*y;h[t+1084>>2]=b*S+g*v+m*y;h[t+1088>>2]=x*S+C*v+T*y;h[t+1092>>2]=0.0;h[t+1096>>2]=M*w+R*P+I*L;h[t+1100>>2]=b*w+g*P+m*L;h[t+1104>>2]=x*w+C*P+T*L;h[t+1108>>2]=0.0;h[t+1112>>2]=A;h[t+1116>>2]=s;h[t+1120>>2]=E;h[t+1124>>2]=0.0;E=+h[t+112>>2];s=+h[i>>2];A=+h[t+128>>2];L=+h[i+4>>2];T=+h[t+144>>2];P=+h[i+8>>2];C=+h[t+116>>2];w=+h[t+132>>2];x=+h[t+148>>2];m=+h[t+120>>2];g=+h[t+136>>2];b=+h[t+152>>2];I=+h[i+16>>2];R=+h[i+20>>2];M=+h[i+24>>2];y=+h[i+32>>2];v=+h[i+36>>2];S=+h[i+40>>2];f=+h[t+160>>2];l=+h[t+164>>2];a=+h[t+168>>2];o=+h[i+48>>2]+(s*f+L*l+P*a);c=I*f+R*l+M*a+ +h[i+52>>2];a=y*f+v*l+S*a+ +h[i+56>>2];h[t+1128>>2]=E*s+A*L+T*P;h[t+1132>>2]=s*C+L*w+P*x;h[t+1136>>2]=s*m+L*g+P*b;h[t+1140>>2]=0.0;h[t+1144>>2]=E*I+A*R+T*M;h[t+1148>>2]=C*I+w*R+x*M;h[t+1152>>2]=m*I+g*R+b*M;h[t+1156>>2]=0.0;h[t+1160>>2]=E*y+A*v+T*S;h[t+1164>>2]=C*y+w*v+x*S;h[t+1168>>2]=m*y+g*v+b*S;h[t+1172>>2]=0.0;h[t+1176>>2]=o;h[t+1180>>2]=c;h[t+1184>>2]=a;h[t+1188>>2]=0.0;o=o-+h[t+1112>>2];c=c-+h[t+1116>>2];a=a-+h[t+1120>>2];x=+h[t+1084>>2];w=+h[t+1104>>2];C=+h[t+1088>>2];T=+h[t+1100>>2];A=+h[t+1096>>2];E=+h[t+1080>>2];M=+h[t+1064>>2];R=+h[t+1068>>2];I=+h[t+1072>>2];P=1.0/((x*w-C*T)*M+R*(C*A-w*E)+(T*E-x*A)*I);L=(T*E-x*A)*P;s=a*((C*R-x*I)*P)+(o*((x*w-C*T)*P)+c*((T*I-w*R)*P));l=a*((E*I-C*M)*P)+(o*((C*A-w*E)*P)+c*((w*M-A*I)*P));c=a*((x*M-E*R)*P)+(o*L+c*((A*R-T*M)*P));h[t+1256>>2]=s;h[t+1260>>2]=l;h[t+1264>>2]=c;h[t+1268>>2]=0.0;h[t+840>>2]=s;o=+h[t+680>>2];a=+h[t+696>>2];do{if(!(o>a)){if(o>s){r[t+856>>2]=2;h[t+824>>2]=s-o;break}if(a<s){r[t+856>>2]=1;h[t+824>>2]=s-a;break}else{r[t+856>>2]=0;h[t+824>>2]=0.0;break}}else{r[t+856>>2]=0;h[t+824>>2]=0.0}}while(0);h[t+844>>2]=l;s=+h[t+684>>2];o=+h[t+700>>2];do{if(!(s>o)){if(s>l){r[t+860>>2]=2;h[t+828>>2]=l-s;break}if(o<l){r[t+860>>2]=1;h[t+828>>2]=l-o;break}else{r[t+860>>2]=0;h[t+828>>2]=0.0;break}}else{r[t+860>>2]=0;h[t+828>>2]=0.0}}while(0);h[t+848>>2]=c;s=+h[t+688>>2];o=+h[t+704>>2];do{if(!(s>o)){if(s>c){r[t+864>>2]=2;h[t+832>>2]=c-s;break}if(o<c){r[t+864>>2]=1;h[t+832>>2]=c-o;break}else{r[t+864>>2]=0;h[t+832>>2]=0.0;break}}else{r[t+864>>2]=0;h[t+832>>2]=0.0}}while(0);o=+h[t+1128>>2];a=+h[t+1144>>2];l=+h[t+1160>>2];c=+h[t+1132>>2];_=+h[t+1148>>2];u=+h[t+1164>>2];d=(x*w-C*T)*P*c+(T*I-w*R)*P*_+(C*R-x*I)*P*u;p=c*((C*A-w*E)*P)+(w*M-A*I)*P*_+(E*I-C*M)*P*u;f=l*((x*M-E*R)*P)+(o*L+a*((A*R-T*M)*P));s=L*+h[t+1136>>2]+(A*R-T*M)*P*+h[t+1152>>2]+(x*M-E*R)*P*(m*y+g*v+b*S);do{if(f<1.0)if(f>-1.0){h[t+1192>>2]=+Q(+-(c*L+(A*R-T*M)*P*_+(x*M-E*R)*P*u),+s);L=f<-1.0?-1.0:f;h[t+1196>>2]=+K(+(L>1.0?1.0:L));h[t+1200>>2]=+Q(+-(l*((E*I-C*M)*P)+(o*((C*A-w*E)*P)+a*((w*M-A*I)*P))),+(l*((C*R-x*I)*P)+(o*((x*w-C*T)*P)+a*((T*I-w*R)*P))));break}else{h[t+1192>>2]=-+Q(+d,+p);h[t+1196>>2]=-1.5707963705062866;h[t+1200>>2]=0.0;break}else{h[t+1192>>2]=+Q(+d,+p);h[t+1196>>2]=1.5707963705062866;h[t+1200>>2]=0.0}}while(0);h[t+1236>>2]=0.0;T=w*(o*w-l*I)-C*(a*I-o*C);A=I*(a*I-o*C)-w*(l*C-a*w);E=C*(l*C-a*w)-I*(o*w-l*I);h[t+1220>>2]=0.0;M=a*(a*I-o*C)-l*(o*w-l*I);R=l*(l*C-a*w)-o*(a*I-o*C);P=o*(o*w-l*I)-a*(l*C-a*w);h[t+1252>>2]=0.0;L=1.0/+G(+(T*T+A*A+E*E));h[t+1208>>2]=T*L;h[t+1212>>2]=A*L;h[t+1216>>2]=E*L;L=1.0/+G(+((l*C-a*w)*(l*C-a*w)+(o*w-l*I)*(o*w-l*I)+(a*I-o*C)*(a*I-o*C)));h[t+1224>>2]=(l*C-a*w)*L;h[t+1228>>2]=(o*w-l*I)*L;h[t+1232>>2]=(a*I-o*C)*L;L=1.0/+G(+(M*M+R*R+P*P));h[t+1240>>2]=M*L;h[t+1244>>2]=R*L;h[t+1248>>2]=P*L;if(!(n[t+1301>>0]|0))return;P=+h[(r[t+28>>2]|0)+368>>2];L=+h[(r[t+32>>2]|0)+368>>2];n[t+1280>>0]=(P<1.1920928955078125e-07|L<1.1920928955078125e-07)&1;L=P+L>0.0?L/(P+L):.5;h[t+1272>>2]=L;h[t+1276>>2]=1.0-L;return}function qE(t,e,i,n,s,o,a,l,c,u){t=t|0;e=e|0;i=i|0;n=n|0;s=+s;o=+o;a=+a;l=+l;c=+c;u=+u;var d=0;d=_;_=_+128|0;r[d+80>>2]=r[t+4>>2];r[d+80+4>>2]=r[t+20>>2];r[d+80+8>>2]=r[t+36>>2];h[d+80+12>>2]=0.0;r[d+80+16>>2]=r[t+8>>2];r[d+80+20>>2]=r[t+24>>2];r[d+80+24>>2]=r[t+40>>2];h[d+80+28>>2]=0.0;r[d+80+32>>2]=r[t+12>>2];r[d+80+36>>2]=r[t+28>>2];r[d+80+40>>2]=r[t+44>>2];h[d+80+44>>2]=0.0;r[d+32>>2]=r[e+4>>2];r[d+32+4>>2]=r[e+20>>2];r[d+32+8>>2]=r[e+36>>2];h[d+32+12>>2]=0.0;r[d+32+16>>2]=r[e+8>>2];r[d+32+20>>2]=r[e+24>>2];r[d+32+24>>2]=r[e+40>>2];h[d+32+28>>2]=0.0;r[d+32+32>>2]=r[e+12>>2];r[d+32+36>>2]=r[e+28>>2];r[d+32+40>>2]=r[e+44>>2];h[d+32+44>>2]=0.0;o=o-+h[t+56>>2];a=a-+h[t+60>>2];h[d+16>>2]=s-+h[t+52>>2];h[d+16+4>>2]=o;h[d+16+8>>2]=a;h[d+16+12>>2]=0.0;c=c-+h[e+56>>2];u=u-+h[e+60>>2];h[d>>2]=l-+h[e+52>>2];h[d+4>>2]=c;h[d+8>>2]=u;h[d+12>>2]=0.0;ME(i,d+80|0,d+32|0,d+16|0,d,n,t+420|0,+h[t+368>>2],e+420|0,+h[e+368>>2]);_=d;return}function KE(t,e,i){t=+t;e=+e;i=+i;var n=0.0,s=0.0,r=0;if(e>=i)return+t;if(t<e){n=+ql(e-t);if(!(n<-3.1415927410125732)){if(n>3.1415927410125732)n=n+-6.2831854820251465}else n=n+6.2831854820251465;s=+W(+n);n=+ql(i-t);if(!(n<-3.1415927410125732)){if(n>3.1415927410125732)n=n+-6.2831854820251465}else n=n+6.2831854820251465;r=s<+W(+n);t=r?t:t+6.2831854820251465;return+t}if(!(t>i))return+t;n=+ql(t-i);if(!(n<-3.1415927410125732)){if(n>3.1415927410125732)n=n+-6.2831854820251465}else n=n+6.2831854820251465;s=+W(+n);n=+ql(t-e);if(!(n<-3.1415927410125732)){if(n>3.1415927410125732)n=n+-6.2831854820251465}else n=n+6.2831854820251465;r=+W(+n)<s;t=r?t+-6.2831854820251465:t;return+t}function ZE(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0.0,l=0.0,c=0.0,_=0;if(n[t+1308>>0]|0){r[e>>2]=0;r[e+4>>2]=0;return}YE(t,(r[t+28>>2]|0)+4|0,(r[t+32>>2]|0)+4|0);r[e>>2]=0;r[e+4>>2]=6;if((r[t+856>>2]|0)==0?(n[t+788>>0]|0)==0:0){i=0;s=6}else{r[e>>2]=1;r[e+4>>2]=5;i=1;s=5}if(!((r[t+860>>2]|0)==0?(n[t+789>>0]|0)==0:0)){i=i+1|0;r[e>>2]=i;s=s+-1|0;r[e+4>>2]=s}if((r[t+864>>2]|0)==0?(n[t+790>>0]|0)==0:0)_=0;else{i=i+1|0;r[e>>2]=i;s=s+-1|0;r[e+4>>2]=s;_=0}do{a=+h[t+868+(_<<6)>>2];l=+h[t+868+(_<<6)+4>>2];c=+KE(+h[t+1192+(_<<2)>>2],a,l);h[t+868+(_<<6)+52>>2]=c;do{if(!(a>l)){if(a>c){r[t+868+(_<<6)+56>>2]=1;o=t+868+(_<<6)+48|0;h[o>>2]=c-a;if(c-a>3.1415927410125732){h[o>>2]=c-a+-6.2831854820251465;o=21;break}if(!(c-a<-3.1415927410125732)){o=21;break}h[o>>2]=c-a+6.2831854820251465;o=21;break}o=t+868+(_<<6)+56|0;if(!(l<c)){r[o>>2]=0;o=20;break}r[o>>2]=2;o=t+868+(_<<6)+48|0;h[o>>2]=c-l;if(c-l>3.1415927410125732){h[o>>2]=c-l+-6.2831854820251465;o=21;break}if(c-l<-3.1415927410125732){h[o>>2]=c-l+6.2831854820251465;o=21}else o=21}else{r[t+868+(_<<6)+56>>2]=0;o=20}}while(0);if((o|0)==20){o=0;if(n[t+868+(_<<6)+44>>0]|0)o=21}if((o|0)==21){i=i+1|0;r[e>>2]=i;s=s+-1|0;r[e+4>>2]=s}_=_+1|0}while((_|0)!=3);return}function QE(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0,l=0,h=0,c=0;c=_;_=_+16|0;l=r[t+28>>2]|0;h=r[t+32>>2]|0;if(!(n[t+1301>>0]|0)){a=0;i=JE(t,e,0,l+4|0,h+4|0,l+336|0,h+336|0,l+352|0,h+352|0)|0;do{s=t+868+(a<<6)|0;if(!((r[t+868+(a<<6)+56>>2]|0)==0?(n[t+868+(a<<6)+44>>0]|0)==0:0)){o=t+1208+(a<<4)|0;r[c>>2]=r[o>>2];r[c+4>>2]=r[o+4>>2];r[c+8>>2]=r[o+8>>2];r[c+12>>2]=r[o+12>>2];o=r[t+1304>>2]>>(a*3|0)+9;if(!(o&1))r[t+868+(a<<6)+28>>2]=r[r[e+32>>2]>>2];if(!(o&2))r[t+868+(a<<6)+36>>2]=r[r[e+32>>2]>>2];if(!(o&4))r[t+868+(a<<6)+32>>2]=r[e+4>>2];i=($E(t,s,l+4|0,h+4|0,l+336|0,h+336|0,l+352|0,h+352|0,e,i,c,1,0)|0)+i|0}a=a+1|0}while((a|0)!=3);_=c;return}a=0;i=0;do{s=t+868+(a<<6)|0;if(!((r[t+868+(a<<6)+56>>2]|0)==0?(n[t+868+(a<<6)+44>>0]|0)==0:0)){o=t+1208+(a<<4)|0;r[c>>2]=r[o>>2];r[c+4>>2]=r[o+4>>2];r[c+8>>2]=r[o+8>>2];r[c+12>>2]=r[o+12>>2];o=r[t+1304>>2]>>(a*3|0)+9;if(!(o&1))r[t+868+(a<<6)+28>>2]=r[r[e+32>>2]>>2];if(!(o&2))r[t+868+(a<<6)+36>>2]=r[r[e+32>>2]>>2];if(!(o&4))r[t+868+(a<<6)+32>>2]=r[e+4>>2];i=($E(t,s,l+4|0,h+4|0,l+336|0,h+336|0,l+352|0,h+352|0,e,i,c,1,0)|0)+i|0}a=a+1|0}while((a|0)!=3);JE(t,e,i,l+4|0,h+4|0,l+336|0,h+336|0,l+352|0,h+352|0)|0;_=c;return}function $E(t,e,i,s,o,a,l,c,_,u,d,p,f){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;l=l|0;c=c|0;_=_|0;u=u|0;d=d|0;p=p|0;f=f|0;var m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0,T=0,A=0,E=0,M=0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0;A=et(r[_+24>>2]|0,u)|0;u=n[e+44>>0]|0;T=r[e+56>>2]|0;if(!(u<<24>>24!=0|(T|0)!=0)){A=0;return A|0}M=r[(p|0?_+12|0:_+8|0)>>2]|0;E=r[(p|0?_+20|0:_+16|0)>>2]|0;r[M+(A<<2)>>2]=r[d>>2];r[M+(A+1<<2)>>2]=r[d+4>>2];r[M+(A+2<<2)>>2]=r[d+8>>2];h[E+(A<<2)>>2]=-+h[d>>2];h[E+(A+1<<2)>>2]=-+h[d+4>>2];h[E+(A+2<<2)>>2]=-+h[d+8>>2];do{if(!p){m=+h[t+1176>>2];if(!(n[t+1301>>0]|0)){y=m-+h[i+48>>2];x=+h[t+1180>>2]-+h[i+52>>2];w=+h[t+1184>>2]-+h[i+56>>2];S=+h[d+8>>2];b=+h[d+4>>2];v=+h[d>>2];M=r[_+12>>2]|0;h[M+(A<<2)>>2]=x*S-w*b;h[M+(A+1<<2)>>2]=w*v-y*S;h[M+(A+2<<2)>>2]=y*b-x*v;v=+h[t+1176>>2]-+h[s+48>>2];x=+h[t+1180>>2]-+h[s+52>>2];b=+h[t+1184>>2]-+h[s+56>>2];y=+h[d+8>>2];S=+h[d+4>>2];w=+h[d>>2];M=r[_+20>>2]|0;h[M+(A<<2)>>2]=-(x*y-b*S);h[M+(A+1<<2)>>2]=-(b*w-v*y);h[M+(A+2<<2)>>2]=-(v*S-x*w);break}k=m-+h[s+48>>2];D=+h[t+1180>>2]-+h[s+52>>2];P=+h[t+1184>>2]-+h[s+56>>2];v=+h[d>>2];L=+h[d+4>>2];I=+h[d+8>>2];F=+h[t+1112>>2]-+h[i+48>>2];y=+h[t+1116>>2]-+h[i+52>>2];m=+h[t+1120>>2]-+h[i+56>>2];S=+h[e+52>>2]-+h[e+48>>2];O=v*(v*F+L*y+I*m)+v*S-v*(k*v+D*L+P*I);R=L*(v*F+L*y+I*m)+L*S-L*(k*v+D*L+P*I);S=I*(v*F+L*y+I*m)+I*S-I*(k*v+D*L+P*I);w=+h[t+1272>>2];x=+h[t+1276>>2];b=I*(y-L*(v*F+L*y+I*m)+w*R)-L*(m-I*(v*F+L*y+I*m)+w*S);g=v*(m-I*(v*F+L*y+I*m)+w*S)-I*(F-v*(v*F+L*y+I*m)+w*O);m=L*(F-v*(v*F+L*y+I*m)+w*O)-v*(y-L*(v*F+L*y+I*m)+w*R);y=(D-L*(k*v+D*L+P*I)-x*R)*I-(P-I*(k*v+D*L+P*I)-x*S)*L;S=(P-I*(k*v+D*L+P*I)-x*S)*v-(k-v*(k*v+D*L+P*I)-x*O)*I;v=(k-v*(k*v+D*L+P*I)-x*O)*L-(D-L*(k*v+D*L+P*I)-x*R)*v;if(!((f|0)!=0|(n[t+1280>>0]|0)==0)){y=x*y;S=x*S;v=x*v;b=w*b;g=w*g;m=w*m}M=(r[_+12>>2]|0)+(A<<2)|0;h[M>>2]=b;h[M+4>>2]=g;h[M+8>>2]=m;M=r[_+20>>2]|0;h[M+(A<<2)>>2]=-y;h[M+(A+1<<2)>>2]=-S;h[M+(A+2<<2)>>2]=-v}}while(0);if(T|0?+h[e>>2]==+h[e+4>>2]:0){u=r[_+28>>2]|0;h[u+(A<<2)>>2]=0.0;m=0.0;i=_+28|0}else C=11;do{if((C|0)==11){i=r[_+28>>2]|0;h[i+(A<<2)>>2]=0.0;if(!(u<<24>>24)){if(T|0){u=i;m=0.0;i=_+28|0;break}else u=1;return u|0}r[(r[_+32>>2]|0)+(A<<2)>>2]=r[e+28>>2];if(T|0){u=i;m=+h[i+(A<<2)>>2];i=_+28|0;break}S=+h[e+8>>2];m=p|0?S:-S;g=+h[e+52>>2];b=+h[e>>2];y=+h[e+4>>2];v=+h[_>>2]*+h[e+32>>2];do{if(!(b>y))if(!(b==y)){if(m/v<0.0)if(g>=b?b-m/v>g:0){m=(b-g)/(m/v);break}else{m=g<b?0.0:1.0;break}if(m/v>0.0)if(g<=y?y-m/v<g:0){m=(y-g)/(m/v);break}else{m=g>y?0.0:1.0;break}else m=0.0}else m=0.0;else m=1.0}while(0);h[i+(A<<2)>>2]=m*S+ +h[i+(A<<2)>>2];h[(r[_+36>>2]|0)+(A<<2)>>2]=-+h[e+12>>2];r[(r[_+40>>2]|0)+(A<<2)>>2]=r[e+12>>2];M=1;return M|0}}while(0);F=+h[_>>2]*+h[e+32>>2]*+h[e+48>>2];h[u+(A<<2)>>2]=m+(p|0?-F:F);r[(r[_+32>>2]|0)+(A<<2)>>2]=r[e+36>>2];if(+h[e>>2]==+h[e+4>>2]){h[(r[_+36>>2]|0)+(A<<2)>>2]=-3402823466385288598117041.0e14;h[(r[_+40>>2]|0)+(A<<2)>>2]=3402823466385288598117041.0e14;M=1;return M|0}M=r[_+40>>2]|0;h[(r[_+36>>2]|0)+(A<<2)>>2]=(T|0)==1?0.0:-3402823466385288598117041.0e14;h[M+(A<<2)>>2]=(T|0)==1?3402823466385288598117041.0e14:0.0;g=+h[e+40>>2];if(!(g>0.0)){M=1;return M|0}if(p|0){O=+h[d>>2];F=+h[d+4>>2];m=+h[d+8>>2];m=+h[l>>2]*O+ +h[l+4>>2]*F+ +h[l+8>>2]*m-(O*+h[c>>2]+F*+h[c+4>>2]+m*+h[c+8>>2])}else{O=+h[d>>2];F=+h[d+4>>2];m=+h[d+8>>2];m=+h[o>>2]*O+ +h[o+4>>2]*F+ +h[o+8>>2]*m-(O*+h[a>>2]+F*+h[a+4>>2]+m*+h[a+8>>2])}if((T|0)==1){if(!(m<0.0)){M=1;return M|0}m=-(m*g);u=(r[i>>2]|0)+(A<<2)|0;if(!(+h[u>>2]<m)){M=1;return M|0}h[u>>2]=m;M=1;return M|0}else{if(!(m>0.0)){M=1;return M|0}m=-(m*g);u=(r[i>>2]|0)+(A<<2)|0;if(!(+h[u>>2]>m)){M=1;return M|0}h[u>>2]=m;M=1;return M|0}return 0}function JE(t,e,i,s,o,a,l,c,u){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;l=l|0;c=c|0;u=u|0;var d=0,p=0,f=0,m=0;m=_;_=_+80|0;h[m+16+60>>2]=0.0;h[m+16+8>>2]=0.0;h[m+16+12>>2]=.10000000149011612;h[m+16+16>>2]=300.0;h[m+16>>2]=1.0;h[m+16+4>>2]=-1.0;h[m+16+28>>2]=0.0;h[m+16+32>>2]=.20000000298023224;h[m+16+36>>2]=0.0;h[m+16+40>>2]=0.0;h[m+16+20>>2]=1.0;h[m+16+24>>2]=.5;r[m+16+56>>2]=0;h[m+16+48>>2]=0.0;n[m+16+44>>0]=0;f=0;do{d=r[t+856+(f<<2)>>2]|0;p=n[t+788+f>>0]|0;if(!((d|0)==0&p<<24>>24==0)){h[m+16+40>>2]=0.0;r[m+16+56>>2]=d;r[m+16+52>>2]=r[t+840+(f<<2)>>2];r[m+16+48>>2]=r[t+824+(f<<2)>>2];r[m+16+20>>2]=r[t+732>>2];n[m+16+44>>0]=p;r[m+16+4>>2]=r[t+696+(f<<2)>>2];r[m+16+24>>2]=r[t+728>>2];r[m+16>>2]=r[t+680+(f<<2)>>2];h[m+16+16>>2]=0.0;r[m+16+12>>2]=r[t+808+(f<<2)>>2];r[m+16+8>>2]=r[t+792+(f<<2)>>2];r[m>>2]=r[t+1064+(f<<2)>>2];r[m+4>>2]=r[t+1080+(f<<2)>>2];r[m+8>>2]=r[t+1096+(f<<2)>>2];h[m+12>>2]=0.0;p=r[t+1304>>2]>>f*3;if(!(p&1))d=r[e+32>>2]|0;else d=t+740+(f<<2)|0;r[m+16+28>>2]=r[d>>2];if(!(p&2))d=r[e+32>>2]|0;else d=t+772+(f<<2)|0;r[m+16+36>>2]=r[d>>2];r[m+16+32>>2]=r[((p&4|0)==0?e+4|0:t+756+(f<<2)|0)>>2];if(!(n[t+1301>>0]|0))d=$E(t,m+16|0,s,o,a,l,c,u,e,i,m,0,0)|0;else{p=f+1|0;if(!(r[t+868+(((p|0)==3?0:p)<<6)+56>>2]|0))d=1;else d=(r[t+868+(((f+2|0)%3|0)<<6)+56>>2]|0)==0&1;d=$E(t,m+16|0,s,o,a,l,c,u,e,i,m,0,d)|0}i=d+i|0}f=f+1|0}while((f|0)!=3);_=m;return i|0}function tM(t,e,i,n){t=t|0;e=e|0;i=+i;n=n|0;if(n>>>0<3)switch(e|0){case 2:{h[t+756+(n<<2)>>2]=i;r[t+1304>>2]=r[t+1304>>2]|4<<n*3;return}case 4:{h[t+772+(n<<2)>>2]=i;r[t+1304>>2]=r[t+1304>>2]|2<<n*3;return}case 3:{h[t+740+(n<<2)>>2]=i;r[t+1304>>2]=r[t+1304>>2]|1<<n*3;return}default:return}if((n+-3|0)>>>0>=3)return;switch(e|0){case 2:{h[t+868+(n+-3<<6)+32>>2]=i;r[t+1304>>2]=r[t+1304>>2]|4<<n*3;return}case 4:{h[t+868+(n+-3<<6)+36>>2]=i;r[t+1304>>2]=r[t+1304>>2]|2<<n*3;return}case 3:{h[t+868+(n+-3<<6)+28>>2]=i;r[t+1304>>2]=r[t+1304>>2]|1<<n*3;return}default:return}}function eM(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0;t:do{if(i>>>0>=3)if((i+-3|0)>>>0<3)switch(e|0){case 2:{n=+h[t+868+(i+-3<<6)+32>>2];break t}case 4:{n=+h[t+868+(i+-3<<6)+36>>2];break t}case 3:{n=+h[t+868+(i+-3<<6)+28>>2];break t}default:{n=0.0;break t}}else n=0.0;else switch(e|0){case 2:{n=+h[t+756+(i<<2)>>2];break t}case 4:{n=+h[t+772+(i<<2)>>2];break t}case 3:{n=+h[t+740+(i<<2)>>2];break t}default:{n=0.0;break t}}}while(0);return+n}function iM(t){t=t|0;return 252}function nM(t,e,i){t=t|0;e=e|0;i=i|0;Ub(t,e,i)|0;r[e+52>>2]=r[t+48>>2];r[e+56>>2]=r[t+52>>2];r[e+60>>2]=r[t+56>>2];r[e+64>>2]=r[t+60>>2];r[e+68>>2]=r[t+64>>2];r[e+72>>2]=r[t+68>>2];r[e+76>>2]=r[t+72>>2];r[e+80>>2]=r[t+76>>2];r[e+84>>2]=r[t+80>>2];r[e+88>>2]=r[t+84>>2];r[e+92>>2]=r[t+88>>2];r[e+96>>2]=r[t+92>>2];r[e+100>>2]=r[t+96>>2];r[e+104>>2]=r[t+100>>2];r[e+108>>2]=r[t+104>>2];r[e+112>>2]=r[t+108>>2];r[e+116>>2]=r[t+112>>2];r[e+120>>2]=r[t+116>>2];r[e+124>>2]=r[t+120>>2];r[e+128>>2]=r[t+124>>2];r[e+132>>2]=r[t+128>>2];r[e+136>>2]=r[t+132>>2];r[e+140>>2]=r[t+136>>2];r[e+144>>2]=r[t+140>>2];r[e+148>>2]=r[t+144>>2];r[e+152>>2]=r[t+148>>2];r[e+156>>2]=r[t+152>>2];r[e+160>>2]=r[t+156>>2];r[e+164>>2]=r[t+160>>2];r[e+168>>2]=r[t+164>>2];r[e+172>>2]=r[t+168>>2];r[e+176>>2]=r[t+172>>2];r[e+228>>2]=r[t+868>>2];r[e+212>>2]=r[t+872>>2];r[e+196>>2]=r[t+680>>2];r[e+180>>2]=r[t+696>>2];r[e+232>>2]=r[t+932>>2];r[e+216>>2]=r[t+936>>2];r[e+200>>2]=r[t+684>>2];r[e+184>>2]=r[t+700>>2];r[e+236>>2]=r[t+996>>2];r[e+220>>2]=r[t+1e3>>2];r[e+204>>2]=r[t+688>>2];r[e+188>>2]=r[t+704>>2];t=s[t+1300>>1]|0;r[e+244>>2]=t&255;r[e+248>>2]=(t&65535)>>>8&65535;return 15229}function sM(t){t=t|0;var e=0.0,i=0.0,n=0.0,s=0.0;e=+h[(r[t+28>>2]|0)+368>>2];i=+h[(r[t+32>>2]|0)+368>>2];if(i==0.0)e=1.0;else e=e/(e+i);s=1.0-e;n=e*+h[t+1116>>2]+s*+h[t+1180>>2];i=e*+h[t+1120>>2]+s*+h[t+1184>>2];h[t+1284>>2]=e*+h[t+1112>>2]+s*+h[t+1176>>2];h[t+1288>>2]=n;h[t+1292>>2]=i;h[t+1296>>2]=0.0;return}function rM(t){t=t|0;return r[t+1304>>2]|0}function oM(t,e,i,s,o,a){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;r[t+4>>2]=6;r[t+8>>2]=-1;r[t+12>>2]=-1;h[t+16>>2]=3402823466385288598117041.0e14;n[t+20>>0]=1;n[t+21>>0]=0;r[t+24>>2]=-1;r[t+28>>2]=e;r[t+32>>2]=i;h[t+36>>2]=0.0;h[t+40>>2]=.30000001192092896;r[t+44>>2]=0;r[t>>2]=7240;r[t+48>>2]=r[s>>2];r[t+48+4>>2]=r[s+4>>2];r[t+48+8>>2]=r[s+8>>2];r[t+48+12>>2]=r[s+12>>2];r[t+64>>2]=r[s+16>>2];r[t+64+4>>2]=r[s+16+4>>2];r[t+64+8>>2]=r[s+16+8>>2];r[t+64+12>>2]=r[s+16+12>>2];r[t+80>>2]=r[s+32>>2];r[t+80+4>>2]=r[s+32+4>>2];r[t+80+8>>2]=r[s+32+8>>2];r[t+80+12>>2]=r[s+32+12>>2];r[t+96>>2]=r[s+48>>2];r[t+96+4>>2]=r[s+48+4>>2];r[t+96+8>>2]=r[s+48+8>>2];r[t+96+12>>2]=r[s+48+12>>2];r[t+112>>2]=r[o>>2];r[t+112+4>>2]=r[o+4>>2];r[t+112+8>>2]=r[o+8>>2];r[t+112+12>>2]=r[o+12>>2];r[t+128>>2]=r[o+16>>2];r[t+128+4>>2]=r[o+16+4>>2];r[t+128+8>>2]=r[o+16+8>>2];r[t+128+12>>2]=r[o+16+12>>2];r[t+144>>2]=r[o+32>>2];r[t+144+4>>2]=r[o+32+4>>2];r[t+144+8>>2]=r[o+32+8>>2];r[t+144+12>>2]=r[o+32+12>>2];r[t+160>>2]=r[o+48>>2];r[t+160+4>>2]=r[o+48+4>>2];r[t+160+8>>2]=r[o+48+8>>2];r[t+160+12>>2]=r[o+48+12>>2];s=t+680|0;o=s+48|0;do{r[s>>2]=0;s=s+4|0}while((s|0)<(o|0));r[t+740>>2]=0;r[t+740+4>>2]=0;r[t+740+8>>2]=0;r[t+740+12>>2]=0;r[t+756>>2]=1045220557;r[t+760>>2]=1045220557;r[t+764>>2]=1045220557;r[t+768>>2]=0;r[t+768+4>>2]=0;r[t+768+8>>2]=0;r[t+768+12>>2]=0;r[t+768+16>>2]=0;h[t+728>>2]=.699999988079071;h[t+732>>2]=1.0;h[t+736>>2]=.5;n[t+788>>0]=0;h[t+792>>2]=0.0;h[t+808>>2]=0.0;n[t+789>>0]=0;h[t+796>>2]=0.0;h[t+812>>2]=0.0;n[t+790>>0]=0;h[t+800>>2]=0.0;h[t+816>>2]=0.0;h[t+928>>2]=0.0;h[t+876>>2]=0.0;h[t+880>>2]=.10000000149011612;h[t+884>>2]=300.0;h[t+868>>2]=1.0;h[t+872>>2]=-1.0;h[t+896>>2]=0.0;h[t+900>>2]=.20000000298023224;h[t+904>>2]=0.0;h[t+908>>2]=0.0;h[t+888>>2]=1.0;h[t+892>>2]=.5;r[t+924>>2]=0;h[t+916>>2]=0.0;n[t+912>>0]=0;h[t+992>>2]=0.0;h[t+940>>2]=0.0;h[t+944>>2]=.10000000149011612;h[t+948>>2]=300.0;h[t+932>>2]=1.0;h[t+936>>2]=-1.0;h[t+960>>2]=0.0;h[t+964>>2]=.20000000298023224;h[t+968>>2]=0.0;h[t+972>>2]=0.0;h[t+952>>2]=1.0;h[t+956>>2]=.5;r[t+988>>2]=0;h[t+980>>2]=0.0;n[t+976>>0]=0;h[t+1056>>2]=0.0;h[t+1004>>2]=0.0;h[t+1008>>2]=.10000000149011612;h[t+1012>>2]=300.0;h[t+996>>2]=1.0;h[t+1e3>>2]=-1.0;h[t+1024>>2]=0.0;h[t+1028>>2]=.20000000298023224;h[t+1032>>2]=0.0;h[t+1036>>2]=0.0;h[t+1016>>2]=1.0;h[t+1020>>2]=.5;r[t+1052>>2]=0;h[t+1044>>2]=0.0;n[t+1040>>0]=0;n[t+1300>>0]=a&1;n[t+1301>>0]=1;r[t+1304>>2]=0;n[t+1308>>0]=0;YE(t,(r[t+28>>2]|0)+4|0,(r[t+32>>2]|0)+4|0);return}function aM(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0;a=_;_=_+16|0;if(!(n[19880]|0)){n[19880]=1;r[a>>2]=0;r[a+4>>2]=0;r[a+8>>2]=0;r[a+12>>2]=0;zy(21260,0.0,0,0,a)}r[5366]=r[5366]|1;h[5407]=0.0;l=+h[5417]*0.0;c=+h[5418]*0.0;h[5412]=+h[5416]*0.0;h[5413]=l;h[5414]=c;h[5415]=0.0;r[5420]=0;r[5421]=0;r[5422]=0;r[5423]=0;c=+h[5409]*0.0;l=+h[5410]*0.0;h[5461]=+h[5408]*0.0;h[5462]=c;h[5463]=l;h[5464]=0.0;r[t+4>>2]=6;r[t+8>>2]=-1;r[t+12>>2]=-1;h[t+16>>2]=3402823466385288598117041.0e14;n[t+20>>0]=1;n[t+21>>0]=0;r[t+24>>2]=-1;r[t+28>>2]=21260;r[t+32>>2]=e;h[t+36>>2]=0.0;h[t+40>>2]=.30000001192092896;r[t+44>>2]=0;r[t>>2]=7240;r[t+112>>2]=r[i>>2];r[t+112+4>>2]=r[i+4>>2];r[t+112+8>>2]=r[i+8>>2];r[t+112+12>>2]=r[i+12>>2];r[t+128>>2]=r[i+16>>2];r[t+128+4>>2]=r[i+16+4>>2];r[t+128+8>>2]=r[i+16+8>>2];r[t+128+12>>2]=r[i+16+12>>2];r[t+144>>2]=r[i+32>>2];r[t+144+4>>2]=r[i+32+4>>2];r[t+144+8>>2]=r[i+32+8>>2];r[t+144+12>>2]=r[i+32+12>>2];r[t+160>>2]=r[i+48>>2];r[t+160+4>>2]=r[i+48+4>>2];r[t+160+8>>2]=r[i+48+8>>2];r[t+160+12>>2]=r[i+48+12>>2];i=t+680|0;o=i+48|0;do{r[i>>2]=0;i=i+4|0}while((i|0)<(o|0));r[t+740>>2]=0;r[t+740+4>>2]=0;r[t+740+8>>2]=0;r[t+740+12>>2]=0;r[t+756>>2]=1045220557;r[t+760>>2]=1045220557;r[t+764>>2]=1045220557;r[t+768>>2]=0;r[t+768+4>>2]=0;r[t+768+8>>2]=0;r[t+768+12>>2]=0;r[t+768+16>>2]=0;h[t+728>>2]=.699999988079071;h[t+732>>2]=1.0;h[t+736>>2]=.5;n[t+788>>0]=0;h[t+792>>2]=0.0;h[t+808>>2]=0.0;n[t+789>>0]=0;h[t+796>>2]=0.0;h[t+812>>2]=0.0;n[t+790>>0]=0;h[t+800>>2]=0.0;h[t+816>>2]=0.0;h[t+928>>2]=0.0;h[t+876>>2]=0.0;h[t+880>>2]=.10000000149011612;h[t+884>>2]=300.0;h[t+868>>2]=1.0;h[t+872>>2]=-1.0;h[t+896>>2]=0.0;h[t+900>>2]=.20000000298023224;h[t+904>>2]=0.0;h[t+908>>2]=0.0;h[t+888>>2]=1.0;h[t+892>>2]=.5;r[t+924>>2]=0;h[t+916>>2]=0.0;n[t+912>>0]=0;h[t+992>>2]=0.0;h[t+940>>2]=0.0;h[t+944>>2]=.10000000149011612;h[t+948>>2]=300.0;h[t+932>>2]=1.0;h[t+936>>2]=-1.0;h[t+960>>2]=0.0;h[t+964>>2]=.20000000298023224;h[t+968>>2]=0.0;h[t+972>>2]=0.0;h[t+952>>2]=1.0;h[t+956>>2]=.5;r[t+988>>2]=0;h[t+980>>2]=0.0;n[t+976>>0]=0;h[t+1056>>2]=0.0;h[t+1004>>2]=0.0;h[t+1008>>2]=.10000000149011612;h[t+1012>>2]=300.0;h[t+996>>2]=1.0;h[t+1e3>>2]=-1.0;h[t+1024>>2]=0.0;h[t+1028>>2]=.20000000298023224;h[t+1032>>2]=0.0;h[t+1036>>2]=0.0;h[t+1016>>2]=1.0;h[t+1020>>2]=.5;r[t+1052>>2]=0;h[t+1044>>2]=0.0;n[t+1040>>0]=0;n[t+1300>>0]=s&1;n[t+1301>>0]=1;r[t+1304>>2]=0;n[t+1308>>0]=0;C=+h[t+112>>2];I=+h[e+4>>2];w=+h[t+128>>2];R=+h[e+8>>2];x=+h[t+144>>2];M=+h[e+12>>2];S=+h[t+116>>2];v=+h[t+132>>2];y=+h[t+148>>2];b=+h[t+120>>2];m=+h[t+136>>2];p=+h[t+152>>2];E=+h[e+20>>2];A=+h[e+24>>2];T=+h[e+28>>2];g=+h[e+36>>2];f=+h[e+40>>2];d=+h[e+44>>2];L=+h[t+160>>2];P=+h[t+164>>2];c=+h[t+168>>2];u=+h[e+52>>2]+(I*L+R*P+M*c);l=E*L+A*P+T*c+ +h[e+56>>2];c=g*L+f*P+d*c+ +h[e+60>>2];h[t+48>>2]=C*I+w*R+x*M;h[t+52>>2]=I*S+R*v+M*y;h[t+56>>2]=I*b+R*m+M*p;h[t+60>>2]=0.0;h[t+64>>2]=C*E+w*A+x*T;h[t+68>>2]=S*E+v*A+y*T;h[t+72>>2]=b*E+m*A+p*T;h[t+76>>2]=0.0;h[t+80>>2]=C*g+w*f+x*d;h[t+84>>2]=S*g+v*f+y*d;h[t+88>>2]=b*g+m*f+p*d;h[t+92>>2]=0.0;h[t+96>>2]=u;h[t+100>>2]=l;h[t+104>>2]=c;h[t+108>>2]=0.0;YE(t,(r[t+28>>2]|0)+4|0,(r[t+32>>2]|0)+4|0);_=a;return}function lM(t){t=t|0;r[t>>2]=7188;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function hM(t,e){t=t|0;e=e|0;var i=0,s=0.0,o=0.0,a=0.0,l=0;cM(t,(r[t+28>>2]|0)+4|0,(r[t+32>>2]|0)+4|0);r[e>>2]=0;r[e+4>>2]=0;switch(r[t+956>>2]|0){case 4:{r[e>>2]=2;i=2;break}case 0:{i=0;break}default:{r[e>>2]=1;i=1}}if(n[t+792>>0]|0){i=i+1|0;r[e>>2]=i}if(n[t+798>>0]|0){i=i+1|0;r[e>>2]=i}switch(r[t+960>>2]|0){case 4:{i=i+2|0;r[e>>2]=i;break}case 0:break;default:{i=i+1|0;r[e>>2]=i}}if(n[t+793>>0]|0){i=i+1|0;r[e>>2]=i}if(n[t+799>>0]|0){i=i+1|0;r[e>>2]=i}switch(r[t+964>>2]|0){case 4:{i=i+2|0;r[e>>2]=i;break}case 0:break;default:{i=i+1|0;r[e>>2]=i}}if(n[t+794>>0]|0){i=i+1|0;r[e>>2]=i}if(!(n[t+800>>0]|0))l=0;else{i=i+1|0;r[e>>2]=i;l=0}do{s=+h[t+968+(l*88|0)>>2];o=+h[t+968+(l*88|0)+4>>2];a=+KE(+h[t+1364+(l<<2)>>2],s,o);h[t+968+(l*88|0)+80>>2]=a;do{if(!(s>o)){h[t+968+(l*88|0)+72>>2]=a-s;if(s==o){r[t+968+(l*88|0)+84>>2]=3;i=i+1|0;r[e>>2]=i;break}else{h[t+968+(l*88|0)+76>>2]=a-o;r[t+968+(l*88|0)+84>>2]=4;i=i+2|0;r[e>>2]=i;break}}else{r[t+968+(l*88|0)+84>>2]=0;h[t+968+(l*88|0)+72>>2]=0.0}}while(0);if(n[t+968+(l*88|0)+28>>0]|0){i=i+1|0;r[e>>2]=i}if(n[t+968+(l*88|0)+48>>0]|0){i=i+1|0;r[e>>2]=i}l=l+1|0}while((l|0)!=3);return}function cM(t,e,i){t=t|0;e=e|0;i=i|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0,u=0,d=0,p=0,f=0,m=0,g=0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,W=0.0,j=0.0,H=0.0,X=0.0,Y=0.0,q=0.0;X=+h[t+48>>2];a=+h[e>>2];Y=+h[t+64>>2];C=+h[e+4>>2];q=+h[t+80>>2];s=+h[e+8>>2];E=+h[t+52>>2];A=+h[t+68>>2];T=+h[t+84>>2];z=+h[t+56>>2];j=+h[t+72>>2];U=+h[t+88>>2];I=+h[e+16>>2];R=+h[e+20>>2];M=+h[e+24>>2];W=+h[e+32>>2];w=+h[e+36>>2];b=+h[e+40>>2];c=+h[t+96>>2];o=+h[t+100>>2];H=+h[t+104>>2];V=+h[e+48>>2]+(a*c+C*o+s*H);x=I*c+R*o+M*H+ +h[e+52>>2];H=W*c+w*o+b*H+ +h[e+56>>2];h[t+1236>>2]=X*a+Y*C+q*s;h[t+1240>>2]=a*E+C*A+s*T;h[t+1244>>2]=a*z+C*j+s*U;h[t+1248>>2]=0.0;h[t+1252>>2]=X*I+Y*R+q*M;h[t+1256>>2]=E*I+A*R+T*M;h[t+1260>>2]=z*I+j*R+U*M;h[t+1264>>2]=0.0;h[t+1268>>2]=X*W+Y*w+q*b;h[t+1272>>2]=E*W+A*w+T*b;h[t+1276>>2]=z*W+j*w+U*b;h[t+1280>>2]=0.0;h[t+1284>>2]=V;h[t+1288>>2]=x;h[t+1292>>2]=H;h[t+1296>>2]=0.0;H=+h[t+112>>2];x=+h[i>>2];V=+h[t+128>>2];b=+h[i+4>>2];U=+h[t+144>>2];w=+h[i+8>>2];j=+h[t+116>>2];W=+h[t+132>>2];z=+h[t+148>>2];T=+h[t+120>>2];A=+h[t+136>>2];E=+h[t+152>>2];q=+h[i+16>>2];Y=+h[i+20>>2];X=+h[i+24>>2];M=+h[i+32>>2];R=+h[i+36>>2];I=+h[i+40>>2];s=+h[t+160>>2];C=+h[t+164>>2];a=+h[t+168>>2];o=+h[i+48>>2]+(x*s+b*C+w*a);c=q*s+Y*C+X*a+ +h[i+52>>2];a=M*s+R*C+I*a+ +h[i+56>>2];h[t+1300>>2]=H*x+V*b+U*w;h[t+1304>>2]=x*j+b*W+w*z;h[t+1308>>2]=x*T+b*A+w*E;h[t+1312>>2]=0.0;h[t+1316>>2]=H*q+V*Y+U*X;h[t+1320>>2]=j*q+W*Y+z*X;h[t+1324>>2]=T*q+A*Y+E*X;h[t+1328>>2]=0.0;h[t+1332>>2]=H*M+V*R+U*I;h[t+1336>>2]=j*M+W*R+z*I;h[t+1340>>2]=T*M+A*R+E*I;h[t+1344>>2]=0.0;h[t+1348>>2]=o;h[t+1352>>2]=c;h[t+1356>>2]=a;h[t+1360>>2]=0.0;o=o-+h[t+1284>>2];c=c-+h[t+1288>>2];a=a-+h[t+1292>>2];z=+h[t+1256>>2];W=+h[t+1276>>2];j=+h[t+1260>>2];U=+h[t+1272>>2];V=+h[t+1268>>2];H=+h[t+1252>>2];X=+h[t+1236>>2];Y=+h[t+1240>>2];q=+h[t+1244>>2];w=1.0/((z*W-j*U)*X+Y*(j*V-W*H)+(U*H-z*V)*q);b=(z*W-j*U)*w;x=(j*V-W*H)*w;C=(U*H-z*V)*w;s=a*((j*Y-z*q)*w)+(o*b+c*((U*q-W*Y)*w));l=a*((H*q-j*X)*w)+(o*x+c*((W*X-V*q)*w));c=a*((z*X-H*Y)*w)+(o*C+c*((V*Y-U*X)*w));h[t+1428>>2]=s;h[t+1432>>2]=l;h[t+1436>>2]=c;h[t+1440>>2]=0.0;h[t+940>>2]=s;o=+h[t+680>>2];a=+h[t+696>>2];do{if(!(o>a)){h[t+908>>2]=s-o;if(o==a){r[t+956>>2]=3;break}else{h[t+924>>2]=s-a;r[t+956>>2]=4;break}}else{h[t+908>>2]=0.0;r[t+956>>2]=0}}while(0);h[t+944>>2]=l;s=+h[t+684>>2];o=+h[t+700>>2];do{if(!(s>o)){h[t+912>>2]=l-s;if(s==o){r[t+960>>2]=3;break}else{h[t+928>>2]=l-o;r[t+960>>2]=4;break}}else{h[t+912>>2]=0.0;r[t+960>>2]=0}}while(0);h[t+948>>2]=c;s=+h[t+688>>2];o=+h[t+704>>2];do{if(!(s>o)){h[t+916>>2]=c-s;if(s==o){r[t+964>>2]=3;break}else{h[t+932>>2]=c-o;r[t+964>>2]=4;break}}else{h[t+916>>2]=0.0;r[t+964>>2]=0}}while(0);D=+h[t+1300>>2];k=+h[t+1316>>2];O=+h[t+1332>>2];v=O*((j*Y-z*q)*w)+(D*b+k*((U*q-W*Y)*w));F=+h[t+1304>>2];B=+h[t+1320>>2];N=+h[t+1336>>2];S=b*F+(U*q-W*Y)*w*B+(j*Y-z*q)*w*N;P=+h[t+1308>>2];L=+h[t+1324>>2];c=b*P+(U*q-W*Y)*w*L+(j*Y-z*q)*w*(T*M+A*R+E*I);b=O*((H*q-j*X)*w)+(D*x+k*((W*X-V*q)*w));y=F*x+(W*X-V*q)*w*B+(H*q-j*X)*w*N;o=x*P+(W*X-V*q)*w*L+(H*q-j*X)*w*(T*M+A*R+E*I);a=O*((z*X-H*Y)*w)+(D*C+k*((V*Y-U*X)*w));l=F*C+(V*Y-U*X)*w*B+(z*X-H*Y)*w*N;s=C*P+(V*Y-U*X)*w*L+(z*X-H*Y)*w*(T*M+A*R+E*I);switch(r[t+1232>>2]|0){case 0:{do{if(a<1.0)if(a>-1.0){h[t+1364>>2]=+Q(+-l,+s);Y=a<-1.0?-1.0:a;h[t+1368>>2]=+K(+(Y>1.0?1.0:Y));h[t+1372>>2]=+Q(+-b,+v);break}else{h[t+1364>>2]=-+Q(+S,+y);h[t+1368>>2]=-1.5707963705062866;h[t+1372>>2]=0.0;break}else{h[t+1364>>2]=+Q(+S,+y);h[t+1368>>2]=1.5707963705062866;h[t+1372>>2]=0.0}}while(0);h[t+1396>>2]=O*j-k*W;h[t+1400>>2]=D*W-O*q;h[t+1404>>2]=k*q-D*j;h[t+1408>>2]=0.0;h[t+1380>>2]=W*(D*W-O*q)-j*(k*q-D*j);h[t+1384>>2]=q*(k*q-D*j)-W*(O*j-k*W);h[t+1388>>2]=j*(O*j-k*W)-q*(D*W-O*q);h[t+1392>>2]=0.0;h[t+1412>>2]=k*(k*q-D*j)-O*(D*W-O*q);h[t+1416>>2]=O*(O*j-k*W)-D*(k*q-D*j);h[t+1420>>2]=D*(D*W-O*q)-k*(O*j-k*W);h[t+1424>>2]=0.0;e=t+1380|0;i=t+1384|0;_=t+1388|0;u=t+1396|0;d=t+1400|0;p=t+1404|0;f=t+1412|0;m=t+1416|0;g=t+1420|0;a=W*(D*W-O*q)-j*(k*q-D*j);l=q*(k*q-D*j)-W*(O*j-k*W);c=j*(O*j-k*W)-q*(D*W-O*q);b=O*j-k*W;y=D*W-O*q;v=k*q-D*j;S=k*(k*q-D*j)-O*(D*W-O*q);o=O*(O*j-k*W)-D*(k*q-D*j);s=D*(D*W-O*q)-k*(O*j-k*W);break}case 1:{do{if(b<1.0)if(b>-1.0){h[t+1364>>2]=+Q(+o,+y);h[t+1368>>2]=+Q(+a,+v);q=-b<-1.0?-1.0:-b;h[t+1372>>2]=+K(+(q>1.0?1.0:q));break}else{h[t+1364>>2]=-+Q(+-c,+s);h[t+1368>>2]=0.0;h[t+1372>>2]=1.5707963705062866;break}else{h[t+1364>>2]=+Q(+-c,+s);h[t+1368>>2]=0.0;h[t+1372>>2]=-1.5707963705062866}}while(0);h[t+1412>>2]=k*U-O*z;h[t+1416>>2]=O*Y-D*U;h[t+1420>>2]=D*z-k*Y;h[t+1424>>2]=0.0;h[t+1380>>2]=z*(D*z-k*Y)-U*(O*Y-D*U);h[t+1384>>2]=U*(k*U-O*z)-Y*(D*z-k*Y);h[t+1388>>2]=Y*(O*Y-D*U)-z*(k*U-O*z);h[t+1392>>2]=0.0;h[t+1396>>2]=O*(O*Y-D*U)-k*(D*z-k*Y);h[t+1400>>2]=D*(D*z-k*Y)-O*(k*U-O*z);h[t+1404>>2]=k*(k*U-O*z)-D*(O*Y-D*U);h[t+1408>>2]=0.0;e=t+1380|0;i=t+1384|0;_=t+1388|0;u=t+1396|0;d=t+1400|0;p=t+1404|0;f=t+1412|0;m=t+1416|0;g=t+1420|0;a=z*(D*z-k*Y)-U*(O*Y-D*U);l=U*(k*U-O*z)-Y*(D*z-k*Y);c=Y*(O*Y-D*U)-z*(k*U-O*z);b=O*(O*Y-D*U)-k*(D*z-k*Y);y=D*(D*z-k*Y)-O*(k*U-O*z);v=k*(k*U-O*z)-D*(O*Y-D*U);S=k*U-O*z;o=O*Y-D*U;s=D*z-k*Y;break}case 2:{do{if(l<1.0)if(l>-1.0){Y=-l<-1.0?-1.0:-l;h[t+1364>>2]=+K(+(Y>1.0?1.0:Y));h[t+1368>>2]=+Q(+a,+s);h[t+1372>>2]=+Q(+S,+y);break}else{h[t+1364>>2]=1.5707963705062866;h[t+1368>>2]=-+Q(+-b,+v);h[t+1372>>2]=0.0;break}else{h[t+1364>>2]=-1.5707963705062866;h[t+1368>>2]=+Q(+-b,+v);h[t+1372>>2]=0.0}}while(0);h[t+1380>>2]=B*W-N*j;h[t+1384>>2]=N*q-F*W;h[t+1388>>2]=F*j-B*q;h[t+1392>>2]=0.0;h[t+1396>>2]=j*(F*j-B*q)-W*(N*q-F*W);h[t+1400>>2]=W*(B*W-N*j)-q*(F*j-B*q);h[t+1404>>2]=q*(N*q-F*W)-j*(B*W-N*j);h[t+1408>>2]=0.0;h[t+1412>>2]=N*(N*q-F*W)-B*(F*j-B*q);h[t+1416>>2]=F*(F*j-B*q)-N*(B*W-N*j);h[t+1420>>2]=B*(B*W-N*j)-F*(N*q-F*W);h[t+1424>>2]=0.0;e=t+1380|0;i=t+1384|0;_=t+1388|0;u=t+1396|0;d=t+1400|0;p=t+1404|0;f=t+1412|0;m=t+1416|0;g=t+1420|0;a=B*W-N*j;l=N*q-F*W;c=F*j-B*q;b=j*(F*j-B*q)-W*(N*q-F*W);y=W*(B*W-N*j)-q*(F*j-B*q);v=q*(N*q-F*W)-j*(B*W-N*j);S=N*(N*q-F*W)-B*(F*j-B*q);o=F*(F*j-B*q)-N*(B*W-N*j);s=B*(B*W-N*j)-F*(N*q-F*W);break}case 3:{do{if(S<1.0)if(S>-1.0){h[t+1364>>2]=+Q(+-l,+y);h[t+1368>>2]=+Q(+-c,+v);q=S<-1.0?-1.0:S;h[t+1372>>2]=+K(+(q>1.0?1.0:q));break}else{h[t+1364>>2]=0.0;h[t+1368>>2]=-+Q(+o,+s);h[t+1372>>2]=-1.5707963705062866;break}else{h[t+1364>>2]=0.0;h[t+1368>>2]=+Q(+o,+s);h[t+1372>>2]=1.5707963705062866}}while(0);h[t+1412>>2]=H*N-V*B;h[t+1416>>2]=V*F-X*N;h[t+1420>>2]=X*B-H*F;h[t+1424>>2]=0.0;h[t+1380>>2]=B*(X*B-H*F)-N*(V*F-X*N);h[t+1384>>2]=N*(H*N-V*B)-F*(X*B-H*F);h[t+1388>>2]=F*(V*F-X*N)-B*(H*N-V*B);h[t+1392>>2]=0.0;h[t+1396>>2]=V*(V*F-X*N)-H*(X*B-H*F);h[t+1400>>2]=X*(X*B-H*F)-V*(H*N-V*B);h[t+1404>>2]=H*(H*N-V*B)-X*(V*F-X*N);h[t+1408>>2]=0.0;e=t+1380|0;i=t+1384|0;_=t+1388|0;u=t+1396|0;d=t+1400|0;p=t+1404|0;f=t+1412|0;m=t+1416|0;g=t+1420|0;a=B*(X*B-H*F)-N*(V*F-X*N);l=N*(H*N-V*B)-F*(X*B-H*F);c=F*(V*F-X*N)-B*(H*N-V*B);b=V*(V*F-X*N)-H*(X*B-H*F);y=X*(X*B-H*F)-V*(H*N-V*B);v=H*(H*N-V*B)-X*(V*F-X*N);S=H*N-V*B;o=V*F-X*N;s=X*B-H*F;break}case 4:{do{if(o<1.0)if(o>-1.0){q=o<-1.0?-1.0:o;h[t+1364>>2]=+K(+(q>1.0?1.0:q));h[t+1368>>2]=+Q(+-c,+s);h[t+1372>>2]=+Q(+-b,+y);break}else{h[t+1364>>2]=-1.5707963705062866;h[t+1368>>2]=0.0;h[t+1372>>2]=-+Q(+a,+v);break}else{h[t+1364>>2]=1.5707963705062866;h[t+1368>>2]=0.0;h[t+1372>>2]=+Q(+a,+v)}}while(0);q=z*(T*M+A*R+E*I)-U*L;s=U*P-Y*(T*M+A*R+E*I);h[t+1380>>2]=q;h[t+1384>>2]=s;h[t+1388>>2]=Y*L-z*P;h[t+1392>>2]=0.0;b=L*(Y*L-z*P)-(T*M+A*R+E*I)*s;y=(T*M+A*R+E*I)*q-P*(Y*L-z*P);h[t+1396>>2]=b;h[t+1400>>2]=y;h[t+1404>>2]=P*s-L*q;h[t+1408>>2]=0.0;h[t+1412>>2]=U*s-z*(Y*L-z*P);h[t+1416>>2]=Y*(Y*L-z*P)-U*q;h[t+1420>>2]=z*q-Y*s;h[t+1424>>2]=0.0;e=t+1380|0;i=t+1384|0;_=t+1388|0;u=t+1396|0;d=t+1400|0;p=t+1404|0;f=t+1412|0;m=t+1416|0;g=t+1420|0;a=q;l=s;c=Y*L-z*P;v=P*s-L*q;S=U*s-z*(Y*L-z*P);o=Y*(Y*L-z*P)-U*q;s=z*q-Y*s;break}case 5:{do{if(c<1.0)if(c>-1.0){h[t+1364>>2]=+Q(+o,+s);q=-c<-1.0?-1.0:-c;h[t+1368>>2]=+K(+(q>1.0?1.0:q));h[t+1372>>2]=+Q(+S,+v);break}else{h[t+1364>>2]=0.0;h[t+1368>>2]=1.5707963705062866;h[t+1372>>2]=-+Q(+b,+a);break}else{h[t+1364>>2]=0.0;h[t+1368>>2]=-1.5707963705062866;h[t+1372>>2]=+Q(+-b,+-a)}}while(0);s=V*L-H*(T*M+A*R+E*I);q=X*(T*M+A*R+E*I)-V*P;h[t+1396>>2]=s;h[t+1400>>2]=q;h[t+1404>>2]=H*P-X*L;h[t+1408>>2]=0.0;a=(T*M+A*R+E*I)*q-L*(H*P-X*L);l=P*(H*P-X*L)-(T*M+A*R+E*I)*s;h[t+1380>>2]=a;h[t+1384>>2]=l;h[t+1388>>2]=L*s-P*q;h[t+1392>>2]=0.0;h[t+1412>>2]=H*(H*P-X*L)-V*q;h[t+1416>>2]=V*s-X*(H*P-X*L);h[t+1420>>2]=X*q-H*s;h[t+1424>>2]=0.0;e=t+1380|0;i=t+1384|0;_=t+1388|0;u=t+1396|0;d=t+1400|0;p=t+1404|0;f=t+1412|0;m=t+1416|0;g=t+1420|0;c=L*s-P*q;b=s;y=q;v=H*P-X*L;S=H*(H*P-X*L)-V*q;o=V*s-X*(H*P-X*L);s=X*q-H*s;break}default:{e=t+1380|0;i=t+1384|0;_=t+1388|0;u=t+1396|0;d=t+1400|0;p=t+1404|0;f=t+1412|0;m=t+1416|0;g=t+1420|0;a=+h[t+1380>>2];l=+h[t+1384>>2];c=+h[t+1388>>2];b=+h[t+1396>>2];y=+h[t+1400>>2];v=+h[t+1404>>2];S=+h[t+1412>>2];o=+h[t+1416>>2];s=+h[t+1420>>2]}}Y=1.0/+G(+(a*a+l*l+c*c));h[e>>2]=a*Y;h[i>>2]=l*Y;h[_>>2]=c*Y;Y=1.0/+G(+(b*b+y*y+v*v));h[u>>2]=b*Y;h[d>>2]=y*Y;h[p>>2]=v*Y;Y=1.0/+G(+(S*S+o*o+s*s));h[f>>2]=S*Y;h[m>>2]=o*Y;h[g>>2]=s*Y;Y=+h[(r[t+28>>2]|0)+368>>2];q=+h[(r[t+32>>2]|0)+368>>2];n[t+1452>>0]=(Y<1.1920928955078125e-07|q<1.1920928955078125e-07)&1;q=Y+q>0.0?q/(Y+q):.5;h[t+1444>>2]=q;h[t+1448>>2]=1.0-q;return}function _M(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0,p=0,f=0,m=0.0;f=_;_=_+112|0;u=r[t+28>>2]|0;d=r[t+32>>2]|0;r[f+16>>2]=r[1836];r[f+16+4>>2]=r[1837];r[f+16+8>>2]=r[1838];switch(r[t+1232>>2]|0){case 0:{r[f+16>>2]=0;r[f+16+4>>2]=1;r[f+16+8>>2]=2;i=0;break}case 1:{r[f+16>>2]=0;r[f+16+4>>2]=2;r[f+16+8>>2]=1;i=0;break}case 2:{r[f+16>>2]=1;r[f+16+4>>2]=0;r[f+16+8>>2]=2;i=1;break}case 3:{r[f+16>>2]=1;r[f+16+4>>2]=2;r[f+16+8>>2]=0;i=1;break}case 4:{r[f+16>>2]=2;r[f+16+4>>2]=0;r[f+16+8>>2]=1;i=2;break}case 5:{r[f+16>>2]=2;r[f+16+4>>2]=1;r[f+16+8>>2]=0;i=2;break}default:i=0}s=0;l=0;while(1){o=t+968+(i*88|0)|0;if(!(((r[t+968+(i*88|0)+84>>2]|0)==0?(n[t+968+(i*88|0)+28>>0]|0)==0:0)?(n[t+968+(i*88|0)+48>>0]|0)==0:0)){a=t+1380+(i<<4)|0;r[f>>2]=r[a>>2];r[f+4>>2]=r[a+4>>2];r[f+8>>2]=r[a+8>>2];r[f+12>>2]=r[a+12>>2];a=r[t+1456>>2]>>(i<<2)+12;if(!(a&1))r[t+968+(i*88|0)+16>>2]=r[r[e+32>>2]>>2];if(!(a&2))r[t+968+(i*88|0)+12>>2]=r[e+4>>2];if(!(a&4))r[t+968+(i*88|0)+24>>2]=r[r[e+32>>2]>>2];if(!(a&8))r[t+968+(i*88|0)+20>>2]=r[e+4>>2];l=(lD(t,o,u+4|0,d+4|0,u+336|0,d+336|0,u+352|0,d+352|0,e,l,f,1,0)|0)+l|0}s=s+1|0;if((s|0)==3)break;i=r[f+16+(s<<2)>>2]|0}h[f+16>>2]=1.0;h[f+16+4>>2]=-1.0;h[f+16+8>>2]=0.0;h[f+16+12>>2]=.20000000298023224;h[f+16+16>>2]=0.0;h[f+16+20>>2]=.8999999761581421;h[f+16+24>>2]=0.0;n[f+16+28>>0]=0;h[f+16+32>>2]=0.0;h[f+16+36>>2]=.10000000149011612;n[f+16+40>>0]=0;h[f+16+44>>2]=0.0;n[f+16+48>>0]=0;h[f+16+52>>2]=0.0;n[f+16+56>>0]=0;h[f+16+60>>2]=0.0;n[f+16+64>>0]=0;c=f+16+68|0;r[c>>2]=0;r[c+4>>2]=0;r[c+8>>2]=0;r[c+12>>2]=0;r[c+16>>2]=0;s=l;l=0;while(1){o=r[t+956+(l<<2)>>2]|0;i=n[t+792+l>>0]|0;a=n[t+798+l>>0]|0;if((o|0)==0&i<<24>>24==0)if(!(a<<24>>24))i=l+1|0;else{i=0;p=27}else p=27;if((p|0)==27){p=0;r[f+16+8>>2]=r[t+712+(l<<2)>>2];r[f+16+84>>2]=o;r[f+16+80>>2]=r[t+940+(l<<2)>>2];r[f+16+72>>2]=r[t+908+(l<<2)>>2];r[f+16+76>>2]=r[t+924+(l<<2)>>2];n[f+16+28>>0]=i;n[f+16+40>>0]=n[t+795+l>>0]|0;r[f+16+44>>2]=r[t+804+(l<<2)>>2];n[f+16+48>>0]=a;r[f+16+52>>2]=r[t+820+(l<<2)>>2];n[f+16+56>>0]=n[t+836+l>>0]|0;r[f+16+60>>2]=r[t+840+(l<<2)>>2];n[f+16+64>>0]=n[t+856+l>>0]|0;r[c>>2]=r[t+860+(l<<2)>>2];r[f+16+4>>2]=r[t+696+(l<<2)>>2];r[f+16>>2]=r[t+680+(l<<2)>>2];r[f+16+36>>2]=r[t+892+(l<<2)>>2];r[f+16+32>>2]=r[t+876+(l<<2)>>2];r[f>>2]=r[t+1236+(l<<2)>>2];r[f+4>>2]=r[t+1252+(l<<2)>>2];r[f+8>>2]=r[t+1268+(l<<2)>>2];h[f+12>>2]=0.0;o=r[t+1456>>2]>>(l<<2);if(!(o&1))i=r[e+32>>2]|0;else i=t+744+(l<<2)|0;r[f+16+16>>2]=r[i>>2];r[f+16+12>>2]=r[((o&2|0)==0?e+4|0:t+728+(l<<2)|0)>>2];if(!(o&4))i=r[e+32>>2]|0;else i=t+776+(l<<2)|0;r[f+16+24>>2]=r[i>>2];r[f+16+20>>2]=r[((o&8|0)==0?e+4|0:t+760+(l<<2)|0)>>2];i=l+1|0;a=(i|0)==3?0:i;l=(l+2|0)%3|0;o=r[t+968+(a*88|0)+84>>2]|0;switch(o|0){case 2:case 1:{a=1;break}case 3:{m=+h[t+968+(a*88|0)+72>>2];a=m<-.001|m>.001;break}default:if((o|0)==4)if(+h[t+968+(a*88|0)+72>>2]<-.001)a=1;else a=+h[t+968+(a*88|0)+76>>2]>.001;else a=0}switch(r[t+968+(l*88|0)+84>>2]|0){case 2:case 1:{p=42;break}case 3:{m=+h[t+968+(l*88|0)+72>>2];if(m<-.001|m>.001)p=42;else o=1;break}case 4:{if(!(+h[t+968+(l*88|0)+72>>2]<-.001)?!(+h[t+968+(l*88|0)+76>>2]>.001):0)o=1;else p=42;break}default:o=1}if((p|0)==42){p=0;o=0}s=(lD(t,f+16|0,u+4|0,d+4|0,u+336|0,d+336|0,u+352|0,d+352|0,e,s,f,0,a?o:1)|0)+s|0}if((i|0)==3)break;else l=i}_=f;return}function uM(t,e,i){t=t|0;e=e|0;i=+i;var n=0,s=0.0,o=0.0,a=0.0,l=0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0;l=_;_=_+32|0;d=+h[t+60>>2];g=+h[t+76>>2]-d;u=+h[t+64>>2];f=+h[t+80>>2]-u;c=+h[t+68>>2];b=+h[t+84>>2]-c;p=+h[t+92>>2]-d;m=+h[t+96>>2]-u;o=+h[t+100>>2]-c;a=1.0/+G(+((g*m-f*p)*(g*m-f*p)+((f*o-b*m)*(f*o-b*m)+(b*p-g*o)*(b*p-g*o))));s=a*(f*o-b*m);o=a*(b*p-g*o);a=(g*m-f*p)*a;c=a*+h[e+8>>2]+(+h[e>>2]*s+ +h[e+4>>2]*o)-(s*d+o*u+a*c);if(!(c>=-i)|!(c<=i)){t=0;_=l;return t|0}n=0;while(1){jk[r[(r[t>>2]|0)+104>>2]&127](t,n,l+16|0,l);d=+h[l+16>>2];b=+h[l>>2]-d;f=+h[l+16+4>>2];p=+h[l+4>>2]-f;u=+h[l+16+8>>2];g=+h[l+8>>2]-u;m=1.0/+G(+((o*b-s*p)*(o*b-s*p)+((a*p-o*g)*(a*p-o*g)+(s*g-a*b)*(s*g-a*b))));n=n+1|0;if((o*b-s*p)*m*+h[e+8>>2]+(+h[e>>2]*(m*(a*p-o*g))+ +h[e+4>>2]*(m*(s*g-a*b)))-(u*((o*b-s*p)*m)+(d*(m*(a*p-o*g))+f*(m*(s*g-a*b))))<-i){n=0;e=5;break}if((n|0)>=3){n=1;e=5;break}}if((e|0)==5){_=l;return n|0}return 0}function dM(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0;o=+h[t+60>>2];c=+h[t+76>>2]-o;l=+h[t+64>>2];a=+h[t+80>>2]-l;_=+h[t+68>>2];u=+h[t+84>>2]-_;o=+h[t+92>>2]-o;l=+h[t+96>>2]-l;_=+h[t+100>>2]-_;h[i+12>>2]=0.0;s=1.0/+G(+((c*l-a*o)*(c*l-a*o)+((a*_-u*l)*(a*_-u*l)+(u*o-c*_)*(u*o-c*_))));h[i>>2]=(a*_-u*l)*s;h[i+4>>2]=(u*o-c*_)*s;h[i+8>>2]=(c*l-a*o)*s;r[n>>2]=r[t+60>>2];r[n+4>>2]=r[t+60+4>>2];r[n+8>>2]=r[t+60+8>>2];r[n+12>>2]=r[t+60+12>>2];return}function pM(t){t=t|0;var e=0;r[t>>2]=3720;r[t+12>>2]=3748;e=r[t+60>>2]|0;lk[r[(r[e>>2]|0)+20>>2]&127](e,r[t+76>>2]|0);e=r[t+60>>2]|0;lk[r[(r[e>>2]|0)+16>>2]&127](e,r[t+76>>2]|0);Ql(t);return}function fM(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0,l=0,c=0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0;l=_;_=_+64|0;c=(n[t+8>>0]|0)!=0;a=c?i:e;e=c?e:i;i=r[e+4>>2]|0;if(((r[i+4>>2]|0)+-21|0)>>>0>=9){_=l;return}if((r[(r[a+4>>2]|0)+4>>2]|0)>=20){_=l;return}u=+xk[r[(r[i>>2]|0)+48>>2]&15](i);r[o+4>>2]=r[t+76>>2];r[t+16>>2]=a;r[t+20>>2]=e;r[t+64>>2]=s;h[t+68>>2]=u;r[t+56>>2]=o;c=r[e+12>>2]|0;E=+h[c>>2];A=+h[c+16>>2];T=+h[c+32>>2];C=+h[c+4>>2];w=+h[c+20>>2];x=+h[c+36>>2];b=+h[c+8>>2];m=+h[c+24>>2];p=+h[c+40>>2];S=-+h[c+48>>2];v=-+h[c+52>>2];y=-+h[c+56>>2];c=r[a+12>>2]|0;F=+h[c>>2];O=+h[c+16>>2];k=+h[c+32>>2];D=+h[c+4>>2];L=+h[c+20>>2];P=+h[c+36>>2];I=+h[c+8>>2];R=+h[c+24>>2];M=+h[c+40>>2];g=+h[c+48>>2];f=+h[c+52>>2];d=+h[c+56>>2];h[l>>2]=E*F+A*O+T*k;h[l+4>>2]=E*D+A*L+T*P;h[l+8>>2]=E*I+A*R+T*M;h[l+12>>2]=0.0;h[l+16>>2]=C*F+w*O+x*k;h[l+20>>2]=C*D+w*L+x*P;h[l+24>>2]=C*I+w*R+x*M;h[l+28>>2]=0.0;h[l+32>>2]=b*F+m*O+p*k;h[l+36>>2]=b*D+m*L+p*P;h[l+40>>2]=b*I+m*R+p*M;h[l+44>>2]=0.0;h[l+48>>2]=E*S+A*v+T*y+(E*g+A*f+T*d);h[l+52>>2]=C*S+w*v+x*y+(C*g+w*f+x*d);h[l+56>>2]=b*S+m*v+p*y+(b*g+m*f+p*d);h[l+60>>2]=0.0;c=r[(r[t+16>>2]|0)+4>>2]|0;jk[r[(r[c>>2]|0)+8>>2]&127](c,l,t+24|0,t+40|0);h[t+40>>2]=+h[t+40>>2]+u;h[t+44>>2]=+h[t+44>>2]+u;h[t+48>>2]=+h[t+48>>2]+u;h[t+24>>2]=+h[t+24>>2]-u;h[t+28>>2]=+h[t+28>>2]-u;h[t+32>>2]=+h[t+32>>2]-u;c=r[t+76>>2]|0;s=r[e+8>>2]|0;r[c+740>>2]=r[a+8>>2];r[c+744>>2]=s;jk[r[(r[i>>2]|0)+64>>2]&127](i,t+12|0,t+24|0,t+40|0);i=r[o+4>>2]|0;do{if(r[i+748>>2]|0){a=r[i+740>>2]|0;s=r[(r[o+8>>2]|0)+8>>2]|0;e=r[(r[o+12>>2]|0)+8>>2]|0;if((a|0)==(s|0)){uS(i,a+4|0,e+4|0);break}else{uS(i,e+4|0,s+4|0);break}}}while(0);r[t+16>>2]=0;r[t+20>>2]=0;_=l;return}function mM(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,W=0.0,G=0.0,j=0.0,H=0.0,X=0.0,Y=0.0,q=0,K=0.0,Z=0.0;q=_;_=_+240|0;s=(n[t+8>>0]|0)!=0;o=s?i:e;s=s?e:i;j=+h[o+116>>2]-+h[o+52>>2];H=+h[o+120>>2]-+h[o+56>>2];X=+h[o+124>>2]-+h[o+60>>2];Y=+h[o+256>>2];if(j*j+H*H+X*X<Y*Y){K=1.0;_=q;return+K}P=+h[s+4>>2];L=+h[s+20>>2];D=+h[s+36>>2];k=+h[s+8>>2];O=+h[s+24>>2];F=+h[s+40>>2];B=+h[s+12>>2];N=+h[s+28>>2];U=+h[s+44>>2];l=-+h[s+52>>2];c=-+h[s+56>>2];u=-+h[s+60>>2];V=+h[o+4>>2];z=+h[o+20>>2];W=+h[o+36>>2];G=+h[o+8>>2];j=+h[o+24>>2];H=+h[o+40>>2];X=+h[o+12>>2];Y=+h[o+28>>2];f=+h[o+44>>2];v=+h[o+52>>2];y=+h[o+56>>2];b=+h[o+60>>2];m=P*l+L*c+D*u+(P*v+L*y+D*b);g=k*l+O*c+F*u+(k*v+O*y+F*b);b=B*l+N*c+U*u+(B*v+N*y+U*b);y=+h[o+68>>2];v=+h[o+84>>2];S=+h[o+100>>2];x=+h[o+72>>2];w=+h[o+88>>2];C=+h[o+104>>2];T=+h[o+76>>2];A=+h[o+92>>2];E=+h[o+108>>2];d=+h[o+116>>2];p=+h[o+120>>2];I=+h[o+124>>2];M=P*l+L*c+D*u+(P*d+L*p+D*I);R=k*l+O*c+F*u+(k*d+O*p+F*I);I=B*l+N*c+U*u+(B*d+N*p+U*I);s=r[s+192>>2]|0;if(((r[s+4>>2]|0)+-21|0)>>>0>=9){K=1.0;_=q;return+K}h[q+224>>2]=m;h[q+224+4>>2]=g;h[q+224+8>>2]=b;h[q+224+12>>2]=0.0;if(M<m){h[q+224>>2]=M;a=M}else a=m;if(R<g){h[q+224+4>>2]=R;l=R}else l=g;if(I<b){h[q+224+8>>2]=I;c=I}else c=b;h[q+208>>2]=m;h[q+208+4>>2]=g;h[q+208+8>>2]=b;h[q+208+12>>2]=0.0;if(m<M){h[q+208>>2]=M;u=M}else u=m;if(g<R){h[q+208+4>>2]=R;d=R}else d=g;if(b<I){h[q+208+8>>2]=I;p=I}else p=b;Z=+h[o+252>>2];h[q+224>>2]=a-Z;h[q+224+4>>2]=l-Z;h[q+224+8>>2]=c-Z;h[q+208>>2]=Z+u;h[q+208+4>>2]=Z+d;h[q+208+8>>2]=Z+p;r[q>>2]=3904;h[q+4>>2]=P*V+L*z+D*W;h[q+8>>2]=P*G+L*j+D*H;h[q+12>>2]=P*X+L*Y+D*f;h[q+16>>2]=0.0;h[q+20>>2]=k*V+O*z+F*W;h[q+24>>2]=k*G+O*j+F*H;h[q+28>>2]=k*X+O*Y+F*f;h[q+32>>2]=0.0;h[q+36>>2]=B*V+N*z+U*W;h[q+40>>2]=B*G+N*j+U*H;h[q+44>>2]=B*X+N*Y+U*f;h[q+48>>2]=0.0;h[q+52>>2]=m;h[q+56>>2]=g;h[q+60>>2]=b;h[q+64>>2]=0.0;h[q+68>>2]=P*y+L*v+D*S;h[q+72>>2]=P*x+L*w+D*C;h[q+76>>2]=P*T+L*A+D*E;h[q+80>>2]=0.0;h[q+84>>2]=k*y+O*v+F*S;h[q+88>>2]=k*x+O*w+F*C;h[q+92>>2]=k*T+O*A+F*E;h[q+96>>2]=0.0;h[q+100>>2]=B*y+N*v+U*S;h[q+104>>2]=B*x+N*w+U*C;h[q+108>>2]=B*T+N*A+U*E;h[q+112>>2]=0.0;h[q+116>>2]=M;h[q+120>>2]=R;h[q+124>>2]=I;h[q+128>>2]=0.0;h[q+196>>2]=Z;r[q+200>>2]=r[o+248>>2];if(s|0?(jk[r[(r[s>>2]|0)+64>>2]&127](s,q,q+224|0,q+208|0),K=+h[q+200>>2],K<+h[o+248>>2]):0){h[o+248>>2]=K;Z=K;_=q;return+Z}Z=1.0;_=q;return+Z}function gM(t){t=t|0;Ql(t);return}function bM(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0.0;s=_;_=_+784|0;r[s+720>>2]=1065353216;r[s+720+4>>2]=0;r[s+720+4+4>>2]=0;r[s+720+4+8>>2]=0;r[s+720+4+12>>2]=0;r[s+720+20>>2]=1065353216;r[s+720+24>>2]=0;r[s+720+24+4>>2]=0;r[s+720+24+8>>2]=0;r[s+720+24+12>>2]=0;r[s+720+40>>2]=1065353216;i=s+720+44|0;r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;r[i+12>>2]=0;r[i+16>>2]=0;r[s+544>>2]=3316;r[s+544+168>>2]=0;h[s+544+172>>2]=0.0;r[s+544+164>>2]=r[t+200>>2];i=r[t+196>>2]|0;r[s+488+8>>2]=0;r[s+488+12>>2]=-1;r[s+488+16>>2]=1065353216;r[s+488+20>>2]=1065353216;r[s+488+24>>2]=1065353216;h[s+488+28>>2]=0.0;r[s+488>>2]=6380;r[s+488+4>>2]=8;r[s+488+32>>2]=i;r[s+488+48>>2]=i;r[s+376+8>>2]=0;r[s+376+12>>2]=-1;r[s+376+16>>2]=1065353216;r[s+376+20>>2]=1065353216;r[s+376+24>>2]=1065353216;h[s+376+28>>2]=0.0;h[s+376+48>>2]=.03999999910593033;r[s+376+56>>2]=0;r[s+376>>2]=3768;r[s+376+4>>2]=1;r[s+376+60>>2]=r[e>>2];r[s+376+60+4>>2]=r[e+4>>2];r[s+376+60+8>>2]=r[e+8>>2];r[s+376+60+12>>2]=r[e+12>>2];r[s+376+76>>2]=r[e+16>>2];r[s+376+76+4>>2]=r[e+16+4>>2];r[s+376+76+8>>2]=r[e+16+8>>2];r[s+376+76+12>>2]=r[e+16+12>>2];r[s+376+92>>2]=r[e+32>>2];r[s+376+92+4>>2]=r[e+32+4>>2];r[s+376+92+8>>2]=r[e+32+8>>2];r[s+376+92+12>>2]=r[e+32+12>>2];h[s+16+308>>2]=9.999999747378752e-05;n[s+16+332>>0]=0;r[s>>2]=7024;r[s+4>>2]=s+16;r[s+8>>2]=s+488;r[s+12>>2]=s+376;if(yS(s,t+4|0,t+68|0,s+720|0,s+720|0,s+544|0)|0?(o=+h[s+544+164>>2],+h[t+200>>2]>o):0)h[t+200>>2]=o;r[s+376>>2]=6248;i=r[s+376+56>>2]|0;if(!i){_=s;return}ok[r[r[i>>2]>>2]&255](i);i=r[s+376+56>>2]|0;if(!i){_=s;return}r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0);_=s;return}function yM(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0;i=r[t+76>>2]|0;if(!i)return;s=r[e+4>>2]|0;if((s|0)==(r[e+8>>2]|0)?(a=s|0?s<<1:1,(s|0)<(a|0)):0){if(!a)i=0;else{r[5637]=(r[5637]|0)+1;i=Zl((a<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}s=r[e+4>>2]|0}if((s|0)>0){o=0;do{r[i+(o<<2)>>2]=r[(r[e+12>>2]|0)+(o<<2)>>2];o=o+1|0}while((o|0)!=(s|0))}o=r[e+12>>2]|0;if(o){if(n[e+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0);s=r[e+4>>2]|0}r[e+12>>2]=0}n[e+16>>0]=1;r[e+12>>2]=i;r[e+8>>2]=a;i=r[t+76>>2]|0}r[(r[e+12>>2]|0)+(s<<2)>>2]=i;r[e+4>>2]=s+1;return}function vM(t){t=t|0;return}function SM(t){t=t|0;Ql(t);return}function xM(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0,l=0;s=r[e>>2]|0;s=Rk[r[(r[s>>2]|0)+56>>2]&31](s,36)|0;o=r[e+4>>2]|0;l=r[t+12>>2]|0;a=r[t+8>>2]|0;i=r[t+16>>2]|0;t=r[t+20>>2]|0;r[s+4>>2]=r[e>>2];r[s>>2]=3944;r[s+8>>2]=l;r[s+12>>2]=a;n[s+16>>0]=0;r[s+20>>2]=o;n[s+24>>0]=0;r[s+28>>2]=i;r[s+32>>2]=t;return s|0}function wM(t){t=t|0;var e=0;r[t>>2]=3944;if(!(n[t+16>>0]|0))return;e=r[t+20>>2]|0;if(!e)return;t=r[t+4>>2]|0;lk[r[(r[t>>2]|0)+16>>2]&127](t,e);return}function CM(t){t=t|0;var e=0,i=0;r[t>>2]=3944;if(!(n[t+16>>0]|0)){Ql(t);return}e=r[t+20>>2]|0;if(!e){Ql(t);return}i=r[t+4>>2]|0;lk[r[(r[i>>2]|0)+16>>2]&127](i,e);Ql(t);return}function TM(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0,l=0,c=0,u=0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0,w=0.0,C=0.0,T=0.0,A=0,E=0.0,M=0.0,R=0.0,I=0,P=0.0,L=0,D=0,k=0,O=0.0,F=0,B=0.0,N=0.0,U=0.0,V=0.0,z=0,j=0,Y=0,q=0,K=0,Z=0,Q=0,$=0,J=0,tt=0,et=0.0,it=0.0,nt=0.0,st=0.0,rt=0,ot=0,at=0,lt=0,ht=0,ct=0.0,_t=0.0,ut=0.0,dt=0,pt=0.0,ft=0,mt=0,gt=0,bt=0,yt=0.0,vt=0.0;bt=_;_=_+688|0;l=r[t+20>>2]|0;if(!l){l=r[t+4>>2]|0;l=yk[r[(r[l>>2]|0)+12>>2]&63](l,r[e+8>>2]|0,r[i+8>>2]|0)|0;r[t+20>>2]=l;n[t+16>>0]=1}r[o+4>>2]=l;ft=r[e+4>>2]|0;mt=r[i+4>>2]|0;a=r[ft+4>>2]|0;c=r[mt+4>>2]|0;if((a|0)==10&(c|0)==10){N=+h[l+752>>2];dt=r[ft+56>>2]|0;b=+h[ft+32+(dt<<2)>>2];B=+h[ft+32+(((dt+2|0)%3|0)<<2)>>2];gt=r[mt+56>>2]|0;y=+h[mt+32+(gt<<2)>>2];O=+h[mt+32+(((gt+2|0)%3|0)<<2)>>2];t=r[e+12>>2]|0;a=r[i+12>>2]|0;M=+h[t+(dt<<2)>>2];P=+h[t+16+(dt<<2)>>2];R=+h[t+32+(dt<<2)>>2];m=+h[a+(gt<<2)>>2];g=+h[a+16+(gt<<2)>>2];w=+h[a+32+(gt<<2)>>2];C=+h[a+48>>2]-+h[t+48>>2];T=+h[a+52>>2]-+h[t+52>>2];E=+h[a+56>>2]-+h[t+56>>2];p=1.0-(M*m+P*g+R*w)*(M*m+P*g+R*w);if(!(p==0.0)){p=(M*C+P*T+R*E-(M*m+P*g+R*w)*(m*C+g*T+w*E))/p;if(!(p<-b)){if(p>b)p=b}else p=-b}else p=0.0;f=(M*m+P*g+R*w)*p-(m*C+g*T+w*E);if(f<-y){p=(M*m+P*g+R*w)*-y+(M*C+P*T+R*E);if(!(p<-b))if(p>b){p=b;f=-y}else f=-y;else{p=-b;f=-y}}else if(f>y){p=y*(M*m+P*g+R*w)+(M*C+P*T+R*E);if(!(p<-b))if(p>b){p=b;f=y}else f=y;else{p=-b;f=y}}S=m*f;v=g*f;y=w*f;f=S+(C-M*p);g=v+(T-P*p);p=y+(E-R*p);b=+G(+(p*p+(f*f+g*g)));if(!(b-B-O>N)){do{if(p*p+(f*f+g*g)<=1.4210854715202004e-14)if(+W(+R)>.7071067690849304){p=1.0/+G(+(P*P+R*R));h[bt+280>>2]=0.0;h[bt+280+4>>2]=-(R*p);h[bt+280+8>>2]=P*p;m=0.0;f=-(R*p);p=P*p;break}else{f=1.0/+G(+(M*M+P*P));h[bt+280>>2]=-(P*f);h[bt+280+4>>2]=M*f;h[bt+280+8>>2]=0.0;m=-(P*f);f=M*f;p=0.0;break}else{h[bt+280>>2]=f*-(1.0/b);h[bt+280+4>>2]=g*-(1.0/b);h[bt+280+8>>2]=p*-(1.0/b);h[bt+280+12>>2]=0.0;m=f*-(1.0/b);f=g*-(1.0/b);p=p*-(1.0/b)}}while(0);ut=O*f+(v+ +h[a+52>>2]);pt=O*p+(y+ +h[a+56>>2]);h[bt+264>>2]=O*m+(S+ +h[a+48>>2]);h[bt+264+4>>2]=ut;h[bt+264+8>>2]=pt;h[bt+264+12>>2]=0.0}if(b-B-O<N){Uk[r[(r[o>>2]|0)+16>>2]&15](o,bt+280|0,bt+264|0,b-B-O);l=r[o+4>>2]|0}if(!(r[l+748>>2]|0)){_=bt;return}c=r[l+740>>2]|0;u=r[(r[o+8>>2]|0)+8>>2]|0;a=r[(r[o+12>>2]|0)+8>>2]|0;if((c|0)==(u|0)){uS(l,c+4|0,a+4|0);_=bt;return}else{uS(l,a+4|0,u+4|0);_=bt;return}}h[bt+128+128>>2]=999999984306749440.0;I=r[t+8>>2]|0;x=r[t+12>>2]|0;r[bt+48>>2]=6928;r[bt+48+4>>2]=0;r[bt+48+8>>2]=1065353216;r[bt+48+12>>2]=0;h[bt+48+16>>2]=0.0;r[bt+48+20>>2]=x;r[bt+48+24>>2]=I;r[bt+48+28>>2]=ft;r[bt+48+32>>2]=mt;r[bt+48+36>>2]=a;r[bt+48+40>>2]=c;h[bt+48+44>>2]=+xk[r[(r[ft>>2]|0)+48>>2]&15](ft);h[bt+48+48>>2]=+xk[r[(r[mt>>2]|0)+48>>2]&15](mt);n[bt+48+52>>0]=0;r[bt+48+60>>2]=-1;r[bt+48+72>>2]=1;r[bt+48+76>>2]=1;r[bt+48+28>>2]=ft;r[bt+48+32>>2]=mt;ut=+xk[r[(r[ft>>2]|0)+48>>2]&15](ft);pt=+xk[r[(r[mt>>2]|0)+48>>2]&15](mt);pt=ut+pt+ +h[(r[t+20>>2]|0)+752>>2];h[bt+128+128>>2]=pt*pt;I=r[e+12>>2]|0;r[bt+128>>2]=r[I>>2];r[bt+128+4>>2]=r[I+4>>2];r[bt+128+8>>2]=r[I+8>>2];r[bt+128+12>>2]=r[I+12>>2];c=bt+128+16|0;r[c>>2]=r[I+16>>2];r[c+4>>2]=r[I+16+4>>2];r[c+8>>2]=r[I+16+8>>2];r[c+12>>2]=r[I+16+12>>2];x=bt+128+32|0;r[x>>2]=r[I+32>>2];r[x+4>>2]=r[I+32+4>>2];r[x+8>>2]=r[I+32+8>>2];r[x+12>>2]=r[I+32+12>>2];A=bt+128+48|0;r[A>>2]=r[I+48>>2];r[A+4>>2]=r[I+48+4>>2];r[A+8>>2]=r[I+48+8>>2];r[A+12>>2]=r[I+48+12>>2];I=bt+128+64|0;a=r[i+12>>2]|0;r[I>>2]=r[a>>2];r[I+4>>2]=r[a+4>>2];r[I+8>>2]=r[a+8>>2];r[I+12>>2]=r[a+12>>2];L=bt+128+80|0;r[L>>2]=r[a+16>>2];r[L+4>>2]=r[a+16+4>>2];r[L+8>>2]=r[a+16+8>>2];r[L+12>>2]=r[a+16+12>>2];D=bt+128+96|0;r[D>>2]=r[a+32>>2];r[D+4>>2]=r[a+32+4>>2];r[D+8>>2]=r[a+32+8>>2];r[D+12>>2]=r[a+32+12>>2];k=bt+128+112|0;r[k>>2]=r[a+48>>2];r[k+4>>2]=r[a+48+4>>2];r[k+8>>2]=r[a+48+8>>2];r[k+12>>2]=r[a+48+12>>2];a=r[ft+4>>2]|0;if((a|0)<7?(u=r[mt+4>>2]|0,(u|0)<7):0){r[bt+40>>2]=3972;if(!a){a=u;f=0.0}else{f=+xk[r[(r[ft>>2]|0)+48>>2]&15](ft);a=r[mt+4>>2]|0}if(!a)p=0.0;else p=+xk[r[(r[mt>>2]|0)+48>>2]&15](mt);r[bt>>2]=4e3;r[bt+4>>2]=o;h[bt+24>>2]=f;h[bt+28>>2]=p;n[bt+36>>0]=0;lt=r[ft+56>>2]|0;t:do{if(lt|0){ht=r[mt+56>>2]|0;do{if(!ht){if((r[mt+4>>2]|0)!=1)break t;A=bt+624+16|0;n[A>>0]=1;I=bt+624+12|0;r[I>>2]=0;x=bt+624+4|0;r[x>>2]=0;u=bt+624+8|0;r[u>>2]=0;a=r[i+12>>2]|0;ut=+h[mt+60>>2];pt=+h[mt+60+4>>2];m=+h[mt+60+8>>2];p=ut*+h[a>>2]+pt*+h[a+4>>2]+m*+h[a+8>>2]+ +h[a+48>>2];f=ut*+h[a+16>>2]+pt*+h[a+20>>2]+m*+h[a+24>>2]+ +h[a+52>>2];m=ut*+h[a+32>>2]+pt*+h[a+36>>2]+m*+h[a+40>>2]+ +h[a+56>>2];r[5637]=(r[5637]|0)+1;a=Zl(35)|0;if(!a)l=0;else{r[(a+4+15&-16)+-4>>2]=a;l=a+4+15&-16}a=r[I>>2]|0;if(!a)a=0;else{r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0);a=r[x>>2]|0;r[I>>2]=0}n[A>>0]=1;r[I>>2]=l;r[u>>2]=1;h[l+(a<<4)>>2]=p;h[l+(a<<4)+4>>2]=f;h[l+(a<<4)+8>>2]=m;h[l+(a<<4)+12>>2]=0.0;a=(r[x>>2]|0)+1|0;r[x>>2]=a;gt=r[i+12>>2]|0;ut=+h[mt+60+16>>2];pt=+h[mt+60+20>>2];m=+h[mt+60+24>>2];p=ut*+h[gt>>2]+pt*+h[gt+4>>2]+m*+h[gt+8>>2]+ +h[gt+48>>2];f=ut*+h[gt+16>>2]+pt*+h[gt+20>>2]+m*+h[gt+24>>2]+ +h[gt+52>>2];m=ut*+h[gt+32>>2]+pt*+h[gt+36>>2]+m*+h[gt+40>>2]+ +h[gt+56>>2];if((a|0)==(r[u>>2]|0)?(F=a|0?a<<1:1,(a|0)<(F|0)):0){if(!F)c=0;else{r[5637]=(r[5637]|0)+1;a=Zl((F<<4|3)+16|0)|0;if(!a)a=0;else{r[(a+4+15&-16)+-4>>2]=a;a=a+4+15&-16}c=a;a=r[x>>2]|0}if((a|0)>0){l=0;do{gt=c+(l<<4)|0;dt=(r[I>>2]|0)+(l<<4)|0;r[gt>>2]=r[dt>>2];r[gt+4>>2]=r[dt+4>>2];r[gt+8>>2]=r[dt+8>>2];r[gt+12>>2]=r[dt+12>>2];l=l+1|0}while((l|0)!=(a|0))}a=r[I>>2]|0;if(a|0){if(n[A>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[I>>2]=0}n[A>>0]=1;r[I>>2]=c;r[u>>2]=F;a=r[x>>2]|0}gt=r[I>>2]|0;h[gt+(a<<4)>>2]=p;h[gt+(a<<4)+4>>2]=f;h[gt+(a<<4)+8>>2]=m;h[gt+(a<<4)+12>>2]=0.0;a=(r[x>>2]|0)+1|0;r[x>>2]=a;gt=r[i+12>>2]|0;ut=+h[mt+60+32>>2];pt=+h[mt+60+36>>2];m=+h[mt+60+40>>2];p=ut*+h[gt>>2]+pt*+h[gt+4>>2]+m*+h[gt+8>>2]+ +h[gt+48>>2];f=ut*+h[gt+16>>2]+pt*+h[gt+20>>2]+m*+h[gt+24>>2]+ +h[gt+52>>2];m=ut*+h[gt+32>>2]+pt*+h[gt+36>>2]+m*+h[gt+40>>2]+ +h[gt+56>>2];if((a|0)==(r[u>>2]|0)?(z=a|0?a<<1:1,(a|0)<(z|0)):0){if(!z)c=0;else{r[5637]=(r[5637]|0)+1;a=Zl((z<<4|3)+16|0)|0;if(!a)a=0;else{r[(a+4+15&-16)+-4>>2]=a;a=a+4+15&-16}c=a;a=r[x>>2]|0}if((a|0)>0){l=0;do{gt=c+(l<<4)|0;i=(r[I>>2]|0)+(l<<4)|0;r[gt>>2]=r[i>>2];r[gt+4>>2]=r[i+4>>2];r[gt+8>>2]=r[i+8>>2];r[gt+12>>2]=r[i+12>>2];l=l+1|0}while((l|0)!=(a|0))}a=r[I>>2]|0;if(a|0){if(n[A>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[I>>2]=0}n[A>>0]=1;r[I>>2]=c;r[u>>2]=z;a=r[x>>2]|0}gt=r[I>>2]|0;h[gt+(a<<4)>>2]=p;h[gt+(a<<4)+4>>2]=f;h[gt+(a<<4)+8>>2]=m;h[gt+(a<<4)+12>>2]=0.0;r[x>>2]=(r[x>>2]|0)+1;g=+h[(r[t+20>>2]|0)+752>>2];nS(bt+48|0,bt+128|0,bt+40|0,r[s+20>>2]|0,0);p=+h[bt+48+4>>2];f=+h[bt+48+8>>2];m=+h[bt+48+12>>2];if(p*p+f*f+m*m>1.1920928955078125e-07){ut=1.0/(p*p+f*f+m*m);h[bt+384>>2]=p*ut;h[bt+384+4>>2]=f*ut;h[bt+384+8>>2]=m*ut;h[bt+384+12>>2]=0.0;ut=+h[bt+48+56>>2];pt=+xk[r[(r[ft>>2]|0)+48>>2]&15](ft);pt=ut-pt-+xk[r[(r[mt>>2]|0)+48>>2]&15](mt);pS(bt+384|0,r[ft+56>>2]|0,r[e+12>>2]|0,bt+624|0,pt-g,g,o)}do{if(n[t+16>>0]|0?(j=r[o+4>>2]|0,r[j+748>>2]|0):0){l=r[j+740>>2]|0;c=r[(r[o+8>>2]|0)+8>>2]|0;a=r[(r[o+12>>2]|0)+8>>2]|0;if((l|0)==(c|0)){uS(j,l+4|0,a+4|0);break}else{uS(j,a+4|0,c+4|0);break}}}while(0);a=r[I>>2]|0;if(a|0){if(n[A>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[I>>2]=0}}else{pt=+h[(r[t+20>>2]|0)+752>>2];e:do{if(!(n[s+24>>0]|0)){nS(bt+48|0,bt+128|0,bt,r[s+20>>2]|0,0);p=+h[bt+32>>2];if(p<0.0&(n[bt+36>>0]|0)!=0){m=+h[bt+8>>2];g=+h[bt+16>>2];a=r[bt+20>>2]|0;f=+h[bt+12>>2];dt=111}}else{ot=r[e+12>>2]|0;at=r[i+12>>2]|0;r[5297]=(r[5297]|0)+1;V=+h[lt+64>>2];et=+h[lt+68>>2];p=+h[ot+4>>2];it=+h[lt+72>>2];f=+h[ot+8>>2];m=+h[ot+16>>2];g=+h[ot+20>>2];b=+h[ot+24>>2];y=+h[ot+32>>2];v=+h[ot+36>>2];S=+h[ot+40>>2];nt=+h[ht+64>>2];st=+h[ht+68>>2];ut=+h[ht+72>>2];ct=V*+h[ot>>2]+et*p+it*f+ +h[ot+48>>2]-(nt*+h[at>>2]+st*+h[at+4>>2]+ut*+h[at+8>>2]+ +h[at+48>>2]);_t=V*m+et*g+it*b+ +h[ot+52>>2]-(nt*+h[at+16>>2]+st*+h[at+20>>2]+ut*+h[at+24>>2]+ +h[at+52>>2]);ut=V*y+et*v+it*S+ +h[ot+56>>2]-(nt*+h[at+32>>2]+st*+h[at+36>>2]+ut*+h[at+40>>2]+ +h[at+56>>2]);c=r[lt+28>>2]|0;i:do{if((c|0)>0){E=f;M=m;T=g;R=0.0;P=3402823466385288598117041.0e14;l=0;m=0.0;g=0.0;f=0.0;while(1){rt=r[lt+36>>2]|0;it=+h[rt+(l*36|0)+20>>2];nt=+h[rt+(l*36|0)+24>>2];st=+h[rt+(l*36|0)+28>>2];w=it*+h[ot>>2]+nt*p+st*E;b=it*M+nt*T+st*b;p=it*y+nt*v+st*S;h[bt+296>>2]=w;h[bt+296+4>>2]=b;h[bt+296+8>>2]=p;h[bt+296+12>>2]=0.0;if(ct*w+_t*b+ut*p<0.0){h[bt+296>>2]=-w;h[bt+296+4>>2]=-b;h[bt+296+8>>2]=-p;C=-w;b=-b;p=-p}else C=w;r[5295]=(r[5295]|0)+1;if(dS(ot,at,ct,_t,ut,C,b,p,lt,ht,P)|0){r[5296]=(r[5296]|0)+1;CT(lt,ot,bt+296|0,bt+624|0,bt+384|0,bt+360|0,bt+344|0);CT(ht,at,bt+296|0,bt+380|0,bt+376|0,bt+328|0,bt+312|0);y=+h[bt+384>>2];v=+h[bt+380>>2];do{if(y<v){a=0;v=R}else{S=+h[bt+376>>2];w=+h[bt+624>>2];if(S<w){a=0;v=R;break}a=1;v=y-v<S-w?y-v:S-w}}while(0);if(!a)break;if(v<P){y=v;m=C;g=p;f=b}else y=P;C=v;w=y}else{C=R;w=P}a=l+1|0;if((a|0)>=(c|0)){p=w;break i}p=+h[ot+4>>2];E=+h[ot+8>>2];M=+h[ot+16>>2];T=+h[ot+20>>2];b=+h[ot+24>>2];y=+h[ot+32>>2];v=+h[ot+36>>2];S=+h[ot+40>>2];R=C;P=w;l=a}break e}else{p=3402823466385288598117041.0e14;m=0.0;g=0.0;f=0.0}}while(0);c=r[ht+28>>2]|0;i:do{if((c|0)>0){E=0.0;l=0;while(1){rt=r[ht+36>>2]|0;nt=+h[rt+(l*36|0)+20>>2];st=+h[rt+(l*36|0)+24>>2];v=+h[rt+(l*36|0)+28>>2];b=nt*+h[at>>2]+st*+h[at+4>>2]+v*+h[at+8>>2];y=nt*+h[at+16>>2]+st*+h[at+20>>2]+v*+h[at+24>>2];v=nt*+h[at+32>>2]+st*+h[at+36>>2]+v*+h[at+40>>2];h[bt+296>>2]=b;h[bt+296+4>>2]=y;h[bt+296+8>>2]=v;h[bt+296+12>>2]=0.0;if(ct*b+_t*y+ut*v<0.0){h[bt+296>>2]=-b;h[bt+296+4>>2]=-y;h[bt+296+8>>2]=-v;b=-b;y=-y;v=-v}r[5295]=(r[5295]|0)+1;if(dS(ot,at,ct,_t,ut,b,y,v,lt,ht,p)|0){r[5296]=(r[5296]|0)+1;CT(lt,ot,bt+296|0,bt+624|0,bt+384|0,bt+360|0,bt+344|0);CT(ht,at,bt+296|0,bt+380|0,bt+376|0,bt+328|0,bt+312|0);S=+h[bt+384>>2];w=+h[bt+380>>2];do{if(S<w){a=0;S=E}else{C=+h[bt+376>>2];T=+h[bt+624>>2];if(C<T){a=0;S=E;break}a=1;S=S-w<C-T?S-w:C-T}}while(0);if(!a)break;if(S<p){p=S;m=b;g=v;f=y}}else S=E;l=l+1|0;if((l|0)>=(c|0))break i;else E=S}break e}}while(0);a=r[lt+48>>2]|0;i:do{if((a|0)>0){Y=r[ht+48>>2]|0;b=0.0;rt=0;L=-1;I=-1;D=0;k=0;F=0;z=0;j=0;s=0;u=0;x=0;A=0;q=0;l=0;c=0;N=0.0;U=0.0;V=0.0;S=0.0;w=0.0;O=0.0;n:while(1){tt=r[lt+56>>2]|0;B=+h[tt+(rt<<4)>>2];et=+h[tt+(rt<<4)+4>>2];st=+h[tt+(rt<<4)+8>>2];it=B*+h[ot>>2]+et*+h[ot+4>>2]+st*+h[ot+8>>2];nt=B*+h[ot+16>>2]+et*+h[ot+20>>2]+st*+h[ot+24>>2];st=B*+h[ot+32>>2]+et*+h[ot+36>>2]+st*+h[ot+40>>2];if((Y|0)>0){R=b;Y=0;et=m;B=g;P=f;while(1){tt=r[ht+56>>2]|0;v=+h[tt+(Y<<4)>>2];C=+h[tt+(Y<<4)+4>>2];M=+h[tt+(Y<<4)+8>>2];T=v*+h[at>>2]+C*+h[at+4>>2]+M*+h[at+8>>2];E=v*+h[at+16>>2]+C*+h[at+20>>2]+M*+h[at+24>>2];M=v*+h[at+32>>2]+C*+h[at+36>>2]+M*+h[at+40>>2];h[bt+296>>2]=nt*M-st*E;h[bt+296+4>>2]=st*T-it*M;h[bt+296+8>>2]=it*E-nt*T;h[bt+296+12>>2]=0.0;do{if(!(+W(+(nt*M-st*E))>1.0e-06)){if(+W(+(st*T-it*M))>1.0e-06){dt=75;break}if(!(+W(+(it*E-nt*T))>1.0e-06)){y=R;m=et;g=B;f=P;K=D;Z=k;Q=F;$=z;J=j;tt=s}else dt=75}else dt=75}while(0);do{if((dt|0)==75){dt=0;g=1.0/+G(+((nt*M-st*E)*(nt*M-st*E)+(st*T-it*M)*(st*T-it*M)+(it*E-nt*T)*(it*E-nt*T)));m=(nt*M-st*E)*g;h[bt+296>>2]=m;f=(st*T-it*M)*g;h[bt+296+4>>2]=f;g=(it*E-nt*T)*g;h[bt+296+8>>2]=g;if(m*ct+f*_t+ut*g<0.0){h[bt+296>>2]=-m;h[bt+296+4>>2]=-f;h[bt+296+8>>2]=-g;m=-m;f=-f;g=-g}r[5295]=(r[5295]|0)+1;if(!(dS(ot,at,ct,_t,ut,m,f,g,lt,ht,p)|0)){y=R;m=et;g=B;f=P;K=D;Z=k;Q=F;$=z;J=j;tt=s;break}r[5296]=(r[5296]|0)+1;CT(lt,ot,bt+296|0,bt+624|0,bt+384|0,bt+360|0,bt+344|0);CT(ht,at,bt+296|0,bt+380|0,bt+376|0,bt+328|0,bt+312|0);b=+h[bt+384>>2];y=+h[bt+380>>2];do{if(!(b<y)){v=+h[bt+376>>2];C=+h[bt+624>>2];if(v<C){a=0;b=R;break}if(b-y<v-C){a=1;b=b-y;D=r[bt+344>>2]|0;k=r[bt+344+4>>2]|0;F=r[bt+344+8>>2]|0;z=r[bt+328>>2]|0;j=r[bt+328+4>>2]|0;s=r[bt+328+8>>2]|0;break}else{a=1;b=v-C;D=r[bt+360>>2]|0;k=r[bt+360+4>>2]|0;F=r[bt+360+8>>2]|0;z=r[bt+312>>2]|0;j=r[bt+312+4>>2]|0;s=r[bt+312+8>>2]|0;break}}else{a=0;b=R}}while(0);if(!a)break n;if(!(b<p)){y=b;m=et;g=B;f=P;K=D;Z=k;Q=F;$=z;J=j;tt=s;break}y=b;p=b;L=rt;I=Y;K=D;Z=k;Q=F;$=z;J=j;tt=s;u=D;x=k;A=F;q=z;l=j;c=s;N=it;U=nt;V=st;S=T;w=E;O=M}}while(0);Y=Y+1|0;a=r[ht+48>>2]|0;if((Y|0)>=(a|0))break;else{R=y;et=m;B=g;P=f;D=K;k=Z;F=Q;z=$;j=J;s=tt}}Y=a;a=r[lt+48>>2]|0;b=y;D=K;k=Z;F=Q;z=$;j=J;s=tt}rt=rt+1|0;if((rt|0)>=(a|0)){a=q;break i}}break e}else{L=-1;I=-1;u=0;x=0;A=0;a=0;l=0;c=0;N=0.0;U=0.0;V=0.0;S=0.0;w=0.0;O=0.0}}while(0);if((I|L|0)>-1){B=(r[d>>2]=a,+h[d>>2]);M=B-(r[d>>2]=u,+h[d>>2]);P=(r[d>>2]=l,+h[d>>2]);E=P-(r[d>>2]=x,+h[d>>2]);R=(r[d>>2]=c,+h[d>>2]);T=R-(r[d>>2]=A,+h[d>>2]);b=S*N+w*U+O*V;y=M*N+E*U+T*V;p=M*S+E*w+T*O;do{if(1.0-b*b==0.0)v=0.0;else{if((y-p*b)/(1.0-b*b)<-1000000015047466219876688.0e6){v=-1000000015047466219876688.0e6;break}if(!((y-p*b)/(1.0-b*b)>1000000015047466219876688.0e6)){v=(y-p*b)/(1.0-b*b);break}v=1000000015047466219876688.0e6}}while(0);p=b*v-p;do{if(p<-1000000015047466219876688.0e6){if(y-b*1000000015047466219876688.0e6<-1000000015047466219876688.0e6){b=-1000000015047466219876688.0e6;p=-1000000015047466219876688.0e6;break}if(!(y-b*1000000015047466219876688.0e6>1000000015047466219876688.0e6)){b=y-b*1000000015047466219876688.0e6;p=-1000000015047466219876688.0e6;break}b=1000000015047466219876688.0e6;p=-1000000015047466219876688.0e6}else{if(!(p>1000000015047466219876688.0e6)){b=v;break}if(y+b*1000000015047466219876688.0e6<-1000000015047466219876688.0e6){b=-1000000015047466219876688.0e6;p=1000000015047466219876688.0e6;break}if(!(y+b*1000000015047466219876688.0e6>1000000015047466219876688.0e6)){b=y+b*1000000015047466219876688.0e6;p=1000000015047466219876688.0e6;break}b=1000000015047466219876688.0e6;p=1000000015047466219876688.0e6}}while(0);C=S*p;w=w*p;S=O*p;v=C+(M-N*b);y=w+(E-U*b);p=S+(T-V*b);h[bt+624>>2]=v;h[bt+624+4>>2]=y;h[bt+624+8>>2]=p;h[bt+624+12>>2]=0.0;if(v*v+y*y+p*p>1.1920928955078125e-07){b=+G(+(v*v+y*y+p*p));h[bt+624>>2]=v*(1.0/b);h[bt+624+4>>2]=1.0/b*y;h[bt+624+8>>2]=1.0/b*p;if(v*(1.0/b)*ct+1.0/b*y*_t+1.0/b*p*ut<0.0){h[bt+624>>2]=-(v*(1.0/b));h[bt+624+4>>2]=-(1.0/b*y);h[bt+624+8>>2]=-(1.0/b*p)}h[bt+384>>2]=B+C;h[bt+384+4>>2]=P+w;h[bt+384+8>>2]=R+S;h[bt+384+12>>2]=0.0;Uk[r[(r[o>>2]|0)+16>>2]&15](o,bt+624|0,bt+384|0,-b)}}if(ct*m+_t*f+ut*g<0.0){p=-1000000015047466219876688.0e6;m=-m;g=-g;a=0;f=-f;dt=111}else{p=-1000000015047466219876688.0e6;a=0;dt=111}}}while(0);if((dt|0)==111){Y=r[ft+56>>2]|0;s=r[mt+56>>2]|0;j=r[e+12>>2]|0;z=r[i+12>>2]|0;B=p-pt;R=1.0/+G(+(m*m+f*f+g*g));O=m*R;P=f*R;R=g*R;h[bt+624>>2]=O;h[bt+624+4>>2]=P;h[bt+624+8>>2]=R;r[bt+624+12>>2]=a;l=r[s+28>>2]|0;x=r[s+36>>2]|0;if((l|0)>0){p=+h[z>>2];f=+h[z+4>>2];m=+h[z+8>>2];g=+h[z+16>>2];b=+h[z+20>>2];y=+h[z+24>>2];v=+h[z+32>>2];S=+h[z+36>>2];w=+h[z+40>>2];a=-1;M=-3402823466385288598117041.0e14;u=0;while(1){C=+h[x+(u*36|0)+20>>2];T=+h[x+(u*36|0)+24>>2];E=+h[x+(u*36|0)+28>>2];c=(C*p+T*f+E*m)*O+(C*g+T*b+E*y)*P+(C*v+T*S+E*w)*R>M;a=c?u:a;u=u+1|0;if((u|0)==(l|0)){k=a;break}else M=c?(C*p+T*f+E*m)*O+(C*g+T*b+E*y)*P+(C*v+T*S+E*w)*R:M}}else k=-1;n[bt+384+16>>0]=1;F=bt+384+12|0;r[F>>2]=0;L=bt+384+4|0;r[L>>2]=0;r[bt+384+8>>2]=0;D=r[x+(k*36|0)+4>>2]|0;e:do{if((D|0)>0){I=x+(k*36|0)+12|0;a=0;c=0;l=0;while(1){e=r[(r[I>>2]|0)+(l<<2)>>2]|0;i=r[s+16>>2]|0;_t=+h[i+(e<<4)>>2];ut=+h[i+(e<<4)+4>>2];m=+h[i+(e<<4)+8>>2];p=_t*+h[z>>2]+ut*+h[z+4>>2]+m*+h[z+8>>2]+ +h[z+48>>2];f=_t*+h[z+16>>2]+ut*+h[z+20>>2]+m*+h[z+24>>2]+ +h[z+52>>2];m=_t*+h[z+32>>2]+ut*+h[z+36>>2]+m*+h[z+40>>2]+ +h[z+56>>2];if((a|0)==(c|0)){A=c|0?c<<1:1;if((c|0)<(A|0)){if(!A){x=0;a=c}else{r[5637]=(r[5637]|0)+1;a=Zl((A<<4|3)+16|0)|0;if(!a)a=0;else{r[(a+4+15&-16)+-4>>2]=a;a=a+4+15&-16}x=a;a=r[L>>2]|0}u=r[F>>2]|0;if((a|0)<=0){if(u)dt=126}else{c=0;do{e=x+(c<<4)|0;i=u+(c<<4)|0;r[e>>2]=r[i>>2];r[e+4>>2]=r[i+4>>2];r[e+8>>2]=r[i+8>>2];r[e+12>>2]=r[i+12>>2];c=c+1|0}while((c|0)!=(a|0));dt=126}if((dt|0)==126){dt=0;if(n[bt+384+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[u+-4>>2]|0);a=r[L>>2]|0}r[F>>2]=0}n[bt+384+16>>0]=1;r[F>>2]=x;r[bt+384+8>>2]=A}else a=c}e=r[F>>2]|0;h[e+(a<<4)>>2]=p;h[e+(a<<4)+4>>2]=f;h[e+(a<<4)+8>>2]=m;h[e+(a<<4)+12>>2]=0.0;a=(r[L>>2]|0)+1|0;r[L>>2]=a;l=l+1|0;if((l|0)>=(D|0))break e;c=r[bt+384+8>>2]|0}}}while(0);if((k|0)>-1)pS(bt+624|0,Y,j,bt+384|0,B,pt,o);a=r[F>>2]|0;if(a|0){if(n[bt+384+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[F>>2]=0}}if(n[t+16>>0]|0?(gt=r[o+4>>2]|0,r[gt+748>>2]|0):0){c=r[gt+740>>2]|0;l=r[(r[o+8>>2]|0)+8>>2]|0;a=r[(r[o+12>>2]|0)+8>>2]|0;if((c|0)==(l|0)){uS(gt,c+4|0,a+4|0);break}else{uS(gt,a+4|0,l+4|0);break}}}}while(0);_=bt;return}}while(0)}nS(bt+48|0,bt+128|0,o,r[s+20>>2]|0,0);if((r[t+28>>2]|0?(r[(r[o+4>>2]|0)+748>>2]|0)<(r[t+32>>2]|0):0)?(B=+h[bt+48+4>>2],N=+h[bt+48+8>>2],U=+h[bt+48+12>>2],B*B+N*N+U*U>1.1920928955078125e-07):0){M=1.0/(B*B+N*N+U*U);if(+W(+(U*M))>.7071067690849304){O=1.0/+G(+(U*M*(U*M)+N*M*(N*M)));R=0.0;P=N*M*O;O=-(U*M*O)}else{O=1.0/+G(+(B*M*(B*M)+N*M*(N*M)));R=-(N*M*O);P=0.0;O=B*M*O}E=+xk[r[(r[ft>>2]|0)+16>>2]&15](ft);C=+xk[r[(r[mt>>2]|0)+16>>2]&15](mt);p=.019999999552965164/(E<C?E:C);if(E<C){r[bt+624>>2]=r[bt+128>>2];r[bt+624+4>>2]=r[bt+128+4>>2];r[bt+624+8>>2]=r[bt+128+8>>2];r[bt+624+12>>2]=r[bt+128+12>>2];r[bt+624+16>>2]=r[c>>2];r[bt+624+16+4>>2]=r[c+4>>2];r[bt+624+16+8>>2]=r[c+8>>2];r[bt+624+16+12>>2]=r[c+12>>2];r[bt+624+32>>2]=r[x>>2];r[bt+624+32+4>>2]=r[x+4>>2];r[bt+624+32+8>>2]=r[x+8>>2];r[bt+624+32+12>>2]=r[x+12>>2];r[bt+624+48>>2]=r[A>>2];r[bt+624+48+4>>2]=r[A+4>>2];r[bt+624+48+8>>2]=r[A+8>>2];r[bt+624+48+12>>2]=r[A+12>>2]}else{r[bt+624>>2]=r[I>>2];r[bt+624+4>>2]=r[I+4>>2];r[bt+624+8>>2]=r[I+8>>2];r[bt+624+12>>2]=r[I+12>>2];r[bt+624+16>>2]=r[L>>2];r[bt+624+16+4>>2]=r[L+4>>2];r[bt+624+16+8>>2]=r[L+8>>2];r[bt+624+16+12>>2]=r[L+12>>2];r[bt+624+32>>2]=r[D>>2];r[bt+624+32+4>>2]=r[D+4>>2];r[bt+624+32+8>>2]=r[D+8>>2];r[bt+624+32+12>>2]=r[D+12>>2];r[bt+624+48>>2]=r[k>>2];r[bt+624+48+4>>2]=r[k+4>>2];r[bt+624+48+8>>2]=r[k+8>>2];r[bt+624+48+12>>2]=r[k+12>>2]}a=r[t+28>>2]|0;if((a|0)>0){T=R*R+O*O+P*P;w=(p>.39269909262657166?.39269909262657166:p)*.5;l=0;do{if(T>1.1920928955078125e-07){v=+X(+w)/+G(+T);b=R*v;y=O*v;v=P*v;S=+H(+w);g=+(l|0)*(6.2831854820251465/+(a|0))*.5;m=+X(+g)/+G(+(U*M*(U*M)+(B*M*(B*M)+N*M*(N*M))));p=B*M*m;f=N*M*m;m=U*M*m;g=+H(+g);if(E<C){st=m*(b*-m+(y*g+S*-f)-v*-p)+(p*(S*g-b*-p-y*-f-v*-m)+g*(v*-f+(b*g+S*-p)-y*-m))-f*(y*-p+(v*g+S*-m)-b*-f);_t=p*(y*-p+(v*g+S*-m)-b*-f)+(g*(b*-m+(y*g+S*-f)-v*-p)+f*(S*g-b*-p-y*-f-v*-m))-m*(v*-f+(b*g+S*-p)-y*-m);yt=f*(v*-f+(b*g+S*-p)-y*-m)+(m*(S*g-b*-p-y*-f-v*-m)+g*(y*-p+(v*g+S*-m)-b*-f))-p*(b*-m+(y*g+S*-f)-v*-p);it=g*(S*g-b*-p-y*-f-v*-m)-p*(v*-f+(b*g+S*-p)-y*-m)-f*(b*-m+(y*g+S*-f)-v*-p)-m*(y*-p+(v*g+S*-m)-b*-f);ct=st*(2.0/(it*it+(yt*yt+(st*st+_t*_t))));ut=_t*(2.0/(it*it+(yt*yt+(st*st+_t*_t))));et=yt*(2.0/(it*it+(yt*yt+(st*st+_t*_t))));gt=r[e+12>>2]|0;m=+h[gt>>2];g=+h[gt+16>>2];b=+h[gt+32>>2];y=+h[gt+4>>2];v=+h[gt+20>>2];S=+h[gt+36>>2];V=+h[gt+8>>2];nt=+h[gt+24>>2];pt=+h[gt+40>>2];h[bt+128>>2]=(1.0-(_t*ut+yt*et))*m+(st*ut-it*et)*g+(st*et+it*ut)*b;h[bt+128+4>>2]=(1.0-(_t*ut+yt*et))*y+(st*ut-it*et)*v+(st*et+it*ut)*S;h[bt+128+8>>2]=(1.0-(_t*ut+yt*et))*V+(st*ut-it*et)*nt+(st*et+it*ut)*pt;h[bt+128+12>>2]=0.0;h[bt+128+16>>2]=(st*ut+it*et)*m+(1.0-(st*ct+yt*et))*g+(_t*et-it*ct)*b;h[bt+128+20>>2]=(st*ut+it*et)*y+(1.0-(st*ct+yt*et))*v+(_t*et-it*ct)*S;h[bt+128+24>>2]=(st*ut+it*et)*V+(1.0-(st*ct+yt*et))*nt+(_t*et-it*ct)*pt;h[bt+128+28>>2]=0.0;h[bt+128+32>>2]=(st*et-it*ut)*m+(_t*et+it*ct)*g+(1.0-(st*ct+_t*ut))*b;h[bt+128+36>>2]=(st*et-it*ut)*y+(_t*et+it*ct)*v+(1.0-(st*ct+_t*ut))*S;h[bt+128+40>>2]=(st*et-it*ut)*V+(_t*et+it*ct)*nt+(1.0-(st*ct+_t*ut))*pt;h[bt+128+44>>2]=0.0;gt=r[i+12>>2]|0;r[I>>2]=r[gt>>2];r[I+4>>2]=r[gt+4>>2];r[I+8>>2]=r[gt+8>>2];r[I+12>>2]=r[gt+12>>2];r[L>>2]=r[gt+16>>2];r[L+4>>2]=r[gt+16+4>>2];r[L+8>>2]=r[gt+16+8>>2];r[L+12>>2]=r[gt+16+12>>2];r[D>>2]=r[gt+32>>2];r[D+4>>2]=r[gt+32+4>>2];r[D+8>>2]=r[gt+32+8>>2];r[D+12>>2]=r[gt+32+12>>2];r[k>>2]=r[gt+48>>2];r[k+4>>2]=r[gt+48+4>>2];r[k+8>>2]=r[gt+48+8>>2];r[k+12>>2]=r[gt+48+12>>2]}else{gt=r[e+12>>2]|0;r[bt+128>>2]=r[gt>>2];r[bt+128+4>>2]=r[gt+4>>2];r[bt+128+8>>2]=r[gt+8>>2];r[bt+128+12>>2]=r[gt+12>>2];r[c>>2]=r[gt+16>>2];r[c+4>>2]=r[gt+16+4>>2];r[c+8>>2]=r[gt+16+8>>2];r[c+12>>2]=r[gt+16+12>>2];r[x>>2]=r[gt+32>>2];r[x+4>>2]=r[gt+32+4>>2];r[x+8>>2]=r[gt+32+8>>2];r[x+12>>2]=r[gt+32+12>>2];r[A>>2]=r[gt+48>>2];r[A+4>>2]=r[gt+48+4>>2];r[A+8>>2]=r[gt+48+8>>2];r[A+12>>2]=r[gt+48+12>>2];ct=m*(b*-m+(y*g+S*-f)-v*-p)+(p*(S*g-b*-p-y*-f-v*-m)+g*(v*-f+(b*g+S*-p)-y*-m))-f*(y*-p+(v*g+S*-m)-b*-f);ut=p*(y*-p+(v*g+S*-m)-b*-f)+(g*(b*-m+(y*g+S*-f)-v*-p)+f*(S*g-b*-p-y*-f-v*-m))-m*(v*-f+(b*g+S*-p)-y*-m);vt=f*(v*-f+(b*g+S*-p)-y*-m)+(m*(S*g-b*-p-y*-f-v*-m)+g*(y*-p+(v*g+S*-m)-b*-f))-p*(b*-m+(y*g+S*-f)-v*-p);nt=g*(S*g-b*-p-y*-f-v*-m)-p*(v*-f+(b*g+S*-p)-y*-m)-f*(b*-m+(y*g+S*-f)-v*-p)-m*(y*-p+(v*g+S*-m)-b*-f);_t=ct*(2.0/(nt*nt+(vt*vt+(ct*ct+ut*ut))));pt=ut*(2.0/(nt*nt+(vt*vt+(ct*ct+ut*ut))));it=vt*(2.0/(nt*nt+(vt*vt+(ct*ct+ut*ut))));gt=r[i+12>>2]|0;g=+h[gt>>2];b=+h[gt+16>>2];y=+h[gt+32>>2];v=+h[gt+4>>2];S=+h[gt+20>>2];V=+h[gt+36>>2];et=+h[gt+8>>2];st=+h[gt+24>>2];yt=+h[gt+40>>2];h[bt+128+64>>2]=(1.0-(ut*pt+vt*it))*g+(ct*pt-nt*it)*b+(ct*it+nt*pt)*y;h[bt+128+68>>2]=(1.0-(ut*pt+vt*it))*v+(ct*pt-nt*it)*S+(ct*it+nt*pt)*V;h[bt+128+72>>2]=(1.0-(ut*pt+vt*it))*et+(ct*pt-nt*it)*st+(ct*it+nt*pt)*yt;h[bt+128+76>>2]=0.0;h[bt+128+80>>2]=(ct*pt+nt*it)*g+(1.0-(ct*_t+vt*it))*b+(ut*it-nt*_t)*y;h[bt+128+84>>2]=(ct*pt+nt*it)*v+(1.0-(ct*_t+vt*it))*S+(ut*it-nt*_t)*V;h[bt+128+88>>2]=(ct*pt+nt*it)*et+(1.0-(ct*_t+vt*it))*st+(ut*it-nt*_t)*yt;h[bt+128+92>>2]=0.0;h[bt+128+96>>2]=(ct*it-nt*pt)*g+(ut*it+nt*_t)*b+(1.0-(ct*_t+ut*pt))*y;h[bt+128+100>>2]=(ct*it-nt*pt)*v+(ut*it+nt*_t)*S+(1.0-(ct*_t+ut*pt))*V;h[bt+128+104>>2]=(ct*it-nt*pt)*et+(ut*it+nt*_t)*st+(1.0-(ct*_t+ut*pt))*yt;h[bt+128+108>>2]=0.0}a=r[s+20>>2]|0;r[bt+384>>2]=4028;r[bt+384+32>>2]=o;r[bt+384+36>>2]=r[bt+128>>2];r[bt+384+36+4>>2]=r[bt+128+4>>2];r[bt+384+36+8>>2]=r[bt+128+8>>2];r[bt+384+36+12>>2]=r[bt+128+12>>2];r[bt+384+52>>2]=r[c>>2];r[bt+384+52+4>>2]=r[c+4>>2];r[bt+384+52+8>>2]=r[c+8>>2];r[bt+384+52+12>>2]=r[c+12>>2];r[bt+384+68>>2]=r[x>>2];r[bt+384+68+4>>2]=r[x+4>>2];r[bt+384+68+8>>2]=r[x+8>>2];r[bt+384+68+12>>2]=r[x+12>>2];r[bt+384+84>>2]=r[A>>2];r[bt+384+84+4>>2]=r[A+4>>2];r[bt+384+84+8>>2]=r[A+8>>2];r[bt+384+84+12>>2]=r[A+12>>2];r[bt+384+100>>2]=r[I>>2];r[bt+384+100+4>>2]=r[I+4>>2];r[bt+384+100+8>>2]=r[I+8>>2];r[bt+384+100+12>>2]=r[I+12>>2];r[bt+384+116>>2]=r[L>>2];r[bt+384+116+4>>2]=r[L+4>>2];r[bt+384+116+8>>2]=r[L+8>>2];r[bt+384+116+12>>2]=r[L+12>>2];r[bt+384+132>>2]=r[D>>2];r[bt+384+132+4>>2]=r[D+4>>2];r[bt+384+132+8>>2]=r[D+8>>2];r[bt+384+132+12>>2]=r[D+12>>2];r[bt+384+148>>2]=r[k>>2];r[bt+384+148+4>>2]=r[k+4>>2];r[bt+384+148+8>>2]=r[k+8>>2];r[bt+384+148+12>>2]=r[k+12>>2];r[bt+384+164>>2]=r[bt+624>>2];r[bt+384+164+4>>2]=r[bt+624+4>>2];r[bt+384+164+8>>2]=r[bt+624+8>>2];r[bt+384+164+12>>2]=r[bt+624+12>>2];r[bt+384+180>>2]=r[bt+624+16>>2];r[bt+384+180+4>>2]=r[bt+624+16+4>>2];r[bt+384+180+8>>2]=r[bt+624+16+8>>2];r[bt+384+180+12>>2]=r[bt+624+16+12>>2];r[bt+384+196>>2]=r[bt+624+32>>2];r[bt+384+196+4>>2]=r[bt+624+32+4>>2];r[bt+384+196+8>>2]=r[bt+624+32+8>>2];r[bt+384+196+12>>2]=r[bt+624+32+12>>2];r[bt+384+212>>2]=r[bt+624+48>>2];r[bt+384+212+4>>2]=r[bt+624+48+4>>2];r[bt+384+212+8>>2]=r[bt+624+48+8>>2];r[bt+384+212+12>>2]=r[bt+624+48+12>>2];n[bt+384+228>>0]=E<C&1;r[bt+384+232>>2]=a;nS(bt+48|0,bt+128|0,bt+384|0,a,0);a=r[t+28>>2]|0}l=l+1|0}while((l|0)<(a|0))}}if(!(n[t+16>>0]|0)){_=bt;return}l=r[o+4>>2]|0;if(!(r[l+748>>2]|0)){_=bt;return}c=r[l+740>>2]|0;u=r[(r[o+8>>2]|0)+8>>2]|0;a=r[(r[o+12>>2]|0)+8>>2]|0;if((c|0)==(u|0)){uS(l,c+4|0,a+4|0);_=bt;return}else{uS(l,a+4|0,u+4|0);_=bt;return}}function AM(t){t=t|0;Ql(t);return}function EM(t,e,i){t=t|0;e=e|0;i=i|0;return}function MM(t,e,i){t=t|0;e=e|0;i=i|0;return}function RM(t,e,i,n){t=t|0;e=e|0;i=i|0;n=+n;return}function IM(t){t=t|0;Ql(t);return}function PM(t,e,i){t=t|0;e=e|0;i=i|0;return}function LM(t,e,i){t=t|0;e=e|0;i=i|0;return}function DM(t,e,i,s){t=t|0;e=e|0;i=i|0;s=+s;var o=0,a=0.0,l=0.0,c=0.0;o=_;_=_+16|0;h[t+32>>2]=s;r[t+8>>2]=r[e>>2];r[t+8+4>>2]=r[e+4>>2];r[t+8+8>>2]=r[e+8>>2];r[t+8+12>>2]=r[e+12>>2];a=+h[t+28>>2];c=+h[i+4>>2]-a*+h[e+4>>2];l=+h[i+8>>2]-a*+h[e+8>>2];h[o>>2]=+h[i>>2]-+h[e>>2]*a;h[o+4>>2]=c;h[o+8>>2]=l;h[o+12>>2]=0.0;s=+h[t+24>>2]+a+s;h[t+32>>2]=s;if(!(s<0.0)){t=t+4|0;t=r[t>>2]|0;i=r[t>>2]|0;i=i+16|0;i=r[i>>2]|0;Uk[i&15](t,e,o,s);_=o;return}n[t+36>>0]=1;t=t+4|0;t=r[t>>2]|0;i=r[t>>2]|0;i=i+16|0;i=r[i>>2]|0;Uk[i&15](t,e,o,s);_=o;return}function kM(t){t=t|0;Ql(t);return}function OM(t,e,i,s){t=t|0;e=e|0;i=i|0;s=+s;var o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0;p=_;_=_+16|0;c=+h[e>>2];u=+h[e+4>>2];d=+h[e+8>>2];a=+h[i>>2];l=+h[i+4>>2];o=+h[i+8>>2];if(!(n[t+228>>0]|0)){T=+h[t+100>>2];x=+h[t+116>>2];M=+h[t+132>>2];C=+h[t+104>>2];v=+h[t+120>>2];E=+h[t+136>>2];w=+h[t+108>>2];f=+h[t+124>>2];A=+h[t+140>>2];P=-+h[t+148>>2];I=-+h[t+152>>2];R=-+h[t+156>>2];O=+h[t+164>>2];k=+h[t+168>>2];b=+h[t+172>>2];D=+h[t+180>>2];L=+h[t+184>>2];g=+h[t+188>>2];S=+h[t+196>>2];y=+h[t+200>>2];m=+h[t+204>>2];b=o*(M*O+E*k+A*b)+(a*(T*O+C*k+w*b)+l*(x*O+v*k+f*b))+(O*(T*P+x*I+M*R)+(C*P+v*I+E*R)*k+(w*P+f*I+A*R)*b+ +h[t+212>>2]);g=o*(M*D+E*L+A*g)+(a*(T*D+C*L+w*g)+l*(x*D+v*L+f*g))+((T*P+x*I+M*R)*D+(C*P+v*I+E*R)*L+(w*P+f*I+A*R)*g+ +h[t+216>>2]);m=(T*P+x*I+M*R)*S+(C*P+v*I+E*R)*y+(w*P+f*I+A*R)*m+ +h[t+220>>2]+(o*(M*S+E*y+A*m)+(a*(T*S+C*y+w*m)+l*(x*S+v*y+f*m)));h[p>>2]=b;h[p+4>>2]=g;f=m;s=(c*s+a-b)*+h[e>>2]+(u*s+l-g)*+h[e+4>>2]+(d*s+o-m)*+h[e+8>>2];i=p+8|0;h[i>>2]=f;i=p+12|0;h[i>>2]=0.0;t=t+32|0;t=r[t>>2]|0;i=r[t>>2]|0;i=i+16|0;i=r[i>>2]|0;Uk[i&15](t,e,p,s);_=p;return}else{T=+h[t+36>>2];M=+h[t+52>>2];x=+h[t+68>>2];A=+h[t+40>>2];I=+h[t+56>>2];w=+h[t+72>>2];E=+h[t+44>>2];k=+h[t+60>>2];C=+h[t+76>>2];y=-+h[t+84>>2];v=-+h[t+88>>2];S=-+h[t+92>>2];f=+h[t+164>>2];m=+h[t+168>>2];L=+h[t+172>>2];g=+h[t+180>>2];b=+h[t+184>>2];D=+h[t+188>>2];R=+h[t+196>>2];P=+h[t+200>>2];O=+h[t+204>>2];L=(d*s+o)*(x*f+w*m+C*L)+((c*s+a)*(T*f+A*m+E*L)+(u*s+l)*(M*f+I*m+k*L))+(f*(T*y+M*v+x*S)+(A*y+I*v+w*S)*m+(E*y+k*v+C*S)*L+ +h[t+212>>2]);D=(d*s+o)*(x*g+w*b+C*D)+((c*s+a)*(T*g+A*b+E*D)+(u*s+l)*(M*g+I*b+k*D))+((T*y+M*v+x*S)*g+(A*y+I*v+w*S)*b+(E*y+k*v+C*S)*D+ +h[t+216>>2]);O=(T*y+M*v+x*S)*R+(A*y+I*v+w*S)*P+(E*y+k*v+C*S)*O+ +h[t+220>>2]+((d*s+o)*(x*R+w*P+C*O)+((c*s+a)*(T*R+A*P+E*O)+(u*s+l)*(M*R+I*P+k*O)));h[p>>2]=L+c*(c*(L-a)+u*(D-l)+d*(O-o));h[p+4>>2]=D+u*(c*(L-a)+u*(D-l)+d*(O-o));k=O+d*(c*(L-a)+u*(D-l)+d*(O-o));O=c*(L-a)+u*(D-l)+d*(O-o);i=p+8|0;h[i>>2]=k;i=p+12|0;h[i>>2]=0.0;t=t+32|0;t=r[t>>2]|0;i=r[t>>2]|0;i=i+16|0;i=r[i>>2]|0;Uk[i&15](t,e,p,O);_=p;return}}function FM(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0;s=_;_=_+608|0;f=+h[e+116>>2]-+h[e+52>>2];p=+h[e+120>>2]-+h[e+56>>2];d=+h[e+124>>2]-+h[e+60>>2];a=+h[i+116>>2]-+h[i+52>>2];l=+h[i+120>>2]-+h[i+56>>2];c=+h[i+124>>2]-+h[i+60>>2];u=+h[e+256>>2];if(f*f+p*p+d*d<u*u?(f=+h[i+256>>2],a*a+l*l+c*c<f*f):0){f=1.0;_=s;return+f}t=r[e+192>>2]|0;o=r[i+252>>2]|0;r[s+552+8>>2]=0;r[s+552+12>>2]=-1;r[s+552+16>>2]=1065353216;r[s+552+20>>2]=1065353216;r[s+552+24>>2]=1065353216;h[s+552+28>>2]=0.0;r[s+552>>2]=6380;r[s+552+4>>2]=8;r[s+552+32>>2]=o;r[s+552+48>>2]=o;r[s+376>>2]=3316;h[s+376+164>>2]=999999984306749440.0;r[s+376+168>>2]=0;h[s+376+172>>2]=0.0;h[s+16+308>>2]=9.999999747378752e-05;n[s+16+332>>0]=0;r[s>>2]=6864;r[s+4>>2]=s+16;r[s+8>>2]=t;r[s+12>>2]=s+552;if(Gv(s,e+4|0,e+68|0,i+4|0,i+68|0,s+376|0)|0){a=+h[s+376+164>>2];if(+h[e+248>>2]>a)h[e+248>>2]=a;if(+h[i+248>>2]>a)h[i+248>>2]=a;if(a<1.0)l=a;else l=1.0}else l=1.0;t=r[i+192>>2]|0;o=r[e+252>>2]|0;r[s+552+8>>2]=0;r[s+552+12>>2]=-1;r[s+552+16>>2]=1065353216;r[s+552+20>>2]=1065353216;r[s+552+24>>2]=1065353216;h[s+552+28>>2]=0.0;r[s+552>>2]=6380;r[s+552+4>>2]=8;r[s+552+32>>2]=o;r[s+552+48>>2]=o;r[s+376>>2]=3316;h[s+376+164>>2]=999999984306749440.0;r[s+376+168>>2]=0;h[s+376+172>>2]=0.0;h[s+16+308>>2]=9.999999747378752e-05;n[s+16+332>>0]=0;r[s>>2]=6864;r[s+4>>2]=s+16;r[s+8>>2]=s+552;r[s+12>>2]=t;if(Gv(s,e+4|0,e+68|0,i+4|0,i+68|0,s+376|0)|0){a=+h[s+376+164>>2];if(+h[e+248>>2]>a)h[e+248>>2]=a;if(+h[i+248>>2]>a)h[i+248>>2]=a;if(!(l>a))a=l}else a=l;f=a;_=s;return+f}function BM(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0;i=r[t+20>>2]|0;if(!i)return;if(!(n[t+16>>0]|0))return;s=r[e+4>>2]|0;if((s|0)==(r[e+8>>2]|0)?(a=s|0?s<<1:1,(s|0)<(a|0)):0){if(!a)i=0;else{r[5637]=(r[5637]|0)+1;i=Zl((a<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}s=r[e+4>>2]|0}if((s|0)>0){o=0;do{r[i+(o<<2)>>2]=r[(r[e+12>>2]|0)+(o<<2)>>2];o=o+1|0}while((o|0)!=(s|0))}o=r[e+12>>2]|0;if(o){if(n[e+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0);s=r[e+4>>2]|0}r[e+12>>2]=0}n[e+16>>0]=1;r[e+12>>2]=i;r[e+8>>2]=a;i=r[t+20>>2]|0}r[(r[e+12>>2]|0)+(s<<2)>>2]=i;r[e+4>>2]=s+1;return}function NM(t){t=t|0;var e=0;r[t>>2]=4056;if(!(n[t+8>>0]|0))return;e=r[t+12>>2]|0;if(!e)return;t=r[t+4>>2]|0;lk[r[(r[t>>2]|0)+16>>2]&127](t,e);return}function UM(t){t=t|0;var e=0,i=0;r[t>>2]=4056;if(!(n[t+8>>0]|0)){Ql(t);return}e=r[t+12>>2]|0;if(!e){Ql(t);return}i=r[t+4>>2]|0;lk[r[(r[i>>2]|0)+16>>2]&127](i,e);Ql(t);return}function VM(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0,l=0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0,O=0,F=0,B=0,N=0.0,U=0.0,V=0.0,z=0.0,j=0.0,Y=0.0,q=0.0,K=0.0,Z=0.0,Q=0.0,$=0.0,J=0.0,tt=0.0,et=0,it=0.0,nt=0.0,st=0.0,rt=0.0,ot=0.0,at=0.0,lt=0.0,ht=0.0,ct=0.0,_t=0.0,ut=0.0,dt=0.0,pt=0.0;k=_;_=_+96|0;if(!(r[t+12>>2]|0)){_=k;return}s=(n[t+16>>0]|0)!=0;B=s?i:e;s=s?e:i;a=r[B+4>>2]|0;l=r[s+4>>2]|0;B=r[B+12>>2]|0;tt=+h[B>>2];J=+h[B+16>>2];$=+h[B+32>>2];Q=+h[B+4>>2];Z=+h[B+20>>2];p=+h[B+36>>2];c=+h[B+8>>2];g=+h[B+24>>2];C=+h[B+40>>2];z=+h[B+48>>2];V=+h[B+52>>2];U=+h[B+56>>2];F=r[s+12>>2]|0;K=+h[F>>2];q=+h[F+16>>2];f=+h[F+32>>2];Y=+h[F+4>>2];j=+h[F+20>>2];m=+h[F+36>>2];w=+h[F+8>>2];S=+h[F+24>>2];y=+h[F+40>>2];N=-+h[F+48>>2];I=-+h[F+52>>2];P=-+h[F+56>>2];L=+h[B>>2];D=+h[B+16>>2];R=+h[B+32>>2];E=+h[B+4>>2];A=+h[B+20>>2];T=+h[B+36>>2];x=+h[B+8>>2];v=+h[B+24>>2];b=+h[B+40>>2];B=r[(r[a>>2]|0)+64>>2]|0;d=-+h[l+52>>2];u=-+h[l+56>>2];M=-+h[l+60>>2];h[k>>2]=(tt*K+J*q+$*f)*d+(tt*Y+J*j+$*m)*u+(tt*w+J*S+$*y)*M;h[k+4>>2]=(Q*K+Z*q+p*f)*d+(Q*Y+Z*j+p*m)*u+(Q*w+Z*S+p*y)*M;h[k+8>>2]=(c*K+g*q+C*f)*d+(c*Y+g*j+C*m)*u+(c*w+g*S+C*y)*M;h[k+12>>2]=0.0;Vk[B&127](k+16|0,a,k);M=+h[k+16>>2];C=+h[k+16+4>>2];g=+h[k+16+8>>2];c=+h[l+52>>2];u=+h[l+56>>2];d=+h[l+60>>2];p=d*(z*w+V*S+U*y+(w*N+S*I+y*P)+((w*L+S*D+y*R)*M+(w*E+S*A+y*T)*C+(w*x+S*v+y*b)*g))+(c*(z*K+V*q+U*f+(K*N+q*I+f*P)+((K*L+q*D+f*R)*M+(K*E+q*A+f*T)*C+(K*x+q*v+f*b)*g))+u*(z*Y+V*j+U*m+(Y*N+j*I+m*P)+((Y*L+j*D+m*R)*M+(Y*E+j*A+m*T)*C+(Y*x+j*v+m*b)*g)))-+h[l+68>>2];f=z*K+V*q+U*f+(K*N+q*I+f*P)+((K*L+q*D+f*R)*M+(K*E+q*A+f*T)*C+(K*x+q*v+f*b)*g)-c*p;m=z*Y+V*j+U*m+(Y*N+j*I+m*P)+((Y*L+j*D+m*R)*M+(Y*E+j*A+m*T)*C+(Y*x+j*v+m*b)*g)-u*p;g=z*w+V*S+U*y+(w*N+S*I+y*P)+((w*L+S*D+y*R)*M+(w*E+S*A+y*T)*C+(w*x+S*v+y*b)*g)-d*p;B=r[s+12>>2]|0;b=+h[B>>2];y=+h[B+4>>2];v=+h[B+8>>2];S=+h[B+16>>2];x=+h[B+20>>2];w=+h[B+24>>2];C=+h[B+32>>2];T=+h[B+36>>2];A=+h[B+40>>2];E=+h[B+48>>2];M=+h[B+52>>2];R=+h[B+56>>2];B=r[t+12>>2]|0;F=p<+h[B+752>>2];r[o+4>>2]=B;if(F){B=r[s+12>>2]|0;J=c*+h[B+16>>2]+u*+h[B+20>>2]+d*+h[B+24>>2];tt=c*+h[B+32>>2]+u*+h[B+36>>2]+d*+h[B+40>>2];h[k+80>>2]=+h[B>>2]*c+ +h[B+4>>2]*u+ +h[B+8>>2]*d;h[k+80+4>>2]=J;h[k+80+8>>2]=tt;h[k+80+12>>2]=0.0;h[k+64>>2]=v*g+(b*f+y*m)+E;h[k+64+4>>2]=f*S+m*x+g*w+M;h[k+64+8>>2]=f*C+m*T+g*A+R;h[k+64+12>>2]=0.0;Uk[r[(r[o>>2]|0)+16>>2]&15](o,k+80|0,k+64|0,p)}if((r[a+4>>2]|0)<7?(r[(r[o+4>>2]|0)+748>>2]|0)<(r[t+24>>2]|0):0){c=+h[l+60>>2];if(+W(+c)>.7071067690849304){d=+h[l+56>>2];tt=1.0/+G(+(c*c+d*d));u=0.0;d=d*tt;c=-(c*tt)}else{tt=+h[l+52>>2];u=+h[l+56>>2];c=1.0/+G(+(tt*tt+u*u));u=-(u*c);d=0.0;c=tt*c}P=.019999999552965164/+xk[r[(r[a>>2]|0)+16>>2]&15](a);P=(P>.39269909262657166?.39269909262657166:P)*.5;I=+X(+P)/+G(+(u*u+c*c+d*d));D=u*I;L=c*I;I=d*I;P=+H(+P);s=r[t+20>>2]|0;if((s|0)>0){a=0;do{S=+h[l+52>>2];tt=+h[l+56>>2];E=+h[l+60>>2];T=+(a|0)*(6.2831854820251465/+(s|0))*.5;J=+X(+T)/+G(+(S*S+tt*tt+E*E));T=+H(+T);A=I*-(tt*J)+(D*T+P*-(S*J))-L*-(E*J);w=D*-(E*J)+(L*T+P*-(tt*J))-I*-(S*J);nt=L*-(S*J)+(I*T+P*-(E*J))-D*-(tt*J);R=P*T-D*-(S*J)-L*-(tt*J)-I*-(E*J);lt=E*J*w+(S*J*R+T*A)-tt*J*nt;at=S*J*nt+(T*w+tt*J*R)-E*J*A;_t=tt*J*A+(E*J*R+T*nt)-S*J*w;nt=T*R-S*J*A-tt*J*w-E*J*nt;s=(n[t+16>>0]|0)!=0;et=s?i:e;s=s?e:i;B=r[et+4>>2]|0;F=r[s+4>>2]|0;et=r[et+12>>2]|0;J=+h[et>>2];E=+h[et+4>>2];w=+h[et+8>>2];tt=+h[et+16>>2];A=+h[et+20>>2];S=+h[et+24>>2];R=+h[et+32>>2];T=+h[et+36>>2];y=+h[et+40>>2];Y=+h[et+48>>2];q=+h[et+52>>2];K=+h[et+56>>2];et=r[s+12>>2]|0;U=+h[et>>2];V=+h[et+16>>2];f=+h[et+32>>2];z=+h[et+4>>2];j=+h[et+20>>2];m=+h[et+36>>2];x=+h[et+8>>2];v=+h[et+24>>2];b=+h[et+40>>2];Z=-+h[et+48>>2];Q=-+h[et+52>>2];$=-+h[et+56>>2];ot=lt*(2.0/(lt*lt+at*at+_t*_t+nt*nt));d=at*(2.0/(lt*lt+at*at+_t*_t+nt*nt));it=_t*(2.0/(lt*lt+at*at+_t*_t+nt*nt));dt=w*(lt*it-nt*d)+(E*(lt*d+nt*it)+J*(1.0-(at*d+_t*it)));ct=w*(at*it+nt*ot)+(J*(lt*d-nt*it)+E*(1.0-(lt*ot+_t*it)));c=J*(lt*it+nt*d)+E*(at*it-nt*ot)+w*(1.0-(lt*ot+at*d));ut=S*(lt*it-nt*d)+(A*(lt*d+nt*it)+tt*(1.0-(at*d+_t*it)));ht=S*(at*it+nt*ot)+(tt*(lt*d-nt*it)+A*(1.0-(lt*ot+_t*it)));C=tt*(lt*it+nt*d)+A*(at*it-nt*ot)+S*(1.0-(lt*ot+at*d));pt=y*(lt*it-nt*d)+(T*(lt*d+nt*it)+R*(1.0-(at*d+_t*it)));_t=y*(at*it+nt*ot)+(R*(lt*d-nt*it)+T*(1.0-(lt*ot+_t*it)));d=R*(lt*it+nt*d)+T*(at*it-nt*ot)+y*(1.0-(lt*ot+at*d));at=+h[et>>2];ot=+h[et+16>>2];lt=+h[et+32>>2];nt=+h[et+4>>2];it=+h[et+20>>2];st=+h[et+36>>2];u=+h[et+8>>2];g=+h[et+24>>2];p=+h[et+40>>2];et=r[(r[B>>2]|0)+64>>2]|0;rt=-+h[F+52>>2];N=-+h[F+56>>2];M=-+h[F+60>>2];h[k+64>>2]=(lt*pt+(at*dt+ot*ut))*rt+(st*pt+(nt*dt+it*ut))*N+(p*pt+(u*dt+g*ut))*M;h[k+64+4>>2]=(lt*_t+(at*ct+ot*ht))*rt+(st*_t+(nt*ct+it*ht))*N+(p*_t+(u*ct+g*ht))*M;h[k+64+8>>2]=(lt*d+(at*c+ot*C))*rt+(st*d+(nt*c+it*C))*N+(p*d+(u*c+g*C))*M;h[k+64+12>>2]=0.0;Vk[et&127](k+80|0,B,k+64|0);M=+h[k+80>>2];C=+h[k+80+4>>2];g=+h[k+80+8>>2];c=+h[F+52>>2];u=+h[F+56>>2];d=+h[F+60>>2];p=d*(Y*x+q*v+K*b+(x*Z+v*Q+b*$)+((J*x+tt*v+R*b)*M+(E*x+A*v+T*b)*C+(w*x+S*v+y*b)*g))+(c*(Y*U+q*V+K*f+(U*Z+V*Q+f*$)+((J*U+tt*V+R*f)*M+(E*U+A*V+T*f)*C+(w*U+S*V+y*f)*g))+u*(Y*z+q*j+K*m+(z*Z+j*Q+m*$)+((J*z+tt*j+R*m)*M+(E*z+A*j+T*m)*C+(w*z+S*j+y*m)*g)))-+h[F+68>>2];f=Y*U+q*V+K*f+(U*Z+V*Q+f*$)+((J*U+tt*V+R*f)*M+(E*U+A*V+T*f)*C+(w*U+S*V+y*f)*g)-c*p;m=Y*z+q*j+K*m+(z*Z+j*Q+m*$)+((J*z+tt*j+R*m)*M+(E*z+A*j+T*m)*C+(w*z+S*j+y*m)*g)-u*p;g=Y*x+q*v+K*b+(x*Z+v*Q+b*$)+((J*x+tt*v+R*b)*M+(E*x+A*v+T*b)*C+(w*x+S*v+y*b)*g)-d*p;F=r[s+12>>2]|0;b=+h[F>>2];y=+h[F+4>>2];v=+h[F+8>>2];S=+h[F+16>>2];x=+h[F+20>>2];w=+h[F+24>>2];C=+h[F+32>>2];T=+h[F+36>>2];A=+h[F+40>>2];E=+h[F+48>>2];M=+h[F+52>>2];R=+h[F+56>>2];F=r[t+12>>2]|0;B=p<+h[F+752>>2];r[o+4>>2]=F;if(B){et=r[s+12>>2]|0;dt=c*+h[et+16>>2]+u*+h[et+20>>2]+d*+h[et+24>>2];pt=c*+h[et+32>>2]+u*+h[et+36>>2]+d*+h[et+40>>2];h[k+48>>2]=+h[et>>2]*c+ +h[et+4>>2]*u+ +h[et+8>>2]*d;h[k+48+4>>2]=dt;h[k+48+8>>2]=pt;h[k+48+12>>2]=0.0;h[k+32>>2]=v*g+(b*f+y*m)+E;h[k+32+4>>2]=f*S+m*x+g*w+M;h[k+32+8>>2]=f*C+m*T+g*A+R;h[k+32+12>>2]=0.0;Uk[r[(r[o>>2]|0)+16>>2]&15](o,k+48|0,k+32|0,p)}a=a+1|0;s=r[t+20>>2]|0}while((a|0)<(s|0))}}do{if((n[t+8>>0]|0?r[(r[t+12>>2]|0)+748>>2]|0:0)?(O=r[o+4>>2]|0,r[O+748>>2]|0):0){a=r[O+740>>2]|0;l=r[(r[o+8>>2]|0)+8>>2]|0;s=r[(r[o+12>>2]|0)+8>>2]|0;if((a|0)==(l|0)){uS(O,a+4|0,s+4|0);break}else{uS(O,s+4|0,l+4|0);break}}}while(0);_=k;return}function zM(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;return 1.0}function WM(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0;i=r[t+12>>2]|0;if(!i)return;if(!(n[t+8>>0]|0))return;s=r[e+4>>2]|0;if((s|0)==(r[e+8>>2]|0)?(a=s|0?s<<1:1,(s|0)<(a|0)):0){if(!a)i=0;else{r[5637]=(r[5637]|0)+1;i=Zl((a<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}s=r[e+4>>2]|0}if((s|0)>0){o=0;do{r[i+(o<<2)>>2]=r[(r[e+12>>2]|0)+(o<<2)>>2];o=o+1|0}while((o|0)!=(s|0))}o=r[e+12>>2]|0;if(o){if(n[e+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0);s=r[e+4>>2]|0}r[e+12>>2]=0}n[e+16>>0]=1;r[e+12>>2]=i;r[e+8>>2]=a;i=r[t+12>>2]|0}r[(r[e+12>>2]|0)+(s<<2)>>2]=i;r[e+4>>2]=s+1;return}function GM(t){t=t|0;var e=0,i=0;r[t>>2]=4084;if(n[t+20>>0]|0){e=r[t+16>>2]|0;i=r[e+16>>2]|0;if(i){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0);e=r[t+16>>2]|0}if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}}if(n[t+12>>0]|0){e=r[t+8>>2]|0;i=r[e+16>>2]|0;if(i){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0);e=r[t+8>>2]|0}if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}}e=r[t+32>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+32>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+36>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+36>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+40>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+40>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+44>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+44>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+48>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+48>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+52>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+52>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+56>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+56>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+60>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+60>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+76>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+76>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+80>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+80>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+72>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+72>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+88>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+88>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+84>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+84>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+24>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+28>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+28>>2]|0;if(!e)return;r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);return}function jM(t){t=t|0;GM(t);Ql(t);return}function HM(t){t=t|0;return r[t+8>>2]|0}function XM(t){t=t|0;return r[t+16>>2]|0}function YM(t,e,i){t=t|0;e=e|0;i=i|0;do{if(!((e|0)==8&(i|0)==8)){if((e|0)==8&(i|0)==1){e=t+76|0;break}if((e|0)==1&(i|0)==8){e=t+80|0;break}if(!(i|e)){e=t+72|0;break}if((e|0)<20&(i|0)==28){e=t+88|0;break}if((e|0)==28&(i|0)<20){e=t+84|0;break}if((e|0)<20){if((i|0)<20){e=t+32|0;break}if((i+-21|0)>>>0<9){e=t+36|0;break}}else{if((i|0)<20&(e+-21|0)>>>0<9){e=t+40|0;break}if((e|0)==31)if((i|0)==31){e=t+48|0;break}else{e=t+44|0;break}}if((i|0)==31){e=t+52|0;break}else{e=t+56|0;break}}else e=t+60|0}while(0);return r[e>>2]|0}function qM(t){t=t|0;return r[t+24>>2]|0}function KM(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0,l=0,c=0,_=0,u=0;r[t>>2]=4084;r[5637]=(r[5637]|0)+1;i=Zl(379)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}h[i+308>>2]=9.999999747378752e-05;s=i+332|0;n[s>>0]=n[s>>0]&-16;r[t+24>>2]=i;s=(r[e+20>>2]|0)==0;r[5637]=(r[5637]|0)+1;i=Zl(23)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}if(s){r[i>>2]=6948;r[t+28>>2]=i;s=t+28|0}else{r[i>>2]=6908;r[t+28>>2]=i;s=t+28|0}r[5637]=(r[5637]|0)+1;i=Zl(43)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}c=r[t+24>>2]|0;_=r[s>>2]|0;n[i+4>>0]=0;r[i>>2]=3924;r[i+16>>2]=0;r[i+20>>2]=3;r[i+12>>2]=c;r[i+8>>2]=_;r[t+32>>2]=i;r[5637]=(r[5637]|0)+1;i=Zl(27)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}n[i+4>>0]=0;r[i>>2]=4116;r[t+36>>2]=i;r[5637]=(r[5637]|0)+1;i=Zl(27)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}n[i+4>>0]=0;r[i>>2]=4136;r[t+40>>2]=i;r[5637]=(r[5637]|0)+1;i=Zl(27)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}n[i+4>>0]=0;r[i>>2]=4156;r[t+44>>2]=i;r[5637]=(r[5637]|0)+1;i=Zl(27)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}n[i+4>>0]=0;r[i>>2]=4176;r[t+48>>2]=i;r[5637]=(r[5637]|0)+1;i=Zl(27)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}n[i+4>>0]=0;r[i>>2]=4196;r[t+52>>2]=i;r[5637]=(r[5637]|0)+1;i=Zl(27)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}n[i+4>>0]=0;r[i>>2]=4216;r[t+56>>2]=i;r[5637]=(r[5637]|0)+1;i=Zl(27)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}n[i+4>>0]=0;r[i>>2]=4236;r[t+60>>2]=i;r[5637]=(r[5637]|0)+1;i=Zl(27)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}n[i+4>>0]=0;r[i>>2]=4256;r[t+76>>2]=i;r[5637]=(r[5637]|0)+1;i=Zl(27)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[i>>2]=4256;r[t+80>>2]=i;n[i+4>>0]=1;r[5637]=(r[5637]|0)+1;i=Zl(27)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}n[i+4>>0]=0;r[i>>2]=4276;r[t+72>>2]=i;r[5637]=(r[5637]|0)+1;i=Zl(35)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}n[i+4>>0]=0;r[i>>2]=4296;r[i+8>>2]=1;r[i+12>>2]=0;r[t+88>>2]=i;r[5637]=(r[5637]|0)+1;i=Zl(35)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[i>>2]=4296;r[i+8>>2]=1;r[i+12>>2]=0;r[t+84>>2]=i;n[i+4>>0]=1;_=r[e+16>>2]|0;_=(_|0)>80?_:80;i=r[e>>2]|0;if(!i){n[t+12>>0]=1;r[5637]=(r[5637]|0)+1;i=Zl(39)|0;if(!i)c=0;else{r[(i+4+15&-16)+-4>>2]=i;c=i+4+15&-16}i=r[e+8>>2]|0;r[c>>2]=772;s=c+4|0;r[s>>2]=i;r[5637]=(r[5637]|0)+1;i=Zl((i*772|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[c+16>>2]=i;r[c+12>>2]=i;s=r[s>>2]|0;r[c+8>>2]=s;if(s+-1|0){o=r[c>>2]|0;a=s+-1|0;l=i;do{u=l;l=l+o|0;r[u>>2]=l;a=a+-1|0}while((a|0)!=0);i=i+(et(o,s+-1|0)|0)|0}r[i>>2]=0;r[t+8>>2]=c}else{n[t+12>>0]=0;r[t+8>>2]=i}i=r[e+4>>2]|0;if(i|0){n[t+20>>0]=0;r[t+16>>2]=i;return}n[t+20>>0]=1;r[5637]=(r[5637]|0)+1;i=Zl(39)|0;if(!i)c=0;else{r[(i+4+15&-16)+-4>>2]=i;c=i+4+15&-16}i=r[e+12>>2]|0;r[c>>2]=_;s=c+4|0;r[s>>2]=i;i=et(i,_)|0;r[5637]=(r[5637]|0)+1;i=Zl(i+19|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[c+16>>2]=i;r[c+12>>2]=i;s=r[s>>2]|0;r[c+8>>2]=s;if(s+-1|0){o=r[c>>2]|0;a=s+-1|0;l=i;do{u=l;l=l+o|0;r[u>>2]=l;a=a+-1|0}while((a|0)!=0);i=i+(et(o,s+-1|0)|0)|0}r[i>>2]=0;r[t+16>>2]=c;return}function ZM(t){t=t|0;return}function QM(t){t=t|0;Ql(t);return}function $M(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;t=r[e>>2]|0;t=Rk[r[(r[t>>2]|0)+56>>2]&31](t,80)|0;e=r[e>>2]|0;r[t+4>>2]=e;r[t>>2]=3720;n[t+8>>0]=0;r[t+12>>2]=3748;r[t+60>>2]=e;r[t+64>>2]=0;r[t+16>>2]=i;r[t+20>>2]=s;e=yk[r[(r[e>>2]|0)+12>>2]&63](e,r[i+8>>2]|0,r[s+8>>2]|0)|0;r[t+76>>2]=e;s=r[t+60>>2]|0;lk[r[(r[s>>2]|0)+20>>2]&127](s,e);return t|0}function JM(t){t=t|0;Ql(t);return}function tR(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;t=r[e>>2]|0;t=Rk[r[(r[t>>2]|0)+56>>2]&31](t,80)|0;e=r[e>>2]|0;r[t+4>>2]=e;r[t>>2]=3720;n[t+8>>0]=1;r[t+12>>2]=3748;r[t+60>>2]=e;r[t+64>>2]=0;r[t+16>>2]=s;r[t+20>>2]=i;e=yk[r[(r[e>>2]|0)+12>>2]&63](e,r[s+8>>2]|0,r[i+8>>2]|0)|0;r[t+76>>2]=e;s=r[t+60>>2]|0;lk[r[(r[s>>2]|0)+20>>2]&127](s,e);return t|0}function eR(t){t=t|0;Ql(t);return}function iR(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;t=r[e>>2]|0;t=Rk[r[(r[t>>2]|0)+56>>2]&31](t,44)|0;fw(t,e,i,n,0);return t|0}function nR(t){t=t|0;Ql(t);return}function sR(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0,l=0,h=0,c=0,_=0,u=0,d=0;_=r[e>>2]|0;_=Rk[r[(r[_>>2]|0)+56>>2]&31](_,76)|0;fw(_,e,i,s,0);r[_>>2]=3656;n[_+64>>0]=1;r[_+60>>2]=0;r[_+52>>2]=0;r[_+56>>2]=0;r[5637]=(r[5637]|0)+1;t=Zl(83)|0;if(!t)c=0;else{r[(t+4+15&-16)+-4>>2]=t;c=t+4+15&-16}r[c>>2]=4432;a=c+20|0;n[a>>0]=1;l=c+16|0;r[l>>2]=0;e=c+8|0;r[e>>2]=0;h=c+12|0;r[h>>2]=0;n[c+40>>0]=1;r[c+36>>2]=0;r[c+28>>2]=0;r[c+32>>2]=0;n[c+60>>0]=1;r[c+56>>2]=0;r[c+48>>2]=0;r[c+52>>2]=0;r[5637]=(r[5637]|0)+1;t=Zl(43)|0;if(!t)o=0;else{r[(t+4+15&-16)+-4>>2]=t;o=t+4+15&-16}t=r[e>>2]|0;if((t|0)>0){e=0;do{u=o+(e*12|0)|0;d=(r[l>>2]|0)+(e*12|0)|0;r[u>>2]=r[d>>2];r[u+4>>2]=r[d+4>>2];r[u+8>>2]=r[d+8>>2];e=e+1|0}while((e|0)!=(t|0))}t=r[l>>2]|0;if(!t){n[a>>0]=1;r[l>>2]=o;r[h>>2]=2;OR(c);d=_+44|0;r[d>>2]=c;d=i+4|0;d=r[d>>2]|0;d=d+72|0;d=r[d>>2]|0;u=_+68|0;r[u>>2]=d;u=s+4|0;u=r[u>>2]|0;u=u+72|0;u=r[u>>2]|0;d=_+72|0;r[d>>2]=u;return _|0}if(n[a>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0)}r[l>>2]=0;n[a>>0]=1;r[l>>2]=o;r[h>>2]=2;OR(c);d=_+44|0;r[d>>2]=c;d=i+4|0;d=r[d>>2]|0;d=d+72|0;d=r[d>>2]|0;u=_+68|0;r[u>>2]=d;u=s+4|0;u=r[u>>2]|0;u=u+72|0;u=r[u>>2]|0;d=_+72|0;r[d>>2]=u;return _|0}function rR(t){t=t|0;Ql(t);return}function oR(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;t=r[e>>2]|0;t=Rk[r[(r[t>>2]|0)+56>>2]&31](t,44)|0;fw(t,e,i,n,1);return t|0}function aR(t){t=t|0;Ql(t);return}function lR(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;t=r[e>>2]|0;t=Rk[r[(r[t>>2]|0)+56>>2]&31](t,8)|0;r[t+4>>2]=r[e>>2];r[t>>2]=4316;return t|0}function hR(t){t=t|0;Ql(t);return}function cR(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;t=r[e>>2]|0;t=Rk[r[(r[t>>2]|0)+56>>2]&31](t,16)|0;e=r[e>>2]|0;r[t+4>>2]=e;r[t>>2]=4512;n[t+8>>0]=0;r[t+12>>2]=0;r[t+12>>2]=yk[r[(r[e>>2]|0)+12>>2]&63](e,r[i+8>>2]|0,r[s+8>>2]|0)|0;n[t+8>>0]=1;return t|0}function _R(t){t=t|0;Ql(t);return}function uR(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0;o=r[e>>2]|0;o=Rk[r[(r[o>>2]|0)+56>>2]&31](o,20)|0;a=r[e+4>>2]|0;t=n[t+4>>0]|0;e=r[e>>2]|0;r[o+4>>2]=e;r[o>>2]=4540;n[o+8>>0]=0;r[o+12>>2]=a;n[o+16>>0]=t;if(a|0)return o|0;r[o+12>>2]=yk[r[(r[e>>2]|0)+12>>2]&63](e,r[i+8>>2]|0,r[s+8>>2]|0)|0;n[o+8>>0]=1;return o|0}function dR(t){t=t|0;Ql(t);return}function pR(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;t=r[e>>2]|0;t=Rk[r[(r[t>>2]|0)+56>>2]&31](t,16)|0;e=r[e>>2]|0;r[t+4>>2]=e;r[t>>2]=3016;n[t+8>>0]=0;r[t+12>>2]=0;if(!(yk[r[(r[e>>2]|0)+24>>2]&63](e,r[i+8>>2]|0,r[s+8>>2]|0)|0))return t|0;e=r[t+4>>2]|0;r[t+12>>2]=yk[r[(r[e>>2]|0)+12>>2]&63](e,r[i+8>>2]|0,r[s+8>>2]|0)|0;n[t+8>>0]=1;return t|0}function fR(t){t=t|0;Ql(t);return}function mR(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0,l=0,h=0;a=r[e>>2]|0;a=Rk[r[(r[a>>2]|0)+56>>2]&31](a,28)|0;h=(n[t+4>>0]|0)==0;l=r[t+8>>2]|0;o=r[t+12>>2]|0;t=r[e>>2]|0;r[a+4>>2]=t;r[a>>2]=4056;n[a+8>>0]=0;r[a+12>>2]=0;if(h){n[a+16>>0]=0;r[a+20>>2]=l;r[a+24>>2]=o;if(!(yk[r[(r[t>>2]|0)+24>>2]&63](t,r[i+8>>2]|0,r[s+8>>2]|0)|0))return a|0;h=r[a+4>>2]|0;r[a+12>>2]=yk[r[(r[h>>2]|0)+12>>2]&63](h,r[i+8>>2]|0,r[s+8>>2]|0)|0;n[a+8>>0]=1;return a|0}else{n[a+16>>0]=1;r[a+20>>2]=l;r[a+24>>2]=o;if(!(yk[r[(r[t>>2]|0)+24>>2]&63](t,r[s+8>>2]|0,r[i+8>>2]|0)|0))return a|0;h=r[a+4>>2]|0;r[a+12>>2]=yk[r[(r[h>>2]|0)+12>>2]&63](h,r[s+8>>2]|0,r[i+8>>2]|0)|0;n[a+8>>0]=1;return a|0}return 0}function gR(t){t=t|0;Ql(t);return}function bR(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;return}function yR(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;return 1.0}function vR(t,e){t=t|0;e=e|0;return}function SR(t){t=t|0;var e=0;r[t>>2]=4344;e=r[t+300>>2]|0;if(e|0){if(n[t+304>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+300>>2]=0}n[t+304>>0]=1;r[t+300>>2]=0;r[t+292>>2]=0;r[t+296>>2]=0;r[t>>2]=3156;e=r[t+276>>2]|0;if(!e){n[t+280>>0]=1;r[t+276>>2]=0;r[t+268>>2]=0;t=t+272|0;r[t>>2]=0;return}if(n[t+280>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+276>>2]=0;n[t+280>>0]=1;r[t+276>>2]=0;r[t+268>>2]=0;t=t+272|0;r[t>>2]=0;return}function xR(t){t=t|0;var e=0;r[t>>2]=4344;e=r[t+300>>2]|0;if(e|0){if(n[t+304>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+300>>2]=0}n[t+304>>0]=1;r[t+300>>2]=0;r[t+292>>2]=0;r[t+296>>2]=0;r[t>>2]=3156;e=r[t+276>>2]|0;if(e|0){if(n[t+280>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+276>>2]=0}n[t+280>>0]=1;r[t+276>>2]=0;r[t+268>>2]=0;r[t+272>>2]=0;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function wR(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0;o=r[e>>2]|0;e=r[t+292>>2]|0;t:do{if((e|0)>0){s=r[t+300>>2]|0;i=0;while(1){if((r[s+(i<<2)>>2]|0)==(o|0))break;i=i+1|0;if((i|0)>=(e|0))break t}if((i|0)!=(e|0))return}}while(0);if((e|0)==(r[t+296>>2]|0)?(a=e|0?e<<1:1,(e|0)<(a|0)):0){if(!a)s=0;else{r[5637]=(r[5637]|0)+1;e=Zl((a<<2|3)+16|0)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}s=e;e=r[t+292>>2]|0}if((e|0)>0){i=0;do{r[s+(i<<2)>>2]=r[(r[t+300>>2]|0)+(i<<2)>>2];i=i+1|0}while((i|0)!=(e|0))}i=r[t+300>>2]|0;if(i){if(n[t+304>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0);e=r[t+292>>2]|0}r[t+300>>2]=0}n[t+304>>0]=1;r[t+300>>2]=s;r[t+296>>2]=a}r[(r[t+300>>2]|0)+(e<<2)>>2]=o;r[t+292>>2]=e+1;return}function CR(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0,a=0;o=r[t+292>>2]|0;if((o|0)<=0)return;e=r[e>>2]|0;s=r[t+300>>2]|0;i=0;while(1){n=s+(i<<2)|0;if((r[n>>2]|0)==(e|0))break;i=i+1|0;if((i|0)>=(o|0)){a=7;break}}if((a|0)==7)return;if((i|0)>=(o|0))return;r[n>>2]=r[s+(o+-1<<2)>>2];r[t+292>>2]=o+-1;return}function TR(t){t=t|0;var e=0;r[t>>2]=4388;e=r[t+308>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+308>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t>>2]=4344;e=r[t+300>>2]|0;if(e|0){if(n[t+304>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+300>>2]=0}n[t+304>>0]=1;r[t+300>>2]=0;r[t+292>>2]=0;r[t+296>>2]=0;r[t>>2]=3156;e=r[t+276>>2]|0;if(!e){n[t+280>>0]=1;r[t+276>>2]=0;r[t+268>>2]=0;t=t+272|0;r[t>>2]=0;return}if(n[t+280>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+276>>2]=0;n[t+280>>0]=1;r[t+276>>2]=0;r[t+268>>2]=0;t=t+272|0;r[t>>2]=0;return}function AR(t){t=t|0;TR(t);if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function ER(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0,l=0,h=0;if(!i)i=r[t+188>>2]|0;h=r[e>>2]|0;s=r[t+292>>2]|0;t:do{if((s|0)>0){a=r[t+300>>2]|0;o=0;while(1){if((r[a+(o<<2)>>2]|0)==(h|0))break;o=o+1|0;if((o|0)>=(s|0))break t}if((o|0)!=(s|0))return}}while(0);if((s|0)==(r[t+296>>2]|0)?(l=s|0?s<<1:1,(s|0)<(l|0)):0){if(!l)a=0;else{r[5637]=(r[5637]|0)+1;s=Zl((l<<2|3)+16|0)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}a=s;s=r[t+292>>2]|0}if((s|0)>0){o=0;do{r[a+(o<<2)>>2]=r[(r[t+300>>2]|0)+(o<<2)>>2];o=o+1|0}while((o|0)!=(s|0))}o=r[t+300>>2]|0;if(o){if(n[t+304>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0);s=r[t+292>>2]|0}r[t+300>>2]=0}n[t+304>>0]=1;r[t+300>>2]=a;r[t+296>>2]=l}r[(r[t+300>>2]|0)+(s<<2)>>2]=h;r[t+292>>2]=s+1;t=r[t+308>>2]|0;yk[r[(r[t>>2]|0)+8>>2]&63](t,i,e)|0;return}function MR(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0,a=0,l=0,h=0,c=0;h=r[e>>2]|0;if(!n)n=r[t+188>>2]|0;a=r[t+292>>2]|0;if((a|0)<=0)return;l=r[t+300>>2]|0;s=0;while(1){o=l+(s<<2)|0;if((r[o>>2]|0)==(h|0))break;s=s+1|0;if((s|0)>=(a|0)){c=9;break}}if((c|0)==9)return;if((s|0)>=(a|0))return;r[o>>2]=r[l+(a+-1<<2)>>2];r[t+292>>2]=a+-1;c=r[t+308>>2]|0;pk[r[(r[c>>2]|0)+12>>2]&31](c,n,e,i)|0;return}function RR(t){t=t|0;var e=0;r[t+164>>2]=1065353216;r[t+168>>2]=1065353216;r[t+172>>2]=1065353216;h[t+176>>2]=0.0;r[t+180>>2]=0;h[t+184>>2]=999999984306749440.0;r[t+188>>2]=0;r[t+188+4>>2]=0;r[t+188+8>>2]=0;r[t+188+12>>2]=0;r[t+204>>2]=1;r[t+208>>2]=-1;r[t+212>>2]=-1;r[t+216>>2]=1;h[t+220>>2]=0.0;h[t+224>>2]=.5;h[t+228>>2]=0.0;h[t+232>>2]=0.0;r[t+240>>2]=0;r[t+244>>2]=-1;h[t+248>>2]=1.0;h[t+252>>2]=0.0;h[t+256>>2]=0.0;r[t+260>>2]=0;n[t+280>>0]=1;r[t+276>>2]=0;r[t+268>>2]=0;r[t+272>>2]=0;r[t+284>>2]=0;r[t+4>>2]=1065353216;r[t+8>>2]=0;r[t+8+4>>2]=0;r[t+8+8>>2]=0;r[t+8+12>>2]=0;r[t+24>>2]=1065353216;r[t+28>>2]=0;r[t+28+4>>2]=0;r[t+28+8>>2]=0;r[t+28+12>>2]=0;r[t+44>>2]=1065353216;r[t+48>>2]=0;r[t+48+4>>2]=0;r[t+48+8>>2]=0;r[t+48+12>>2]=0;r[t+48+16>>2]=0;n[t+304>>0]=1;r[t+300>>2]=0;r[t+292>>2]=0;r[t+296>>2]=0;r[t+236>>2]=4;r[t>>2]=4388;r[5637]=(r[5637]|0)+1;e=Zl(91)|0;if(!e){e=0;WL(e);t=t+308|0;r[t>>2]=e;return}r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16;WL(e);t=t+308|0;r[t>>2]=e;return}function IR(t,e,i,n,s,o){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=+o;var a=0.0,l=0,c=0.0,u=0,p=0.0,f=0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0,R=0,I=0.0,P=0.0,L=0.0,D=0,k=0,O=0,F=0,B=0.0,N=0.0,U=0.0,V=0.0;F=_;_=_+288|0;r[F+144>>2]=r[i>>2];r[F+144+4>>2]=r[i+4>>2];r[F+144+8>>2]=r[i+8>>2];r[F+144+12>>2]=r[i+12>>2];r[F+144+16>>2]=r[i+16>>2];r[F+144+16+4>>2]=r[i+16+4>>2];r[F+144+16+8>>2]=r[i+16+8>>2];r[F+144+16+12>>2]=r[i+16+12>>2];r[F+144+32>>2]=r[i+32>>2];r[F+144+32+4>>2]=r[i+32+4>>2];r[F+144+32+8>>2]=r[i+32+8>>2];r[F+144+32+12>>2]=r[i+32+12>>2];r[F+144+48>>2]=r[i+48>>2];r[F+144+48+4>>2]=r[i+48+4>>2];r[F+144+48+8>>2]=r[i+48+8>>2];r[F+144+48+12>>2]=r[i+48+12>>2];r[F+80>>2]=r[n>>2];r[F+80+4>>2]=r[n+4>>2];r[F+80+8>>2]=r[n+8>>2];r[F+80+12>>2]=r[n+12>>2];r[F+80+16>>2]=r[n+16>>2];r[F+80+16+4>>2]=r[n+16+4>>2];r[F+80+16+8>>2]=r[n+16+8>>2];r[F+80+16+12>>2]=r[n+16+12>>2];r[F+80+32>>2]=r[n+32>>2];r[F+80+32+4>>2]=r[n+32+4>>2];r[F+80+32+8>>2]=r[n+32+8>>2];r[F+80+32+12>>2]=r[n+32+12>>2];r[F+80+48>>2]=r[n+48>>2];r[F+80+48+4>>2]=r[n+48+4>>2];r[F+80+48+8>>2]=r[n+48+8>>2];r[F+80+48+12>>2]=r[n+48+12>>2];c=+h[F+80+52>>2]-+h[F+144+52>>2];V=+h[F+80+56>>2]-+h[F+144+56>>2];h[F+32>>2]=+h[F+80+48>>2]-+h[F+144+48>>2];h[F+32+4>>2]=c;h[F+32+8>>2]=V;h[F+32+12>>2]=0.0;qx(F+144|0,F+80|0,F+224|0,F+208|0);V=+h[F+208>>2];c=V*+h[F+224+4>>2];B=V*+h[F+224+8>>2];h[F+16>>2]=+h[F+224>>2]*V;h[F+16+4>>2]=c;h[F+16+8>>2]=B;h[F+16+12>>2]=0.0;r[F+224+4>>2]=0;r[F+224+4+4>>2]=0;r[F+224+24>>2]=0;r[F+224+24+4>>2]=0;O=F+224+44|0;r[O>>2]=0;r[O+4>>2]=0;r[O+8>>2]=0;r[O+12>>2]=0;r[O+16>>2]=0;Kx(F+144|0,F);B=+h[F>>2];c=+h[F+4>>2];V=+h[F+8>>2];N=+h[F+12>>2];a=B*(2.0/(B*B+c*c+V*V+N*N));p=c*(2.0/(B*B+c*c+V*V+N*N));U=V*(2.0/(B*B+c*c+V*V+N*N));h[F+224>>2]=1.0-(c*p+V*U);h[F+224+4>>2]=B*p-N*U;h[F+224+8>>2]=B*U+N*p;h[F+224+12>>2]=0.0;h[F+224+16>>2]=B*p+N*U;h[F+224+20>>2]=1.0-(B*a+V*U);h[F+224+24>>2]=c*U-N*a;h[F+224+28>>2]=0.0;h[F+224+32>>2]=B*U-N*p;h[F+224+36>>2]=c*U+N*a;h[F+224+40>>2]=1.0-(B*a+c*p);h[O>>2]=0.0;vC(e,F+224|0,F+32|0,F+16|0,F+64|0,F+48|0);if((r[t+292>>2]|0)<=0){_=F;return}k=0;do{f=r[(r[t+300>>2]|0)+(k<<2)>>2]|0;if(Rk[r[(r[s>>2]|0)+8>>2]&31](s,r[f+188>>2]|0)|0?(M=r[f+192>>2]|0,jk[r[(r[M>>2]|0)+8>>2]&127](M,f+4|0,F+208|0,F+32|0),m=+h[F+208>>2]+ +h[F+64>>2],g=+h[F+208+4>>2]+ +h[F+64+4>>2],b=+h[F+208+8>>2]+ +h[F+64+8>>2],h[F+208>>2]=m,h[F+208+4>>2]=g,h[F+208+8>>2]=b,h[F+208+12>>2]=0.0,y=+h[F+32>>2]+ +h[F+48>>2],v=+h[F+32+4>>2]+ +h[F+48+4>>2],S=+h[F+32+8>>2]+ +h[F+48+8>>2],h[F+32>>2]=y,h[F+32+4>>2]=v,h[F+32+8>>2]=S,h[F+32+12>>2]=0.0,x=+h[i+48>>2]-(y+m)*.5,w=+h[i+52>>2]-(v+g)*.5,C=+h[i+56>>2]-(S+b)*.5,T=+h[n+48>>2]-(y+m)*.5,A=+h[n+52>>2]-(v+g)*.5,E=+h[n+56>>2]-(S+b)*.5,M=x<-((y-m)*.5)|(x>(y-m)*.5?8:0)|(w<-((v-g)*.5)?2:0)|(w>(v-g)*.5?16:0)|(C<-((S-b)*.5)?4:0)|(C>(S-b)*.5?32:0),R=T<-((y-m)*.5)|(T>(y-m)*.5?8:0)|(A<-((v-g)*.5)?2:0)|(A>(v-g)*.5?16:0)|(E<-((S-b)*.5)?4:0)|(E>(S-b)*.5?32:0),(M&R|0)==0):0){D=1;O=0;a=0.0;l=1065353216;p=1.0;while(1){if(!(D&M)){if((D&R|0)!=0?(I=(-x-p*((y-m)*.5))/(T-x),I<(r[d>>2]=l,+h[d>>2])):0)l=(h[d>>2]=I,r[d>>2]|0)}else{c=(-x-p*((y-m)*.5))/(T-x);if(a<=c)a=c}u=D<<1;if(!(u&M))if((u&R|0)!=0?(P=(-w-p*((v-g)*.5))/(A-w),P<(r[d>>2]=l,+h[d>>2])):0){c=a;l=(h[d>>2]=P,r[d>>2]|0)}else c=a;else{c=(-w-p*((v-g)*.5))/(A-w);if(!(a<=c))c=a}u=D<<2;if(!(u&M))if((u&R|0)!=0?(L=(-C-p*((S-b)*.5))/(E-C),L<(r[d>>2]=l,+h[d>>2])):0){a=c;l=(h[d>>2]=L,r[d>>2]|0)}else a=c;else{a=(-C-p*((S-b)*.5))/(E-C);if(!(c<=a))a=c}O=O+1|0;if((O|0)==2)break;else{D=D<<3;p=-1.0}}if(a<=(r[d>>2]=l,+h[d>>2])){O=r[f+192>>2]|0;r[F+224>>2]=0;r[F+224+4>>2]=O;r[F+224+8>>2]=f;r[F+224+12>>2]=f+4;r[F+224+16>>2]=-1;r[F+224+20>>2]=-1;Nx(e,F+144|0,F+80|0,F+224|0,s,o)}}k=k+1|0}while((k|0)<(r[t+292>>2]|0));_=F;return}function PR(t){t=t|0;var e=0;r[t>>2]=4432;e=r[t+56>>2]|0;if(e|0){if(n[t+60>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+56>>2]=0}n[t+60>>0]=1;r[t+56>>2]=0;r[t+48>>2]=0;r[t+52>>2]=0;e=r[t+36>>2]|0;if(e|0){if(n[t+40>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+36>>2]=0}n[t+40>>0]=1;r[t+36>>2]=0;r[t+28>>2]=0;r[t+32>>2]=0;e=r[t+16>>2]|0;if(!e){n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;t=t+12|0;r[t>>2]=0;return}if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+16>>2]=0;n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;t=t+12|0;r[t>>2]=0;return}function LR(t){t=t|0;PR(t);Ql(t);return}function DR(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0,a=0,l=0,h=0,c=0,_=0,u=0,d=0;r[4990]=(r[4990]|0)+1;o=((i<<16|e)+~((i<<16|e)<<15)>>10^(i<<16|e)+~((i<<16|e)<<15))*9|0;_=r[t+36>>2]|0;o=_+(((r[t+12>>2]|0)+-1&((o>>6^o)+~((o>>6^o)<<11)>>16^(o>>6^o)+~((o>>6^o)<<11)))<<2)|0;s=r[o>>2]|0;if((s|0)==-1){d=0;return d|0}u=r[t+16>>2]|0;n=s;while(1){c=u+(n*12|0)|0;if((r[c>>2]|0)==(e|0)?(r[u+(n*12|0)+4>>2]|0)==(i|0):0)break;n=r[(r[t+56>>2]|0)+(n<<2)>>2]|0;if((n|0)==-1){n=0;d=21;break}}if((d|0)==21)return n|0;if(!c){d=0;return d|0}h=r[u+(n*12|0)+8>>2]|0;l=(n*12|0)/12|0;e=r[t+56>>2]|0;if((s|0)!=(l|0)){while(1){i=e+(s<<2)|0;n=r[i>>2]|0;if((n|0)==(l|0))break;else s=n}n=r[e+(l<<2)>>2]|0;if((s|0)==-1)d=11;else r[i>>2]=n}else{n=r[e+(s<<2)>>2]|0;d=11}if((d|0)==11)r[o>>2]=n;o=(r[t+8>>2]|0)+-1|0;if((o|0)==(l|0)){r[t+8>>2]=l;d=h;return d|0}a=r[u+(o*12|0)+4>>2]<<16|r[u+(o*12|0)>>2];a=(a+~(a<<15)>>10^a+~(a<<15))*9|0;a=((a>>6^a)+~((a>>6^a)<<11)>>16^(a>>6^a)+~((a>>6^a)<<11))&(r[t+12>>2]|0)+-1;n=r[_+(a<<2)>>2]|0;e=r[t+56>>2]|0;if((n|0)!=(o|0)){s=n;while(1){i=e+(s<<2)|0;n=r[i>>2]|0;if((n|0)==(o|0))break;else s=n}n=r[e+(o<<2)>>2]|0;if((s|0)==-1)d=19;else r[i>>2]=n}else{n=r[e+(o<<2)>>2]|0;d=19}if((d|0)==19)r[_+(a<<2)>>2]=n;r[c>>2]=r[u+(o*12|0)>>2];r[c+4>>2]=r[u+(o*12|0)+4>>2];r[c+8>>2]=r[u+(o*12|0)+8>>2];d=(r[t+36>>2]|0)+(a<<2)|0;r[(r[t+56>>2]|0)+(l<<2)>>2]=r[d>>2];r[d>>2]=l;r[t+8>>2]=(r[t+8>>2]|0)+-1;d=h;return d|0}function kR(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0,l=0,h=0,c=0,_=0,u=0,d=0;r[4991]=(r[4991]|0)+1;c=((i<<16|e)+~((i<<16|e)<<15)>>10^(i<<16|e)+~((i<<16|e)<<15))*9|0;c=(c>>6^c)+~((c>>6^c)<<11)>>16^(c>>6^c)+~((c>>6^c)<<11);_=r[t+12>>2]|0;s=r[(r[t+36>>2]|0)+((_+-1&c)<<2)>>2]|0;t:do{if((s|0)!=-1){a=r[t+16>>2]|0;while(1){o=a+(s*12|0)|0;if((r[o>>2]|0)==(e|0)?(r[a+(s*12|0)+4>>2]|0)==(i|0):0)break;s=r[(r[t+56>>2]|0)+(s<<2)>>2]|0;if((s|0)==-1)break t}if(o|0){t=o;return t|0}}}while(0);h=r[t+8>>2]|0;if((h|0)==(_|0)){a=_|0?_<<1:1;if((_|0)<(a|0)){if(!a){s=0;o=_}else{r[5637]=(r[5637]|0)+1;s=Zl((a*12|3)+16|0)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}o=r[t+8>>2]|0}if((o|0)>0){l=0;do{u=s+(l*12|0)|0;d=(r[t+16>>2]|0)+(l*12|0)|0;r[u>>2]=r[d>>2];r[u+4>>2]=r[d+4>>2];r[u+8>>2]=r[d+8>>2];l=l+1|0}while((l|0)!=(o|0))}o=r[t+16>>2]|0;if(o|0){if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+16>>2]=0}n[t+20>>0]=1;r[t+16>>2]=s;r[t+12>>2]=a;s=r[t+8>>2]|0}else{s=_;a=_}}else{s=h;a=_}r[t+8>>2]=s+1;o=r[t+16>>2]|0;if((_|0)<(a|0)){OR(t);s=(r[t+12>>2]|0)+-1&c}else s=_+-1&c;r[o+(h*12|0)>>2]=e;r[o+(h*12|0)+4>>2]=i;r[o+(h*12|0)+8>>2]=0;d=(r[t+36>>2]|0)+(s<<2)|0;r[(r[t+56>>2]|0)+(h<<2)>>2]=r[d>>2];r[d>>2]=h;d=o+(h*12|0)|0;return d|0}function OR(t){t=t|0;var e=0,i=0,s=0,o=0,a=0,l=0,h=0;l=r[t+12>>2]|0;h=r[t+28>>2]|0;if((l|0)<=(h|0))return;if((l|0)>=(h|0)){do{if((r[t+32>>2]|0)<(l|0)){if(!l){e=0;i=h}else{r[5637]=(r[5637]|0)+1;e=Zl((l<<2|3)+16|0)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}i=r[t+28>>2]|0}s=r[t+36>>2]|0;if((i|0)<=0){if(!s){n[t+40>>0]=1;r[t+36>>2]=e;r[t+32>>2]=l;break}}else{o=0;do{r[e+(o<<2)>>2]=r[s+(o<<2)>>2];o=o+1|0}while((o|0)!=(i|0))}if(n[t+40>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}n[t+40>>0]=1;r[t+36>>2]=e;r[t+32>>2]=l}else e=r[t+36>>2]|0}while(0);Ph(e+(h<<2)|0,0,l-h<<2|0)|0}r[t+28>>2]=l;a=r[t+48>>2]|0;if((l|0)>(a|0)){do{if((r[t+52>>2]|0)<(l|0)){if(!l){e=0;i=a}else{r[5637]=(r[5637]|0)+1;e=Zl((l<<2|3)+16|0)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}i=r[t+48>>2]|0}s=r[t+56>>2]|0;if((i|0)<=0){if(!s){n[t+60>>0]=1;r[t+56>>2]=e;r[t+52>>2]=l;break}}else{o=0;do{r[e+(o<<2)>>2]=r[s+(o<<2)>>2];o=o+1|0}while((o|0)!=(i|0))}if(n[t+60>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}n[t+60>>0]=1;r[t+56>>2]=e;r[t+52>>2]=l}else e=r[t+56>>2]|0}while(0);Ph(e+(a<<2)|0,0,l-a<<2|0)|0}r[t+48>>2]=l;if((l|0)>0){Ph(r[t+36>>2]|0,-1,l<<2|0)|0;Ph(r[t+56>>2]|0,-1,l<<2|0)|0}if((h|0)<=0)return;e=r[t+16>>2]|0;i=r[t+36>>2]|0;s=r[t+56>>2]|0;o=0;do{l=r[e+(o*12|0)+4>>2]<<16|r[e+(o*12|0)>>2];l=(l+~(l<<15)>>10^l+~(l<<15))*9|0;l=i+((((l>>6^l)+~((l>>6^l)<<11)>>16^(l>>6^l)+~((l>>6^l)<<11))&(r[t+12>>2]|0)+-1)<<2)|0;r[s+(o<<2)>>2]=r[l>>2];r[l>>2]=o;o=o+1|0}while((o|0)!=(h|0));return}function FR(t){t=t|0;return r[t+16>>2]|0}function BR(t){t=t|0;var e=0,i=0,s=0,o=0,a=0;e=r[t+16>>2]|0;if(e|0){if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+16>>2]=0}n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;r[t+12>>2]=0;e=r[t+36>>2]|0;if(e|0){if(n[t+40>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+36>>2]=0}n[t+40>>0]=1;r[t+36>>2]=0;r[t+28>>2]=0;r[t+32>>2]=0;e=r[t+56>>2]|0;if(e|0){if(n[t+60>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+56>>2]=0}n[t+60>>0]=1;r[t+56>>2]=0;r[t+48>>2]=0;r[t+52>>2]=0;if((r[t+12>>2]|0)>=2){OR(t);return}r[5637]=(r[5637]|0)+1;e=Zl(43)|0;if(!e)s=0;else{r[(e+4+15&-16)+-4>>2]=e;s=e+4+15&-16}e=r[t+8>>2]|0;if((e|0)>0){i=0;do{o=s+(i*12|0)|0;a=(r[t+16>>2]|0)+(i*12|0)|0;r[o>>2]=r[a>>2];r[o+4>>2]=r[a+4>>2];r[o+8>>2]=r[a+8>>2];i=i+1|0}while((i|0)!=(e|0))}e=r[t+16>>2]|0;if(e|0){if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+16>>2]=0}n[t+20>>0]=1;r[t+16>>2]=s;r[t+12>>2]=2;OR(t);return}function NR(t){t=t|0;Ql(t);return}function UR(t,e,i,s){t=t|0;e=e|0;i=i|0;s=+s;var o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0,m=0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0,C=0,T=0,A=0,E=0,M=0,R=0,I=0;M=_;_=_+192|0;T=r[t+4>>2]|0;if(+h[T+752>>2]<s){_=M;return}E=r[T+740>>2]|0;C=(r[t+8>>2]|0)+8|0;A=r[C>>2]|0;a=+h[i>>2];g=+h[e>>2]*s+a;l=+h[i+4>>2];b=+h[e+4>>2]*s+l;o=+h[i+8>>2];y=+h[e+8>>2]*s+o;w=(r[t+12>>2]|0)+8|0;f=r[w>>2]|0;c=+h[f+52>>2];u=+h[f+56>>2];if((E|0)!=(A|0)){x=y-+h[f+60>>2];a=a-+h[A+52>>2];l=l-+h[A+56>>2];o=o-+h[A+60>>2];v=(g-c)*+h[f+4>>2]+(b-u)*+h[f+20>>2]+x*+h[f+36>>2];S=(g-c)*+h[f+8>>2]+(b-u)*+h[f+24>>2]+x*+h[f+40>>2];x=(g-c)*+h[f+12>>2]+(b-u)*+h[f+28>>2]+x*+h[f+44>>2];d=a*+h[A+4>>2]+l*+h[A+20>>2]+o*+h[A+36>>2];p=a*+h[A+8>>2]+l*+h[A+24>>2]+o*+h[A+40>>2];o=a*+h[A+12>>2]+l*+h[A+28>>2]+o*+h[A+44>>2]}else{p=g-+h[E+52>>2];d=b-+h[E+56>>2];x=y-+h[E+60>>2];o=o-+h[f+60>>2];v=p*+h[E+4>>2]+d*+h[E+20>>2]+x*+h[E+36>>2];S=p*+h[E+8>>2]+d*+h[E+24>>2]+x*+h[E+40>>2];x=p*+h[E+12>>2]+d*+h[E+28>>2]+x*+h[E+44>>2];d=(a-c)*+h[f+4>>2]+(l-u)*+h[f+20>>2]+o*+h[f+36>>2];p=(a-c)*+h[f+8>>2]+(l-u)*+h[f+24>>2]+o*+h[f+40>>2];o=(a-c)*+h[f+12>>2]+(l-u)*+h[f+28>>2]+o*+h[f+44>>2]}h[M>>2]=v;h[M+4>>2]=S;h[M+8>>2]=x;h[M+12>>2]=0.0;h[M+16>>2]=d;h[M+20>>2]=p;h[M+24>>2]=o;h[M+28>>2]=0.0;r[M+64>>2]=r[e>>2];r[M+64+4>>2]=r[e+4>>2];r[M+64+8>>2]=r[e+8>>2];r[M+64+12>>2]=r[e+12>>2];h[M+80>>2]=s;h[M+84>>2]=0.0;h[M+88>>2]=0.0;h[M+92>>2]=0.0;r[M+112>>2]=0;n[M+116>>0]=0;r[M+120>>2]=0;r[M+120+4>>2]=0;r[M+120+8>>2]=0;r[M+120+12>>2]=0;r[M+120+16>>2]=0;r[M+120+20>>2]=0;r[M+120+24>>2]=0;r[M+120+28>>2]=0;h[M+48>>2]=g;h[M+52>>2]=b;h[M+56>>2]=y;h[M+60>>2]=0.0;r[M+32>>2]=r[i>>2];r[M+32+4>>2]=r[i+4>>2];r[M+32+8>>2]=r[i+8>>2];r[M+32+12>>2]=r[i+12>>2];o=+h[T+752>>2];i=r[T+748>>2]|0;if((i|0)>0){m=0;f=-1;c=o*o;while(1){o=+h[T+4+(m*184|0)>>2]-v;a=+h[T+4+(m*184|0)+4>>2]-S;l=+h[T+4+(m*184|0)+8>>2]-x;e=o*o+a*a+l*l<c;f=e?m:f;m=m+1|0;if((m|0)==(i|0))break;else c=e?o*o+a*a+l*l:c}}else f=-1;m=r[C>>2]|0;C=r[w>>2]|0;o=+h[m+224>>2]*+h[C+224>>2];o=o<-10.0?-10.0:o;h[M+84>>2]=o>10.0?10.0:o;h[M+92>>2]=+h[m+228>>2]*+h[C+228>>2];o=+h[m+232>>2]*+h[C+232>>2];o=o<-10.0?-10.0:o;h[M+88>>2]=o>10.0?10.0:o;o=+h[M+72>>2];C=+W(+o)>.7071067690849304;c=+h[M+68>>2];if(C){x=1.0/+G(+(o*o+c*c));d=+h[M+64>>2];u=-(x*c*d);d=d*-(x*o);p=-(x*o);a=(o*o+c*c)*x;l=0.0;o=x*c}else{a=+h[M+64>>2];l=1.0/+G(+(a*a+c*c));u=o*-(c*l);d=(a*a+c*c)*l;p=l*a;a=-(l*a*o);l=-(c*l);o=0.0}h[M+152>>2]=l;h[M+156>>2]=p;h[M+160>>2]=o;h[M+168>>2]=a;h[M+172>>2]=u;h[M+176>>2]=d;w=r[t+20>>2]|0;m=r[t+16>>2]|0;C=r[t+28>>2]|0;t=r[t+24>>2]|0;r[M+96>>2]=(E|0)!=(A|0)?w:m;r[M+100>>2]=(E|0)!=(A|0)?m:w;r[M+104>>2]=(E|0)!=(A|0)?C:t;r[M+108>>2]=(E|0)!=(A|0)?t:C;if((f|0)>-1){t=T+4+(f*184|0)+148|0;E=r[t>>2]|0;i=T+4+(f*184|0)+120|0;e=r[i>>2]|0;w=T+4+(f*184|0)+124|0;m=r[w>>2]|0;A=T+4+(f*184|0)+128|0;C=r[A>>2]|0;R=T+4+(f*184|0)+112|0;I=r[R>>2]|0;Oh(T+4+(f*184|0)|0,M|0,184)|0;r[R>>2]=I;r[i>>2]=e;r[w>>2]=m;r[A>>2]=C;r[t>>2]=E}else _S(T,M)|0;_=M;return}function VR(t){t=t|0;var e=0;r[t>>2]=4488;e=r[t+56>>2]|0;if(e|0){if(n[t+60>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+56>>2]=0}n[t+60>>0]=1;r[t+56>>2]=0;r[t+48>>2]=0;r[t+52>>2]=0;e=r[t+36>>2]|0;if(e|0){if(n[t+40>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+36>>2]=0}n[t+40>>0]=1;r[t+36>>2]=0;r[t+28>>2]=0;r[t+32>>2]=0;e=r[t+16>>2]|0;if(!e){e=t+12|0;n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;r[e>>2]=0;return}if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+16>>2]=0;e=t+12|0;n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;r[e>>2]=0;return}function zR(t){t=t|0;VR(t);Ql(t);return}function WR(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0,l=0,c=0,_=0,u=0;s=r[e+8>>2]|0;if((s|0)>0){o=r[e+16>>2]|0;l=0;i=0;do{a=r[o+(l<<2)>>2]|0;if(!(r[a+204>>2]&3)){r[a+208>>2]=i;i=i+1|0}r[a+212>>2]=-1;h[a+248>>2]=1.0;l=l+1|0}while((l|0)!=(s|0));l=i}else l=0;a=r[t+8>>2]|0;if((a|0)<(l|0)){if((r[t+12>>2]|0)<(l|0)){if(!l){i=0;s=a}else{r[5637]=(r[5637]|0)+1;i=Zl((l<<3|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}s=r[t+8>>2]|0}if((s|0)>0){o=0;do{u=(r[t+16>>2]|0)+(o<<3)|0;c=r[u+4>>2]|0;_=i+(o<<3)|0;r[_>>2]=r[u>>2];r[_+4>>2]=c;o=o+1|0}while((o|0)!=(s|0))}s=r[t+16>>2]|0;if(s|0){if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[t+16>>2]=0}n[t+20>>0]=1;r[t+16>>2]=i;r[t+12>>2]=l;s=t+16|0}else s=t+16|0;i=a;do{u=(r[s>>2]|0)+(i<<3)|0;r[u>>2]=0;r[u+4>>2]=0;i=i+1|0}while((i|0)!=(l|0))}r[t+8>>2]=l;if((l|0)>0){i=r[t+16>>2]|0;s=0;do{r[i+(s<<3)>>2]=s;r[i+(s<<3)+4>>2]=1;s=s+1|0}while((s|0)!=(l|0))}i=r[e+68>>2]|0;i=ck[r[(r[i>>2]|0)+36>>2]&127](i)|0;_=ck[r[(r[i>>2]|0)+36>>2]&127](i)|0;if(!_)return;e=ck[r[(r[i>>2]|0)+20>>2]&127](i)|0;if((_|0)<=0)return;c=0;do{i=r[r[e+(c<<4)>>2]>>2]|0;s=r[r[e+(c<<4)+4>>2]>>2]|0;if((i|0?s|0?(r[i+204>>2]&7|0)==0:0:0)?(r[s+204>>2]&7|0)==0:0){a=r[i+208>>2]|0;i=r[s+208>>2]|0;l=r[t+16>>2]|0;s=r[l+(a<<3)>>2]|0;if((s|0)!=(a|0)){o=l+(a<<3)|0;do{a=l+(s<<3)|0;r[o>>2]=r[a>>2];a=r[a>>2]|0;o=l+(a<<3)|0;s=r[o>>2]|0}while((a|0)!=(s|0))}s=r[l+(i<<3)>>2]|0;if((s|0)!=(i|0)){o=l+(i<<3)|0;do{i=l+(s<<3)|0;r[o>>2]=r[i>>2];i=r[i>>2]|0;o=l+(i<<3)|0;s=r[o>>2]|0}while((i|0)!=(s|0))}if((a|0)!=(i|0)){r[l+(a<<3)>>2]=i;u=l+(i<<3)+4|0;r[u>>2]=(r[u>>2]|0)+(r[l+(a<<3)+4>>2]|0)}}c=c+1|0}while((c|0)!=(_|0));return}function GR(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0,a=0,l=0,h=0,c=0;c=r[e+8>>2]|0;if((c|0)<=0)return;l=r[e+16>>2]|0;h=0;e=0;do{a=r[l+(h<<2)>>2]|0;if(!(r[a+204>>2]&3)){o=r[t+16>>2]|0;n=o+(e<<3)|0;i=r[n>>2]|0;if((i|0)==(e|0))i=e;else{s=i;do{i=o+(s<<3)|0;r[n>>2]=r[i>>2];i=r[i>>2]|0;n=o+(i<<3)|0;s=r[n>>2]|0}while((i|0)!=(s|0))}r[a+208>>2]=i;r[o+(e<<3)+4>>2]=h;r[a+212>>2]=-1;e=e+1|0}else{r[a+208>>2]=-1;r[a+212>>2]=-2}h=h+1|0}while((h|0)!=(c|0));return}function jR(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0,l=0,c=0,u=0,d=0,p=0,f=0,m=0,g=0,b=0,y=0,v=0;v=_;_=_+16|0;j_(12530);o=r[t+28>>2]|0;if((o|0)<0){if((r[t+32>>2]|0)<0){a=r[t+36>>2]|0;if(a|0){if(n[t+40>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+36>>2]=0}n[t+40>>0]=1;r[t+36>>2]=0;r[t+32>>2]=0}do{r[(r[t+36>>2]|0)+(o<<2)>>2]=0;o=o+1|0}while((o|0)!=0)}r[t+28>>2]=0;c=r[t+8>>2]|0;if((c|0)>0){u=r[t+16>>2]|0;p=0;do{d=u+(p<<3)|0;o=r[d>>2]|0;if((o|0)==(p|0))o=p;else{a=o;l=d;do{o=u+(a<<3)|0;r[l>>2]=r[o>>2];o=r[o>>2]|0;l=u+(o<<3)|0;a=r[l>>2]|0}while((o|0)!=(a|0))}r[d>>2]=o;p=p+1|0}while((p|0)!=(c|0));if((c|0)>1){iI(t+4|0,0,c+-1|0);c=r[t+8>>2]|0}if((c|0)>0){p=r[t+16>>2]|0;a=0;while(1){f=r[p+(a<<3)>>2]|0;b=a;while(1){g=b+1|0;if((g|0)>=(c|0)){d=0;break}if((r[p+(g<<3)>>2]|0)==(f|0))b=g;else{d=1;break}}t:do{if((a|0)<=(b|0)){m=r[i+16>>2]|0;o=1;u=a;while(1){l=r[m+(r[p+(u<<3)+4>>2]<<2)>>2]|0;if((r[l+208>>2]|0)==(f|0)){l=r[l+216>>2]|0;o=(l|0)!=4&(o&(l|0)!=1)}if((u|0)<(b|0))u=u+1|0;else break}if(o){o=p;while(1){o=r[m+(r[o+(a<<3)+4>>2]<<2)>>2]|0;if((r[o+208>>2]|0)==(f|0)?(r[o+216>>2]&-2|0)!=4:0)r[o+216>>2]=2;if((a|0)>=(b|0))break t;o=r[t+16>>2]|0;a=a+1|0}}else{o=p;while(1){o=r[m+(r[o+(a<<3)+4>>2]<<2)>>2]|0;if((r[o+208>>2]|0)==(f|0)?(r[o+216>>2]|0)==2:0){r[o+216>>2]=3;h[o+220>>2]=0.0}if((a|0)>=(b|0))break t;o=r[t+16>>2]|0;a=a+1|0}}}}while(0);if(d)a=g;else break}}}u=ck[r[(r[e>>2]|0)+36>>2]&127](e)|0;if((u|0)>0){d=0;do{c=Rk[r[(r[e>>2]|0)+40>>2]&31](e,d)|0;a=r[c+740>>2]|0;l=r[c+744>>2]|0;if((a|0)!=0?(r[a+216>>2]|0)!=2:0)o=44;else o=42;if(((o|0)==42?(o=0,l|0):0)?(r[l+216>>2]|0)!=2:0)o=44;if((o|0)==44){o=r[a+204>>2]|0;if((o&2|0?(o&4|0)==0?(r[a+216>>2]|0)!=2:0:0)?(r[l+204>>2]&3|0)==0:0){if((r[l+216>>2]&-2|0)!=4)r[l+216>>2]=1;h[l+220>>2]=0.0}b=r[l+204>>2]|0;if(b&2|0?(b&4|o&3|0)==0?(r[l+216>>2]|0)!=2:0:0){if((r[a+216>>2]&-2|0)!=4)r[a+216>>2]=1;h[a+220>>2]=0.0}if(n[t+64>>0]|0?yk[r[(r[e>>2]|0)+28>>2]&63](e,a,l)|0:0){o=r[t+28>>2]|0;if((o|0)==(r[t+32>>2]|0)?(y=o|0?o<<1:1,(o|0)<(y|0)):0){if(!y)l=0;else{r[5637]=(r[5637]|0)+1;o=Zl((y<<2|3)+16|0)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}l=o;o=r[t+28>>2]|0}if((o|0)>0){a=0;do{r[l+(a<<2)>>2]=r[(r[t+36>>2]|0)+(a<<2)>>2];a=a+1|0}while((a|0)!=(o|0))}a=r[t+36>>2]|0;if(a){if(n[t+40>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0);o=r[t+28>>2]|0}r[t+36>>2]=0}n[t+40>>0]=1;r[t+36>>2]=l;r[t+32>>2]=y}r[(r[t+36>>2]|0)+(o<<2)>>2]=c;r[t+28>>2]=o+1}}d=d+1|0}while((d|0)<(u|0))}o=r[2006]|0;y=(r[o+16>>2]|0)+-1|0;r[o+16>>2]=y;do{if(!y){if(r[o+4>>2]|0){de(v|0,0)|0;y=r[5649]|0;h[o+8>>2]=+h[o+8>>2]+ +(((r[v+4>>2]|0)-(r[y+4>>2]|0)+(((r[v>>2]|0)-(r[y>>2]|0)|0)*1e6|0)-(r[o+12>>2]|0)|0)>>>0)/1.0e3;if(r[o+16>>2]|0)break;o=r[2006]|0}r[2006]=r[o+20>>2]}}while(0);y=r[t+8>>2]|0;j_(12558);if(n[t+64>>0]|0){g=r[t+28>>2]|0;if((g|0)>1)HR(t+24|0,0,g+-1|0);if((y|0)>0){f=1;a=0;b=0;while(1){o=r[t+16>>2]|0;m=r[o+(a<<3)>>2]|0;t:do{if((a|0)<(y|0)){u=r[t+48>>2]|0;l=r[t+52>>2]|0;p=1;while(1){d=r[(r[i+16>>2]|0)+(r[o+(a<<3)+4>>2]<<2)>>2]|0;if((u|0)==(l|0)){u=l|0?l<<1:1;if((l|0)<(u|0)){if(!u)o=0;else{r[5637]=(r[5637]|0)+1;o=Zl((u<<2|3)+16|0)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}l=r[t+48>>2]|0}if((l|0)>0){c=0;do{r[o+(c<<2)>>2]=r[(r[t+56>>2]|0)+(c<<2)>>2];c=c+1|0}while((c|0)!=(l|0))}c=r[t+56>>2]|0;if(c){if(n[t+60>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[c+-4>>2]|0);l=r[t+48>>2]|0}r[t+56>>2]=0}n[t+60>>0]=1;r[t+56>>2]=o;r[t+52>>2]=u;o=l;l=u}else o=l}else o=u;r[(r[t+56>>2]|0)+(o<<2)>>2]=d;u=o+1|0;r[t+48>>2]=u;c=r[d+216>>2]|0;c=p&((c|0)==2|(c|0)==5);a=a+1|0;if((a|0)>=(y|0)){p=a;break t}o=r[t+16>>2]|0;if((r[o+(a<<3)>>2]|0)!=(m|0)){p=a;break}else p=c}}else{p=a;c=1}}while(0);if((b|0)<(g|0)){d=r[t+36>>2]|0;o=d+(b<<2)|0;l=r[o>>2]|0;a=r[(r[l+740>>2]|0)+208>>2]|0;if((a|0)<=-1)a=r[(r[l+744>>2]|0)+208>>2]|0;if((a|0)==(m|0)){u=b;do{u=u+1|0;if((u|0)>=(g|0))break;l=r[d+(u<<2)>>2]|0;a=r[(r[l+740>>2]|0)+208>>2]|0;if((a|0)<=-1)a=r[(r[l+744>>2]|0)+208>>2]|0}while((m|0)==(a|0));l=u;a=u-b|0}else{l=f;a=0;o=0}}else{l=f;a=0;o=0}if(!c)vk[r[(r[s>>2]|0)+8>>2]&7](s,r[t+56>>2]|0,r[t+48>>2]|0,o,a,m);b=(a|0)==0?b:l;o=r[t+48>>2]|0;if((o|0)<0){if((r[t+52>>2]|0)<0){a=r[t+56>>2]|0;if(a|0){if(n[t+60>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+56>>2]=0}n[t+60>>0]=1;r[t+56>>2]=0;r[t+52>>2]=0}do{r[(r[t+56>>2]|0)+(o<<2)>>2]=0;o=o+1|0}while((o|0)!=0)}r[t+48>>2]=0;if((p|0)>=(y|0))break;else{f=l;a=p}}}}else{y=ck[r[(r[e>>2]|0)+44>>2]&127](e)|0;t=ck[r[(r[e>>2]|0)+36>>2]&127](e)|0;vk[r[(r[s>>2]|0)+8>>2]&7](s,r[i+16>>2]|0,r[i+8>>2]|0,y,t,-1)}o=r[2006]|0;t=(r[o+16>>2]|0)+-1|0;r[o+16>>2]=t;if(t|0){_=v;return}do{if(r[o+4>>2]|0){de(v|0,0)|0;t=r[5649]|0;h[o+8>>2]=+h[o+8>>2]+ +(((r[v+4>>2]|0)-(r[t+4>>2]|0)+(((r[v>>2]|0)-(r[t>>2]|0)|0)*1e6|0)-(r[o+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[o+16>>2]|0)){o=r[2006]|0;break}else{_=v;return}}}while(0);r[2006]=r[o+20>>2];_=v;return}function HR(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0,a=0,l=0,h=0,c=0,_=0;while(1){c=r[t+12>>2]|0;_=r[c+(((e+i|0)/2|0)<<2)>>2]|0;n=e;s=i;while(1){h=r[(r[_+740>>2]|0)+208>>2]|0;if((h|0)>-1)while(1){a=r[c+(n<<2)>>2]|0;o=r[(r[a+740>>2]|0)+208>>2]|0;if((o|0)<=-1)o=r[(r[a+744>>2]|0)+208>>2]|0;if((o|0)<(h|0))n=n+1|0;else break}else{l=r[(r[_+744>>2]|0)+208>>2]|0;while(1){a=r[c+(n<<2)>>2]|0;o=r[(r[a+740>>2]|0)+208>>2]|0;if((o|0)<=-1)o=r[(r[a+744>>2]|0)+208>>2]|0;if((o|0)<(l|0))n=n+1|0;else break}}if((h|0)>-1)while(1){a=r[c+(s<<2)>>2]|0;o=r[(r[a+740>>2]|0)+208>>2]|0;if((o|0)<=-1)o=r[(r[a+744>>2]|0)+208>>2]|0;if((h|0)<(o|0))s=s+-1|0;else break}else{l=r[(r[_+744>>2]|0)+208>>2]|0;while(1){a=r[c+(s<<2)>>2]|0;o=r[(r[a+740>>2]|0)+208>>2]|0;if((o|0)<=-1)o=r[(r[a+744>>2]|0)+208>>2]|0;if((l|0)<(o|0))s=s+-1|0;else break}}if((n|0)<=(s|0)){l=c+(n<<2)|0;h=r[l>>2]|0;r[l>>2]=r[c+(s<<2)>>2];r[(r[t+12>>2]|0)+(s<<2)>>2]=h;n=n+1|0;s=s+-1|0}if((n|0)>(s|0))break;c=r[t+12>>2]|0}if((s|0)>(e|0))HR(t,e,s);if((n|0)<(i|0))e=n;else break}return}function XR(t){t=t|0;var e=0;r[t>>2]=4512;if(!(n[t+8>>0]|0))return;e=r[t+12>>2]|0;if(!e)return;t=r[t+4>>2]|0;lk[r[(r[t>>2]|0)+16>>2]&127](t,e);return}function YR(t){t=t|0;var e=0,i=0;r[t>>2]=4512;if(!(n[t+8>>0]|0)){Ql(t);return}e=r[t+12>>2]|0;if(!e){Ql(t);return}i=r[t+4>>2]|0;lk[r[(r[i>>2]|0)+16>>2]&127](i,e);Ql(t);return}function qR(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0,m=0,g=0;m=_;_=_+32|0;f=r[t+12>>2]|0;if(!f){_=m;return}r[s+4>>2]=f;t=r[e+4>>2]|0;g=r[i+4>>2]|0;e=r[e+12>>2]|0;n=r[i+12>>2]|0;o=+h[e+48>>2]-+h[n+48>>2];a=+h[e+52>>2]-+h[n+52>>2];c=+h[e+56>>2]-+h[n+56>>2];u=+G(+(o*o+a*a+c*c));d=+h[g+32>>2]*+h[g+16>>2];p=+h[t+32>>2]*+h[t+16>>2]+d;if(u>p){if(!(r[f+748>>2]|0)){_=m;return}t=r[f+740>>2]|0;e=r[(r[s+8>>2]|0)+8>>2]|0;n=r[(r[s+12>>2]|0)+8>>2]|0;if((t|0)==(e|0)){uS(f,t+4|0,n+4|0);_=m;return}else{uS(f,n+4|0,e+4|0);_=m;return}}r[m+16>>2]=1065353216;r[m+16+4>>2]=0;r[m+16+8>>2]=0;h[m+16+12>>2]=0.0;if(u>1.1920928955078125e-07){h[m+16>>2]=o*(1.0/u);h[m+16+4>>2]=a*(1.0/u);h[m+16+8>>2]=c*(1.0/u);h[m+16+12>>2]=0.0;l=o*(1.0/u);a=a*(1.0/u);o=c*(1.0/u)}else{l=1.0;a=0.0;o=0.0}a=d*a+ +h[n+52>>2];c=d*o+ +h[n+56>>2];h[m>>2]=d*l+ +h[n+48>>2];h[m+4>>2]=a;h[m+8>>2]=c;h[m+12>>2]=0.0;Uk[r[(r[s>>2]|0)+16>>2]&15](s,m+16|0,m,u-p);t=r[s+4>>2]|0;do{if(r[t+748>>2]|0){e=r[t+740>>2]|0;i=r[(r[s+8>>2]|0)+8>>2]|0;n=r[(r[s+12>>2]|0)+8>>2]|0;if((e|0)==(i|0)){uS(t,e+4|0,n+4|0);break}else{uS(t,n+4|0,i+4|0);break}}}while(0);_=m;return}function KR(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;return 1.0}function ZR(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0;i=r[t+12>>2]|0;if(!i)return;if(!(n[t+8>>0]|0))return;s=r[e+4>>2]|0;if((s|0)==(r[e+8>>2]|0)?(a=s|0?s<<1:1,(s|0)<(a|0)):0){if(!a)i=0;else{r[5637]=(r[5637]|0)+1;i=Zl((a<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}s=r[e+4>>2]|0}if((s|0)>0){o=0;do{r[i+(o<<2)>>2]=r[(r[e+12>>2]|0)+(o<<2)>>2];o=o+1|0}while((o|0)!=(s|0))}o=r[e+12>>2]|0;if(o){if(n[e+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0);s=r[e+4>>2]|0}r[e+12>>2]=0}n[e+16>>0]=1;r[e+12>>2]=i;r[e+8>>2]=a;i=r[t+12>>2]|0}r[(r[e+12>>2]|0)+(s<<2)>>2]=i;r[e+4>>2]=s+1;return}function QR(t){t=t|0;var e=0;r[t>>2]=4540;if(!(n[t+8>>0]|0))return;e=r[t+12>>2]|0;if(!e)return;t=r[t+4>>2]|0;lk[r[(r[t>>2]|0)+16>>2]&127](t,e);return}function $R(t){t=t|0;var e=0,i=0;r[t>>2]=4540;if(!(n[t+8>>0]|0)){Ql(t);return}e=r[t+12>>2]|0;if(!e){Ql(t);return}i=r[t+4>>2]|0;lk[r[(r[i>>2]|0)+16>>2]&127](i,e);Ql(t);return}function JR(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0,l=0,c=0,u=0,d=0,p=0,f=0;c=_;_=_+160|0;a=r[t+12>>2]|0;if(!a){_=c;return}u=(n[t+16>>0]|0)!=0;d=u?i:e;i=u?e:i;f=r[d+4>>2]|0;p=r[i+4>>2]|0;r[o+4>>2]=a;e=r[a+752>>2]|0;r[c+136>>2]=4568;r[c+136+4>>2]=f;r[c+136+8>>2]=p;r[c+136+12>>2]=e;h[c+128>>2]=999999984306749440.0;e=r[d+12>>2]|0;r[c>>2]=r[e>>2];r[c+4>>2]=r[e+4>>2];r[c+8>>2]=r[e+8>>2];r[c+12>>2]=r[e+12>>2];r[c+16>>2]=r[e+16>>2];r[c+16+4>>2]=r[e+16+4>>2];r[c+16+8>>2]=r[e+16+8>>2];r[c+16+12>>2]=r[e+16+12>>2];r[c+32>>2]=r[e+32>>2];r[c+32+4>>2]=r[e+32+4>>2];r[c+32+8>>2]=r[e+32+8>>2];r[c+32+12>>2]=r[e+32+12>>2];r[c+48>>2]=r[e+48>>2];r[c+48+4>>2]=r[e+48+4>>2];r[c+48+8>>2]=r[e+48+8>>2];r[c+48+12>>2]=r[e+48+12>>2];i=r[i+12>>2]|0;r[c+64>>2]=r[i>>2];r[c+64+4>>2]=r[i+4>>2];r[c+64+8>>2]=r[i+8>>2];r[c+64+12>>2]=r[i+12>>2];r[c+80>>2]=r[i+16>>2];r[c+80+4>>2]=r[i+16+4>>2];r[c+80+8>>2]=r[i+16+8>>2];r[c+80+12>>2]=r[i+16+12>>2];r[c+96>>2]=r[i+32>>2];r[c+96+4>>2]=r[i+32+4>>2];r[c+96+8>>2]=r[i+32+8>>2];r[c+96+12>>2]=r[i+32+12>>2];r[c+112>>2]=r[i+48>>2];r[c+112+4>>2]=r[i+48+4>>2];r[c+112+8>>2]=r[i+48+8>>2];r[c+112+12>>2]=r[i+48+12>>2];sI(c+136|0,c,o,r[s+20>>2]|0,u);do{if(n[t+8>>0]|0?(l=r[o+4>>2]|0,r[l+748>>2]|0):0){e=r[l+740>>2]|0;i=r[(r[o+8>>2]|0)+8>>2]|0;a=r[(r[o+12>>2]|0)+8>>2]|0;if((e|0)==(i|0)){uS(l,e+4|0,a+4|0);break}else{uS(l,a+4|0,i+4|0);break}}}while(0);_=c;return}function tI(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;return 1.0}function eI(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0;i=r[t+12>>2]|0;if(!i)return;if(!(n[t+8>>0]|0))return;s=r[e+4>>2]|0;if((s|0)==(r[e+8>>2]|0)?(a=s|0?s<<1:1,(s|0)<(a|0)):0){if(!a)i=0;else{r[5637]=(r[5637]|0)+1;i=Zl((a<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}s=r[e+4>>2]|0}if((s|0)>0){o=0;do{r[i+(o<<2)>>2]=r[(r[e+12>>2]|0)+(o<<2)>>2];o=o+1|0}while((o|0)!=(s|0))}o=r[e+12>>2]|0;if(o){if(n[e+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0);s=r[e+4>>2]|0}r[e+12>>2]=0}n[e+16>>0]=1;r[e+12>>2]=i;r[e+8>>2]=a;i=r[t+12>>2]|0}r[(r[e+12>>2]|0)+(s<<2)>>2]=i;r[e+4>>2]=s+1;return}function iI(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0,a=0,l=0,h=0,c=0,_=0,u=0;while(1){h=r[t+12>>2]|0;c=r[h+(((e+i|0)/2|0)<<3)>>2]|0;n=e;s=i;while(1){while(1){a=n+1|0;if((r[h+(n<<3)>>2]|0)<(c|0))n=a;else{l=s;break}}while(1){o=h+(l<<3)|0;s=l+-1|0;if((c|0)<(r[o>>2]|0))l=s;else break}if((n|0)>(l|0))s=l;else{n=h+(n<<3)|0;_=r[n>>2]|0;h=r[n+4>>2]|0;u=r[o+4>>2]|0;r[n>>2]=r[o>>2];r[n+4>>2]=u;n=(r[t+12>>2]|0)+(l<<3)|0;r[n>>2]=_;r[n+4>>2]=h;n=a}if((n|0)>(s|0))break;h=r[t+12>>2]|0}if((s|0)>(e|0))iI(t,e,s);if((n|0)<(i|0))e=n;else break}return}function nI(t){t=t|0;Ql(t);return}function sI(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0,A=0.0,E=0.0,M=0.0,R=0.0,I=0,P=0;I=_;_=_+64|0;A=+h[e+48>>2]-+h[e+112>>2];o=+h[e+52>>2]-+h[e+116>>2];R=+h[e+56>>2]-+h[e+120>>2];E=A*+h[e+64>>2]+o*+h[e+80>>2]+R*+h[e+96>>2];M=A*+h[e+68>>2]+o*+h[e+84>>2]+R*+h[e+100>>2];R=A*+h[e+72>>2]+o*+h[e+88>>2]+R*+h[e+104>>2];n=r[t+8>>2]|0;T=r[t+4>>2]|0;o=+h[T+32>>2]*+h[T+16>>2];A=o+ +h[t+12>>2];f=+h[n+76>>2];m=+h[n+60>>2];g=+h[n+80>>2];b=+h[n+64>>2];y=+h[n+84>>2];v=+h[n+68>>2];S=+h[n+92>>2];x=+h[n+96>>2];w=+h[n+100>>2];l=(g-b)*(w-v)-(y-v)*(x-b);u=(y-v)*(S-m)-(f-m)*(w-v);p=(f-m)*(x-b)-(g-b)*(S-m);d=1.0/+G(+(p*p+(l*l+u*u)));a=(E-m)*(d*l)+(M-b)*(d*u)+d*p*(R-v);if(a<0.0){C=-a;c=-(d*l);a=-(d*u);l=-(d*p)}else{C=a;c=d*l;a=d*u;l=d*p}if(!(C<A)){_=I;return}p=(R-v)*((f-m)*a-(g-b)*c)+((E-m)*((g-b)*l-(y-v)*a)+(M-b)*((y-v)*c-(f-m)*l));y=(R-y)*((S-f)*a-(x-g)*c)+((E-f)*((x-g)*l-(w-y)*a)+(M-g)*((w-y)*c-(S-f)*l));w=(R-w)*((m-S)*a-(b-x)*c)+((E-S)*((b-x)*l-(v-w)*a)+(M-x)*((v-w)*c-(m-S)*l));if(!(w>0.0&(p>0.0&y>0.0))?!(w<=0.0&(p<=0.0&y<=0.0)):0){if((ck[r[(r[n>>2]|0)+100>>2]&127](n)|0)<=0){_=I;return}b=0.0;g=0.0;m=0.0;n=0;T=0;do{P=r[t+8>>2]|0;jk[r[(r[P>>2]|0)+104>>2]&127](P,T,I+48|0,I+32|0);u=+h[I+48>>2];x=+h[I+48+4>>2];v=+h[I+48+8>>2];d=+h[I+32>>2]-u;w=+h[I+32+4>>2]-x;S=+h[I+32+8>>2]-v;do{if((E-u)*d+(M-x)*w+(R-v)*S>0.0)if((E-u)*d+(M-x)*w+(R-v)*S<d*d+w*w+S*S){C=((E-u)*d+(M-x)*w+(R-v)*S)/(d*d+w*w+S*S);p=E-u-d*C;f=M-x-w*C;y=R-v-S*C;break}else{p=E-u-d;f=M-x-w;y=R-v-S;C=1.0;break}else{p=E-u;f=M-x;y=R-v;C=0.0}}while(0);if(p*p+f*f+y*y<A*A){b=u+d*C;g=v+S*C;m=x+w*C;n=1}T=T+1|0;P=r[t+8>>2]|0}while((T|0)<(ck[r[(r[P>>2]|0)+100>>2]&127](P)|0));if(!(n&1)){_=I;return}else f=A*A}else{f=A*A;b=E-C*c;g=R-C*l;m=M-C*a}d=E-b;p=M-m;u=R-g;if(!(d*d+p*p+u*u<f)){_=I;return}if(d*d+p*p+u*u>1.1920928955078125e-07){a=+G(+(d*d+p*p+u*u));o=o-a;c=d*(1.0/a);l=u*(1.0/a);a=p*(1.0/a)}o=-o;if(s){w=+h[e+64>>2];C=+h[e+68>>2];A=+h[e+72>>2];E=w*c+C*a+A*l;p=+h[e+80>>2];f=+h[e+84>>2];y=+h[e+88>>2];M=c*p+a*f+l*y;v=+h[e+96>>2];S=+h[e+100>>2];x=+h[e+104>>2];R=c*v+a*S+l*x;h[I+48>>2]=-E;h[I+48+4>>2]=-M;h[I+48+8>>2]=-R;h[I+48+12>>2]=0.0;M=b*p+m*f+g*y+ +h[e+116>>2]+M*o;R=b*v+m*S+g*x+ +h[e+120>>2]+R*o;h[I+32>>2]=b*w+m*C+g*A+ +h[e+112>>2]+E*o;h[I+32+4>>2]=M;h[I+32+8>>2]=R;h[I+32+12>>2]=0.0;Uk[r[(r[i>>2]|0)+16>>2]&15](i,I+48|0,I+32|0,o);_=I;return}else{P=r[(r[i>>2]|0)+16>>2]|0;C=+h[e+64>>2];A=+h[e+68>>2];E=+h[e+72>>2];v=+h[e+80>>2];S=+h[e+84>>2];M=+h[e+88>>2];x=+h[e+96>>2];w=+h[e+100>>2];R=+h[e+104>>2];h[I+16>>2]=C*c+A*a+E*l;h[I+16+4>>2]=c*v+a*S+l*M;h[I+16+8>>2]=c*x+a*w+l*R;h[I+16+12>>2]=0.0;M=b*v+m*S+g*M+ +h[e+116>>2];R=b*x+m*w+g*R+ +h[e+120>>2];h[I>>2]=b*C+m*A+g*E+ +h[e+112>>2];h[I+4>>2]=M;h[I+8>>2]=R;h[I+12>>2]=0.0;Uk[P&15](i,I+16|0,I,o);_=I;return}}function rI(t){t=t|0;var e=0,i=0;r[t>>2]=6248;e=r[t+56>>2]|0;if(e|0?(ok[r[r[e>>2]>>2]&255](e),i=r[t+56>>2]|0,i|0):0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function oI(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0;a=+xk[r[(r[t>>2]|0)+48>>2]&15](t);u=a+ +h[t+32>>2];c=a+ +h[t+36>>2];a=a+ +h[t+40>>2];v=+W(+ +h[e>>2]);y=+W(+ +h[e+4>>2]);b=+W(+ +h[e+8>>2]);m=+W(+ +h[e+16>>2]);f=+W(+ +h[e+20>>2]);p=+W(+ +h[e+24>>2]);_=+W(+ +h[e+32>>2]);l=+W(+ +h[e+36>>2]);o=+W(+ +h[e+40>>2]);g=+h[e+48>>2];d=+h[e+52>>2];s=+h[e+56>>2];h[i>>2]=g-(u*v+c*y+a*b);h[i+4>>2]=d-(u*m+c*f+a*p);h[i+8>>2]=s-(u*_+c*l+a*o);h[i+12>>2]=0.0;h[n>>2]=u*v+c*y+a*b+g;h[n+4>>2]=u*m+c*f+a*p+d;h[n+8>>2]=u*_+c*l+a*o+s;h[n+12>>2]=0.0;return}function aI(t,e){t=t|0;e=e|0;var i=0.0,n=0.0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0;c=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=+xk[r[(r[t>>2]|0)+48>>2]&15](t);i=+xk[r[(r[t>>2]|0)+48>>2]&15](t);u=(c+ +h[t+32>>2])/+h[t+16>>2];l=(o+ +h[t+36>>2])/+h[t+20>>2];s=(i+ +h[t+40>>2])/+h[t+24>>2];_=+W(+ +h[e>>2]);a=+W(+ +h[e+4>>2]);n=+W(+ +h[e+8>>2]);h[t+16>>2]=_;h[t+20>>2]=a;h[t+24>>2]=n;h[t+28>>2]=0.0;h[t+32>>2]=u*_-c;h[t+36>>2]=l*a-o;h[t+40>>2]=s*n-i;h[t+44>>2]=0.0;return}function lI(t,e,i){t=t|0;e=+e;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0;a=+h[t+32>>2];s=+h[t+36>>2];l=+h[t+40>>2];o=+xk[r[(r[t>>2]|0)+48>>2]&15](t);n=+xk[r[(r[t>>2]|0)+48>>2]&15](t);l=(l+ +xk[r[(r[t>>2]|0)+48>>2]&15](t))*2.0;h[i>>2]=e/12.0*((s+n)*2.0*((s+n)*2.0)+l*l);h[i+4>>2]=e/12.0*((a+o)*2.0*((a+o)*2.0)+l*l);h[i+8>>2]=e/12.0*((a+o)*2.0*((a+o)*2.0)+(s+n)*2.0*((s+n)*2.0));h[i+12>>2]=0.0;return}function hI(t){t=t|0;return 12683}function cI(t,e){t=t|0;e=+e;var i=0.0,n=0.0,s=0.0,o=0.0,a=0.0;o=+xk[r[(r[t>>2]|0)+48>>2]&15](t);n=+xk[r[(r[t>>2]|0)+48>>2]&15](t);a=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=o+ +h[t+32>>2];n=n+ +h[t+36>>2];a=a+ +h[t+40>>2];h[t+48>>2]=e;s=+xk[r[(r[t>>2]|0)+48>>2]&15](t);i=+xk[r[(r[t>>2]|0)+48>>2]&15](t);e=a-+xk[r[(r[t>>2]|0)+48>>2]&15](t);h[t+32>>2]=o-s;h[t+36>>2]=n-i;h[t+40>>2]=e;h[t+44>>2]=0.0;return}function _I(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0;a=+h[e+32>>2];l=+h[e+36>>2];n=+h[e+40>>2];o=+xk[r[(r[e>>2]|0)+48>>2]&15](e);s=+xk[r[(r[e>>2]|0)+48>>2]&15](e);n=n+ +xk[r[(r[e>>2]|0)+48>>2]&15](e);s=+h[i+4>>2]>=0.0?l+s:-(l+s);n=+h[i+8>>2]>=0.0?n:-n;h[t>>2]=+h[i>>2]>=0.0?a+o:-(a+o);h[t+4>>2]=s;h[t+8>>2]=n;h[t+12>>2]=0.0;return}function uI(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,r=0.0;r=+h[e+32>>2];s=+h[e+36>>2];s=+h[i+4>>2]>=0.0?s:-s;n=+h[e+40>>2];n=+h[i+8>>2]>=0.0?n:-n;h[t>>2]=+h[i>>2]>=0.0?r:-r;h[t+4>>2]=s;h[t+8>>2]=n;h[t+12>>2]=0.0;return}function dI(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,r=0.0,o=0.0,a=0.0;if((n|0)<=0)return;s=0;do{a=+h[t+32>>2];o=+h[t+36>>2];o=+h[e+(s<<4)+4>>2]>=0.0?o:-o;r=+h[t+40>>2];r=+h[e+(s<<4)+8>>2]>=0.0?r:-r;h[i+(s<<4)>>2]=+h[e+(s<<4)>>2]>=0.0?a:-a;h[i+(s<<4)+4>>2]=o;h[i+(s<<4)+8>>2]=r;h[i+(s<<4)+12>>2]=0.0;s=s+1|0}while((s|0)!=(n|0));return}function pI(t){t=t|0;return 6}function fI(t,e,i){t=t|0;e=e|0;i=i|0;switch(e|0){case 0:{r[i>>2]=1065353216;r[i+4>>2]=0;r[i+8>>2]=0;h[i+12>>2]=0.0;return}case 1:{r[i>>2]=-1082130432;r[i+4>>2]=0;r[i+8>>2]=0;h[i+12>>2]=0.0;return}case 2:{r[i>>2]=0;r[i+4>>2]=1065353216;r[i+8>>2]=0;h[i+12>>2]=0.0;return}case 3:{r[i>>2]=0;r[i+4>>2]=-1082130432;r[i+8>>2]=0;h[i+12>>2]=0.0;return}case 4:{r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=1065353216;h[i+12>>2]=0.0;return}case 5:{r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=-1082130432;h[i+12>>2]=0.0;return}default:return}}function mI(t){t=t|0;return 8}function gI(t){t=t|0;return 12}function bI(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0;do{switch(e|0){case 0:{s=0;e=1;break}case 1:{s=0;e=2;break}case 2:{s=1;e=3;break}case 3:{s=2;break}case 4:{s=0;break}case 5:{s=1;break}case 6:{s=2;break}case 7:{s=3;break}case 8:{s=4;e=5;break}case 9:{s=4;e=6;break}case 10:{s=5;e=7;break}case 11:{s=6;e=7;break}default:{s=0;e=0}}}while(0);Vk[r[(r[t>>2]|0)+108>>2]&127](t,s,i);Vk[r[(r[t>>2]|0)+108>>2]&127](t,e,n);return}function yI(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0;l=+h[t+32>>2];o=+h[t+36>>2];n=+h[t+40>>2];a=+xk[r[(r[t>>2]|0)+48>>2]&15](t);s=+xk[r[(r[t>>2]|0)+48>>2]&15](t);n=n+ +xk[r[(r[t>>2]|0)+48>>2]&15](t);h[i>>2]=+(e&1^1|0)*(l+a)-+(e&1|0)*(l+a);h[i+4>>2]=+(e>>>1&1^1|0)*(o+s)-+(e>>>1&1|0)*(o+s);h[i+8>>2]=+(e>>>2&1^1|0)*n-+(e>>>2&1|0)*n;h[i+12>>2]=0.0;return}function vI(t){t=t|0;return 6}function SI(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0.0,a=0.0,l=0.0,c=0,u=0;s=_;_=_+48|0;Vk[r[(r[t>>2]|0)+124>>2]&127](t,s+32|0,n);u=r[s+32>>2]|0;c=r[s+32+4>>2]|0;n=r[s+32+8>>2]|0;r[e>>2]=u;r[e+4>>2]=c;r[e+8>>2]=n;h[e+12>>2]=0.0;e=r[(r[t>>2]|0)+64>>2]|0;l=-(r[d>>2]=u,+h[d>>2]);a=-(r[d>>2]=c,+h[d>>2]);o=-(r[d>>2]=n,+h[d>>2]);h[s>>2]=l;h[s+4>>2]=a;h[s+8>>2]=o;h[s+12>>2]=0.0;Vk[e&127](s+16|0,t,s);r[i>>2]=r[s+16>>2];r[i+4>>2]=r[s+16+4>>2];r[i+8>>2]=r[s+16+8>>2];r[i+12>>2]=r[s+16+12>>2];_=s;return}function xI(t,e,i){t=t|0;e=e|0;i=+i;var n=0.0,s=0.0,r=0.0,o=0.0;s=+h[t+32>>2];r=+h[t+36>>2];o=+h[t+40>>2];n=+h[e>>2];if(!(n<=s+i)){e=0;return e|0}if(!(n>=-s-i)){e=0;return e|0}n=+h[e+4>>2];if(!(n<=r+i)){e=0;return e|0}if(!(n>=-r-i)){e=0;return e|0}n=+h[e+8>>2];if(!(n<=o+i)){e=0;return e|0}e=n>=-o-i;return e|0}function wI(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0;s=+h[t+32>>2];o=+h[t+36>>2];n=+h[t+40>>2];switch(i|0){case 0:{r[e>>2]=1065353216;r[e+4>>2]=0;r[e+8>>2]=0;h[e+12>>2]=-s;return}case 1:{r[e>>2]=-1082130432;r[e+4>>2]=0;r[e+8>>2]=0;h[e+12>>2]=-s;return}case 2:{r[e>>2]=0;r[e+4>>2]=1065353216;r[e+8>>2]=0;h[e+12>>2]=-o;return}case 3:{r[e>>2]=0;r[e+4>>2]=-1082130432;r[e+8>>2]=0;h[e+12>>2]=-o;return}case 4:{r[e>>2]=0;r[e+4>>2]=0;r[e+8>>2]=1065353216;h[e+12>>2]=-n;return}case 5:{r[e>>2]=0;r[e+4>>2]=0;r[e+8>>2]=-1082130432;h[e+12>>2]=-n;return}default:return}}function CI(t,e){t=t|0;e=e|0;var i=0.0,n=0,s=0.0,o=0.0,a=0.0,l=0.0;r[t+8>>2]=0;r[t+12>>2]=-1;r[t+16>>2]=1065353216;r[t+20>>2]=1065353216;r[t+24>>2]=1065353216;h[t+28>>2]=0.0;h[t+48>>2]=.03999999910593033;r[t+56>>2]=0;r[t>>2]=4588;r[t+4>>2]=0;o=+h[e>>2];s=+h[e+4>>2];i=+h[e+8>>2];i=+h[e+((o<s?o<i?0:2:s<i?1:2)<<2)>>2]*.10000000149011612;if(i<.03999999910593033){l=+Ow(t);a=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=+xk[r[(r[t>>2]|0)+48>>2]&15](t);l=l+ +h[t+32>>2];a=a+ +h[t+36>>2];o=o+ +h[t+40>>2];h[t+48>>2]=i;i=+xk[r[(r[t>>2]|0)+48>>2]&15](t);s=+xk[r[(r[t>>2]|0)+48>>2]&15](t);o=o-+xk[r[(r[t>>2]|0)+48>>2]&15](t);h[t+32>>2]=l-i;h[t+36>>2]=a-s;h[t+40>>2]=o;h[t+44>>2]=0.0;n=r[t>>2]|0}else n=4588;o=+xk[r[n+48>>2]&15](t);a=+xk[r[(r[t>>2]|0)+48>>2]&15](t);l=+xk[r[(r[t>>2]|0)+48>>2]&15](t);a=+h[e+4>>2]*+h[t+20>>2]-a;l=+h[e+8>>2]*+h[t+24>>2]-l;h[t+32>>2]=+h[e>>2]*+h[t+16>>2]-o;h[t+36>>2]=a;h[t+40>>2]=l;h[t+44>>2]=0.0;return}function TI(t){t=t|0;var e=0;r[t>>2]=4724;if(!(n[t+65>>0]|0))return;e=r[t+56>>2]|0;ok[r[r[e>>2]>>2]&255](e);t=r[t+56>>2]|0;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function AI(t){t=t|0;var e=0;r[t>>2]=4724;if(n[t+65>>0]|0?(e=r[t+56>>2]|0,ok[r[r[e>>2]>>2]&255](e),e=r[t+56>>2]|0,e|0):0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function EI(t,e){t=t|0;e=e|0;var i=0,s=0.0,o=0.0,a=0.0,l=0;l=ck[r[(r[t>>2]|0)+28>>2]&127](t)|0;a=+h[l>>2]-+h[e>>2];o=+h[l+4>>2]-+h[e+4>>2];s=+h[l+8>>2]-+h[e+8>>2];if(!(a*a+o*o+s*s>1.1920928955078125e-07))return;wv(t,e);if((n[t+65>>0]|0)!=0?(i=r[t+56>>2]|0,ok[r[r[i>>2]>>2]&255](i),i=r[t+56>>2]|0,(i|0)!=0):0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0);e=t+56|0}else e=t+56|0;r[5637]=(r[5637]|0)+1;i=Zl(191)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}r[i+52>>2]=284;n[i+60>>0]=0;n[i+80>>0]=1;r[i+76>>2]=0;r[i+68>>2]=0;r[i+72>>2]=0;n[i+100>>0]=1;r[i+96>>2]=0;r[i+88>>2]=0;r[i+92>>2]=0;n[i+120>>0]=1;r[i+116>>2]=0;r[i+108>>2]=0;r[i+112>>2]=0;n[i+140>>0]=1;r[i+136>>2]=0;r[i+128>>2]=0;r[i+132>>2]=0;r[i+144>>2]=0;n[i+164>>0]=1;r[i+160>>2]=0;r[i+152>>2]=0;r[i+156>>2]=0;r[i+168>>2]=0;r[i+4>>2]=-8388609;r[i+8>>2]=-8388609;r[i+12>>2]=-8388609;h[i+16>>2]=0.0;r[i+20>>2]=2139095039;r[i+24>>2]=2139095039;r[i+28>>2]=2139095039;h[i+32>>2]=0.0;r[i>>2]=6168;r[e>>2]=i;yA(i,r[t+52>>2]|0,(n[t+64>>0]|0)!=0,t+20|0,t+36|0);n[t+65>>0]=1;return}function MI(t){t=t|0;return 12712}function RI(t,e){t=t|0;e=+e;h[t+16>>2]=e;return}function II(t){t=t|0;return+ +h[t+16>>2]}function PI(t){t=t|0;return 60}function LI(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0;n=Rk[r[(r[i>>2]|0)+40>>2]&31](i,t)|0;o=Rk[r[(r[i>>2]|0)+28>>2]&31](i,n)|0;r[e>>2]=o;if(o|0)lk[r[(r[i>>2]|0)+48>>2]&127](i,n);r[e+4>>2]=r[t+4>>2];o=r[t+52>>2]|0;yk[r[(r[o>>2]|0)+56>>2]&63](o,e+12|0,i)|0;r[e+52>>2]=r[t+16>>2];do{if((r[t+56>>2]|0)!=0?((ck[r[(r[i>>2]|0)+52>>2]&127](i)|0)&1|0)==0:0){n=Rk[r[(r[i>>2]|0)+24>>2]&31](i,r[t+56>>2]|0)|0;if(!n){r[e+40>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,r[t+56>>2]|0)|0;r[e+44>>2]=0;n=r[t+56>>2]|0;n=ck[r[(r[n>>2]|0)+12>>2]&127](n)|0;n=yk[r[(r[i>>2]|0)+16>>2]&63](i,n,1)|0;o=r[t+56>>2]|0;o=yk[r[(r[o>>2]|0)+16>>2]&63](o,r[n+8>>2]|0,i)|0;sk[r[(r[i>>2]|0)+20>>2]&31](i,n,o,1213612625,r[t+56>>2]|0);break}else{r[e+40>>2]=n;r[e+44>>2]=0;break}}else s=8}while(0);if((s|0)==8){r[e+40>>2]=0;r[e+44>>2]=0}if(r[t+60>>2]|0?((ck[r[(r[i>>2]|0)+52>>2]&127](i)|0)&2|0)==0:0){n=Rk[r[(r[i>>2]|0)+24>>2]&31](i,r[t+60>>2]|0)|0;if(!n){r[e+48>>2]=Rk[r[(r[i>>2]|0)+28>>2]&31](i,r[t+60>>2]|0)|0;e=r[t+60>>2]|0;e=ck[r[(r[e>>2]|0)+8>>2]&127](e)|0;e=yk[r[(r[i>>2]|0)+16>>2]&63](i,e,1)|0;o=r[t+60>>2]|0;o=yk[r[(r[o>>2]|0)+12>>2]&63](o,r[e+8>>2]|0,i)|0;sk[r[(r[i>>2]|0)+20>>2]&31](i,e,o,1346456916,r[t+60>>2]|0);return 12728}else{r[e+48>>2]=n;return 12728}}r[e+48>>2]=0;return 12728}function DI(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0;s=_;_=_+64|0;o=r[t+52>>2]|0;r[s>>2]=4816;r[s+4>>2]=o;r[s+8>>2]=e;QL(r[t+56>>2]|0,s,i,n);_=s;return}function kI(t){t=t|0;Ql(t);return}function OI(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0.0,l=0.0,u=0.0,d=0,p=0,f=0,m=0,g=0,b=0,y=0;y=_;_=_+32|0;p=r[t+4>>2]|0;Mk[r[(r[p>>2]|0)+16>>2]&3](p,y+28|0,y+24|0,y+20|0,y+16|0,y+12|0,y+8|0,y+4|0,y,e);p=(r[y+12>>2]|0)+(et(r[y+8>>2]|0,i)|0)|0;b=r[t+4>>2]|0;d=r[y>>2]|0;switch(d|0){case 3:{n=a[p+4>>1]|0;break}case 2:{n=r[p+8>>2]|0;break}default:n=o[p+2>>0]|0}g=(r[y+20>>2]|0)==0;f=r[y+28>>2]|0;m=r[y+16>>2]|0;n=f+(et(m,n)|0)|0;if(g){l=+h[n+8>>2]*+h[b+12>>2];u=+h[n+4>>2]*+h[b+8>>2];s=+h[n>>2]*+h[b+4>>2]}else{l=+c[n+16>>3]*+h[b+12>>2];u=+c[n+8>>3]*+h[b+8>>2];s=+c[n>>3]*+h[b+4>>2]}h[t+44>>2]=s;h[t+48>>2]=u;h[t+52>>2]=l;h[t+56>>2]=0.0;switch(d|0){case 3:{n=a[p+2>>1]|0;break}case 2:{n=r[p+4>>2]|0;break}default:n=o[p+1>>0]|0}n=f+(et(m,n)|0)|0;if(g){l=+h[n+8>>2]*+h[b+12>>2];u=+h[n+4>>2]*+h[b+8>>2];s=+h[n>>2]*+h[b+4>>2]}else{l=+c[n+16>>3]*+h[b+12>>2];u=+c[n+8>>3]*+h[b+8>>2];s=+c[n>>3]*+h[b+4>>2]}h[t+28>>2]=s;h[t+32>>2]=u;h[t+36>>2]=l;h[t+40>>2]=0.0;switch(d|0){case 3:{n=a[p>>1]|0;break}case 2:{n=r[p>>2]|0;break}default:n=o[p>>0]|0}n=f+(et(m,n)|0)|0;if(g){u=+h[n+8>>2]*+h[b+12>>2];l=+h[n+4>>2]*+h[b+8>>2];s=+h[n>>2]*+h[b+4>>2];g=t+12|0;h[g>>2]=s;g=t+16|0;h[g>>2]=l;g=t+20|0;h[g>>2]=u;g=t+24|0;h[g>>2]=0.0;g=t+8|0;g=r[g>>2]|0;m=r[g>>2]|0;m=m+8|0;m=r[m>>2]|0;b=t+12|0;jk[m&127](g,b,e,i);t=r[t+4>>2]|0;i=r[t>>2]|0;i=i+24|0;i=r[i>>2]|0;lk[i&127](t,e);_=y;return}else{u=+c[n+16>>3]*+h[b+12>>2];l=+c[n+8>>3]*+h[b+8>>2];s=+c[n>>3]*+h[b+4>>2];g=t+12|0;h[g>>2]=s;g=t+16|0;h[g>>2]=l;g=t+20|0;h[g>>2]=u;g=t+24|0;h[g>>2]=0.0;g=t+8|0;g=r[g>>2]|0;m=r[g>>2]|0;m=m+8|0;m=r[m>>2]|0;b=t+12|0;jk[m&127](g,b,e,i);t=r[t+4>>2]|0;i=r[t>>2]|0;i=i+24|0;i=r[i>>2]|0;lk[i&127](t,e);_=y;return}}function FI(t,e,i){t=t|0;e=e|0;i=i|0;Vk[r[(r[e>>2]|0)+68>>2]&127](t,e,i);return}function BI(t,e){t=t|0;e=e|0;var i=0,n=0;i=r[t+56>>2]|0;if(!i)return;n=ck[r[(r[i>>2]|0)+12>>2]&127](i)|0;n=yk[r[(r[e>>2]|0)+16>>2]&63](e,n,1)|0;i=r[t+56>>2]|0;i=yk[r[(r[i>>2]|0)+16>>2]&63](i,r[n+8>>2]|0,e)|0;sk[r[(r[e>>2]|0)+20>>2]&31](e,n,i,1213612625,r[t+56>>2]|0);return}function NI(t,e){t=t|0;e=e|0;var i=0,n=0;i=r[t+60>>2]|0;if(!i)return;n=ck[r[(r[i>>2]|0)+8>>2]&127](i)|0;n=yk[r[(r[e>>2]|0)+16>>2]&63](e,n,1)|0;i=r[t+60>>2]|0;i=yk[r[(r[i>>2]|0)+12>>2]&63](i,r[n+8>>2]|0,e)|0;sk[r[(r[e>>2]|0)+20>>2]&31](e,n,i,1346456916,r[t+60>>2]|0);return}function UI(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0;o=_;_=_+48|0;r[t+8>>2]=0;r[t+12>>2]=-1;h[t+16>>2]=0.0;r[t>>2]=6692;r[t+52>>2]=e;r[t+4>>2]=21;if(ck[r[(r[e>>2]|0)+40>>2]&127](e)|0)Vk[r[(r[e>>2]|0)+48>>2]&127](e,t+20|0,t+36|0);else{r[o+32>>2]=0;r[o+32+4>>2]=0;r[o+32+8>>2]=0;r[o+32+12>>2]=0;h[o+32>>2]=1.0;Vk[r[(r[t>>2]|0)+68>>2]&127](o+16|0,t,o+32|0);h[t+36>>2]=+h[o+16>>2]+ +h[t+16>>2];h[o+32>>2]=-1.0;Vk[r[(r[t>>2]|0)+68>>2]&127](o,t,o+32|0);r[o+16>>2]=r[o>>2];r[o+16+4>>2]=r[o+4>>2];r[o+16+8>>2]=r[o+8>>2];r[o+16+12>>2]=r[o+12>>2];h[t+20>>2]=+h[o+16>>2]-+h[t+16>>2];r[o+32>>2]=0;r[o+32+4>>2]=0;r[o+32+8>>2]=0;r[o+32+12>>2]=0;h[o+32+4>>2]=1.0;Vk[r[(r[t>>2]|0)+68>>2]&127](o+16|0,t,o+32|0);h[t+40>>2]=+h[o+16+4>>2]+ +h[t+16>>2];h[o+32+4>>2]=-1.0;Vk[r[(r[t>>2]|0)+68>>2]&127](o,t,o+32|0);r[o+16>>2]=r[o>>2];r[o+16+4>>2]=r[o+4>>2];r[o+16+8>>2]=r[o+8>>2];r[o+16+12>>2]=r[o+12>>2];h[t+24>>2]=+h[o+16+4>>2]-+h[t+16>>2];r[o+32>>2]=0;r[o+32+4>>2]=0;r[o+32+8>>2]=0;r[o+32+12>>2]=0;h[o+32+8>>2]=1.0;Vk[r[(r[t>>2]|0)+68>>2]&127](o+16|0,t,o+32|0);h[t+44>>2]=+h[o+16+8>>2]+ +h[t+16>>2];h[o+32+8>>2]=-1.0;Vk[r[(r[t>>2]|0)+68>>2]&127](o,t,o+32|0);r[o+16>>2]=r[o>>2];r[o+16+4>>2]=r[o+4>>2];r[o+16+8>>2]=r[o+8>>2];r[o+16+12>>2]=r[o+12>>2];h[t+28>>2]=+h[o+16+8>>2]-+h[t+16>>2]}r[t>>2]=4724;r[t+56>>2]=0;r[t+60>>2]=0;n[t+64>>0]=i&1;n[t+65>>0]=0;r[t+4>>2]=21;if(!s){_=o;return}r[5637]=(r[5637]|0)+1;s=Zl(191)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}r[s+52>>2]=284;n[s+60>>0]=0;n[s+80>>0]=1;r[s+76>>2]=0;r[s+68>>2]=0;r[s+72>>2]=0;n[s+100>>0]=1;r[s+96>>2]=0;r[s+88>>2]=0;r[s+92>>2]=0;n[s+120>>0]=1;r[s+116>>2]=0;r[s+108>>2]=0;r[s+112>>2]=0;n[s+140>>0]=1;r[s+136>>2]=0;r[s+128>>2]=0;r[s+132>>2]=0;r[s+144>>2]=0;n[s+164>>0]=1;r[s+160>>2]=0;r[s+152>>2]=0;r[s+156>>2]=0;r[s+168>>2]=0;r[s+4>>2]=-8388609;r[s+8>>2]=-8388609;r[s+12>>2]=-8388609;h[s+16>>2]=0.0;r[s+20>>2]=2139095039;r[s+24>>2]=2139095039;r[s+28>>2]=2139095039;h[s+32>>2]=0.0;r[s>>2]=6168;r[t+56>>2]=s;yA(s,r[t+52>>2]|0,(n[t+64>>0]|0)!=0,t+20|0,t+36|0);n[t+65>>0]=1;_=o;return}function VI(t){t=t|0;Ql(t);return}function zI(t){t=t|0;var e=0;e=_;_=_+t|0;_=_+15&-16;return e|0}function WI(){return _|0}function GI(t){t=t|0;_=t}function jI(t,e){t=t|0;e=e|0;_=t;u=e}function HI(t,e){t=t|0;e=e|0;if(!m){m=t;g=e}}function XI(t){t|0;n[d>>0]=n[t>>0];n[d+1>>0]=n[t+1>>0];n[d+2>>0]=n[t+2>>0];n[d+3>>0]=n[t+3>>0]}function YI(t){t|0;n[d>>0]=n[t>>0];n[d+1>>0]=n[t+1>>0];n[d+2>>0]=n[t+2>>0];n[d+3>>0]=n[t+3>>0];n[d+4>>0]=n[t+4>>0];n[d+5>>0]=n[t+5>>0];n[d+6>>0]=n[t+6>>0];n[d+7>>0]=n[t+7>>0]}function qI(t){t=t|0;P=t}function KI(){return P|0}function ZI(t,e,i,o,l,c){t=t|0;e=e|0;i=i|0;o=o|0;l=l|0;c=c|0;var _=0.0,u=0.0,d=0.0;r[t>>2]=2552;s[t+4>>1]=-2;s[t+6>>1]=-1;r[t+92>>2]=l;r[t+96>>2]=0;n[t+100>>0]=0;r[t+104>>2]=0;r[t+108>>2]=0;if(!l){r[5637]=(r[5637]|0)+1;l=Zl(91)|0;if(!l)l=0;else{r[(l+4+15&-16)+-4>>2]=l;l=l+4+15&-16}WL(l);r[t+92>>2]=l;n[t+100>>0]=1}if(!c){r[5637]=(r[5637]|0)+1;l=Zl(43)|0;if(!l)l=0;else{r[(l+4+15&-16)+-4>>2]=l;l=l+4+15&-16}r[l>>2]=0;r[l+4>>2]=0;r[l+8>>2]=0;r[l+12>>2]=0;r[l+16>>2]=0;r[l+20>>2]=0;r[l>>2]=2616;n[l+20>>0]=1;r[l+16>>2]=0;r[l+8>>2]=0;r[l+12>>2]=0;r[t+112>>2]=l;r[5637]=(r[5637]|0)+1;l=Zl(215)|0;if(!l)l=0;else{r[(l+4+15&-16)+-4>>2]=l;l=l+4+15&-16}gL(l,r[t+112>>2]|0);r[t+108>>2]=l;n[l+193>>0]=1}r[t+8>>2]=r[e>>2];r[t+8+4>>2]=r[e+4>>2];r[t+8+8>>2]=r[e+8>>2];r[t+8+12>>2]=r[e+12>>2];r[t+24>>2]=r[i>>2];r[t+24+4>>2]=r[i+4>>2];r[t+24+8>>2]=r[i+8>>2];r[t+24+12>>2]=r[i+12>>2];d=+(a[t+6>>1]|0);u=d/(+h[t+28>>2]-+h[t+12>>2]);_=d/(+h[t+32>>2]-+h[t+16>>2]);h[t+40>>2]=d/(+h[t+24>>2]-+h[t+8>>2]);h[t+44>>2]=u;h[t+48>>2]=_;h[t+52>>2]=0.0;e=(o&65535)+1&65535;r[5637]=(r[5637]|0)+1;l=Zl(e<<6|19)|0;if(!l)i=0;else{r[(l+4+15&-16)+-4>>2]=l;i=l+4+15&-16}if(e|0){l=i+(e<<6)|0;c=i;do{r[c>>2]=0;r[c+8>>2]=0;c=c+64|0}while((c|0)!=(l|0))}r[t+60>>2]=i;s[t+58>>1]=(o&65535)+1;s[t+56>>1]=0;s[t+64>>1]=1;if(e>>>0>1){l=1;c=1;do{s[i+(l<<6)+48>>1]=l+1;c=c+1<<16>>16;l=c&65535}while(l>>>0<e>>>0)}s[i+(e+-1<<6)+48>>1]=0;r[5637]=(r[5637]|0)+1;l=Zl((e<<3|3)+16|0)|0;if(!l)l=0;else{r[(l+4+15&-16)+-4>>2]=l;l=l+4+15&-16}r[t+80>>2]=l;r[t+68>>2]=l;r[5637]=(r[5637]|0)+1;l=Zl((e<<3|3)+16|0)|0;if(!l)l=0;else{r[(l+4+15&-16)+-4>>2]=l;l=l+4+15&-16}r[t+84>>2]=l;r[t+72>>2]=l;r[5637]=(r[5637]|0)+1;l=Zl((e<<3|3)+16|0)|0;if(!l){i=0;o=t+88|0;r[o>>2]=i;o=t+76|0;r[o>>2]=i;i=r[t+60>>2]|0;r[i>>2]=0;e=i+48|0;s[e>>1]=0;e=i+54|0;s[e>>1]=1;e=r[t+68>>2]|0;s[e>>1]=0;c=e+2|0;s[c>>1]=0;c=s[t+6>>1]|0;l=e+4|0;s[l>>1]=c;e=e+6|0;s[e>>1]=0;e=i+50|0;s[e>>1]=0;e=i+56|0;s[e>>1]=1;e=r[t+72>>2]|0;s[e>>1]=0;l=e+2|0;s[l>>1]=0;l=s[t+6>>1]|0;c=e+4|0;s[c>>1]=l;e=e+6|0;s[e>>1]=0;e=i+52|0;s[e>>1]=0;i=i+58|0;s[i>>1]=1;o=r[o>>2]|0;s[o>>1]=0;i=o+2|0;s[i>>1]=0;i=s[t+6>>1]|0;e=o+4|0;s[e>>1]=i;o=o+6|0;s[o>>1]=0;r[t>>2]=2488;return}r[(l+4+15&-16)+-4>>2]=l;i=l+4+15&-16;o=t+88|0;r[o>>2]=i;o=t+76|0;r[o>>2]=i;i=r[t+60>>2]|0;r[i>>2]=0;e=i+48|0;s[e>>1]=0;e=i+54|0;s[e>>1]=1;e=r[t+68>>2]|0;s[e>>1]=0;c=e+2|0;s[c>>1]=0;c=s[t+6>>1]|0;l=e+4|0;s[l>>1]=c;e=e+6|0;s[e>>1]=0;e=i+50|0;s[e>>1]=0;e=i+56|0;s[e>>1]=1;e=r[t+72>>2]|0;s[e>>1]=0;l=e+2|0;s[l>>1]=0;l=s[t+6>>1]|0;c=e+4|0;s[c>>1]=l;e=e+6|0;s[e>>1]=0;e=i+52|0;s[e>>1]=0;i=i+58|0;s[i>>1]=1;o=r[o>>2]|0;s[o>>1]=0;i=o+2|0;s[i>>1]=0;i=s[t+6>>1]|0;e=o+4|0;s[e>>1]=i;o=o+6|0;s[o>>1]=0;r[t>>2]=2488;return}function QI(t){t=t|0;var e=0;r[t>>2]=2552;if(r[t+108>>2]|0){e=r[t+112>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+112>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+108>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+108>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}}e=r[t+88>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+84>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+80>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}e=r[t+60>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}if(!(n[t+100>>0]|0))return;e=r[t+92>>2]|0;ok[r[r[e>>2]>>2]&255](e);e=r[t+92>>2]|0;if(!e)return;r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);return}function $I(t){t=t|0;QI(t);if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function JI(t,e,i,n,o,l,c,u,d){t=t|0;e=e|0;i=i|0;n=n|0;o=o|0;l=l|0;c=c|0;u=u|0;d=d|0;var p=0,f=0,m=0,g=0,b=0,y=0,v=0,S=0,x=0;x=_;_=_+16|0;IP(t,x+6|0,+h[e>>2],+h[e+4>>2],+h[e+8>>2],0);IP(t,x,+h[i>>2],+h[i+4>>2],+h[i+8>>2],1);S=s[t+64>>1]|0;v=r[t+60>>2]|0;s[t+64>>1]=s[v+((S&65535)<<6)+48>>1]|0;p=(s[t+56>>1]|0)+1<<16>>16;s[t+56>>1]=p;r[v+((S&65535)<<6)+12>>2]=S&65535;r[v+((S&65535)<<6)>>2]=o;s[v+((S&65535)<<6)+4>>1]=l;s[v+((S&65535)<<6)+6>>1]=c;r[v+((S&65535)<<6)+8>>2]=d;m=(p&65535)<<1&65534;s[v+54>>1]=(a[v+54>>1]|0)+2;f=r[t+68>>2]|0;d=a[f+(m+-1<<2)>>1]|a[f+(m+-1<<2)+2>>1]<<16;s[f+((m|1)<<2)>>1]=d;s[f+((m|1)<<2)+2>>1]=d>>>16;f=r[t+68>>2]|0;s[f+(m+-1<<2)>>1]=s[x+6>>1]|0;s[f+(m+-1<<2)+2>>1]=S;s[f+(m<<2)>>1]=s[x>>1]|0;s[f+(m<<2)+2>>1]=S;s[v+((S&65535)<<6)+48>>1]=m+-1;s[v+((S&65535)<<6)+54>>1]=(p&65535)<<1;f=(r[t+60>>2]|0)+56|0;s[f>>1]=(a[f>>1]|0)+2;f=r[t+72>>2]|0;d=a[f+(m+-1<<2)>>1]|a[f+(m+-1<<2)+2>>1]<<16;s[f+((m|1)<<2)>>1]=d;s[f+((m|1)<<2)+2>>1]=d>>>16;f=r[t+72>>2]|0;s[f+(m+-1<<2)>>1]=s[x+6+2>>1]|0;s[f+(m+-1<<2)+2>>1]=S;s[f+(m<<2)>>1]=s[x+2>>1]|0;s[f+(m<<2)+2>>1]=S;s[v+((S&65535)<<6)+50>>1]=m+-1;s[v+((S&65535)<<6)+56>>1]=(p&65535)<<1;f=(r[t+60>>2]|0)+58|0;s[f>>1]=(a[f>>1]|0)+2;f=r[t+76>>2]|0;d=a[f+(m+-1<<2)>>1]|a[f+(m+-1<<2)+2>>1]<<16;s[f+((m|1)<<2)>>1]=d;s[f+((m|1)<<2)+2>>1]=d>>>16;f=r[t+76>>2]|0;s[f+(m+-1<<2)>>1]=s[x+6+4>>1]|0;s[f+(m+-1<<2)+2>>1]=S;s[f+(m<<2)>>1]=s[x+4>>1]|0;s[f+(m<<2)+2>>1]=S;s[v+((S&65535)<<6)+52>>1]=m+-1;s[v+((S&65535)<<6)+58>>1]=(p&65535)<<1;p=r[t+68>>2]|0;m=a[v+((S&65535)<<6)+48>>1]|0;f=r[t+60>>2]|0;d=s[p+(m<<2)+-4>>1]|0;if((a[p+(m<<2)>>1]|0)<(d&65535)){b=f+((a[p+(m<<2)+2>>1]|0)<<6)+48|0;g=p+(m<<2)|0;m=p+(m<<2)+-4|0;while(1){p=a[g+-2>>1]|0;if(!(d&1)){y=f+(p<<6)+48|0;s[y>>1]=(s[y>>1]|0)+1<<16>>16}else{y=f+(p<<6)+54|0;s[y>>1]=(s[y>>1]|0)+1<<16>>16}s[b>>1]=(s[b>>1]|0)+-1<<16>>16;p=a[g>>1]|a[g+2>>1]<<16;d=a[m>>1]|a[m+2>>1]<<16;s[g>>1]=d;s[g+2>>1]=d>>>16;s[m>>1]=p;s[m+2>>1]=p>>>16;p=g+-4|0;m=m+-4|0;d=s[m>>1]|0;if((a[p>>1]|0)>=(d&65535))break;f=r[t+60>>2]|0;g=p}p=r[t+68>>2]|0}d=a[v+((S&65535)<<6)+54>>1]|0;m=p+(d<<2)|0;f=s[m+-4>>1]|0;t:do{if((a[m>>1]|0)<(f&65535)){b=r[t+60>>2]|0;y=b+((a[p+(d<<2)+2>>1]|0)<<6)+54|0;d=f;g=m;f=m+-4|0;while(1){p=a[g+-2>>1]|0;if(!(d&1)){b=b+(p<<6)+48|0;s[b>>1]=(s[b>>1]|0)+1<<16>>16}else{b=b+(p<<6)+54|0;s[b>>1]=(s[b>>1]|0)+1<<16>>16}s[y>>1]=(s[y>>1]|0)+-1<<16>>16;p=a[g>>1]|a[g+2>>1]<<16;d=a[f>>1]|a[f+2>>1]<<16;s[g>>1]=d;s[g+2>>1]=d>>>16;s[f>>1]=p;s[f+2>>1]=p>>>16;p=g+-4|0;f=f+-4|0;d=s[f>>1]|0;if((a[p>>1]|0)>=(d&65535))break t;b=r[t+60>>2]|0;g=p}}}while(0);p=r[t+72>>2]|0;m=a[v+((S&65535)<<6)+50>>1]|0;f=r[t+60>>2]|0;d=s[p+(m<<2)+-4>>1]|0;if((a[p+(m<<2)>>1]|0)<(d&65535)){b=f+((a[p+(m<<2)+2>>1]|0)<<6)+50|0;g=p+(m<<2)|0;m=p+(m<<2)+-4|0;while(1){p=a[g+-2>>1]|0;if(!(d&1)){y=f+(p<<6)+50|0;s[y>>1]=(s[y>>1]|0)+1<<16>>16}else{y=f+(p<<6)+56|0;s[y>>1]=(s[y>>1]|0)+1<<16>>16}s[b>>1]=(s[b>>1]|0)+-1<<16>>16;p=a[g>>1]|a[g+2>>1]<<16;d=a[m>>1]|a[m+2>>1]<<16;s[g>>1]=d;s[g+2>>1]=d>>>16;s[m>>1]=p;s[m+2>>1]=p>>>16;p=g+-4|0;m=m+-4|0;d=s[m>>1]|0;if((a[p>>1]|0)>=(d&65535))break;f=r[t+60>>2]|0;g=p}p=r[t+72>>2]|0}d=a[v+((S&65535)<<6)+56>>1]|0;m=p+(d<<2)|0;f=s[m+-4>>1]|0;t:do{if((a[m>>1]|0)<(f&65535)){b=r[t+60>>2]|0;y=b+((a[p+(d<<2)+2>>1]|0)<<6)+56|0;d=f;g=m;f=m+-4|0;while(1){p=a[g+-2>>1]|0;if(!(d&1)){b=b+(p<<6)+50|0;s[b>>1]=(s[b>>1]|0)+1<<16>>16}else{b=b+(p<<6)+56|0;s[b>>1]=(s[b>>1]|0)+1<<16>>16}s[y>>1]=(s[y>>1]|0)+-1<<16>>16;p=a[g>>1]|a[g+2>>1]<<16;d=a[f>>1]|a[f+2>>1]<<16;s[g>>1]=d;s[g+2>>1]=d>>>16;s[f>>1]=p;s[f+2>>1]=p>>>16;p=g+-4|0;f=f+-4|0;d=s[f>>1]|0;if((a[p>>1]|0)>=(d&65535))break t;b=r[t+60>>2]|0;g=p}}}while(0);PP(t,2,s[v+((S&65535)<<6)+52>>1]|0);LP(t,2,s[v+((S&65535)<<6)+58>>1]|0,u);p=r[t+60>>2]|0;d=r[t+108>>2]|0;if(!d){o=p+((S&65535)<<6)|0;_=x;return o|0}r[p+((S&65535)<<6)+60>>2]=Nk[r[(r[d>>2]|0)+8>>2]&3](d,e,i,n,o,l,c,u,0)|0;o=p+((S&65535)<<6)|0;_=x;return o|0}function tP(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,o=0,l=0,h=0,c=0,_=0,u=0,d=0,p=0,f=0,m=0;n=r[t+108>>2]|0;if(n|0)Vk[r[(r[n>>2]|0)+12>>2]&127](n,r[e+60>>2]|0,i);m=r[e+12>>2]|0;f=r[t+60>>2]|0;p=r[t+92>>2]|0;if(!(ck[r[(r[p>>2]|0)+56>>2]&127](p)|0)){p=r[t+92>>2]|0;Vk[r[(r[p>>2]|0)+16>>2]&127](p,f+((m&65535)<<6)|0,i)}u=a[t+56>>1]|0;n=r[t+60>>2]|0;s[n+54>>1]=(a[n+54>>1]|0)+65534;s[n+56>>1]=(a[n+56>>1]|0)+65534;s[n+58>>1]=(a[n+58>>1]|0)+65534;n=s[t+6>>1]|0;p=0;do{_=t+68+(p<<2)|0;d=r[_>>2]|0;i=a[f+((m&65535)<<6)+54+(p<<1)>>1]|0;s[d+(i<<2)>>1]=n;e=s[d+(i<<2)+6>>1]|0;if(!(e<<16>>16))i=d;else{c=(r[t+60>>2]|0)+((a[d+(i<<2)+2>>1]|0)<<6)+54+(p<<1)|0;l=d+(i<<2)|0;while(1){h=l;l=l+4|0;o=s[l>>1]|0;if((n&65535)<(o&65535))break;i=r[t+60>>2]|0;n=e&65535;if(!(o&1)){o=i+(n<<6)+48+(p<<1)|0;s[o>>1]=(s[o>>1]|0)+-1<<16>>16}else{o=i+(n<<6)+54+(p<<1)|0;s[o>>1]=(s[o>>1]|0)+-1<<16>>16}s[c>>1]=(s[c>>1]|0)+1<<16>>16;n=a[h>>1]|a[h+2>>1]<<16;e=a[l>>1]|a[l+2>>1]<<16;s[h>>1]=e;s[h+2>>1]=e>>>16;s[l>>1]=n;s[l+2>>1]=n>>>16;e=s[h+10>>1]|0;if(!(e<<16>>16))break;else n=n&65535}n=s[t+6>>1]|0;i=r[_>>2]|0}e=a[f+((m&65535)<<6)+48+(p<<1)>>1]|0;s[d+(e<<2)>>1]=n;l=i+(e<<2)|0;o=s[l+6>>1]|0;if(o<<16>>16){c=(r[t+60>>2]|0)+((a[i+(e<<2)+2>>1]|0)<<6)+48+(p<<1)|0;n=s[l>>1]|0;while(1){h=l;l=l+4|0;i=s[l>>1]|0;if((n&65535)<(i&65535))break;e=r[t+60>>2]|0;n=o&65535;if(!(i&1)){_=e+(n<<6)+48+(p<<1)|0;s[_>>1]=(s[_>>1]|0)+-1<<16>>16}else{_=e+(n<<6)+54+(p<<1)|0;s[_>>1]=(s[_>>1]|0)+-1<<16>>16}s[c>>1]=(s[c>>1]|0)+1<<16>>16;n=a[h>>1]|a[h+2>>1]<<16;o=a[l>>1]|a[l+2>>1]<<16;s[h>>1]=o;s[h+2>>1]=o>>>16;s[l>>1]=n;s[l+2>>1]=n>>>16;o=s[h+10>>1]|0;if(!(o<<16>>16))break;else n=n&65535}n=s[t+6>>1]|0}s[d+((u<<1)+-1<<2)+2>>1]=0;s[d+((u<<1)+-1<<2)>>1]=n;p=p+1|0}while((p|0)!=3);s[(r[t+60>>2]|0)+((m&65535)<<6)+48>>1]=s[t+64>>1]|0;s[t+64>>1]=m;s[t+56>>1]=(s[t+56>>1]|0)+-1<<16>>16;return}function eP(t,e,i,n,o){t=t|0;e=e|0;i=i|0;n=n|0;o=o|0;var l=0,c=0,u=0,d=0,p=0,f=0,m=0,g=0,b=0,y=0,v=0,S=0,x=0,w=0,C=0,T=0,A=0,E=0,M=0,R=0,I=0,P=0,L=0,D=0,k=0;k=_;_=_+16|0;r[e+16>>2]=r[i>>2];r[e+16+4>>2]=r[i+4>>2];r[e+16+8>>2]=r[i+8>>2];r[e+16+12>>2]=r[i+12>>2];r[e+32>>2]=r[n>>2];r[e+32+4>>2]=r[n+4>>2];r[e+32+8>>2]=r[n+8>>2];r[e+32+12>>2]=r[n+12>>2];R=r[t+60>>2]|0;I=r[e+12>>2]&65535;IP(t,k+6|0,+h[i>>2],+h[i+4>>2],+h[i+8>>2],0);IP(t,k,+h[n>>2],+h[n+4>>2],+h[n+8>>2],1);D=0;do{y=s[R+(I<<6)+48+(D<<1)>>1]|0;x=s[R+(I<<6)+54+(D<<1)>>1]|0;m=s[k+6+(D<<1)>>1]|0;c=t+68+(D<<2)|0;b=r[c>>2]|0;u=(m&65535)-(a[b+((y&65535)<<2)>>1]|0)|0;g=s[k+(D<<1)>>1]|0;C=(g&65535)-(a[b+((x&65535)<<2)>>1]|0)|0;s[b+((y&65535)<<2)>>1]=m;s[b+((x&65535)<<2)>>1]=g;if((u|0)<0)PP(t,D,y);t:do{if((C|0)>0?(T=r[c>>2]|0,A=r[t+60>>2]|0,E=a[T+((x&65535)<<2)+2>>1]|0,M=s[T+((x&65535)<<2)+6>>1]|0,M<<16>>16):0){d=1<<D&3;p=A+(E<<6)+54+(D<<1)|0;l=M;g=T+((x&65535)<<2)|0;do{b=g;g=g+4|0;f=s[g>>1]|0;if((a[b>>1]|0)<(f&65535))break t;m=r[t+60>>2]|0;l=l&65535;if(!(f&1)){if(((((a[A+(E<<6)+54+(d<<1)>>1]|0)>=(a[m+(l<<6)+48+(d<<1)>>1]|0)?(a[m+(l<<6)+54+(d<<1)>>1]|0)>=(a[A+(E<<6)+48+(d<<1)>>1]|0):0)?(a[A+(E<<6)+54+((1<<d&3)<<1)>>1]|0)>=(a[m+(l<<6)+48+((1<<d&3)<<1)>>1]|0):0)?(a[m+(l<<6)+54+((1<<d&3)<<1)>>1]|0)>=(a[A+(E<<6)+48+((1<<d&3)<<1)>>1]|0):0)?(L=r[t+92>>2]|0,P=m+((a[b+2>>1]|0)<<6)|0,yk[r[(r[L>>2]|0)+8>>2]&63](L,P,m+(l<<6)|0)|0,L=r[t+96>>2]|0,L|0):0)yk[r[(r[L>>2]|0)+8>>2]&63](L,P,m+(l<<6)|0)|0;m=m+(l<<6)+48+(D<<1)|0;s[m>>1]=(s[m>>1]|0)+-1<<16>>16}else{m=m+(l<<6)+54+(D<<1)|0;s[m>>1]=(s[m>>1]|0)+-1<<16>>16}s[p>>1]=(s[p>>1]|0)+1<<16>>16;l=a[b>>1]|a[b+2>>1]<<16;m=a[g>>1]|a[g+2>>1]<<16;s[b>>1]=m;s[b+2>>1]=m>>>16;s[g>>1]=l;s[g+2>>1]=l>>>16;l=s[b+10>>1]|0}while(l<<16>>16!=0)}}while(0);t:do{if((u|0)>0?(v=r[c>>2]|0,S=s[v+((y&65535)<<2)+6>>1]|0,S<<16>>16):0){f=(r[t+60>>2]|0)+((a[v+((y&65535)<<2)+2>>1]|0)<<6)+48+(D<<1)|0;m=1<<D&3;c=S;d=v+((y&65535)<<2)|0;do{p=d;d=d+4|0;l=s[d>>1]|0;if((a[p>>1]|0)<(l&65535))break t;u=r[t+60>>2]|0;c=c&65535;if(!(l&1)){y=u+(c<<6)+48+(D<<1)|0;s[y>>1]=(s[y>>1]|0)+-1<<16>>16}else{l=a[p+2>>1]|0;if(((((a[u+(l<<6)+54+(m<<1)>>1]|0)>=(a[u+(c<<6)+48+(m<<1)>>1]|0)?(a[u+(c<<6)+54+(m<<1)>>1]|0)>=(a[u+(l<<6)+48+(m<<1)>>1]|0):0)?(a[u+(l<<6)+54+((1<<m&3)<<1)>>1]|0)>=(a[u+(c<<6)+48+((1<<m&3)<<1)>>1]|0):0)?(a[u+(c<<6)+54+((1<<m&3)<<1)>>1]|0)>=(a[u+(l<<6)+48+((1<<m&3)<<1)>>1]|0):0)?(w=r[t+92>>2]|0,pk[r[(r[w>>2]|0)+12>>2]&31](w,u+(l<<6)|0,u+(c<<6)|0,o)|0,w=r[t+96>>2]|0,w|0):0)pk[r[(r[w>>2]|0)+12>>2]&31](w,u+(l<<6)|0,u+(c<<6)|0,o)|0;y=u+(c<<6)+54+(D<<1)|0;s[y>>1]=(s[y>>1]|0)+-1<<16>>16}s[f>>1]=(s[f>>1]|0)+1<<16>>16;c=a[p>>1]|a[p+2>>1]<<16;y=a[d>>1]|a[d+2>>1]<<16;s[p>>1]=y;s[p+2>>1]=y>>>16;s[d>>1]=c;s[d+2>>1]=c>>>16;c=s[p+10>>1]|0}while(c<<16>>16!=0)}}while(0);if((C|0)<0)LP(t,D,x,o);D=D+1|0}while((D|0)!=3);l=r[t+108>>2]|0;if(!l){_=k;return}sk[r[(r[l>>2]|0)+16>>2]&31](l,r[e+60>>2]|0,i,n,o);_=k;return}function iP(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;r[i>>2]=r[e+16>>2];r[i+4>>2]=r[e+16+4>>2];r[i+8>>2]=r[e+16+8>>2];r[i+12>>2]=r[e+16+12>>2];r[n>>2]=r[e+32>>2];r[n+4>>2]=r[e+32+4>>2];r[n+8>>2]=r[e+32+8>>2];r[n+12>>2]=r[e+32+12>>2];return}function nP(t,e,i,n,o,l){t=t|0;e=e|0;i=i|0;n=n|0;o=o|0;l=l|0;var h=0;h=r[t+108>>2]|0;if(h|0){vk[r[(r[h>>2]|0)+24>>2]&7](h,e,i,n,o,l);return}h=s[t+56>>1]|0;if((h&65535)<<1>>>0<=1)return;e=1;o=1;do{l=r[t+68>>2]|0;if(s[l+(e<<2)>>1]&1){Rk[r[(r[n>>2]|0)+8>>2]&31](n,(r[t+60>>2]|0)+((a[l+(e<<2)+2>>1]|0)<<6)|0)|0;h=s[t+56>>1]|0}o=o+1<<16>>16;e=o&65535}while(e>>>0<((h&65535)<<1|1)>>>0);return}function sP(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var o=0,l=0,c=0,_=0,u=0;o=r[t+108>>2]|0;if(o|0){jk[r[(r[o>>2]|0)+28>>2]&127](o,e,i,n);return}o=s[t+56>>1]|0;if((o&65535)<<1>>>0<=1)return;c=1;u=1;do{l=r[t+68>>2]|0;if(s[l+(c<<2)>>1]&1){_=r[t+60>>2]|0;c=a[l+(c<<2)+2>>1]|0;if(!(+h[e>>2]>+h[_+(c<<6)+32>>2])?!(+h[i>>2]<+h[_+(c<<6)+16>>2]):0)l=1;else l=0;if(!(!(+h[e+8>>2]>+h[_+(c<<6)+40>>2])?!(+h[i+8>>2]<+h[_+(c<<6)+24>>2]):0))l=0;if(!(+h[e+4>>2]>+h[_+(c<<6)+36>>2])?!(+h[i+4>>2]<+h[_+(c<<6)+20>>2]|l^1):0){Rk[r[(r[n>>2]|0)+8>>2]&31](n,_+(c<<6)|0)|0;o=s[t+56>>1]|0}}u=u+1<<16>>16;c=u&65535}while(c>>>0<((o&65535)<<1|1)>>>0);return}function rP(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0,l=0,h=0,c=0,u=0,d=0,p=0,f=0,m=0;f=_;_=_+32|0;p=r[t+92>>2]|0;if(!(ck[r[(r[p>>2]|0)+56>>2]&127](p)|0)){_=f;return}p=r[t+92>>2]|0;p=ck[r[(r[p>>2]|0)+28>>2]&127](p)|0;i=r[p+4>>2]|0;if((i|0)>1){kP(p,0,i+-1|0);i=r[p+4>>2]|0}n=i-(r[t+104>>2]|0)|0;r[f+16>>2]=0;r[f+16+4>>2]=0;r[f+16+8>>2]=0;r[f+16+12>>2]=0;DP(p,n,f+16|0);r[t+104>>2]=0;n=r[p+4>>2]|0;if((n|0)>0){i=0;c=0;u=0;o=0;while(1){h=r[p+12>>2]|0;l=h+(c<<4)|0;m=u;u=r[l>>2]|0;h=h+(c<<4)+4|0;s=r[h>>2]|0;if(!((u|0)==(m|0)&(s|0)==(o|0))){m=u+54|0;o=u+48|0;if(!((((((a[m>>1]|0)>=(a[s+48>>1]|0)?(a[s+54>>1]|0)>=(a[o>>1]|0):0)?(a[m+2>>1]|0)>=(a[s+48+2>>1]|0):0)?(a[s+54+2>>1]|0)>=(a[o+2>>1]|0):0)?(a[m+4>>1]|0)>=(a[s+52>>1]|0):0)?(a[s+54+4>>1]|0)>=(a[u+52>>1]|0):0))d=13}else{s=o;d=13}if((d|0)==13){d=0;i=r[t+92>>2]|0;Vk[r[(r[i>>2]|0)+32>>2]&127](i,l,e);r[l>>2]=0;r[h>>2]=0;i=(r[t+104>>2]|0)+1|0;r[t+104>>2]=i;r[4984]=(r[4984]|0)+-1;n=r[p+4>>2]|0}c=c+1|0;if((c|0)>=(n|0))break;else o=s}if((n|0)>1){kP(p,0,n+-1|0);n=r[p+4>>2]|0;i=r[t+104>>2]|0}}else i=0;r[f>>2]=0;r[f+4>>2]=0;r[f+8>>2]=0;r[f+12>>2]=0;DP(p,n-i|0,f);r[t+104>>2]=0;_=f;return}function oP(t){t=t|0;return r[t+92>>2]|0}function aP(t){t=t|0;return r[t+92>>2]|0}function lP(t,e,i){t=t|0;e=e|0;i=i|0;r[e>>2]=r[t+8>>2];r[e+4>>2]=r[t+8+4>>2];r[e+8>>2]=r[t+8+8>>2];r[e+12>>2]=r[t+8+12>>2];r[i>>2]=r[t+24>>2];r[i+4>>2]=r[t+24+4>>2];r[i+8>>2]=r[t+24+8>>2];r[i+12>>2]=r[t+24+12>>2];return}function hP(t,e){t=t|0;e=e|0;var i=0,n=0,o=0;e=r[t+56>>2]|0;if((e&65535)<<16>>16)return;s[t+64>>1]=1;o=r[t+60>>2]|0;if((e>>>16&65535)>1){i=1;e=1;while(1){s[o+(i<<6)+48>>1]=i+1;n=e+1<<16>>16;e=s[t+58>>1]|0;if((n&65535)<(e&65535)){i=n&65535;e=n}else break}}else e=e>>>16&65535;s[o+((e&65535)+-1<<6)+48>>1]=0;return}function cP(t){t=t|0;return}function _P(t){t|0;var e=0,i=0;_;_=_+32|0;te(t|0)|0;if(re(23316,3)|0)eh(19340,i);se(r[5830]|0)|0;if((t|0?(r[t>>2]|0,e|0):0)?(r[e+48>>2]&-256|0)==1126902528?(r[e+48+4>>2]|0)==1129074247:0:0){zk[r[e+12>>2]&3]();eh(19664,i+8|0)}r[2054]|0;r[2054]=e+0;zk[e&3]();eh(19664,i+16|0)}function uP(t){t=t|0;QI(t);if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function dP(t){t=t|0;var e=0;r[t>>2]=2616;e=r[t+16>>2]|0;if(e|0){if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+16>>2]=0}n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;r[t+12>>2]=0;return}function pP(t){t=t|0;var e=0;r[t>>2]=2616;e=r[t+16>>2]|0;if(!e){Ql(t);return}if(!(n[t+20>>0]|0)){Ql(t);return}r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);Ql(t);return}function fP(t,e,i){t=t|0;e=e|0;i=i|0;return 0}function mP(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;return 0}function gP(t,e,i){t=t|0;e=e|0;i=i|0;return}function bP(t){t=t|0;return r[t+16>>2]|0}function yP(t){t=t|0;return r[t+16>>2]|0}function vP(t){t=t|0;return t+4|0}function SP(t,e,i){t=t|0;e=e|0;i=i|0;return}function xP(t){t=t|0;return 0}function wP(t,e,i){t=t|0;e=e|0;i=i|0;return}function CP(t,e){t=t|0;e=e|0;return}function TP(t,e,i){t=t|0;e=e|0;i=i|0;return}function AP(t,e,i){t=t|0;e=e|0;i=i|0;return 0}function EP(t){t=t|0;return 1}function MP(t,e){t=t|0;e=e|0;return}function RP(t,e){t=t|0;e=e|0;return}function IP(t,e,i,n,r,o){t=t|0;e=e|0;i=+i;n=+n;r=+r;o=o|0;var a=0,l=0;i=(i-+h[t+8>>2])*+h[t+40>>2];n=(n-+h[t+12>>2])*+h[t+44>>2];r=(r-+h[t+16>>2])*+h[t+48>>2];do{if(!(i<=0.0)){a=s[t+6>>1]|0;l=s[t+4>>1]|0;if(!(i>=+(a&65535))){a=l&(~~i&65535)&65535|o;break}else{a=l&a&65535|o;break}}else a=o}while(0);s[e>>1]=a;do{if(!(n<=0.0)){a=s[t+6>>1]|0;l=s[t+4>>1]|0;if(!(n>=+(a&65535))){a=l&(~~n&65535)&65535|o;break}else{a=l&a&65535|o;break}}else a=o}while(0);s[e+2>>1]=a;if(r<=0.0){o=o&65535;e=e+4|0;s[e>>1]=o;return}l=s[t+6>>1]|0;a=s[t+4>>1]|0;if(!(r>=+(l&65535))){o=a&(~~r&65535)&65535|o;o=o&65535;e=e+4|0;s[e>>1]=o;return}else{o=a&l&65535|o;o=o&65535;e=e+4|0;s[e>>1]=o;return}}function PP(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,o=0,l=0,h=0,c=0,_=0,u=0,d=0;o=r[t+68+(e<<2)>>2]|0;u=r[t+60>>2]|0;d=a[o+((i&65535)<<2)+2>>1]|0;n=s[o+((i&65535)<<2)+-4>>1]|0;if((a[o+((i&65535)<<2)>>1]|0)>=(n&65535))return;h=u;l=o+((i&65535)<<2)|0;i=o+((i&65535)<<2)+-4|0;while(1){o=a[l+-2>>1]|0;if(!(n&1)){h=h+(o<<6)+48+(e<<1)|0;s[h>>1]=(s[h>>1]|0)+1<<16>>16}else{if(((((a[u+(d<<6)+54+((1<<e&3)<<1)>>1]|0)>=(a[h+(o<<6)+48+((1<<e&3)<<1)>>1]|0)?(a[h+(o<<6)+54+((1<<e&3)<<1)>>1]|0)>=(a[u+(d<<6)+48+((1<<e&3)<<1)>>1]|0):0)?(a[u+(d<<6)+54+((1<<(1<<e&3)&3)<<1)>>1]|0)>=(a[h+(o<<6)+48+((1<<(1<<e&3)&3)<<1)>>1]|0):0)?(a[h+(o<<6)+54+((1<<(1<<e&3)&3)<<1)>>1]|0)>=(a[u+(d<<6)+48+((1<<(1<<e&3)&3)<<1)>>1]|0):0)?(_=r[t+92>>2]|0,c=h+(o<<6)|0,yk[r[(r[_>>2]|0)+8>>2]&63](_,u+(d<<6)|0,c)|0,_=r[t+96>>2]|0,_|0):0)yk[r[(r[_>>2]|0)+8>>2]&63](_,u+(d<<6)|0,c)|0;h=h+(o<<6)+54+(e<<1)|0;s[h>>1]=(s[h>>1]|0)+1<<16>>16}s[u+(d<<6)+48+(e<<1)>>1]=(s[u+(d<<6)+48+(e<<1)>>1]|0)+-1<<16>>16;o=a[l>>1]|a[l+2>>1]<<16;n=a[i>>1]|a[i+2>>1]<<16;s[l>>1]=n;s[l+2>>1]=n>>>16;s[i>>1]=o;s[i+2>>1]=o>>>16;o=l+-4|0;i=i+-4|0;n=s[i>>1]|0;if((a[o>>1]|0)>=(n&65535))break;h=r[t+60>>2]|0;l=o}return}function LP(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var o=0,l=0,h=0,c=0,_=0,u=0,d=0,p=0;l=r[t+68+(e<<2)>>2]|0;o=s[l+((i&65535)<<2)+-4>>1]|0;if((a[l+((i&65535)<<2)>>1]|0)>=(o&65535))return;c=r[t+60>>2]|0;_=c+((a[l+((i&65535)<<2)+2>>1]|0)<<6)+54+(e<<1)|0;h=l+((i&65535)<<2)|0;i=l+((i&65535)<<2)+-4|0;while(1){l=a[h+-2>>1]|0;if(!(o&1)){o=a[h+2>>1]|0;if(((((a[c+(o<<6)+54+((1<<e&3)<<1)>>1]|0)>=(a[c+(l<<6)+48+((1<<e&3)<<1)>>1]|0)?(a[c+(l<<6)+54+((1<<e&3)<<1)>>1]|0)>=(a[c+(o<<6)+48+((1<<e&3)<<1)>>1]|0):0)?(a[c+(o<<6)+54+((1<<(1<<e&3)&3)<<1)>>1]|0)>=(a[c+(l<<6)+48+((1<<(1<<e&3)&3)<<1)>>1]|0):0)?(a[c+(l<<6)+54+((1<<(1<<e&3)&3)<<1)>>1]|0)>=(a[c+(o<<6)+48+((1<<(1<<e&3)&3)<<1)>>1]|0):0)?(p=r[t+92>>2]|0,u=c+(o<<6)|0,d=c+(l<<6)|0,pk[r[(r[p>>2]|0)+12>>2]&31](p,u,d,n)|0,p=r[t+96>>2]|0,p|0):0)pk[r[(r[p>>2]|0)+12>>2]&31](p,u,d,n)|0;c=c+(l<<6)+48+(e<<1)|0;s[c>>1]=(s[c>>1]|0)+1<<16>>16}else{c=c+(l<<6)+54+(e<<1)|0;s[c>>1]=(s[c>>1]|0)+1<<16>>16}s[_>>1]=(s[_>>1]|0)+-1<<16>>16;l=a[h>>1]|a[h+2>>1]<<16;o=a[i>>1]|a[i+2>>1]<<16;s[h>>1]=o;s[h+2>>1]=o>>>16;s[i>>1]=l;s[i+2>>1]=l>>>16;l=h+-4|0;i=i+-4|0;o=s[i>>1]|0;if((a[l>>1]|0)>=(o&65535))break;c=r[t+60>>2]|0;h=l}return}function DP(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0,l=0,h=0;l=r[t+4>>2]|0;if((l|0)>=(e|0)){r[t+4>>2]=e;return}if((r[t+8>>2]|0)<(e|0)){if(!e){s=0;o=l}else{r[5637]=(r[5637]|0)+1;s=Zl((e<<4|3)+16|0)|0;if(!s)s=0;else{r[(s+4+15&-16)+-4>>2]=s;s=s+4+15&-16}o=r[t+4>>2]|0}if((o|0)>0){a=0;do{h=r[t+12>>2]|0;r[s+(a<<4)>>2]=r[h+(a<<4)>>2];r[s+(a<<4)+4>>2]=r[h+(a<<4)+4>>2];r[s+(a<<4)+8>>2]=r[h+(a<<4)+8>>2];r[s+(a<<4)+12>>2]=r[h+(a<<4)+12>>2];a=a+1|0}while((a|0)!=(o|0))}o=r[t+12>>2]|0;if(o|0){if(n[t+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+12>>2]=0}n[t+16>>0]=1;r[t+12>>2]=s;r[t+8>>2]=e;o=t+12|0}else o=t+12|0;s=l;do{h=r[o>>2]|0;r[h+(s<<4)>>2]=r[i>>2];r[h+(s<<4)+4>>2]=r[i+4>>2];r[h+(s<<4)+8>>2]=r[i+8>>2];r[h+(s<<4)+12>>2]=r[i+12>>2];s=s+1|0}while((s|0)!=(e|0));r[t+4>>2]=e;return}function kP(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0,a=0,l=0,h=0,c=0,_=0,u=0,d=0,p=0,f=0;while(1){f=(e+i|0)/2|0;u=r[t+12>>2]|0;d=r[u+(f<<4)>>2]|0;p=r[u+(f<<4)+4>>2]|0;f=r[u+(f<<4)+8>>2]|0;n=e;s=i;while(1){t:do{if(!d)while(1){h=r[u+(n<<4)>>2]|0;if(!h)o=-1;else o=r[h+12>>2]|0;c=r[u+(n<<4)+4>>2]|0;if(!c)a=-1;else a=r[c+12>>2]|0;if(!p)l=-1;else l=r[p+12>>2]|0;do{if((o|0)<=-1){o=(a|0)>(l|0);if(o|(h|0)==0^1)if((h|0)==0&o)break;else break t;if((c|0)!=(p|0))break t;if((r[u+(n<<4)+8>>2]|0)>>>0<=f>>>0)break t}}while(0);n=n+1|0}else{_=r[d+12>>2]|0;if(!p)while(1){l=r[u+(n<<4)>>2]|0;if(!l)o=-1;else o=r[l+12>>2]|0;h=r[u+(n<<4)+4>>2]|0;if(!h)a=-1;else a=r[h+12>>2]|0;do{if((o|0)<=(_|0)){o=(a|0)>-1;if(o|(l|0)==(d|0)^1)if((l|0)==(d|0)&o)break;else break t;if(h|0)break t;if((r[u+(n<<4)+8>>2]|0)>>>0<=f>>>0)break t}}while(0);n=n+1|0}c=r[p+12>>2]|0;while(1){l=r[u+(n<<4)>>2]|0;if(!l)o=-1;else o=r[l+12>>2]|0;h=r[u+(n<<4)+4>>2]|0;if(!h)a=-1;else a=r[h+12>>2]|0;do{if((o|0)<=(_|0)){o=(a|0)>(c|0);if(o|(l|0)==(d|0)^1)if((l|0)==(d|0)&o)break;else break t;if((h|0)!=(p|0))break t;if((r[u+(n<<4)+8>>2]|0)>>>0<=f>>>0)break t}}while(0);n=n+1|0}}}while(0);t:do{if(!d)while(1){h=r[u+(s<<4)>>2]|0;if(!h)o=-1;else o=r[h+12>>2]|0;if(!p)a=-1;else a=r[p+12>>2]|0;c=r[u+(s<<4)+4>>2]|0;if(!c)l=-1;else l=r[c+12>>2]|0;do{if((o|0)>=-1){o=(a|0)>(l|0);if(o|(h|0)==0^1)if((h|0)==0&o)break;else break t;if((p|0)!=(c|0))break t;if(f>>>0<=(r[u+(s<<4)+8>>2]|0)>>>0)break t}}while(0);s=s+-1|0}else{_=r[d+12>>2]|0;if(!p)while(1){l=r[u+(s<<4)>>2]|0;if(!l)o=-1;else o=r[l+12>>2]|0;h=r[u+(s<<4)+4>>2]|0;if(!h)a=-1;else a=r[h+12>>2]|0;do{if((_|0)<=(o|0)){o=(a|0)<-1;if(o|(d|0)==(l|0)^1)if((d|0)==(l|0)&o)break;else break t;if(h|0)break t;if(f>>>0<=(r[u+(s<<4)+8>>2]|0)>>>0)break t}}while(0);s=s+-1|0}c=r[p+12>>2]|0;while(1){l=r[u+(s<<4)>>2]|0;if(!l)o=-1;else o=r[l+12>>2]|0;h=r[u+(s<<4)+4>>2]|0;if(!h)a=-1;else a=r[h+12>>2]|0;do{if((_|0)<=(o|0)){o=(c|0)>(a|0);if(o|(d|0)==(l|0)^1)if((d|0)==(l|0)&o)break;else break t;if((p|0)!=(h|0))break t;if(f>>>0<=(r[u+(s<<4)+8>>2]|0)>>>0)break t}}while(0);s=s+-1|0}}}while(0);if((n|0)<=(s|0)){a=u+(n<<4)|0;l=r[a>>2]|0;h=r[u+(n<<4)+4>>2]|0;c=r[u+(n<<4)+8>>2]|0;_=r[u+(n<<4)+12>>2]|0;u=u+(s<<4)|0;r[a>>2]=r[u>>2];r[a+4>>2]=r[u+4>>2];r[a+8>>2]=r[u+8>>2];r[a+12>>2]=r[u+12>>2];u=r[t+12>>2]|0;r[u+(s<<4)>>2]=l;r[u+(s<<4)+4>>2]=h;r[u+(s<<4)+8>>2]=c;r[u+(s<<4)+12>>2]=_;n=n+1|0;s=s+-1|0}if((n|0)>(s|0))break;u=r[t+12>>2]|0}if((s|0)>(e|0))kP(t,e,s);if((n|0)<(i|0))e=n;else break}return}function OP(t){t=t|0;return}function FP(t){t=t|0;var e=0;e=r[t>>2]|0;if(e|0)BP(t,e);e=r[t+4>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+4>>2]=0;r[t+8>>2]=-1;e=r[t+32>>2]|0;if(e|0){if(n[t+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+32>>2]=0}n[t+36>>0]=1;r[t+32>>2]=0;r[t+24>>2]=0;r[t+28>>2]=0;r[t+16>>2]=0;e=r[t+52>>2]|0;if(!e){n[t+56>>0]=1;r[t+52>>2]=0;r[t+44>>2]=0;r[t+48>>2]=0;n[t+36>>0]=1;r[t+32>>2]=0;r[t+24>>2]=0;r[t+28>>2]=0;return}if(!(n[t+56>>0]|0)){n[t+56>>0]=1;r[t+52>>2]=0;r[t+44>>2]=0;r[t+48>>2]=0;n[t+36>>0]=1;r[t+32>>2]=0;r[t+24>>2]=0;r[t+28>>2]=0;return}r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);e=r[t+32>>2]|0;n[t+56>>0]=1;r[t+52>>2]=0;r[t+44>>2]=0;r[t+48>>2]=0;if(!e){n[t+36>>0]=1;r[t+32>>2]=0;r[t+24>>2]=0;r[t+28>>2]=0;return}if(n[t+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+32>>2]=0;n[t+36>>0]=1;r[t+32>>2]=0;r[t+24>>2]=0;r[t+28>>2]=0;return}function BP(t,e){t=t|0;e=e|0;var i=0;if(r[e+40>>2]|0){BP(t,r[e+36>>2]|0);BP(t,r[e+40>>2]|0)}if((r[t>>2]|0)==(e|0))r[t>>2]=0;i=r[t+4>>2]|0;if(!i){r[t+4>>2]=e;return}r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0);r[t+4>>2]=e;return}function NP(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0,a=0,l=0,h=0,c=0,u=0,d=0;d=_;_=_+32|0;if((e|0)<0)e=r[t+12>>2]|0;i=r[t>>2]|0;if(!((e|0)>0&(i|0)!=0)){_=d;return}while(1){n=i+40|0;if(r[n>>2]|0){u=0;while(1){c=(r[t+16>>2]|0)>>>u&1;s=i+32|0;o=r[s>>2]|0;if(o>>>0>i>>>0){a=(r[o+40>>2]|0)==(i|0)&1;l=r[o+36+((a^1)<<2)>>2]|0;h=r[o+32>>2]|0;if(!h)r[t>>2]=i;else r[h+36+(((r[h+40>>2]|0)==(o|0)&1)<<2)>>2]=i;r[l+32>>2]=i;r[o+32>>2]=i;r[s>>2]=h;h=i+36|0;r[o+36>>2]=r[h>>2];r[o+40>>2]=r[n>>2];r[(r[h>>2]|0)+32>>2]=o;r[(r[n>>2]|0)+32>>2]=o;r[i+36+(a<<2)>>2]=o;r[i+36+((a^1)<<2)>>2]=l;r[d>>2]=r[o>>2];r[d+4>>2]=r[o+4>>2];r[d+8>>2]=r[o+8>>2];r[d+12>>2]=r[o+12>>2];r[d+16>>2]=r[o+16>>2];r[d+20>>2]=r[o+20>>2];r[d+24>>2]=r[o+24>>2];r[d+28>>2]=r[o+28>>2];r[o>>2]=r[i>>2];r[o+4>>2]=r[i+4>>2];r[o+8>>2]=r[i+8>>2];r[o+12>>2]=r[i+12>>2];r[o+16>>2]=r[i+16>>2];r[o+20>>2]=r[i+20>>2];r[o+24>>2]=r[i+24>>2];r[o+28>>2]=r[i+28>>2];r[i>>2]=r[d>>2];r[i+4>>2]=r[d+4>>2];r[i+8>>2]=r[d+8>>2];r[i+12>>2]=r[d+12>>2];r[i+16>>2]=r[d+16>>2];r[i+20>>2]=r[d+20>>2];r[i+24>>2]=r[d+24>>2];r[i+28>>2]=r[d+28>>2];i=o}i=r[i+36+(c<<2)>>2]|0;n=i+40|0;if(!(r[n>>2]|0))break;else u=u+1&31}}if(!(UP(t,i)|0))n=0;else n=r[t>>2]|0;VP(t,n,i);r[t+16>>2]=(r[t+16>>2]|0)+1;e=e+-1|0;if(!e)break;i=r[t>>2]|0}_=d;return}function UP(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0,S=0,x=0,w=0,C=0;if((r[t>>2]|0)==(e|0)){r[t>>2]=0;t=0;return t|0}n=r[e+32>>2]|0;i=r[n+32>>2]|0;e=r[n+36+(((r[n+40>>2]|0)!=(e|0)&1)<<2)>>2]|0;if(!i){r[t>>2]=e;r[e+32>>2]=0;i=r[t+4>>2]|0;if(!i)i=e;else{r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0);i=r[t>>2]|0}r[t+4>>2]=n;t=i;return t|0}r[i+36+(((r[i+40>>2]|0)==(n|0)&1)<<2)>>2]=e;r[e+32>>2]=i;e=r[t+4>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+4>>2]=n;do{b=+h[i>>2];w=i+4|0;m=+h[w>>2];S=i+8|0;p=+h[S>>2];C=i+16|0;u=+h[C>>2];x=i+20|0;a=+h[x>>2];n=i+24|0;c=+h[n>>2];v=r[i+36>>2]|0;e=r[i+40>>2]|0;y=+h[v>>2];g=+h[e>>2];g=y<g?y:g;h[i>>2]=g;y=+h[v+16>>2];_=+h[e+16>>2];_=y>_?y:_;h[C>>2]=_;y=+h[v+4>>2];f=+h[e+4>>2];f=y<f?y:f;h[w>>2]=f;y=+h[v+20>>2];o=+h[e+20>>2];o=y>o?y:o;h[x>>2]=o;y=+h[v+8>>2];d=+h[e+8>>2];d=y<d?y:d;h[S>>2]=d;y=+h[v+24>>2];l=+h[e+24>>2];l=y>l?y:l;h[n>>2]=l;if(!(b!=g|m!=f|p!=d|u!=_)?!(c!=l|a!=o):0){s=14;break}i=r[i+32>>2]|0}while((i|0)!=0);if((s|0)==14)return i|0;C=r[t>>2]|0;return C|0}function VP(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0,f=0,m=0.0;if(!(r[t>>2]|0)){r[t>>2]=i;r[i+32>>2]=0;return}n=r[e+40>>2]|0;if(!n)p=e;else{c=+h[i>>2]+ +h[i+16>>2];a=+h[i+4>>2]+ +h[i+20>>2];l=+h[i+8>>2]+ +h[i+24>>2];do{f=r[e+36>>2]|0;d=+W(+(c-(+h[f>>2]+ +h[f+16>>2])))+ +W(+(a-(+h[f+4>>2]+ +h[f+20>>2])))+ +W(+(l-(+h[f+8>>2]+ +h[f+24>>2])));e=r[e+36+((!(d<+W(+(c-(+h[n>>2]+ +h[n+16>>2])))+ +W(+(a-(+h[n+4>>2]+ +h[n+20>>2])))+ +W(+(l-(+h[n+8>>2]+ +h[n+24>>2]))))&1)<<2)>>2]|0;n=r[e+40>>2]|0}while((n|0)!=0);p=e}f=p+32|0;n=r[f>>2]|0;e=r[t+4>>2]|0;if(!e){r[5637]=(r[5637]|0)+1;e=Zl(63)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}s=e;o=s+44|0;do{r[s>>2]=0;s=s+4|0}while((s|0)<(o|0))}else r[t+4>>2]=0;r[e+32>>2]=n;r[e+36>>2]=0;s=e+40|0;r[s>>2]=0;m=+h[i>>2];d=+h[p>>2];d=m<d?m:d;h[e>>2]=d;m=+h[i+16>>2];c=+h[p+16>>2];c=m>c?m:c;h[e+16>>2]=c;m=+h[i+4>>2];u=+h[p+4>>2];u=m<u?m:u;h[e+4>>2]=u;m=+h[i+20>>2];l=+h[p+20>>2];l=m>l?m:l;h[e+20>>2]=l;m=+h[i+8>>2];_=+h[p+8>>2];_=m<_?m:_;h[e+8>>2]=_;m=+h[i+24>>2];a=+h[p+24>>2];a=m>a?m:a;h[e+24>>2]=a;if(!n){r[e+36>>2]=p;r[f>>2]=e;r[s>>2]=i;r[i+32>>2]=e;r[t>>2]=e;return}r[n+36+(((r[(r[f>>2]|0)+40>>2]|0)==(p|0)&1)<<2)>>2]=e;r[e+36>>2]=p;r[f>>2]=e;r[s>>2]=i;r[i+32>>2]=e;while(1){e=n+4|0;if(((((+h[n>>2]<=d?+h[e>>2]<=u:0)?+h[n+8>>2]<=_:0)?+h[n+16>>2]>=c:0)?+h[n+20>>2]>=l:0)?+h[n+24>>2]>=a:0){e=21;break}i=r[n+36>>2]|0;t=r[n+40>>2]|0;m=+h[i>>2];d=+h[t>>2];d=m<d?m:d;h[n>>2]=d;m=+h[i+16>>2];c=+h[t+16>>2];c=m>c?m:c;h[n+16>>2]=c;m=+h[i+4>>2];u=+h[t+4>>2];u=m<u?m:u;h[e>>2]=u;m=+h[i+20>>2];l=+h[t+20>>2];l=m>l?m:l;h[n+20>>2]=l;m=+h[i+8>>2];_=+h[t+8>>2];_=m<_?m:_;h[n+8>>2]=_;m=+h[i+24>>2];a=+h[t+24>>2];a=m>a?m:a;h[n+24>>2]=a;n=r[n+32>>2]|0;if(!n){e=21;break}}if((e|0)==21)return}function zP(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=+s;var o=0,a=0.0,l=0,c=0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0;p=+h[i>>2];if(+h[e>>2]<=p){a=+h[i+4>>2];if((((+h[e+4>>2]<=a?+h[e+8>>2]<=+h[i+8>>2]:0)?+h[e+16>>2]>=+h[i+16>>2]:0)?+h[e+20>>2]>=+h[i+20>>2]:0)?+h[e+24>>2]>=+h[i+24>>2]:0){i=0;return i|0}else o=i+4|0}else{o=i+4|0;a=+h[i+4>>2]}h[i>>2]=p-s;u=a-s;h[o>>2]=u;f=+h[i+8>>2]-s;h[i+8>>2]=f;a=+h[i+16>>2]+s;h[i+16>>2]=a;d=+h[i+20>>2]+s;h[i+20>>2]=d;m=+h[i+24>>2]+s;h[i+24>>2]=m;_=+h[n>>2];if(_>0.0)h[i+16>>2]=_+a;else h[i>>2]=_+(p-s);a=+h[n+4>>2];if(a>0.0)h[i+20>>2]=a+d;else h[o>>2]=a+u;a=+h[n+8>>2];if(a>0.0)h[i+24>>2]=a+m;else h[i+8>>2]=a+f;o=UP(t,e)|0;t:do{if(o){l=r[t+8>>2]|0;if((l|0)<=-1){o=r[t>>2]|0;break}if((l|0)>0){c=0;while(1){n=r[o+32>>2]|0;c=c+1|0;if(!n)break t;if((c|0)>=(l|0)){o=n;break}else o=n}}}else o=0}while(0);r[e>>2]=r[i>>2];r[e+4>>2]=r[i+4>>2];r[e+8>>2]=r[i+8>>2];r[e+12>>2]=r[i+12>>2];r[e+16>>2]=r[i+16>>2];r[e+20>>2]=r[i+20>>2];r[e+24>>2]=r[i+24>>2];r[e+28>>2]=r[i+28>>2];VP(t,o,e);i=1;return i|0}function WP(t,e,i){t=t|0;e=e|0;i=i|0;return}function GP(t,e,i){t=t|0;e=e|0;i=+i;lk[r[(r[t>>2]|0)+12>>2]&127](t,e);return}function jP(t,e){t=t|0;e=e|0;return 1}function HP(t,e){t=t|0;e=e|0;return 1}function XP(t){t=t|0;var e=0;r[t>>2]=2692;if(n[t+192>>0]|0?(e=r[t+136>>2]|0,ok[r[r[e>>2]>>2]&255](e),e=r[t+136>>2]|0,e|0):0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}FP(t+64|0);FP(t+4|0);return}function YP(t){t=t|0;XP(t);Ql(t);return}function qP(t,e,i,o,a,l,h,c,u){t=t|0;e=e|0;i=i|0;o=o|0;a=a|0;l=l|0;h=h|0;c=c|0;u=u|0;var d=0,p=0;p=_;_=_+48|0;r[5637]=(r[5637]|0)+1;o=Zl(83)|0;if(!o)d=0;else{r[(o+4+15&-16)+-4>>2]=o;d=o+4+15&-16}r[d>>2]=a;s[d+4>>1]=l;s[d+6>>1]=h;l=d+16|0;r[l>>2]=r[e>>2];r[l+4>>2]=r[e+4>>2];r[l+8>>2]=r[e+8>>2];r[l+12>>2]=r[e+12>>2];l=d+32|0;r[l>>2]=r[i>>2];r[l+4>>2]=r[i+4>>2];r[l+8>>2]=r[i+8>>2];r[l+12>>2]=r[i+12>>2];r[d+8>>2]=0;l=d+56|0;r[l>>2]=0;h=d+52|0;r[h>>2]=0;r[p+16>>2]=r[e>>2];r[p+16+4>>2]=r[e+4>>2];r[p+16+8>>2]=r[e+8>>2];r[p+16+12>>2]=r[e+12>>2];r[p+16+16>>2]=r[i>>2];r[p+16+16+4>>2]=r[i+4>>2];r[p+16+16+8>>2]=r[i+8>>2];r[p+16+16+12>>2]=r[i+12>>2];r[d+60>>2]=r[t+144>>2];o=(r[t+188>>2]|0)+1|0;r[t+188>>2]=o;r[d+12>>2]=o;o=r[t+8>>2]|0;if(!o){r[5637]=(r[5637]|0)+1;o=Zl(63)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}c=o;u=c+44|0;do{r[c>>2]=0;c=c+4|0}while((c|0)<(u|0))}else r[t+8>>2]=0;r[o+32>>2]=0;r[o+36>>2]=d;r[o+40>>2]=0;r[o>>2]=r[p+16>>2];r[o+4>>2]=r[p+16+4>>2];r[o+8>>2]=r[p+16+8>>2];r[o+12>>2]=r[p+16+12>>2];r[o+16>>2]=r[p+16+16>>2];r[o+20>>2]=r[p+16+20>>2];r[o+24>>2]=r[p+16+24>>2];r[o+28>>2]=r[p+16+28>>2];VP(t+4|0,r[t+4>>2]|0,o);r[t+16>>2]=(r[t+16>>2]|0)+1;r[d+48>>2]=o;c=t+124+(r[t+144>>2]<<2)|0;r[h>>2]=0;r[l>>2]=r[c>>2];o=r[c>>2]|0;if(o|0)r[o+52>>2]=d;r[c>>2]=d;if(n[t+193>>0]|0){_=p;return d|0}r[p>>2]=2756;r[p+4>>2]=t;r[p+8>>2]=d;JP(r[t+4>>2]|0,p+16|0,p);JP(r[t+64>>2]|0,p+16|0,p);_=p;return d|0}function KP(t){t=t|0;return}function ZP(t){t=t|0;Ql(t);return}function QP(t,e,i){t=t|0;e=e|0;i=i|0;var n=0;if((e|0)==(i|0))return;n=r[(r[t+4>>2]|0)+136>>2]|0;yk[r[(r[n>>2]|0)+8>>2]&63](n,r[e+36>>2]|0,r[i+36>>2]|0)|0;t=(r[t+4>>2]|0)+160|0;r[t>>2]=(r[t>>2]|0)+1;return}function $P(t,e){t=t|0;e=e|0;Vk[r[(r[t>>2]|0)+8>>2]&127](t,e,r[(r[t+8>>2]|0)+48>>2]|0);return}function JP(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0,a=0,l=0,c=0,_=0.0,u=0.0,d=0.0,p=0.0,f=0,m=0.0,g=0,b=0.0,y=0;if(!t)return;d=+h[e>>2];p=+h[e+4>>2];m=+h[e+8>>2];b=+h[e+16>>2];u=+h[e+20>>2];_=+h[e+24>>2];r[5637]=(r[5637]|0)+1;e=Zl(275)|0;r[(e+4+15&-16)+-4>>2]=e;r[(e+4+15&-16)>>2]=t;c=1;t=64;e=e+4+15&-16;while(1){n=c+-1|0;a=r[e+(n<<2)>>2]|0;do{if(((((+h[a>>2]<=b?+h[a+16>>2]>=d:0)?+h[a+4>>2]<=u:0)?+h[a+20>>2]>=p:0)?+h[a+8>>2]<=_:0)?+h[a+24>>2]>=m:0){if(!(r[a+40>>2]|0)){lk[r[(r[i>>2]|0)+12>>2]&127](i,a);break}l=r[a+36>>2]|0;do{if((n|0)==(t|0)?(f=t|0?t<<1:1,(c|0)<=(f|0)):0){if((f|0)!=0?(r[5637]=(r[5637]|0)+1,g=Zl((f<<2|3)+16|0)|0,(g|0)!=0):0){r[(g+4+15&-16)+-4>>2]=g;o=g+4+15&-16}else o=0;if((c|0)<=1){if(!e){t=f;e=o;break}}else{s=0;do{r[o+(s<<2)>>2]=r[e+(s<<2)>>2];s=s+1|0}while((s|0)!=(t|0))}r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);t=f;e=o}}while(0);r[e+(n<<2)>>2]=l;o=r[a+40>>2]|0;do{if((c|0)==(t|0)){t=c|0?c<<1:1;if((c|0)<(t|0)){if((t|0)!=0?(r[5637]=(r[5637]|0)+1,y=Zl((t<<2|3)+16|0)|0,(y|0)!=0):0){r[(y+4+15&-16)+-4>>2]=y;s=y+4+15&-16}else s=0;if((c|0)<=0){if(!e){e=s;break}}else{n=0;do{r[s+(n<<2)>>2]=r[e+(n<<2)>>2];n=n+1|0}while((n|0)!=(c|0))}r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);e=s}else t=c}}while(0);r[e+(c<<2)>>2]=o;n=c+1|0}}while(0);if((n|0)>0)c=n;else break}if(!e)return;r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);return}function tL(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0;if((r[e+60>>2]|0)==2){s=r[e+48>>2]|0;UP(t+64|0,s)|0;o=r[t+68>>2]|0;if(o|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+68>>2]=s;r[t+76>>2]=(r[t+76>>2]|0)+-1}else{s=r[e+48>>2]|0;UP(t+4|0,s)|0;o=r[t+8>>2]|0;if(o|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+8>>2]=s;r[t+16>>2]=(r[t+16>>2]|0)+-1}s=r[e+52>>2]|0;o=r[e+56>>2]|0;if(!s)r[t+124+(r[e+60>>2]<<2)>>2]=o;else r[s+56>>2]=o;s=r[e+56>>2]|0;if(s|0)r[s+52>>2]=r[e+52>>2];o=r[t+136>>2]|0;Vk[r[(r[o>>2]|0)+16>>2]&127](o,e,i);r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0);n[t+194>>0]=1;return}function eL(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0,l=0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0,g=0,b=0,y=0.0,v=0.0;b=_;_=_+48|0;r[b+16>>2]=r[i>>2];r[b+16+4>>2]=r[i+4>>2];r[b+16+8>>2]=r[i+8>>2];r[b+16+12>>2]=r[i+12>>2];r[b+16+16>>2]=r[s>>2];r[b+16+16+4>>2]=r[s+4>>2];r[b+16+16+8>>2]=r[s+8>>2];r[b+16+16+12>>2]=r[s+12>>2];do{if((r[e+60>>2]|0)==2){o=r[e+48>>2]|0;UP(t+64|0,o)|0;a=r[t+68>>2]|0;if(a|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+68>>2]=o;r[t+76>>2]=(r[t+76>>2]|0)+-1;o=r[t+8>>2]|0;if(!o){r[5637]=(r[5637]|0)+1;o=Zl(63)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}a=o;l=a+44|0;do{r[a>>2]=0;a=a+4|0}while((a|0)<(l|0))}else r[t+8>>2]=0;r[o+32>>2]=0;r[o+36>>2]=e;r[o+40>>2]=0;r[o>>2]=r[b+16>>2];r[o+4>>2]=r[b+16+4>>2];r[o+8>>2]=r[b+16+8>>2];r[o+12>>2]=r[b+16+12>>2];r[o+16>>2]=r[b+16+16>>2];r[o+20>>2]=r[b+16+20>>2];r[o+24>>2]=r[b+16+24>>2];r[o+28>>2]=r[b+16+28>>2];VP(t+4|0,r[t+4>>2]|0,o);r[t+16>>2]=(r[t+16>>2]|0)+1;r[e+48>>2]=o;l=1}else{r[t+168>>2]=(r[t+168>>2]|0)+1;g=r[e+48>>2]|0;if(((((+h[g>>2]<=+h[b+16+16>>2]?+h[g+16>>2]>=+h[b+16>>2]:0)?+h[g+4>>2]<=+h[b+16+20>>2]:0)?+h[g+20>>2]>=+h[b+16+4>>2]:0)?+h[g+8>>2]<=+h[b+16+24>>2]:0)?+h[g+24>>2]>=+h[b+16+8>>2]:0){c=+h[e+16>>2];y=+h[i>>2]-c;u=+h[e+20>>2];p=+h[i+4>>2]-u;d=+h[e+24>>2];f=+h[i+8>>2]-d;v=+h[t+140>>2];c=(+h[e+32>>2]-c)*.5*v;u=(+h[e+36>>2]-u)*.5*v;d=v*((+h[e+40>>2]-d)*.5);h[b>>2]=c;h[b+4>>2]=u;h[b+8>>2]=d;h[b+12>>2]=0.0;if(y<0.0)h[b>>2]=-c;if(p<0.0)h[b+4>>2]=-u;if(f<0.0)h[b+8>>2]=-d;if(zP(t+4|0,g,b+16|0,b,.05000000074505806)|0){r[t+172>>2]=(r[t+172>>2]|0)+1;o=1}else o=0;l=o;break}o=UP(t+4|0,g)|0;t:do{if(o){l=r[t+12>>2]|0;if((l|0)<=-1){o=r[t+4>>2]|0;break}if((l|0)>0){m=0;while(1){a=r[o+32>>2]|0;m=m+1|0;if(!a)break t;if((m|0)>=(l|0)){o=a;break}else o=a}}}else o=0}while(0);r[g>>2]=r[b+16>>2];r[g+4>>2]=r[b+16+4>>2];r[g+8>>2]=r[b+16+8>>2];r[g+12>>2]=r[b+16+12>>2];r[g+16>>2]=r[b+16+16>>2];r[g+20>>2]=r[b+16+20>>2];r[g+24>>2]=r[b+16+24>>2];r[g+28>>2]=r[b+16+28>>2];VP(t+4|0,o,g);r[t+172>>2]=(r[t+172>>2]|0)+1;l=1}}while(0);o=r[e+52>>2]|0;a=r[e+56>>2]|0;if(!o)r[t+124+(r[e+60>>2]<<2)>>2]=a;else r[o+56>>2]=a;o=r[e+56>>2]|0;if(o|0)r[o+52>>2]=r[e+52>>2];r[e+16>>2]=r[i>>2];r[e+16+4>>2]=r[i+4>>2];r[e+16+8>>2]=r[i+8>>2];r[e+16+12>>2]=r[i+12>>2];r[e+32>>2]=r[s>>2];r[e+32+4>>2]=r[s+4>>2];r[e+32+8>>2]=r[s+8>>2];r[e+32+12>>2]=r[s+12>>2];o=r[t+144>>2]|0;r[e+60>>2]=o;r[e+52>>2]=0;r[e+56>>2]=r[t+124+(o<<2)>>2];a=r[t+124+(o<<2)>>2]|0;if(a|0)r[a+52>>2]=e;r[t+124+(o<<2)>>2]=e;if(!l){_=b;return}n[t+194>>0]=1;if(n[t+193>>0]|0){_=b;return}r[b>>2]=2756;r[b+4>>2]=t;iL(t+64|0,r[t+64>>2]|0,r[e+48>>2]|0,b);iL(t+4|0,r[t+4>>2]|0,r[e+48>>2]|0,b);_=b;return}function iL(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0,l=0,c=0,_=0,u=0,d=0,p=0,f=0;if(!((e|0)!=0&(i|0)!=0))return;if((r[t+24>>2]|0)<128?(r[t+28>>2]|0)<128:0){r[5637]=(r[5637]|0)+1;o=Zl(1043)|0;if(!o)l=0;else{r[(o+4+15&-16)+-4>>2]=o;l=o+4+15&-16}o=r[t+24>>2]|0;if((o|0)>0){a=0;do{_=(r[t+32>>2]|0)+(a<<3)|0;u=r[_+4>>2]|0;d=l+(a<<3)|0;r[d>>2]=r[_>>2];r[d+4>>2]=u;a=a+1|0}while((a|0)!=(o|0))}o=r[t+32>>2]|0;if(o|0){if(n[t+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+32>>2]=0}n[t+36>>0]=1;r[t+32>>2]=l;r[t+28>>2]=128}r[t+24>>2]=128;d=r[t+32>>2]|0;r[d>>2]=e;r[d+4>>2]=i;d=1;l=124;while(1){o=d+-1|0;a=r[t+32>>2]|0;_=r[a+(o<<3)>>2]|0;u=r[a+(o<<3)+4>>2]|0;if((o|0)>(l|0)){i=r[t+24>>2]|0;if((i|0)<(i<<1|0)?(r[t+28>>2]|0)<(i<<1|0):0){if(i){r[5637]=(r[5637]|0)+1;a=Zl((i<<4|3)+16|0)|0;if(!a)a=0;else{r[(a+4+15&-16)+-4>>2]=a;a=a+4+15&-16}l=r[t+24>>2]|0;if((l|0)>0){e=0;do{f=(r[t+32>>2]|0)+(e<<3)|0;p=r[f+4>>2]|0;c=a+(e<<3)|0;r[c>>2]=r[f>>2];r[c+4>>2]=p;e=e+1|0}while((e|0)!=(l|0))}}else a=0;l=r[t+32>>2]|0;if(l|0){if(n[t+36>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0)}r[t+32>>2]=0}n[t+36>>0]=1;r[t+32>>2]=a;r[t+28>>2]=i<<1}r[t+24>>2]=i<<1;l=(i<<1)+-4|0}do{if((_|0)==(u|0)){if(r[_+40>>2]|0){f=r[_+36>>2]|0;r[a+(o<<3)>>2]=f;r[a+(o<<3)+4>>2]=f;o=d+1|0;f=r[t+32>>2]|0;p=r[_+40>>2]|0;r[f+(d<<3)>>2]=p;r[f+(d<<3)+4>>2]=p;f=r[t+32>>2]|0;p=r[_+40>>2]|0;r[f+(o<<3)>>2]=r[_+36>>2];r[f+(o<<3)+4>>2]=p;o=d+2|0}}else if(((((+h[_>>2]<=+h[u+16>>2]?+h[_+16>>2]>=+h[u>>2]:0)?+h[_+4>>2]<=+h[u+20>>2]:0)?+h[_+20>>2]>=+h[u+4>>2]:0)?+h[_+8>>2]<=+h[u+24>>2]:0)?+h[_+24>>2]>=+h[u+8>>2]:0){e=(r[u+40>>2]|0)!=0;if(!(r[_+40>>2]|0))if(e){f=r[u+36>>2]|0;r[a+(o<<3)>>2]=_;r[a+(o<<3)+4>>2]=f;o=r[t+32>>2]|0;f=r[u+40>>2]|0;r[o+(d<<3)>>2]=_;r[o+(d<<3)+4>>2]=f;o=d+1|0;break}else{Vk[r[(r[s>>2]|0)+8>>2]&127](s,_,u);break}else{i=a+(o<<3)|0;c=r[_+36>>2]|0;if(e){f=r[u+36>>2]|0;r[i>>2]=c;r[a+(o<<3)+4>>2]=f;f=d+1|0;o=r[t+32>>2]|0;p=r[u+36>>2]|0;r[o+(d<<3)>>2]=r[_+40>>2];r[o+(d<<3)+4>>2]=p;o=d+2|0;p=r[t+32>>2]|0;c=r[u+40>>2]|0;r[p+(f<<3)>>2]=r[_+36>>2];r[p+(f<<3)+4>>2]=c;f=r[t+32>>2]|0;p=r[u+40>>2]|0;r[f+(o<<3)>>2]=r[_+40>>2];r[f+(o<<3)+4>>2]=p;o=d+3|0;break}else{r[i>>2]=c;r[a+(o<<3)+4>>2]=u;o=r[t+32>>2]|0;r[o+(d<<3)>>2]=r[_+40>>2];r[o+(d<<3)+4>>2]=u;o=d+1|0;break}}}}while(0);if(!o)break;else d=o}return}function nL(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;r[i>>2]=r[e+16>>2];r[i+4>>2]=r[e+16+4>>2];r[i+8>>2]=r[e+16+8>>2];r[i+12>>2]=r[e+16+12>>2];r[n>>2]=r[e+32>>2];r[n+4>>2]=r[e+32+4>>2];r[n+8>>2]=r[e+32+8>>2];r[n+12>>2]=r[e+32+12>>2];return}function sL(t,e,i,n,s,o){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;i=_;_=_+16|0;r[i>>2]=2792;r[i+4>>2]=n;aL(t+4|0,r[t+4>>2]|0,e,n+4|0,n+20|0,+h[n+32>>2],s,o,i);aL(t+64|0,r[t+64>>2]|0,e,n+4|0,n+20|0,+h[n+32>>2],s,o,i);_=i;return}function rL(t){t=t|0;Ql(t);return}function oL(t,e){t=t|0;e=e|0;t=r[t+4>>2]|0;Rk[r[(r[t>>2]|0)+8>>2]&31](t,r[e+36>>2]|0)|0;return}function aL(t,e,i,s,o,a,l,c,u){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=+a;l=l|0;c=c|0;u=u|0;var d=0,p=0,f=0,m=0,g=0.0,b=0.0,y=0.0,v=0.0,S=0,x=0,w=0,C=0,T=0.0,A=0.0,E=0.0,M=0.0,R=0,I=0.0;R=_;_=_+32|0;if(!e){_=R;return}m=r[t+44>>2]|0;if((m|0)<128){if((r[t+48>>2]|0)<128){r[5637]=(r[5637]|0)+1;d=Zl(531)|0;if(!d)f=0;else{r[(d+4+15&-16)+-4>>2]=d;f=d+4+15&-16}d=r[t+44>>2]|0;if((d|0)>0){p=0;do{r[f+(p<<2)>>2]=r[(r[t+52>>2]|0)+(p<<2)>>2];p=p+1|0}while((p|0)!=(d|0))}d=r[t+52>>2]|0;if(d|0){if(n[t+56>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[d+-4>>2]|0)}r[t+52>>2]=0}n[t+56>>0]=1;r[t+52>>2]=f;r[t+48>>2]=128;p=t+52|0}else p=t+52|0;d=m;do{r[(r[p>>2]|0)+(d<<2)>>2]=0;d=d+1|0}while((d|0)!=128);C=t+48|0}else{p=t+52|0;C=t+48|0}r[t+44>>2]=128;r[r[p>>2]>>2]=e;w=1;d=126;while(1){f=w+-1|0;m=r[p>>2]|0;x=r[m+(f<<2)>>2]|0;y=+h[x+4>>2]-+h[c+4>>2];g=+h[x+8>>2]-+h[c+8>>2];h[R>>2]=+h[x>>2]-+h[c>>2];h[R+4>>2]=y;h[R+8>>2]=g;h[R+12>>2]=0.0;g=+h[x+20>>2]-+h[l+4>>2];y=+h[x+24>>2]-+h[l+8>>2];h[R+16>>2]=+h[x+16>>2]-+h[l>>2];h[R+20>>2]=g;h[R+24>>2]=y;h[R+28>>2]=0.0;S=r[o>>2]|0;y=+h[i>>2];g=+h[s>>2];b=(+h[R+(S<<4)>>2]-y)*g;y=g*(+h[R+(1-S<<4)>>2]-y);S=r[o+4>>2]|0;g=+h[i+4>>2];I=+h[s+4>>2];v=(+h[R+(S<<4)+4>>2]-g)*I;g=I*(+h[R+(1-S<<4)+4>>2]-g);do{if((!(v>y|b>g)?(T=v>b?v:b,M=g<y?g:y,S=r[o+8>>2]|0,E=+h[i+8>>2],I=+h[s+8>>2],A=(+h[R+(S<<4)+8>>2]-E)*I,E=I*(+h[R+(1-S<<4)+8>>2]-E),!(A>M|T>E)):0)?(E<M?E:M)>0.0?(A>T?A:T)<a:0:0){if(!(r[x+40>>2]|0)){lk[r[(r[u>>2]|0)+12>>2]&127](u,x);break}if((f|0)>(d|0)){S=r[t+44>>2]|0;if((S|0)<(S<<1|0)){if((r[C>>2]|0)<(S<<1|0)){if(S){r[5637]=(r[5637]|0)+1;d=Zl((S<<3|3)+16|0)|0;if(!d)d=0;else{r[(d+4+15&-16)+-4>>2]=d;d=d+4+15&-16}m=r[t+44>>2]|0;if((m|0)>0){e=0;do{r[d+(e<<2)>>2]=r[(r[p>>2]|0)+(e<<2)>>2];e=e+1|0}while((e|0)!=(m|0))}}else d=0;m=r[p>>2]|0;if(m|0){if(n[t+56>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[m+-4>>2]|0)}r[p>>2]=0}n[t+56>>0]=1;r[p>>2]=d;r[C>>2]=S<<1;m=S}else{d=m;m=S}do{r[d+(m<<2)>>2]=0;m=m+1|0;d=r[p>>2]|0}while((m|0)!=(S<<1|0))}else d=m;r[t+44>>2]=S<<1;m=d;d=(S<<1)+-2|0}r[m+(f<<2)>>2]=r[x+36>>2];r[(r[p>>2]|0)+(w<<2)>>2]=r[x+40>>2];f=w+1|0}}while(0);if(!f)break;else w=f}_=R;return}function lL(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0;s=_;_=_+48|0;r[s+32>>2]=2828;r[s+32+4>>2]=n;r[s>>2]=r[e>>2];r[s+4>>2]=r[e+4>>2];r[s+8>>2]=r[e+8>>2];r[s+12>>2]=r[e+12>>2];r[s+16>>2]=r[i>>2];r[s+16+4>>2]=r[i+4>>2];r[s+16+8>>2]=r[i+8>>2];r[s+16+12>>2]=r[i+12>>2];JP(r[t+4>>2]|0,s,s+32|0);JP(r[t+64>>2]|0,s,s+32|0);_=s;return}function hL(t){t=t|0;Ql(t);return}function cL(t,e){t=t|0;e=e|0;t=r[t+4>>2]|0;Rk[r[(r[t>>2]|0)+8>>2]&31](t,r[e+36>>2]|0)|0;return}function _L(t,e){t=t|0;e=e|0;var i=0,s=0,o=0.0,a=0,l=0,c=0,u=0,d=0,p=0,f=0,m=0,g=0;g=_;_=_+32|0;NP(t+4|0,((et(r[t+152>>2]|0,r[t+16>>2]|0)|0)/100|0)+1|0);if(r[t+164>>2]|0){f=((et(r[t+148>>2]|0,r[t+76>>2]|0)|0)/100|0)+1|0;NP(t+64|0,f);f=(r[t+164>>2]|0)-f|0;r[t+164>>2]=(f|0)<0?0:f}i=((r[t+144>>2]|0)+1|0)%2|0;r[t+144>>2]=i;i=r[t+124+(i<<2)>>2]|0;if(i|0){do{c=i+56|0;u=i;i=r[c>>2]|0;l=r[u+52>>2]|0;a=i;if(!l)r[t+124+(r[u+60>>2]<<2)>>2]=a;else r[l+56>>2]=a;a=r[c>>2]|0;if(a|0)r[a+52>>2]=r[u+52>>2];r[u+52>>2]=0;r[c>>2]=r[t+132>>2];a=r[t+132>>2]|0;if(a|0)r[a+52>>2]=u;r[t+132>>2]=u;a=r[u+48>>2]|0;UP(t+4|0,a)|0;l=r[t+8>>2]|0;if(l|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0)}r[t+8>>2]=a;r[t+16>>2]=(r[t+16>>2]|0)+-1;r[g>>2]=r[u+16>>2];r[g+4>>2]=r[u+16+4>>2];r[g+8>>2]=r[u+16+8>>2];r[g+12>>2]=r[u+16+12>>2];r[g+16>>2]=r[u+32>>2];r[g+16+4>>2]=r[u+32+4>>2];r[g+16+8>>2]=r[u+32+8>>2];r[g+16+12>>2]=r[u+32+12>>2];a=r[t+68>>2]|0;if(!a){r[5637]=(r[5637]|0)+1;a=Zl(63)|0;if(!a)a=0;else{r[(a+4+15&-16)+-4>>2]=a;a=a+4+15&-16}l=a;c=l+44|0;do{r[l>>2]=0;l=l+4|0}while((l|0)<(c|0))}else r[t+68>>2]=0;r[a+32>>2]=0;r[a+36>>2]=u;r[a+40>>2]=0;r[a>>2]=r[g>>2];r[a+4>>2]=r[g+4>>2];r[a+8>>2]=r[g+8>>2];r[a+12>>2]=r[g+12>>2];r[a+16>>2]=r[g+16>>2];r[a+20>>2]=r[g+20>>2];r[a+24>>2]=r[g+24>>2];r[a+28>>2]=r[g+28>>2];VP(t+64|0,r[t+64>>2]|0,a);l=(r[t+76>>2]|0)+1|0;r[t+76>>2]=l;r[u+48>>2]=a;r[u+60>>2]=2}while((i|0)!=0);r[t+164>>2]=l;n[t+194>>0]=1}r[g>>2]=2756;r[g+4>>2]=t;if(n[t+193>>0]|0?(iL(t+4|0,r[t+4>>2]|0,r[t+64>>2]|0,g),n[t+193>>0]|0):0){f=r[t+4>>2]|0;iL(t+4|0,f,f,g)}if(n[t+194>>0]|0?(d=r[t+136>>2]|0,d=ck[r[(r[d>>2]|0)+28>>2]&127](d)|0,s=r[d+4>>2]|0,(s|0)>0):0){i=(et(r[t+156>>2]|0,s)|0)/100|0;f=r[t+160>>2]|0;i=(f|0)>(i|0)?f:i;i=(s|0)<(i|0)?s:i;if((i|0)>0){a=0;do{c=((r[t+184>>2]|0)+a|0)%(s|0)|0;p=r[d+12>>2]|0;l=r[p+(c<<4)>>2]|0;c=r[p+(c<<4)+4>>2]|0;p=r[l+48>>2]|0;f=r[c+48>>2]|0;if(!(((((+h[p>>2]<=+h[f+16>>2]?+h[p+16>>2]>=+h[f>>2]:0)?+h[p+4>>2]<=+h[f+20>>2]:0)?+h[p+20>>2]>=+h[f+4>>2]:0)?+h[p+8>>2]<=+h[f+24>>2]:0)?+h[p+24>>2]>=+h[f+8>>2]:0)){s=r[t+136>>2]|0;pk[r[(r[s>>2]|0)+12>>2]&31](s,l,c,e)|0;s=r[d+4>>2]|0;a=a+-1|0;i=i+-1|0}a=a+1|0}while((a|0)<(i|0));if((s|0)>0)m=37;else i=0}else m=37;if((m|0)==37)i=((r[t+184>>2]|0)+i|0)%(s|0)|0;r[t+184>>2]=i}r[t+180>>2]=(r[t+180>>2]|0)+1;r[t+160>>2]=1;n[t+194>>0]=0;s=r[t+168>>2]|0;i=r[t+172>>2]|0;if(!s)o=0.0;else o=+(i>>>0)/+(s>>>0);h[t+176>>2]=o;r[t+172>>2]=i>>>1;r[t+168>>2]=s>>>1;f=r[t+136>>2]|0;if(!(ck[r[(r[f>>2]|0)+56>>2]&127](f)|0)){_=g;return}f=r[t+136>>2]|0;f=ck[r[(r[f>>2]|0)+28>>2]&127](f)|0;i=r[f+4>>2]|0;if((i|0)>1){kP(f,0,i+-1|0);a=0;l=0;c=0;s=0;m=44}else{a=0;p=0;d=0;s=0}while(1){if((m|0)==44){m=0;i=r[f+4>>2]|0;p=l;d=c}if((a|0)>=(i|0))break;u=r[f+12>>2]|0;l=u+(a<<4)|0;c=r[l>>2]|0;u=u+(a<<4)+4|0;i=r[u>>2]|0;if(!((c|0)==(d|0)&(i|0)==(s|0))){s=r[c+48>>2]|0;d=r[i+48>>2]|0;if(((((+h[s>>2]<=+h[d+16>>2]?+h[s+16>>2]>=+h[d>>2]:0)?+h[s+4>>2]<=+h[d+20>>2]:0)?+h[s+20>>2]>=+h[d+4>>2]:0)?+h[s+8>>2]<=+h[d+24>>2]:0)?+h[s+24>>2]>=+h[d+8>>2]:0){s=i;i=p}else m=53}else{i=s;m=53}if((m|0)==53){s=r[t+136>>2]|0;Vk[r[(r[s>>2]|0)+32>>2]&127](s,l,e);r[l>>2]=0;r[u>>2]=0;s=i;i=p+1|0}a=a+1|0;l=i;m=44}if((i|0)>1){kP(f,0,i+-1|0);l=r[f+4>>2]|0}else l=i;c=l-p|0;if((p|0)<0){if((r[f+8>>2]|0)<(c|0)){if((l|0)!=(p|0)){r[5637]=(r[5637]|0)+1;i=Zl((c<<4|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}s=r[f+4>>2]|0;if((s|0)>0){a=0;do{m=r[f+12>>2]|0;r[i+(a<<4)>>2]=r[m+(a<<4)>>2];r[i+(a<<4)+4>>2]=r[m+(a<<4)+4>>2];r[i+(a<<4)+8>>2]=r[m+(a<<4)+8>>2];r[i+(a<<4)+12>>2]=r[m+(a<<4)+12>>2];a=a+1|0}while((a|0)!=(s|0));s=f+12|0}else s=f+12|0}else{i=0;s=f+12|0}a=r[s>>2]|0;if(a|0){if(n[f+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[s>>2]=0}n[f+16>>0]=1;r[s>>2]=i;r[f+8>>2]=c}else s=f+12|0;i=l;do{m=(r[s>>2]|0)+(i<<4)|0;i=i+1|0;r[m>>2]=0;r[m+4>>2]=0;r[m+8>>2]=0;r[m+12>>2]=0}while((i|0)!=(c|0))}r[f+4>>2]=c;_=g;return}function uL(t){t=t|0;return r[t+136>>2]|0}function dL(t){t=t|0;return r[t+136>>2]|0}function pL(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0,d=0.0;u=r[t+4>>2]|0;t=r[t+64>>2]|0;do{if(!u)if(!t){n=0.0;d=0.0;l=0.0;_=0.0;o=0.0;c=0.0;a=0.0;s=0.0}else{n=+h[t>>2];d=+h[t+12>>2];l=+h[t+16>>2];_=+h[t+20>>2];o=+h[t+24>>2];c=+h[t+28>>2];a=+h[t+4>>2];s=+h[t+8>>2]}else{n=+h[u>>2];if(!t){d=+h[u+12>>2];l=+h[u+16>>2];_=+h[u+20>>2];o=+h[u+24>>2];c=+h[u+28>>2];a=+h[u+4>>2];s=+h[u+8>>2];break}c=+h[t>>2];n=n<c?n:c;c=+h[u+16>>2];l=+h[t+16>>2];l=c>l?c:l;c=+h[u+4>>2];a=+h[t+4>>2];a=c<a?c:a;c=+h[u+20>>2];_=+h[t+20>>2];_=c>_?c:_;c=+h[u+8>>2];s=+h[t+8>>2];s=c<s?c:s;c=+h[u+24>>2];o=+h[t+24>>2];if(c>o){d=0.0;o=c;c=0.0}else{d=0.0;c=0.0}}}while(0);h[e>>2]=n;h[e+4>>2]=a;h[e+8>>2]=s;h[e+12>>2]=d;h[i>>2]=l;h[i+4>>2]=_;h[i+8>>2]=o;h[i+12>>2]=c;return}function fL(t,e){t=t|0;e=e|0;if((r[t+16>>2]|0)!=(0-(r[t+76>>2]|0)|0))return;e=r[t+4>>2]|0;if(e|0)BP(t+4|0,e);e=r[t+8>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+8>>2]=0;r[t+12>>2]=-1;e=r[t+36>>2]|0;if(e|0){if(n[t+40>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+36>>2]=0}n[t+40>>0]=1;r[t+36>>2]=0;r[t+28>>2]=0;r[t+32>>2]=0;r[t+20>>2]=0;e=r[t+64>>2]|0;if(e|0)BP(t+64|0,e);e=r[t+68>>2]|0;if(e|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+68>>2]=0;r[t+72>>2]=-1;e=r[t+96>>2]|0;if(e|0){if(n[t+100>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+96>>2]=0}n[t+100>>0]=1;r[t+96>>2]=0;r[t+88>>2]=0;r[t+92>>2]=0;r[t+80>>2]=0;n[t+193>>0]=0;n[t+194>>0]=1;r[t+144>>2]=0;r[t+164>>2]=0;r[t+148>>2]=1;r[t+152>>2]=0;r[t+156>>2]=10;r[t+160>>2]=1;r[t+124>>2]=0;r[t+124+4>>2]=0;r[t+124+8>>2]=0;r[t+168>>2]=0;r[t+168+4>>2]=0;r[t+168+8>>2]=0;r[t+168+12>>2]=0;r[t+168+16>>2]=0;r[t+168+20>>2]=0;return}function mL(t){t=t|0;return}function gL(t,e){t=t|0;e=e|0;var i=0;r[t>>2]=2692;n[t+40>>0]=1;r[t+36>>2]=0;r[t+28>>2]=0;r[t+32>>2]=0;n[t+60>>0]=1;r[t+56>>2]=0;r[t+48>>2]=0;r[t+52>>2]=0;r[t+4>>2]=0;r[t+8>>2]=0;r[t+12>>2]=-1;r[t+16>>2]=0;r[t+20>>2]=0;n[t+100>>0]=1;r[t+96>>2]=0;r[t+88>>2]=0;r[t+92>>2]=0;n[t+120>>0]=1;r[t+116>>2]=0;r[t+108>>2]=0;r[t+112>>2]=0;r[t+64>>2]=0;r[t+68>>2]=0;r[t+72>>2]=-1;r[t+76>>2]=0;r[t+80>>2]=0;n[t+193>>0]=0;n[t+194>>0]=1;n[t+192>>0]=(e|0)!=0^1;h[t+140>>2]=0.0;r[t+144>>2]=0;r[t+164>>2]=0;r[t+148>>2]=1;r[t+152>>2]=0;r[t+156>>2]=10;r[t+160>>2]=1;r[t+168>>2]=0;r[t+172>>2]=0;h[t+176>>2]=0.0;if(e|0){i=e;e=t+136|0;r[e>>2]=i;e=t+188|0;r[e>>2]=0;e=t+180|0;r[e>>2]=0;e=t+184|0;r[e>>2]=0;t=t+124|0;r[t>>2]=0;r[t+4>>2]=0;r[t+8>>2]=0;return}r[5637]=(r[5637]|0)+1;e=Zl(91)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}WL(e);i=t+136|0;r[i>>2]=e;i=t+188|0;r[i>>2]=0;i=t+180|0;r[i>>2]=0;i=t+184|0;r[i>>2]=0;i=t+124|0;r[i>>2]=0;r[i+4>>2]=0;r[i+8>>2]=0;return}function bL(t){t=t|0;return}function yL(t){t=t|0;var e=0;r[t>>2]=2864;e=r[t+60>>2]|0;if(e|0){if(n[t+64>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+60>>2]=0}n[t+64>>0]=1;r[t+60>>2]=0;r[t+52>>2]=0;r[t+56>>2]=0;e=r[t+40>>2]|0;if(e|0){if(n[t+44>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+40>>2]=0}n[t+44>>0]=1;r[t+40>>2]=0;r[t+32>>2]=0;r[t+36>>2]=0;e=r[t+16>>2]|0;if(!e){n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;t=t+12|0;r[t>>2]=0;return}if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+16>>2]=0;n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;t=t+12|0;r[t>>2]=0;return}function vL(t){t=t|0;yL(t);Ql(t);return}function SL(t,e,i){t=t|0;e=e|0;i=i|0;var o=0,a=0,l=0,h=0,c=0,_=0,u=0,d=0;r[4986]=(r[4986]|0)+1;o=r[t+24>>2]|0;if(!o){o=r[e+4>>2]|0;if(!((s[i+6>>1]&(o&65535))<<16>>16)){t=0;return t|0}if(!((s[i+4>>1]&(o>>>16&65535))<<16>>16)){t=0;return t|0}}else if(!(yk[r[(r[o>>2]|0)+8>>2]&63](o,e,i)|0)){t=0;return t|0}_=(r[e+12>>2]|0)>(r[i+12>>2]|0);u=_?i:e;a=r[u+12>>2]|0;_=_?e:i;e=r[_+12>>2]|0;h=((e<<16|a)+~((e<<16|a)<<15)>>10^(e<<16|a)+~((e<<16|a)<<15))*9|0;h=(h>>6^h)+~((h>>6^h)<<11)>>16^(h>>6^h)+~((h>>6^h)<<11);c=r[t+12>>2]|0;o=r[(r[t+40>>2]|0)+((h&c+-1)<<2)>>2]|0;t:do{if((o|0)!=-1){i=r[t+16>>2]|0;while(1){if((r[(r[i+(o<<4)>>2]|0)+12>>2]|0)==(a|0)?(r[(r[i+(o<<4)+4>>2]|0)+12>>2]|0)==(e|0):0)break;o=r[(r[t+60>>2]|0)+(o<<2)>>2]|0;if((o|0)==-1)break t}o=i+(o<<4)|0;if(o|0){t=o;return t|0}}}while(0);l=r[t+8>>2]|0;if((l|0)==(c|0)){o=c|0?c<<1:1;if((c|0)<(o|0)){if(!o){e=0;i=c}else{r[5637]=(r[5637]|0)+1;e=Zl((o<<4|3)+16|0)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}i=r[t+8>>2]|0}if((i|0)>0){a=0;do{d=r[t+16>>2]|0;r[e+(a<<4)>>2]=r[d+(a<<4)>>2];r[e+(a<<4)+4>>2]=r[d+(a<<4)+4>>2];r[e+(a<<4)+8>>2]=r[d+(a<<4)+8>>2];r[e+(a<<4)+12>>2]=r[d+(a<<4)+12>>2];a=a+1|0}while((a|0)!=(i|0))}a=r[t+16>>2]|0;if(a){if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0);i=r[t+8>>2]|0}r[t+16>>2]=0}n[t+20>>0]=1;r[t+16>>2]=e;r[t+12>>2]=o}else{i=c;o=c}}else{i=l;o=c}r[t+8>>2]=i+1;i=r[t+16>>2]|0;e=r[t+68>>2]|0;if(e){yk[r[(r[e>>2]|0)+8>>2]&63](e,u,_)|0;o=r[t+12>>2]|0}if((c|0)<(o|0)){xL(t);o=(r[t+12>>2]|0)+-1&h}else o=h&c+-1;d=(r[u+12>>2]|0)<(r[_+12>>2]|0);r[i+(l<<4)>>2]=d?u:_;r[i+(l<<4)+4>>2]=d?_:u;r[i+(l<<4)+8>>2]=0;r[i+(l<<4)+8+4>>2]=0;d=(r[t+40>>2]|0)+(o<<2)|0;r[(r[t+60>>2]|0)+(l<<2)>>2]=r[d>>2];r[d>>2]=l;d=i+(l<<4)|0;return d|0}function xL(t){t=t|0;var e=0,i=0,s=0,o=0,a=0,l=0,h=0;l=r[t+12>>2]|0;h=r[t+32>>2]|0;if((l|0)<=(h|0))return;if((l|0)>=(h|0)){do{if((r[t+36>>2]|0)<(l|0)){if(!l){e=0;i=h}else{r[5637]=(r[5637]|0)+1;e=Zl((l<<2|3)+16|0)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}i=r[t+32>>2]|0}s=r[t+40>>2]|0;if((i|0)<=0){if(!s){n[t+44>>0]=1;r[t+40>>2]=e;r[t+36>>2]=l;break}}else{o=0;do{r[e+(o<<2)>>2]=r[s+(o<<2)>>2];o=o+1|0}while((o|0)!=(i|0))}if(n[t+44>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}n[t+44>>0]=1;r[t+40>>2]=e;r[t+36>>2]=l}else e=r[t+40>>2]|0}while(0);Ph(e+(h<<2)|0,0,l-h<<2|0)|0}r[t+32>>2]=l;a=r[t+52>>2]|0;if((l|0)>(a|0)){do{if((r[t+56>>2]|0)<(l|0)){if(!l){e=0;i=a}else{r[5637]=(r[5637]|0)+1;e=Zl((l<<2|3)+16|0)|0;if(!e)e=0;else{r[(e+4+15&-16)+-4>>2]=e;e=e+4+15&-16}i=r[t+52>>2]|0}s=r[t+60>>2]|0;if((i|0)<=0){if(!s){n[t+64>>0]=1;r[t+60>>2]=e;r[t+56>>2]=l;break}}else{o=0;do{r[e+(o<<2)>>2]=r[s+(o<<2)>>2];o=o+1|0}while((o|0)!=(i|0))}if(n[t+64>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}n[t+64>>0]=1;r[t+60>>2]=e;r[t+56>>2]=l}else e=r[t+60>>2]|0}while(0);Ph(e+(a<<2)|0,0,l-a<<2|0)|0}r[t+52>>2]=l;if((l|0)>0){Ph(r[t+40>>2]|0,-1,l<<2|0)|0;Ph(r[t+60>>2]|0,-1,l<<2|0)|0}if((h|0)<=0)return;e=r[t+16>>2]|0;i=r[t+40>>2]|0;s=r[t+60>>2]|0;o=0;do{l=r[(r[e+(o<<4)+4>>2]|0)+12>>2]<<16|r[(r[e+(o<<4)>>2]|0)+12>>2];l=(l+~(l<<15)>>10^l+~(l<<15))*9|0;l=i+((((l>>6^l)+~((l>>6^l)<<11)>>16^(l>>6^l)+~((l>>6^l)<<11))&(r[t+12>>2]|0)+-1)<<2)|0;r[s+(o<<2)>>2]=r[l>>2];r[l>>2]=o;o=o+1|0}while((o|0)!=(h|0));return}function wL(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0,a=0,l=0,h=0,c=0,_=0,u=0,d=0,p=0;r[4985]=(r[4985]|0)+1;h=(r[e+12>>2]|0)>(r[i+12>>2]|0);_=h?i:e;a=r[_+12>>2]|0;h=h?e:i;s=r[h+12>>2]|0;l=((s<<16|a)+~((s<<16|a)<<15)>>10^(s<<16|a)+~((s<<16|a)<<15))*9|0;l=((l>>6^l)+~((l>>6^l)<<11)>>16^(l>>6^l)+~((l>>6^l)<<11))&(r[t+12>>2]|0)+-1;e=r[(r[t+40>>2]|0)+(l<<2)>>2]|0;if((e|0)==-1){p=0;return p|0}o=r[t+16>>2]|0;i=e;while(1){if((r[(r[o+(i<<4)>>2]|0)+12>>2]|0)==(a|0)?(r[(r[o+(i<<4)+4>>2]|0)+12>>2]|0)==(s|0):0)break;e=r[(r[t+60>>2]|0)+(i<<2)>>2]|0;if((e|0)==-1){e=0;p=24;break}else i=e}if((p|0)==24)return e|0;e=o+(i<<4)|0;if(!e){p=0;return p|0}Vk[r[(r[t>>2]|0)+32>>2]&127](t,e,n);d=r[o+(i<<4)+12>>2]|0;u=e-(r[t+16>>2]|0)>>4;a=(r[t+40>>2]|0)+(l<<2)|0;e=r[a>>2]|0;i=r[t+60>>2]|0;if((e|0)!=(u|0)){o=e;while(1){s=i+(o<<2)|0;e=r[s>>2]|0;if((e|0)==(u|0))break;else o=e}e=r[i+(u<<2)>>2]|0;if((o|0)==-1)p=12;else r[s>>2]=e}else{e=r[i+(u<<2)>>2]|0;p=12}if((p|0)==12)r[a>>2]=e;c=(r[t+8>>2]|0)+-1|0;e=r[t+68>>2]|0;if(e|0)pk[r[(r[e>>2]|0)+12>>2]&31](e,_,h,n)|0;if((c|0)==(u|0)){r[t+8>>2]=(r[t+8>>2]|0)+-1;p=d;return p|0}h=r[t+16>>2]|0;a=r[(r[h+(c<<4)+4>>2]|0)+12>>2]<<16|r[(r[h+(c<<4)>>2]|0)+12>>2];a=(a+~(a<<15)>>10^a+~(a<<15))*9|0;a=((a>>6^a)+~((a>>6^a)<<11)>>16^(a>>6^a)+~((a>>6^a)<<11))&(r[t+12>>2]|0)+-1;l=(r[t+40>>2]|0)+(a<<2)|0;e=r[l>>2]|0;i=r[t+60>>2]|0;if((e|0)!=(c|0)){o=e;while(1){s=i+(o<<2)|0;e=r[s>>2]|0;if((e|0)==(c|0))break;else o=e}e=r[i+(c<<2)>>2]|0;if((o|0)==-1)p=22;else r[s>>2]=e}else{e=r[i+(c<<2)>>2]|0;p=22}if((p|0)==22)r[l>>2]=e;r[h+(u<<4)>>2]=r[h+(c<<4)>>2];r[h+(u<<4)+4>>2]=r[h+(c<<4)+4>>2];r[h+(u<<4)+8>>2]=r[h+(c<<4)+8>>2];r[h+(u<<4)+12>>2]=r[h+(c<<4)+12>>2];p=(r[t+40>>2]|0)+(a<<2)|0;r[(r[t+60>>2]|0)+(u<<2)>>2]=r[p>>2];r[p>>2]=u;r[t+8>>2]=(r[t+8>>2]|0)+-1;p=d;return p|0}function CL(t,e,i){t=t|0;e=e|0;i=i|0;var n=0;n=_;_=_+16|0;r[n>>2]=2940;r[n+4>>2]=e;Vk[r[(r[t>>2]|0)+48>>2]&127](t,n,i);_=n;return}function TL(t){t=t|0;return}function AL(t){t=t|0;Ql(t);return}function EL(t,e){t=t|0;e=e|0;t=r[t+4>>2]|0;return((r[e>>2]|0)==(t|0)?1:(r[e+4>>2]|0)==(t|0))|0}function ML(t){t=t|0;return r[t+16>>2]|0}function RL(t){t=t|0;return r[t+16>>2]|0}function IL(t){t=t|0;return t+4|0}function PL(t,e,i){t=t|0;e=e|0;i=i|0;t=r[e+8>>2]|0;if(!((i|0)!=0&(t|0)!=0))return;ok[r[r[t>>2]>>2]&255](t);lk[r[(r[i>>2]|0)+60>>2]&127](i,r[e+8>>2]|0);r[e+8>>2]=0;return}function LL(t){t=t|0;return r[t+8>>2]|0}function DL(t,e,i){t=t|0;e=e|0;i=i|0;var n=0;n=_;_=_+16|0;r[n>>2]=2960;r[n+4>>2]=e;r[n+8>>2]=t;r[n+12>>2]=i;Vk[r[(r[t>>2]|0)+48>>2]&127](t,n,i);_=n;return}function kL(t){t=t|0;Ql(t);return}function OL(t,e){t=t|0;e=e|0;var i=0;i=r[t+4>>2]|0;if((r[e>>2]|0)!=(i|0)?(r[e+4>>2]|0)!=(i|0):0)return 0;i=r[t+8>>2]|0;Vk[r[(r[i>>2]|0)+32>>2]&127](i,e,r[t+12>>2]|0);return 0}function FL(t,e){t=t|0;e=e|0;r[t+24>>2]=e;return}function BL(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0;if((r[t+8>>2]|0)<=0)return;o=0;t:while(1){while(1){n=r[t+16>>2]|0;s=n+(o<<4)|0;if(!(Rk[r[(r[e>>2]|0)+8>>2]&31](e,s)|0))break;pk[r[(r[t>>2]|0)+12>>2]&31](t,r[s>>2]|0,r[n+(o<<4)+4>>2]|0,i)|0;r[4984]=(r[4984]|0)+-1;if((o|0)>=(r[t+8>>2]|0)){n=7;break t}}o=o+1|0;if((o|0)>=(r[t+8>>2]|0)){n=7;break}}if((n|0)==7)return}function NL(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,o=0;r[4987]=(r[4987]|0)+1;n=(r[e+12>>2]|0)>(r[i+12>>2]|0);s=r[(n?i:e)+12>>2]|0;n=r[(n?e:i)+12>>2]|0;e=((n<<16|s)+~((n<<16|s)<<15)>>10^(n<<16|s)+~((n<<16|s)<<15))*9|0;e=((e>>6^e)+~((e>>6^e)<<11)>>16^(e>>6^e)+~((e>>6^e)<<11))&(r[t+12>>2]|0)+-1;if((e|0)>=(r[t+32>>2]|0)){o=0;return o|0}e=r[(r[t+40>>2]|0)+(e<<2)>>2]|0;if((e|0)==-1){o=0;return o|0}i=r[t+16>>2]|0;while(1){if((r[(r[i+(e<<4)>>2]|0)+12>>2]|0)==(s|0)?(r[(r[i+(e<<4)+4>>2]|0)+12>>2]|0)==(n|0):0)break;e=r[(r[t+60>>2]|0)+(e<<2)>>2]|0;if((e|0)==-1){e=0;o=8;break}}if((o|0)==8)return e|0;o=i+(e<<4)|0;return o|0}function UL(t){t=t|0;return 0}function VL(t,e){t=t|0;e=e|0;r[t+68>>2]=e;return}function zL(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0,l=0,h=0,c=0,u=0,d=0,p=0,f=0;f=_;_=_+32|0;n[f+16>>0]=1;r[f+12>>2]=0;r[f+4>>2]=0;r[f+8>>2]=0;i=r[t+8>>2]|0;if((i|0)>0){o=0;a=0;s=0;d=0;do{c=r[t+16>>2]|0;u=c+(d<<4)|0;if((o|0)==(s|0)){h=s|0?s<<1:1;if((s|0)<(h|0)){if(h){r[5637]=(r[5637]|0)+1;i=Zl((h<<4|3)+16|0)|0;if(!i){a=0;s=o}else{r[(i+4+15&-16)+-4>>2]=i;a=i+4+15&-16;s=o}}else a=0;if((s|0)>0){i=0;do{l=r[f+12>>2]|0;r[a+(i<<4)>>2]=r[l+(i<<4)>>2];r[a+(i<<4)+4>>2]=r[l+(i<<4)+4>>2];r[a+(i<<4)+8>>2]=r[l+(i<<4)+8>>2];r[a+(i<<4)+12>>2]=r[l+(i<<4)+12>>2];i=i+1|0}while((i|0)!=(s|0))}i=r[f+12>>2]|0;if(!i)o=s;else{r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0);r[f+12>>2]=0}n[f+16>>0]=1;r[f+12>>2]=a;r[f+8>>2]=h;l=o;s=h;i=r[t+8>>2]|0}else l=s}else l=o;r[a+(l<<4)>>2]=r[u>>2];r[a+(l<<4)+4>>2]=r[c+(d<<4)+4>>2];r[a+(l<<4)+8>>2]=r[c+(d<<4)+8>>2];r[a+(l<<4)+12>>2]=r[c+(d<<4)+12>>2];o=l+1|0;d=d+1|0}while((d|0)<(i|0));r[f+4>>2]=o;if((l|0)>-1){i=r[f+12>>2]|0;s=0;while(1){pk[r[(r[t>>2]|0)+12>>2]&31](t,r[i+(s<<4)>>2]|0,r[i+(s<<4)+4>>2]|0,e)|0;if((s|0)<(l|0))s=s+1|0;else break}}}else o=0;if((r[t+52>>2]|0)>0){i=r[t+60>>2]|0;s=0;do{r[i+(s<<2)>>2]=-1;s=s+1|0}while((s|0)<(r[t+52>>2]|0))}if((o|0)<=1)if((o|0)>0)p=24;else i=r[f+12>>2]|0;else{kP(f,0,o+-1|0);p=24}if((p|0)==24){i=r[f+12>>2]|0;s=0;do{yk[r[(r[t>>2]|0)+8>>2]&63](t,r[i+(s<<4)>>2]|0,r[i+(s<<4)+4>>2]|0)|0;s=s+1|0}while((s|0)<(o|0))}if(!i){_=f;return}r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0);r[f+12>>2]=0;_=f;return}function WL(t){t=t|0;var e=0,i=0,s=0,o=0;r[t>>2]=2864;n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;r[t+12>>2]=0;r[t+24>>2]=0;n[t+44>>0]=1;r[t+40>>2]=0;r[t+32>>2]=0;r[t+36>>2]=0;n[t+64>>0]=1;r[t+60>>2]=0;r[t+52>>2]=0;r[t+56>>2]=0;r[t+68>>2]=0;r[5637]=(r[5637]|0)+1;e=Zl(51)|0;if(!e)s=0;else{r[(e+4+15&-16)+-4>>2]=e;s=e+4+15&-16}e=r[t+8>>2]|0;if((e|0)>0){i=0;do{o=r[t+16>>2]|0;r[s+(i<<4)>>2]=r[o+(i<<4)>>2];r[s+(i<<4)+4>>2]=r[o+(i<<4)+4>>2];r[s+(i<<4)+8>>2]=r[o+(i<<4)+8>>2];r[s+(i<<4)+12>>2]=r[o+(i<<4)+12>>2];i=i+1|0}while((i|0)!=(e|0))}e=r[t+16>>2]|0;if(!e){n[t+20>>0]=1;r[t+16>>2]=s;r[t+12>>2]=2;xL(t);return}if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+16>>2]=0;n[t+20>>0]=1;r[t+16>>2]=s;r[t+12>>2]=2;xL(t);return}function GL(t){t=t|0;var e=0;r[t>>2]=2980;e=r[t+160>>2]|0;if(e|0){if(n[t+164>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+160>>2]=0}n[t+164>>0]=1;r[t+160>>2]=0;r[t+152>>2]=0;r[t+156>>2]=0;e=r[t+136>>2]|0;if(e|0){if(n[t+140>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+136>>2]=0}n[t+140>>0]=1;r[t+136>>2]=0;r[t+128>>2]=0;r[t+132>>2]=0;e=r[t+116>>2]|0;if(e|0){if(n[t+120>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+116>>2]=0}n[t+120>>0]=1;r[t+116>>2]=0;r[t+108>>2]=0;r[t+112>>2]=0;e=r[t+96>>2]|0;if(e|0){if(n[t+100>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+96>>2]=0}n[t+100>>0]=1;r[t+96>>2]=0;r[t+88>>2]=0;r[t+92>>2]=0;e=r[t+76>>2]|0;if(!e){n[t+80>>0]=1;r[t+76>>2]=0;r[t+68>>2]=0;t=t+72|0;r[t>>2]=0;return}if(n[t+80>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+76>>2]=0;n[t+80>>0]=1;r[t+76>>2]=0;r[t+68>>2]=0;t=t+72|0;r[t>>2]=0;return}function jL(t){t=t|0;GL(t);if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function HL(t,e,i,o){t=t|0;e=e|0;i=i|0;o=o|0;var l=0,c=0,_=0,u=0,d=0,p=0;r[t+168>>2]=r[t+152>>2];r[e>>2]=2980;r[e+52>>2]=284;n[e+60>>0]=0;n[e+80>>0]=1;r[e+76>>2]=0;r[e+68>>2]=0;r[e+72>>2]=0;n[e+100>>0]=1;r[e+96>>2]=0;r[e+88>>2]=0;r[e+92>>2]=0;n[e+120>>0]=1;r[e+116>>2]=0;r[e+108>>2]=0;r[e+112>>2]=0;n[e+140>>0]=1;r[e+136>>2]=0;r[e+128>>2]=0;r[e+132>>2]=0;r[e+144>>2]=0;n[e+164>>0]=1;r[e+160>>2]=0;r[e+152>>2]=0;r[e+156>>2]=0;r[e+168>>2]=0;r[e+4>>2]=-8388609;r[e+8>>2]=-8388609;r[e+12>>2]=-8388609;h[e+16>>2]=0.0;r[e+20>>2]=2139095039;r[e+24>>2]=2139095039;r[e+28>>2]=2139095039;h[e+32>>2]=0.0;i=r[t+56>>2]|0;if(o){r[e+56>>2]=Bh(i|0)|0;n[e+4>>0]=n[t+4+3>>0]|0;n[e+5>>0]=n[t+4+2>>0]|0;n[e+6>>0]=n[t+4+1>>0]|0;n[e+7>>0]=n[t+4>>0]|0;n[e+8>>0]=n[t+8+3>>0]|0;n[e+9>>0]=n[t+8+2>>0]|0;n[e+10>>0]=n[t+8+1>>0]|0;n[e+11>>0]=n[t+8>>0]|0;n[e+12>>0]=n[t+12+3>>0]|0;n[e+13>>0]=n[t+12+2>>0]|0;n[e+14>>0]=n[t+12+1>>0]|0;n[e+15>>0]=n[t+12>>0]|0;n[e+16>>0]=n[t+16+3>>0]|0;n[e+17>>0]=n[t+16+2>>0]|0;n[e+18>>0]=n[t+16+1>>0]|0;n[e+19>>0]=n[t+16>>0]|0;n[e+20>>0]=n[t+20+3>>0]|0;n[e+21>>0]=n[t+20+2>>0]|0;n[e+22>>0]=n[t+20+1>>0]|0;n[e+23>>0]=n[t+20>>0]|0;n[e+24>>0]=n[t+24+3>>0]|0;n[e+25>>0]=n[t+24+2>>0]|0;n[e+26>>0]=n[t+24+1>>0]|0;n[e+27>>0]=n[t+24>>0]|0;n[e+28>>0]=n[t+28+3>>0]|0;n[e+29>>0]=n[t+28+2>>0]|0;n[e+30>>0]=n[t+28+1>>0]|0;n[e+31>>0]=n[t+28>>0]|0;n[e+32>>0]=n[t+32+3>>0]|0;n[e+33>>0]=n[t+32+2>>0]|0;n[e+34>>0]=n[t+32+1>>0]|0;n[e+35>>0]=n[t+32>>0]|0;n[e+36>>0]=n[t+36+3>>0]|0;n[e+37>>0]=n[t+36+2>>0]|0;n[e+38>>0]=n[t+36+1>>0]|0;n[e+39>>0]=n[t+36>>0]|0;n[e+40>>0]=n[t+40+3>>0]|0;n[e+41>>0]=n[t+40+2>>0]|0;n[e+42>>0]=n[t+40+1>>0]|0;n[e+43>>0]=n[t+40>>0]|0;n[e+44>>0]=n[t+44+3>>0]|0;n[e+45>>0]=n[t+44+2>>0]|0;n[e+46>>0]=n[t+44+1>>0]|0;n[e+47>>0]=n[t+44>>0]|0;n[e+48>>0]=n[t+48+3>>0]|0;n[e+49>>0]=n[t+48+2>>0]|0;n[e+50>>0]=n[t+48+1>>0]|0;n[e+51>>0]=n[t+48>>0]|0;r[e+144>>2]=Bh(r[t+144>>2]|0)|0;i=Bh(r[t+168>>2]|0)|0}else{r[e+56>>2]=i;r[e+4>>2]=r[t+4>>2];r[e+4+4>>2]=r[t+4+4>>2];r[e+4+8>>2]=r[t+4+8>>2];r[e+4+12>>2]=r[t+4+12>>2];r[e+20>>2]=r[t+20>>2];r[e+20+4>>2]=r[t+20+4>>2];r[e+20+8>>2]=r[t+20+8>>2];r[e+20+12>>2]=r[t+20+12>>2];r[e+36>>2]=r[t+36>>2];r[e+36+4>>2]=r[t+36+4>>2];r[e+36+8>>2]=r[t+36+8>>2];r[e+36+12>>2]=r[t+36+12>>2];r[e+144>>2]=r[t+144>>2];i=r[t+168>>2]|0}r[e+168>>2]=i;n[e+60>>0]=n[t+60>>0]|0;_=r[t+56>>2]|0;if(!(n[t+60>>0]|0)){i=r[e+96>>2]|0;if(i|0){if(n[e+100>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[e+96>>2]=0}r[e+88>>2]=0;r[e+88+4>>2]=0;r[e+88+8>>2]=0;n[e+88+12>>0]=0;r[e+96>>2]=e+172;r[e+88>>2]=_;r[e+92>>2]=_;if(o)if((_|0)>0){l=r[t+96>>2]|0;i=e+172|0;c=0;do{u=l+(c<<6)|0;p=i+(c<<6)|0;n[p>>0]=n[u+3>>0]|0;n[p+1>>0]=n[u+2>>0]|0;n[p+2>>0]=n[u+1>>0]|0;n[p+3>>0]=n[u>>0]|0;p=l+(c<<6)+4|0;u=i+(c<<6)+4|0;n[u>>0]=n[p+3>>0]|0;n[u+1>>0]=n[p+2>>0]|0;n[u+2>>0]=n[p+1>>0]|0;n[u+3>>0]=n[p>>0]|0;u=l+(c<<6)+8|0;p=i+(c<<6)+8|0;n[p>>0]=n[u+3>>0]|0;n[p+1>>0]=n[u+2>>0]|0;n[p+2>>0]=n[u+1>>0]|0;n[p+3>>0]=n[u>>0]|0;p=l+(c<<6)+12|0;i=i+(c<<6)+12|0;n[i>>0]=n[p+3>>0]|0;n[i+1>>0]=n[p+2>>0]|0;n[i+2>>0]=n[p+1>>0]|0;n[i+3>>0]=n[p>>0]|0;i=r[t+96>>2]|0;p=i+(c<<6)+16|0;u=r[e+96>>2]|0;d=u+(c<<6)+16|0;n[d>>0]=n[p+3>>0]|0;n[d+1>>0]=n[p+2>>0]|0;n[d+2>>0]=n[p+1>>0]|0;n[d+3>>0]=n[p>>0]|0;d=i+(c<<6)+20|0;p=u+(c<<6)+20|0;n[p>>0]=n[d+3>>0]|0;n[p+1>>0]=n[d+2>>0]|0;n[p+2>>0]=n[d+1>>0]|0;n[p+3>>0]=n[d>>0]|0;p=i+(c<<6)+24|0;d=u+(c<<6)+24|0;n[d>>0]=n[p+3>>0]|0;n[d+1>>0]=n[p+2>>0]|0;n[d+2>>0]=n[p+1>>0]|0;n[d+3>>0]=n[p>>0]|0;i=i+(c<<6)+28|0;u=u+(c<<6)+28|0;n[u>>0]=n[i+3>>0]|0;n[u+1>>0]=n[i+2>>0]|0;n[u+2>>0]=n[i+1>>0]|0;n[u+3>>0]=n[i>>0]|0;l=r[t+96>>2]|0;u=Bh(r[l+(c<<6)+32>>2]|0)|0;i=r[e+96>>2]|0;r[i+(c<<6)+32>>2]=u;r[i+(c<<6)+36>>2]=Bh(r[l+(c<<6)+36>>2]|0)|0;r[i+(c<<6)+40>>2]=Bh(r[l+(c<<6)+40>>2]|0)|0;c=c+1|0}while((c|0)!=(_|0))}else i=e+172|0;else if((_|0)>0){i=e+172|0;l=r[t+96>>2]|0;c=0;do{i=i+(c<<6)|0;p=l+(c<<6)|0;r[i>>2]=r[p>>2];r[i+4>>2]=r[p+4>>2];r[i+8>>2]=r[p+8>>2];r[i+12>>2]=r[p+12>>2];i=(r[e+96>>2]|0)+(c<<6)+16|0;p=(r[t+96>>2]|0)+(c<<6)+16|0;r[i>>2]=r[p>>2];r[i+4>>2]=r[p+4>>2];r[i+8>>2]=r[p+8>>2];r[i+12>>2]=r[p+12>>2];l=r[t+96>>2]|0;i=r[e+96>>2]|0;r[i+(c<<6)+32>>2]=r[l+(c<<6)+32>>2];r[i+(c<<6)+36>>2]=r[l+(c<<6)+36>>2];r[i+(c<<6)+40>>2]=r[l+(c<<6)+40>>2];c=c+1|0}while((c|0)!=(_|0))}else i=e+172|0;if(i|0){if(n[e+100>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[e+96>>2]=0}r[e+88>>2]=0;r[e+88+4>>2]=0;r[e+88+8>>2]=0;n[e+88+12>>0]=0;i=_<<6}else{i=r[e+136>>2]|0;if(i|0){if(n[e+140>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[i+-4>>2]|0)}r[e+136>>2]=0}r[e+128>>2]=0;r[e+128+4>>2]=0;r[e+128+8>>2]=0;n[e+128+12>>0]=0;r[e+136>>2]=e+172;r[e+128>>2]=_;r[e+132>>2]=_;if(o){if((_|0)>0){i=r[t+136>>2]|0;l=0;do{p=a[i+(l<<4)>>1]|0;s[e+172+(l<<4)>>1]=p>>>8|p<<8;p=a[i+(l<<4)+2>>1]|0;s[e+172+(l<<4)+2>>1]=p>>>8|p<<8;p=a[i+(l<<4)+4>>1]|0;s[e+172+(l<<4)+4>>1]=p>>>8|p<<8;p=a[i+(l<<4)+6>>1]|0;s[e+172+(l<<4)+6>>1]=p>>>8|p<<8;p=a[i+(l<<4)+8>>1]|0;s[e+172+(l<<4)+8>>1]=p>>>8|p<<8;p=a[i+(l<<4)+10>>1]|0;s[e+172+(l<<4)+10>>1]=p>>>8|p<<8;r[e+172+(l<<4)+12>>2]=Bh(r[i+(l<<4)+12>>2]|0)|0;l=l+1|0}while((l|0)!=(_|0))}}else if((_|0)>0){i=r[t+136>>2]|0;l=0;do{s[e+172+(l<<4)>>1]=s[i+(l<<4)>>1]|0;s[e+172+(l<<4)+2>>1]=s[i+(l<<4)+2>>1]|0;s[e+172+(l<<4)+4>>1]=s[i+(l<<4)+4>>1]|0;s[e+172+(l<<4)+6>>1]=s[i+(l<<4)+6>>1]|0;s[e+172+(l<<4)+8>>1]=s[i+(l<<4)+8>>1]|0;s[e+172+(l<<4)+10>>1]=s[i+(l<<4)+10>>1]|0;r[e+172+(l<<4)+12>>2]=r[i+(l<<4)+12>>2];l=l+1|0}while((l|0)!=(_|0))}if(r[e+136>>2]|0)r[e+136>>2]=0;r[e+128>>2]=0;r[e+128+4>>2]=0;r[e+128+8>>2]=0;n[e+128+12>>0]=0;i=_<<4}_=e+172+i|0;i=r[t+168>>2]|0;l=r[e+160>>2]|0;if(l|0){if(n[e+164>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0)}r[e+160>>2]=0}r[e+152>>2]=0;r[e+152+4>>2]=0;r[e+152+8>>2]=0;n[e+152+12>>0]=0;r[e+160>>2]=_;r[e+152>>2]=i;r[e+156>>2]=i;c=r[t+168>>2]|0;if(o){if((c|0)>0){i=r[t+160>>2]|0;l=0;do{p=a[i+(l<<5)>>1]|0;s[_+(l<<5)>>1]=p>>>8|p<<8;p=a[i+(l<<5)+2>>1]|0;s[_+(l<<5)+2>>1]=p>>>8|p<<8;p=a[i+(l<<5)+4>>1]|0;s[_+(l<<5)+4>>1]=p>>>8|p<<8;p=a[i+(l<<5)+6>>1]|0;s[_+(l<<5)+6>>1]=p>>>8|p<<8;p=a[i+(l<<5)+8>>1]|0;s[_+(l<<5)+8>>1]=p>>>8|p<<8;p=a[i+(l<<5)+10>>1]|0;s[_+(l<<5)+10>>1]=p>>>8|p<<8;r[_+(l<<5)+12>>2]=Bh(r[i+(l<<5)+12>>2]|0)|0;r[_+(l<<5)+16>>2]=Bh(r[i+(l<<5)+16>>2]|0)|0;l=l+1|0}while((l|0)!=(c|0))}}else if((c|0)>0){i=r[t+160>>2]|0;l=0;do{s[_+(l<<5)>>1]=s[i+(l<<5)>>1]|0;s[_+(l<<5)+2>>1]=s[i+(l<<5)+2>>1]|0;s[_+(l<<5)+4>>1]=s[i+(l<<5)+4>>1]|0;s[_+(l<<5)+6>>1]=s[i+(l<<5)+6>>1]|0;s[_+(l<<5)+8>>1]=s[i+(l<<5)+8>>1]|0;s[_+(l<<5)+10>>1]=s[i+(l<<5)+10>>1]|0;r[_+(l<<5)+12>>2]=r[i+(l<<5)+12>>2];r[_+(l<<5)+16>>2]=r[i+(l<<5)+16>>2];r[_+(l<<5)+20>>2]=0;r[_+(l<<5)+24>>2]=0;r[_+(l<<5)+28>>2]=0;l=l+1|0}while((l|0)<(r[t+168>>2]|0))}if(!(r[e+160>>2]|0)){r[e>>2]=0;r[e+152>>2]=0;r[e+152+4>>2]=0;r[e+152+8>>2]=0;n[e+152+12>>0]=0;return 1}r[e+160>>2]=0;r[e>>2]=0;r[e+152>>2]=0;r[e+152+4>>2]=0;r[e+152+8>>2]=0;n[e+152+12>>0]=0;return 1}function XL(t){t=t|0;return 84}function YL(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,a=0,l=0,h=0,c=0;r[e+16>>2]=r[t+20>>2];r[e+20>>2]=r[t+24>>2];r[e+24>>2]=r[t+28>>2];r[e+28>>2]=r[t+32>>2];r[e>>2]=r[t+4>>2];r[e+4>>2]=r[t+8>>2];r[e+8>>2]=r[t+12>>2];r[e+12>>2]=r[t+16>>2];r[e+32>>2]=r[t+36>>2];r[e+36>>2]=r[t+40>>2];r[e+40>>2]=r[t+44>>2];r[e+44>>2]=r[t+48>>2];r[e+48>>2]=r[t+56>>2];r[e+52>>2]=o[t+60>>0];c=r[t+88>>2]|0;r[e+56>>2]=c;if(c){c=Rk[r[(r[i>>2]|0)+28>>2]&31](i,r[t+96>>2]|0)|0;r[e+64>>2]=c;if(c|0){a=r[t+88>>2]|0;c=yk[r[(r[i>>2]|0)+16>>2]&63](i,48,a)|0;if((a|0)>0){n=r[t+96>>2]|0;l=0;h=r[c+8>>2]|0;while(1){r[h+16>>2]=r[n+(l<<6)+16>>2];r[h+20>>2]=r[n+(l<<6)+20>>2];r[h+24>>2]=r[n+(l<<6)+24>>2];r[h+28>>2]=r[n+(l<<6)+28>>2];r[h>>2]=r[n+(l<<6)>>2];r[h+4>>2]=r[n+(l<<6)+4>>2];r[h+8>>2]=r[n+(l<<6)+8>>2];r[h+12>>2]=r[n+(l<<6)+12>>2];r[h+32>>2]=r[n+(l<<6)+32>>2];r[h+36>>2]=r[n+(l<<6)+36>>2];r[h+40>>2]=r[n+(l<<6)+40>>2];l=l+1|0;if((l|0)==(a|0))break;else h=h+48|0}}else n=r[t+96>>2]|0;sk[r[(r[i>>2]|0)+20>>2]&31](i,c,8969,1497453121,n)}}else r[e+64>>2]=0;c=r[t+128>>2]|0;r[e+60>>2]=c;if(c){c=Rk[r[(r[i>>2]|0)+28>>2]&31](i,r[t+136>>2]|0)|0;r[e+68>>2]=c;if(c|0){a=r[t+128>>2]|0;c=yk[r[(r[i>>2]|0)+16>>2]&63](i,16,a)|0;if((a|0)>0){n=r[t+136>>2]|0;l=0;h=r[c+8>>2]|0;while(1){r[h+12>>2]=r[n+(l<<4)+12>>2];s[h+6>>1]=s[n+(l<<4)+6>>1]|0;s[h+8>>1]=s[n+(l<<4)+8>>1]|0;s[h+10>>1]=s[n+(l<<4)+10>>1]|0;s[h>>1]=s[n+(l<<4)>>1]|0;s[h+2>>1]=s[n+(l<<4)+2>>1]|0;s[h+4>>1]=s[n+(l<<4)+4>>1]|0;l=l+1|0;if((l|0)==(a|0))break;else h=h+16|0}}else n=r[t+136>>2]|0;sk[r[(r[i>>2]|0)+20>>2]&31](i,c,8992,1497453121,n)}}else r[e+68>>2]=0;r[e+76>>2]=r[t+144>>2];c=r[t+152>>2]|0;r[e+80>>2]=c;if(!c){r[e+72>>2]=0;return 9036}c=Rk[r[(r[i>>2]|0)+28>>2]&31](i,r[t+160>>2]|0)|0;r[e+72>>2]=c;if(!c)return 9036;h=r[t+152>>2]|0;c=yk[r[(r[i>>2]|0)+16>>2]&63](i,20,h)|0;if((h|0)>0){n=r[t+160>>2]|0;a=0;l=r[c+8>>2]|0;while(1){s[l+14>>1]=s[n+(a<<5)+6>>1]|0;s[l+16>>1]=s[n+(a<<5)+8>>1]|0;s[l+18>>1]=s[n+(a<<5)+10>>1]|0;s[l+8>>1]=s[n+(a<<5)>>1]|0;s[l+10>>1]=s[n+(a<<5)+2>>1]|0;s[l+12>>1]=s[n+(a<<5)+4>>1]|0;r[l>>2]=r[n+(a<<5)+12>>2];r[l+4>>2]=r[n+(a<<5)+16>>2];a=a+1|0;if((a|0)==(h|0))break;else l=l+20|0}}else n=r[t+160>>2]|0;sk[r[(r[i>>2]|0)+20>>2]&31](i,c,9015,1497453121,n);return 9036}function qL(t,e){t=t|0;e=e|0;var i=0,o=0,a=0,l=0,h=0,c=0,u=0,d=0,p=0;p=_;_=_+112|0;r[t+20>>2]=r[e+16>>2];r[t+24>>2]=r[e+20>>2];r[t+28>>2]=r[e+24>>2];r[t+32>>2]=r[e+28>>2];r[t+4>>2]=r[e>>2];r[t+8>>2]=r[e+4>>2];r[t+12>>2]=r[e+8>>2];r[t+16>>2]=r[e+12>>2];r[t+36>>2]=r[e+32>>2];r[t+40>>2]=r[e+36>>2];r[t+44>>2]=r[e+40>>2];r[t+48>>2]=r[e+44>>2];r[t+56>>2]=r[e+48>>2];n[t+60>>0]=(r[e+52>>2]|0)!=0&1;d=r[e+56>>2]|0;l=p+48|0;c=l+64|0;do{r[l>>2]=0;l=l+4|0}while((l|0)<(c|0));u=r[t+88>>2]|0;if((u|0)<(d|0)){if((r[t+92>>2]|0)<(d|0)){if(!d){i=0;o=u}else{r[5637]=(r[5637]|0)+1;i=Zl(d<<6|19)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=r[t+88>>2]|0}if((o|0)>0){a=0;do{l=i+(a<<6)|0;h=(r[t+96>>2]|0)+(a<<6)|0;c=l+64|0;do{r[l>>2]=r[h>>2];l=l+4|0;h=h+4|0}while((l|0)<(c|0));a=a+1|0}while((a|0)!=(o|0))}o=r[t+96>>2]|0;if(o|0){if(n[t+100>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+96>>2]=0}n[t+100>>0]=1;r[t+96>>2]=i;r[t+92>>2]=d;o=t+96|0}else o=t+96|0;i=u;do{l=(r[o>>2]|0)+(i<<6)|0;h=p+48|0;c=l+64|0;do{r[l>>2]=r[h>>2];l=l+4|0;h=h+4|0}while((l|0)<(c|0));i=i+1|0}while((i|0)!=(d|0))}r[t+88>>2]=d;if((d|0)>0){i=r[t+96>>2]|0;o=0;a=r[e+64>>2]|0;while(1){r[i+(o<<6)+16>>2]=r[a+16>>2];r[i+(o<<6)+20>>2]=r[a+20>>2];r[i+(o<<6)+24>>2]=r[a+24>>2];r[i+(o<<6)+28>>2]=r[a+28>>2];r[i+(o<<6)>>2]=r[a>>2];r[i+(o<<6)+4>>2]=r[a+4>>2];r[i+(o<<6)+8>>2]=r[a+8>>2];r[i+(o<<6)+12>>2]=r[a+12>>2];r[i+(o<<6)+32>>2]=r[a+32>>2];r[i+(o<<6)+36>>2]=r[a+36>>2];r[i+(o<<6)+40>>2]=r[a+40>>2];o=o+1|0;if((o|0)==(d|0))break;else a=a+48|0}}h=r[e+60>>2]|0;r[p+32>>2]=0;r[p+32+4>>2]=0;r[p+32+8>>2]=0;r[p+32+12>>2]=0;l=r[t+128>>2]|0;if((l|0)<(h|0)){if((r[t+132>>2]|0)<(h|0)){if(!h){i=0;o=l}else{r[5637]=(r[5637]|0)+1;i=Zl((h<<4|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=r[t+128>>2]|0}if((o|0)>0){a=0;do{d=i+(a<<4)|0;u=(r[t+136>>2]|0)+(a<<4)|0;r[d>>2]=r[u>>2];r[d+4>>2]=r[u+4>>2];r[d+8>>2]=r[u+8>>2];r[d+12>>2]=r[u+12>>2];a=a+1|0}while((a|0)!=(o|0))}o=r[t+136>>2]|0;if(o|0){if(n[t+140>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+136>>2]=0}n[t+140>>0]=1;r[t+136>>2]=i;r[t+132>>2]=h;o=t+136|0}else o=t+136|0;i=l;do{d=(r[o>>2]|0)+(i<<4)|0;r[d>>2]=r[p+32>>2];r[d+4>>2]=r[p+32+4>>2];r[d+8>>2]=r[p+32+8>>2];r[d+12>>2]=r[p+32+12>>2];i=i+1|0}while((i|0)!=(h|0))}r[t+128>>2]=h;if((h|0)>0){i=r[t+136>>2]|0;o=0;a=r[e+68>>2]|0;while(1){r[i+(o<<4)+12>>2]=r[a+12>>2];s[i+(o<<4)+6>>1]=s[a+6>>1]|0;s[i+(o<<4)+8>>1]=s[a+8>>1]|0;s[i+(o<<4)+10>>1]=s[a+10>>1]|0;s[i+(o<<4)>>1]=s[a>>1]|0;s[i+(o<<4)+2>>1]=s[a+2>>1]|0;s[i+(o<<4)+4>>1]=s[a+4>>1]|0;o=o+1|0;if((o|0)==(h|0))break;else a=a+16|0}}r[t+144>>2]=r[e+76>>2];h=r[e+80>>2]|0;l=r[t+152>>2]|0;if((l|0)<(h|0)){if((r[t+156>>2]|0)<(h|0)){if(!h){i=0;o=l}else{r[5637]=(r[5637]|0)+1;i=Zl(h<<5|19)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=r[t+152>>2]|0}if((o|0)>0){a=0;do{d=i+(a<<5)|0;u=(r[t+160>>2]|0)+(a<<5)|0;r[d>>2]=r[u>>2];r[d+4>>2]=r[u+4>>2];r[d+8>>2]=r[u+8>>2];r[d+12>>2]=r[u+12>>2];r[d+16>>2]=r[u+16>>2];r[d+20>>2]=r[u+20>>2];r[d+24>>2]=r[u+24>>2];r[d+28>>2]=r[u+28>>2];a=a+1|0}while((a|0)!=(o|0))}o=r[t+160>>2]|0;if(o|0){if(n[t+164>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+160>>2]=0}n[t+164>>0]=1;r[t+160>>2]=i;r[t+156>>2]=h;o=t+160|0}else o=t+160|0;i=l;do{d=(r[o>>2]|0)+(i<<5)|0;r[d>>2]=r[p>>2];r[d+4>>2]=r[p+4>>2];r[d+8>>2]=r[p+8>>2];r[d+12>>2]=r[p+12>>2];r[d+16>>2]=r[p+16>>2];r[d+20>>2]=r[p+20>>2];r[d+24>>2]=r[p+24>>2];r[d+28>>2]=r[p+28>>2];i=i+1|0}while((i|0)!=(h|0))}r[t+152>>2]=h;if((h|0)<=0){_=p;return}o=r[t+160>>2]|0;a=0;i=r[e+72>>2]|0;while(1){s[o+(a<<5)+6>>1]=s[i+14>>1]|0;s[o+(a<<5)+8>>1]=s[i+16>>1]|0;s[o+(a<<5)+10>>1]=s[i+18>>1]|0;s[o+(a<<5)>>1]=s[i+8>>1]|0;s[o+(a<<5)+2>>1]=s[i+10>>1]|0;s[o+(a<<5)+4>>1]=s[i+12>>1]|0;r[o+(a<<5)+12>>2]=r[i>>2];r[o+(a<<5)+16>>2]=r[i+4>>2];a=a+1|0;if((a|0)==(h|0))break;else i=i+20|0}_=p;return}function KL(t,e){t=t|0;e=e|0;var i=0,o=0,a=0,l=0,u=0,d=0,p=0,f=0,m=0;m=_;_=_+112|0;h[t+20>>2]=+c[e+32>>3];h[t+24>>2]=+c[e+40>>3];h[t+28>>2]=+c[e+48>>3];h[t+32>>2]=+c[e+56>>3];h[t+4>>2]=+c[e>>3];h[t+8>>2]=+c[e+8>>3];h[t+12>>2]=+c[e+16>>3];h[t+16>>2]=+c[e+24>>3];h[t+36>>2]=+c[e+64>>3];h[t+40>>2]=+c[e+72>>3];h[t+44>>2]=+c[e+80>>3];h[t+48>>2]=+c[e+88>>3];r[t+56>>2]=r[e+96>>2];n[t+60>>0]=(r[e+100>>2]|0)!=0&1;f=r[e+104>>2]|0;l=m+48|0;d=l+64|0;do{r[l>>2]=0;l=l+4|0}while((l|0)<(d|0));p=r[t+88>>2]|0;if((p|0)<(f|0)){if((r[t+92>>2]|0)<(f|0)){if(!f){i=0;o=p}else{r[5637]=(r[5637]|0)+1;i=Zl(f<<6|19)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=r[t+88>>2]|0}if((o|0)>0){a=0;do{l=i+(a<<6)|0;u=(r[t+96>>2]|0)+(a<<6)|0;d=l+64|0;do{r[l>>2]=r[u>>2];l=l+4|0;u=u+4|0}while((l|0)<(d|0));a=a+1|0}while((a|0)!=(o|0))}o=r[t+96>>2]|0;if(o|0){if(n[t+100>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+96>>2]=0}n[t+100>>0]=1;r[t+96>>2]=i;r[t+92>>2]=f;o=t+96|0}else o=t+96|0;i=p;do{l=(r[o>>2]|0)+(i<<6)|0;u=m+48|0;d=l+64|0;do{r[l>>2]=r[u>>2];l=l+4|0;u=u+4|0}while((l|0)<(d|0));i=i+1|0}while((i|0)!=(f|0))}r[t+88>>2]=f;if((f|0)>0){i=r[t+96>>2]|0;o=0;a=r[e+112>>2]|0;while(1){h[i+(o<<6)+16>>2]=+c[a+32>>3];h[i+(o<<6)+20>>2]=+c[a+40>>3];h[i+(o<<6)+24>>2]=+c[a+48>>3];h[i+(o<<6)+28>>2]=+c[a+56>>3];h[i+(o<<6)>>2]=+c[a>>3];h[i+(o<<6)+4>>2]=+c[a+8>>3];h[i+(o<<6)+8>>2]=+c[a+16>>3];h[i+(o<<6)+12>>2]=+c[a+24>>3];r[i+(o<<6)+32>>2]=r[a+64>>2];r[i+(o<<6)+36>>2]=r[a+68>>2];r[i+(o<<6)+40>>2]=r[a+72>>2];o=o+1|0;if((o|0)==(f|0))break;else a=a+80|0}}u=r[e+108>>2]|0;r[m+32>>2]=0;r[m+32+4>>2]=0;r[m+32+8>>2]=0;r[m+32+12>>2]=0;l=r[t+128>>2]|0;if((l|0)<(u|0)){if((r[t+132>>2]|0)<(u|0)){if(!u){i=0;o=l}else{r[5637]=(r[5637]|0)+1;i=Zl((u<<4|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=r[t+128>>2]|0}if((o|0)>0){a=0;do{f=i+(a<<4)|0;p=(r[t+136>>2]|0)+(a<<4)|0;r[f>>2]=r[p>>2];r[f+4>>2]=r[p+4>>2];r[f+8>>2]=r[p+8>>2];r[f+12>>2]=r[p+12>>2];a=a+1|0}while((a|0)!=(o|0))}o=r[t+136>>2]|0;if(o|0){if(n[t+140>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+136>>2]=0}n[t+140>>0]=1;r[t+136>>2]=i;r[t+132>>2]=u;o=t+136|0}else o=t+136|0;i=l;do{f=(r[o>>2]|0)+(i<<4)|0;r[f>>2]=r[m+32>>2];r[f+4>>2]=r[m+32+4>>2];r[f+8>>2]=r[m+32+8>>2];r[f+12>>2]=r[m+32+12>>2];i=i+1|0}while((i|0)!=(u|0))}r[t+128>>2]=u;if((u|0)>0){i=r[t+136>>2]|0;o=0;a=r[e+116>>2]|0;while(1){r[i+(o<<4)+12>>2]=r[a+12>>2];s[i+(o<<4)+6>>1]=s[a+6>>1]|0;s[i+(o<<4)+8>>1]=s[a+8>>1]|0;s[i+(o<<4)+10>>1]=s[a+10>>1]|0;s[i+(o<<4)>>1]=s[a>>1]|0;s[i+(o<<4)+2>>1]=s[a+2>>1]|0;s[i+(o<<4)+4>>1]=s[a+4>>1]|0;o=o+1|0;if((o|0)==(u|0))break;else a=a+16|0}}r[t+144>>2]=r[e+120>>2];u=r[e+124>>2]|0;l=r[t+152>>2]|0;if((l|0)<(u|0)){if((r[t+156>>2]|0)<(u|0)){if(!u){i=0;o=l}else{r[5637]=(r[5637]|0)+1;i=Zl(u<<5|19)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}o=r[t+152>>2]|0}if((o|0)>0){a=0;do{f=i+(a<<5)|0;p=(r[t+160>>2]|0)+(a<<5)|0;r[f>>2]=r[p>>2];r[f+4>>2]=r[p+4>>2];r[f+8>>2]=r[p+8>>2];r[f+12>>2]=r[p+12>>2];r[f+16>>2]=r[p+16>>2];r[f+20>>2]=r[p+20>>2];r[f+24>>2]=r[p+24>>2];r[f+28>>2]=r[p+28>>2];a=a+1|0}while((a|0)!=(o|0))}o=r[t+160>>2]|0;if(o|0){if(n[t+164>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0)}r[t+160>>2]=0}n[t+164>>0]=1;r[t+160>>2]=i;r[t+156>>2]=u;o=t+160|0}else o=t+160|0;i=l;do{f=(r[o>>2]|0)+(i<<5)|0;r[f>>2]=r[m>>2];r[f+4>>2]=r[m+4>>2];r[f+8>>2]=r[m+8>>2];r[f+12>>2]=r[m+12>>2];r[f+16>>2]=r[m+16>>2];r[f+20>>2]=r[m+20>>2];r[f+24>>2]=r[m+24>>2];r[f+28>>2]=r[m+28>>2];i=i+1|0}while((i|0)!=(u|0))}r[t+152>>2]=u;if((u|0)<=0){_=m;return}o=r[t+160>>2]|0;a=0;i=r[e+128>>2]|0;while(1){s[o+(a<<5)+6>>1]=s[i+14>>1]|0;s[o+(a<<5)+8>>1]=s[i+16>>1]|0;s[o+(a<<5)+10>>1]=s[i+18>>1]|0;s[o+(a<<5)>>1]=s[i+8>>1]|0;s[o+(a<<5)+2>>1]=s[i+10>>1]|0;s[o+(a<<5)+4>>1]=s[i+12>>1]|0;r[o+(a<<5)+12>>2]=r[i>>2];r[o+(a<<5)+16>>2]=r[i+4>>2];a=a+1|0;if((a|0)==(u|0))break;else i=i+20|0}_=m;return}function ZL(t,e,i){t=t|0;e=e|0;i=i|0;var o=0,l=0,c=0.0,u=0,d=0.0,p=0.0,f=0,m=0,g=0,b=0.0,y=0.0,v=0.0,S=0,x=0,w=0.0,C=0.0,T=0.0,A=0,E=0,M=0.0,R=0.0,I=0.0,P=0,L=0,D=0,k=0,O=0,F=0,B=0.0,N=0.0,U=0.0;F=_;_=_+112|0;D=r[t+56>>2]|0;if((i-e|0)==1){if(!(n[t+60>>0]|0)){f=(r[t+96>>2]|0)+(D<<6)|0;m=(r[t+76>>2]|0)+(e<<6)|0;g=f+64|0;do{r[f>>2]=r[m>>2];f=f+4|0;m=m+4|0}while((f|0)<(g|0))}else{O=(r[t+136>>2]|0)+(D<<4)|0;k=(r[t+116>>2]|0)+(e<<4)|0;r[O>>2]=r[k>>2];r[O+4>>2]=r[k+4>>2];r[O+8>>2]=r[k+8>>2];r[O+12>>2]=r[k+12>>2]}r[t+56>>2]=(r[t+56>>2]|0)+1;_=F;return}if((i|0)>(e|0)){u=(n[t+60>>0]|0)==0;if(u){o=r[t+76>>2]|0;l=e;d=0.0;p=0.0;c=0.0;do{d=d+(+h[o+(l<<6)+16>>2]+ +h[o+(l<<6)>>2])*.5;c=c+(+h[o+(l<<6)+20>>2]+ +h[o+(l<<6)+4>>2])*.5;p=p+(+h[o+(l<<6)+24>>2]+ +h[o+(l<<6)+8>>2])*.5;l=l+1|0}while((l|0)!=(i|0))}else{o=r[t+116>>2]|0;b=+h[t+36>>2];y=+h[t+40>>2];v=+h[t+44>>2];w=+h[t+4>>2];C=+h[t+8>>2];T=+h[t+12>>2];l=e;d=0.0;p=0.0;c=0.0;do{d=d+(+(a[o+(l<<4)+6>>1]|0)/b+w+(+(a[o+(l<<4)>>1]|0)/b+w))*.5;c=c+(+(a[o+(l<<4)+8>>1]|0)/y+C+(+(a[o+(l<<4)+2>>1]|0)/y+C))*.5;p=p+(+(a[o+(l<<4)+10>>1]|0)/v+T+(+(a[o+(l<<4)+4>>1]|0)/v+T))*.5;l=l+1|0}while((l|0)!=(i|0))}M=1.0/+(i-e|0);I=M*d;R=M*c;M=M*p;if(u){o=r[t+76>>2]|0;l=e;p=0.0;d=0.0;c=0.0;do{w=(+h[o+(l<<6)+16>>2]+ +h[o+(l<<6)>>2])*.5-I;C=(+h[o+(l<<6)+20>>2]+ +h[o+(l<<6)+4>>2])*.5-R;T=(+h[o+(l<<6)+24>>2]+ +h[o+(l<<6)+8>>2])*.5-M;p=p+w*w;c=c+C*C;d=d+T*T;l=l+1|0}while((l|0)!=(i|0));b=+(i-e|0)}else{o=r[t+116>>2]|0;b=+h[t+36>>2];y=+h[t+40>>2];v=+h[t+44>>2];w=+h[t+4>>2];C=+h[t+8>>2];T=+h[t+12>>2];l=e;p=0.0;d=0.0;c=0.0;do{U=(+(a[o+(l<<4)+6>>1]|0)/b+w+(+(a[o+(l<<4)>>1]|0)/b+w))*.5-I;N=(+(a[o+(l<<4)+8>>1]|0)/y+C+(+(a[o+(l<<4)+2>>1]|0)/y+C))*.5-R;B=(+(a[o+(l<<4)+10>>1]|0)/v+T+(+(a[o+(l<<4)+4>>1]|0)/v+T))*.5-M;p=p+U*U;c=c+N*N;d=d+B*B;l=l+1|0}while((l|0)!=(i|0));b=+(i-e|0)}}else{b=+(i-e|0);p=0.0;d=0.0;c=0.0}U=1.0/(b+-1.0);N=U*p;B=U*c;U=U*d;x=N<B?B<U?2:1:N<U?2:0;r[F+16>>2]=0;r[F+16+4>>2]=0;r[F+16+8>>2]=0;r[F+16+12>>2]=0;if((i|0)>(e|0)){if(!(n[t+60>>0]|0)){o=r[t+76>>2]|0;p=0.0;d=0.0;c=0.0;l=e;do{p=(+h[o+(l<<6)+16>>2]+ +h[o+(l<<6)>>2])*.5+p;d=(+h[o+(l<<6)+20>>2]+ +h[o+(l<<6)+4>>2])*.5+d;c=(+h[o+(l<<6)+24>>2]+ +h[o+(l<<6)+8>>2])*.5+c;l=l+1|0}while((l|0)!=(i|0))}else{o=r[t+116>>2]|0;b=+h[t+36>>2];y=+h[t+40>>2];v=+h[t+44>>2];w=+h[t+4>>2];C=+h[t+8>>2];T=+h[t+12>>2];p=0.0;d=0.0;c=0.0;l=e;do{p=(+(a[o+(l<<4)+6>>1]|0)/b+w+(+(a[o+(l<<4)>>1]|0)/b+w))*.5+p;d=(+(a[o+(l<<4)+8>>1]|0)/y+C+(+(a[o+(l<<4)+2>>1]|0)/y+C))*.5+d;c=(+(a[o+(l<<4)+10>>1]|0)/v+T+(+(a[o+(l<<4)+4>>1]|0)/v+T))*.5+c;l=l+1|0}while((l|0)!=(i|0))}h[F+16>>2]=p;h[F+16+4>>2]=d;h[F+16+8>>2]=c;o=F+16|0}else{o=F+16|0;p=0.0;d=0.0;c=0.0}h[o>>2]=1.0/+(i-e|0)*p;h[F+16+4>>2]=1.0/+(i-e|0)*d;h[F+16+8>>2]=1.0/+(i-e|0)*c;w=+h[F+16+(x<<2)>>2];if((i|0)>(e|0)){S=e;o=e;do{l=(n[t+60>>0]|0)==0;if(l){L=r[t+76>>2]|0;c=+h[L+(S<<6)>>2];d=+h[L+(S<<6)+16>>2];p=+h[L+(S<<6)+4>>2];b=+h[L+(S<<6)+20>>2];y=+h[L+(S<<6)+8>>2];v=+h[L+(S<<6)+24>>2]}else{L=r[t+116>>2]|0;p=+h[t+36>>2];y=+h[t+40>>2];U=+h[t+44>>2];d=+h[t+4>>2];b=+h[t+8>>2];v=+h[t+12>>2];c=+(a[L+(S<<4)>>1]|0)/p+d;d=+(a[L+(S<<4)+6>>1]|0)/p+d;p=+(a[L+(S<<4)+2>>1]|0)/y+b;b=+(a[L+(S<<4)+8>>1]|0)/y+b;y=+(a[L+(S<<4)+4>>1]|0)/U+v;v=+(a[L+(S<<4)+10>>1]|0)/U+v}h[F>>2]=(d+c)*.5;h[F+4>>2]=(b+p)*.5;h[F+8>>2]=(v+y)*.5;h[F+12>>2]=0.0;if(+h[F+(x<<2)>>2]>w){if(l){l=r[t+76>>2]|0;u=l+(S<<6)|0;f=F+48|0;m=u;g=f+64|0;do{r[f>>2]=r[m>>2];f=f+4|0;m=m+4|0}while((f|0)<(g|0));f=u;m=l+(o<<6)|0;g=f+64|0;do{r[f>>2]=r[m>>2];f=f+4|0;m=m+4|0}while((f|0)<(g|0));f=(r[t+76>>2]|0)+(o<<6)|0;m=F+48|0;g=f+64|0;do{r[f>>2]=r[m>>2];f=f+4|0;m=m+4|0}while((f|0)<(g|0))}else{P=r[t+116>>2]|0;L=P+(S<<4)|0;r[F+48>>2]=r[L>>2];r[F+48+4>>2]=r[L+4>>2];r[F+48+8>>2]=r[L+8>>2];r[F+48+12>>2]=r[L+12>>2];P=P+(o<<4)|0;r[L>>2]=r[P>>2];r[L+4>>2]=r[P+4>>2];r[L+8>>2]=r[P+8>>2];r[L+12>>2]=r[P+12>>2];L=(r[t+116>>2]|0)+(o<<4)|0;r[L>>2]=r[F+48>>2];r[L+4>>2]=r[F+48+4>>2];r[L+8>>2]=r[F+48+8>>2];r[L+12>>2]=r[F+48+12>>2]}o=o+1|0}S=S+1|0}while((S|0)!=(i|0))}else o=e;if(!((o|0)>(((i-e|0)/3|0)+e|0)?(o|0)<(i+-1-((i-e|0)/3|0)|0):0))o=(i-e>>1)+e|0;L=r[t+56>>2]|0;if(!(n[t+60>>0]|0)){P=(r[t+96>>2]|0)+(L<<6)|0;r[P>>2]=r[t+20>>2];r[P+4>>2]=r[t+20+4>>2];r[P+8>>2]=r[t+20+8>>2];r[P+12>>2]=r[t+20+12>>2]}else{P=r[t+136>>2]|0;N=(+h[t+24>>2]-+h[t+8>>2])*+h[t+40>>2];U=(+h[t+28>>2]-+h[t+12>>2])*+h[t+44>>2];s[P+(L<<4)>>1]=~~((+h[t+20>>2]-+h[t+4>>2])*+h[t+36>>2])&65534;s[P+(L<<4)+2>>1]=~~N&65534;s[P+(L<<4)+4>>1]=~~U&65534}l=r[t+56>>2]|0;if(!(n[t+60>>0]|0)){P=(r[t+96>>2]|0)+(l<<6)+16|0;r[P>>2]=r[t+4>>2];r[P+4>>2]=r[t+4+4>>2];r[P+8>>2]=r[t+4+8>>2];r[P+12>>2]=r[t+4+12>>2]}else{P=r[t+136>>2]|0;B=+h[t+4>>2];N=+h[t+8>>2];U=+h[t+12>>2];N=(N-N)*+h[t+40>>2];U=(U-U)*+h[t+44>>2];s[P+(l<<4)+6>>1]=~~((B-B)*+h[t+36>>2]+1.0)&65535|1;s[P+(l<<4)+8>>1]=~~(N+1.0)&65535|1;s[P+(l<<4)+10>>1]=~~(U+1.0)&65535|1}P=r[t+56>>2]|0;if((i|0)>(e|0)){A=n[t+60>>0]|0;E=e;do{if(!(A<<24>>24)){l=r[t+76>>2]|0;c=+h[l+(E<<6)>>2];d=+h[l+(E<<6)+4>>2];p=+h[l+(E<<6)+8>>2];b=+h[l+(E<<6)+12>>2];y=+h[l+(E<<6)+16>>2];v=+h[l+(E<<6)+20>>2];w=+h[l+(E<<6)+24>>2];C=+h[l+(E<<6)+28>>2];l=r[t+96>>2]|0;if(c<+h[l+(P<<6)>>2])h[l+(P<<6)>>2]=c;if(d<+h[l+(P<<6)+4>>2])h[l+(P<<6)+4>>2]=d;if(p<+h[l+(P<<6)+8>>2])h[l+(P<<6)+8>>2]=p;if(b<+h[l+(P<<6)+12>>2])h[l+(P<<6)+12>>2]=b;if(+h[l+(P<<6)+16>>2]<y)h[l+(P<<6)+16>>2]=y;if(+h[l+(P<<6)+20>>2]<v)h[l+(P<<6)+20>>2]=v;if(+h[l+(P<<6)+24>>2]<w)h[l+(P<<6)+24>>2]=w;if(+h[l+(P<<6)+28>>2]<C)h[l+(P<<6)+28>>2]=C}else{m=r[t+116>>2]|0;b=+h[t+36>>2];I=+h[t+40>>2];C=+h[t+44>>2];y=+h[t+4>>2];B=+h[t+8>>2];T=+h[t+12>>2];v=+h[t+4>>2];N=+h[t+8>>2];M=+h[t+12>>2];w=+h[t+36>>2];U=+h[t+40>>2];R=+h[t+44>>2];g=~~((+(a[m+(E<<4)>>1]|0)/b+y-v)*w)&65534;l=~~((+(a[m+(E<<4)+4>>1]|0)/C+T-M)*R)&65534;f=~~((+(a[m+(E<<4)+2>>1]|0)/I+B-N)*U)&65534;S=(~~((+(a[m+(E<<4)+6>>1]|0)/b+y-v)*w+1.0)&65535|1)&65535;u=(~~((+(a[m+(E<<4)+10>>1]|0)/C+T-M)*R+1.0)&65535|1)&65535;m=(~~((+(a[m+(E<<4)+8>>1]|0)/I+B-N)*U+1.0)&65535|1)&65535;x=r[t+136>>2]|0;if((a[x+(P<<4)>>1]|0)>(g&65535))s[x+(P<<4)>>1]=g;if((a[x+(P<<4)+6>>1]|0)<(S&65535))s[x+(P<<4)+6>>1]=S;if((a[x+(P<<4)+2>>1]|0)>(f&65535))s[x+(P<<4)+2>>1]=f;if((a[x+(P<<4)+8>>1]|0)<(m&65535))s[x+(P<<4)+8>>1]=m;if((a[x+(P<<4)+4>>1]|0)>(l&65535))s[x+(P<<4)+4>>1]=l;if((a[x+(P<<4)+10>>1]|0)<(u&65535))s[x+(P<<4)+10>>1]=u}E=E+1|0}while((E|0)!=(i|0))}r[t+56>>2]=P+1;ZL(t,e,o);A=r[t+56>>2]|0;ZL(t,o,i);x=(r[t+56>>2]|0)-D|0;o=n[t+60>>0]|0;if(o<<24>>24!=0&(x<<4|0)>2048){g=r[t+136>>2]|0;f=r[g+(P+1<<4)+12>>2]|0;f=(f|0)>-1?1:0-f|0;S=r[g+(A<<4)+12>>2]|0;S=(S|0)>-1?1:0-S|0;if((f<<4|0)<2049){m=r[t+152>>2]|0;if((m|0)==(r[t+156>>2]|0)?(k=m|0?m<<1:1,(m|0)<(k|0)):0){if(!k){o=0;l=m}else{r[5637]=(r[5637]|0)+1;o=Zl(k<<5|19)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}l=r[t+152>>2]|0}if((l|0)>0){u=0;do{i=o+(u<<5)|0;D=(r[t+160>>2]|0)+(u<<5)|0;r[i>>2]=r[D>>2];r[i+4>>2]=r[D+4>>2];r[i+8>>2]=r[D+8>>2];r[i+12>>2]=r[D+12>>2];r[i+16>>2]=r[D+16>>2];r[i+20>>2]=r[D+20>>2];r[i+24>>2]=r[D+24>>2];r[i+28>>2]=r[D+28>>2];u=u+1|0}while((u|0)!=(l|0))}l=r[t+160>>2]|0;if(l|0){if(n[t+164>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0)}r[t+160>>2]=0}n[t+164>>0]=1;r[t+160>>2]=o;r[t+156>>2]=k;o=r[t+152>>2]|0}else o=m;r[t+152>>2]=o+1;k=(r[t+160>>2]|0)+(m<<5)|0;r[k>>2]=r[F+48>>2];r[k+4>>2]=r[F+48+4>>2];r[k+8>>2]=r[F+48+8>>2];r[k+12>>2]=r[F+48+12>>2];r[k+16>>2]=r[F+48+16>>2];r[k+20>>2]=r[F+48+20>>2];r[k+24>>2]=r[F+48+24>>2];r[k+28>>2]=r[F+48+28>>2];k=r[t+160>>2]|0;s[k+(m<<5)>>1]=s[g+(P+1<<4)>>1]|0;s[k+(m<<5)+2>>1]=s[g+(P+1<<4)+2>>1]|0;s[k+(m<<5)+4>>1]=s[g+(P+1<<4)+4>>1]|0;s[k+(m<<5)+6>>1]=s[g+(P+1<<4)+6>>1]|0;s[k+(m<<5)+8>>1]=s[g+(P+1<<4)+8>>1]|0;s[k+(m<<5)+10>>1]=s[g+(P+1<<4)+10>>1]|0;r[k+(m<<5)+12>>2]=P+1;r[k+(m<<5)+16>>2]=f}if((S<<4|0)<2049){f=r[t+152>>2]|0;if((f|0)==(r[t+156>>2]|0)?(O=f|0?f<<1:1,(f|0)<(O|0)):0){if(!O){o=0;l=f}else{r[5637]=(r[5637]|0)+1;o=Zl(O<<5|19)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}l=r[t+152>>2]|0}if((l|0)>0){u=0;do{k=o+(u<<5)|0;i=(r[t+160>>2]|0)+(u<<5)|0;r[k>>2]=r[i>>2];r[k+4>>2]=r[i+4>>2];r[k+8>>2]=r[i+8>>2];r[k+12>>2]=r[i+12>>2];r[k+16>>2]=r[i+16>>2];r[k+20>>2]=r[i+20>>2];r[k+24>>2]=r[i+24>>2];r[k+28>>2]=r[i+28>>2];u=u+1|0}while((u|0)!=(l|0))}l=r[t+160>>2]|0;if(l|0){if(n[t+164>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[l+-4>>2]|0)}r[t+160>>2]=0}n[t+164>>0]=1;r[t+160>>2]=o;r[t+156>>2]=O;o=r[t+152>>2]|0}else o=f;r[t+152>>2]=o+1;O=(r[t+160>>2]|0)+(f<<5)|0;r[O>>2]=r[F+16>>2];r[O+4>>2]=r[F+16+4>>2];r[O+8>>2]=r[F+16+8>>2];r[O+12>>2]=r[F+16+12>>2];r[O+16>>2]=r[F+16+16>>2];r[O+20>>2]=r[F+16+20>>2];r[O+24>>2]=r[F+16+24>>2];r[O+28>>2]=r[F+16+28>>2];O=r[t+160>>2]|0;s[O+(f<<5)>>1]=s[g+(A<<4)>>1]|0;s[O+(f<<5)+2>>1]=s[g+(A<<4)+2>>1]|0;s[O+(f<<5)+4>>1]=s[g+(A<<4)+4>>1]|0;s[O+(f<<5)+6>>1]=s[g+(A<<4)+6>>1]|0;s[O+(f<<5)+8>>1]=s[g+(A<<4)+8>>1]|0;s[O+(f<<5)+10>>1]=s[g+(A<<4)+10>>1]|0;r[O+(f<<5)+12>>2]=A;r[O+(f<<5)+16>>2]=S}r[t+168>>2]=r[t+152>>2];o=n[t+60>>0]|0}if(!(o<<24>>24)){r[(r[t+96>>2]|0)+(L<<6)+32>>2]=x;_=F;return}else{r[(r[t+136>>2]|0)+(L<<4)+12>>2]=0-x;_=F;return}}function QL(t,e,i,o){t=t|0;e=e|0;i=i|0;o=o|0;var l=0,c=0,u=0,d=0,p=0,f=0,m=0,g=0,b=0,y=0,v=0,S=0,x=0,w=0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0;w=_;_=_+16|0;if(!(n[t+60>>0]|0)){l=r[t+56>>2]|0;if((l|0)>0){c=l;p=0;g=r[t+96>>2]|0;l=0;while(1){l=l+1|0;if(!(+h[i>>2]>+h[g+16>>2])?!(+h[o>>2]<+h[g>>2]):0)u=1;else u=0;if(!(!(+h[i+8>>2]>+h[g+24>>2])?!(+h[o+8>>2]<+h[g+8>>2]):0))u=0;if(!(+h[i+4>>2]>+h[g+20>>2])?!(+h[o+4>>2]<+h[g+4>>2]):0){d=r[g+32>>2]|0;if(u&(d|0)==-1){Vk[r[(r[e>>2]|0)+8>>2]&127](e,r[g+36>>2]|0,r[g+40>>2]|0);c=r[t+56>>2]|0;m=43}else{f=(d|0)==-1;m=42}}else{d=r[g+32>>2]|0;f=(d|0)==-1;u=0;m=42}if((m|0)==42){m=0;if(f|u)m=43;else{p=d+p|0;u=g+(d<<6)|0}}if((m|0)==43){p=p+1|0;u=g+64|0}if((p|0)<(c|0))g=u;else break}}else l=0;if((r[4988]|0)>=(l|0)){_=w;return}r[4988]=l;_=w;return}I=+h[i>>2];k=+h[i+4>>2];A=+h[i+8>>2];D=+h[t+4>>2];I=I<D?D:I;T=+h[t+8>>2];k=k<T?T:k;R=+h[t+12>>2];A=A<R?R:A;O=+h[t+20>>2];E=+h[t+24>>2];P=+h[t+28>>2];L=+h[t+36>>2];C=+h[t+40>>2];M=+h[t+44>>2];x=~~(((O<I?O:I)-D)*L)&65534;s[w+6>>1]=x;v=~~(((P<A?P:A)-R)*M)&65534;S=~~(((E<k?E:k)-T)*C)&65534;s[w+6+2>>1]=S;s[w+6+4>>1]=v;k=+h[o>>2];A=+h[o+4>>2];I=+h[o+8>>2];k=k<D?D:k;A=A<T?T:A;I=I<R?R:I;y=(~~(((O<k?O:k)-D)*L+1.0)&65535|1)&65535;s[w>>1]=y;o=(~~(((P<I?P:I)-R)*M+1.0)&65535|1)&65535;b=(~~(((E<A?E:A)-T)*C+1.0)&65535|1)&65535;s[w+2>>1]=b;s[w+4>>1]=o;switch(r[t+144>>2]|0){case 0:{m=r[t+56>>2]|0;if((m|0)>0){c=0;u=r[t+136>>2]|0;l=0;do{l=l+1|0;d=((y&65535)>=(a[u>>1]|0)?(x&65535)<=(a[u+6>>1]|0):0)&(v&65535)<=(a[u+10>>1]|0)&(o&65535)>=(a[u+4>>1]|0)&(S&65535)<=(a[u+8>>1]|0)&(b&65535)>=(a[u+2>>1]|0);p=u+12|0;f=r[p>>2]|0;if((f|0)>-1&d)Vk[r[(r[e>>2]|0)+8>>2]&127](e,f>>21,f&2097151);if(d|(f|0)>-1){c=c+1|0;u=u+16|0}else{t=r[p>>2]|0;c=c-t|0;u=u+(0-t<<4)|0}}while((c|0)<(m|0))}else l=0;if((r[4988]|0)<(l|0))r[4988]=l;break}case 1:{if((r[t+152>>2]|0)>0){i=0;do{l=r[t+160>>2]|0;if(((y&65535)>=(a[l+(i<<5)>>1]|0)?(x&65535)<=(a[l+(i<<5)+6>>1]|0):0)&(v&65535)<=(a[l+(i<<5)+10>>1]|0)&(o&65535)>=(a[l+(i<<5)+4>>1]|0)&(S&65535)<=(a[l+(i<<5)+8>>1]|0)&(b&65535)>=(a[l+(i<<5)+2>>1]|0)){g=r[l+(i<<5)+12>>2]|0;m=r[l+(i<<5)+16>>2]|0;if((m|0)>0){c=g;u=(r[t+136>>2]|0)+(g<<4)|0;l=0;do{l=l+1|0;d=((y&65535)>=(a[u>>1]|0)?(x&65535)<=(a[u+6>>1]|0):0)&(v&65535)<=(a[u+10>>1]|0)&(o&65535)>=(a[u+4>>1]|0)&(S&65535)<=(a[u+8>>1]|0)&(b&65535)>=(a[u+2>>1]|0);p=u+12|0;f=r[p>>2]|0;if((f|0)>-1&d)Vk[r[(r[e>>2]|0)+8>>2]&127](e,f>>21,f&2097151);if(d|(f|0)>-1){c=c+1|0;u=u+16|0}else{f=r[p>>2]|0;c=c-f|0;u=u+(0-f<<4)|0}}while((c|0)<(m+g|0))}else l=0;if((r[4988]|0)<(l|0))r[4988]=l}i=i+1|0}while((i|0)<(r[t+152>>2]|0))}break}case 2:{$L(r[t+136>>2]|0,e,w+6|0,w);break}default:{}}_=w;return}function $L(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,o=0,l=0;while(1){s=r[t+12>>2]|0;if(!(((a[n>>1]|0)>=(a[t>>1]|0)?(a[i>>1]|0)<=(a[t+6>>1]|0):0)&(a[i+4>>1]|0)<=(a[t+10>>1]|0)&(a[n+4>>1]|0)>=(a[t+4>>1]|0)&(a[i+2>>1]|0)<=(a[t+8>>1]|0)&(a[n+2>>1]|0)>=(a[t+2>>1]|0))){o=6;break}if((s|0)>-1)break;l=t+16|0;$L(l,e,i,n);s=r[t+28>>2]|0;t=(s|0)>-1?t+32|0:l+(0-s<<4)|0}if((o|0)==6)return;Vk[r[(r[e>>2]|0)+8>>2]&127](e,s>>21,s&2097151);return}function JL(t,e,i,n,s,o,a,l){t=t|0;e=e|0;i=i|0;n=+n;s=+s;o=+o;a=a|0;l=l|0;var c=0,u=0,d=0,p=0,f=0.0,m=0.0,g=0,b=0.0,y=0.0,v=0.0,S=0,x=0.0,w=0,C=0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,W=0.0,j=0.0,H=0.0,X=0.0,Y=0;Y=_;_=_+32|0;L=+h[i>>2];k=+h[i+4>>2];H=+h[i+8>>2];y=+h[a>>2];v=+h[a+4>>2];x=+h[a+8>>2];f=+h[l>>2];m=+h[l+4>>2];b=+h[l+8>>2];D=1.0/+G(+((n-L)*(n-L)+(s-k)*(s-k)+(o-H)*(o-H)));O=(n-L)*D==0.0?999999984306749440.0:1.0/((n-L)*D);F=(s-k)*D==0.0?999999984306749440.0:1.0/((s-k)*D);B=(o-H)*D==0.0?999999984306749440.0:1.0/((o-H)*D);N=(L>n?n:L)+y;U=(k>s?s:k)+v;V=(H>o?o:H)+x;z=(L<n?n:L)+f;W=(k<s?s:k)+m;j=(H<o?o:H)+b;u=r[t+56>>2]|0;t:do{if((u|0)>0){w=0;C=r[t+96>>2]|0;c=0;while(1){c=c+1|0;r[Y>>2]=r[C>>2];r[Y+4>>2]=r[C+4>>2];r[Y+8>>2]=r[C+8>>2];r[Y+12>>2]=r[C+12>>2];S=C+16|0;r[Y+16>>2]=r[S>>2];r[Y+16+4>>2]=r[S+4>>2];r[Y+16+8>>2]=r[S+8>>2];r[Y+16+12>>2]=r[S+12>>2];h[Y>>2]=+h[Y>>2]-f;h[Y+4>>2]=+h[Y+4>>2]-m;h[Y+8>>2]=+h[Y+8>>2]-b;h[Y+16>>2]=+h[Y+16>>2]-y;h[Y+20>>2]=+h[Y+20>>2]-v;h[Y+24>>2]=+h[Y+24>>2]-x;if(!(N>+h[S>>2])?!(z<+h[C>>2]):0)d=1;else d=0;if(!(!(V>+h[C+24>>2])?!(j<+h[C+8>>2]):0))d=0;if(((!(U>+h[C+20>>2])?!(W<+h[C+4>>2]|d^1):0)?(A=+h[i>>2],T=O*(+h[Y+((O<0.0&1)<<4)>>2]-A),A=O*(+h[Y+((O<0.0^1)<<4)>>2]-A),M=+h[i+4>>2],E=F*(+h[Y+((F<0.0&1)<<4)+4>>2]-M),M=F*(+h[Y+((F<0.0^1)<<4)+4>>2]-M),!(E>A|T>M)):0)?(R=E>T?E:T,X=M<A?M:A,P=+h[i+8>>2],I=B*(+h[Y+((B<0.0&1)<<4)+8>>2]-P),P=B*(+h[Y+((B<0.0^1)<<4)+8>>2]-P),!(I>X|R>P)):0){d=(P<X?P:X)>0.0?(I>R?I:R)<(o-H)*((o-H)*D)+((n-L)*((n-L)*D)+(s-k)*((s-k)*D)):0;p=r[C+32>>2]|0;if(d&(p|0)==-1){Vk[r[(r[e>>2]|0)+8>>2]&127](e,r[C+36>>2]|0,r[C+40>>2]|0);u=r[t+56>>2]|0;S=17}else{g=(p|0)==-1;S=16}}else{p=r[C+32>>2]|0;g=(p|0)==-1;d=0;S=16}if((S|0)==16){S=0;if(g|d)S=17;else{g=p+w|0;d=C+(p<<6)|0}}if((S|0)==17){g=w+1|0;d=C+64|0}if((g|0)>=(u|0))break t;f=+h[l>>2];m=+h[l+4>>2];b=+h[l+8>>2];y=+h[a>>2];v=+h[a+4>>2];x=+h[a+8>>2];w=g;C=d}}else c=0}while(0);if((r[4988]|0)>=(c|0)){_=Y;return}r[4988]=c;_=Y;return}function tD(t,e,i,n,o,l,c,u,d){t=t|0;e=e|0;i=i|0;n=+n;o=+o;l=+l;c=c|0;u=u|0;d=d|0;var p=0,f=0,m=0,g=0,b=0.0,y=0.0,v=0.0,S=0.0,x=0,w=0,C=0,T=0,A=0,E=0,M=0,R=0,I=0,P=0,L=0,D=0.0,k=0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,W=0.0,j=0.0,H=0,X=0.0,Y=0,q=0.0,K=0.0,Z=0.0,Q=0.0,$=0.0,J=0.0,tt=0.0,et=0.0,it=0.0,nt=0.0,st=0.0;Y=_;_=_+32|0;D=+h[i>>2];z=+h[i+4>>2];j=+h[i+8>>2];O=1.0/+G(+((n-D)*(n-D)+(o-z)*(o-z)+(l-j)*(l-j)));U=(n-D)*O==0.0?999999984306749440.0:1.0/((n-D)*O);V=(o-z)*O==0.0?999999984306749440.0:1.0/((o-z)*O);W=(l-j)*O==0.0?999999984306749440.0:1.0/((l-j)*O);st=(D>n?n:D)+ +h[c>>2];it=(z>o?o:z)+ +h[c+4>>2];nt=(j>l?l:j)+ +h[c+8>>2];tt=(D<n?n:D)+ +h[u>>2];y=(z<o?o:z)+ +h[u+4>>2];Z=(j<l?l:j)+ +h[u+8>>2];J=+h[t+4>>2];st=st<J?J:st;v=+h[t+8>>2];it=it<v?v:it;K=+h[t+12>>2];nt=nt<K?K:nt;et=+h[t+20>>2];b=+h[t+24>>2];Q=+h[t+28>>2];$=+h[t+36>>2];S=+h[t+40>>2];q=+h[t+44>>2];H=~~(((et<st?et:st)-J)*$)&65534;I=~~(((Q<nt?Q:nt)-K)*q)&65534;L=~~(((b<it?b:it)-v)*S)&65534;tt=tt<J?J:tt;y=y<v?v:y;Z=Z<K?K:Z;k=(~~(((et<tt?et:tt)-J)*$+1.0)&65535|1)&65535;R=(~~(((Q<Z?Q:Z)-K)*q+1.0)&65535|1)&65535;P=(~~(((b<y?b:y)-v)*S+1.0)&65535|1)&65535;if((d|0)>0){f=0;m=r[t+136>>2]|0;p=0;do{p=p+1|0;g=m+6|0;x=s[m>>1]|0;w=m+10|0;C=s[m+4>>1]|0;T=m+8|0;A=s[m+2>>1]|0;E=m+12|0;M=(r[E>>2]|0)>-1;do{if(((k&65535)>=(x&65535)?(H&65535)<=(a[g>>1]|0):0)&(I&65535)<=(a[w>>1]|0)&(R&65535)>=(C&65535)&(L&65535)<=(a[T>>1]|0)&(P&65535)>=(A&65535)){tt=+h[t+36>>2];it=+h[t+40>>2];st=+h[t+44>>2];et=+h[t+4>>2];nt=+h[t+8>>2];v=+h[t+12>>2];h[Y+12>>2]=0.0;S=+(a[g>>1]|0)/tt+et;b=+(a[T>>1]|0)/it+nt;y=+(a[w>>1]|0)/st+v;h[Y+28>>2]=0.0;h[Y>>2]=+(x&65535)/tt+et-+h[u>>2];h[Y+4>>2]=+(A&65535)/it+nt-+h[u+4>>2];h[Y+8>>2]=+(C&65535)/st+v-+h[u+8>>2];h[Y+16>>2]=S-+h[c>>2];h[Y+20>>2]=b-+h[c+4>>2];h[Y+24>>2]=y-+h[c+8>>2];y=+h[i>>2];b=U*(+h[Y+((U<0.0&1)<<4)>>2]-y);y=U*(+h[Y+((U<0.0^1)<<4)>>2]-y);S=+h[i+4>>2];v=V*(+h[Y+((V<0.0&1)<<4)+4>>2]-S);S=V*(+h[Y+((V<0.0^1)<<4)+4>>2]-S);if(!(v>y|b>S)?(F=v>b?v:b,X=S<y?S:y,N=+h[i+8>>2],B=W*(+h[Y+((W<0.0&1)<<4)+8>>2]-N),N=W*(+h[Y+((W<0.0^1)<<4)+8>>2]-N),!(B>X|F>N)):0){g=(N<X?N:X)>0.0?(B>F?B:F)<(l-j)*((l-j)*O)+((n-D)*((n-D)*O)+(o-z)*((o-z)*O)):0;if(!(M&g)){x=9;break}x=r[E>>2]|0;Vk[r[(r[e>>2]|0)+8>>2]&127](e,x>>21,x&2097151);x=10;break}g=0;x=9}else{g=0;x=9}}while(0);if((x|0)==9){x=0;if(M|g)x=10;else{M=r[E>>2]|0;f=f-M|0;m=m+(0-M<<4)|0}}if((x|0)==10){f=f+1|0;m=m+16|0}}while((f|0)<(d|0))}else p=0;if((r[4988]|0)>=(p|0)){_=Y;return}r[4988]=p;_=Y;return}function eD(t){t=t|0;var e=0;r[t>>2]=3016;if(!(n[t+8>>0]|0))return;e=r[t+12>>2]|0;if(!e)return;t=r[t+4>>2]|0;lk[r[(r[t>>2]|0)+16>>2]&127](t,e);return}function iD(t){t=t|0;var e=0,i=0;r[t>>2]=3016;if(!(n[t+8>>0]|0)){Ql(t);return}e=r[t+12>>2]|0;if(!e){Ql(t);return}i=r[t+4>>2]|0;lk[r[(r[i>>2]|0)+16>>2]&127](i,e);Ql(t);return}function nD(t,e,i,s,o){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;var a=0,l=0,c=0,u=0,d=0;c=_;_=_+144|0;a=r[t+12>>2]|0;if(!a){_=c;return}d=r[e+4>>2]|0;u=r[i+4>>2]|0;r[o+4>>2]=a;h[c+12+128>>2]=999999984306749440.0;e=r[e+12>>2]|0;r[c+12>>2]=r[e>>2];r[c+12+4>>2]=r[e+4>>2];r[c+12+8>>2]=r[e+8>>2];r[c+12+12>>2]=r[e+12>>2];r[c+12+16>>2]=r[e+16>>2];r[c+12+16+4>>2]=r[e+16+4>>2];r[c+12+16+8>>2]=r[e+16+8>>2];r[c+12+16+12>>2]=r[e+16+12>>2];r[c+12+32>>2]=r[e+32>>2];r[c+12+32+4>>2]=r[e+32+4>>2];r[c+12+32+8>>2]=r[e+32+8>>2];r[c+12+32+12>>2]=r[e+32+12>>2];r[c+12+48>>2]=r[e+48>>2];r[c+12+48+4>>2]=r[e+48+4>>2];r[c+12+48+8>>2]=r[e+48+8>>2];r[c+12+48+12>>2]=r[e+48+12>>2];i=r[i+12>>2]|0;r[c+12+64>>2]=r[i>>2];r[c+12+64+4>>2]=r[i+4>>2];r[c+12+64+8>>2]=r[i+8>>2];r[c+12+64+12>>2]=r[i+12>>2];r[c+12+80>>2]=r[i+16>>2];r[c+12+80+4>>2]=r[i+16+4>>2];r[c+12+80+8>>2]=r[i+16+8>>2];r[c+12+80+12>>2]=r[i+16+12>>2];r[c+12+96>>2]=r[i+32>>2];r[c+12+96+4>>2]=r[i+32+4>>2];r[c+12+96+8>>2]=r[i+32+8>>2];r[c+12+96+12>>2]=r[i+32+12>>2];r[c+12+112>>2]=r[i+48>>2];r[c+12+112+4>>2]=r[i+48+4>>2];r[c+12+112+8>>2]=r[i+48+8>>2];r[c+12+112+12>>2]=r[i+48+12>>2];r[c>>2]=3044;r[c+4>>2]=d;r[c+8>>2]=u;SS(c,c+12|0,o,r[s+20>>2]|0,0);do{if(n[t+8>>0]|0?(l=r[o+4>>2]|0,r[l+748>>2]|0):0){e=r[l+740>>2]|0;i=r[(r[o+8>>2]|0)+8>>2]|0;a=r[(r[o+12>>2]|0)+8>>2]|0;if((e|0)==(i|0)){uS(l,e+4|0,a+4|0);break}else{uS(l,a+4|0,i+4|0);break}}}while(0);_=c;return}function sD(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;return 1.0}function rD(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0;i=r[t+12>>2]|0;if(!i)return;if(!(n[t+8>>0]|0))return;s=r[e+4>>2]|0;if((s|0)==(r[e+8>>2]|0)?(a=s|0?s<<1:1,(s|0)<(a|0)):0){if(!a)i=0;else{r[5637]=(r[5637]|0)+1;i=Zl((a<<2|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}s=r[e+4>>2]|0}if((s|0)>0){o=0;do{r[i+(o<<2)>>2]=r[(r[e+12>>2]|0)+(o<<2)>>2];o=o+1|0}while((o|0)!=(s|0))}o=r[e+12>>2]|0;if(o){if(n[e+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[o+-4>>2]|0);s=r[e+4>>2]|0}r[e+12>>2]=0}n[e+16>>0]=1;r[e+12>>2]=i;r[e+8>>2]=a;i=r[t+12>>2]|0}r[(r[e+12>>2]|0)+(s<<2)>>2]=i;r[e+4>>2]=s+1;return}function oD(t){t=t|0;return}function aD(t){t=t|0;Ql(t);return}function lD(t,e,i,s,o,a,l,c,_,u,d,p,f){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;l=l|0;c=c|0;_=_|0;u=u|0;d=d|0;p=p|0;f=f|0;var m=0.0,g=0.0,b=0.0,y=0.0,v=0,S=0.0,x=0.0,w=0,C=0.0,T=0,A=0.0,E=0.0,M=0.0;v=et(r[_+24>>2]|0,u)|0;switch(r[e+84>>2]|0){case 4:{g=+h[d>>2];b=+h[d+4>>2];m=+h[d+8>>2];if(p|0)y=+h[l>>2]*g+ +h[l+4>>2]*b+ +h[l+8>>2]*m-(g*+h[c>>2]+b*+h[c+4>>2]+m*+h[c+8>>2]);else y=+h[o>>2]*g+ +h[o+4>>2]*b+ +h[o+8>>2]*m-(g*+h[a>>2]+b*+h[a+4>>2]+m*+h[a+8>>2]);hD(t,i,s,_,v,d,p,f);b=p|0?-1.0:1.0;m=b*(+h[_>>2]*+h[e+12>>2]*+h[e+72>>2]);u=(r[_+28>>2]|0)+(v<<2)|0;h[u>>2]=m;g=m-y*+h[e+12>>2];if(p|0){if(g>0.0?(S=-(y*+h[e+8>>2]),m<S):0)h[u>>2]=S}else if(g<0.0?(x=-(y*+h[e+8>>2]),m>x):0)h[u>>2]=x;h[(r[_+36>>2]|0)+(v<<2)>>2]=p|0?0.0:-3402823466385288598117041.0e14;h[(r[_+40>>2]|0)+(v<<2)>>2]=p|0?3402823466385288598117041.0e14:0.0;r[(r[_+32>>2]|0)+(v<<2)>>2]=r[e+16>>2];v=(r[_+24>>2]|0)+v|0;hD(t,i,s,_,v,d,p,f);m=b*(+h[_>>2]*+h[e+12>>2]*+h[e+76>>2]);u=(r[_+28>>2]|0)+(v<<2)|0;h[u>>2]=m;g=m-y*+h[e+12>>2];if(p|0){if(g<0.0?(C=-(y*+h[e+8>>2]),m>C):0)h[u>>2]=C}else if(g>0.0?(A=-(y*+h[e+8>>2]),m<A):0)h[u>>2]=A;h[(r[_+36>>2]|0)+(v<<2)>>2]=p|0?-3402823466385288598117041.0e14:0.0;h[(r[_+40>>2]|0)+(v<<2)>>2]=p|0?0.0:3402823466385288598117041.0e14;r[(r[_+32>>2]|0)+(v<<2)>>2]=r[e+16>>2];u=2;v=(r[_+24>>2]|0)+v|0;break}case 3:{hD(t,i,s,_,v,d,p,f);h[(r[_+28>>2]|0)+(v<<2)>>2]=(p|0?-1.0:1.0)*(+h[_>>2]*+h[e+12>>2]*+h[e+72>>2]);h[(r[_+36>>2]|0)+(v<<2)>>2]=-3402823466385288598117041.0e14;h[(r[_+40>>2]|0)+(v<<2)>>2]=3402823466385288598117041.0e14;r[(r[_+32>>2]|0)+(v<<2)>>2]=r[e+16>>2];u=1;v=(r[_+24>>2]|0)+v|0;break}default:u=0}do{if(!(n[e+28>>0]|0))w=u;else{if(!(n[e+40>>0]|0)){hD(t,i,s,_,v,d,p,f);x=+h[e+32>>2];m=p|0?x:-x;g=+h[e+80>>2];b=+h[e>>2];y=+h[e+4>>2];S=+h[_>>2]*+h[e+20>>2];do{if(!(b>y))if(!(b==y)){if(m/S<0.0)if(g>=b?b-m/S>g:0){m=(b-g)/(m/S);break}else{m=g<b?0.0:1.0;break}if(m/S>0.0)if(g<=y?y-m/S<g:0){m=(y-g)/(m/S);break}else{m=g>y?0.0:1.0;break}else m=0.0}else m=0.0;else m=1.0}while(0);h[(r[_+28>>2]|0)+(v<<2)>>2]=m*x;h[(r[_+36>>2]|0)+(v<<2)>>2]=-+h[e+36>>2];r[(r[_+40>>2]|0)+(v<<2)>>2]=r[e+36>>2];r[(r[_+32>>2]|0)+(v<<2)>>2]=r[e+24>>2];v=(r[_+24>>2]|0)+v|0;u=u+1|0;if(!(n[e+28>>0]|0)){w=u;break}if(!(n[e+40>>0]|0)){w=u;break}else{w=e+32|0;T=e+80|0}}else{w=e+32|0;T=e+80|0}g=+h[T>>2]-+h[e+44>>2];hD(t,i,s,_,v,d,p,f);S=+h[w>>2];S=g<0.0?-S:S;do{if(g!=0.0){b=+h[e>>2];m=+h[e+4>>2];do{if(b>m){if(g>0.0)m=+h[e+44>>2];else m=-3402823466385288598117041.0e14;if(g<0.0){y=+h[e+44>>2];b=m}else{y=3402823466385288598117041.0e14;b=m}}else{if(g>0.0?(E=+h[e+44>>2],E>b):0)b=E;if(g<0.0?(M=+h[e+44>>2],M<m):0){y=M;break}y=m}}while(0);m=+h[T>>2];g=+h[_>>2]*+h[e+20>>2];if(!(b>y))if(!(b==y)){if(-S/g<0.0)if(m>=b?b- -S/g>m:0){m=(b-m)/(-S/g);break}else{m=m<b?0.0:1.0;break}if(-S/g>0.0)if(m<=y?y- -S/g<m:0){m=(y-m)/(-S/g);break}else{m=m>y?0.0:1.0;break}else m=0.0}else m=0.0;else m=1.0}else m=0.0}while(0);h[(r[_+28>>2]|0)+(v<<2)>>2]=(p|0?-1.0:1.0)*(S*m);h[(r[_+36>>2]|0)+(v<<2)>>2]=-+h[e+36>>2];r[(r[_+40>>2]|0)+(v<<2)>>2]=r[e+36>>2];r[(r[_+32>>2]|0)+(v<<2)>>2]=r[e+24>>2];w=u+1|0;v=(r[_+24>>2]|0)+v|0}}while(0);if(!(n[e+48>>0]|0)){_=w;return _|0}C=+h[e+80>>2]-+h[e+68>>2];hD(t,i,s,_,v,d,p,f);S=1.0/+h[_>>2];x=+h[e+60>>2];m=+h[e+52>>2];b=+h[d>>2];y=+h[d+4>>2];g=+h[d+8>>2];if(p|0)b=+h[l>>2]*b+ +h[l+4>>2]*y+ +h[l+8>>2]*g-(b*+h[c>>2]+y*+h[c+4>>2]+g*+h[c+8>>2]);else b=+h[o>>2]*b+ +h[o+4>>2]*y+ +h[o+8>>2]*g-(b*+h[a>>2]+y*+h[a+4>>2]+g*+h[a+8>>2]);g=1.0/+h[(r[t+28>>2]|0)+368>>2];M=1.0/+h[(r[t+32>>2]|0)+368>>2];g=g>M?M:g;if((n[e+56>>0]|0)!=0?S*+G(+(m/g))>.25:0)m=1.0/S/S*.0625*g;A=p|0?-1.0:1.0;E=S*(A*(b*(x*S>g&(n[e+64>>0]|0)!=0?g/S:x)));M=S*(C*m)-E;h[(r[_+28>>2]|0)+(v<<2)>>2]=b+A*M;m=M<-E?M:-E;b=M<-E?-E:M;u=r[_+40>>2]|0;if(p|0){g=-m<0.0?0.0:-m;m=-b>0.0?0.0:-b}else{g=b<0.0?0.0:b;m=m>0.0?0.0:m}h[(r[_+36>>2]|0)+(v<<2)>>2]=m;h[u+(v<<2)>>2]=g;h[(r[_+32>>2]|0)+(v<<2)>>2]=0.0;_=w+1|0;return _|0}function hD(t,e,i,s,o,a,l,c){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;l=l|0;c=c|0;var _=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0,C=0,T=0.0;C=r[(l|0?s+12|0:s+8|0)>>2]|0;w=r[(l|0?s+20|0:s+16|0)>>2]|0;r[C+(o<<2)>>2]=r[a>>2];r[C+(o+1<<2)>>2]=r[a+4>>2];r[C+(o+2<<2)>>2]=r[a+8>>2];h[w+(o<<2)>>2]=-+h[a>>2];h[w+(o+1<<2)>>2]=-+h[a+4>>2];h[w+(o+2<<2)>>2]=-+h[a+8>>2];if(l|0)return;d=+h[t+1348>>2]-+h[i+48>>2];_=+h[t+1352>>2]-+h[i+52>>2];u=+h[t+1356>>2]-+h[i+56>>2];S=+h[t+1284>>2]-+h[e+48>>2];x=+h[t+1288>>2]-+h[e+52>>2];g=+h[t+1292>>2]-+h[e+56>>2];b=+h[a+8>>2];v=+h[a+4>>2];y=+h[a>>2];if((c|0)!=0|(n[t+1452>>0]|0)==0){m=d*v-_*y;f=_*b-u*v;d=u*y-d*b;p=x*b-g*v;u=g*y-S*b;_=S*v-x*y}else{T=+h[t+1444>>2];p=+h[t+1448>>2];m=p*(d*v-_*y);f=p*(_*b-u*v);d=p*(u*y-d*b);p=T*(x*b-g*v);u=T*(g*y-S*b);_=T*(S*v-x*y)}C=(r[s+12>>2]|0)+(o<<2)|0;h[C>>2]=p;h[C+4>>2]=u;h[C+8>>2]=_;C=r[s+20>>2]|0;h[C+(o<<2)>>2]=-f;h[C+(o+1<<2)>>2]=-d;h[C+(o+2<<2)>>2]=-m;return}function cD(t,e,i,n){t=t|0;e=e|0;i=+i;n=n|0;if(n>>>0<3)switch(e|0){case 2:{h[t+728+(n<<2)>>2]=i;r[t+1456>>2]=r[t+1456>>2]|2<<(n<<2);return}case 4:{h[t+744+(n<<2)>>2]=i;r[t+1456>>2]=r[t+1456>>2]|1<<(n<<2);return}case 1:{h[t+760+(n<<2)>>2]=i;r[t+1456>>2]=r[t+1456>>2]|8<<(n<<2);return}case 3:{h[t+776+(n<<2)>>2]=i;r[t+1456>>2]=r[t+1456>>2]|4<<(n<<2);return}default:return}if((n+-3|0)>>>0>=3)return;switch(e|0){case 2:{h[t+968+((n+-3|0)*88|0)+12>>2]=i;r[t+1456>>2]=r[t+1456>>2]|2<<(n<<2);return}case 4:{h[t+968+((n+-3|0)*88|0)+16>>2]=i;r[t+1456>>2]=r[t+1456>>2]|1<<(n<<2);return}case 1:{h[t+968+((n+-3|0)*88|0)+20>>2]=i;r[t+1456>>2]=r[t+1456>>2]|8<<(n<<2);return}case 3:{h[t+968+((n+-3|0)*88|0)+24>>2]=i;r[t+1456>>2]=r[t+1456>>2]|4<<(n<<2);return}default:return}}function _D(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0;t:do{if(i>>>0>=3)if((i+-3|0)>>>0<3)switch(e|0){case 2:{n=+h[t+968+((i+-3|0)*88|0)+12>>2];break t}case 4:{n=+h[t+968+((i+-3|0)*88|0)+16>>2];break t}case 1:{n=+h[t+968+((i+-3|0)*88|0)+20>>2];break t}case 3:{n=+h[t+968+((i+-3|0)*88|0)+24>>2];break t}default:{n=0.0;break t}}else n=0.0;else switch(e|0){case 2:{n=+h[t+728+(i<<2)>>2];break t}case 4:{n=+h[t+744+(i<<2)>>2];break t}case 1:{n=+h[t+760+(i<<2)>>2];break t}case 3:{n=+h[t+776+(i<<2)>>2];break t}default:{n=0.0;break t}}}while(0);return+n}function uD(t){t=t|0;r[t>>2]=7188;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function dD(t,e){t=t|0;e=e|0;var i=0.0,s=0.0;if(n[t+1309>>0]|0){i=(+h[t+1256>>2]-+h[t+1316>>2])*+h[t+1340>>2];h[t+792>>2]=i*(+h[e>>2]*+h[t+1364>>2]/+(r[e+48>>2]|0));i=+W(+i);h[t+808>>2]=i/+h[e>>2]}if(n[t+1310>>0]|0){i=(+h[t+1260>>2]-+h[t+1320>>2])*+h[t+1344>>2];h[t+796>>2]=i*(+h[e>>2]*+h[t+1368>>2]/+(r[e+48>>2]|0));i=+W(+i);h[t+812>>2]=i/+h[e>>2]}if(n[t+1311>>0]|0){i=(+h[t+1264>>2]-+h[t+1324>>2])*+h[t+1348>>2];h[t+800>>2]=i*(+h[e>>2]*+h[t+1372>>2]/+(r[e+48>>2]|0));i=+W(+i);h[t+816>>2]=i/+h[e>>2]}if(n[t+1312>>0]|0){s=-((+h[t+1192>>2]-+h[t+1328>>2])*+h[t+1352>>2]);i=+h[e>>2];h[t+876>>2]=i*+h[t+1376>>2]/+(r[e+48>>2]|0)*s;h[t+880>>2]=+W(+s)/i}if(n[t+1313>>0]|0){i=-((+h[t+1196>>2]-+h[t+1332>>2])*+h[t+1356>>2]);s=+h[e>>2];h[t+940>>2]=s*+h[t+1380>>2]/+(r[e+48>>2]|0)*i;h[t+944>>2]=+W(+i)/s}if(!(n[t+1314>>0]|0)){QE(t,e);return}i=-((+h[t+1200>>2]-+h[t+1336>>2])*+h[t+1360>>2]);s=+h[e>>2];h[t+1004>>2]=s*+h[t+1384>>2]/+(r[e+48>>2]|0)*i;h[t+1008>>2]=+W(+i)/s;QE(t,e);return}function pD(t){t=t|0;return 348}function fD(t,e,i){t=t|0;e=e|0;i=i|0;nM(t,e,i)|0;r[e+276>>2]=r[t+1316>>2];r[e+324>>2]=r[t+1364>>2];r[e+252>>2]=o[t+1309>>0];r[e+300>>2]=r[t+1340>>2];r[e+280>>2]=r[t+1320>>2];r[e+328>>2]=r[t+1368>>2];r[e+256>>2]=o[t+1310>>0];r[e+304>>2]=r[t+1344>>2];r[e+284>>2]=r[t+1324>>2];r[e+332>>2]=r[t+1372>>2];r[e+260>>2]=o[t+1311>>0];r[e+308>>2]=r[t+1348>>2];r[e+288>>2]=r[t+1328>>2];r[e+336>>2]=r[t+1376>>2];r[e+264>>2]=o[t+1312>>0];r[e+312>>2]=r[t+1352>>2];r[e+292>>2]=r[t+1332>>2];r[e+340>>2]=r[t+1380>>2];r[e+268>>2]=o[t+1313>>0];r[e+316>>2]=r[t+1356>>2];r[e+296>>2]=r[t+1336>>2];r[e+344>>2]=r[t+1384>>2];r[e+272>>2]=o[t+1314>>0];r[e+320>>2]=r[t+1360>>2];return 15322}function mD(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0;v=+h[e>>2];y=+h[e+4>>2];b=+h[e+8>>2];g=1.0/+G(+(v*v+y*y+b*b));C=+h[i>>2];w=+h[i+4>>2];x=+h[i+8>>2];S=1.0/+G(+(C*C+w*w+x*x));E=b*g*(w*S)-y*g*(x*S);A=v*g*(x*S)-b*g*(C*S);T=y*g*(C*S)-v*g*(w*S);i=r[t+28>>2]|0;n=+h[i+4>>2];o=+h[i+20>>2];l=+h[i+36>>2];s=+h[i+8>>2];a=+h[i+24>>2];c=+h[i+40>>2];_=+h[i+12>>2];d=+h[i+28>>2];f=+h[i+44>>2];u=-+h[i+52>>2];p=-+h[i+56>>2];m=-+h[i+60>>2];h[t+48>>2]=T*l+(n*E+o*A);h[t+52>>2]=n*(C*S)+w*S*o+x*S*l;h[t+56>>2]=v*g*n+y*g*o+b*g*l;h[t+60>>2]=0.0;h[t+64>>2]=E*s+A*a+T*c;h[t+68>>2]=C*S*s+w*S*a+x*S*c;h[t+72>>2]=v*g*s+y*g*a+b*g*c;h[t+76>>2]=0.0;h[t+80>>2]=E*_+A*d+T*f;h[t+84>>2]=C*S*_+w*S*d+x*S*f;h[t+88>>2]=v*g*_+y*g*d+b*g*f;h[t+92>>2]=0.0;h[t+96>>2]=n*0.0+o*0.0+l*0.0+(n*u+o*p+l*m);h[t+100>>2]=s*0.0+a*0.0+c*0.0+(s*u+a*p+c*m);h[t+104>>2]=_*0.0+d*0.0+f*0.0+(_*u+d*p+f*m);h[t+108>>2]=0.0;i=r[t+32>>2]|0;m=+h[i+4>>2];f=+h[i+20>>2];p=+h[i+36>>2];d=+h[i+8>>2];u=+h[i+24>>2];_=+h[i+40>>2];c=+h[i+12>>2];a=+h[i+28>>2];s=+h[i+44>>2];l=-+h[i+52>>2];o=-+h[i+56>>2];n=-+h[i+60>>2];h[t+112>>2]=E*m+A*f+T*p;h[t+116>>2]=C*S*m+w*S*f+x*S*p;h[t+120>>2]=v*g*m+y*g*f+b*g*p;h[t+124>>2]=0.0;h[t+128>>2]=E*d+A*u+T*_;h[t+132>>2]=C*S*d+w*S*u+x*S*_;h[t+136>>2]=v*g*d+y*g*u+b*g*_;h[t+140>>2]=0.0;h[t+144>>2]=E*c+A*a+T*s;h[t+148>>2]=C*S*c+w*S*a+x*S*s;h[t+152>>2]=v*g*c+y*g*a+b*g*s;h[t+156>>2]=0.0;h[t+160>>2]=m*0.0+f*0.0+p*0.0+(m*l+f*o+p*n);h[t+164>>2]=d*0.0+u*0.0+_*0.0+(d*l+u*o+_*n);h[t+168>>2]=c*0.0+a*0.0+s*0.0+(c*l+a*o+s*n);h[t+172>>2]=0.0;YE(t,(r[t+28>>2]|0)+4|0,(r[t+32>>2]|0)+4|0);return}function gD(t){t=t|0;r[t>>2]=7188;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function bD(t){t=t|0;var e=0.0,i=0,s=0,o=0.0,a=0.0,l=0.0,c=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0,w=0.0,C=0.0,T=0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,j=0.0,H=0.0,X=0.0,Y=0.0,q=0.0,K=0.0;x=_;_=_+176|0;if(!(n[t+738>>0]|0)){_=x;return}h[t+36>>2]=0.0;h[t+744>>2]=0.0;if(!(n[t+736>>0]|0)){i=r[t+28>>2]|0;c=+h[t+600>>2];u=+h[t+604>>2];g=+h[t+608>>2];y=c*+h[i+20>>2]+u*+h[i+24>>2]+g*+h[i+28>>2]+ +h[i+56>>2];s=r[t+32>>2]|0;d=+h[t+664>>2];p=+h[t+668>>2];b=+h[t+672>>2];f=+h[s+52>>2];e=+h[s+56>>2];v=d*+h[s+20>>2]+p*+h[s+24>>2]+b*+h[s+28>>2]+e;S=d*+h[s+36>>2]+p*+h[s+40>>2]+b*+h[s+44>>2]+ +h[s+60>>2];m=c*+h[i+4>>2]+u*+h[i+8>>2]+g*+h[i+12>>2]+ +h[i+52>>2];g=c*+h[i+36>>2]+u*+h[i+40>>2]+g*+h[i+44>>2]+ +h[i+60>>2];b=d*+h[s+4>>2]+p*+h[s+8>>2]+b*+h[s+12>>2]+f;if((b-m)*(b-m)+(v-y)*(v-y)+(S-g)*(S-g)>1.1920928955078125e-07){a=1.0/+G(+((b-m)*(b-m)+(v-y)*(v-y)+(S-g)*(S-g)));h[x+128>>2]=(b-m)*a;h[x+128+4>>2]=(v-y)*a;h[x+128+8>>2]=(S-g)*a;r[x+128+12>>2]=0;d=(S-g)*a;o=(v-y)*a;a=(b-m)*a}else{r[x+128>>2]=1065353216;r[x+128+4>>2]=0;r[x+128+8>>2]=0;h[x+128+12>>2]=0.0;d=0.0;o=0.0;a=1.0}if(+W(+d)>.7071067690849304){C=d*d+o*o;w=1.0/+G(+C);c=-(w*d);d=w*o;p=-(d*a);l=a*c;u=0.0;o=C*w;a=d}else{c=a*a+o*o;l=1.0/+G(+c);u=-(o*l);o=l*a;p=d*u;l=c*l;c=o;o=-(o*d);a=0.0}h[x+128+16>>2]=u;h[x+128+20>>2]=c;h[x+128+24>>2]=a;h[x+128+32>>2]=o;h[x+128+36>>2]=p;h[x+128+40>>2]=l;o=f;i=0;while(1){T=r[t+28>>2]|0;r[x+80>>2]=r[T+4>>2];r[x+80+4>>2]=r[T+20>>2];r[x+80+8>>2]=r[T+36>>2];h[x+80+12>>2]=0.0;r[x+80+16>>2]=r[T+8>>2];r[x+80+20>>2]=r[T+24>>2];r[x+80+24>>2]=r[T+40>>2];h[x+80+28>>2]=0.0;r[x+80+32>>2]=r[T+12>>2];r[x+80+36>>2]=r[T+28>>2];r[x+80+40>>2]=r[T+44>>2];h[x+80+44>>2]=0.0;r[x+32>>2]=r[s+4>>2];r[x+32+4>>2]=r[s+20>>2];r[x+32+8>>2]=r[s+36>>2];h[x+32+12>>2]=0.0;r[x+32+16>>2]=r[s+8>>2];r[x+32+20>>2]=r[s+24>>2];r[x+32+24>>2]=r[s+40>>2];h[x+32+28>>2]=0.0;r[x+32+32>>2]=r[s+12>>2];r[x+32+36>>2]=r[s+28>>2];r[x+32+40>>2]=r[s+44>>2];h[x+32+44>>2]=0.0;w=y-+h[T+56>>2];C=g-+h[T+60>>2];h[x+16>>2]=m-+h[T+52>>2];h[x+16+4>>2]=w;h[x+16+8>>2]=C;h[x+16+12>>2]=0.0;C=S-+h[s+60>>2];h[x>>2]=b-o;h[x+4>>2]=v-e;h[x+8>>2]=C;h[x+12>>2]=0.0;T=r[t+28>>2]|0;s=r[t+32>>2]|0;ME(t+48+(i*84|0)|0,x+80|0,x+32|0,x+16|0,x,x+128+(i<<4)|0,T+420|0,+h[T+368>>2],s+420|0,+h[s+368>>2]);i=i+1|0;if((i|0)==3)break;T=r[t+32>>2]|0;s=T;o=+h[T+52>>2];e=+h[T+56>>2]}}o=+h[t+560>>2];a=+h[t+576>>2];l=+h[t+592>>2];if(+W(+l)>.7071067690849304){f=1.0/+G(+(l*l+a*a));e=o*-(l*f);c=0.0;u=a*f;d=-(l*f);p=(l*l+a*a)*f;f=-(o*(a*f))}else{f=1.0/+G(+(o*o+a*a));e=(o*o+a*a)*f;c=-(a*f);u=0.0;d=o*f;p=-(l*(o*f));f=l*-(a*f)}s=r[t+28>>2]|0;k=+h[s+4>>2];D=+h[s+8>>2];v=+h[s+12>>2];z=c*k+d*D+u*v;L=+h[s+20>>2];P=+h[s+24>>2];w=+h[s+28>>2];H=c*L+d*P+u*w;I=+h[s+36>>2];b=+h[s+40>>2];M=+h[s+44>>2];q=c*I+d*b+u*M;E=p*k+f*D+e*v;F=p*L+f*P+e*w;B=p*I+f*b+e*M;i=r[t+32>>2]|0;A=+h[i+4>>2];c=+h[i+20>>2];u=+h[i+36>>2];m=+h[i+8>>2];g=+h[i+24>>2];S=+h[i+40>>2];U=+h[i+12>>2];j=+h[i+28>>2];Y=+h[i+44>>2];r[t+300>>2]=0;r[t+300+4>>2]=0;r[t+300+8>>2]=0;r[t+300+12>>2]=0;h[t+316>>2]=z*k+H*L+q*I;h[t+320>>2]=z*D+H*P+q*b;h[t+324>>2]=z*v+H*w+q*M;h[t+328>>2]=0.0;h[t+332>>2]=A*-z+c*-H+u*-q;h[t+336>>2]=m*-z+g*-H+S*-q;h[t+340>>2]=U*-z+j*-H+Y*-q;h[t+344>>2]=0.0;R=(z*k+H*L+q*I)*+h[s+420>>2];O=(z*D+H*P+q*b)*+h[s+424>>2];e=(z*v+H*w+q*M)*+h[s+428>>2];h[t+348>>2]=R;h[t+352>>2]=O;h[t+356>>2]=e;h[t+360>>2]=0.0;f=(A*-z+c*-H+u*-q)*+h[i+420>>2];C=(m*-z+g*-H+S*-q)*+h[i+424>>2];K=(U*-z+j*-H+Y*-q)*+h[i+428>>2];h[t+364>>2]=f;h[t+368>>2]=C;h[t+372>>2]=K;h[t+376>>2]=0.0;h[t+380>>2]=(z*k+H*L+q*I)*R+(z*D+H*P+q*b)*O+(z*v+H*w+q*M)*e+((A*-z+c*-H+u*-q)*f+(m*-z+g*-H+S*-q)*C+(U*-z+j*-H+Y*-q)*K);i=r[t+28>>2]|0;K=+h[i+4>>2];q=+h[i+20>>2];Y=+h[i+36>>2];H=+h[i+8>>2];j=+h[i+24>>2];z=+h[i+40>>2];U=+h[i+12>>2];C=+h[i+28>>2];S=+h[i+44>>2];s=r[t+32>>2]|0;g=+h[s+4>>2];m=+h[s+20>>2];f=+h[s+36>>2];u=+h[s+8>>2];c=+h[s+24>>2];A=+h[s+40>>2];e=+h[s+12>>2];O=+h[s+28>>2];R=+h[s+44>>2];r[t+384>>2]=0;r[t+384+4>>2]=0;r[t+384+8>>2]=0;r[t+384+12>>2]=0;h[t+400>>2]=E*K+F*q+B*Y;h[t+404>>2]=E*H+F*j+B*z;h[t+408>>2]=E*U+F*C+B*S;h[t+412>>2]=0.0;h[t+416>>2]=g*-E+m*-F+f*-B;h[t+420>>2]=u*-E+c*-F+A*-B;h[t+424>>2]=e*-E+O*-F+R*-B;h[t+428>>2]=0.0;X=(E*K+F*q+B*Y)*+h[i+420>>2];V=(E*H+F*j+B*z)*+h[i+424>>2];y=(E*U+F*C+B*S)*+h[i+428>>2];h[t+432>>2]=X;h[t+436>>2]=V;h[t+440>>2]=y;h[t+444>>2]=0.0;d=(g*-E+m*-F+f*-B)*+h[s+420>>2];p=(u*-E+c*-F+A*-B)*+h[s+424>>2];N=(e*-E+O*-F+R*-B)*+h[s+428>>2];h[t+448>>2]=d;h[t+452>>2]=p;h[t+456>>2]=N;h[t+460>>2]=0.0;h[t+464>>2]=(E*K+F*q+B*Y)*X+(E*H+F*j+B*z)*V+(E*U+F*C+B*S)*y+((g*-E+m*-F+f*-B)*d+(u*-E+c*-F+A*-B)*p+(e*-E+O*-F+R*-B)*N);s=r[t+28>>2]|0;N=+h[s+4>>2];B=+h[s+20>>2];R=+h[s+36>>2];F=+h[s+8>>2];O=+h[s+24>>2];E=+h[s+40>>2];e=+h[s+12>>2];p=+h[s+28>>2];A=+h[s+44>>2];i=r[t+32>>2]|0;c=+h[i+4>>2];u=+h[i+20>>2];d=+h[i+36>>2];f=+h[i+8>>2];m=+h[i+24>>2];g=+h[i+40>>2];y=+h[i+12>>2];S=+h[i+28>>2];C=+h[i+44>>2];r[t+468>>2]=0;r[t+468+4>>2]=0;r[t+468+8>>2]=0;r[t+468+12>>2]=0;R=(k*o+D*a+v*l)*N+(L*o+P*a+w*l)*B+(I*o+b*a+M*l)*R;E=(k*o+D*a+v*l)*F+(L*o+P*a+w*l)*O+(I*o+b*a+M*l)*E;A=(k*o+D*a+v*l)*e+(L*o+P*a+w*l)*p+(I*o+b*a+M*l)*A;h[t+484>>2]=R;h[t+488>>2]=E;h[t+492>>2]=A;h[t+496>>2]=0.0;v=-(k*o+D*a+v*l);w=-(L*o+P*a+w*l);o=-(I*o+b*a+M*l);h[t+500>>2]=c*v+u*w+d*o;h[t+504>>2]=f*v+m*w+g*o;h[t+508>>2]=y*v+S*w+C*o;h[t+512>>2]=0.0;M=R*+h[s+420>>2];a=E*+h[s+424>>2];l=A*+h[s+428>>2];h[t+516>>2]=M;h[t+520>>2]=a;h[t+524>>2]=l;h[t+528>>2]=0.0;p=(c*v+u*w+d*o)*+h[i+420>>2];b=(f*v+m*w+g*o)*+h[i+424>>2];e=(y*v+S*w+C*o)*+h[i+428>>2];h[t+532>>2]=p;h[t+536>>2]=b;h[t+540>>2]=e;h[t+544>>2]=0.0;h[t+548>>2]=R*M+E*a+A*l+((c*v+u*w+d*o)*p+(f*v+m*w+g*o)*b+(y*v+S*w+C*o)*e);h[t+724>>2]=0.0;i=r[t+28>>2]|0;s=r[t+32>>2]|0;e=+yD(t,i+4|0,s+4|0);h[t+728>>2]=e;h[t+708>>2]=0.0;h[t+712>>2]=0.0;n[t+716>>0]=0;o=+h[t+692>>2];do{if(o>=0.0){e=+ql(e-+h[t+688>>2]);if(!(e<-3.1415927410125732)){if(e>3.1415927410125732)e=e+-6.2831854820251465}else e=e+6.2831854820251465;if(e<-o){n[t+716>>0]=1;h[t+708>>2]=-(e+o);h[t+712>>2]=1.0;break}if(e>o){n[t+716>>0]=1;h[t+708>>2]=o-e;h[t+712>>2]=-1.0}}}while(0);H=+h[t+560>>2];X=+h[t+576>>2];K=+h[t+592>>2];Y=H*+h[i+4>>2]+X*+h[i+8>>2]+K*+h[i+12>>2];q=H*+h[i+20>>2]+X*+h[i+24>>2]+K*+h[i+28>>2];K=H*+h[i+36>>2]+X*+h[i+40>>2]+K*+h[i+44>>2];h[t+720>>2]=1.0/(Y*(Y*+h[i+288>>2]+q*+h[i+304>>2]+K*+h[i+320>>2])+q*(Y*+h[i+292>>2]+q*+h[i+308>>2]+K*+h[i+324>>2])+K*(Y*+h[i+296>>2]+q*+h[i+312>>2]+K*+h[i+328>>2])+(Y*(Y*+h[s+288>>2]+q*+h[s+304>>2]+K*+h[s+320>>2])+q*(Y*+h[s+292>>2]+q*+h[s+308>>2]+K*+h[s+324>>2])+K*(Y*+h[s+296>>2]+q*+h[s+312>>2]+K*+h[s+328>>2])));_=x;return}function yD(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,r=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0;S=+h[t+552>>2];v=+h[t+568>>2];y=+h[t+584>>2];b=+h[e>>2];g=+h[e+4>>2];m=+h[e+8>>2];p=+h[e+16>>2];d=+h[e+20>>2];u=+h[e+24>>2];c=+h[e+32>>2];a=+h[e+36>>2];r=+h[e+40>>2];l=+h[t+556>>2];o=+h[t+572>>2];s=+h[t+588>>2];w=+h[t+620>>2];x=+h[t+636>>2];n=+h[t+652>>2];f=w*+h[i>>2]+x*+h[i+4>>2]+n*+h[i+8>>2];_=w*+h[i+16>>2]+x*+h[i+20>>2]+n*+h[i+24>>2];n=w*+h[i+32>>2]+x*+h[i+36>>2]+n*+h[i+40>>2];n=+Q(+((S*b+v*g+y*m)*f+(S*p+v*d+y*u)*_+(S*c+v*a+y*r)*n),+((b*l+g*o+m*s)*f+(p*l+d*o+u*s)*_+(c*l+a*o+r*s)*n));return+(n*+h[t+732>>2])}function vD(t,e){t=t|0;e=e|0;var i=0.0,s=0.0,o=0;if(n[t+738>>0]|0){r[e>>2]=0;r[e+4>>2]=0;return}r[e>>2]=5;r[e+4>>2]=1;i=+yD(t,(r[t+28>>2]|0)+4|0,(r[t+32>>2]|0)+4|0);h[t+728>>2]=i;h[t+708>>2]=0.0;h[t+712>>2]=0.0;n[t+716>>0]=0;s=+h[t+692>>2];do{if(s>=0.0){i=+ql(i-+h[t+688>>2]);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;if(i<-s){n[t+716>>0]=1;h[t+708>>2]=-(i+s);h[t+712>>2]=1.0;break}if(i>s){n[t+716>>0]=1;h[t+708>>2]=s-i;h[t+712>>2]=-1.0}else o=12}else o=12}while(0);if((o|0)==12?(n[t+737>>0]|0)==0:0)return;r[e>>2]=6;r[e+4>>2]=0;return}function SD(t,e){t=t|0;e=e|0;var i=0.0,o=0.0,a=0,l=0,c=0.0,_=0.0,u=0.0,d=0,p=0.0,f=0,m=0,g=0.0,b=0,y=0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0.0,V=0.0,z=0.0,W=0.0,j=0.0,H=0,X=0,Y=0.0,q=0.0,K=0.0,Z=0.0,Q=0.0,$=0.0,J=0.0,tt=0.0,et=0.0,it=0.0,nt=0.0,st=0.0,rt=0.0,ot=0.0,at=0.0,lt=0.0,ht=0.0,ct=0.0,_t=0.0,ut=0.0,dt=0.0,pt=0.0,ft=0.0,mt=0.0,gt=0,bt=0;gt=r[t+28>>2]|0;bt=r[t+32>>2]|0;b=r[e+24>>2]|0;if(!(n[t+739>>0]|0)){A=+h[t+552>>2];Y=+h[gt+4>>2];E=+h[t+568>>2];q=+h[gt+8>>2];M=+h[t+584>>2];K=+h[gt+12>>2];R=+h[t+556>>2];I=+h[t+572>>2];P=+h[t+588>>2];Z=+h[t+560>>2];Q=+h[t+576>>2];$=+h[t+592>>2];J=+h[gt+20>>2];tt=+h[gt+24>>2];et=+h[gt+28>>2];it=+h[gt+36>>2];nt=+h[gt+40>>2];st=+h[gt+44>>2];u=+h[t+600>>2];p=+h[t+604>>2];g=+h[t+608>>2];v=+h[gt+52>>2];S=+h[gt+56>>2];x=+h[gt+60>>2];L=+h[bt+4>>2];D=+h[bt+8>>2];k=+h[bt+12>>2];O=+h[t+624>>2];F=+h[t+640>>2];B=+h[t+656>>2];N=+h[bt+20>>2];U=+h[bt+24>>2];V=+h[bt+28>>2];z=+h[bt+36>>2];W=+h[bt+40>>2];j=+h[bt+44>>2];ft=+h[t+664>>2];mt=+h[t+668>>2];T=+h[t+672>>2];w=+h[bt+52>>2]+(L*ft+D*mt+k*T);C=N*ft+U*mt+V*T+ +h[bt+56>>2];T=z*ft+W*mt+j*T+ +h[bt+60>>2];H=s[t+736>>1]|0;if(!((H&255)<<24>>24)){a=r[e+8>>2]|0;h[a>>2]=1.0;h[a+(b+1<<2)>>2]=1.0;h[a+((b<<1)+2<<2)>>2]=1.0;a=r[e+16>>2]|0;h[a>>2]=-1.0;h[a+(b+1<<2)>>2]=-1.0;h[a+((b<<1)+2<<2)>>2]=-1.0;a=b<<1;i=+h[gt+52>>2];o=+h[gt+56>>2];c=+h[gt+60>>2]}else{a=b<<1;i=v;o=S;c=x}_=v+(Y*u+q*p+K*g)-i;i=J*u+tt*p+et*g+S-o;mt=it*u+nt*p+st*g+x-c;d=r[e+12>>2]|0;m=d+(a<<2)|0;r[d>>2]=0;h[d+4>>2]=mt;h[d+8>>2]=-i;h[d+12>>2]=0.0;h[d+(b<<2)>>2]=-mt;r[d+(b<<2)+4>>2]=0;h[d+(b<<2)+8>>2]=_;h[d+(b<<2)+12>>2]=0.0;h[m>>2]=i;h[m+4>>2]=-_;r[m+8>>2]=0;h[m+12>>2]=0.0;_=w-+h[bt+52>>2];i=C-+h[bt+56>>2];mt=T-+h[bt+60>>2];m=r[e+20>>2]|0;X=m+(a<<2)|0;r[m>>2]=0;h[m+4>>2]=-mt;h[m+8>>2]=i;h[m+12>>2]=0.0;h[m+(b<<2)>>2]=mt;r[m+(b<<2)+4>>2]=0;h[m+(b<<2)+8>>2]=-_;h[m+(b<<2)+12>>2]=0.0;h[X>>2]=-i;h[X+4>>2]=_;r[X+8>>2]=0;h[X+12>>2]=0.0;X=r[t+748>>2]|0;_=+h[((X&8|0)==0?e+4|0:t+756|0)>>2];i=_*+h[e>>2];y=r[e+28>>2]|0;if(!((H&255)<<24>>24)){h[y>>2]=i*(w-(v+(Y*u+q*p+K*g)));h[y+(b<<2)>>2]=i*(C-(J*u+tt*p+et*g+S));h[y+(b<<1<<2)>>2]=i*(T-(it*u+nt*p+st*g+x))}b=r[e+24>>2]|0;h[d+(b*3<<2)>>2]=A*Y+E*q+M*K;h[d+((b*3|0)+1<<2)>>2]=A*J+E*tt+M*et;h[d+((b*3|0)+2<<2)>>2]=A*it+E*nt+M*st;h[d+(b<<2<<2)>>2]=Y*R+q*I+K*P;h[d+((b<<2|1)<<2)>>2]=R*J+I*tt+P*et;h[d+((b<<2|2)<<2)>>2]=R*it+I*nt+P*st;h[m+(b*3<<2)>>2]=-(A*Y+E*q+M*K);h[m+((b*3|0)+1<<2)>>2]=-(A*J+E*tt+M*et);h[m+((b*3|0)+2<<2)>>2]=-(A*it+E*nt+M*st);h[m+(b<<2<<2)>>2]=-(Y*R+q*I+K*P);h[m+((b<<2|1)<<2)>>2]=-(R*J+I*tt+P*et);h[m+((b<<2|2)<<2)>>2]=-(R*it+I*nt+P*st);ft=(Z*J+Q*tt+$*et)*(O*z+F*W+B*j)-(Z*it+Q*nt+$*st)*(O*N+F*U+B*V);mt=(Z*it+Q*nt+$*st)*(L*O+D*F+k*B)-(Y*Z+q*Q+K*$)*(O*z+F*W+B*j);pt=(Y*Z+q*Q+K*$)*(O*N+F*U+B*V)-(Z*J+Q*tt+$*et)*(L*O+D*F+k*B);h[y+(b*3<<2)>>2]=((A*it+E*nt+M*st)*pt+((A*Y+E*q+M*K)*ft+(A*J+E*tt+M*et)*mt))*i;h[y+(b<<2<<2)>>2]=((R*it+I*nt+P*st)*pt+((Y*R+q*I+K*P)*ft+(R*J+I*tt+P*et)*mt))*i;if(!(n[t+716>>0]|0)){f=0;g=0.0}else{g=+h[t+708>>2]*+h[t+732>>2];f=g>0.0?1:2}l=(f|0)!=0;if(!((H&65535)>>>8&65535|f))return;h[d+(b*5<<2)>>2]=Y*Z+q*Q+K*$;h[d+((b*5|0)+1<<2)>>2]=Z*J+Q*tt+$*et;h[d+((b*5|0)+2<<2)>>2]=Z*it+Q*nt+$*st;h[m+(b*5<<2)>>2]=-(Y*Z+q*Q+K*$);h[m+((b*5|0)+1<<2)>>2]=-(Z*J+Q*tt+$*et);h[m+((b*5|0)+2<<2)>>2]=-(Z*it+Q*nt+$*st);o=+h[t+688>>2];c=+h[t+692>>2];i=+ql(o-c);if(!(i<-3.1415927410125732))if(i>3.1415927410125732)p=i+-6.2831854820251465;else p=i;else p=i+6.2831854820251465;i=+ql(o+c);if(!(i<-3.1415927410125732))if(i>3.1415927410125732)u=i+-6.2831854820251465;else u=i;else u=i+6.2831854820251465;a=p==u;d=y+(b*5<<2)|0;h[d>>2]=0.0;if(X&2)_=+h[t+764>>2];if(!((H&65535)>>>8<<16>>16==0|l&a)){if(X&4|0)r[(r[e+32>>2]|0)+(b*5<<2)>>2]=r[t+752>>2];o=+h[t+728>>2];c=+h[t+680>>2];i=p>u?1.0:0.0;do{if(!(p>=u)){i=c/(_*+h[e>>2]);if(i<0.0)if(o>=p&p-i>o){i=(p-o)/i;break}else{i=o<p?0.0:1.0;break}if(i>0.0)if(o<=u&u-i<o){i=(u-o)/i;break}else{i=o>u?0.0:1.0;break}else i=0.0}}while(0);h[d>>2]=i*c*+h[t+732>>2]+ +h[d>>2];h[(r[e+36>>2]|0)+(b*5<<2)>>2]=-+h[t+684>>2];r[(r[e+40>>2]|0)+(b*5<<2)>>2]=r[t+684>>2]}if(!l)return;h[d>>2]=+h[d>>2]+g*(_*+h[e>>2]);if(X&1|0)r[(r[e+32>>2]|0)+(b*5<<2)>>2]=r[t+760>>2];do{if(!a){l=(r[e+36>>2]|0)+(b*5<<2)|0;a=r[e+40>>2]|0;if((f|0)==1){h[l>>2]=0.0;h[a+(b*5<<2)>>2]=3402823466385288598117041.0e14;break}else{h[l>>2]=-3402823466385288598117041.0e14;h[a+(b*5<<2)>>2]=0.0;break}}else{h[(r[e+36>>2]|0)+(b*5<<2)>>2]=-3402823466385288598117041.0e14;h[(r[e+40>>2]|0)+(b*5<<2)>>2]=3402823466385288598117041.0e14}}while(0);o=+h[t+704>>2];do{if(o>0.0){i=(Y*Z+q*Q+K*$)*+h[gt+352>>2]+(Z*J+Q*tt+$*et)*+h[gt+356>>2]+(Z*it+Q*nt+$*st)*+h[gt+360>>2]-((Y*Z+q*Q+K*$)*+h[bt+352>>2]+(Z*J+Q*tt+$*et)*+h[bt+356>>2]+(Z*it+Q*nt+$*st)*+h[bt+360>>2]);if((f|0)==1){if(!(i<0.0))break;if(!(+h[d>>2]<-(o*i)))break;h[d>>2]=-(o*i);break}else{if(!(i>0.0))break;if(!(+h[d>>2]>-(o*i)))break;h[d>>2]=-(o*i);break}}}while(0);h[d>>2]=+h[t+700>>2]*+h[d>>2];return}Z=+h[gt+4>>2];Q=+h[gt+8>>2];$=+h[gt+12>>2];v=+h[t+556>>2];w=+h[t+572>>2];T=+h[t+588>>2];J=+h[t+560>>2];tt=+h[t+576>>2];et=+h[t+592>>2];it=+h[gt+20>>2];nt=+h[gt+24>>2];st=+h[gt+28>>2];rt=+h[gt+36>>2];ot=+h[gt+40>>2];at=+h[gt+44>>2];ht=+h[t+600>>2];lt=+h[t+604>>2];p=+h[t+608>>2];o=+h[gt+52>>2]+(Z*ht+Q*lt+$*p);x=it*ht+nt*lt+st*p+ +h[gt+56>>2];p=rt*ht+ot*lt+at*p+ +h[gt+60>>2];lt=+h[bt+4>>2];ht=+h[bt+8>>2];ct=+h[bt+12>>2];_t=+h[t+624>>2];ut=+h[t+640>>2];V=+h[t+656>>2];z=+h[bt+20>>2];W=+h[bt+24>>2];j=+h[bt+28>>2];Y=+h[bt+36>>2];q=+h[bt+40>>2];K=+h[bt+44>>2];g=+h[t+664>>2];C=+h[t+668>>2];c=+h[t+672>>2];i=+h[bt+52>>2];S=+h[bt+56>>2];u=+h[bt+60>>2];O=i+(lt*g+ht*C+ct*c)-o;F=z*g+W*C+j*c+S-x;B=Y*g+q*C+K*c+u-p;A=+h[(r[t+28>>2]|0)+368>>2];E=+h[(r[t+32>>2]|0)+368>>2];k=A+E>0.0?E/(A+E):.5;dt=(Z*J+Q*tt+$*et)*k+(lt*_t+ht*ut+ct*V)*(1.0-k);pt=(J*it+tt*nt+et*st)*k+(_t*z+ut*W+V*j)*(1.0-k);ft=(J*rt+tt*ot+et*at)*k+(_t*Y+ut*q+V*K)*(1.0-k);mt=1.0/+G(+(dt*dt+pt*pt+ft*ft));M=(i+(lt*g+ht*C+ct*c)-i)*(dt*mt)+(z*g+W*C+j*c+S-S)*(pt*mt)+(Y*g+q*C+K*c+u-u)*(ft*mt);i=i+(lt*g+ht*C+ct*c)-i-dt*mt*M;S=z*g+W*C+j*c+S-S-pt*mt*M;u=Y*g+q*C+K*c+u-u-ft*mt*M;o=o-+h[gt+52>>2];x=x-+h[gt+56>>2];p=p-+h[gt+60>>2];c=dt*mt*(o*(dt*mt)+x*(pt*mt)+p*(ft*mt));C=pt*mt*(o*(dt*mt)+x*(pt*mt)+p*(ft*mt));g=ft*mt*(o*(dt*mt)+x*(pt*mt)+p*(ft*mt));L=o-c+k*(c-dt*mt*M);D=x-C+k*(C-pt*mt*M);P=p-g+k*(g-ft*mt*M);R=i-(1.0-k)*(c-dt*mt*M);I=S-(1.0-k)*(C-pt*mt*M);M=u-(1.0-k)*(g-ft*mt*M);_=(k*i+(1.0-k)*(o-c))*(k*i+(1.0-k)*(o-c))+(k*S+(1.0-k)*(x-C))*(k*S+(1.0-k)*(x-C))+(k*u+(1.0-k)*(p-g))*(k*u+(1.0-k)*(p-g));if(_>1.1920928955078125e-07){T=1.0/+G(+_);U=(k*i+(1.0-k)*(o-c))*T;N=T*(k*u+(1.0-k)*(p-g));x=T*(k*S+(1.0-k)*(x-C))}else{U=Z*v+Q*w+$*T;N=v*rt+w*ot+T*at;x=v*it+w*nt+T*st}g=pt*mt*N-ft*mt*x;v=ft*mt*U-N*(dt*mt);S=x*(dt*mt)-pt*mt*U;X=r[e+12>>2]|0;h[X>>2]=D*N-P*x;h[X+4>>2]=P*U-L*N;h[X+8>>2]=L*x-D*U;X=r[e+20>>2]|0;h[X>>2]=-(I*N-M*x);h[X+4>>2]=-(M*U-R*N);h[X+8>>2]=-(R*x-I*U);if(A<1.1920928955078125e-07|E<1.1920928955078125e-07?(n[t+716>>0]|0)!=0:0){i=(1.0-k)*(I*S-M*v);o=(1.0-k)*(M*g-R*S);c=(1.0-k)*(R*v-I*g);_=k*(D*S-P*v);u=k*(P*g-L*S);p=k*(L*v-D*g)}else{i=I*S-M*v;o=M*g-R*S;c=R*v-I*g;_=D*S-P*v;u=P*g-L*S;p=L*v-D*g}X=(r[e+12>>2]|0)+(b<<2)|0;h[X>>2]=_;h[X+4>>2]=u;h[X+8>>2]=p;X=r[e+20>>2]|0;h[X+(b<<2)>>2]=-i;h[X+(b+1<<2)>>2]=-o;h[X+(b+2<<2)>>2]=-c;if(A<1.1920928955078125e-07|E<1.1920928955078125e-07){p=(1.0-k)*(I*(ft*mt)-M*(pt*mt));u=(1.0-k)*(M*(dt*mt)-R*(ft*mt));_=(1.0-k)*(R*(pt*mt)-I*(dt*mt));c=k*(D*(ft*mt)-P*(pt*mt));o=k*(P*(dt*mt)-L*(ft*mt));i=k*(L*(pt*mt)-D*(dt*mt))}else{p=I*(ft*mt)-M*(pt*mt);u=M*(dt*mt)-R*(ft*mt);_=R*(pt*mt)-I*(dt*mt);c=D*(ft*mt)-P*(pt*mt);o=P*(dt*mt)-L*(ft*mt);i=L*(pt*mt)-D*(dt*mt)}a=(r[e+12>>2]|0)+(b<<1<<2)|0;h[a>>2]=c;h[a+4>>2]=o;h[a+8>>2]=i;a=r[e+20>>2]|0;h[a+(b<<1<<2)>>2]=-p;h[a+((b<<1|1)<<2)>>2]=-u;h[a+((b<<1)+2<<2)>>2]=-_;u=+h[((r[t+748>>2]&8|0)==0?e+4|0:t+756|0)>>2];i=u*+h[e>>2];if(!(n[t+736>>0]|0)){f=r[e+8>>2]|0;h[f>>2]=U;h[f+4>>2]=x;h[f+8>>2]=N;f=(r[e+8>>2]|0)+(b<<2)|0;h[f>>2]=g;h[f+4>>2]=v;h[f+8>>2]=S;f=(r[e+8>>2]|0)+(b<<1<<2)|0;h[f>>2]=dt*mt;h[f+4>>2]=pt*mt;h[f+8>>2]=ft*mt;f=r[e+16>>2]|0;o=-U;h[f>>2]=o;h[f+4>>2]=-x;h[f+8>>2]=-N;f=r[e+16>>2]|0;h[f+(b<<2)>>2]=-g;h[f+(b+1<<2)>>2]=-v;h[f+(b+2<<2)>>2]=-S;f=r[e+16>>2]|0;h[f+(b<<1<<2)>>2]=-(dt*mt);h[f+((b<<1|1)<<2)>>2]=-(pt*mt);h[f+((b<<1)+2<<2)>>2]=-(ft*mt);f=r[e+28>>2]|0;h[f>>2]=i*(O*U+F*x+B*N);h[f+(b<<2)>>2]=i*(O*g+F*v+B*S);h[f+(b<<1<<2)>>2]=i*(O*(dt*mt)+F*(pt*mt)+B*(ft*mt));i=o;o=-g;c=-v;_=-S;a=r[e+20>>2]|0}else{i=-U;o=-g;c=-v;_=-S;f=r[e+28>>2]|0}l=r[e+12>>2]|0;h[l+(b*3<<2)>>2]=U;h[l+((b*3|0)+1<<2)>>2]=x;h[l+((b*3|0)+2<<2)>>2]=N;h[l+(b<<2<<2)>>2]=g;h[l+((b<<2|1)<<2)>>2]=v;h[l+((b<<2|2)<<2)>>2]=S;h[a+(b*3<<2)>>2]=i;h[a+((b*3|0)+1<<2)>>2]=-x;h[a+((b*3|0)+2<<2)>>2]=-N;h[a+(b<<2<<2)>>2]=o;h[a+((b<<2|1)<<2)>>2]=c;h[a+((b<<2|2)<<2)>>2]=_;F=u*+h[e>>2];B=(J*it+tt*nt+et*st)*(_t*Y+ut*q+V*K)-(J*rt+tt*ot+et*at)*(_t*z+ut*W+V*j);at=(J*rt+tt*ot+et*at)*(lt*_t+ht*ut+ct*V)-(Z*J+Q*tt+$*et)*(_t*Y+ut*q+V*K);ut=(Z*J+Q*tt+$*et)*(_t*z+ut*W+V*j)-(J*it+tt*nt+et*st)*(lt*_t+ht*ut+ct*V);h[f+(b*3<<2)>>2]=F*(B*U+at*x+ut*N);h[f+(b<<2<<2)>>2]=F*(B*g+at*v+ut*S);if(!(n[t+716>>0]|0)){y=0;g=0.0}else{g=+h[t+708>>2]*+h[t+732>>2];y=g>0.0?1:2}d=n[t+737>>0]|0;m=(y|0)!=0;if(!(d&255|y))return;b=(r[e+24>>2]|0)*5|0;h[l+(b<<2)>>2]=dt*mt;h[l+(b+1<<2)>>2]=pt*mt;h[l+(b+2<<2)>>2]=ft*mt;h[a+(b<<2)>>2]=-(dt*mt);h[a+(b+1<<2)>>2]=-(pt*mt);h[a+(b+2<<2)>>2]=-(ft*mt);o=+h[t+688>>2];c=+h[t+692>>2];i=+ql(o-c);if(!(i<-3.1415927410125732))if(i>3.1415927410125732)p=i+-6.2831854820251465;else p=i;else p=i+6.2831854820251465;i=+ql(o+c);if(!(i<-3.1415927410125732)){if(i>3.1415927410125732)i=i+-6.2831854820251465}else i=i+6.2831854820251465;l=p==i;f=f+(b<<2)|0;h[f>>2]=0.0;a=r[t+748>>2]|0;if(a&2)u=+h[t+764>>2];if(!(d<<24>>24==0|m&l)){if(a&4|0)r[(r[e+32>>2]|0)+(b<<2)>>2]=r[t+752>>2];c=+h[t+728>>2];_=+h[t+680>>2];o=p>i?1.0:0.0;do{if(!(p>=i)){o=_/(u*+h[e>>2]);if(o<0.0)if(c>=p&p-o>c){i=(p-c)/o;break}else{i=c<p?0.0:1.0;break}if(o>0.0)if(c<=i&i-o<c){i=(i-c)/o;break}else{i=c>i?0.0:1.0;break}else i=0.0}else i=o}while(0);h[f>>2]=i*_*+h[t+732>>2]+ +h[f>>2];h[(r[e+36>>2]|0)+(b<<2)>>2]=-+h[t+684>>2];r[(r[e+40>>2]|0)+(b<<2)>>2]=r[t+684>>2]}if(!m)return;h[f>>2]=+h[f>>2]+g*(u*+h[e>>2]);if(a&1|0)r[(r[e+32>>2]|0)+(b<<2)>>2]=r[t+760>>2];do{if(!l){l=(r[e+36>>2]|0)+(b<<2)|0;a=r[e+40>>2]|0;if((y|0)==1){h[l>>2]=0.0;h[a+(b<<2)>>2]=3402823466385288598117041.0e14;break}else{h[l>>2]=-3402823466385288598117041.0e14;h[a+(b<<2)>>2]=0.0;break}}else{h[(r[e+36>>2]|0)+(b<<2)>>2]=-3402823466385288598117041.0e14;h[(r[e+40>>2]|0)+(b<<2)>>2]=3402823466385288598117041.0e14}}while(0);o=+h[t+704>>2];do{if(o>0.0){i=+h[gt+352>>2]*(dt*mt)+ +h[gt+356>>2]*(pt*mt)+ +h[gt+360>>2]*(ft*mt)-(dt*mt*+h[bt+352>>2]+pt*mt*+h[bt+356>>2]+ft*mt*+h[bt+360>>2]);if((y|0)==1){if(!(i<0.0))break;if(!(+h[f>>2]<-(o*i)))break;h[f>>2]=-(o*i);break}else{if(!(i>0.0))break;if(!(+h[f>>2]>-(o*i)))break;h[f>>2]=-(o*i);break}}}while(0);h[f>>2]=+h[t+700>>2]*+h[f>>2];return}function xD(t,e,i,n){t=t|0;e=e|0;i=+i;n=n|0;switch(n|0){case 5:case-1:break;default:return}switch(e|0){case 2:{h[t+764>>2]=i;r[t+748>>2]=r[t+748>>2]|2;return}case 4:{h[t+760>>2]=i;r[t+748>>2]=r[t+748>>2]|1;return}case 3:{h[t+752>>2]=i;r[t+748>>2]=r[t+748>>2]|4;return}case 1:{h[t+756>>2]=i;r[t+748>>2]=r[t+748>>2]|8;return}default:return}}function wD(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0;t:do{switch(i|0){case 5:case-1:switch(e|0){case 2:{n=+h[t+764>>2];break t}case 4:{n=+h[t+760>>2];break t}case 3:{n=+h[t+752>>2];break t}case 1:{n=+h[t+756>>2];break t}default:{n=0.0;break t}}default:n=0.0}}while(0);return+n}function CD(t){t=t|0;return 220}function TD(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,a=0.0,l=0.0,c=0;Ub(t,e,i)|0;r[e+52>>2]=r[t+552>>2];r[e+56>>2]=r[t+556>>2];r[e+60>>2]=r[t+560>>2];r[e+64>>2]=r[t+564>>2];r[e+68>>2]=r[t+568>>2];r[e+72>>2]=r[t+572>>2];r[e+76>>2]=r[t+576>>2];r[e+80>>2]=r[t+580>>2];r[e+84>>2]=r[t+584>>2];r[e+88>>2]=r[t+588>>2];r[e+92>>2]=r[t+592>>2];r[e+96>>2]=r[t+596>>2];r[e+100>>2]=r[t+600>>2];r[e+104>>2]=r[t+604>>2];r[e+108>>2]=r[t+608>>2];r[e+112>>2]=r[t+612>>2];r[e+116>>2]=r[t+616>>2];r[e+120>>2]=r[t+620>>2];r[e+124>>2]=r[t+624>>2];r[e+128>>2]=r[t+628>>2];r[e+132>>2]=r[t+632>>2];r[e+136>>2]=r[t+636>>2];r[e+140>>2]=r[t+640>>2];r[e+144>>2]=r[t+644>>2];r[e+148>>2]=r[t+648>>2];r[e+152>>2]=r[t+652>>2];r[e+156>>2]=r[t+656>>2];r[e+160>>2]=r[t+660>>2];r[e+164>>2]=r[t+664>>2];r[e+168>>2]=r[t+668>>2];r[e+172>>2]=r[t+672>>2];r[e+176>>2]=r[t+676>>2];i=s[t+736>>1]|0;r[e+184>>2]=i&255;r[e+188>>2]=(i&65535)>>>8&65535;r[e+196>>2]=r[t+684>>2];r[e+192>>2]=r[t+680>>2];r[e+180>>2]=o[t+740>>0];a=+h[t+688>>2];l=+h[t+692>>2];n=+ql(a-l);if(!(n<-3.1415927410125732)){if(n>3.1415927410125732)n=n+-6.2831854820251465}else n=n+6.2831854820251465;h[e+200>>2]=n;n=+ql(a+l);if(n<-3.1415927410125732){l=n+6.2831854820251465;i=e+204|0;h[i>>2]=l;i=t+696|0;i=r[i>>2]|0;c=e+208|0;r[c>>2]=i;c=t+700|0;c=r[c>>2]|0;i=e+212|0;r[i>>2]=c;i=t+704|0;i=r[i>>2]|0;t=e+216|0;r[t>>2]=i;return 15376}if(!(n>3.1415927410125732)){l=n;c=e+204|0;h[c>>2]=l;c=t+696|0;c=r[c>>2]|0;i=e+208|0;r[i>>2]=c;i=t+700|0;i=r[i>>2]|0;c=e+212|0;r[c>>2]=i;t=t+704|0;t=r[t>>2]|0;c=e+216|0;r[c>>2]=t;return 15376}l=n+-6.2831854820251465;c=e+204|0;h[c>>2]=l;c=t+696|0;c=r[c>>2]|0;i=e+208|0;r[i>>2]=c;i=t+700|0;i=r[i>>2]|0;c=e+212|0;r[c>>2]=i;t=t+704|0;t=r[t>>2]|0;c=e+216|0;r[c>>2]=t;return 15376}function AD(t){t=t|0;return r[t+748>>2]|0}function ED(t,e,i,s,o,a,l,c){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;l=l|0;c=c|0;var _=0.0,u=0.0,p=0.0,f=0.0,m=0.0,g=0.0,b=0.0,y=0,v=0,S=0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0;r[t+4>>2]=4;r[t+8>>2]=-1;r[t+12>>2]=-1;h[t+16>>2]=3402823466385288598117041.0e14;n[t+20>>0]=1;n[t+21>>0]=0;r[t+24>>2]=-1;r[t+28>>2]=e;r[t+32>>2]=i;h[t+36>>2]=0.0;h[t+40>>2]=.30000001192092896;r[t+44>>2]=0;r[t>>2]=7428;h[t+688>>2]=0.0;h[t+692>>2]=-1.0;h[t+696>>2]=.8999999761581421;h[t+700>>2]=.30000001192092896;h[t+704>>2]=1.0;h[t+708>>2]=0.0;h[t+712>>2]=0.0;n[t+716>>0]=0;n[t+736>>0]=0;n[t+737>>0]=0;n[t+738>>0]=0;n[t+739>>0]=1;n[t+740>>0]=c&1;r[t+748>>2]=0;r[t+748+4>>2]=0;r[t+748+8>>2]=0;r[t+748+12>>2]=0;r[t+748+16>>2]=0;r[t+600>>2]=r[s>>2];r[t+600+4>>2]=r[s+4>>2];r[t+600+8>>2]=r[s+8>>2];r[t+600+12>>2]=r[s+12>>2];_=+h[e+4>>2];u=+h[e+20>>2];p=+h[e+36>>2];f=+h[a>>2];m=+h[a+4>>2];g=+h[a+8>>2];do{if(!(_*f+u*m+p*g>=.9999998807907104))if(!(_*f+u*m+p*g<=-.9999998807907104)){i=(h[d>>2]=p*m-u*g,r[d>>2]|0);s=(h[d>>2]=_*g-p*f,r[d>>2]|0);c=(h[d>>2]=u*f-_*m,r[d>>2]|0);v=(h[d>>2]=g*(_*g-p*f)-m*(u*f-_*m),r[d>>2]|0);S=(h[d>>2]=f*(u*f-_*m)-g*(p*m-u*g),r[d>>2]|0);y=(h[d>>2]=m*(p*m-u*g)-f*(_*g-p*f),r[d>>2]|0);break}else{v=r[e+12>>2]|0;S=r[e+28>>2]|0;y=r[e+44>>2]|0;i=r[e+8>>2]|0;c=r[e+40>>2]|0;s=r[e+24>>2]|0;break}else{v=(h[d>>2]=-+h[e+12>>2],r[d>>2]|0);S=(h[d>>2]=-+h[e+28>>2],r[d>>2]|0);y=(h[d>>2]=-+h[e+44>>2],r[d>>2]|0);i=r[e+8>>2]|0;c=r[e+40>>2]|0;s=r[e+24>>2]|0}}while(0);r[t+552>>2]=v;r[t+556>>2]=i;r[t+560>>2]=r[a>>2];h[t+564>>2]=0.0;r[t+568>>2]=S;r[t+572>>2]=s;r[t+576>>2]=r[a+4>>2];h[t+580>>2]=0.0;r[t+584>>2]=y;r[t+588>>2]=c;r[t+592>>2]=r[a+8>>2];h[t+596>>2]=0.0;p=+h[a+4>>2];m=+h[l+8>>2];_=+h[a+8>>2];g=+h[l+4>>2];b=+h[l>>2];u=+h[a>>2];do{if(m*_+(p*g+b*u)<-.9999998807907104)if(+W(+_)>.7071067690849304){u=1.0/+G(+(p*p+_*_));i=0;f=0.0;_=-(_*u);s=(h[d>>2]=p*u,r[d>>2]|0);break}else{_=1.0/+G(+(p*p+u*u));i=(h[d>>2]=-(p*_),r[d>>2]|0);f=0.0;_=u*_;s=0;break}else{x=+G(+((m*_+(p*g+b*u)+1.0)*2.0));i=(h[d>>2]=(p*m-_*g)*(1.0/x),r[d>>2]|0);f=x*.5;_=(_*b-m*u)*(1.0/x);s=(h[d>>2]=(g*u-p*b)*(1.0/x),r[d>>2]|0)}}while(0);p=(r[d>>2]=v,+h[d>>2]);A=(r[d>>2]=y,+h[d>>2]);T=(r[d>>2]=s,+h[d>>2]);x=(r[d>>2]=S,+h[d>>2]);E=p*f+A*_-x*T;u=(r[d>>2]=i,+h[d>>2]);w=x*f+p*T-A*u;C=A*f+x*u-p*_;A=-(p*u)-x*_-A*T;_=-_;x=w*-T+(f*E+A*-u)-C*_;p=C*-u+(f*w+A*_)-E*-T;f=E*_+(A*-T+f*C)-w*-u;r[t+664>>2]=r[o>>2];r[t+664+4>>2]=r[o+4>>2];r[t+664+8>>2]=r[o+8>>2];r[t+664+12>>2]=r[o+12>>2];h[t+616>>2]=x;h[t+620>>2]=g*f-m*p;r[t+624>>2]=r[l>>2];h[t+628>>2]=0.0;h[t+632>>2]=p;h[t+636>>2]=m*x-b*f;r[t+640>>2]=r[l+4>>2];h[t+644>>2]=0.0;h[t+648>>2]=f;h[t+652>>2]=b*p-g*x;r[t+656>>2]=r[l+8>>2];h[t+660>>2]=0.0;h[t+732>>2]=n[t+740>>0]|0?-1.0:1.0;return}function MD(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0.0,a=0.0,l=0.0,c=0.0,_=0.0;Bb(t,4,e);r[t>>2]=7428;r[t+552>>2]=r[i>>2];r[t+552+4>>2]=r[i+4>>2];r[t+552+8>>2]=r[i+8>>2];r[t+552+12>>2]=r[i+12>>2];r[t+568>>2]=r[i+16>>2];r[t+568+4>>2]=r[i+16+4>>2];r[t+568+8>>2]=r[i+16+8>>2];r[t+568+12>>2]=r[i+16+12>>2];r[t+584>>2]=r[i+32>>2];r[t+584+4>>2]=r[i+32+4>>2];r[t+584+8>>2]=r[i+32+8>>2];r[t+584+12>>2]=r[i+32+12>>2];r[t+600>>2]=r[i+48>>2];r[t+600+4>>2]=r[i+48+4>>2];r[t+600+8>>2]=r[i+48+8>>2];r[t+600+12>>2]=r[i+48+12>>2];r[t+616>>2]=r[i>>2];r[t+616+4>>2]=r[i+4>>2];r[t+616+8>>2]=r[i+8>>2];r[t+616+12>>2]=r[i+12>>2];r[t+632>>2]=r[i+16>>2];r[t+632+4>>2]=r[i+16+4>>2];r[t+632+8>>2]=r[i+16+8>>2];r[t+632+12>>2]=r[i+16+12>>2];r[t+648>>2]=r[i+32>>2];r[t+648+4>>2]=r[i+32+4>>2];r[t+648+8>>2]=r[i+32+8>>2];r[t+648+12>>2]=r[i+32+12>>2];r[t+664>>2]=r[i+48>>2];r[t+664+4>>2]=r[i+48+4>>2];r[t+664+8>>2]=r[i+48+8>>2];r[t+664+12>>2]=r[i+48+12>>2];h[t+688>>2]=0.0;h[t+692>>2]=-1.0;h[t+696>>2]=.8999999761581421;h[t+700>>2]=.30000001192092896;h[t+704>>2]=1.0;h[t+708>>2]=0.0;h[t+712>>2]=0.0;n[t+716>>0]=0;n[t+736>>0]=0;n[t+737>>0]=0;n[t+738>>0]=0;n[t+739>>0]=1;n[t+740>>0]=s&1;r[t+748>>2]=0;r[t+748+4>>2]=0;r[t+748+8>>2]=0;r[t+748+12>>2]=0;r[t+748+16>>2]=0;i=r[t+28>>2]|0;_=+h[t+600>>2];c=+h[t+604>>2];l=+h[t+608>>2];a=_*+h[i+20>>2]+c*+h[i+24>>2]+l*+h[i+28>>2]+ +h[i+56>>2];o=_*+h[i+36>>2]+c*+h[i+40>>2]+l*+h[i+44>>2]+ +h[i+60>>2];h[t+664>>2]=_*+h[i+4>>2]+c*+h[i+8>>2]+l*+h[i+12>>2]+ +h[i+52>>2];h[t+668>>2]=a;h[t+672>>2]=o;h[t+676>>2]=0.0;h[t+732>>2]=s?-1.0:1.0;return}function RD(t,e,i){t=t|0;e=e|0;i=i|0;return}function ID(t,e,i){t=t|0;e=e|0;i=i|0;return}function PD(t){t=t|0;r[t>>2]=7188;if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function LD(t){t=t|0;var e=0,i=0,n=0,s=0,o=0,a=0.0,l=0.0,c=0.0,u=0.0,p=0.0,f=0.0,m=0.0,g=0,b=0,y=0,v=0,S=0,x=0,w=0,C=0,T=0,A=0,E=0,M=0,R=0,I=0,P=0,L=0,D=0,k=0;i=_;_=_+144|0;h[t+36>>2]=0.0;r[i+128>>2]=0;r[i+128+4>>2]=0;r[i+128+8>>2]=0;r[i+128+12>>2]=0;e=0;do{n=i+128+(e<<2)|0;h[n>>2]=1.0;A=r[t+28>>2]|0;k=r[A+4>>2]|0;r[i+80>>2]=k;P=r[A+20>>2]|0;r[i+80+4>>2]=P;M=r[A+36>>2]|0;r[i+80+8>>2]=M;h[i+80+12>>2]=0.0;D=r[A+8>>2]|0;r[i+80+16>>2]=D;I=r[A+24>>2]|0;r[i+80+20>>2]=I;E=r[A+40>>2]|0;r[i+80+24>>2]=E;h[i+80+28>>2]=0.0;L=r[A+12>>2]|0;r[i+80+32>>2]=L;R=r[A+28>>2]|0;r[i+80+36>>2]=R;T=r[A+44>>2]|0;r[i+80+40>>2]=T;h[i+80+44>>2]=0.0;s=r[t+32>>2]|0;C=r[s+4>>2]|0;r[i+32>>2]=C;S=r[s+20>>2]|0;r[i+32+4>>2]=S;b=r[s+36>>2]|0;r[i+32+8>>2]=b;h[i+32+12>>2]=0.0;w=r[s+8>>2]|0;r[i+32+16>>2]=w;v=r[s+24>>2]|0;r[i+32+20>>2]=v;g=r[s+40>>2]|0;r[i+32+24>>2]=g;h[i+32+28>>2]=0.0;x=r[s+12>>2]|0;r[i+32+32>>2]=x;y=r[s+28>>2]|0;r[i+32+36>>2]=y;o=r[s+44>>2]|0;r[i+32+40>>2]=o;h[i+32+44>>2]=0.0;f=+h[t+300>>2];c=f*(r[d>>2]=k,+h[d>>2]);a=+h[t+304>>2];c=c+a*(r[d>>2]=D,+h[d>>2]);l=+h[t+308>>2];c=c+l*(r[d>>2]=L,+h[d>>2]);m=f*(r[d>>2]=P,+h[d>>2]);m=m+a*(r[d>>2]=I,+h[d>>2]);m=m+l*(r[d>>2]=R,+h[d>>2]);f=f*(r[d>>2]=M,+h[d>>2]);a=f+a*(r[d>>2]=E,+h[d>>2]);f=+h[A+52>>2];p=+h[A+56>>2];u=+h[A+60>>2];u=a+l*(r[d>>2]=T,+h[d>>2])+u-u;h[i+16>>2]=c+f-f;h[i+16+4>>2]=m+p-p;h[i+16+8>>2]=u;h[i+16+12>>2]=0.0;u=+h[t+316>>2];p=u*(r[d>>2]=C,+h[d>>2]);m=+h[t+320>>2];p=p+m*(r[d>>2]=w,+h[d>>2]);f=+h[t+324>>2];p=p+f*(r[d>>2]=x,+h[d>>2]);c=u*(r[d>>2]=S,+h[d>>2]);c=c+m*(r[d>>2]=v,+h[d>>2]);c=c+f*(r[d>>2]=y,+h[d>>2]);u=u*(r[d>>2]=b,+h[d>>2]);m=u+m*(r[d>>2]=g,+h[d>>2]);u=+h[s+52>>2];l=+h[s+56>>2];a=+h[s+60>>2];a=m+f*(r[d>>2]=o,+h[d>>2])+a-a;h[i>>2]=p+u-u;h[i+4>>2]=c+l-l;h[i+8>>2]=a;h[i+12>>2]=0.0;o=r[t+28>>2]|0;s=r[t+32>>2]|0;ME(t+48+(e*84|0)|0,i+80|0,i+32|0,i+16|0,i,i+128|0,o+420|0,+h[o+368>>2],s+420|0,+h[s+368>>2]);h[n>>2]=0.0;e=e+1|0}while((e|0)!=3);_=i;return}function DD(t,e){t=t|0;e=e|0;t=(n[t+344>>0]|0)==0?3:0;r[e>>2]=t;r[e+4>>2]=t;return}function kD(t,e){t=t|0;e=e|0;var i=0.0,n=0.0,s=0,o=0,a=0,l=0,c=0,_=0.0,u=0.0,d=0.0,p=0.0,f=0.0,m=0.0;l=r[t+28>>2]|0;c=r[t+32>>2]|0;s=r[e+8>>2]|0;h[s>>2]=1.0;o=r[e+24>>2]|0;h[s+(o+1<<2)>>2]=1.0;h[s+((o<<1)+2<<2)>>2]=1.0;_=+h[t+300>>2];m=+h[t+304>>2];n=+h[t+308>>2];p=+h[l+4>>2]*_+ +h[l+8>>2]*m+ +h[l+12>>2]*n;u=_*+h[l+20>>2]+m*+h[l+24>>2]+n*+h[l+28>>2];n=_*+h[l+36>>2]+m*+h[l+40>>2]+n*+h[l+44>>2];s=r[e+12>>2]|0;r[s>>2]=0;h[s+4>>2]=n;h[s+8>>2]=-u;h[s+12>>2]=0.0;h[s+(o<<2)>>2]=-n;r[s+(o<<2)+4>>2]=0;h[s+(o<<2)+8>>2]=p;h[s+(o<<2)+12>>2]=0.0;h[s+(o<<1<<2)>>2]=u;h[s+(o<<1<<2)+4>>2]=-p;r[s+(o<<1<<2)+8>>2]=0;h[s+(o<<1<<2)+12>>2]=0.0;s=r[e+16>>2]|0;h[s>>2]=-1.0;h[s+(o+1<<2)>>2]=-1.0;h[s+((o<<1)+2<<2)>>2]=-1.0;m=+h[t+316>>2];_=+h[t+320>>2];i=+h[t+324>>2];f=+h[c+4>>2]*m+ +h[c+8>>2]*_+ +h[c+12>>2]*i;d=m*+h[c+20>>2]+_*+h[c+24>>2]+i*+h[c+28>>2];i=m*+h[c+36>>2]+_*+h[c+40>>2]+i*+h[c+44>>2];o=r[e+20>>2]|0;s=r[e+24>>2]|0;r[o>>2]=0;h[o+4>>2]=-i;h[o+8>>2]=d;h[o+12>>2]=0.0;h[o+(s<<2)>>2]=i;r[o+(s<<2)+4>>2]=0;h[o+(s<<2)+8>>2]=-f;h[o+(s<<2)+12>>2]=0.0;h[o+(s<<1<<2)>>2]=-d;h[o+(s<<1<<2)+4>>2]=f;r[o+(s<<1<<2)+8>>2]=0;h[o+(s<<1<<2)+12>>2]=0.0;s=r[t+332>>2]|0;_=+h[((s&1|0)==0?e+4|0:t+336|0)>>2]*+h[e>>2];o=r[e+24>>2]|0;a=r[e+28>>2]|0;h[a>>2]=_*(f+ +h[c+52>>2]-p-+h[l+52>>2]);h[a+(o<<2)>>2]=_*(d+ +h[c+56>>2]-u-+h[l+56>>2]);h[a+(o<<1<<2)>>2]=_*(i+ +h[c+60>>2]-n-+h[l+60>>2]);if(s&2|0){c=r[e+24>>2]|0;l=r[e+32>>2]|0;r[l>>2]=r[t+340>>2];r[l+(c<<2)>>2]=r[t+340>>2];r[l+(c<<1<<2)>>2]=r[t+340>>2]}n=+h[t+356>>2];if(n>0.0){h[r[e+36>>2]>>2]=-n;h[r[e+40>>2]>>2]=n;i=+h[t+356>>2]}else i=n;if(i>0.0){c=r[e+24>>2]|0;h[(r[e+36>>2]|0)+(c<<2)>>2]=-n;h[(r[e+40>>2]|0)+(c<<2)>>2]=n;i=+h[t+356>>2]}if(!(i>0.0)){l=t+352|0;l=r[l>>2]|0;c=e+52|0;r[c>>2]=l;return}l=r[e+24>>2]<<1;h[(r[e+36>>2]|0)+(l<<2)>>2]=-n;h[(r[e+40>>2]|0)+(l<<2)>>2]=n;l=t+352|0;l=r[l>>2]|0;c=e+52|0;r[c>>2]=l;return}function OD(t,e,i,n){t=t|0;e=e|0;i=+i;n=n|0;if((n|0)!=-1)return;switch(e|0){case 2:case 1:{h[t+336>>2]=i;r[t+332>>2]=r[t+332>>2]|1;return}case 4:case 3:{h[t+340>>2]=i;r[t+332>>2]=r[t+332>>2]|2;return}default:return}}function FD(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0;t:do{if((i|0)==-1)switch(e|0){case 2:case 1:{n=+h[t+336>>2];break t}case 4:case 3:{n=+h[t+340>>2];break t}default:{n=3402823466385288598117041.0e14;break t}}else n=3402823466385288598117041.0e14}while(0);return+n}function BD(t){t=t|0;return 84}function ND(t,e,i){t=t|0;e=e|0;i=i|0;Ub(t,e,i)|0;r[e+52>>2]=r[t+300>>2];r[e+56>>2]=r[t+304>>2];r[e+60>>2]=r[t+308>>2];r[e+64>>2]=r[t+312>>2];r[e+68>>2]=r[t+316>>2];r[e+72>>2]=r[t+320>>2];r[e+76>>2]=r[t+324>>2];r[e+80>>2]=r[t+328>>2];return 15429}function UD(t){t=t|0;return r[t+332>>2]|0}function VD(t){t=t|0;var e=0;r[t>>2]=7540;e=r[t+176>>2]|0;if(e|0){if(n[t+180>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+176>>2]=0}n[t+180>>0]=1;r[t+176>>2]=0;r[t+168>>2]=0;r[t+172>>2]=0;e=r[t+156>>2]|0;if(e|0){if(n[t+160>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+156>>2]=0}n[t+160>>0]=1;r[t+156>>2]=0;r[t+148>>2]=0;r[t+152>>2]=0;e=r[t+136>>2]|0;if(e|0){if(n[t+140>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+136>>2]=0}n[t+140>>0]=1;r[t+136>>2]=0;r[t+128>>2]=0;r[t+132>>2]=0;e=r[t+116>>2]|0;if(e|0){if(n[t+120>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+116>>2]=0}n[t+120>>0]=1;r[t+116>>2]=0;r[t+108>>2]=0;r[t+112>>2]=0;e=r[t+96>>2]|0;if(e|0){if(n[t+100>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+96>>2]=0}n[t+100>>0]=1;r[t+96>>2]=0;r[t+88>>2]=0;r[t+92>>2]=0;e=r[t+76>>2]|0;if(e|0){if(n[t+80>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+76>>2]=0}n[t+80>>0]=1;r[t+76>>2]=0;r[t+68>>2]=0;r[t+72>>2]=0;e=r[t+56>>2]|0;if(e|0){if(n[t+60>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+56>>2]=0}n[t+60>>0]=1;r[t+56>>2]=0;r[t+48>>2]=0;r[t+52>>2]=0;e=r[t+36>>2]|0;if(e|0){if(n[t+40>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+36>>2]=0}n[t+40>>0]=1;r[t+36>>2]=0;r[t+28>>2]=0;r[t+32>>2]=0;e=r[t+16>>2]|0;if(!e){n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;t=t+12|0;r[t>>2]=0;return}if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+16>>2]=0;n[t+20>>0]=1;r[t+16>>2]=0;r[t+8>>2]=0;t=t+12|0;r[t>>2]=0;return}function zD(t){t=t|0;VD(t);if(!t)return;r[5638]=(r[5638]|0)+1;Ql(r[t+-4>>2]|0);return}function WD(t,e,i,n,s,o,a,l,c,u){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;l=l|0;c=c|0;u=u|0;var d=0;d=_;_=_+16|0;j_(15521);+Dk[r[(r[t>>2]|0)+44>>2]&3](t,e,i,n,s,o,a,l,c);+Dk[r[(r[t>>2]|0)+48>>2]&3](t,e,i,n,s,o,a,l,c);+Bk[r[(r[t>>2]|0)+36>>2]&1](t,e,i,l);u=r[2006]|0;t=(r[u+16>>2]|0)+-1|0;r[u+16>>2]=t;if(t|0){_=d;return 0.0}do{if(r[u+4>>2]|0){de(d|0,0)|0;t=r[5649]|0;h[u+8>>2]=+h[u+8>>2]+ +(((r[d+4>>2]|0)-(r[t+4>>2]|0)+(((r[d>>2]|0)-(r[t>>2]|0)|0)*1e6|0)-(r[u+12>>2]|0)|0)>>>0)/1.0e3;if(!(r[u+16>>2]|0)){u=r[2006]|0;break}else{_=d;return 0.0}}}while(0);r[2006]=r[u+20>>2];_=d;return 0.0}function GD(t){t=t|0;r[t+200>>2]=0;return}function jD(t){t=t|0;return 1}function HD(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0;if((i|0)>0)s=0;else return;do{XD(t,r[e+(s<<2)>>2]|0,n);s=s+1|0}while((s|0)!=(i|0));return}function XD(t,e,i){t=t|0;e=e|0;i=i|0;var s=0,o=0,a=0,l=0.0,c=0.0,u=0,p=0.0,f=0,m=0,g=0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0,R=0.0,I=0.0,P=0,L=0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0.0,U=0,V=0,z=0,j=0,H=0,X=0,Y=0,q=0,K=0,Z=0,Q=0,$=0,J=0,tt=0,et=0,it=0.0,nt=0.0,st=0.0;et=_;_=_+80|0;Y=r[e+740>>2]|0;Z=r[e+744>>2]|0;Q=YD(t,Y,+h[i+12>>2])|0;$=YD(t,Z,+h[i+12>>2])|0;q=r[t+16>>2]|0;F=+h[q+(Q*244|0)+128>>2];B=+h[q+(Q*244|0)+132>>2];N=+h[q+(Q*244|0)+136>>2];if(F*F+B*B+N*N<1.4210854715202004e-14?(F=+h[q+($*244|0)+128>>2],B=+h[q+($*244|0)+132>>2],N=+h[q+($*244|0)+136>>2],F*F+B*B+N*N<1.4210854715202004e-14):0){_=et;return}if((r[e+748>>2]|0)<=0){_=et;return}J=0;s=1;do{H=e+4+(J*184|0)|0;M=e+4+(J*184|0)+80|0;if(+h[M>>2]<=+h[e+756>>2]){X=r[t+28>>2]|0;if((X|0)==(r[t+32>>2]|0)?(K=X|0?X<<1:1,(X|0)<(K|0)):0){if(!K){o=0;a=X}else{r[5637]=(r[5637]|0)+1;o=Zl((K*152|3)+16|0)|0;if(!o)o=0;else{r[(o+4+15&-16)+-4>>2]=o;o=o+4+15&-16}a=r[t+28>>2]|0}if((a|0)>0){u=0;do{Oh(o+(u*152|0)|0,(r[t+36>>2]|0)+(u*152|0)|0,152)|0;u=u+1|0}while((u|0)!=(a|0))}a=r[t+36>>2]|0;if(a|0){if(n[t+40>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[a+-4>>2]|0)}r[t+36>>2]=0}n[t+40>>0]=1;r[t+36>>2]=o;r[t+32>>2]=K;o=r[t+28>>2]|0}else o=X;r[t+28>>2]=o+1;j=r[t+36>>2]|0;P=(r[Y+236>>2]&2|0)==0?0:Y;L=(r[Z+236>>2]&2|0)==0?0:Z;r[j+(X*152|0)+144>>2]=Q;r[j+(X*152|0)+148>>2]=$;r[j+(X*152|0)+132>>2]=H;C=+h[e+4+(J*184|0)+48>>2]-+h[Y+52>>2];T=+h[e+4+(J*184|0)+52>>2]-+h[Y+56>>2];w=+h[e+4+(J*184|0)+56>>2]-+h[Y+60>>2];h[et+64>>2]=C;h[et+64+4>>2]=T;h[et+64+8>>2]=w;h[et+64+12>>2]=0.0;E=+h[e+4+(J*184|0)+32>>2]-+h[Z+52>>2];R=+h[e+4+(J*184|0)+36>>2]-+h[Z+56>>2];A=+h[e+4+(J*184|0)+40>>2]-+h[Z+60>>2];h[et+48>>2]=E;h[et+48+4>>2]=R;h[et+48+8>>2]=A;h[et+48+12>>2]=0.0;if(!(r[q+(Q*244|0)+240>>2]|0)){o=0;u=0;m=0}else{B=+h[q+(Q*244|0)+192>>2]+ +h[q+(Q*244|0)+224>>2];N=+h[q+(Q*244|0)+196>>2]+ +h[q+(Q*244|0)+228>>2];F=+h[q+(Q*244|0)+200>>2]+ +h[q+(Q*244|0)+232>>2];o=(h[d>>2]=+h[q+(Q*244|0)+176>>2]+ +h[q+(Q*244|0)+208>>2]+(N*w-F*T),r[d>>2]|0);u=(h[d>>2]=+h[q+(Q*244|0)+180>>2]+ +h[q+(Q*244|0)+212>>2]+(F*C-B*w),r[d>>2]|0);m=(h[d>>2]=+h[q+(Q*244|0)+184>>2]+ +h[q+(Q*244|0)+216>>2]+(B*T-N*C),r[d>>2]|0)}if(!(r[q+($*244|0)+240>>2]|0)){a=0;f=0;g=0}else{B=+h[q+($*244|0)+192>>2]+ +h[q+($*244|0)+224>>2];N=+h[q+($*244|0)+196>>2]+ +h[q+($*244|0)+228>>2];F=+h[q+($*244|0)+200>>2]+ +h[q+($*244|0)+232>>2];a=(h[d>>2]=+h[q+($*244|0)+176>>2]+ +h[q+($*244|0)+208>>2]+(N*A-F*R),r[d>>2]|0);f=(h[d>>2]=+h[q+($*244|0)+180>>2]+ +h[q+($*244|0)+212>>2]+(F*E-B*A),r[d>>2]|0);g=(h[d>>2]=+h[q+($*244|0)+184>>2]+ +h[q+($*244|0)+216>>2]+(B*R-N*E),r[d>>2]|0)}N=(r[d>>2]=o,+h[d>>2]);N=N-(r[d>>2]=a,+h[d>>2]);B=(r[d>>2]=u,+h[d>>2]);B=B-(r[d>>2]=f,+h[d>>2]);D=(r[d>>2]=m,+h[d>>2]);D=D-(r[d>>2]=g,+h[d>>2]);U=e+4+(J*184|0)+64|0;k=+h[U>>2];V=e+4+(J*184|0)+68|0;O=+h[V>>2];z=e+4+(J*184|0)+72|0;F=+h[z>>2];g=r[t+16>>2]|0;f=r[g+(Q*244|0)+240>>2]|0;m=r[g+($*244|0)+240>>2]|0;if(f|0){u=(h[d>>2]=((T*F-w*O)*+h[f+288>>2]+(w*k-F*C)*+h[f+292>>2]+(O*C-T*k)*+h[f+296>>2])*+h[f+568>>2],r[d>>2]|0);o=(h[d>>2]=((T*F-w*O)*+h[f+304>>2]+(w*k-F*C)*+h[f+308>>2]+(O*C-T*k)*+h[f+312>>2])*+h[f+572>>2],r[d>>2]|0);a=(h[d>>2]=((T*F-w*O)*+h[f+320>>2]+(w*k-F*C)*+h[f+324>>2]+(O*C-T*k)*+h[f+328>>2])*+h[f+576>>2],r[d>>2]|0)}else{u=0;o=0;a=0}r[j+(X*152|0)+64>>2]=u;r[j+(X*152|0)+68>>2]=o;r[j+(X*152|0)+72>>2]=a;h[j+(X*152|0)+76>>2]=0.0;v=+h[z>>2];S=+h[V>>2];x=+h[U>>2];y=(r[d>>2]=o,+h[d>>2]);b=(r[d>>2]=a,+h[d>>2]);c=(r[d>>2]=u,+h[d>>2]);if(m|0){o=(h[d>>2]=(+h[m+288>>2]*-(R*v-A*S)+ +h[m+292>>2]*-(A*x-v*E)+ +h[m+296>>2]*-(S*E-R*x))*+h[m+568>>2],r[d>>2]|0);a=(h[d>>2]=(+h[m+304>>2]*-(R*v-A*S)+ +h[m+308>>2]*-(A*x-v*E)+ +h[m+312>>2]*-(S*E-R*x))*+h[m+572>>2],r[d>>2]|0);u=(h[d>>2]=(+h[m+320>>2]*-(R*v-A*S)+ +h[m+324>>2]*-(A*x-v*E)+ +h[m+328>>2]*-(S*E-R*x))*+h[m+576>>2],r[d>>2]|0)}else{o=0;a=0;u=0}r[j+(X*152|0)+80>>2]=o;r[j+(X*152|0)+84>>2]=a;r[j+(X*152|0)+88>>2]=u;h[j+(X*152|0)+92>>2]=0.0;p=(r[d>>2]=o,+h[d>>2]);l=(r[d>>2]=a,+h[d>>2]);if(f|0)c=+h[f+368>>2]+((y*w-b*T)*+h[U>>2]+(b*C-w*c)*+h[V>>2]+(T*c-y*C)*+h[z>>2]);else c=0.0;if(m|0){I=-(r[d>>2]=u,+h[d>>2]);l=+h[m+368>>2]+((A*-l-R*I)*+h[U>>2]+(E*I-A*-p)*+h[V>>2]+(R*-p-E*-l)*+h[z>>2])}else l=0.0;h[j+(X*152|0)+108>>2]=1.0/(c+l);if(f|0){r[j+(X*152|0)+16>>2]=r[U>>2];r[j+(X*152|0)+16+4>>2]=r[U+4>>2];r[j+(X*152|0)+16+8>>2]=r[U+8>>2];r[j+(X*152|0)+16+12>>2]=r[U+12>>2];h[j+(X*152|0)>>2]=T*F-w*O;h[j+(X*152|0)+4>>2]=w*k-F*C;h[j+(X*152|0)+8>>2]=O*C-T*k;h[j+(X*152|0)+12>>2]=0.0}else{r[j+(X*152|0)>>2]=0;r[j+(X*152|0)+4>>2]=0;r[j+(X*152|0)+8>>2]=0;r[j+(X*152|0)+12>>2]=0;r[j+(X*152|0)+16>>2]=0;r[j+(X*152|0)+20>>2]=0;r[j+(X*152|0)+24>>2]=0;r[j+(X*152|0)+28>>2]=0}if(m|0){y=-+h[V>>2];I=-+h[z>>2];h[j+(X*152|0)+48>>2]=-+h[U>>2];h[j+(X*152|0)+52>>2]=y;h[j+(X*152|0)+56>>2]=I;h[j+(X*152|0)+60>>2]=0.0;h[j+(X*152|0)+32>>2]=-(R*v-A*S);h[j+(X*152|0)+36>>2]=-(A*x-v*E);h[j+(X*152|0)+40>>2]=-(S*E-R*x);h[j+(X*152|0)+44>>2]=0.0}else{r[j+(X*152|0)+32>>2]=0;r[j+(X*152|0)+32+4>>2]=0;r[j+(X*152|0)+32+8>>2]=0;r[j+(X*152|0)+32+12>>2]=0;r[j+(X*152|0)+32+16>>2]=0;r[j+(X*152|0)+32+20>>2]=0;r[j+(X*152|0)+32+24>>2]=0;r[j+(X*152|0)+32+28>>2]=0}I=+h[M>>2]+ +h[i+56>>2];if(f|0){b=+h[f+356>>2];y=+h[f+360>>2];x=+h[f+352>>2];v=b*w-y*T+ +h[f+336>>2];y=+h[f+340>>2]+(y*C-w*x);b=T*x-b*C+ +h[f+344>>2]}else{v=0.0;y=0.0;b=0.0}if(m|0){l=+h[m+356>>2];c=+h[m+360>>2];T=+h[m+352>>2];p=l*A-c*R+ +h[m+336>>2];c=+h[m+340>>2]+(c*E-A*T);l=R*T-l*E+ +h[m+344>>2]}else{p=0.0;c=0.0;l=0.0}E=(v-p)*+h[U>>2]+(y-c)*+h[V>>2]+(b-l)*+h[z>>2];r[j+(X*152|0)+104>>2]=r[e+4+(J*184|0)+84>>2];E=-(E*+h[e+4+(J*184|0)+92>>2]);E=E<=0.0?0.0:E;do{if(r[i+64>>2]&4){l=+h[e+4+(J*184|0)+120>>2]*+h[i+60>>2];h[j+(X*152|0)+100>>2]=l;do{if(f|0){if(!(r[g+(Q*244|0)+240>>2]|0))break;R=l*(+h[j+(X*152|0)+20>>2]*+h[g+(Q*244|0)+132>>2]*+h[f+376>>2])*+h[g+(Q*244|0)+116>>2];A=l*(+h[j+(X*152|0)+24>>2]*+h[g+(Q*244|0)+136>>2]*+h[f+380>>2])*+h[g+(Q*244|0)+120>>2];h[g+(Q*244|0)+64>>2]=+h[g+(Q*244|0)+112>>2]*(l*(+h[j+(X*152|0)+16>>2]*+h[g+(Q*244|0)+128>>2]*+h[f+372>>2]))+ +h[g+(Q*244|0)+64>>2];h[g+(Q*244|0)+68>>2]=R+ +h[g+(Q*244|0)+68>>2];h[g+(Q*244|0)+72>>2]=A+ +h[g+(Q*244|0)+72>>2];A=l*+h[g+(Q*244|0)+100>>2]*+h[j+(X*152|0)+68>>2];R=l*+h[g+(Q*244|0)+104>>2]*+h[j+(X*152|0)+72>>2];h[g+(Q*244|0)+80>>2]=l*+h[g+(Q*244|0)+96>>2]*+h[j+(X*152|0)+64>>2]+ +h[g+(Q*244|0)+80>>2];h[g+(Q*244|0)+84>>2]=A+ +h[g+(Q*244|0)+84>>2];h[g+(Q*244|0)+88>>2]=R+ +h[g+(Q*244|0)+88>>2]}}while(0);if(m|0){l=+h[j+(X*152|0)+100>>2];if(!(r[g+($*244|0)+240>>2]|0))break;R=+h[j+(X*152|0)+88>>2];A=+h[j+(X*152|0)+84>>2];T=+h[j+(X*152|0)+80>>2];w=l*(+h[j+(X*152|0)+52>>2]*+h[g+($*244|0)+132>>2]*+h[m+376>>2])*+h[g+($*244|0)+116>>2];C=l*(+h[j+(X*152|0)+56>>2]*+h[g+($*244|0)+136>>2]*+h[m+380>>2])*+h[g+($*244|0)+120>>2];h[g+($*244|0)+64>>2]=+h[g+($*244|0)+112>>2]*(l*(+h[j+(X*152|0)+48>>2]*+h[g+($*244|0)+128>>2]*+h[m+372>>2]))+ +h[g+($*244|0)+64>>2];h[g+($*244|0)+68>>2]=w+ +h[g+($*244|0)+68>>2];h[g+($*244|0)+72>>2]=C+ +h[g+($*244|0)+72>>2];A=A*(+h[g+($*244|0)+100>>2]*-l);R=R*(+h[g+($*244|0)+104>>2]*-l);h[g+($*244|0)+80>>2]=+h[g+($*244|0)+80>>2]-T*(+h[g+($*244|0)+96>>2]*-l);h[g+($*244|0)+84>>2]=+h[g+($*244|0)+84>>2]-A;h[g+($*244|0)+88>>2]=+h[g+($*244|0)+88>>2]-R}}else h[j+(X*152|0)+100>>2]=0.0}while(0);h[j+(X*152|0)+96>>2]=0.0;if(!(r[g+(Q*244|0)+240>>2]|0)){l=0.0;c=0.0;p=0.0;S=0.0;x=0.0;w=0.0}else{l=+h[g+(Q*244|0)+208>>2];c=+h[g+(Q*244|0)+212>>2];p=+h[g+(Q*244|0)+216>>2];S=+h[g+(Q*244|0)+224>>2];x=+h[g+(Q*244|0)+228>>2];w=+h[g+(Q*244|0)+232>>2]}if(!(r[g+($*244|0)+240>>2]|0)){b=0.0;y=0.0;v=0.0;C=0.0;T=0.0;A=0.0}else{b=+h[g+($*244|0)+208>>2];y=+h[g+($*244|0)+212>>2];v=+h[g+($*244|0)+216>>2];C=+h[g+($*244|0)+224>>2];T=+h[g+($*244|0)+228>>2];A=+h[g+($*244|0)+232>>2]}l=E-((l+ +h[g+(Q*244|0)+176>>2])*+h[j+(X*152|0)+16>>2]+(c+ +h[g+(Q*244|0)+180>>2])*+h[j+(X*152|0)+20>>2]+(p+ +h[g+(Q*244|0)+184>>2])*+h[j+(X*152|0)+24>>2]+((S+ +h[g+(Q*244|0)+192>>2])*+h[j+(X*152|0)>>2]+(x+ +h[g+(Q*244|0)+196>>2])*+h[j+(X*152|0)+4>>2]+(w+ +h[g+(Q*244|0)+200>>2])*+h[j+(X*152|0)+8>>2])+((b+ +h[g+($*244|0)+176>>2])*+h[j+(X*152|0)+48>>2]+(y+ +h[g+($*244|0)+180>>2])*+h[j+(X*152|0)+52>>2]+(v+ +h[g+($*244|0)+184>>2])*+h[j+(X*152|0)+56>>2]+((C+ +h[g+($*244|0)+192>>2])*+h[j+(X*152|0)+32>>2]+(T+ +h[g+($*244|0)+196>>2])*+h[j+(X*152|0)+36>>2]+(A+ +h[g+($*244|0)+200>>2])*+h[j+(X*152|0)+40>>2])));o=(r[i+44>>2]|0)==0;c=+h[i+12>>2];if(I>0.0){p=0.0;l=l-I/c}else p=-(I*+h[(o|I>+h[i+48>>2]?i+32|0:i+36|0)>>2])/c;R=+h[j+(X*152|0)+108>>2];c=p*R;l=l*R;if(o|I>+h[i+48>>2]){h[j+(X*152|0)+112>>2]=c+l;h[j+(X*152|0)+128>>2]=0.0}else{h[j+(X*152|0)+112>>2]=l;h[j+(X*152|0)+128>>2]=c}h[j+(X*152|0)+116>>2]=0.0;h[j+(X*152|0)+120>>2]=0.0;h[j+(X*152|0)+124>>2]=1.0e10;r[j+(X*152|0)+140>>2]=r[t+68>>2];if(!P){a=0;m=0;g=0}else{a=r[P+352>>2]|0;m=r[P+356>>2]|0;g=r[P+360>>2]|0}if(!L){o=0;u=0;f=0}else{o=r[L+352>>2]|0;u=r[L+356>>2]|0;f=r[L+360>>2]|0}p=(r[d>>2]=o,+h[d>>2]);p=p-(r[d>>2]=a,+h[d>>2]);c=(r[d>>2]=u,+h[d>>2]);c=c-(r[d>>2]=m,+h[d>>2]);b=(r[d>>2]=f,+h[d>>2]);b=b-(r[d>>2]=g,+h[d>>2]);h[et+32>>2]=p;h[et+32+4>>2]=c;h[et+32+8>>2]=b;h[et+32+12>>2]=0.0;do{if((s|0)>0?+h[e+4+(J*184|0)+88>>2]>0.0:0){s=s+-1|0;l=+G(+(p*p+c*c+b*b));if(l>+h[i+80>>2]){p=p*(1.0/l);h[et+32>>2]=p;c=c*(1.0/l);h[et+32+4>>2]=c;l=b*(1.0/l);h[et+32+8>>2]=l;do{if(Y){if(!(r[Y+180>>2]&2))break;y=+h[Y+4>>2];x=+h[Y+20>>2];T=+h[Y+36>>2];v=+h[Y+8>>2];w=+h[Y+24>>2];E=+h[Y+40>>2];S=+h[Y+12>>2];C=+h[Y+28>>2];I=+h[Y+44>>2];A=(y*p+x*c+l*T)*+h[Y+164>>2];R=(p*v+c*w+l*E)*+h[Y+168>>2];l=(p*S+c*C+l*I)*+h[Y+172>>2];h[et+32>>2]=y*A+v*R+S*l;h[et+32+4>>2]=x*A+w*R+C*l;h[et+32+8>>2]=T*A+E*R+I*l;h[et+32+12>>2]=0.0;p=y*A+v*R+S*l;c=x*A+w*R+C*l;l=T*A+E*R+I*l}}while(0);do{if(Z){if(!(r[Z+180>>2]&2))break;x=+h[Z+4>>2];T=+h[Z+20>>2];y=+h[Z+36>>2];w=+h[Z+8>>2];E=+h[Z+24>>2];v=+h[Z+40>>2];C=+h[Z+12>>2];I=+h[Z+28>>2];S=+h[Z+44>>2];A=(x*p+T*c+y*l)*+h[Z+164>>2];R=(p*w+c*E+l*v)*+h[Z+168>>2];c=(p*C+c*I+l*S)*+h[Z+172>>2];h[et+32>>2]=x*A+w*R+C*c;h[et+32+4>>2]=T*A+E*R+I*c;h[et+32+8>>2]=y*A+v*R+S*c;h[et+32+12>>2]=0.0;l=y*A+v*R+S*c;p=x*A+w*R+C*c;c=T*A+E*R+I*c}}while(0);if(!(+G(+(p*p+c*c+l*l))>.001))break;ZD(t,et+32|0,Q,$,X,H);break}ZD(t,U,Q,$,X,H);l=+h[z>>2];if(+W(+l)>.7071067690849304){I=+h[V>>2];R=1.0/+G(+(l*l+I*I));h[et+16>>2]=0.0;h[et+16+4>>2]=-(R*l);h[et+16+8>>2]=R*I;h[et>>2]=(l*l+I*I)*R;p=+h[U>>2];h[et+4>>2]=-(R*I*p);S=p*-(R*l);c=0.0;b=-(R*l);v=R*I;y=(l*l+I*I)*R;p=-(R*I*p)}else{y=+h[U>>2];I=+h[V>>2];p=1.0/+G(+(y*y+I*I));h[et+16>>2]=-(I*p);h[et+16+4>>2]=p*y;h[et+16+8>>2]=0.0;h[et>>2]=-(p*y*l);h[et+4>>2]=l*-(I*p);S=(y*y+I*I)*p;c=-(I*p);b=p*y;v=0.0;y=-(p*y*l);p=l*-(I*p)}h[et+8>>2]=S;do{if(!Y)l=v;else{if(!(r[Y+180>>2]&2)){l=v;break}st=+h[Y+4>>2];x=+h[Y+20>>2];T=+h[Y+36>>2];nt=+h[Y+8>>2];w=+h[Y+24>>2];E=+h[Y+40>>2];it=+h[Y+12>>2];C=+h[Y+28>>2];I=+h[Y+44>>2];A=(st*c+x*b+T*v)*+h[Y+164>>2];R=(c*nt+b*w+v*E)*+h[Y+168>>2];l=(c*it+b*C+v*I)*+h[Y+172>>2];h[et+16>>2]=st*A+nt*R+it*l;h[et+16+4>>2]=x*A+w*R+C*l;h[et+16+8>>2]=T*A+E*R+I*l;h[et+16+12>>2]=0.0;c=st*A+nt*R+it*l;b=x*A+w*R+C*l;l=T*A+E*R+I*l}}while(0);do{if(!Z)v=l;else{if(!(r[Z+180>>2]&2)){v=l;break}x=+h[Z+4>>2];T=+h[Z+20>>2];R=+h[Z+36>>2];w=+h[Z+8>>2];A=+h[Z+24>>2];it=+h[Z+40>>2];C=+h[Z+12>>2];E=+h[Z+28>>2];st=+h[Z+44>>2];I=(x*c+T*b+R*l)*+h[Z+164>>2];nt=(c*w+b*A+l*it)*+h[Z+168>>2];v=(c*C+b*E+l*st)*+h[Z+172>>2];h[et+16>>2]=x*I+w*nt+C*v;h[et+16+4>>2]=T*I+A*nt+E*v;h[et+16+8>>2]=R*I+it*nt+st*v;h[et+16+12>>2]=0.0;c=x*I+w*nt+C*v;b=T*I+A*nt+E*v;v=R*I+it*nt+st*v}}while(0);do{if(!Y)l=S;else{if(!(r[Y+180>>2]&2)){l=S;break}x=+h[Y+4>>2];T=+h[Y+20>>2];R=+h[Y+36>>2];w=+h[Y+8>>2];A=+h[Y+24>>2];it=+h[Y+40>>2];C=+h[Y+12>>2];E=+h[Y+28>>2];st=+h[Y+44>>2];I=(x*y+T*p+R*S)*+h[Y+164>>2];nt=(y*w+p*A+S*it)*+h[Y+168>>2];l=(y*C+p*E+S*st)*+h[Y+172>>2];h[et>>2]=x*I+w*nt+C*l;h[et+4>>2]=T*I+A*nt+E*l;h[et+8>>2]=R*I+it*nt+st*l;h[et+12>>2]=0.0;y=x*I+w*nt+C*l;p=T*I+A*nt+E*l;l=R*I+it*nt+st*l}}while(0);do{if(Z){if(!(r[Z+180>>2]&2))break;x=+h[Z+4>>2];T=+h[Z+20>>2];R=+h[Z+36>>2];w=+h[Z+8>>2];A=+h[Z+24>>2];it=+h[Z+40>>2];C=+h[Z+12>>2];E=+h[Z+28>>2];st=+h[Z+44>>2];I=(x*y+T*p+R*l)*+h[Z+164>>2];nt=(y*w+p*A+l*it)*+h[Z+168>>2];l=(y*C+p*E+l*st)*+h[Z+172>>2];h[et>>2]=x*I+w*nt+C*l;h[et+4>>2]=T*I+A*nt+E*l;h[et+8>>2]=R*I+it*nt+st*l;h[et+12>>2]=0.0;y=x*I+w*nt+C*l;p=T*I+A*nt+E*l;l=R*I+it*nt+st*l}}while(0);if(+G(+(c*c+b*b+v*v))>.001)ZD(t,et+16|0,Q,$,X,H);if(+G(+(y*y+p*p+l*l))>.001)ZD(t,et,Q,$,X,H)}}while(0);do{if(!(r[i+64>>2]&32))tt=95;else{if(!(n[e+4+(J*184|0)+116>>0]|0)){tt=95;break}QD(t,e+4+(J*184|0)+152|0,Q,$,X,H,et+64|0,et+48|0,1.0,+h[e+4+(J*184|0)+132>>2],+h[e+4+(J*184|0)+140>>2]);if(!(r[i+64>>2]&16))break;QD(t,e+4+(J*184|0)+168|0,Q,$,X,H,et+64|0,et+48|0,1.0,+h[e+4+(J*184|0)+136>>2],+h[e+4+(J*184|0)+144>>2])}}while(0);do{if((tt|0)==95){tt=0;M=e+4+(J*184|0)+152|0;l=+h[U>>2];x=+h[V>>2];S=+h[z>>2];c=N-(N*k+B*O+D*F)*l;y=B-(N*k+B*O+D*F)*x;b=D-(N*k+B*O+D*F)*S;h[e+4+(J*184|0)+152>>2]=c;m=e+4+(J*184|0)+156|0;h[m>>2]=y;g=e+4+(J*184|0)+160|0;h[g>>2]=b;o=e+4+(J*184|0)+164|0;h[o>>2]=0.0;if((r[i+64>>2]&64|0)==0?c*c+y*y+b*b>1.1920928955078125e-07:0){l=1.0/+G(+(c*c+y*y+b*b));h[M>>2]=c*l;h[m>>2]=l*y;h[g>>2]=l*b;do{if(!Y){p=c*l;c=l*y;l=l*b}else{if(!(r[Y+180>>2]&1)){p=c*l;c=l*y;l=l*b;break}I=+h[Y+4>>2];k=+h[Y+20>>2];B=+h[Y+36>>2];D=+h[Y+8>>2];O=+h[Y+24>>2];it=+h[Y+40>>2];p=+h[Y+12>>2];F=+h[Y+28>>2];st=+h[Y+44>>2];N=(I*(c*l)+k*(l*y)+l*b*B)*+h[Y+164>>2];nt=(c*l*D+l*y*O+l*b*it)*+h[Y+168>>2];l=(c*l*p+l*y*F+l*b*st)*+h[Y+172>>2];h[M>>2]=I*N+D*nt+p*l;h[m>>2]=k*N+O*nt+F*l;h[g>>2]=B*N+it*nt+st*l;h[o>>2]=0.0;p=I*N+D*nt+p*l;c=k*N+O*nt+F*l;l=B*N+it*nt+st*l}}while(0);do{if(Z|0){if(!(r[Z+180>>2]&1))break;E=+h[Z+4>>2];D=+h[Z+20>>2];F=+h[Z+36>>2];R=+h[Z+8>>2];k=+h[Z+24>>2];N=+h[Z+40>>2];I=+h[Z+12>>2];O=+h[Z+28>>2];nt=+h[Z+44>>2];B=(E*p+D*c+F*l)*+h[Z+164>>2];it=(p*R+c*k+l*N)*+h[Z+168>>2];st=(p*I+c*O+l*nt)*+h[Z+172>>2];h[M>>2]=E*B+R*it+I*st;h[m>>2]=D*B+k*it+O*st;h[g>>2]=F*B+N*it+nt*st;h[o>>2]=0.0}}while(0);QD(t,M,Q,$,X,H,et+64|0,et+48|0,1.0,0.0,0.0);if(!(r[i+64>>2]&16))break;f=e+4+(J*184|0)+168|0;nt=+h[m>>2];p=+h[z>>2];B=+h[g>>2];N=+h[V>>2];st=+h[U>>2];it=+h[M>>2];h[e+4+(J*184|0)+168>>2]=nt*p-B*N;o=e+4+(J*184|0)+172|0;a=e+4+(J*184|0)+176|0;u=e+4+(J*184|0)+180|0;h[u>>2]=0.0;c=1.0/+G(+((nt*p-B*N)*(nt*p-B*N)+(B*st-p*it)*(B*st-p*it)+(N*it-nt*st)*(N*it-nt*st)));l=(nt*p-B*N)*c;h[f>>2]=l;p=(B*st-p*it)*c;h[o>>2]=p;c=(N*it-nt*st)*c;h[a>>2]=c;do{if(Y){if(!(r[Y+180>>2]&1))break;R=+h[Y+4>>2];k=+h[Y+20>>2];B=+h[Y+36>>2];I=+h[Y+8>>2];O=+h[Y+24>>2];it=+h[Y+40>>2];D=+h[Y+12>>2];F=+h[Y+28>>2];st=+h[Y+44>>2];N=(R*l+k*p+c*B)*+h[Y+164>>2];nt=(l*I+p*O+c*it)*+h[Y+168>>2];c=(l*D+p*F+c*st)*+h[Y+172>>2];h[f>>2]=R*N+I*nt+D*c;h[o>>2]=k*N+O*nt+F*c;h[a>>2]=B*N+it*nt+st*c;h[u>>2]=0.0;l=R*N+I*nt+D*c;p=k*N+O*nt+F*c;c=B*N+it*nt+st*c}}while(0);do{if(Z|0){if(!(r[Z+180>>2]&1))break;E=+h[Z+4>>2];D=+h[Z+20>>2];F=+h[Z+36>>2];R=+h[Z+8>>2];k=+h[Z+24>>2];N=+h[Z+40>>2];I=+h[Z+12>>2];O=+h[Z+28>>2];nt=+h[Z+44>>2];B=(E*l+D*p+F*c)*+h[Z+164>>2];it=(l*R+p*k+c*N)*+h[Z+168>>2];st=(l*I+p*O+c*nt)*+h[Z+172>>2];h[f>>2]=E*B+R*it+I*st;h[o>>2]=D*B+k*it+O*st;h[a>>2]=F*B+N*it+nt*st;h[u>>2]=0.0}}while(0);QD(t,f,Q,$,X,H,et+64|0,et+48|0,1.0,0.0,0.0);break}f=e+4+(J*184|0)+168|0;if(+W(+S)>.7071067690849304){st=1.0/+G(+(S*S+x*x));h[M>>2]=0.0;h[m>>2]=-(st*S);h[g>>2]=st*x;y=-(st*x*l);v=l*-(st*S);b=(S*S+x*x)*st;p=0.0;c=-(st*S);l=st*x}else{c=1.0/+G(+(l*l+x*x));h[M>>2]=-(x*c);h[m>>2]=c*l;h[g>>2]=0.0;y=S*-(x*c);v=(l*l+x*x)*c;b=-(c*l*S);p=-(x*c);c=c*l;l=0.0}h[f>>2]=b;u=e+4+(J*184|0)+172|0;h[u>>2]=y;a=e+4+(J*184|0)+176|0;h[a>>2]=v;do{if(Y){if(!(r[Y+180>>2]&1))break;R=+h[Y+4>>2];k=+h[Y+20>>2];B=+h[Y+36>>2];I=+h[Y+8>>2];O=+h[Y+24>>2];it=+h[Y+40>>2];D=+h[Y+12>>2];F=+h[Y+28>>2];st=+h[Y+44>>2];N=(R*p+k*c+B*l)*+h[Y+164>>2];nt=(p*I+c*O+l*it)*+h[Y+168>>2];l=(p*D+c*F+l*st)*+h[Y+172>>2];h[M>>2]=R*N+I*nt+D*l;h[m>>2]=k*N+O*nt+F*l;h[g>>2]=B*N+it*nt+st*l;h[o>>2]=0.0;p=R*N+I*nt+D*l;c=k*N+O*nt+F*l;l=B*N+it*nt+st*l}}while(0);do{if(Z|0){if(!(r[Z+180>>2]&1))break;E=+h[Z+4>>2];D=+h[Z+20>>2];F=+h[Z+36>>2];R=+h[Z+8>>2];k=+h[Z+24>>2];N=+h[Z+40>>2];I=+h[Z+12>>2];O=+h[Z+28>>2];nt=+h[Z+44>>2];B=(E*p+D*c+F*l)*+h[Z+164>>2];it=(p*R+c*k+l*N)*+h[Z+168>>2];st=(p*I+c*O+l*nt)*+h[Z+172>>2];h[M>>2]=E*B+R*it+I*st;h[m>>2]=D*B+k*it+O*st;h[g>>2]=F*B+N*it+nt*st;h[o>>2]=0.0}}while(0);QD(t,M,Q,$,X,H,et+64|0,et+48|0,1.0,0.0,0.0);o=r[i+64>>2]|0;if(o&16){do{if(Y|0){if(!(r[Y+180>>2]&1))break;E=+h[Y+4>>2];T=+h[f>>2];D=+h[Y+20>>2];A=+h[u>>2];F=+h[Y+36>>2];st=+h[a>>2];R=+h[Y+8>>2];k=+h[Y+24>>2];N=+h[Y+40>>2];I=+h[Y+12>>2];O=+h[Y+28>>2];nt=+h[Y+44>>2];B=(E*T+D*A+F*st)*+h[Y+164>>2];it=(T*R+A*k+st*N)*+h[Y+168>>2];st=(T*I+A*O+st*nt)*+h[Y+172>>2];h[f>>2]=E*B+R*it+I*st;h[u>>2]=D*B+k*it+O*st;h[a>>2]=F*B+N*it+nt*st;h[e+4+(J*184|0)+180>>2]=0.0}}while(0);do{if(Z|0){if(!(r[Z+180>>2]&1))break;E=+h[Z+4>>2];T=+h[f>>2];D=+h[Z+20>>2];A=+h[u>>2];F=+h[Z+36>>2];st=+h[a>>2];R=+h[Z+8>>2];k=+h[Z+24>>2];N=+h[Z+40>>2];I=+h[Z+12>>2];O=+h[Z+28>>2];nt=+h[Z+44>>2];B=(E*T+D*A+F*st)*+h[Z+164>>2];it=(T*R+A*k+st*N)*+h[Z+168>>2];st=(T*I+A*O+st*nt)*+h[Z+172>>2];h[f>>2]=E*B+R*it+I*st;h[u>>2]=D*B+k*it+O*st;h[a>>2]=F*B+N*it+nt*st;h[e+4+(J*184|0)+180>>2]=0.0}}while(0);QD(t,f,Q,$,X,H,et+64|0,et+48|0,1.0,0.0,0.0);o=r[i+64>>2]|0}if((o&80|0)!=80)break;n[e+4+(J*184|0)+116>>0]=1}}while(0);g=r[t+16>>2]|0;a=r[g+(Q*244|0)+240>>2]|0;u=r[g+($*244|0)+240>>2]|0;f=r[j+(X*152|0)+140>>2]|0;m=r[t+76>>2]|0;o=r[i+64>>2]|0;do{if(!(o&4))h[m+(f*152|0)+100>>2]=0.0;else{l=+h[e+4+(J*184|0)+124>>2]*+h[i+60>>2];h[m+(f*152|0)+100>>2]=l;if(a|0){it=+h[a+368>>2];st=l*(it*+h[m+(f*152|0)+20>>2]*+h[a+376>>2])*+h[g+(Q*244|0)+116>>2];nt=l*(it*+h[m+(f*152|0)+24>>2]*+h[a+380>>2])*+h[g+(Q*244|0)+120>>2];h[g+(Q*244|0)+64>>2]=+h[g+(Q*244|0)+112>>2]*(l*(it*+h[m+(f*152|0)+16>>2]*+h[a+372>>2]))+ +h[g+(Q*244|0)+64>>2];h[g+(Q*244|0)+68>>2]=st+ +h[g+(Q*244|0)+68>>2];h[g+(Q*244|0)+72>>2]=nt+ +h[g+(Q*244|0)+72>>2];nt=l*+h[g+(Q*244|0)+100>>2]*+h[m+(f*152|0)+68>>2];st=l*+h[g+(Q*244|0)+104>>2]*+h[m+(f*152|0)+72>>2];h[g+(Q*244|0)+80>>2]=l*+h[g+(Q*244|0)+96>>2]*+h[m+(f*152|0)+64>>2]+ +h[g+(Q*244|0)+80>>2];h[g+(Q*244|0)+84>>2]=nt+ +h[g+(Q*244|0)+84>>2];h[g+(Q*244|0)+88>>2]=st+ +h[g+(Q*244|0)+88>>2]}if(!u)break;l=+h[u+368>>2];c=+h[m+(f*152|0)+100>>2];if(!(r[g+($*244|0)+240>>2]|0))break;st=+h[m+(f*152|0)+88>>2];nt=+h[m+(f*152|0)+84>>2];it=+h[m+(f*152|0)+80>>2];B=c*(l*+h[m+(f*152|0)+52>>2]*+h[u+376>>2])*+h[g+($*244|0)+116>>2];N=c*(l*+h[m+(f*152|0)+56>>2]*+h[u+380>>2])*+h[g+($*244|0)+120>>2];h[g+($*244|0)+64>>2]=+h[g+($*244|0)+112>>2]*(c*(l*+h[m+(f*152|0)+48>>2]*+h[u+372>>2]))+ +h[g+($*244|0)+64>>2];h[g+($*244|0)+68>>2]=B+ +h[g+($*244|0)+68>>2];h[g+($*244|0)+72>>2]=N+ +h[g+($*244|0)+72>>2];nt=nt*(+h[g+($*244|0)+100>>2]*-c);st=st*(+h[g+($*244|0)+104>>2]*-c);h[g+($*244|0)+80>>2]=+h[g+($*244|0)+80>>2]-it*(+h[g+($*244|0)+96>>2]*-c);h[g+($*244|0)+84>>2]=+h[g+($*244|0)+84>>2]-nt;h[g+($*244|0)+88>>2]=+h[g+($*244|0)+88>>2]-st}}while(0);do{if(o&16|0){if(!(o&4)){h[m+((f+1|0)*152|0)+100>>2]=0.0;break}c=+h[e+4+(J*184|0)+128>>2]*+h[i+60>>2];h[m+((f+1|0)*152|0)+100>>2]=c;do{if(a|0){l=+h[a+368>>2];if(!(r[g+(Q*244|0)+240>>2]|0))break;st=c*(l*+h[m+((f+1|0)*152|0)+20>>2])*+h[g+(Q*244|0)+116>>2];nt=c*(l*+h[m+((f+1|0)*152|0)+24>>2])*+h[g+(Q*244|0)+120>>2];h[g+(Q*244|0)+64>>2]=+h[g+(Q*244|0)+112>>2]*(c*(l*+h[m+((f+1|0)*152|0)+16>>2]))+ +h[g+(Q*244|0)+64>>2];h[g+(Q*244|0)+68>>2]=st+ +h[g+(Q*244|0)+68>>2];h[g+(Q*244|0)+72>>2]=nt+ +h[g+(Q*244|0)+72>>2];nt=c*+h[g+(Q*244|0)+100>>2]*+h[m+((f+1|0)*152|0)+68>>2];st=c*+h[g+(Q*244|0)+104>>2]*+h[m+((f+1|0)*152|0)+72>>2];h[g+(Q*244|0)+80>>2]=c*+h[g+(Q*244|0)+96>>2]*+h[m+((f+1|0)*152|0)+64>>2]+ +h[g+(Q*244|0)+80>>2];h[g+(Q*244|0)+84>>2]=nt+ +h[g+(Q*244|0)+84>>2];h[g+(Q*244|0)+88>>2]=st+ +h[g+(Q*244|0)+88>>2]}}while(0);if(!u)break;l=+h[u+368>>2];c=+h[m+((f+1|0)*152|0)+100>>2];if(!(r[g+($*244|0)+240>>2]|0))break;st=+h[m+((f+1|0)*152|0)+88>>2];nt=+h[m+((f+1|0)*152|0)+84>>2];it=+h[m+((f+1|0)*152|0)+80>>2];B=c*(l*+h[m+((f+1|0)*152|0)+52>>2])*+h[g+($*244|0)+116>>2];N=c*(l*+h[m+((f+1|0)*152|0)+56>>2])*+h[g+($*244|0)+120>>2];h[g+($*244|0)+64>>2]=+h[g+($*244|0)+112>>2]*(c*(l*+h[m+((f+1|0)*152|0)+48>>2]))+ +h[g+($*244|0)+64>>2];h[g+($*244|0)+68>>2]=B+ +h[g+($*244|0)+68>>2];h[g+($*244|0)+72>>2]=N+ +h[g+($*244|0)+72>>2];nt=nt*(+h[g+($*244|0)+100>>2]*-c);st=st*(+h[g+($*244|0)+104>>2]*-c);h[g+($*244|0)+80>>2]=+h[g+($*244|0)+80>>2]-it*(+h[g+($*244|0)+96>>2]*-c);h[g+($*244|0)+84>>2]=+h[g+($*244|0)+84>>2]-nt;h[g+($*244|0)+88>>2]=+h[g+($*244|0)+88>>2]-st}}while(0)}J=J+1|0}while((J|0)<(r[e+748>>2]|0));_=et;return}function YD(t,e,i){t=t|0;e=e|0;i=+i;var n=0,s=0,o=0;s=_;_=_+496|0;n=r[e+212>>2]|0;if((n|0)>-1){t=n;_=s;return t|0}o=(r[e+236>>2]&2|0)==0;n=o?0:e;do{if(!o){if(!(+h[n+368>>2]!=0.0)?(r[n+204>>2]&2|0)==0:0)break;o=r[t+8>>2]|0;Ph(s+244|0,0,244)|0;KD(qD(t+4|0,s+244|0)|0,e,i);r[e+212>>2]=o;_=s;return o|0}}while(0);n=r[t+188>>2]|0;if((n|0)>=0){o=n;_=s;return o|0}r[t+188>>2]=r[t+8>>2];Ph(s|0,0,244)|0;KD(qD(t+4|0,s)|0,0,i);o=r[t+188>>2]|0;_=s;return o|0}function qD(t,e){t=t|0;e=e|0;var i=0,s=0,o=0,a=0,l=0,h=0,c=0,_=0;l=r[t+4>>2]|0;if((l|0)==(r[t+8>>2]|0)?(a=l|0?l<<1:1,(l|0)<(a|0)):0){if(!a){i=0;s=l}else{r[5637]=(r[5637]|0)+1;i=Zl((a*244|3)+16|0)|0;if(!i)i=0;else{r[(i+4+15&-16)+-4>>2]=i;i=i+4+15&-16}s=r[t+4>>2]|0}if((s|0)>0){o=0;do{c=i+(o*244|0)|0;h=r[t+12>>2]|0;_=h+(o*244|0)|0;r[c>>2]=r[_>>2];r[c+4>>2]=r[_+4>>2];r[c+8>>2]=r[_+8>>2];r[c+12>>2]=r[_+12>>2];c=i+(o*244|0)+16|0;_=h+(o*244|0)+16|0;r[c>>2]=r[_>>2];r[c+4>>2]=r[_+4>>2];r[c+8>>2]=r[_+8>>2];r[c+12>>2]=r[_+12>>2];c=i+(o*244|0)+32|0;_=h+(o*244|0)+32|0;r[c>>2]=r[_>>2];r[c+4>>2]=r[_+4>>2];r[c+8>>2]=r[_+8>>2];r[c+12>>2]=r[_+12>>2];c=i+(o*244|0)+48|0;_=h+(o*244|0)+48|0;r[c>>2]=r[_>>2];r[c+4>>2]=r[_+4>>2];r[c+8>>2]=r[_+8>>2];r[c+12>>2]=r[_+12>>2];Oh(i+(o*244|0)+64|0,h+(o*244|0)+64|0,180)|0;o=o+1|0}while((o|0)!=(s|0))}s=r[t+12>>2]|0;if(s|0){if(n[t+16>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[s+-4>>2]|0)}r[t+12>>2]=0}n[t+16>>0]=1;r[t+12>>2]=i;r[t+8>>2]=a;i=r[t+4>>2]|0}else i=l;r[t+4>>2]=i+1;_=r[t+12>>2]|0;r[_+(l*244|0)>>2]=r[e>>2];r[_+(l*244|0)+4>>2]=r[e+4>>2];r[_+(l*244|0)+8>>2]=r[e+8>>2];r[_+(l*244|0)+12>>2]=r[e+12>>2];r[_+(l*244|0)+16>>2]=r[e+16>>2];r[_+(l*244|0)+16+4>>2]=r[e+16+4>>2];r[_+(l*244|0)+16+8>>2]=r[e+16+8>>2];r[_+(l*244|0)+16+12>>2]=r[e+16+12>>2];r[_+(l*244|0)+32>>2]=r[e+32>>2];r[_+(l*244|0)+32+4>>2]=r[e+32+4>>2];r[_+(l*244|0)+32+8>>2]=r[e+32+8>>2];r[_+(l*244|0)+32+12>>2]=r[e+32+12>>2];r[_+(l*244|0)+48>>2]=r[e+48>>2];r[_+(l*244|0)+48+4>>2]=r[e+48+4>>2];r[_+(l*244|0)+48+8>>2]=r[e+48+8>>2];r[_+(l*244|0)+48+12>>2]=r[e+48+12>>2];Oh(_+(l*244|0)+64|0,e+64|0,180)|0;return(r[t+12>>2]|0)+(l*244|0)|0}function KD(t,e,i){t=t|0;e=e|0;i=+i;var n=0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0,u=0;if(!e)e=0;else e=(r[e+236>>2]&2|0)==0?0:e;r[t+64>>2]=0;r[t+64+4>>2]=0;r[t+64+8>>2]=0;r[t+64+12>>2]=0;r[t+64+16>>2]=0;r[t+64+20>>2]=0;r[t+64+24>>2]=0;r[t+64+28>>2]=0;r[t+144>>2]=0;r[t+144+4>>2]=0;r[t+144+8>>2]=0;r[t+144+12>>2]=0;r[t+144+16>>2]=0;r[t+144+20>>2]=0;r[t+144+24>>2]=0;r[t+144+28>>2]=0;if(!e){r[t>>2]=1065353216;r[t+4>>2]=0;r[t+4+4>>2]=0;r[t+4+8>>2]=0;r[t+4+12>>2]=0;r[t+20>>2]=1065353216;r[t+24>>2]=0;r[t+24+4>>2]=0;r[t+24+8>>2]=0;r[t+24+12>>2]=0;r[t+40>>2]=1065353216;r[t+44>>2]=0;r[t+44+4>>2]=0;r[t+44+8>>2]=0;r[t+44+12>>2]=0;r[t+44+16>>2]=0;r[t+240>>2]=0;r[t+128>>2]=0;r[t+128+4>>2]=0;r[t+128+8>>2]=0;r[t+128+12>>2]=0;r[t+96>>2]=1065353216;r[t+100>>2]=1065353216;r[t+104>>2]=1065353216;h[t+108>>2]=0.0;r[t+112>>2]=1065353216;r[t+116>>2]=1065353216;r[t+120>>2]=1065353216;h[t+124>>2]=0.0;e=t+176|0;n=e+60|0;do{r[e>>2]=0;e=e+4|0}while((e|0)<(n|0));t=t+236|0;h[t>>2]=0.0;return}else{n=e+4|0;r[t>>2]=r[n>>2];r[t+4>>2]=r[n+4>>2];r[t+8>>2]=r[n+8>>2];r[t+12>>2]=r[n+12>>2];n=e+20|0;r[t+16>>2]=r[n>>2];r[t+16+4>>2]=r[n+4>>2];r[t+16+8>>2]=r[n+8>>2];r[t+16+12>>2]=r[n+12>>2];n=e+36|0;r[t+32>>2]=r[n>>2];r[t+32+4>>2]=r[n+4>>2];r[t+32+8>>2]=r[n+8>>2];r[t+32+12>>2]=r[n+12>>2];n=e+52|0;r[t+48>>2]=r[n>>2];r[t+48+4>>2]=r[n+4>>2];r[t+48+8>>2]=r[n+8>>2];r[t+48+12>>2]=r[n+12>>2];n=e+368|0;c=+h[n>>2];_=e+372|0;l=c*+h[e+376>>2];a=c*+h[e+380>>2];h[t+128>>2]=c*+h[_>>2];h[t+132>>2]=l;h[t+136>>2]=a;h[t+140>>2]=0.0;r[t+240>>2]=e;u=e+568|0;r[t+96>>2]=r[u>>2];r[t+96+4>>2]=r[u+4>>2];r[t+96+8>>2]=r[u+8>>2];r[t+96+12>>2]=r[u+12>>2];r[t+112>>2]=r[_>>2];r[t+112+4>>2]=r[_+4>>2];r[t+112+8>>2]=r[_+8>>2];r[t+112+12>>2]=r[_+12>>2];_=e+336|0;r[t+176>>2]=r[_>>2];r[t+176+4>>2]=r[_+4>>2];r[t+176+8>>2]=r[_+8>>2];r[t+176+12>>2]=r[_+12>>2];_=e+352|0;r[t+192>>2]=r[_>>2];r[t+192+4>>2]=r[_+4>>2];r[t+192+8>>2]=r[_+8>>2];r[t+192+12>>2]=r[_+12>>2];a=+h[n>>2];l=a*+h[e+440>>2]*i;c=a*+h[e+444>>2]*i;h[t+208>>2]=a*+h[e+436>>2]*i;h[t+212>>2]=l;h[t+216>>2]=c;h[t+220>>2]=0.0;c=+h[e+452>>2];l=+h[e+456>>2];a=+h[e+460>>2];o=(c*+h[e+292>>2]+l*+h[e+308>>2]+a*+h[e+324>>2])*i;s=(c*+h[e+296>>2]+l*+h[e+312>>2]+a*+h[e+328>>2])*i;h[t+224>>2]=(+h[e+288>>2]*c+ +h[e+304>>2]*l+ +h[e+320>>2]*a)*i;h[t+228>>2]=o;h[t+232>>2]=s;t=t+236|0;h[t>>2]=0.0;return}}function ZD(t,e,i,s,o,a){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;var l=0,c=0,_=0,u=0.0,p=0,f=0.0,m=0.0,g=0.0,b=0.0,y=0.0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0,M=0,R=0;R=r[t+88>>2]|0;if((R|0)==(r[t+92>>2]|0)?(p=R|0?R<<1:1,(R|0)<(p|0)):0){if(!p){l=0;c=R}else{r[5637]=(r[5637]|0)+1;l=Zl((p*152|3)+16|0)|0;if(!l)l=0;else{r[(l+4+15&-16)+-4>>2]=l;l=l+4+15&-16}c=r[t+88>>2]|0}if((c|0)>0){_=0;do{Oh(l+(_*152|0)|0,(r[t+96>>2]|0)+(_*152|0)|0,152)|0;_=_+1|0}while((_|0)!=(c|0))}c=r[t+96>>2]|0;if(c|0){if(n[t+100>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[c+-4>>2]|0)}r[t+96>>2]=0}n[t+100>>0]=1;r[t+96>>2]=l;r[t+92>>2]=p;l=r[t+88>>2]|0}else l=R;r[t+88>>2]=l+1;M=r[t+96>>2]|0;r[M+(R*152|0)+140>>2]=o;r[M+(R*152|0)+16>>2]=0;r[M+(R*152|0)+16+4>>2]=0;r[M+(R*152|0)+16+8>>2]=0;r[M+(R*152|0)+16+12>>2]=0;h[M+(R*152|0)+48>>2]=-0.0;h[M+(R*152|0)+52>>2]=-0.0;h[M+(R*152|0)+56>>2]=-0.0;h[M+(R*152|0)+60>>2]=0.0;t=r[t+16>>2]|0;p=r[t+(i*244|0)+240>>2]|0;E=r[t+(s*244|0)+240>>2]|0;r[M+(R*152|0)+144>>2]=i;r[M+(R*152|0)+148>>2]=s;o=r[a+88>>2]|0;r[M+(R*152|0)+104>>2]=o;r[M+(R*152|0)+132>>2]=0;h[M+(R*152|0)+100>>2]=0.0;h[M+(R*152|0)+96>>2]=0.0;w=-+h[e>>2];C=-+h[e+4>>2];T=-+h[e+8>>2];h[M+(R*152|0)>>2]=w;h[M+(R*152|0)+4>>2]=C;h[M+(R*152|0)+8>>2]=T;h[M+(R*152|0)+12>>2]=0.0;A=(r[d>>2]=o,+h[d>>2]);if(p|0){l=(h[d>>2]=(+h[p+288>>2]*w+ +h[p+292>>2]*C+ +h[p+296>>2]*T)*+h[p+568>>2],r[d>>2]|0);c=(h[d>>2]=(+h[p+304>>2]*w+ +h[p+308>>2]*C+ +h[p+312>>2]*T)*+h[p+572>>2],r[d>>2]|0);_=(h[d>>2]=(+h[p+320>>2]*w+ +h[p+324>>2]*C+ +h[p+328>>2]*T)*+h[p+576>>2],r[d>>2]|0)}else{l=0;c=0;_=0}r[M+(R*152|0)+64>>2]=l;r[M+(R*152|0)+68>>2]=c;r[M+(R*152|0)+72>>2]=_;h[M+(R*152|0)+76>>2]=0.0;v=+h[e>>2];S=+h[e+4>>2];x=+h[e+8>>2];e=r[e+12>>2]|0;h[M+(R*152|0)+32>>2]=v;h[M+(R*152|0)+36>>2]=S;h[M+(R*152|0)+40>>2]=x;r[M+(R*152|0)+44>>2]=e;if(E|0){l=(h[d>>2]=(v*+h[E+288>>2]+S*+h[E+292>>2]+x*+h[E+296>>2])*+h[E+568>>2],r[d>>2]|0);c=(h[d>>2]=(v*+h[E+304>>2]+S*+h[E+308>>2]+x*+h[E+312>>2])*+h[E+572>>2],r[d>>2]|0);_=(h[d>>2]=(v*+h[E+320>>2]+S*+h[E+324>>2]+x*+h[E+328>>2])*+h[E+576>>2],r[d>>2]|0)}else{l=0;c=0;_=0}r[M+(R*152|0)+80>>2]=l;r[M+(R*152|0)+84>>2]=c;r[M+(R*152|0)+88>>2]=_;h[M+(R*152|0)+92>>2]=0.0;if(p|0){u=+h[p+288>>2]*w+ +h[p+292>>2]*C+ +h[p+296>>2]*T;f=+h[p+304>>2]*w+ +h[p+308>>2]*C+ +h[p+312>>2]*T;m=+h[p+320>>2]*w+ +h[p+324>>2]*C+ +h[p+328>>2]*T}else{u=0.0;f=0.0;m=0.0}if(E|0){g=+h[E+288>>2]*v+ +h[E+292>>2]*S+ +h[E+296>>2]*x;b=v*+h[E+304>>2]+S*+h[E+308>>2]+x*+h[E+312>>2];y=v*+h[E+320>>2]+S*+h[E+324>>2]+x*+h[E+328>>2]}else{g=0.0;b=0.0;y=0.0}b=1.0/(u*w+f*C+m*T+0.0+(g*v+b*S+y*x));h[M+(R*152|0)+108>>2]=b;if(p|0){f=+h[t+(i*244|0)+192>>2];m=+h[t+(i*244|0)+196>>2];g=+h[t+(i*244|0)+200>>2];u=(+h[t+(i*244|0)+176>>2]+ +h[t+(i*244|0)+208>>2])*0.0+(+h[t+(i*244|0)+180>>2]+ +h[t+(i*244|0)+212>>2])*0.0+(+h[t+(i*244|0)+184>>2]+ +h[t+(i*244|0)+216>>2])*0.0}else{f=0.0;m=0.0;g=0.0;u=0.0}u=u+(f*w+m*C+g*T);if(!E){y=0.0;w=0.0;T=0.0;C=-0.0;v=y*v;w=w*S;w=v+w;T=T*x;T=w+T;T=C+T;T=u+T;T=0.0-T;T=b*T;s=M+(R*152|0)+112|0;h[s>>2]=T;s=M+(R*152|0)+116|0;h[s>>2]=0.0;A=-A;s=M+(R*152|0)+120|0;h[s>>2]=A;s=M+(R*152|0)+124|0;r[s>>2]=o;return}y=+h[t+(s*244|0)+192>>2];w=+h[t+(s*244|0)+196>>2];T=+h[t+(s*244|0)+200>>2];C=(+h[t+(s*244|0)+176>>2]+ +h[t+(s*244|0)+208>>2])*-0.0+(+h[t+(s*244|0)+180>>2]+ +h[t+(s*244|0)+212>>2])*-0.0+(+h[t+(s*244|0)+184>>2]+ +h[t+(s*244|0)+216>>2])*-0.0;v=y*v;w=w*S;w=v+w;T=T*x;T=w+T;T=C+T;T=u+T;T=0.0-T;T=b*T;s=M+(R*152|0)+112|0;h[s>>2]=T;s=M+(R*152|0)+116|0;h[s>>2]=0.0;A=-A;s=M+(R*152|0)+120|0;h[s>>2]=A;s=M+(R*152|0)+124|0;r[s>>2]=o;return}function QD(t,e,i,s,o,a,l,c,_,u,p){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;l=l|0;c=c|0;_=+_;u=+u;p=+p;var f=0,m=0,g=0,b=0.0,y=0,v=0.0,S=0.0,x=0.0,w=0.0,C=0.0,T=0.0,A=0.0,E=0.0,M=0.0,R=0.0,I=0.0,P=0.0,L=0.0,D=0.0,k=0.0,O=0.0,F=0.0,B=0.0,N=0,U=0,V=0.0,z=0.0,W=0.0,G=0.0;U=r[t+68>>2]|0;if((U|0)==(r[t+72>>2]|0)?(y=U|0?U<<1:1,(U|0)<(y|0)):0){if(!y){f=0;m=U}else{r[5637]=(r[5637]|0)+1;f=Zl((y*152|3)+16|0)|0;if(!f)f=0;else{r[(f+4+15&-16)+-4>>2]=f;f=f+4+15&-16}m=r[t+68>>2]|0}if((m|0)>0){g=0;do{Oh(f+(g*152|0)|0,(r[t+76>>2]|0)+(g*152|0)|0,152)|0;g=g+1|0}while((g|0)!=(m|0))}m=r[t+76>>2]|0;if(m|0){if(n[t+80>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[m+-4>>2]|0)}r[t+76>>2]=0}n[t+80>>0]=1;r[t+76>>2]=f;r[t+72>>2]=y;f=r[t+68>>2]|0}else f=U;r[t+68>>2]=f+1;N=r[t+76>>2]|0;r[N+(U*152|0)+140>>2]=o;g=r[t+16>>2]|0;f=r[g+(i*244|0)+240>>2]|0;y=r[g+(s*244|0)+240>>2]|0;r[N+(U*152|0)+144>>2]=i;r[N+(U*152|0)+148>>2]=s;m=r[a+84>>2]|0;r[N+(U*152|0)+104>>2]=m;r[N+(U*152|0)+132>>2]=0;h[N+(U*152|0)+100>>2]=0.0;h[N+(U*152|0)+96>>2]=0.0;B=(r[d>>2]=m,+h[d>>2]);if(f|0){r[N+(U*152|0)+16>>2]=r[e>>2];r[N+(U*152|0)+16+4>>2]=r[e+4>>2];r[N+(U*152|0)+16+8>>2]=r[e+8>>2];r[N+(U*152|0)+16+12>>2]=r[e+12>>2];F=+h[l+4>>2];R=+h[N+(U*152|0)+24>>2];D=+h[l+8>>2];k=+h[N+(U*152|0)+20>>2];I=+h[N+(U*152|0)+16>>2];O=+h[l>>2];h[N+(U*152|0)>>2]=F*R-D*k;h[N+(U*152|0)+4>>2]=D*I-R*O;h[N+(U*152|0)+8>>2]=k*O-F*I;h[N+(U*152|0)+12>>2]=0.0;S=((F*R-D*k)*+h[f+288>>2]+(D*I-R*O)*+h[f+292>>2]+(k*O-F*I)*+h[f+296>>2])*+h[f+568>>2];b=((F*R-D*k)*+h[f+304>>2]+(D*I-R*O)*+h[f+308>>2]+(k*O-F*I)*+h[f+312>>2])*+h[f+572>>2];v=((F*R-D*k)*+h[f+320>>2]+(D*I-R*O)*+h[f+324>>2]+(k*O-F*I)*+h[f+328>>2])*+h[f+576>>2];h[N+(U*152|0)+64>>2]=S;h[N+(U*152|0)+68>>2]=b;h[N+(U*152|0)+72>>2]=v;h[N+(U*152|0)+76>>2]=0.0;T=I;A=k;E=R;M=F*R-D*k;R=D*I-R*O;I=k*O-F*I}else{r[N+(U*152|0)+64>>2]=0;r[N+(U*152|0)+64+4>>2]=0;r[N+(U*152|0)+64+8>>2]=0;r[N+(U*152|0)+64+12>>2]=0;r[N+(U*152|0)>>2]=0;r[N+(U*152|0)+4>>2]=0;r[N+(U*152|0)+8>>2]=0;r[N+(U*152|0)+12>>2]=0;r[N+(U*152|0)+16>>2]=0;r[N+(U*152|0)+20>>2]=0;r[N+(U*152|0)+24>>2]=0;r[N+(U*152|0)+28>>2]=0;b=0.0;v=0.0;S=0.0;T=0.0;A=0.0;E=0.0;M=0.0;R=0.0;I=0.0}if(y|0){F=-+h[e>>2];z=-+h[e+4>>2];O=-+h[e+8>>2];h[N+(U*152|0)+48>>2]=F;h[N+(U*152|0)+52>>2]=z;h[N+(U*152|0)+56>>2]=O;h[N+(U*152|0)+60>>2]=0.0;V=+h[c+4>>2];G=+h[c+8>>2];W=+h[c>>2];h[N+(U*152|0)+32>>2]=V*O-G*z;h[N+(U*152|0)+36>>2]=G*F-W*O;h[N+(U*152|0)+40>>2]=W*z-V*F;h[N+(U*152|0)+44>>2]=0.0;x=((V*O-G*z)*+h[y+288>>2]+(G*F-W*O)*+h[y+292>>2]+(W*z-V*F)*+h[y+296>>2])*+h[y+568>>2];w=((V*O-G*z)*+h[y+304>>2]+(G*F-W*O)*+h[y+308>>2]+(W*z-V*F)*+h[y+312>>2])*+h[y+572>>2];C=((V*O-G*z)*+h[y+320>>2]+(G*F-W*O)*+h[y+324>>2]+(W*z-V*F)*+h[y+328>>2])*+h[y+576>>2];h[N+(U*152|0)+80>>2]=x;h[N+(U*152|0)+84>>2]=w;h[N+(U*152|0)+88>>2]=C;h[N+(U*152|0)+92>>2]=0.0;P=F;L=z;D=O;k=V*O-G*z;O=G*F-W*O;F=W*z-V*F}else{r[N+(U*152|0)+80>>2]=0;r[N+(U*152|0)+80+4>>2]=0;r[N+(U*152|0)+80+8>>2]=0;r[N+(U*152|0)+80+12>>2]=0;r[N+(U*152|0)+32>>2]=0;r[N+(U*152|0)+32+4>>2]=0;r[N+(U*152|0)+32+8>>2]=0;r[N+(U*152|0)+32+12>>2]=0;r[N+(U*152|0)+32+16>>2]=0;r[N+(U*152|0)+32+20>>2]=0;r[N+(U*152|0)+32+24>>2]=0;r[N+(U*152|0)+32+28>>2]=0;x=0.0;w=0.0;C=0.0;P=0.0;L=0.0;D=0.0;k=0.0;O=0.0;F=0.0}if(f|0){z=+h[l+8>>2];W=+h[l+4>>2];G=+h[l>>2];v=+h[f+368>>2]+((b*z-v*W)*+h[e>>2]+(v*G-z*S)*+h[e+4>>2]+(W*S-b*G)*+h[e+8>>2])}else v=0.0;if(y|0){W=-x;b=-w;C=-C;V=+h[c+8>>2];z=+h[c+4>>2];G=+h[c>>2];b=+h[y+368>>2]+((V*b-z*C)*+h[e>>2]+(G*C-V*W)*+h[e+4>>2]+(z*W-G*b)*+h[e+8>>2])}else b=0.0;w=_/(v+b);h[N+(U*152|0)+108>>2]=w;if(f|0){v=+h[g+(i*244|0)+192>>2];S=+h[g+(i*244|0)+196>>2];x=+h[g+(i*244|0)+200>>2];b=(+h[g+(i*244|0)+176>>2]+ +h[g+(i*244|0)+208>>2])*T+(+h[g+(i*244|0)+180>>2]+ +h[g+(i*244|0)+212>>2])*A+(+h[g+(i*244|0)+184>>2]+ +h[g+(i*244|0)+216>>2])*E}else{v=0.0;S=0.0;x=0.0;b=T*0.0+A*0.0+E*0.0}b=b+(v*M+S*R+x*I);if(y|0){V=+h[g+(s*244|0)+192>>2];z=+h[g+(s*244|0)+196>>2];G=+h[g+(s*244|0)+200>>2];W=(+h[g+(s*244|0)+176>>2]+ +h[g+(s*244|0)+208>>2])*P+(+h[g+(s*244|0)+180>>2]+ +h[g+(s*244|0)+212>>2])*L+(+h[g+(s*244|0)+184>>2]+ +h[g+(s*244|0)+216>>2])*D;V=V*k;z=z*O;z=V+z;G=G*F;G=z+G;G=W+G;G=b+G;G=u-G;G=w*G;s=N+(U*152|0)+112|0;h[s>>2]=G;s=N+(U*152|0)+128|0;h[s>>2]=0.0;s=N+(U*152|0)+116|0;h[s>>2]=p;G=-B;s=N+(U*152|0)+120|0;h[s>>2]=G;s=N+(U*152|0)+124|0;r[s>>2]=m;return}else{V=0.0;z=0.0;G=0.0;W=P*0.0+L*0.0+D*0.0;V=V*k;z=z*O;z=V+z;G=G*F;G=z+G;G=W+G;G=b+G;G=u-G;G=w*G;s=N+(U*152|0)+112|0;h[s>>2]=G;s=N+(U*152|0)+128|0;h[s>>2]=0.0;s=N+(U*152|0)+116|0;h[s>>2]=p;G=-B;s=N+(U*152|0)+120|0;h[s>>2]=G;s=N+(U*152|0)+124|0;r[s>>2]=m;return}}function $D(t,e,i,n,s,o,a,l,h){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;o=o|0;a=a|0;l=l|0;h=h|0;if(!(r[l+44>>2]|0))return;e=r[l+20>>2]|0;if(!(r[l+64>>2]&256)){if((e|0)<=0)return;h=0;do{o=r[t+28>>2]|0;if((o|0)>0){e=0;do{s=r[(r[t+116>>2]|0)+(e<<2)>>2]|0;a=r[t+36>>2]|0;i=r[t+16>>2]|0;JD(i+((r[a+(s*152|0)+144>>2]|0)*244|0)|0,i+((r[a+(s*152|0)+148>>2]|0)*244|0)|0,a+(s*152|0)|0);e=e+1|0}while((e|0)!=(o|0));e=r[l+20>>2]|0}h=h+1|0}while((h|0)<(e|0));return}else{if((e|0)<=0)return;h=0;do{o=r[t+28>>2]|0;if((o|0)>0){e=0;do{s=r[(r[t+116>>2]|0)+(e<<2)>>2]|0;a=r[t+36>>2]|0;i=r[t+16>>2]|0;JD(i+((r[a+(s*152|0)+144>>2]|0)*244|0)|0,i+((r[a+(s*152|0)+148>>2]|0)*244|0)|0,a+(s*152|0)|0);e=e+1|0}while((e|0)!=(o|0));e=r[l+20>>2]|0}h=h+1|0}while((h|0)<(e|0));return}}function JD(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0;n=+h[i+128>>2];if(!(n!=0.0))return;r[5314]=(r[5314]|0)+1;c=+h[i+96>>2];s=+h[i+16>>2];o=+h[i+20>>2];a=+h[i+24>>2];l=+h[i+108>>2];l=n-c*+h[i+116>>2]-(s*+h[t+144>>2]+o*+h[t+148>>2]+a*+h[t+152>>2]+(+h[i>>2]*+h[t+160>>2]+ +h[i+4>>2]*+h[t+164>>2]+ +h[i+8>>2]*+h[t+168>>2]))*l-l*(+h[i+48>>2]*+h[e+144>>2]+ +h[i+52>>2]*+h[e+148>>2]+ +h[i+56>>2]*+h[e+152>>2]+(+h[i+32>>2]*+h[e+160>>2]+ +h[i+36>>2]*+h[e+164>>2]+ +h[i+40>>2]*+h[e+168>>2]));_=+h[i+120>>2];n=c+l<_?_-c:l;h[i+96>>2]=c+l<_?_:c+l;if(r[t+240>>2]|0){_=n*(o*+h[t+132>>2])*+h[t+116>>2];c=n*(a*+h[t+136>>2])*+h[t+120>>2];h[t+144>>2]=+h[t+112>>2]*(n*(s*+h[t+128>>2]))+ +h[t+144>>2];h[t+148>>2]=_+ +h[t+148>>2];h[t+152>>2]=c+ +h[t+152>>2];c=n*+h[t+100>>2]*+h[i+68>>2];_=n*+h[t+104>>2]*+h[i+72>>2];h[t+160>>2]=n*+h[t+96>>2]*+h[i+64>>2]+ +h[t+160>>2];h[t+164>>2]=c+ +h[t+164>>2];h[t+168>>2]=_+ +h[t+168>>2]}if(!(r[e+240>>2]|0))return;_=n*(+h[i+52>>2]*+h[e+132>>2])*+h[e+116>>2];c=n*(+h[i+56>>2]*+h[e+136>>2])*+h[e+120>>2];h[e+144>>2]=+h[e+112>>2]*(n*(+h[i+48>>2]*+h[e+128>>2]))+ +h[e+144>>2];h[e+148>>2]=_+ +h[e+148>>2];h[e+152>>2]=c+ +h[e+152>>2];c=n*+h[e+100>>2]*+h[i+84>>2];_=n*+h[e+104>>2]*+h[i+88>>2];h[e+160>>2]=n*+h[e+96>>2]*+h[i+80>>2]+ +h[e+160>>2];h[e+164>>2]=c+ +h[e+164>>2];h[e+168>>2]=_+ +h[e+168>>2];return}function tk(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var o=0,a=0,l=0,c=0,u=0.0,p=0.0,f=0.0,m=0.0,g=0,b=0,y=0.0,v=0.0;g=_;_=_+80|0;a=r[t+28>>2]|0;e=r[s+64>>2]|0;t:do{if((e&4|0)!=0&(a|0)>0){l=r[t+36>>2]|0;o=r[t+76>>2]|0;if(!(e&16)){e=0;while(1){c=r[l+(e*152|0)+132>>2]|0;r[c+120>>2]=r[l+(e*152|0)+100>>2];r[c+124>>2]=r[o+((r[l+(e*152|0)+140>>2]|0)*152|0)+100>>2];e=e+1|0;if((e|0)==(a|0))break t}}else{i=o;e=0}while(1){c=r[l+(e*152|0)+132>>2]|0;r[c+120>>2]=r[l+(e*152|0)+100>>2];b=r[l+(e*152|0)+140>>2]|0;r[c+124>>2]=r[o+(b*152|0)+100>>2];r[c+128>>2]=r[i+((b+1|0)*152|0)+100>>2];e=e+1|0;if((e|0)==(a|0))break t;i=r[t+76>>2]|0}}}while(0);i=r[t+48>>2]|0;if((i|0)>0){c=0;do{o=r[t+56>>2]|0;a=r[o+(c*152|0)+132>>2]|0;l=r[a+44>>2]|0;e=o+(c*152|0)+100|0;if(l|0){m=+h[e>>2];b=r[a+28>>2]|0;f=1.0/+h[s+12>>2];p=m*+h[o+(c*152|0)+20>>2]*+h[b+376>>2]*f;u=m*+h[o+(c*152|0)+24>>2]*+h[b+380>>2]*f;h[l>>2]=+h[l>>2]+ +h[o+(c*152|0)+16>>2]*m*+h[b+372>>2]*f;h[l+4>>2]=p+ +h[l+4>>2];h[l+8>>2]=u+ +h[l+8>>2];u=+h[e>>2];b=r[a+32>>2]|0;p=1.0/+h[s+12>>2];f=u*+h[o+(c*152|0)+52>>2]*+h[b+376>>2]*p;m=u*+h[o+(c*152|0)+56>>2]*+h[b+380>>2]*p;h[l+32>>2]=+h[l+32>>2]+ +h[o+(c*152|0)+48>>2]*u*+h[b+372>>2]*p;h[l+36>>2]=f+ +h[l+36>>2];h[l+40>>2]=m+ +h[l+40>>2];b=r[a+28>>2]|0;m=+h[e>>2];f=1.0/+h[s+12>>2];p=+h[o+(c*152|0)+4>>2]*+h[b+572>>2]*m*f;u=m*(+h[o+(c*152|0)+8>>2]*+h[b+576>>2])*f;h[l+16>>2]=+h[l+16>>2]+ +h[o+(c*152|0)>>2]*+h[b+568>>2]*m*f;h[l+20>>2]=p+ +h[l+20>>2];h[l+24>>2]=u+ +h[l+24>>2];b=r[a+32>>2]|0;u=+h[e>>2];p=1.0/+h[s+12>>2];f=+h[o+(c*152|0)+36>>2]*+h[b+572>>2]*u*p;m=u*(+h[o+(c*152|0)+40>>2]*+h[b+576>>2])*p;h[l+48>>2]=+h[l+48>>2]+ +h[o+(c*152|0)+32>>2]*+h[b+568>>2]*u*p;h[l+52>>2]=f+ +h[l+52>>2];h[l+56>>2]=m+ +h[l+56>>2]}b=r[e>>2]|0;r[a+36>>2]=b;m=+W(+(r[d>>2]=b,+h[d>>2]));if(m>=+h[a+16>>2])n[a+20>>0]=0;c=c+1|0}while((c|0)!=(i|0))}e=r[t+8>>2]|0;if((e|0)>0){l=0;do{i=r[t+16>>2]|0;o=i+(l*244|0)|0;a=r[i+(l*244|0)+240>>2]|0;if(a){if(!(r[s+44>>2]|0)){o=i+(l*244|0)+176|0;p=+h[i+(l*244|0)+64>>2]+ +h[o>>2];h[o>>2]=p;o=i+(l*244|0)+180|0;f=+h[i+(l*244|0)+68>>2]+ +h[o>>2];h[o>>2]=f;o=i+(l*244|0)+184|0;u=+h[i+(l*244|0)+72>>2]+ +h[o>>2];h[o>>2]=u;o=i+(l*244|0)+192|0;h[o>>2]=+h[i+(l*244|0)+80>>2]+ +h[o>>2];o=i+(l*244|0)+196|0;h[o>>2]=+h[i+(l*244|0)+84>>2]+ +h[o>>2];o=i+(l*244|0)+200|0;h[o>>2]=+h[i+(l*244|0)+88>>2]+ +h[o>>2];o=i;e=a}else{p=+h[s+12>>2];f=+h[s+52>>2];b=i+(l*244|0)+176|0;h[b>>2]=+h[i+(l*244|0)+64>>2]+ +h[b>>2];b=i+(l*244|0)+180|0;h[b>>2]=+h[i+(l*244|0)+68>>2]+ +h[b>>2];b=i+(l*244|0)+184|0;h[b>>2]=+h[i+(l*244|0)+72>>2]+ +h[b>>2];b=i+(l*244|0)+192|0;h[b>>2]=+h[i+(l*244|0)+80>>2]+ +h[b>>2];b=i+(l*244|0)+196|0;h[b>>2]=+h[i+(l*244|0)+84>>2]+ +h[b>>2];b=i+(l*244|0)+200|0;h[b>>2]=+h[i+(l*244|0)+88>>2]+ +h[b>>2];m=+h[i+(l*244|0)+144>>2];u=+h[i+(l*244|0)+148>>2];if((((!(m!=0.0|u!=0.0)?!(+h[i+(l*244|0)+152>>2]!=0.0):0)?!(+h[i+(l*244|0)+160>>2]!=0.0):0)?!(+h[i+(l*244|0)+164>>2]!=0.0):0)?!(+h[i+(l*244|0)+168>>2]!=0.0):0)e=a;else{v=+h[i+(l*244|0)+164>>2]*f;y=+h[i+(l*244|0)+168>>2]*f;h[g>>2]=+h[i+(l*244|0)+160>>2]*f;h[g+4>>2]=v;h[g+8>>2]=y;h[g+12>>2]=0.0;Vv(o,m,u,+h[i+(l*244|0)+152>>2],g,p,g+16|0);r[o>>2]=r[g+16>>2];r[o+4>>2]=r[g+16+4>>2];r[o+8>>2]=r[g+16+8>>2];r[o+12>>2]=r[g+16+12>>2];e=i+(l*244|0)+16|0;r[e>>2]=r[g+16+16>>2];r[e+4>>2]=r[g+16+16+4>>2];r[e+8>>2]=r[g+16+16+8>>2];r[e+12>>2]=r[g+16+16+12>>2];e=i+(l*244|0)+32|0;r[e>>2]=r[g+16+32>>2];r[e+4>>2]=r[g+16+32+4>>2];r[e+8>>2]=r[g+16+32+8>>2];r[e+12>>2]=r[g+16+32+12>>2];e=i+(l*244|0)+48|0;r[e>>2]=r[g+16+48>>2];r[e+4>>2]=r[g+16+48+4>>2];r[e+8>>2]=r[g+16+48+8>>2];r[e+12>>2]=r[g+16+48+12>>2];e=r[t+16>>2]|0;i=e;e=r[e+(l*244|0)+240>>2]|0}o=i;p=+h[i+(l*244|0)+176>>2];f=+h[i+(l*244|0)+180>>2];u=+h[i+(l*244|0)+184>>2]}v=p+ +h[o+(l*244|0)+208>>2];y=f+ +h[o+(l*244|0)+212>>2];m=u+ +h[o+(l*244|0)+216>>2];c=e+284|0;r[c>>2]=(r[c>>2]|0)+1;h[e+336>>2]=v;h[e+340>>2]=y;h[e+344>>2]=m;h[e+348>>2]=0.0;c=r[t+16>>2]|0;b=r[c+(l*244|0)+240>>2]|0;m=+h[c+(l*244|0)+192>>2]+ +h[c+(l*244|0)+224>>2];y=+h[c+(l*244|0)+196>>2]+ +h[c+(l*244|0)+228>>2];v=+h[c+(l*244|0)+200>>2]+ +h[c+(l*244|0)+232>>2];r[b+284>>2]=(r[b+284>>2]|0)+1;h[b+352>>2]=m;h[b+356>>2]=y;h[b+360>>2]=v;h[b+364>>2]=0.0;if(r[s+44>>2]|0){c=r[t+16>>2]|0;b=r[c+(l*244|0)+240>>2]|0;a=c+(l*244|0)|0;r[b+284>>2]=(r[b+284>>2]|0)+1;r[b+4>>2]=r[a>>2];r[b+4+4>>2]=r[a+4>>2];r[b+4+8>>2]=r[a+8>>2];r[b+4+12>>2]=r[a+12>>2];a=c+(l*244|0)+16|0;r[b+20>>2]=r[a>>2];r[b+20+4>>2]=r[a+4>>2];r[b+20+8>>2]=r[a+8>>2];r[b+20+12>>2]=r[a+12>>2];a=c+(l*244|0)+32|0;r[b+36>>2]=r[a>>2];r[b+36+4>>2]=r[a+4>>2];r[b+36+8>>2]=r[a+8>>2];r[b+36+12>>2]=r[a+12>>2];c=c+(l*244|0)+48|0;r[b+52>>2]=r[c>>2];r[b+52+4>>2]=r[c+4>>2];r[b+52+8>>2]=r[c+8>>2];r[b+52+12>>2]=r[c+12>>2]}r[(r[(r[t+16>>2]|0)+(l*244|0)+240>>2]|0)+212>>2]=-1;e=r[t+8>>2]|0}l=l+1|0}while((l|0)<(e|0))}if((r[t+28>>2]|0)<0?(r[t+32>>2]|0)<0:0){e=r[t+36>>2]|0;if(e|0){if(n[t+40>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+36>>2]=0}n[t+40>>0]=1;r[t+36>>2]=0;r[t+32>>2]=0}r[t+28>>2]=0;if((r[t+48>>2]|0)<0?(r[t+52>>2]|0)<0:0){e=r[t+56>>2]|0;if(e|0){if(n[t+60>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+56>>2]=0}n[t+60>>0]=1;r[t+56>>2]=0;r[t+52>>2]=0}r[t+48>>2]=0;if((r[t+68>>2]|0)<0?(r[t+72>>2]|0)<0:0){e=r[t+76>>2]|0;if(e|0){if(n[t+80>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+76>>2]=0}n[t+80>>0]=1;r[t+76>>2]=0;r[t+72>>2]=0}r[t+68>>2]=0;if((r[t+88>>2]|0)<0?(r[t+92>>2]|0)<0:0){e=r[t+96>>2]|0;if(e|0){if(n[t+100>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+96>>2]=0}n[t+100>>0]=1;r[t+96>>2]=0;r[t+92>>2]=0}r[t+88>>2]=0;if((r[t+8>>2]|0)>=0){r[t+8>>2]=0;_=g;return 0.0}if((r[t+12>>2]|0)>=0){r[t+8>>2]=0;_=g;return 0.0}e=r[t+16>>2]|0;if(e|0){if(n[t+20>>0]|0){r[5638]=(r[5638]|0)+1;Ql(r[e+-4>>2]|0)}r[t+16>>2]=0}n[t+20>>0]=1;r[t+16>>2]=0;r[t+12>>2]=0;r[t+8>>2]=0;_=g;return 0.0}function ek(t,e,i,s,o,a,l,c,_,u){t=t|0;e=e|0;i=i|0;s=s|0;o=o|0;a=a|0;l=l|0;c=c|0;_=_|0;u=u|0;var d=0.0,p=0,f=0,m=0,g=0,b=0,y=0,v=0.0;p=r[t+48>>2]|0;m=r[t+28>>2]|0;g=r[t+68>>2]|0;if(r[_+64>>2]&1|0){if((p|0)>0){s=r[t+136>>2]|0;u=r[t+200>>2]|0;f=0;do{o=s+(f<<2)|0;a=r[o>>2]|0;f=f+1|0;u=(et(u,1664525)|0)+1013904223|0;if(f>>>0<65537){i=u>>>16^u;if(f>>>0<257)if(f>>>0<17){i=(i>>>8^i)>>>4^(i>>>8^i);if(f>>>0<5)if(f>>>0<3)i=(i>>>2^i)>>>1^(i>>>2^i);else i=i>>>2^i}else i=i>>>8^i}else i=u;i=s+(((i>>>0)%(f>>>0)|0)<<2)|0;r[o>>2]=r[i>>2];r[i>>2]=a}while((f|0)!=(p|0));r[t+200>>2]=u}if((r[_+20>>2]|0)>(e|0)){if((m|0)>0){s=r[t+116>>2]|0;u=r[t+200>>2]|0;p=0;do{o=s+(p<<2)|0;a=r[o>>2]|0;p=p+1|0;u=(et(u,1664525)|0)+1013904223|0;if(p>>>0<65537){i=u>>>16^u;if(p>>>0<257)if(p>>>0<17){i=(i>>>8^i)>>>4^(i>>>8^i);if(p>>>0<5)if(p>>>0<3)i=(i>>>2^i)>>>1^(i>>>2^i);else i=i>>>2^i}else i=i>>>8^i}else i=u;f=s+(((i>>>0)%(p>>>0)|0)<<2)|0;r[o>>2]=r[f>>2];r[f>>2]=a}while((p|0)!=(m|0));r[t+200>>2]=u}if((g|0)>0){s=r[t+156>>2]|0;u=r[t+200>>2]|0;p=0;do{o=s+(p<<2)|0;a=r[o>>2]|0;p=p+1|0;u=(et(u,1664525)|0)+1013904223|0;if(p>>>0<65537){i=u>>>16^u;if(p>>>0<257)if(p>>>0<17){i=(i>>>8^i)>>>4^(i>>>8^i);if(p>>>0<5)if(p>>>0<3)i=(i>>>2^i)>>>1^(i>>>2^i);else i=i>>>2^i}else i=i>>>8^i}else i=u;m=s+(((i>>>0)%(p>>>0)|0)<<2)|0;r[o>>2]=r[m>>2];r[m>>2]=a}while((p|0)!=(g|0));r[t+200>>2]=u}}}i=r[t+48>>2]|0;if(!(r[_+64>>2]&256)){if((i|0)>0){a=0;do{s=r[(r[t+136>>2]|0)+(a<<2)>>2]|0;o=r[t+56>>2]|0;if((r[o+(s*152|0)+136>>2]|0)>(e|0)){i=r[t+16>>2]|0;+ik(i+((r[o+(s*152|0)+144>>2]|0)*244|0)|0,i+((r[o+(s*152|0)+148>>2]|0)*244|0)|0,o+(s*152|0)|0);i=r[t+48>>2]|0}a=a+1|0}while((a|0)<(i|0))}if((r[_+20>>2]|0)<=(e|0))return 0.0;if((c|0)>0){o=0;do{i=l+(o<<2)|0;s=r[i>>2]|0;if(n[s+20>>0]|0){e=YD(t,r[s+28>>2]|0,+h[_+12>>2])|0;y=YD(t,r[(r[i>>2]|0)+32>>2]|0,+h[_+12>>2])|0;b=r[t+16>>2]|0;g=r[i>>2]|0;Uk[r[(r[g>>2]|0)+24>>2]&15](g,b+(e*244|0)|0,b+(y*244|0)|0,+h[_+12>>2])}o=o+1|0}while((o|0)!=(c|0))}i=r[t+28>>2]|0;if((i|0)>0){s=0;do{_=r[(r[t+116>>2]|0)+(s<<2)>>2]|0;c=r[t+36>>2]|0;l=r[t+16>>2]|0;+nk(l+((r[c+(_*152|0)+144>>2]|0)*244|0)|0,l+((r[c+(_*152|0)+148>>2]|0)*244|0)|0,c+(_*152|0)|0);s=s+1|0}while((s|0)!=(i|0))}i=r[t+68>>2]|0;if((i|0)>0){a=0;do{s=r[(r[t+156>>2]|0)+(a<<2)>>2]|0;o=r[t+76>>2]|0;d=+h[(r[t+36>>2]|0)+((r[o+(s*152|0)+140>>2]|0)*152|0)+100>>2];if(d>0.0){d=d*+h[o+(s*152|0)+104>>2];h[o+(s*152|0)+120>>2]=-d;h[o+(s*152|0)+124>>2]=d;_=r[t+16>>2]|0;+ik(_+((r[o+(s*152|0)+144>>2]|0)*244|0)|0,_+((r[o+(s*152|0)+148>>2]|0)*244|0)|0,o+(s*152|0)|0)}a=a+1|0}while((a|0)!=(i|0))}i=r[t+88>>2]|0;if((i|0)<=0)return 0.0;o=0;do{s=r[t+96>>2]|0;d=+h[(r[t+36>>2]|0)+((r[s+(o*152|0)+140>>2]|0)*152|0)+100>>2];if(d>0.0){v=+h[s+(o*152|0)+104>>2];d=d*v>v?v:d*v;h[s+(o*152|0)+120>>2]=-d;h[s+(o*152|0)+124>>2]=d;_=r[t+16>>2]|0;+ik(_+((r[s+(o*152|0)+144>>2]|0)*244|0)|0,_+((r[s+(o*152|0)+148>>2]|0)*244|0)|0,s+(o*152|0)|0)}o=o+1|0}while((o|0)!=(i|0));return 0.0}if((i|0)>0){a=0;do{s=r[(r[t+136>>2]|0)+(a<<2)>>2]|0;o=r[t+56>>2]|0;if((r[o+(s*152|0)+136>>2]|0)>(e|0)){i=r[t+16>>2]|0;+ik(i+((r[o+(s*152|0)+144>>2]|0)*244|0)|0,i+((r[o+(s*152|0)+148>>2]|0)*244|0)|0,o+(s*152|0)|0);i=r[t+48>>2]|0}a=a+1|0}while((a|0)<(i|0))}if((r[_+20>>2]|0)<=(e|0))return 0.0;if((c|0)>0){o=0;do{i=l+(o<<2)|0;s=r[i>>2]|0;if(n[s+20>>0]|0){m=YD(t,r[s+28>>2]|0,+h[_+12>>2])|0;e=YD(t,r[(r[i>>2]|0)+32>>2]|0,+h[_+12>>2])|0;g=r[t+16>>2]|0;f=r[i>>2]|0;Uk[r[(r[f>>2]|0)+24>>2]&15](f,g+(m*244|0)|0,g+(e*244|0)|0,+h[_+12>>2])}o=o+1|0}while((o|0)!=(c|0))}i=r[_+64>>2]|0;p=r[t+28>>2]|0;if(i&512|0){if((p|0)<=0)return 0.0;u=0;do{s=r[(r[t+116>>2]|0)+(u<<2)>>2]|0;o=r[t+36>>2]|0;a=r[t+16>>2]|0;+nk(a+((r[o+(s*152|0)+144>>2]|0)*244|0)|0,a+((r[o+(s*152|0)+148>>2]|0)*244|0)|0,o+(s*152|0)|0);d=+h[o+(s*152|0)+100>>2];s=et(u,(i>>>4&1)+1|0)|0;o=r[(r[t+156>>2]|0)+(s<<2)>>2]|0;a=r[t+76>>2]|0;if(d>0.0){v=d*+h[a+(o*152|0)+104>>2];h[a+(o*152|0)+120>>2]=-v;h[a+(o*152|0)+124>>2]=v;c=r[t+16>>2]|0;+ik(c+((r[a+(o*152|0)+144>>2]|0)*244|0)|0,c+((r[a+(o*152|0)+148>>2]|0)*244|0)|0,a+(o*152|0)|0)}if(r[_+64>>2]&16|0?(b=r[(r[t+156>>2]|0)+(s+1<<2)>>2]|0,y=r[t+76>>2]|0,d>0.0):0){v=d*+h[y+(b*152|0)+104>>2];h[y+(b*152|0)+120>>2]=-v;h[y+(b*152|0)+124>>2]=v;c=r[t+16>>2]|0;+ik(c+((r[y+(b*152|0)+144>>2]|0)*244|0)|0,c+((r[y+(b*152|0)+148>>2]|0)*244|0)|0,y+(b*152|0)|0)}u=u+1|0}while((u|0)!=(p|0));return 0.0}if((p|0)>0){i=0;do{_=r[(r[t+116>>2]|0)+(i<<2)>>2]|0;c=r[t+36>>2]|0;l=r[t+16>>2]|0;+nk(l+((r[c+(_*152|0)+144>>2]|0)*244|0)|0,l+((r[c+(_*152|0)+148>>2]|0)*244|0)|0,c+(_*152|0)|0);i=i+1|0}while((i|0)!=(p|0))}i=r[t+68>>2]|0;if((i|0)>0){a=0;do{s=r[(r[t+156>>2]|0)+(a<<2)>>2]|0;o=r[t+76>>2]|0;d=+h[(r[t+36>>2]|0)+((r[o+(s*152|0)+140>>2]|0)*152|0)+100>>2];if(d>0.0){v=d*+h[o+(s*152|0)+104>>2];h[o+(s*152|0)+120>>2]=-v;h[o+(s*152|0)+124>>2]=v;_=r[t+16>>2]|0;+ik(_+((r[o+(s*152|0)+144>>2]|0)*244|0)|0,_+((r[o+(s*152|0)+148>>2]|0)*244|0)|0,o+(s*152|0)|0)}a=a+1|0}while((a|0)!=(i|0))}i=r[t+88>>2]|0;if((i|0)<=0)return 0.0;o=0;do{s=r[t+96>>2]|0;d=+h[(r[t+36>>2]|0)+((r[s+(o*152|0)+140>>2]|0)*152|0)+100>>2];if(d>0.0){v=+h[s+(o*152|0)+104>>2];v=d*v>v?v:d*v;h[s+(o*152|0)+120>>2]=-v;h[s+(o*152|0)+124>>2]=v;_=r[t+16>>2]|0;+ik(_+((r[s+(o*152|0)+144>>2]|0)*244|0)|0,_+((r[s+(o*152|0)+148>>2]|0)*244|0)|0,s+(o*152|0)|0)}o=o+1|0}while((o|0)!=(i|0));return 0.0}function ik(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0;o=+h[i+100>>2];c=+h[i+16>>2];a=+h[i+20>>2];l=+h[i+24>>2];n=+h[i+108>>2];n=+h[i+112>>2]-o*+h[i+116>>2]-(c*+h[t+64>>2]+a*+h[t+68>>2]+l*+h[t+72>>2]+(+h[i>>2]*+h[t+80>>2]+ +h[i+4>>2]*+h[t+84>>2]+ +h[i+8>>2]*+h[t+88>>2]))*n-n*(+h[i+48>>2]*+h[e+64>>2]+ +h[i+52>>2]*+h[e+68>>2]+ +h[i+56>>2]*+h[e+72>>2]+(+h[i+32>>2]*+h[e+80>>2]+ +h[i+36>>2]*+h[e+84>>2]+ +h[i+40>>2]*+h[e+88>>2]));s=+h[i+120>>2];do{if(!(o+n<s)){s=+h[i+124>>2];if(o+n>s){h[i+100>>2]=s;n=s-o;break}else{h[i+100>>2]=o+n;break}}else{h[i+100>>2]=s;n=s-o}}while(0);if(r[t+240>>2]|0){a=n*(a*+h[t+132>>2])*+h[t+116>>2];l=n*(l*+h[t+136>>2])*+h[t+120>>2];h[t+64>>2]=+h[t+112>>2]*(n*(c*+h[t+128>>2]))+ +h[t+64>>2];h[t+68>>2]=a+ +h[t+68>>2];h[t+72>>2]=l+ +h[t+72>>2];l=n*+h[t+100>>2]*+h[i+68>>2];c=n*+h[t+104>>2]*+h[i+72>>2];h[t+80>>2]=n*+h[t+96>>2]*+h[i+64>>2]+ +h[t+80>>2];h[t+84>>2]=l+ +h[t+84>>2];h[t+88>>2]=c+ +h[t+88>>2]}if(!(r[e+240>>2]|0))return+n;c=n*(+h[i+52>>2]*+h[e+132>>2])*+h[e+116>>2];l=n*(+h[i+56>>2]*+h[e+136>>2])*+h[e+120>>2];h[e+64>>2]=+h[e+112>>2]*(n*(+h[i+48>>2]*+h[e+128>>2]))+ +h[e+64>>2];h[e+68>>2]=c+ +h[e+68>>2];h[e+72>>2]=l+ +h[e+72>>2];l=n*+h[e+100>>2]*+h[i+84>>2];c=n*+h[e+104>>2]*+h[i+88>>2];h[e+80>>2]=n*+h[e+96>>2]*+h[i+80>>2]+ +h[e+80>>2];h[e+84>>2]=l+ +h[e+84>>2];h[e+88>>2]=c+ +h[e+88>>2];return+n}function nk(t,e,i){t=t|0;e=e|0;i=i|0;var n=0.0,s=0.0,o=0.0,a=0.0,l=0.0,c=0.0,_=0.0;c=+h[i+100>>2];o=+h[i+16>>2];n=+h[i+20>>2];s=+h[i+24>>2];l=+h[i+108>>2];l=+h[i+112>>2]-c*+h[i+116>>2]-(o*+h[t+64>>2]+n*+h[t+68>>2]+s*+h[t+72>>2]+(+h[i>>2]*+h[t+80>>2]+ +h[i+4>>2]*+h[t+84>>2]+ +h[i+8>>2]*+h[t+88>>2]))*l-l*(+h[i+48>>2]*+h[e+64>>2]+ +h[i+52>>2]*+h[e+68>>2]+ +h[i+56>>2]*+h[e+72>>2]+(+h[i+32>>2]*+h[e+80>>2]+ +h[i+36>>2]*+h[e+84>>2]+ +h[i+40>>2]*+h[e+88>>2]));_=+h[i+120>>2];a=c+l<_?_-c:l;h[i+100>>2]=c+l<_?_:c+l;if(r[t+240>>2]|0){_=a*(n*+h[t+132>>2])*+h[t+116>>2];c=a*(s*+h[t+136>>2])*+h[t+120>>2];h[t+64>>2]=+h[t+112>>2]*(a*(o*+h[t+128>>2]))+ +h[t+64>>2];h[t+68>>2]=_+ +h[t+68>>2];h[t+72>>2]=c+ +h[t+72>>2];c=a*+h[t+100>>2]*+h[i+68>>2];_=a*+h[t+104>>2]*+h[i+72>>2];h[t+80>>2]=a*+h[t+96>>2]*+h[i+64>>2]+ +h[t+80>>2];h[t+84>>2]=c+ +h[t+84>>2];h[t+88>>2]=_+ +h[t+88>>2]}if(!(r[e+240>>2]|0))return+a;_=a*(+h[i+52>>2]*+h[e+132>>2])*+h[e+116>>2];c=a*(+h[i+56>>2]*+h[e+136>>2])*+h[e+120>>2];h[e+64>>2]=+h[e+112>>2]*(a*(+h[i+48>>2]*+h[e+128>>2]))+ +h[e+64>>2];h[e+68>>2]=_+ +h[e+68>>2];h[e+72>>2]=c+ +h[e+72>>2];c=a*+h[e+100>>2]*+h[i+84>>2];_=a*+h[e+104>>2]*+h[i+88>>2];h[e+80>>2]=a*+h[e+96>>2]*+h[i+80>>2]+ +h[e+80>>2];h[e+84>>2]=c+ +h[e+84>>2];h[e+88>>2]=_+ +h[e+88>>2];return+a}var sk=[kc,eP,eL,nD,SS,lw,bw,fM,TM,VM,bR,qR,JR,sI,nS,ph,ch,xh,kc,kc,kc,kc,kc,kc,kc,kc,kc,kc,kc,kc,kc,kc];var rk=[Oc,fx,kw,cI,RI,nC,MC,$T,UA,fy,my,Ay,Ey,My,Ly,x_,T_,Oc,Oc,Oc,Oc,Oc,Oc,Oc,Oc,Oc,Oc,Oc,Oc,Oc,Oc,Oc];var ok=[Fc,QI,$I,cP,uP,dP,pP,XP,YP,mL,KP,ZP,rL,hL,yL,vL,TL,AL,kL,GL,jL,eD,iD,oD,aD,xS,wS,PS,WS,GS,KS,ZS,QS,$S,ex,kx,nx,sx,ax,lx,_x,ux,bx,yx,Jy,vx,xx,Cx,Ex,Mx,Ux,zx,Gx,jx,Zx,$x,tw,ew,ow,aw,cw,mw,gw,yw,Cw,pM,Tw,Aw,CA,Mw,gM,vM,SM,wM,CM,AM,IM,kM,NM,UM,GM,jM,ZM,QM,JM,eR,nR,rR,aR,hR,_R,dR,fR,OP,gR,SR,xR,TR,AR,PR,LR,NR,VR,zR,XR,YR,QR,$R,nI,rI,TI,AI,bL,kI,VI,Kw,TT,Qw,cC,uC,SC,xC,kC,FC,YC,ZC,JC,tT,ST,xT,RT,tv,OT,XT,rA,cA,mA,gA,vA,xA,TA,OA,jA,HA,ev,iv,dv,pv,vv,Sv,Mv,Pv,zv,Dv,Ov,Wv,Jv,tS,iS,sS,aS,mS,bS,eE,iE,gE,uE,vE,AE,EE,SE,xE,HE,XE,sM,lM,WE,uD,gD,bD,PD,LD,VD,zD,GD,Mb,Vb,zb,Wb,ty,cy,xy,Iy,gy,yy,Dy,ky,Nb,Fy,Xy,Yy,E_,M_,I_,Au,Eu,Gm,jm,mi,gi,ih,uh,sh,rh,nh,mh,gh,yh,Bl,th,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc,Fc];var ak=[Bc];var lk=[Nc,rP,hP,CP,MP,RP,_L,fL,$P,oL,cL,FL,VL,zL,qL,KL,rD,AS,ES,US,jS,qS,JS,Dx,Ox,mx,Tx,pw,_w,ww,Sw,yM,bT,Dw,yC,BM,WM,vR,GR,ZR,eI,aI,EI,BI,NI,Jw,iC,CC,LC,NC,zC,KC,$C,eT,IT,qT,QT,YA,rv,ov,lv,hv,fv,mv,wv,sE,rE,aE,lE,hE,yE,IE,PE,ZE,QE,hM,_M,dD,vD,SD,DD,kD,Rb,Pb,jb,Hb,Kb,Zb,Qb,$b,Jb,ey,ny,sy,_y,uy,dy,py,wy,Ry,Py,Uy,Ky,Hm,Xm,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc,Nc];var hk=[Uc,eS,rS,Uc];var ck=[Vc,oP,aP,bP,yP,vP,xP,EP,uL,dL,ML,RL,IL,LL,UL,XL,DS,OS,FS,BS,XS,tx,Iw,Lw,Fw,Vw,Ww,Gw,Xw,HM,XM,qM,FR,hI,pI,mI,gI,vI,Cv,MI,PI,eC,sC,lC,_C,dC,TC,EC,IC,VC,WC,qC,QC,iT,nT,hT,cT,dT,PT,LT,NT,UT,WT,ZT,JT,oA,_A,NA,qA,ZA,QA,av,cv,Qy,Av,gC,mE,bE,OE,TE,iM,rM,GE,pD,CD,AD,BD,UD,jD,kb,Fb,ry,oy,hy,By,Ol,bh,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc,Vc];var _k=[zc,DE,tM,cD,xD,OD,Lb,zc];var uk=[Wc];var dk=[Gc];var pk=[jc,mP,wL,HL,CS,xM,$M,tR,iR,sR,oR,lR,cR,uR,pR,mR,bA,R_,yi,jc,jc,jc,jc,jc,jc,jc,jc,jc,jc,jc,jc,jc];var fk=[Hc,Pw,lI,Tv,tC,AC,UC,AA,KT,BA,KA,Hc,Hc,Hc,Hc,Hc];var mk=[Xc,Ru];var gk=[Yc];var bk=[qc,sD,dw,xw,mM,FM,zM,yR,KR,tI,qc,qc,qc,qc,qc,qc];var yk=[Kc,fP,AP,SL,NL,YL,TS,MS,RS,YS,Bw,YM,DR,kR,LI,rC,PC,GC,sT,tA,$A,$y,bC,FE,Ub,nM,jE,fD,TD,ND,Ob,Ny,bi,Fl,Nl,oh,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc,Kc];var vk=[Zc,nP,sL,Oy,dh,lh,vh,Zc];var Sk=[Qc,uM,xI,fT,jT,Qc,Qc,Qc];var xk=[$c,fC,Ow,II,RC,sA,hA,pA,VA,$c,$c,$c,$c,$c,$c,$c];var wk=[Jc,kv,Gv,yS];var Ck=[t_,Vx,Wx,t_];var Tk=[e_];var Ak=[i_,AT,aT,i_];var Ek=[n_,$D];var Mk=[s_,nv,sv,s_];var Rk=[r_,jP,HP,EL,OL,kS,NS,LS,HS,dx,Rx,Hx,Qx,Jx,RA,dE,ay,ly,vy,P_,Mu,r_,r_,r_,r_,r_,r_,r_,r_,r_,r_,r_];var Ik=[o_,Ix,Xx,pE,kE,eM,_D,wD,FD,Db,by,Sy,L_,ik,nk,o_];var Pk=[a_,WD,ek,a_];var Lk=[l_,wE];var Dk=[h_,Ab,Eb,h_];var kk=[c_,mC];var Ok=[__];var Fk=[u_,Sx,wx,u_];var Bk=[d_,tk];var Nk=[p_,JI,qP,p_];var Uk=[f_,sw,RM,DM,OM,UR,Nv,cS,LE,CE,f_,f_,f_,f_,f_,f_];var Vk=[m_,tP,lP,gP,SP,wP,TP,tL,pL,QP,WP,CL,PL,DL,BL,gx,iw,nw,vw,pC,yT,Nw,zw,Hw,EM,MM,PM,LM,wR,ER,WR,_I,uI,fI,yI,wI,Iv,FI,OI,qw,Zw,oC,hC,jC,HC,rT,oT,uT,DT,kT,zT,eA,iA,aA,uA,EA,zA,WA,_v,uv,Fv,Bv,lS,hS,BE,mD,RD,ID,qb,vi,zS,ET,MT,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_,m_];var zk=[g_,b_,$l,Jl];var Wk=[y_,GP,nE,oE,_E,qy,y_,y_];var Gk=[v_,Yb];var jk=[S_,iP,sP,nL,lL,IS,ix,cx,Lx,rx,ox,hx,fS,gS,Ew,Rw,Uw,vT,jw,Yw,dM,bM,CR,MR,oI,dI,bI,SI,xv,DI,$w,aC,wC,BC,XC,DA,lT,_T,pT,BT,VT,GT,FT,YT,nA,lA,dA,SA,wA,MA,FA,GA,XA,JA,Zy,Ev,Rv,Lv,HD,Gb,iy,A_,fh,_h,Ch,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_,S_];return{_emscripten_bind_btCylinderShape___destroy___0:Mm,_emscripten_bind_btGeneric6DofConstraint_enableFeedback_1:bb,_emscripten_bind_btHingeConstraint_setBreakingImpulseThreshold_1:Pi,_emscripten_bind_btDispatcherInfo_set_m_useContinuous_1:qg,_emscripten_bind_btCollisionObject_isActive_0:Tp,_emscripten_bind_btVehicleTuning_set_m_frictionSlip_1:Xa,_emscripten_bind_btDiscreteDynamicsWorld_btDiscreteDynamicsWorld_4:cg,_emscripten_bind_btCapsuleShapeX_getMargin_0:$d,_emscripten_bind_btCompoundShape_getMargin_0:of,_emscripten_bind_RaycastInfo_set_m_wheelDirectionWS_1:Rd,_emscripten_bind_btContactSolverInfo___destroy___0:Kf,_emscripten_bind_ClosestRayResultCallback_get_m_hitPointWorld_0:pu,_emscripten_bind_btPairCachingGhostObject_getCollisionFlags_0:Pn,_emscripten_bind_btQuaternion_setX_1:Es,_emscripten_bind_btCylinderShapeZ_getMargin_0:Tm,_emscripten_bind_btDispatcherInfo_get_m_timeOfImpact_0:Og,_emscripten_bind_btQuaternion_setZ_1:Rs,_emscripten_bind_btCapsuleShapeZ_getMargin_0:sp,_emscripten_bind_btKinematicCharacterController_setMaxSlope_1:Ki,_emscripten_bind_btQuadWord_z_0:Ss,_emscripten_bind_btVehicleTuning_get_m_suspensionStiffness_0:Ha,_emscripten_bind_btWheelInfo_get_m_suspensionRestLength1_0:ll,_emscripten_bind_btWheelInfo_get_m_suspensionStiffness_0:hl,_emscripten_bind_btGeneric6DofSpring2Constraint_getBreakingImpulseThreshold_0:xe,_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingThresholdSqr_1:lr,_emscripten_bind_RaycastInfo_get_m_wheelAxleWS_0:vd,_emscripten_bind_btRigidBodyConstructionInfo_get_m_angularDamping_0:tr,_emscripten_bind_btCollisionDispatcher___destroy___0:pp,_emscripten_bind_btRigidBody_applyCentralImpulse_1:wr,_emscripten_bind_btConvexHullShape_getMargin_0:rm,_emscripten_bind_btDefaultMotionState_getWorldTransform_1:Km,_emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_1:Tg,_emscripten_bind_btRaycastVehicle_getNumWheels_0:Ns,_emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_3:Eg,_emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_2:Ag,_emscripten_bind_btVector3_op_mul_1:ua,_emscripten_bind_btDynamicsWorld_rayTest_3:db,_emscripten_bind_btRaycastVehicle_updateWheelTransform_2:Hs,_emscripten_bind_btQuadWord_x_0:ys,_emscripten_bind_btCollisionObject_isKinematicObject_0:Ap,_emscripten_bind_btWheelInfo_set_m_chassisConnectionPointCS_1:fl,_emscripten_bind_ConvexResultCallback___destroy___0:ku,_emscripten_bind_btGeneric6DofSpringConstraint_setLinearUpperLimit_1:Ge,_emscripten_bind_ClosestConvexResultCallback_set_m_hitNormalWorld_1:ou,_emscripten_bind_btWheelInfo_set_m_wheelsSuspensionForce_1:Ml,_emscripten_bind_btRigidBody_getCenterOfMassTransform_0:Pr,_emscripten_bind_btGhostObject_isKinematicObject_0:ii,_emscripten_bind_btGeneric6DofSpringConstraint_btGeneric6DofSpringConstraint_5:ke,_emscripten_bind_btCapsuleShape___destroy___0:ap,_emscripten_bind_btCollisionObject_activate_1:vp,_emscripten_bind_btCollisionObject_activate_0:yp,_emscripten_bind_btGeneric6DofSpring2Constraint_getRotationalLimitMotor_1:we,_emscripten_bind_btKinematicCharacterController_setUpAxis_1:Zi,_emscripten_bind_btDispatcherInfo_set_m_timeOfImpact_1:Xg,_emscripten_bind_btGeneric6DofSpring2Constraint_setAngularUpperLimit_1:Ae,_emscripten_bind_btTranslationalLimitMotor2___destroy___0:Go,_emscripten_bind_btCollisionDispatcher_btCollisionDispatcher_1:fp,_emscripten_bind_btVector3_setX_1:fa,_emscripten_bind_btCollisionConfiguration___destroy___0:dp,_emscripten_bind_btCapsuleShapeZ_setMargin_1:op,_emscripten_bind_btHingeConstraint_enableFeedback_1:Ri,_emscripten_bind_btSphereShape___destroy___0:wo,_emscripten_bind_btGeneric6DofConstraint_setAngularLowerLimit_1:vb,_emscripten_bind_btManifoldPoint_set_m_localPointB_1:un,_emscripten_bind_btVector3_setZ_1:ga,_emscripten_bind_btKinematicCharacterController_setUseGhostSweepTest_1:Qi,_emscripten_bind_btQuaternion_setValue_4:Ts,_emscripten_bind_btDynamicsWorld_getBroadphase_0:lb,_emscripten_bind_LocalShapeInfo___destroy___0:td,_emscripten_bind_btPoint2PointConstraint_get_m_setting_0:ls,_emscripten_bind_btQuadWord_setY_1:ms,_emscripten_bind_btRigidBodyConstructionInfo_set_m_restitution_1:gr,_emscripten_bind_btDefaultMotionState_get_m_graphicsWorldTrans_0:Zm,_emscripten_bind_btSliderConstraint_btSliderConstraint_5:fo,_emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_3:hg,_emscripten_bind_btPairCachingGhostObject_btPairCachingGhostObject_0:Rn,_emscripten_bind_btDiscreteDynamicsWorld_getSolverInfo_0:yg,_emscripten_bind_btCylinderShape_setMargin_1:Dm,_emscripten_bind_btCollisionWorld___destroy___0:zp,_emscripten_bind_LocalConvexResult_get_m_hitPointLocal_0:Yu,_emscripten_bind_btBoxShape_btBoxShape_1:Nd,_emscripten_bind_btPersistentManifold_getBody1_0:$n,_emscripten_bind_ClosestRayResultCallback_set_m_collisionObject_1:vu,_emscripten_bind_RaycastInfo_set_m_isInContact_1:Ad,_emscripten_bind_btKinematicCharacterController_setGravity_1:Xi,_emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_5:gb,_emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_3:mb,_emscripten_bind_btQuaternion_setY_1:Ms,_emscripten_bind_btWheelInfo_get_m_rollInfluence_0:ol,_emscripten_bind_btTypedConstraint_setBreakingImpulseThreshold_1:sa,_emscripten_bind_btBvhTriangleMeshShape_setLocalScaling_1:qd,_emscripten_bind_btPoint2PointConstraint_setBreakingImpulseThreshold_1:hs,_emscripten_bind_btDynamicsWorld_getDispatchInfo_0:hb,_emscripten_bind_btCompoundShape_removeChildShapeByIndex_1:lf,_emscripten_bind_btGeneric6DofSpring2Constraint_enableSpring_2:Se,_emscripten_bind_btVector3_length_0:ha,_emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_2:dm,_emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_1:um,_emscripten_bind_ClosestConvexResultCallback_set_m_hitPointWorld_1:au,_emscripten_bind_RayResultCallback_set_m_collisionFilterMask_1:_d,_emscripten_bind_btBoxShape_getMargin_0:Vd,_emscripten_bind_btPairCachingGhostObject___destroy___0:An,_emscripten_bind_btPairCachingGhostObject_activate_0:En,_emscripten_bind_btPairCachingGhostObject_activate_1:Mn,_emscripten_bind_btContactSolverInfo_get_m_splitImpulsePenetrationThreshold_0:Zf,_emscripten_bind_btPairCachingGhostObject_forceActivationState_1:In,_emscripten_bind_btDefaultMotionState___destroy___0:zm,_emscripten_bind_btDispatcherInfo_get_m_stepCount_0:kg,_emscripten_bind_btRigidBodyConstructionInfo_set_m_angularDamping_1:ur,_emscripten_bind_btQuadWord_setW_1:ps,_emscripten_bind_btRigidBodyConstructionInfo_get_m_friction_0:ir,_emscripten_bind_btCapsuleShapeX_btCapsuleShapeX_2:Zd,_emscripten_bind_LocalShapeInfo_set_m_shapePart_1:nd,_emscripten_bind_btRigidBody_setLinearFactor_1:Qr,_emscripten_bind_btDispatcherInfo_set_m_useConvexConservativeDistanceUtil_1:Kg,_emscripten_bind_btWheelInfo_get_m_engineForce_0:el,_emscripten_bind_btRaycastVehicle_setSteeringValue_2:js,_emscripten_enum_RotateOrder_RO_YXZ:Pl,_emscripten_bind_btPoint2PointConstraint___destroy___0:es,_emscripten_bind_btGeneric6DofConstraint_setAngularUpperLimit_1:Sb,_emscripten_bind_btDiscreteDynamicsWorld_addConstraint_2:ag,_emscripten_bind_btDiscreteDynamicsWorld_addConstraint_1:og,_emscripten_bind_btRigidBodyConstructionInfo_set_m_angularSleepingThreshold_1:dr,_malloc:Zl,_emscripten_bind_btDispatcherInfo_get_m_useEpa_0:Ug,_memmove:Fh,_emscripten_bind_btTransform_btTransform_2:Fo,_emscripten_bind_btTransform_btTransform_0:Oo,_emscripten_bind_btVector3_op_sub_1:da,_emscripten_bind_btWheelInfo_set_m_wheelsRadius_1:El,_emscripten_bind_btDispatcherInfo_set_m_enableSPU_1:Gg,_emscripten_bind_btWheelInfo_set_m_wheelsDampingCompression_1:Tl,_emscripten_bind_btCollisionObject_setActivationState_1:Ep,_emscripten_bind_btPersistentManifold___destroy___0:Kn,_emscripten_bind_btConstraintSetting_get_m_impulseClamp_0:Gf,_emscripten_bind_btCylinderShapeZ___destroy___0:xm,_emscripten_bind_btMatrix3x3___destroy___0:mn,_emscripten_bind_ConvexResultCallback_hasHit_0:Nu,_emscripten_bind_btCollisionShape_calculateLocalInertia_2:Up,_emscripten_bind_btGeneric6DofSpringConstraint_setBreakingImpulseThreshold_1:Ve,_emscripten_bind_btCollisionWorld_convexSweepTest_5:Yp,_emscripten_bind_ClosestRayResultCallback_set_m_hitPointWorld_1:xu,_emscripten_bind_btCapsuleShapeX_calculateLocalInertia_2:Qd,_emscripten_bind_btConstraintSetting_set_m_damping_1:Hf,_emscripten_bind_btVehicleRaycaster___destroy___0:Na,_emscripten_bind_btRigidBody_setCcdMotionThreshold_1:Gr,_emscripten_bind_btConvexHullShape_setMargin_1:am,_emscripten_bind_btRigidBody_applyForce_2:Cr,_emscripten_bind_btConeShapeZ_calculateLocalInertia_2:vf,_emscripten_bind_btConstraintSetting_set_m_tau_1:Yf,_emscripten_bind_btConvexHullShape_calculateLocalInertia_2:sm,_emscripten_bind_RaycastInfo_get_m_contactPointWS_0:fd,_emscripten_bind_btSphereShape_calculateLocalInertia_2:To,_emscripten_bind_btWheelInfo_get_m_chassisConnectionPointCS_0:tl,_emscripten_bind_btDynamicsWorld_contactTest_2:ob,_emscripten_bind_ClosestRayResultCallback_get_m_rayToWorld_0:mu,_emscripten_bind_btGhostObject_setFriction_1:ci,_emscripten_bind_btCollisionWorld_rayTest_3:$p,_emscripten_bind_btRigidBody_setCcdSweptSphereRadius_1:jr,_emscripten_bind_btCylinderShapeZ_setMargin_1:Em,_emscripten_bind_btRigidBody_setFriction_1:Zr,_emscripten_bind_LocalConvexResult_set_m_hitPointLocal_1:$u,_emscripten_bind_btGhostObject_setWorldTransform_1:di,_emscripten_bind_btDiscreteDynamicsWorld_removeRigidBody_1:wg,_emscripten_bind_btTranslationalLimitMotor2_set_m_currentLinearDiff_1:Ho,_emscripten_bind_btConvexHullShape___destroy___0:tm,_emscripten_bind_btDiscreteDynamicsWorld_getBroadphase_0:pg,_emscripten_bind_btVector4_setX_1:Pa,_emscripten_bind_btKinematicCharacterController_jump_0:zi,_emscripten_bind_btWheelInfo_set_m_raycastInfo_1:vl,_emscripten_bind_btConeTwistConstraint_setMaxMotorImpulseNormalized_1:Ff,_emscripten_bind_btConvexTriangleMeshShape_setLocalScaling_1:fm,_emscripten_bind_btRigidBody_upcast_1:ro,_emscripten_bind_btCollisionObject_getWorldTransform_0:Cp,_emscripten_bind_btVector4_setZ_1:Da,_emscripten_bind_btManifoldPoint_set_m_positionWorldOnB_1:fn,___cxa_can_catch:Ah,_emscripten_bind_btTransform_getBasis_0:Bo,_emscripten_bind_btPairCachingGhostObject_setFriction_1:Hn,_emscripten_bind_btManifoldPoint___destroy___0:en,_emscripten_bind_btDispatcherInfo_set_m_useEpa_1:Zg,_emscripten_bind_btCollisionDispatcher_getNumManifolds_0:gp,_emscripten_bind_btWheelInfo_set_m_bIsFrontWheel_1:pl,_emscripten_bind_ClosestRayResultCallback___destroy___0:hu,_emscripten_bind_btGeneric6DofSpringConstraint_setStiffness_2:je,_emscripten_bind_btCylinderShapeX_setMargin_1:Sm,_emscripten_bind_btQuadWord_w_0:bs,_emscripten_bind_btGhostObject_setCcdMotionThreshold_1:ri,_emscripten_bind_btDiscreteDynamicsWorld_contactTest_2:ug,_emscripten_bind_btGeneric6DofSpring2Constraint_btGeneric6DofSpring2Constraint_3:be,_emscripten_bind_btBvhTriangleMeshShape_calculateLocalInertia_2:Yd,_emscripten_bind_btCompoundShape_getNumChildShapes_0:af,_emscripten_bind_btGhostObject_btGhostObject_0:qe,_emscripten_bind_ClosestConvexResultCallback_ClosestConvexResultCallback_2:H_,_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingFactor_1:ar,_emscripten_bind_btManifoldPoint_set_m_localPointA_1:_n,_emscripten_bind_LocalConvexResult___destroy___0:Gu,_emscripten_bind_btVector3_dot_1:la,_emscripten_bind_btVector4_op_add_1:Ea,_emscripten_bind_btWheelInfo___destroy___0:$a,_emscripten_bind_btTransform_setRotation_1:Wo,_emscripten_bind_btPairCachingGhostObject_getNumOverlappingObjects_0:Dn,_emscripten_bind_btPoint2PointConstraint_enableFeedback_1:ss,_emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterGroup_1:bu,_emscripten_bind_btAxisSweep3_btAxisSweep3_2:Dd,_emscripten_bind_btAxisSweep3_btAxisSweep3_3:kd,_emscripten_bind_btDynamicsWorld___destroy___0:tb,_emscripten_bind_btVector3_setY_1:ma,_emscripten_bind_btAxisSweep3_btAxisSweep3_4:Od,_emscripten_bind_btAxisSweep3_btAxisSweep3_5:Fd,_emscripten_bind_btQuadWord_setX_1:fs,_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalLinearDampingThresholdSqr_0:Js,_emscripten_bind_btGhostObject_isActive_0:ei,_emscripten_bind_btOverlappingPairCache___destroy___0:wn,_emscripten_bind_btVector3_normalize_0:ca,_emscripten_bind_btConstraintSetting___destroy___0:Vf,_emscripten_bind_RayResultCallback___destroy___0:rd,_emscripten_bind_RaycastInfo_get_m_contactNormalWS_0:pd,_emscripten_bind_btTranslationalLimitMotor2_get_m_currentLinearDiff_0:jo,_emscripten_bind_btPersistentManifold_getBody0_0:Qn,_emscripten_bind_btConeShapeX_btConeShapeX_2:ff,_emscripten_bind_btQuaternion_z_0:Ds,_emscripten_bind_btConeTwistConstraint_enableFeedback_1:Rf,_emscripten_bind_btStaticPlaneShape_calculateLocalInertia_2:Po,_emscripten_bind_btCapsuleShapeZ_setLocalScaling_1:rp,_emscripten_bind_btRigidBody_applyTorque_1:Er,_emscripten_bind_btSliderConstraint_setUpperLinLimit_1:xo,_emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_2:Ef,_emscripten_bind_btConcaveShape___destroy___0:_f,_emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_4:Mf,_emscripten_bind_btQuaternion_x_0:Ps,_emscripten_bind_LocalConvexResult_set_m_hitNormalLocal_1:Qu,_emscripten_bind_btConcaveShape_setLocalScaling_1:df,_emscripten_bind_btDiscreteDynamicsWorld_getDispatchInfo_0:fg,_emscripten_bind_btConeShapeX_setLocalScaling_1:gf,_emscripten_bind_btCylinderShapeZ_setLocalScaling_1:Am,_emscripten_bind_btConvexHullShape_btConvexHullShape_0:nm,_emscripten_bind_btWheelInfo_set_m_maxSuspensionForce_1:bl,_emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterMask_1:yu,_emscripten_bind_btRotationalLimitMotor2___destroy___0:ao,_emscripten_bind_btGhostObject___destroy___0:He,_emscripten_bind_btGhostObject_setContactProcessingThreshold_1:hi,_emscripten_bind_btCollisionWorld_getBroadphase_0:qp,_emscripten_bind_btQuaternion___destroy___0:xs,_emscripten_bind_btCollisionDispatcher_getManifoldByIndexInternal_1:mp,_emscripten_bind_btDefaultMotionState_btDefaultMotionState_2:qm,_emscripten_bind_btDefaultMotionState_btDefaultMotionState_0:Wm,_emscripten_bind_btDefaultMotionState_btDefaultMotionState_1:Ym,_pthread_self:Nh,_emscripten_bind_btCompoundShape_getChildShape_1:rf,_emscripten_bind_btKinematicCharacterController_canJump_0:Bi,_emscripten_bind_btVector4_length_0:Ta,_emscripten_bind_btRigidBody_isActive_0:Br,_emscripten_bind_btRaycastVehicle_btRaycastVehicle_3:Bs,_emscripten_bind_btMotionState_setWorldTransform_1:xn,_emscripten_bind_btCylinderShape_setLocalScaling_1:Lm,_emscripten_bind_btPairCachingGhostObject_getWorldTransform_0:On,_emscripten_bind_btCompoundShape_calculateLocalInertia_2:sf,_emscripten_bind_btCollisionWorld_getDispatchInfo_0:Kp,_emscripten_bind_btRigidBody_setCollisionShape_1:Yr,_emscripten_bind_btConeShapeX___destroy___0:pf,_emscripten_bind_btCollisionObject_getCollisionFlags_0:xp,_emscripten_bind_btDispatcherInfo_set_m_enableSatConvex_1:jg,_emscripten_bind_btConeTwistConstraint_enableMotor_1:If,_emscripten_bind_btRaycastVehicle_setCoordinateSystem_3:Gs,_emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_4:Fi,_emscripten_bind_btPairCachingGhostObject_setRestitution_1:Xn,_emscripten_bind_btBroadphaseInterface___destroy___0:Gd,_emscripten_bind_btSliderConstraint_getBreakingImpulseThreshold_0:go,_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDampingFactor_1:hr,_emscripten_bind_btCollisionObject_setContactProcessingThreshold_1:Dp,_emscripten_bind_btCompoundShape___destroy___0:Jp,_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingFactor_0:Ks,_emscripten_bind_btCapsuleShapeX_setMargin_1:tp,_emscripten_bind_btSequentialImpulseConstraintSolver___destroy___0:co,_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalLinearDampingThresholdSqr_1:_r,_emscripten_bind_btRigidBody_getCollisionFlags_0:Lr,_emscripten_bind_btCollisionShape_setLocalScaling_1:Vp,_emscripten_bind_ClosestConvexResultCallback_get_m_closestHitFraction_0:Y_,_emscripten_bind_LocalConvexResult_get_m_hitCollisionObject_0:ju,_emscripten_bind_btMatrix3x3_setEulerZYX_3:yn,_emscripten_bind_btRigidBody_setRollingFriction_1:io,_emscripten_bind_btDispatcherInfo_get_m_convexConservativeDistanceThreshold_0:Ig,_emscripten_bind_ClosestRayResultCallback_get_m_hitNormalWorld_0:du,_emscripten_bind_btRigidBody_setMotionState_1:to,_emscripten_bind_RayResultCallback_get_m_collisionFilterMask_0:ad,_emscripten_bind_btCollisionWorld_getDispatcher_0:Zp,_emscripten_bind_btVector4_dot_1:Ca,_emscripten_bind_btCollisionObject_setRollingFriction_1:Fp,_emscripten_bind_RayResultCallback_set_m_collisionFilterGroup_1:cd,_emscripten_bind_btTriangleMesh_btTriangleMesh_1:Jo,_emscripten_bind_btRotationalLimitMotor2_get_m_currentPosition_0:lo,_i64Subtract:Rh,_emscripten_bind_btCylinderShapeX_getMargin_0:ym,_emscripten_bind_btRigidBody_setDamping_2:Kr,_emscripten_bind_btDynamicsWorld_getDispatcher_0:cb,_emscripten_bind_btGhostObject_setCollisionFlags_1:ai,_emscripten_bind_btMatrix3x3_getRotation_1:gn,_emscripten_bind_btWheelInfo_set_m_engineForce_1:ml,_emscripten_bind_btConeTwistConstraint_setMaxMotorImpulse_1:Bf,_emscripten_bind_btPersistentManifold_getNumContacts_0:ts,_emscripten_bind_btCylinderShapeX_setLocalScaling_1:vm,_emscripten_bind_btDbvtBroadphase_btDbvtBroadphase_0:Om,_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDamping_0:$s,_emscripten_bind_btCompoundShape_setLocalScaling_1:hf,_emscripten_bind_btOverlappingPairCallback___destroy___0:Tn,_emscripten_bind_btDynamicsWorld_convexSweepTest_5:ab,_emscripten_bind_btCylinderShape_calculateLocalInertia_2:Im,_emscripten_bind_btPairCachingGhostObject_setCcdSweptSphereRadius_1:zn,_emscripten_bind_btRigidBody_getCollisionShape_0:Dr,_emscripten_bind_btRigidBody_setContactProcessingThreshold_1:qr,_emscripten_bind_btRigidBody_getLinearVelocity_0:kr,_emscripten_bind_btRigidBody_applyImpulse_2:Tr,_emscripten_bind_btConcaveShape_calculateLocalInertia_2:uf,_emscripten_bind_RaycastInfo_get_m_groundObject_0:md,_emscripten_bind_btRigidBody_setWorldTransform_1:so,_emscripten_bind_btRigidBody_setAngularVelocity_1:zr,_emscripten_bind_btGeneric6DofSpringConstraint_btGeneric6DofSpringConstraint_3:De,_emscripten_bind_btConvexShape_setLocalScaling_1:cm,_emscripten_bind_btTriangleMeshShape_calculateLocalInertia_2:Yo,_free:Ql,_emscripten_bind_btPairCachingGhostObject_setContactProcessingThreshold_1:jn,_emscripten_bind_btGeneric6DofConstraint_setLinearUpperLimit_1:Cb,_emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterMask_0:_u,_emscripten_bind_RayResultCallback_hasHit_0:hd,_bitshift64Shl:Lh,_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingThresholdSqr_0:Zs,_emscripten_bind_btVehicleTuning_get_m_suspensionDamping_0:ja,_emscripten_bind_btRaycastVehicle_getWheelTransformWS_1:zs,_emscripten_bind_btQuaternion_normalize_0:Cs,_emscripten_bind_ClosestConvexResultCallback_get_m_convexToWorld_0:Q_,_emscripten_bind_btQuadWord_setZ_1:gs,_emscripten_bind_btConeShapeZ_setLocalScaling_1:Sf,_emscripten_bind_btPairCachingGhostObject_setActivationState_1:Nn,_emscripten_bind_btGeneric6DofSpringConstraint___destroy___0:Le,_emscripten_bind_btConvexTriangleMeshShape___destroy___0:_m,_emscripten_bind_btVehicleTuning_set_m_maxSuspensionTravelCm_1:qa,_emscripten_bind_btGhostObject_setRollingFriction_1:ui,_emscripten_bind_btCylinderShapeZ_btCylinderShapeZ_1:wm,_emscripten_bind_btRigidBody_getAngularVelocity_0:Ir,_emscripten_bind_btCompoundShape_btCompoundShape_0:ef,_emscripten_bind_btCompoundShape_btCompoundShape_1:nf,_emscripten_bind_btOverlappingPairCache_setInternalGhostPairCallback_1:Cn,_emscripten_bind_btStaticPlaneShape_btStaticPlaneShape_2:Io,_emscripten_bind_btSphereShape_getMargin_0:Ao,_emscripten_bind_btDispatcherInfo_get_m_useContinuous_0:Bg,_emscripten_bind_btRigidBody_updateInertiaTensor_0:oo,_emscripten_bind_btPairCachingGhostObject_setAnisotropicFriction_2:Un,_emscripten_bind_btTransform_setOrigin_1:zo,_emscripten_bind_ClosestRayResultCallback_hasHit_0:gu,_emscripten_bind_btCompoundShape_addChildShape_2:tf,_emscripten_bind_btDispatcher___destroy___0:Qg,_emscripten_bind_btVehicleTuning_get_m_suspensionCompression_0:Ga,_emscripten_bind_btDiscreteDynamicsWorld___destroy___0:eg,_emscripten_bind_btConvexShape___destroy___0:lm,_emscripten_bind_btGeneric6DofSpring2Constraint_setLinearLowerLimit_1:Re,_emscripten_bind_btCapsuleShapeX_setLocalScaling_1:Jd,_emscripten_bind_btQuadWord_y_0:vs,_emscripten_bind_btCollisionObject_setRestitution_1:Op,_emscripten_bind_btRigidBody_applyCentralForce_1:xr,_emscripten_bind_LocalConvexResult_get_m_hitFraction_0:Hu,_emscripten_bind_btDispatcherInfo_get_m_enableSPU_0:Lg,_emscripten_bind_btQuaternion_w_0:Is,_emscripten_bind_ConvexResultCallback_get_m_collisionFilterGroup_0:Fu,_emscripten_bind_btTransform_getRotation_0:Uo,_emscripten_bind_btHingeConstraint_btHingeConstraint_6:Ai,_emscripten_bind_btHingeConstraint_btHingeConstraint_7:Ei,_emscripten_bind_LocalConvexResult_get_m_hitNormalLocal_0:Xu,_emscripten_bind_btHingeConstraint_btHingeConstraint_5:Ti,_emscripten_bind_btHingeConstraint_btHingeConstraint_2:xi,_emscripten_bind_btHingeConstraint_btHingeConstraint_3:wi,_emscripten_bind_RaycastInfo___destroy___0:dd,_emscripten_bind_btBoxShape_setMargin_1:Wd,_emscripten_bind_ClosestConvexResultCallback_get_m_hitNormalWorld_0:$_,_emscripten_bind_btMatrix3x3_getRow_1:bn,_emscripten_bind_btTypedConstraint___destroy___0:ea,_emscripten_bind_btCylinderShapeX_btCylinderShapeX_1:gm,_emscripten_enum_RotateOrder_RO_XYZ:Rl,_emscripten_bind_btGeneric6DofSpringConstraint_setAngularUpperLimit_1:Ue,_emscripten_bind_btConeTwistConstraint_setDamping_1:kf,_emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_1:lg,_bitshift64Ashr:Dh,_emscripten_bind_btQuaternion_btQuaternion_4:ws,_emscripten_bind_btSphereShape_btSphereShape_1:Co,_emscripten_bind_btWheelInfo_get_m_wheelsSuspensionForce_0:dl,_emscripten_bind_btQuaternion_y_0:Ls,_emscripten_bind_btCollisionWorld_addCollisionObject_1:Wp,_emscripten_bind_btCollisionWorld_addCollisionObject_2:Gp,_emscripten_bind_btCollisionWorld_addCollisionObject_3:jp,_emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterGroup_1:iu,_emscripten_bind_btConeTwistConstraint_setBreakingImpulseThreshold_1:Df,_emscripten_bind_RaycastInfo_get_m_isInContact_0:bd,_emscripten_bind_btGeneric6DofSpring2Constraint_setLinearUpperLimit_1:Ie,_emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterGroup_0:q_,_emscripten_bind_btCapsuleShape_setMargin_1:up,_emscripten_bind_btDefaultVehicleRaycaster_btDefaultVehicleRaycaster_1:tg,_emscripten_bind_ConcreteContactResultCallback_addSingleResult_7:Pu,_emscripten_bind_btManifoldPoint_get_m_positionWorldOnB_0:cn,_emscripten_bind_btSequentialImpulseConstraintSolver_btSequentialImpulseConstraintSolver_0:_o,_emscripten_bind_btActionInterface___destroy___0:Pd,_emscripten_bind_btDefaultMotionState_setWorldTransform_1:Qm,_emscripten_bind_btCollisionWorld_contactTest_2:Xp,_emscripten_bind_RayResultCallback_get_m_collisionObject_0:ld,_emscripten_bind_btPoint2PointConstraint_getPivotInA_0:os,_emscripten_bind_ClosestConvexResultCallback_get_m_convexFromWorld_0:Z_,_emscripten_bind_btVector4_setY_1:La,_emscripten_bind_btCompoundShape_setMargin_1:cf,_emscripten_bind_btGhostObject_setRestitution_1:_i,_emscripten_bind_btDynamicsWorld_addCollisionObject_1:ib,_emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterMask_0:K_,_emscripten_bind_btDynamicsWorld_addCollisionObject_3:sb,_emscripten_bind_btDynamicsWorld_addCollisionObject_2:nb,_emscripten_bind_btDiscreteDynamicsWorld_getDispatcher_0:mg,_emscripten_bind_btWheelInfo_get_m_maxSuspensionTravelCm_0:sl,_emscripten_bind_btVector4_op_mul_1:Ma,_emscripten_bind_btCylinderShape_btCylinderShape_1:Rm,_emscripten_bind_btRotationalLimitMotor2_set_m_currentPosition_1:ho,_emscripten_bind_btVector3___destroy___0:ra,_bitshift64Lshr:kh,_emscripten_bind_btRigidBody_setAngularFactor_1:Vr,_emscripten_bind_btCylinderShapeZ_calculateLocalInertia_2:Cm,_emscripten_bind_btWheelInfo_set_m_steering_1:xl,_emscripten_bind_btMotionState_getWorldTransform_1:Sn,_emscripten_bind_btDynamicsWorld_getSolverInfo_0:ub,_emscripten_bind_btDispatcherInfo_set_m_dispatchFunc_1:Wg,_emscripten_bind_btDispatcherInfo_set_m_convexConservativeDistanceThreshold_1:zg,_emscripten_bind_btGeneric6DofSpring2Constraint_btGeneric6DofSpring2Constraint_5:ye,_emscripten_bind_btVector3_x_0:ba,___cxa_is_pointer_type:Eh,_emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_3:Ys,_emscripten_bind_btCollisionObject_getCollisionShape_0:wp,_emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_4:qs,_emscripten_bind_btBoxShape_calculateLocalInertia_2:Ud,_emscripten_bind_btRigidBodyConstructionInfo_set_m_rollingFriction_1:br,_emscripten_bind_btVector3_z_0:va,_emscripten_bind_btDefaultMotionState_set_m_graphicsWorldTrans_1:$m,_emscripten_bind_ClosestConvexResultCallback___destroy___0:X_,_emscripten_bind_btDefaultCollisionConstructionInfo___destroy___0:Um,_emscripten_bind_btCollisionObject_setFriction_1:kp,_emscripten_bind_btDefaultCollisionConfiguration___destroy___0:Fm,_emscripten_bind_btRigidBody_setMassProps_2:Jr,_emscripten_bind_btVector3_setValue_3:pa,_emscripten_bind_btPairCachingGhostObject_setCcdMotionThreshold_1:Vn,_emscripten_bind_RaycastInfo_get_m_suspensionLength_0:yd,_emscripten_bind_btGhostObject_getCollisionFlags_0:Ze,_emscripten_bind_btCapsuleShapeX___destroy___0:Kd,_emscripten_bind_btHingeConstraint_setLimit_4:Li,_emscripten_bind_btHingeConstraint_setLimit_5:Di,_emscripten_bind_btWheelInfo_get_m_wheelsDampingRelaxation_0:_l,_emscripten_bind_btWheelInfo_set_m_maxSuspensionTravelCm_1:yl,_emscripten_bind_btConeShape_setLocalScaling_1:Tf,_emscripten_bind_btKinematicCharacterController_setJumpSpeed_1:Yi,_emscripten_bind_btTypedConstraint_getBreakingImpulseThreshold_0:na,_emscripten_bind_btGhostObject_getCollisionShape_0:Qe,_emscripten_bind_btCollisionObject_setAnisotropicFriction_2:Mp,_emscripten_bind_btBoxShape___destroy___0:Bd,_emscripten_bind_btWheelInfo_get_m_bIsFrontWheel_0:Ja,_emscripten_bind_btPersistentManifold_getContactPoint_1:Jn,_emscripten_bind_btVector3_btVector3_0:oa,_emscripten_bind_btGeneric6DofSpringConstraint_getBreakingImpulseThreshold_0:Be,_emscripten_bind_btConeShapeX_calculateLocalInertia_2:mf,_emscripten_bind_RaycastInfo_set_m_groundObject_1:Cd,_emscripten_bind_btGhostObject_activate_1:Ye,_emscripten_bind_btGeneric6DofSpringConstraint_enableSpring_2:Fe,_emscripten_bind_btManifoldPoint_getPositionWorldOnB_0:rn,_emscripten_bind_btManifoldPoint_get_m_positionWorldOnA_0:hn,_emscripten_bind_btGeneric6DofSpringConstraint_enableFeedback_1:Oe,_emscripten_bind_btSphereShape_setMargin_1:Mo,_emscripten_bind_btRigidBodyConstructionInfo___destroy___0:Xs,_emscripten_bind_btConeShapeZ_btConeShapeZ_2:yf,_emscripten_bind_btContactSolverInfo_set_m_splitImpulsePenetrationThreshold_1:$f,_emscripten_bind_btSliderConstraint_setUpperAngLimit_1:So,_emscripten_bind_btDynamicsWorld_contactPairTest_3:rb,_emscripten_bind_btCollisionWorld_getPairCache_0:Qp,_emscripten_bind_btConeTwistConstraint_setMotorTarget_1:Uf,_emscripten_bind_ClosestConvexResultCallback_set_m_convexFromWorld_1:su,_emscripten_bind_btWheelInfo_set_m_rollInfluence_1:Sl,_emscripten_bind_btRigidBody_getWorldTransform_0:Fr,_emscripten_bind_btDefaultCollisionConstructionInfo_btDefaultCollisionConstructionInfo_0:Vm,_emscripten_bind_btGhostObject_forceActivationState_1:Ke,_emscripten_bind_ConcreteContactResultCallback_ConcreteContactResultCallback_0:Tu,_emscripten_bind_VoidPtr___destroy___0:Id,_emscripten_bind_btSliderConstraint_setLowerAngLimit_1:yo,_emscripten_bind_btVector4_op_sub_1:Ra,_emscripten_bind_RaycastInfo_set_m_contactPointWS_1:wd,_emscripten_bind_btConeShape_btConeShape_2:wf,_emscripten_bind_ClosestRayResultCallback_get_m_rayFromWorld_0:fu,_emscripten_bind_btRaycastVehicle_getRigidBody_0:Us,_emscripten_enum_RotateOrder_RO_YZX:Ll,_emscripten_bind_RayResultCallback_get_m_collisionFilterGroup_0:od,_emscripten_bind_btWheelInfo_get_m_steering_0:al,_emscripten_bind_btConstraintSetting_get_m_tau_0:jf,_emscripten_bind_btSliderConstraint___destroy___0:uo,_emscripten_bind_btCollisionObject_setCollisionShape_1:Lp,_emscripten_bind_btCollisionShape___destroy___0:Np,_emscripten_bind_ConvexResultCallback_get_m_closestHitFraction_0:Ou,_emscripten_bind_btDispatcherInfo_get_m_dispatchFunc_0:Pg,_emscripten_bind_btRigidBodyConstructionInfo_get_m_rollingFriction_0:or,_emscripten_bind_btPairCachingGhostObject_setCollisionShape_1:Gn,_emscripten_bind_btKinematicCharacterController_warp_1:tn,_emscripten_bind_btAxisSweep3___destroy___0:Ld,_emscripten_bind_btTriangleMesh___destroy___0:Ko,_emscripten_bind_btKinematicCharacterController_preStep_1:ji,_emscripten_bind_btRaycastVehicle_applyEngineForce_2:Fs,_emscripten_bind_btRaycastVehicle_setBrake_2:Ws,_emscripten_bind_ConcreteContactResultCallback___destroy___0:Iu,_emscripten_bind_RaycastInfo_set_m_wheelAxleWS_1:Md,_emscripten_bind_btGeneric6DofSpring2Constraint_setAngularLowerLimit_1:Te,_emscripten_bind_btCollisionObject___destroy___0:bp,_emscripten_bind_btVehicleTuning_set_m_suspensionDamping_1:Za,_emscripten_bind_btRigidBodyConstructionInfo_set_m_linearSleepingThreshold_1:mr,_emscripten_bind_btConeTwistConstraint_setMotorTargetInConstraintSpace_1:Nf,_emscripten_bind_btDispatcherInfo_set_m_timeStep_1:Yg,_emscripten_bind_btVector3_btVector3_3:aa,_emscripten_bind_RaycastInfo_set_m_contactNormalWS_1:xd,_emscripten_bind_btRigidBodyConstructionInfo_set_m_friction_1:pr,_emscripten_bind_btDiscreteDynamicsWorld_getGravity_0:gg,_emscripten_bind_ClosestConvexResultCallback_get_m_hitPointWorld_0:J_,_emscripten_bind_btRigidBody_isKinematicObject_0:Nr,_emscripten_bind_btGeneric6DofSpring2Constraint_setStiffness_2:Pe,_emscripten_bind_RaycastInfo_get_m_hardPointWS_0:gd,_emscripten_bind_btConeTwistConstraint___destroy___0:Af,_emscripten_bind_btQuadWord___destroy___0:ds,_emscripten_bind_ClosestRayResultCallback_set_m_rayFromWorld_1:wu,_emscripten_bind_btGeneric6DofSpringConstraint_setDamping_2:ze,_emscripten_bind_RaycastInfo_get_m_wheelDirectionWS_0:Sd,_emscripten_bind_btSliderConstraint_setBreakingImpulseThreshold_1:bo,_emscripten_bind_btGhostObject_setAnisotropicFriction_2:si,_emscripten_bind_btConstraintSolver___destroy___0:qf,_emscripten_bind_btDbvtBroadphase___destroy___0:km,_emscripten_bind_btCapsuleShape_btCapsuleShape_2:lp,_emscripten_bind_btTypedConstraint_enableFeedback_1:ia,_emscripten_bind_btGhostObject_activate_0:Xe,_emscripten_bind_btCapsuleShape_setLocalScaling_1:_p,_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDampingFactor_0:Qs,_emscripten_bind_btRigidBody_setAnisotropicFriction_2:Wr,_emscripten_bind_btTriangleMeshShape_setLocalScaling_1:qo,_emscripten_bind_ConvexResultCallback_set_m_closestHitFraction_1:Uu,_emscripten_bind_btVector3_op_add_1:_a,_emscripten_bind_btPersistentManifold_btPersistentManifold_0:Zn,_emscripten_bind_ConvexResultCallback_get_m_collisionFilterMask_0:Bu,_emscripten_bind_ClosestRayResultCallback_ClosestRayResultCallback_2:lu,_emscripten_bind_btVector4___destroy___0:Sa,_emscripten_bind_btPairCachingGhostObject_isKinematicObject_0:Bn,_emscripten_bind_btConstraintSetting_get_m_damping_0:Wf,_i64Add:Ih,_emscripten_bind_btContactSolverInfo_set_m_splitImpulse_1:Jf,_emscripten_bind_btVehicleTuning_set_m_maxSuspensionForce_1:Ya,_emscripten_bind_btCollisionObject_setCcdMotionThreshold_1:Rp,_emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_0:Bm,_emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_1:Nm,_emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_3:Oi,_emscripten_bind_btRigidBodyConstructionInfo_get_m_angularSleepingThreshold_0:er,_emscripten_bind_btPoint2PointConstraint_getPivotInB_0:as,_emscripten_bind_btKinematicCharacterController_playerStep_2:Gi,_emscripten_bind_btDispatcherInfo___destroy___0:Mg,_emscripten_bind_btCapsuleShape_getMargin_0:cp,_emscripten_bind_btCylinderShape_getMargin_0:Pm,_emscripten_bind_btStaticPlaneShape_setLocalScaling_1:Lo,_emscripten_bind_btConvexTriangleMeshShape_calculateLocalInertia_2:pm,_emscripten_bind_ContactResultCallback_addSingleResult_7:Du,_emscripten_bind_btGhostObject_getWorldTransform_0:ti,_emscripten_bind_btDiscreteDynamicsWorld_getPairCache_0:bg,_emscripten_bind_LocalConvexResult_set_m_hitFraction_1:Zu,_emscripten_bind_btCapsuleShapeZ_calculateLocalInertia_2:np,_emscripten_bind_btDispatcherInfo_get_m_timeStep_0:Fg,_emscripten_bind_btWheelInfo_get_m_frictionSlip_0:il,_emscripten_bind_btVehicleTuning_set_m_suspensionCompression_1:Ka,_emscripten_bind_btConstraintSetting_set_m_impulseClamp_1:Xf,_emscripten_bind_btMotionState___destroy___0:vn,_emscripten_bind_btVector4_z_0:Ba,_emscripten_bind_btCollisionObject_setCollisionFlags_1:Pp,_emscripten_bind_btGeneric6DofSpring2Constraint_getTranslationalLimitMotor_0:Ce,_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_1:ng,_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_2:sg,_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_3:rg,_emscripten_bind_btWheelInfo_set_m_suspensionStiffness_1:Cl,_emscripten_bind_RaycastInfo_set_m_suspensionLength_1:Ed,_emscripten_bind_btDispatcher_getManifoldByIndexInternal_1:$g,_emscripten_bind_btVector4_setValue_4:Ia,_emscripten_bind_btVector4_normalize_0:Aa,_emscripten_bind_LocalShapeInfo_set_m_triangleIndex_1:sd,_emscripten_bind_btPairCachingGhostObject_setWorldTransform_1:qn,_emscripten_bind_btHingeConstraint_getBreakingImpulseThreshold_0:Ii,_emscripten_bind_btConeTwistConstraint_setAngularOnly_1:Lf,_emscripten_bind_btGhostObject_setCcdSweptSphereRadius_1:oi,_emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_4:ns,_emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_2:is,_emscripten_bind_btGhostObject_getNumOverlappingObjects_0:$e,_emscripten_bind_ConvexResultCallback_set_m_collisionFilterGroup_1:Vu,_emscripten_bind_btPairCachingGhostObject_getOverlappingObject_1:kn,_emscripten_bind_btGeneric6DofSpring2Constraint_setDamping_2:Me,_emscripten_bind_btGeneric6DofConstraint_setBreakingImpulseThreshold_1:xb,_emscripten_bind_btPoint2PointConstraint_setPivotA_1:cs,_emscripten_bind_ClosestConvexResultCallback_set_m_convexToWorld_1:ru,_memcpy:Oh,_emscripten_bind_btCapsuleShape_calculateLocalInertia_2:hp,_emscripten_bind_btVector3_y_0:ya,_emscripten_bind_btVehicleTuning_get_m_maxSuspensionForce_0:za,_emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_2:Hd,_emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_3:Xd,_emscripten_bind_LocalShapeInfo_get_m_triangleIndex_0:id,_emscripten_bind_btGhostObject_setCollisionShape_1:li,_emscripten_bind_btDispatcherInfo_set_m_allowedCcdPenetration_1:Vg,_emscripten_bind_btQuaternion_setW_1:As,_emscripten_bind_btPairCachingGhostObject_setRollingFriction_1:Yn,_emscripten_bind_btDiscreteDynamicsWorld_setGravity_1:Cg,_emscripten_bind_btVehicleTuning_set_m_suspensionStiffness_1:Qa,_emscripten_bind_btGeneric6DofSpring2Constraint___destroy___0:Tb,_emscripten_bind_btCollisionObject_forceActivationState_1:Sp,_emscripten_bind_btKinematicCharacterController_onGround_0:Wi,_emscripten_bind_btRaycastVehicle_getWheelInfo_1:Vs,_emscripten_bind_btGeneric6DofConstraint_getBreakingImpulseThreshold_0:yb,_emscripten_bind_btConeTwistConstraint_setLimit_2:Of,_emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterMask_1:nu,_emscripten_bind_btRigidBody___destroy___0:yr,_emscripten_bind_btStridingMeshInterface___destroy___0:Do,_emscripten_bind_btRigidBody_setSleepingThresholds_2:no,_emscripten_bind_btCollisionObject_setWorldTransform_1:Bp,_emscripten_bind_LocalConvexResult_get_m_localShapeInfo_0:qu,_emscripten_bind_btManifoldPoint_get_m_localPointA_0:on,_emscripten_bind_btRigidBodyConstructionInfo_get_m_linearDamping_0:nr,_emscripten_bind_btGeneric6DofSpring2Constraint_enableFeedback_1:ve,_emscripten_bind_btDispatcher_getNumManifolds_0:Jg,_emscripten_bind_btRigidBodyConstructionInfo_get_m_linearSleepingThreshold_0:sr,_emscripten_bind_btRigidBody_activate_1:Sr,_emscripten_bind_btRigidBody_activate_0:vr,_emscripten_bind_btRaycastVehicle___destroy___0:ks,_emscripten_bind_btGhostObject_setActivationState_1:ni,_emscripten_bind_btCollisionWorld_contactPairTest_3:Hp,_emscripten_bind_btCylinderShapeX___destroy___0:mm,_emscripten_bind_btManifoldPoint_getPositionWorldOnA_0:sn,_emscripten_bind_ContactResultCallback___destroy___0:Lu,_emscripten_bind_btDispatcherInfo_set_m_stepCount_1:Hg,_emscripten_bind_btVector4_x_0:Oa,_emscripten_bind_btConstraintSetting_btConstraintSetting_0:zf,_emscripten_bind_btRigidBody_getMotionState_0:Or,_emscripten_bind_btKinematicCharacterController_getGhostObject_0:Ni,_emscripten_bind_btRigidBody_btRigidBody_1:Mr,_emscripten_bind_btTriangleMeshShape___destroy___0:Xo,_emscripten_bind_btKinematicCharacterController_setWalkDirection_1:Ji,_emscripten_bind_btDynamicsWorld_removeAction_1:pb,_emscripten_bind_btRigidBodyConstructionInfo_get_m_restitution_0:rr,_emscripten_bind_btTransform_setIdentity_0:Vo,_emscripten_bind_btManifoldPoint_set_m_normalWorldOnB_1:dn,_emscripten_bind_btKinematicCharacterController_getGravity_0:Ui,_emscripten_bind_btConeTwistConstraint_getBreakingImpulseThreshold_0:Pf,_emscripten_bind_btDiscreteDynamicsWorld_addAction_1:ig,_emscripten_bind_btHingeConstraint_btHingeConstraint_4:Ci,_emscripten_bind_LocalShapeInfo_get_m_shapePart_0:ed,_emscripten_bind_btConeShape_calculateLocalInertia_2:Cf,_emscripten_bind_btCylinderShapeX_calculateLocalInertia_2:bm,_emscripten_bind_ConvexResultCallback_set_m_collisionFilterMask_1:zu,_llvm_bswap_i32:Bh,_emscripten_enum_RotateOrder_RO_XZY:Il,_emscripten_bind_btSphereShape_setLocalScaling_1:Eo,_emscripten_bind_btVector4_w_0:ka,_emscripten_bind_btManifoldPoint_get_m_normalWorldOnB_0:ln,_emscripten_bind_btBvhTriangleMeshShape___destroy___0:jd,_emscripten_bind_LocalConvexResult_LocalConvexResult_5:Wu,_emscripten_bind_ClosestConvexResultCallback_set_m_closestHitFraction_1:eu,_emscripten_bind_btDiscreteDynamicsWorld_removeConstraint_1:xg,_emscripten_bind_btVector4_y_0:Fa,_emscripten_bind_btGeneric6DofConstraint___destroy___0:fb,_emscripten_bind_btVehicleTuning_get_m_maxSuspensionTravelCm_0:Wa,_emscripten_bind_btConvexHullShape_addPoint_1:em,_emscripten_bind_btConvexHullShape_addPoint_2:im,_emscripten_bind_btPoint2PointConstraint_getBreakingImpulseThreshold_0:rs,_emscripten_bind_btTransform_getOrigin_0:No,_emscripten_enum_RotateOrder_RO_ZYX:kl,_emscripten_bind_btHingeConstraint___destroy___0:Si,_emscripten_bind_btConvexShape_calculateLocalInertia_2:hm,_memset:Ph,_emscripten_bind_btKinematicCharacterController___destroy___0:ki,_emscripten_bind_btConvexHullShape_setLocalScaling_1:om,_emscripten_bind_btTriangleMesh_btTriangleMesh_0:$o,_emscripten_bind_btPairCachingGhostObject_getCollisionShape_0:Ln,_emscripten_bind_btTriangleMesh_btTriangleMesh_2:ta,_emscripten_bind_btTransform___destroy___0:ko,_emscripten_bind_btWheelInfo_set_m_frictionSlip_1:gl,_emscripten_bind_btHingeConstraint_enableAngularMotor_3:Mi,_emscripten_bind_btManifoldPoint_set_m_positionWorldOnA_1:pn,_emscripten_bind_btRigidBody_setCenterOfMassTransform_1:Hr,_emscripten_bind_btManifoldPoint_get_m_localPointB_0:an,_emscripten_bind_btDiscreteDynamicsWorld_contactPairTest_3:_g,_emscripten_bind_btSliderConstraint_setLowerLinLimit_1:vo,_emscripten_bind_btPoint2PointConstraint_set_m_setting_1:us,_emscripten_bind_btCollisionObject_setCcdSweptSphereRadius_1:Ip,_emscripten_bind_btWheelInfo_get_m_wheelsRadius_0:ul,_emscripten_bind_btRigidBody_setLinearVelocity_1:$r,_emscripten_bind_btVehicleTuning_btVehicleTuning_0:Ua,_emscripten_bind_RayResultCallback_set_m_collisionObject_1:ud,_emscripten_bind_ClosestRayResultCallback_set_m_rayToWorld_1:Cu,_emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterGroup_0:cu,_emscripten_bind_btWheelInfo_set_m_wheelsDampingRelaxation_1:Al,_emscripten_bind_btDynamicsWorld_addAction_1:eb,_emscripten_bind_btDiscreteDynamicsWorld_removeAction_1:Sg,_emscripten_bind_btDefaultVehicleRaycaster___destroy___0:Jm,_emscripten_bind_btRigidBodyConstructionInfo_set_m_linearDamping_1:fr,_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDamping_1:cr,_emscripten_bind_btKinematicCharacterController_setFallSpeed_1:Hi,_emscripten_bind_btRigidBody_setActivationState_1:Ur,_emscripten_bind_btWheelInfo_get_m_wheelsDampingCompression_0:cl,_emscripten_bind_ClosestConvexResultCallback_hasHit_0:tu,_emscripten_bind_btCapsuleShapeZ___destroy___0:ep,_emscripten_bind_btWheelInfo_get_m_maxSuspensionForce_0:nl,_emscripten_bind_ClosestRayResultCallback_get_m_collisionObject_0:uu,_emscripten_bind_btTriangleMesh_addTriangle_3:Zo,_emscripten_bind_btGhostObject_getOverlappingObject_1:Je,_emscripten_bind_btTriangleMesh_addTriangle_4:Qo,_emscripten_bind_btRigidBody_applyTorqueImpulse_1:Ar,_emscripten_bind_btRigidBody_setCollisionFlags_1:Xr,_emscripten_bind_btWheelInfo_set_m_suspensionRestLength1_1:wl,_emscripten_bind_btConeShape___destroy___0:xf,_emscripten_bind_btCapsuleShapeZ_btCapsuleShapeZ_2:ip,_emscripten_bind_btGeneric6DofSpring2Constraint_setBreakingImpulseThreshold_1:Ee,_emscripten_bind_btSliderConstraint_btSliderConstraint_3:po,_emscripten_bind_btDispatcherInfo_get_m_allowedCcdPenetration_0:Rg,_emscripten_bind_RaycastInfo_set_m_hardPointWS_1:Td,_emscripten_bind_btRigidBody_forceActivationState_1:Rr,_emscripten_bind_btPoint2PointConstraint_setPivotB_1:_s,_emscripten_bind_btManifoldPoint_getDistance_0:nn,_emscripten_bind_btGhostPairCallback___destroy___0:pi,_emscripten_bind_btKinematicCharacterController_getMaxSlope_0:Vi,_emscripten_bind_btSliderConstraint_enableFeedback_1:mo,_emscripten_bind_btRaycastVehicle_addWheel_7:Os,_emscripten_bind_btPairCachingGhostObject_isActive_0:Fn,_emscripten_bind_LocalConvexResult_set_m_localShapeInfo_1:Ju,_emscripten_bind_btStaticPlaneShape___destroy___0:Ro,_emscripten_bind_btDispatcherInfo_get_m_useConvexConservativeDistanceUtil_0:Ng,_emscripten_bind_btBoxShape_setLocalScaling_1:zd,_emscripten_bind_btConeShapeZ___destroy___0:bf,_emscripten_bind_btDynamicsWorld_getPairCache_0:_b,_emscripten_bind_btDiscreteDynamicsWorld_convexSweepTest_5:dg,_emscripten_bind_btKinematicCharacterController_setVelocityForTimeInterval_2:$i,_emscripten_bind_btRigidBody_setRestitution_1:eo,_emscripten_bind_btVector4_btVector4_0:xa,_emscripten_bind_btDispatcherInfo_get_m_enableSatConvex_0:Dg,_emscripten_bind_btVector4_btVector4_4:wa,_emscripten_bind_btGeneric6DofConstraint_setLinearLowerLimit_1:wb,_emscripten_bind_btGeneric6DofSpringConstraint_setLinearLowerLimit_1:We,_emscripten_enum_RotateOrder_RO_ZXY:Dl,_emscripten_bind_LocalConvexResult_set_m_hitCollisionObject_1:Ku,_emscripten_bind_btPairCachingGhostObject_setCollisionFlags_1:Wn,_emscripten_bind_btGeneric6DofSpringConstraint_setAngularLowerLimit_1:Ne,_emscripten_bind_btDiscreteDynamicsWorld_rayTest_3:vg,_emscripten_bind_btWheelInfo_get_m_raycastInfo_0:rl,_emscripten_bind_btContactSolverInfo_get_m_splitImpulse_0:Qf,_emscripten_bind_btGhostPairCallback_btGhostPairCallback_0:fi,_emscripten_bind_btKinematicCharacterController_setMaxJumpHeight_1:qi,_emscripten_bind_ClosestRayResultCallback_set_m_hitNormalWorld_1:Su,_emscripten_bind_btVehicleTuning_get_m_frictionSlip_0:Va,__GLOBAL__sub_I_btConeTwistConstraint_cpp:NE,__GLOBAL__sub_I_btQuickprof_cpp:W_,runPostSets:Mh,stackAlloc:zI,stackSave:WI,stackRestore:GI,establishStackSpace:jI,setThrew:HI,setTempRet0:qI,getTempRet0:KI,dynCall_viiiii:Yh,dynCall_vid:qh,dynCall_vi:Kh,dynCall_viiidii:Zh,dynCall_vii:Qh,dynCall_iiiiiiiiiii:$h,dynCall_ii:Jh,dynCall_viidi:tc,dynCall_viddiii:ec,dynCall_vidii:ic,dynCall_iiiii:nc,dynCall_vidi:sc,dynCall_diiiiiiii:rc,dynCall_viiiiddddiid:oc,dynCall_diiiii:ac,dynCall_iiii:lc,dynCall_viiiiii:hc,dynCall_iiid:cc,dynCall_di:_c,dynCall_iiiiiii:uc,dynCall_diiidii:dc,dynCall_viidii:pc,dynCall_viiiiiii:fc,dynCall_viiiiiiiii:mc,dynCall_viiiiiiiiii:gc,dynCall_iii:bc,dynCall_diii:yc,dynCall_diiiiiiiiii:vc,dynCall_viiiid:Sc,dynCall_diiiiiiiii:xc,dynCall_did:wc,dynCall_viiiidddddidi:Cc,dynCall_diidii:Tc,dynCall_diiii:Ac,dynCall_iiiiiiiiii:Ec,dynCall_viiid:Mc,dynCall_viii:Rc,dynCall_v:Ic,dynCall_viid:Pc,dynCall_iidid:Lc,dynCall_viiii:Dc}}(r.asmGlobalArg,r.asmLibraryArg,E),pi=r._emscripten_bind_btCylinderShape___destroy___0=di._emscripten_bind_btCylinderShape___destroy___0,fi=r._emscripten_bind_btGeneric6DofConstraint_enableFeedback_1=di._emscripten_bind_btGeneric6DofConstraint_enableFeedback_1,mi=r._emscripten_bind_btDispatcherInfo_get_m_enableSPU_0=di._emscripten_bind_btDispatcherInfo_get_m_enableSPU_0,gi=r._emscripten_bind_btDispatcherInfo_set_m_useContinuous_1=di._emscripten_bind_btDispatcherInfo_set_m_useContinuous_1,bi=r._emscripten_bind_btCollisionObject_isActive_0=di._emscripten_bind_btCollisionObject_isActive_0,yi=r._emscripten_bind_btVehicleTuning_set_m_frictionSlip_1=di._emscripten_bind_btVehicleTuning_set_m_frictionSlip_1,vi=r._emscripten_bind_btDiscreteDynamicsWorld_btDiscreteDynamicsWorld_4=di._emscripten_bind_btDiscreteDynamicsWorld_btDiscreteDynamicsWorld_4,Si=r._emscripten_bind_btCapsuleShapeX_getMargin_0=di._emscripten_bind_btCapsuleShapeX_getMargin_0,xi=r._emscripten_bind_btCompoundShape_getMargin_0=di._emscripten_bind_btCompoundShape_getMargin_0,wi=r._emscripten_bind_RaycastInfo_set_m_wheelDirectionWS_1=di._emscripten_bind_RaycastInfo_set_m_wheelDirectionWS_1,Ci=r._emscripten_bind_btAxisSweep3___destroy___0=di._emscripten_bind_btAxisSweep3___destroy___0,Ti=r._emscripten_bind_ClosestRayResultCallback_get_m_hitPointWorld_0=di._emscripten_bind_ClosestRayResultCallback_get_m_hitPointWorld_0,Ai=r._emscripten_bind_btTypedConstraint_setBreakingImpulseThreshold_1=di._emscripten_bind_btTypedConstraint_setBreakingImpulseThreshold_1,Ei=r._emscripten_bind_btQuaternion_setX_1=di._emscripten_bind_btQuaternion_setX_1,Mi=r._emscripten_bind_btCylinderShapeZ_getMargin_0=di._emscripten_bind_btCylinderShapeZ_getMargin_0,Ri=r._emscripten_bind_btDispatcherInfo_get_m_timeOfImpact_0=di._emscripten_bind_btDispatcherInfo_get_m_timeOfImpact_0,Ii=r._emscripten_bind_btQuaternion_setZ_1=di._emscripten_bind_btQuaternion_setZ_1,Pi=r._emscripten_bind_LocalConvexResult_get_m_hitNormalLocal_0=di._emscripten_bind_LocalConvexResult_get_m_hitNormalLocal_0,Li=r._emscripten_bind_btKinematicCharacterController_setMaxSlope_1=di._emscripten_bind_btKinematicCharacterController_setMaxSlope_1,Di=r._emscripten_bind_btQuadWord_z_0=di._emscripten_bind_btQuadWord_z_0,ki=r._emscripten_bind_btTransform_setIdentity_0=di._emscripten_bind_btTransform_setIdentity_0,Oi=r._emscripten_bind_btWheelInfo_get_m_suspensionRestLength1_0=di._emscripten_bind_btWheelInfo_get_m_suspensionRestLength1_0,Fi=r._emscripten_bind_btWheelInfo_get_m_suspensionStiffness_0=di._emscripten_bind_btWheelInfo_get_m_suspensionStiffness_0,Bi=r._emscripten_bind_btGeneric6DofSpring2Constraint_getBreakingImpulseThreshold_0=di._emscripten_bind_btGeneric6DofSpring2Constraint_getBreakingImpulseThreshold_0,Ni=r._emscripten_bind_btQuaternion_setW_1=di._emscripten_bind_btQuaternion_setW_1,Ui=r._emscripten_bind_RaycastInfo_get_m_wheelAxleWS_0=di._emscripten_bind_RaycastInfo_get_m_wheelAxleWS_0,Vi=r._emscripten_bind_btRigidBodyConstructionInfo_get_m_angularDamping_0=di._emscripten_bind_btRigidBodyConstructionInfo_get_m_angularDamping_0,zi=r._emscripten_bind_btCollisionDispatcher___destroy___0=di._emscripten_bind_btCollisionDispatcher___destroy___0,Wi=r._emscripten_bind_btRigidBody_applyCentralImpulse_1=di._emscripten_bind_btRigidBody_applyCentralImpulse_1,Gi=r._emscripten_bind_btConvexHullShape_getMargin_0=di._emscripten_bind_btConvexHullShape_getMargin_0,ji=r._emscripten_bind_btDefaultMotionState_getWorldTransform_1=di._emscripten_bind_btDefaultMotionState_getWorldTransform_1,Hi=r._emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_1=di._emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_1,Xi=r._emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_3=di._emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_3,Yi=r._emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_2=di._emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_2,qi=r._emscripten_bind_btVector3_op_mul_1=di._emscripten_bind_btVector3_op_mul_1,Ki=r._emscripten_bind_btDynamicsWorld_rayTest_3=di._emscripten_bind_btDynamicsWorld_rayTest_3,Zi=r._emscripten_bind_btRaycastVehicle_updateWheelTransform_2=di._emscripten_bind_btRaycastVehicle_updateWheelTransform_2,Qi=r._emscripten_bind_btQuadWord_x_0=di._emscripten_bind_btQuadWord_x_0,$i=r._emscripten_bind_btCollisionObject_isKinematicObject_0=di._emscripten_bind_btCollisionObject_isKinematicObject_0,Ji=r._emscripten_bind_btWheelInfo_set_m_chassisConnectionPointCS_1=di._emscripten_bind_btWheelInfo_set_m_chassisConnectionPointCS_1,tn=r._emscripten_bind_btSphereShape___destroy___0=di._emscripten_bind_btSphereShape___destroy___0,en=r._emscripten_bind_btGeneric6DofSpringConstraint_setLinearUpperLimit_1=di._emscripten_bind_btGeneric6DofSpringConstraint_setLinearUpperLimit_1,nn=r._emscripten_bind_ClosestConvexResultCallback_set_m_hitNormalWorld_1=di._emscripten_bind_ClosestConvexResultCallback_set_m_hitNormalWorld_1,sn=r._emscripten_bind_btRigidBody_getCenterOfMassTransform_0=di._emscripten_bind_btRigidBody_getCenterOfMassTransform_0,rn=r._emscripten_bind_btGhostObject_isKinematicObject_0=di._emscripten_bind_btGhostObject_isKinematicObject_0,on=r._emscripten_bind_btGeneric6DofSpringConstraint_btGeneric6DofSpringConstraint_5=di._emscripten_bind_btGeneric6DofSpringConstraint_btGeneric6DofSpringConstraint_5,an=r._emscripten_bind_btCapsuleShape___destroy___0=di._emscripten_bind_btCapsuleShape___destroy___0,ln=r._emscripten_bind_btCollisionObject_activate_1=di._emscripten_bind_btCollisionObject_activate_1,hn=r._emscripten_bind_btCollisionObject_activate_0=di._emscripten_bind_btCollisionObject_activate_0,cn=r._emscripten_bind_btGeneric6DofSpring2Constraint_getRotationalLimitMotor_1=di._emscripten_bind_btGeneric6DofSpring2Constraint_getRotationalLimitMotor_1,_n=r._emscripten_bind_btKinematicCharacterController_setUpAxis_1=di._emscripten_bind_btKinematicCharacterController_setUpAxis_1,un=r._emscripten_bind_btDispatcherInfo_set_m_timeOfImpact_1=di._emscripten_bind_btDispatcherInfo_set_m_timeOfImpact_1,dn=r._emscripten_bind_btGeneric6DofSpring2Constraint_setAngularUpperLimit_1=di._emscripten_bind_btGeneric6DofSpring2Constraint_setAngularUpperLimit_1,pn=r._emscripten_bind_btTranslationalLimitMotor2___destroy___0=di._emscripten_bind_btTranslationalLimitMotor2___destroy___0,fn=r._emscripten_bind_btCollisionDispatcher_btCollisionDispatcher_1=di._emscripten_bind_btCollisionDispatcher_btCollisionDispatcher_1,mn=r._emscripten_bind_btVector3_setX_1=di._emscripten_bind_btVector3_setX_1,gn=r._emscripten_bind_btCollisionConfiguration___destroy___0=di._emscripten_bind_btCollisionConfiguration___destroy___0,bn=r._emscripten_bind_btCapsuleShapeZ_setMargin_1=di._emscripten_bind_btCapsuleShapeZ_setMargin_1,yn=r._emscripten_bind_btHingeConstraint_enableFeedback_1=di._emscripten_bind_btHingeConstraint_enableFeedback_1,vn=r._emscripten_bind_btManifoldPoint_set_m_positionWorldOnB_1=di._emscripten_bind_btManifoldPoint_set_m_positionWorldOnB_1,Sn=r._emscripten_bind_btManifoldPoint_set_m_localPointB_1=di._emscripten_bind_btManifoldPoint_set_m_localPointB_1,xn=r._emscripten_bind_btVector3_setZ_1=di._emscripten_bind_btVector3_setZ_1,wn=r._emscripten_bind_btKinematicCharacterController_setUseGhostSweepTest_1=di._emscripten_bind_btKinematicCharacterController_setUseGhostSweepTest_1,Cn=r._emscripten_bind_btQuaternion_setValue_4=di._emscripten_bind_btQuaternion_setValue_4,Tn=r._emscripten_bind_btDynamicsWorld_getBroadphase_0=di._emscripten_bind_btDynamicsWorld_getBroadphase_0,An=r._emscripten_bind_LocalShapeInfo___destroy___0=di._emscripten_bind_LocalShapeInfo___destroy___0,En=r._emscripten_bind_btWheelInfo_get_m_bIsFrontWheel_0=di._emscripten_bind_btWheelInfo_get_m_bIsFrontWheel_0,Mn=r._emscripten_bind_btQuadWord_setY_1=di._emscripten_bind_btQuadWord_setY_1,Rn=r._emscripten_bind_btRigidBody_isKinematicObject_0=di._emscripten_bind_btRigidBody_isKinematicObject_0,In=r._emscripten_bind_ContactResultCallback_addSingleResult_7=di._emscripten_bind_ContactResultCallback_addSingleResult_7,Pn=r._emscripten_bind_btRigidBodyConstructionInfo_set_m_restitution_1=di._emscripten_bind_btRigidBodyConstructionInfo_set_m_restitution_1,Ln=r._emscripten_bind_btDefaultMotionState_get_m_graphicsWorldTrans_0=di._emscripten_bind_btDefaultMotionState_get_m_graphicsWorldTrans_0,Dn=r._emscripten_bind_btConeTwistConstraint_setDamping_1=di._emscripten_bind_btConeTwistConstraint_setDamping_1,kn=r._emscripten_bind_btPairCachingGhostObject_btPairCachingGhostObject_0=di._emscripten_bind_btPairCachingGhostObject_btPairCachingGhostObject_0,On=r._emscripten_bind_btDiscreteDynamicsWorld_getSolverInfo_0=di._emscripten_bind_btDiscreteDynamicsWorld_getSolverInfo_0,Fn=r._emscripten_bind_btCylinderShape_setMargin_1=di._emscripten_bind_btCylinderShape_setMargin_1,Bn=r._emscripten_bind_btCollisionWorld___destroy___0=di._emscripten_bind_btCollisionWorld___destroy___0,Nn=r._emscripten_bind_LocalConvexResult_get_m_hitPointLocal_0=di._emscripten_bind_LocalConvexResult_get_m_hitPointLocal_0,Un=r._emscripten_bind_btBoxShape_btBoxShape_1=di._emscripten_bind_btBoxShape_btBoxShape_1,Vn=r._emscripten_bind_btPersistentManifold_getBody1_0=di._emscripten_bind_btPersistentManifold_getBody1_0,zn=r._emscripten_bind_ClosestRayResultCallback_set_m_collisionObject_1=di._emscripten_bind_ClosestRayResultCallback_set_m_collisionObject_1,Wn=r._emscripten_bind_RaycastInfo_set_m_isInContact_1=di._emscripten_bind_RaycastInfo_set_m_isInContact_1,Gn=r._emscripten_bind_btKinematicCharacterController_setGravity_1=di._emscripten_bind_btKinematicCharacterController_setGravity_1,jn=r._emscripten_bind_btConstraintSetting_set_m_impulseClamp_1=di._emscripten_bind_btConstraintSetting_set_m_impulseClamp_1,Hn=r._emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_5=di._emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_5,Xn=r._emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_3=di._emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_3,Yn=r._emscripten_bind_LocalShapeInfo_get_m_shapePart_0=di._emscripten_bind_LocalShapeInfo_get_m_shapePart_0,qn=r.__GLOBAL__sub_I_btConeTwistConstraint_cpp=di.__GLOBAL__sub_I_btConeTwistConstraint_cpp,Kn=r._emscripten_bind_btWheelInfo_get_m_rollInfluence_0=di._emscripten_bind_btWheelInfo_get_m_rollInfluence_0,Zn=r._emscripten_bind_btVector4_setValue_4=di._emscripten_bind_btVector4_setValue_4,Qn=r._emscripten_bind_btBvhTriangleMeshShape_setLocalScaling_1=di._emscripten_bind_btBvhTriangleMeshShape_setLocalScaling_1,$n=r._emscripten_bind_btPoint2PointConstraint_setBreakingImpulseThreshold_1=di._emscripten_bind_btPoint2PointConstraint_setBreakingImpulseThreshold_1,Jn=r._emscripten_bind_btDynamicsWorld_getDispatchInfo_0=di._emscripten_bind_btDynamicsWorld_getDispatchInfo_0,ts=r._emscripten_bind_btCompoundShape_removeChildShapeByIndex_1=di._emscripten_bind_btCompoundShape_removeChildShapeByIndex_1,es=r._emscripten_bind_btGeneric6DofSpring2Constraint_enableSpring_2=di._emscripten_bind_btGeneric6DofSpring2Constraint_enableSpring_2,is=r._emscripten_bind_btVector3_length_0=di._emscripten_bind_btVector3_length_0,ns=r._emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_2=di._emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_2,ss=r._emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_1=di._emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_1,rs=r._emscripten_bind_ClosestConvexResultCallback_set_m_hitPointWorld_1=di._emscripten_bind_ClosestConvexResultCallback_set_m_hitPointWorld_1,os=r._emscripten_bind_RayResultCallback_set_m_collisionFilterMask_1=di._emscripten_bind_RayResultCallback_set_m_collisionFilterMask_1,as=r._emscripten_bind_btBoxShape_getMargin_0=di._emscripten_bind_btBoxShape_getMargin_0,ls=r._emscripten_bind_btPairCachingGhostObject___destroy___0=di._emscripten_bind_btPairCachingGhostObject___destroy___0,hs=r._emscripten_bind_btDynamicsWorld_addCollisionObject_3=di._emscripten_bind_btDynamicsWorld_addCollisionObject_3,cs=r._emscripten_bind_btPairCachingGhostObject_activate_0=di._emscripten_bind_btPairCachingGhostObject_activate_0,_s=r._emscripten_bind_btPairCachingGhostObject_activate_1=di._emscripten_bind_btPairCachingGhostObject_activate_1,us=r._emscripten_bind_btContactSolverInfo_get_m_splitImpulsePenetrationThreshold_0=di._emscripten_bind_btContactSolverInfo_get_m_splitImpulsePenetrationThreshold_0,ds=r._emscripten_bind_btPairCachingGhostObject_forceActivationState_1=di._emscripten_bind_btPairCachingGhostObject_forceActivationState_1,ps=r._emscripten_bind_btDefaultMotionState___destroy___0=di._emscripten_bind_btDefaultMotionState___destroy___0,fs=r._emscripten_bind_btDispatcherInfo_get_m_stepCount_0=di._emscripten_bind_btDispatcherInfo_get_m_stepCount_0,ms=r._emscripten_bind_btRigidBodyConstructionInfo_set_m_angularDamping_1=di._emscripten_bind_btRigidBodyConstructionInfo_set_m_angularDamping_1,gs=r._emscripten_bind_btQuadWord_setW_1=di._emscripten_bind_btQuadWord_setW_1,bs=r._emscripten_bind_btRigidBodyConstructionInfo_get_m_friction_0=di._emscripten_bind_btRigidBodyConstructionInfo_get_m_friction_0,ys=r._emscripten_bind_btCapsuleShapeX_btCapsuleShapeX_2=di._emscripten_bind_btCapsuleShapeX_btCapsuleShapeX_2,vs=r._emscripten_bind_LocalShapeInfo_set_m_shapePart_1=di._emscripten_bind_LocalShapeInfo_set_m_shapePart_1,Ss=r._emscripten_bind_btRigidBody_setLinearFactor_1=di._emscripten_bind_btRigidBody_setLinearFactor_1,xs=r._emscripten_bind_btDispatcherInfo_set_m_useConvexConservativeDistanceUtil_1=di._emscripten_bind_btDispatcherInfo_set_m_useConvexConservativeDistanceUtil_1,ws=r._emscripten_bind_btWheelInfo_get_m_engineForce_0=di._emscripten_bind_btWheelInfo_get_m_engineForce_0,Cs=r._emscripten_bind_btRaycastVehicle_setSteeringValue_2=di._emscripten_bind_btRaycastVehicle_setSteeringValue_2,Ts=r._emscripten_enum_RotateOrder_RO_YXZ=di._emscripten_enum_RotateOrder_RO_YXZ,As=r._emscripten_bind_btPoint2PointConstraint___destroy___0=di._emscripten_bind_btPoint2PointConstraint___destroy___0,Es=r._emscripten_bind_btGeneric6DofConstraint_setAngularUpperLimit_1=di._emscripten_bind_btGeneric6DofConstraint_setAngularUpperLimit_1,Ms=r._emscripten_bind_btDiscreteDynamicsWorld_addConstraint_2=di._emscripten_bind_btDiscreteDynamicsWorld_addConstraint_2,Rs=r._emscripten_bind_btDiscreteDynamicsWorld_addConstraint_1=di._emscripten_bind_btDiscreteDynamicsWorld_addConstraint_1,Is=r._emscripten_bind_btRigidBodyConstructionInfo_set_m_angularSleepingThreshold_1=di._emscripten_bind_btRigidBodyConstructionInfo_set_m_angularSleepingThreshold_1,ce=r._malloc=di._malloc,Ps=r._emscripten_bind_btDispatcherInfo_get_m_useEpa_0=di._emscripten_bind_btDispatcherInfo_get_m_useEpa_0,Ls=r._emscripten_bind_btTransform_btTransform_2=di._emscripten_bind_btTransform_btTransform_2,Ds=r._emscripten_bind_btTransform_btTransform_0=di._emscripten_bind_btTransform_btTransform_0,ks=r._emscripten_bind_btVector3_op_sub_1=di._emscripten_bind_btVector3_op_sub_1,Os=r._emscripten_bind_btWheelInfo_set_m_wheelsRadius_1=di._emscripten_bind_btWheelInfo_set_m_wheelsRadius_1,Fs=r._emscripten_bind_btDispatcherInfo_set_m_enableSPU_1=di._emscripten_bind_btDispatcherInfo_set_m_enableSPU_1,Bs=r._emscripten_bind_btWheelInfo_set_m_wheelsDampingCompression_1=di._emscripten_bind_btWheelInfo_set_m_wheelsDampingCompression_1,Ns=r._emscripten_bind_btCollisionObject_setActivationState_1=di._emscripten_bind_btCollisionObject_setActivationState_1,Us=r._emscripten_bind_btPersistentManifold___destroy___0=di._emscripten_bind_btPersistentManifold___destroy___0,Vs=r._emscripten_bind_btConstraintSetting_get_m_impulseClamp_0=di._emscripten_bind_btConstraintSetting_get_m_impulseClamp_0,zs=r._emscripten_bind_btCylinderShapeZ___destroy___0=di._emscripten_bind_btCylinderShapeZ___destroy___0,Ws=r._emscripten_bind_btMatrix3x3___destroy___0=di._emscripten_bind_btMatrix3x3___destroy___0,Gs=r._emscripten_bind_ConvexResultCallback_hasHit_0=di._emscripten_bind_ConvexResultCallback_hasHit_0,js=r._emscripten_bind_btCollisionShape_calculateLocalInertia_2=di._emscripten_bind_btCollisionShape_calculateLocalInertia_2,Hs=r._emscripten_bind_btGeneric6DofSpringConstraint_setBreakingImpulseThreshold_1=di._emscripten_bind_btGeneric6DofSpringConstraint_setBreakingImpulseThreshold_1,Xs=r._emscripten_bind_btCollisionWorld_convexSweepTest_5=di._emscripten_bind_btCollisionWorld_convexSweepTest_5,Ys=r._emscripten_bind_ClosestRayResultCallback_set_m_hitPointWorld_1=di._emscripten_bind_ClosestRayResultCallback_set_m_hitPointWorld_1,qs=r._emscripten_bind_btCapsuleShapeX_calculateLocalInertia_2=di._emscripten_bind_btCapsuleShapeX_calculateLocalInertia_2,Ks=r._emscripten_bind_btConstraintSetting_set_m_damping_1=di._emscripten_bind_btConstraintSetting_set_m_damping_1,Zs=r._emscripten_bind_btWheelInfo_set_m_bIsFrontWheel_1=di._emscripten_bind_btWheelInfo_set_m_bIsFrontWheel_1,Qs=r._emscripten_bind_btRigidBody_setCcdMotionThreshold_1=di._emscripten_bind_btRigidBody_setCcdMotionThreshold_1,$s=r._emscripten_bind_btConvexHullShape_setMargin_1=di._emscripten_bind_btConvexHullShape_setMargin_1,Js=r._emscripten_bind_btRigidBody_applyForce_2=di._emscripten_bind_btRigidBody_applyForce_2,tr=r._emscripten_bind_btConeShapeZ_calculateLocalInertia_2=di._emscripten_bind_btConeShapeZ_calculateLocalInertia_2,er=r._emscripten_bind_btConstraintSetting_set_m_tau_1=di._emscripten_bind_btConstraintSetting_set_m_tau_1,ir=r._emscripten_bind_btConvexHullShape_calculateLocalInertia_2=di._emscripten_bind_btConvexHullShape_calculateLocalInertia_2,nr=r._emscripten_bind_RaycastInfo_get_m_contactPointWS_0=di._emscripten_bind_RaycastInfo_get_m_contactPointWS_0,sr=r._emscripten_bind_btSphereShape_calculateLocalInertia_2=di._emscripten_bind_btSphereShape_calculateLocalInertia_2,rr=r._emscripten_bind_btSliderConstraint_setBreakingImpulseThreshold_1=di._emscripten_bind_btSliderConstraint_setBreakingImpulseThreshold_1,or=r._emscripten_bind_btCollisionDispatcher_getManifoldByIndexInternal_1=di._emscripten_bind_btCollisionDispatcher_getManifoldByIndexInternal_1,ar=r._pthread_self=di._pthread_self,lr=r._emscripten_bind_btGhostObject_setFriction_1=di._emscripten_bind_btGhostObject_setFriction_1,hr=r._emscripten_bind_btPairCachingGhostObject_getWorldTransform_0=di._emscripten_bind_btPairCachingGhostObject_getWorldTransform_0,cr=r._emscripten_bind_btRigidBody_setCcdSweptSphereRadius_1=di._emscripten_bind_btRigidBody_setCcdSweptSphereRadius_1,_r=r._emscripten_bind_btCylinderShapeZ_setMargin_1=di._emscripten_bind_btCylinderShapeZ_setMargin_1,ur=r._emscripten_bind_btRigidBody_setFriction_1=di._emscripten_bind_btRigidBody_setFriction_1,dr=r._emscripten_bind_LocalConvexResult_set_m_hitPointLocal_1=di._emscripten_bind_LocalConvexResult_set_m_hitPointLocal_1,pr=r._emscripten_bind_btGhostObject_setWorldTransform_1=di._emscripten_bind_btGhostObject_setWorldTransform_1,fr=r._emscripten_bind_btDiscreteDynamicsWorld_removeRigidBody_1=di._emscripten_bind_btDiscreteDynamicsWorld_removeRigidBody_1,mr=r._emscripten_bind_btTranslationalLimitMotor2_set_m_currentLinearDiff_1=di._emscripten_bind_btTranslationalLimitMotor2_set_m_currentLinearDiff_1,gr=r._emscripten_bind_btConvexHullShape___destroy___0=di._emscripten_bind_btConvexHullShape___destroy___0,br=r._emscripten_bind_RaycastInfo_set_m_suspensionLength_1=di._emscripten_bind_RaycastInfo_set_m_suspensionLength_1,yr=r._emscripten_bind_btDiscreteDynamicsWorld_getBroadphase_0=di._emscripten_bind_btDiscreteDynamicsWorld_getBroadphase_0,vr=r._emscripten_bind_btDiscreteDynamicsWorld_addAction_1=di._emscripten_bind_btDiscreteDynamicsWorld_addAction_1,Sr=r._emscripten_bind_btVector4_setX_1=di._emscripten_bind_btVector4_setX_1,xr=r._emscripten_bind_btKinematicCharacterController_jump_0=di._emscripten_bind_btKinematicCharacterController_jump_0,wr=r._emscripten_bind_btWheelInfo_set_m_raycastInfo_1=di._emscripten_bind_btWheelInfo_set_m_raycastInfo_1,Cr=r._emscripten_bind_btConeTwistConstraint_setMaxMotorImpulseNormalized_1=di._emscripten_bind_btConeTwistConstraint_setMaxMotorImpulseNormalized_1,Tr=r._emscripten_bind_btConvexTriangleMeshShape_setLocalScaling_1=di._emscripten_bind_btConvexTriangleMeshShape_setLocalScaling_1,Ar=r._emscripten_bind_btRigidBody_upcast_1=di._emscripten_bind_btRigidBody_upcast_1,Er=r._emscripten_bind_btCollisionObject_getWorldTransform_0=di._emscripten_bind_btCollisionObject_getWorldTransform_0,Mr=r._emscripten_bind_btVector4_setZ_1=di._emscripten_bind_btVector4_setZ_1,Rr=r._emscripten_bind_btQuadWord_y_0=di._emscripten_bind_btQuadWord_y_0,Ir=r._emscripten_bind_btTransform_getBasis_0=di._emscripten_bind_btTransform_getBasis_0,Pr=r._emscripten_bind_btPairCachingGhostObject_setFriction_1=di._emscripten_bind_btPairCachingGhostObject_setFriction_1,Lr=r._emscripten_bind_btDispatcherInfo_set_m_useEpa_1=di._emscripten_bind_btDispatcherInfo_set_m_useEpa_1,Dr=r._emscripten_bind_btCollisionDispatcher_getNumManifolds_0=di._emscripten_bind_btCollisionDispatcher_getNumManifolds_0,kr=r._emscripten_bind_btVehicleRaycaster___destroy___0=di._emscripten_bind_btVehicleRaycaster___destroy___0,Or=r._emscripten_bind_ClosestRayResultCallback___destroy___0=di._emscripten_bind_ClosestRayResultCallback___destroy___0,Fr=r._emscripten_bind_ClosestConvexResultCallback_get_m_convexFromWorld_0=di._emscripten_bind_ClosestConvexResultCallback_get_m_convexFromWorld_0,Br=r._emscripten_bind_btCylinderShapeX_setMargin_1=di._emscripten_bind_btCylinderShapeX_setMargin_1,Nr=r._emscripten_bind_btQuadWord_w_0=di._emscripten_bind_btQuadWord_w_0,Ur=r._emscripten_bind_btPersistentManifold_getNumContacts_0=di._emscripten_bind_btPersistentManifold_getNumContacts_0,Vr=r._emscripten_bind_btDynamicsWorld_contactTest_2=di._emscripten_bind_btDynamicsWorld_contactTest_2,zr=r._emscripten_bind_btDiscreteDynamicsWorld_contactTest_2=di._emscripten_bind_btDiscreteDynamicsWorld_contactTest_2,Wr=r._emscripten_bind_btGeneric6DofSpring2Constraint_btGeneric6DofSpring2Constraint_3=di._emscripten_bind_btGeneric6DofSpring2Constraint_btGeneric6DofSpring2Constraint_3,Gr=r._emscripten_bind_btBvhTriangleMeshShape_calculateLocalInertia_2=di._emscripten_bind_btBvhTriangleMeshShape_calculateLocalInertia_2,jr=r._emscripten_bind_btCompoundShape_getNumChildShapes_0=di._emscripten_bind_btCompoundShape_getNumChildShapes_0,Hr=r._emscripten_bind_btGhostObject_btGhostObject_0=di._emscripten_bind_btGhostObject_btGhostObject_0,Xr=r._emscripten_bind_ClosestConvexResultCallback_ClosestConvexResultCallback_2=di._emscripten_bind_ClosestConvexResultCallback_ClosestConvexResultCallback_2,Yr=r._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingFactor_1=di._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingFactor_1,qr=r._emscripten_bind_btManifoldPoint_set_m_localPointA_1=di._emscripten_bind_btManifoldPoint_set_m_localPointA_1,Kr=r._emscripten_bind_LocalConvexResult___destroy___0=di._emscripten_bind_LocalConvexResult___destroy___0,Zr=r._emscripten_bind_btVector3_dot_1=di._emscripten_bind_btVector3_dot_1,Qr=r._emscripten_bind_btVector4_op_add_1=di._emscripten_bind_btVector4_op_add_1,$r=r._emscripten_bind_btWheelInfo___destroy___0=di._emscripten_bind_btWheelInfo___destroy___0,Jr=r._emscripten_bind_btHingeConstraint_btHingeConstraint_4=di._emscripten_bind_btHingeConstraint_btHingeConstraint_4,to=r._emscripten_bind_btTransform_setRotation_1=di._emscripten_bind_btTransform_setRotation_1,eo=r._emscripten_bind_btPairCachingGhostObject_getNumOverlappingObjects_0=di._emscripten_bind_btPairCachingGhostObject_getNumOverlappingObjects_0,io=r._emscripten_bind_btPoint2PointConstraint_enableFeedback_1=di._emscripten_bind_btPoint2PointConstraint_enableFeedback_1,no=r._emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterGroup_1=di._emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterGroup_1,so=r._emscripten_bind_btAxisSweep3_btAxisSweep3_2=di._emscripten_bind_btAxisSweep3_btAxisSweep3_2,ro=r._emscripten_bind_btAxisSweep3_btAxisSweep3_3=di._emscripten_bind_btAxisSweep3_btAxisSweep3_3,oo=r._emscripten_bind_btDynamicsWorld___destroy___0=di._emscripten_bind_btDynamicsWorld___destroy___0,ao=r._emscripten_bind_btVector3_setY_1=di._emscripten_bind_btVector3_setY_1,lo=r._emscripten_bind_btAxisSweep3_btAxisSweep3_4=di._emscripten_bind_btAxisSweep3_btAxisSweep3_4,ho=r._emscripten_bind_btAxisSweep3_btAxisSweep3_5=di._emscripten_bind_btAxisSweep3_btAxisSweep3_5,co=r._emscripten_bind_btQuadWord_setX_1=di._emscripten_bind_btQuadWord_setX_1,_o=r._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalLinearDampingThresholdSqr_0=di._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalLinearDampingThresholdSqr_0,uo=r._emscripten_bind_btGhostObject_isActive_0=di._emscripten_bind_btGhostObject_isActive_0,po=r._emscripten_bind_btOverlappingPairCache___destroy___0=di._emscripten_bind_btOverlappingPairCache___destroy___0,fo=r._emscripten_bind_btVector3_normalize_0=di._emscripten_bind_btVector3_normalize_0,mo=r._emscripten_bind_btConstraintSetting___destroy___0=di._emscripten_bind_btConstraintSetting___destroy___0,go=r._emscripten_bind_RayResultCallback___destroy___0=di._emscripten_bind_RayResultCallback___destroy___0,bo=r._emscripten_bind_RaycastInfo_get_m_contactNormalWS_0=di._emscripten_bind_RaycastInfo_get_m_contactNormalWS_0,yo=r._emscripten_bind_btTranslationalLimitMotor2_get_m_currentLinearDiff_0=di._emscripten_bind_btTranslationalLimitMotor2_get_m_currentLinearDiff_0,vo=r._emscripten_bind_btPersistentManifold_getBody0_0=di._emscripten_bind_btPersistentManifold_getBody0_0,So=r._emscripten_bind_btConeShapeX_btConeShapeX_2=di._emscripten_bind_btConeShapeX_btConeShapeX_2,xo=r._emscripten_bind_btConeTwistConstraint_enableFeedback_1=di._emscripten_bind_btConeTwistConstraint_enableFeedback_1,wo=r._emscripten_bind_btCapsuleShapeZ_setLocalScaling_1=di._emscripten_bind_btCapsuleShapeZ_setLocalScaling_1,Co=r._emscripten_bind_ClosestConvexResultCallback_get_m_closestHitFraction_0=di._emscripten_bind_ClosestConvexResultCallback_get_m_closestHitFraction_0,To=r._emscripten_bind_btSliderConstraint_setUpperLinLimit_1=di._emscripten_bind_btSliderConstraint_setUpperLinLimit_1,Ao=r._emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_2=di._emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_2,Eo=r._emscripten_bind_btConcaveShape___destroy___0=di._emscripten_bind_btConcaveShape___destroy___0,Mo=r._emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_4=di._emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_4,Ro=r._emscripten_bind_btQuaternion_x_0=di._emscripten_bind_btQuaternion_x_0,Io=r._emscripten_bind_LocalConvexResult_set_m_hitNormalLocal_1=di._emscripten_bind_LocalConvexResult_set_m_hitNormalLocal_1,Po=r._emscripten_bind_btConcaveShape_setLocalScaling_1=di._emscripten_bind_btConcaveShape_setLocalScaling_1,Lo=r._emscripten_bind_btDiscreteDynamicsWorld_getDispatchInfo_0=di._emscripten_bind_btDiscreteDynamicsWorld_getDispatchInfo_0,Do=r._emscripten_bind_btConeShapeX_setLocalScaling_1=di._emscripten_bind_btConeShapeX_setLocalScaling_1,ko=r._emscripten_bind_btGeneric6DofSpring2Constraint_setBreakingImpulseThreshold_1=di._emscripten_bind_btGeneric6DofSpring2Constraint_setBreakingImpulseThreshold_1,Oo=r._emscripten_bind_btQuaternion_z_0=di._emscripten_bind_btQuaternion_z_0,Fo=r._emscripten_bind_btConvexHullShape_btConvexHullShape_0=di._emscripten_bind_btConvexHullShape_btConvexHullShape_0,Bo=r._emscripten_bind_btWheelInfo_set_m_maxSuspensionForce_1=di._emscripten_bind_btWheelInfo_set_m_maxSuspensionForce_1,No=r._emscripten_bind_btConstraintSetting_get_m_damping_0=di._emscripten_bind_btConstraintSetting_get_m_damping_0,Uo=r._emscripten_bind_btRotationalLimitMotor2___destroy___0=di._emscripten_bind_btRotationalLimitMotor2___destroy___0,Vo=r._emscripten_bind_btGhostObject___destroy___0=di._emscripten_bind_btGhostObject___destroy___0,zo=r._emscripten_bind_btGhostObject_setContactProcessingThreshold_1=di._emscripten_bind_btGhostObject_setContactProcessingThreshold_1,Wo=r._emscripten_bind_btCollisionWorld_getBroadphase_0=di._emscripten_bind_btCollisionWorld_getBroadphase_0,Go=r._emscripten_bind_btContactSolverInfo_set_m_splitImpulse_1=di._emscripten_bind_btContactSolverInfo_set_m_splitImpulse_1,jo=r._emscripten_bind_btDefaultMotionState_btDefaultMotionState_2=di._emscripten_bind_btDefaultMotionState_btDefaultMotionState_2,Ho=r._emscripten_bind_btDefaultMotionState_btDefaultMotionState_0=di._emscripten_bind_btDefaultMotionState_btDefaultMotionState_0,Xo=r._emscripten_bind_btDefaultMotionState_btDefaultMotionState_1=di._emscripten_bind_btDefaultMotionState_btDefaultMotionState_1,Yo=r._emscripten_bind_btCompoundShape_getChildShape_1=di._emscripten_bind_btCompoundShape_getChildShape_1,qo=r._emscripten_bind_btKinematicCharacterController_canJump_0=di._emscripten_bind_btKinematicCharacterController_canJump_0,Ko=r._emscripten_bind_btRigidBody_isActive_0=di._emscripten_bind_btRigidBody_isActive_0,Zo=r._emscripten_bind_btRaycastVehicle_btRaycastVehicle_3=di._emscripten_bind_btRaycastVehicle_btRaycastVehicle_3,Qo=r._emscripten_bind_btMotionState_setWorldTransform_1=di._emscripten_bind_btMotionState_setWorldTransform_1,$o=r._emscripten_bind_btCylinderShape_setLocalScaling_1=di._emscripten_bind_btCylinderShape_setLocalScaling_1,Jo=r._emscripten_bind_btCollisionWorld_rayTest_3=di._emscripten_bind_btCollisionWorld_rayTest_3,ta=r._emscripten_bind_btCompoundShape_calculateLocalInertia_2=di._emscripten_bind_btCompoundShape_calculateLocalInertia_2,ea=r._emscripten_bind_btCollisionWorld_getDispatchInfo_0=di._emscripten_bind_btCollisionWorld_getDispatchInfo_0,ia=r._emscripten_bind_btRigidBody_setCollisionShape_1=di._emscripten_bind_btRigidBody_setCollisionShape_1,na=r._emscripten_bind_btConeShapeX___destroy___0=di._emscripten_bind_btConeShapeX___destroy___0,sa=r._emscripten_bind_btCollisionObject_getCollisionFlags_0=di._emscripten_bind_btCollisionObject_getCollisionFlags_0,ra=r._emscripten_bind_btDispatcherInfo_set_m_enableSatConvex_1=di._emscripten_bind_btDispatcherInfo_set_m_enableSatConvex_1,oa=r._emscripten_bind_btConeTwistConstraint_enableMotor_1=di._emscripten_bind_btConeTwistConstraint_enableMotor_1,aa=r._emscripten_bind_btRaycastVehicle_setCoordinateSystem_3=di._emscripten_bind_btRaycastVehicle_setCoordinateSystem_3,la=r._emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_0=di._emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_0,ha=r._emscripten_bind_btPairCachingGhostObject_setRestitution_1=di._emscripten_bind_btPairCachingGhostObject_setRestitution_1,ca=r._emscripten_bind_ConvexResultCallback___destroy___0=di._emscripten_bind_ConvexResultCallback___destroy___0,_a=r._emscripten_bind_btSliderConstraint_getBreakingImpulseThreshold_0=di._emscripten_bind_btSliderConstraint_getBreakingImpulseThreshold_0,ua=r._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDampingFactor_1=di._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDampingFactor_1,da=r._emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_3=di._emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_3,pa=r._emscripten_bind_btCollisionObject_setContactProcessingThreshold_1=di._emscripten_bind_btCollisionObject_setContactProcessingThreshold_1,fa=r._emscripten_bind_btGhostObject_setCcdMotionThreshold_1=di._emscripten_bind_btGhostObject_setCcdMotionThreshold_1,ma=r._emscripten_bind_btDispatcherInfo_get_m_allowedCcdPenetration_0=di._emscripten_bind_btDispatcherInfo_get_m_allowedCcdPenetration_0,ga=r._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingFactor_0=di._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingFactor_0,ba=r._emscripten_bind_btCapsuleShapeX_setMargin_1=di._emscripten_bind_btCapsuleShapeX_setMargin_1,ya=r._emscripten_bind_btGeneric6DofSpring2Constraint_setStiffness_2=di._emscripten_bind_btGeneric6DofSpring2Constraint_setStiffness_2,va=r._emscripten_bind_btSequentialImpulseConstraintSolver___destroy___0=di._emscripten_bind_btSequentialImpulseConstraintSolver___destroy___0,Sa=r._emscripten_bind_LocalConvexResult_LocalConvexResult_5=di._emscripten_bind_LocalConvexResult_LocalConvexResult_5,xa=r._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalLinearDampingThresholdSqr_1=di._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalLinearDampingThresholdSqr_1,wa=r._emscripten_bind_btRigidBody_getCollisionFlags_0=di._emscripten_bind_btRigidBody_getCollisionFlags_0,Ca=r._emscripten_bind_btCollisionShape_setLocalScaling_1=di._emscripten_bind_btCollisionShape_setLocalScaling_1,Ta=r._emscripten_bind_btRigidBody_applyTorque_1=di._emscripten_bind_btRigidBody_applyTorque_1,Aa=r._emscripten_bind_LocalConvexResult_get_m_hitCollisionObject_0=di._emscripten_bind_LocalConvexResult_get_m_hitCollisionObject_0,Ea=r._emscripten_bind_btMatrix3x3_setEulerZYX_3=di._emscripten_bind_btMatrix3x3_setEulerZYX_3,Ma=r._emscripten_bind_btDispatcherInfo_get_m_convexConservativeDistanceThreshold_0=di._emscripten_bind_btDispatcherInfo_get_m_convexConservativeDistanceThreshold_0,Ra=r._emscripten_bind_btConvexHullShape_setLocalScaling_1=di._emscripten_bind_btConvexHullShape_setLocalScaling_1,Ia=r._emscripten_bind_btRigidBody_setMotionState_1=di._emscripten_bind_btRigidBody_setMotionState_1,Pa=r._emscripten_bind_RayResultCallback_get_m_collisionFilterMask_0=di._emscripten_bind_RayResultCallback_get_m_collisionFilterMask_0,La=r._emscripten_bind_btCollisionWorld_getDispatcher_0=di._emscripten_bind_btCollisionWorld_getDispatcher_0,Da=r._emscripten_bind_btVector4_dot_1=di._emscripten_bind_btVector4_dot_1,ka=r._emscripten_bind_btCollisionObject_setRollingFriction_1=di._emscripten_bind_btCollisionObject_setRollingFriction_1,Oa=r._emscripten_bind_RayResultCallback_set_m_collisionFilterGroup_1=di._emscripten_bind_RayResultCallback_set_m_collisionFilterGroup_1,Fa=r._emscripten_bind_btPairCachingGhostObject_getCollisionShape_0=di._emscripten_bind_btPairCachingGhostObject_getCollisionShape_0,Ba=r._emscripten_bind_btRotationalLimitMotor2_get_m_currentPosition_0=di._emscripten_bind_btRotationalLimitMotor2_get_m_currentPosition_0,Na=r._i64Subtract=di._i64Subtract,Ua=r._emscripten_bind_btRaycastVehicle_getWheelTransformWS_1=di._emscripten_bind_btRaycastVehicle_getWheelTransformWS_1,Va=r._emscripten_bind_btRigidBody_setDamping_2=di._emscripten_bind_btRigidBody_setDamping_2,za=r._emscripten_bind_btDynamicsWorld_getDispatcher_0=di._emscripten_bind_btDynamicsWorld_getDispatcher_0,Wa=r._emscripten_bind_btGhostObject_setCollisionFlags_1=di._emscripten_bind_btGhostObject_setCollisionFlags_1,Ga=r._emscripten_bind_btMatrix3x3_getRotation_1=di._emscripten_bind_btMatrix3x3_getRotation_1,ja=r._emscripten_bind_btWheelInfo_set_m_engineForce_1=di._emscripten_bind_btWheelInfo_set_m_engineForce_1,Ha=r._emscripten_bind_btConeTwistConstraint_setMaxMotorImpulse_1=di._emscripten_bind_btConeTwistConstraint_setMaxMotorImpulse_1,Xa=r._emscripten_bind_btCylinderShapeX_setLocalScaling_1=di._emscripten_bind_btCylinderShapeX_setLocalScaling_1,Ya=r._emscripten_bind_btDbvtBroadphase_btDbvtBroadphase_0=di._emscripten_bind_btDbvtBroadphase_btDbvtBroadphase_0,qa=r._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDamping_0=di._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDamping_0,Ka=r._emscripten_bind_btCompoundShape_setLocalScaling_1=di._emscripten_bind_btCompoundShape_setLocalScaling_1,Za=r._emscripten_bind_btOverlappingPairCallback___destroy___0=di._emscripten_bind_btOverlappingPairCallback___destroy___0,Qa=r._emscripten_bind_btManifoldPoint_get_m_positionWorldOnB_0=di._emscripten_bind_btManifoldPoint_get_m_positionWorldOnB_0,$a=r._emscripten_bind_btCylinderShape_calculateLocalInertia_2=di._emscripten_bind_btCylinderShape_calculateLocalInertia_2,Ja=r._emscripten_bind_btPairCachingGhostObject_setCcdSweptSphereRadius_1=di._emscripten_bind_btPairCachingGhostObject_setCcdSweptSphereRadius_1,tl=r._emscripten_bind_btHingeConstraint_enableAngularMotor_3=di._emscripten_bind_btHingeConstraint_enableAngularMotor_3,el=r._emscripten_bind_btRigidBody_setContactProcessingThreshold_1=di._emscripten_bind_btRigidBody_setContactProcessingThreshold_1,il=r._emscripten_bind_btRigidBody_getLinearVelocity_0=di._emscripten_bind_btRigidBody_getLinearVelocity_0,nl=r._emscripten_bind_btRigidBody_applyImpulse_2=di._emscripten_bind_btRigidBody_applyImpulse_2,sl=r._emscripten_bind_btConcaveShape_calculateLocalInertia_2=di._emscripten_bind_btConcaveShape_calculateLocalInertia_2,rl=r._emscripten_bind_RaycastInfo_get_m_groundObject_0=di._emscripten_bind_RaycastInfo_get_m_groundObject_0,ol=r._emscripten_bind_btRigidBody_setWorldTransform_1=di._emscripten_bind_btRigidBody_setWorldTransform_1,al=r._emscripten_bind_btRigidBody_setAngularVelocity_1=di._emscripten_bind_btRigidBody_setAngularVelocity_1,ll=r._emscripten_bind_btGeneric6DofSpringConstraint_btGeneric6DofSpringConstraint_3=di._emscripten_bind_btGeneric6DofSpringConstraint_btGeneric6DofSpringConstraint_3,hl=r._emscripten_bind_btConvexShape_setLocalScaling_1=di._emscripten_bind_btConvexShape_setLocalScaling_1,cl=r._emscripten_bind_btTriangleMeshShape_calculateLocalInertia_2=di._emscripten_bind_btTriangleMeshShape_calculateLocalInertia_2,_l=r._emscripten_bind_btPairCachingGhostObject_setContactProcessingThreshold_1=di._emscripten_bind_btPairCachingGhostObject_setContactProcessingThreshold_1,ul=r._emscripten_bind_btCompoundShape___destroy___0=di._emscripten_bind_btCompoundShape___destroy___0,dl=r._emscripten_bind_btGeneric6DofConstraint_setLinearUpperLimit_1=di._emscripten_bind_btGeneric6DofConstraint_setLinearUpperLimit_1,pl=r._emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterMask_0=di._emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterMask_0,fl=r._emscripten_bind_RayResultCallback_hasHit_0=di._emscripten_bind_RayResultCallback_hasHit_0,ml=r._bitshift64Shl=di._bitshift64Shl,gl=r._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingThresholdSqr_0=di._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingThresholdSqr_0,bl=r._emscripten_bind_btCylinderShapeX_getMargin_0=di._emscripten_bind_btCylinderShapeX_getMargin_0,yl=r._emscripten_bind_btQuaternion_normalize_0=di._emscripten_bind_btQuaternion_normalize_0,vl=r._emscripten_bind_ClosestConvexResultCallback_get_m_convexToWorld_0=di._emscripten_bind_ClosestConvexResultCallback_get_m_convexToWorld_0,Sl=r._emscripten_bind_btWheelInfo_get_m_frictionSlip_0=di._emscripten_bind_btWheelInfo_get_m_frictionSlip_0,xl=r._emscripten_bind_btConeShapeZ_setLocalScaling_1=di._emscripten_bind_btConeShapeZ_setLocalScaling_1,wl=r._emscripten_bind_btPairCachingGhostObject_setActivationState_1=di._emscripten_bind_btPairCachingGhostObject_setActivationState_1,Cl=r._emscripten_bind_btGeneric6DofSpringConstraint___destroy___0=di._emscripten_bind_btGeneric6DofSpringConstraint___destroy___0,Tl=r._emscripten_bind_btRaycastVehicle_getNumWheels_0=di._emscripten_bind_btRaycastVehicle_getNumWheels_0,Al=r._emscripten_bind_btVehicleTuning_set_m_maxSuspensionTravelCm_1=di._emscripten_bind_btVehicleTuning_set_m_maxSuspensionTravelCm_1,El=r._emscripten_bind_btGhostObject_setRollingFriction_1=di._emscripten_bind_btGhostObject_setRollingFriction_1,Ml=r._emscripten_bind_btCylinderShapeZ_btCylinderShapeZ_1=di._emscripten_bind_btCylinderShapeZ_btCylinderShapeZ_1,Rl=r._emscripten_bind_btPoint2PointConstraint_set_m_setting_1=di._emscripten_bind_btPoint2PointConstraint_set_m_setting_1,Il=r._emscripten_bind_btCompoundShape_btCompoundShape_0=di._emscripten_bind_btCompoundShape_btCompoundShape_0,Pl=r._emscripten_bind_btCompoundShape_btCompoundShape_1=di._emscripten_bind_btCompoundShape_btCompoundShape_1,Ll=r._emscripten_bind_btOverlappingPairCache_setInternalGhostPairCallback_1=di._emscripten_bind_btOverlappingPairCache_setInternalGhostPairCallback_1,Dl=r._emscripten_bind_btStaticPlaneShape_btStaticPlaneShape_2=di._emscripten_bind_btStaticPlaneShape_btStaticPlaneShape_2,kl=r.__GLOBAL__sub_I_btQuickprof_cpp=di.__GLOBAL__sub_I_btQuickprof_cpp,Ol=r._emscripten_bind_btDispatcherInfo_set_m_convexConservativeDistanceThreshold_1=di._emscripten_bind_btDispatcherInfo_set_m_convexConservativeDistanceThreshold_1,Fl=r._emscripten_bind_btDispatcherInfo_get_m_useContinuous_0=di._emscripten_bind_btDispatcherInfo_get_m_useContinuous_0,Bl=r._emscripten_bind_btRigidBody_updateInertiaTensor_0=di._emscripten_bind_btRigidBody_updateInertiaTensor_0,Nl=r._emscripten_bind_btPairCachingGhostObject_setAnisotropicFriction_2=di._emscripten_bind_btPairCachingGhostObject_setAnisotropicFriction_2,Ul=r._emscripten_bind_btTransform_setOrigin_1=di._emscripten_bind_btTransform_setOrigin_1,Vl=r._emscripten_bind_ClosestRayResultCallback_hasHit_0=di._emscripten_bind_ClosestRayResultCallback_hasHit_0,zl=r._emscripten_bind_btDispatcherInfo_get_m_useConvexConservativeDistanceUtil_0=di._emscripten_bind_btDispatcherInfo_get_m_useConvexConservativeDistanceUtil_0,Wl=r._emscripten_bind_btCompoundShape_addChildShape_2=di._emscripten_bind_btCompoundShape_addChildShape_2,Gl=r._emscripten_bind_btDispatcher___destroy___0=di._emscripten_bind_btDispatcher___destroy___0,jl=r._emscripten_bind_btVehicleTuning_get_m_suspensionCompression_0=di._emscripten_bind_btVehicleTuning_get_m_suspensionCompression_0,Hl=r._emscripten_bind_btDiscreteDynamicsWorld___destroy___0=di._emscripten_bind_btDiscreteDynamicsWorld___destroy___0,Xl=r._emscripten_bind_btConvexShape___destroy___0=di._emscripten_bind_btConvexShape___destroy___0,Yl=r._memmove=di._memmove,ql=r._emscripten_bind_btCapsuleShapeX_setLocalScaling_1=di._emscripten_bind_btCapsuleShapeX_setLocalScaling_1,Kl=r._emscripten_bind_btPairCachingGhostObject_setCollisionFlags_1=di._emscripten_bind_btPairCachingGhostObject_setCollisionFlags_1,Zl=r._emscripten_bind_btCollisionObject_setRestitution_1=di._emscripten_bind_btCollisionObject_setRestitution_1,Ql=r._emscripten_bind_btRigidBody_applyCentralForce_1=di._emscripten_bind_btRigidBody_applyCentralForce_1,$l=r._emscripten_bind_LocalConvexResult_get_m_hitFraction_0=di._emscripten_bind_LocalConvexResult_get_m_hitFraction_0,Jl=r._emscripten_bind_btHingeConstraint_setBreakingImpulseThreshold_1=di._emscripten_bind_btHingeConstraint_setBreakingImpulseThreshold_1,th=r._emscripten_bind_btQuaternion_w_0=di._emscripten_bind_btQuaternion_w_0,eh=r._emscripten_bind_ConvexResultCallback_get_m_collisionFilterGroup_0=di._emscripten_bind_ConvexResultCallback_get_m_collisionFilterGroup_0,ih=r._emscripten_bind_btTransform_getRotation_0=di._emscripten_bind_btTransform_getRotation_0,nh=r._emscripten_bind_btHingeConstraint_btHingeConstraint_6=di._emscripten_bind_btHingeConstraint_btHingeConstraint_6,sh=r._emscripten_bind_btHingeConstraint_btHingeConstraint_7=di._emscripten_bind_btHingeConstraint_btHingeConstraint_7,rh=r._emscripten_bind_btCapsuleShapeZ_getMargin_0=di._emscripten_bind_btCapsuleShapeZ_getMargin_0,oh=r._emscripten_bind_btHingeConstraint_btHingeConstraint_5=di._emscripten_bind_btHingeConstraint_btHingeConstraint_5,ah=r._emscripten_bind_btHingeConstraint_btHingeConstraint_2=di._emscripten_bind_btHingeConstraint_btHingeConstraint_2,lh=r._emscripten_bind_btHingeConstraint_btHingeConstraint_3=di._emscripten_bind_btHingeConstraint_btHingeConstraint_3,hh=r._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingThresholdSqr_1=di._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingThresholdSqr_1,ch=r._emscripten_bind_btBoxShape_setMargin_1=di._emscripten_bind_btBoxShape_setMargin_1,_h=r._emscripten_bind_ClosestConvexResultCallback_get_m_hitNormalWorld_0=di._emscripten_bind_ClosestConvexResultCallback_get_m_hitNormalWorld_0,uh=r._emscripten_bind_btMatrix3x3_getRow_1=di._emscripten_bind_btMatrix3x3_getRow_1,dh=r._emscripten_bind_btTypedConstraint___destroy___0=di._emscripten_bind_btTypedConstraint___destroy___0,ph=r._emscripten_bind_btCylinderShapeX_btCylinderShapeX_1=di._emscripten_bind_btCylinderShapeX_btCylinderShapeX_1,fh=r._emscripten_enum_RotateOrder_RO_XYZ=di._emscripten_enum_RotateOrder_RO_XYZ,mh=r._emscripten_bind_btGeneric6DofSpringConstraint_setAngularUpperLimit_1=di._emscripten_bind_btGeneric6DofSpringConstraint_setAngularUpperLimit_1,gh=r._emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_3=di._emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_3,bh=r._emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_1=di._emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_1,yh=r._bitshift64Ashr=di._bitshift64Ashr,vh=r._emscripten_bind_btQuaternion_btQuaternion_4=di._emscripten_bind_btQuaternion_btQuaternion_4,Sh=r._emscripten_bind_btDiscreteDynamicsWorld_removeAction_1=di._emscripten_bind_btDiscreteDynamicsWorld_removeAction_1,xh=r._emscripten_bind_btSphereShape_btSphereShape_1=di._emscripten_bind_btSphereShape_btSphereShape_1,wh=r._emscripten_bind_btWheelInfo_get_m_wheelsSuspensionForce_0=di._emscripten_bind_btWheelInfo_get_m_wheelsSuspensionForce_0,Ch=r._emscripten_bind_btQuaternion_y_0=di._emscripten_bind_btQuaternion_y_0,Th=r._emscripten_bind_btCollisionWorld_addCollisionObject_1=di._emscripten_bind_btCollisionWorld_addCollisionObject_1,Ah=r._emscripten_bind_btCollisionWorld_addCollisionObject_2=di._emscripten_bind_btCollisionWorld_addCollisionObject_2,Eh=r._emscripten_bind_btCollisionWorld_addCollisionObject_3=di._emscripten_bind_btCollisionWorld_addCollisionObject_3,Mh=r._emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterGroup_1=di._emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterGroup_1,Rh=r._emscripten_bind_btConeTwistConstraint_setBreakingImpulseThreshold_1=di._emscripten_bind_btConeTwistConstraint_setBreakingImpulseThreshold_1,Ih=r._emscripten_bind_RaycastInfo_get_m_isInContact_0=di._emscripten_bind_RaycastInfo_get_m_isInContact_0,Ph=r._emscripten_bind_btGeneric6DofSpring2Constraint_setLinearUpperLimit_1=di._emscripten_bind_btGeneric6DofSpring2Constraint_setLinearUpperLimit_1,Lh=r._emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterGroup_0=di._emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterGroup_0,Dh=r._emscripten_bind_btCapsuleShape_setMargin_1=di._emscripten_bind_btCapsuleShape_setMargin_1,kh=r._emscripten_bind_btDefaultVehicleRaycaster_btDefaultVehicleRaycaster_1=di._emscripten_bind_btDefaultVehicleRaycaster_btDefaultVehicleRaycaster_1,Oh=r._emscripten_bind_btPoint2PointConstraint_get_m_setting_0=di._emscripten_bind_btPoint2PointConstraint_get_m_setting_0,Fh=r._emscripten_bind_btSequentialImpulseConstraintSolver_btSequentialImpulseConstraintSolver_0=di._emscripten_bind_btSequentialImpulseConstraintSolver_btSequentialImpulseConstraintSolver_0,Bh=r._emscripten_bind_btActionInterface___destroy___0=di._emscripten_bind_btActionInterface___destroy___0,Nh=r._emscripten_bind_btDefaultMotionState_setWorldTransform_1=di._emscripten_bind_btDefaultMotionState_setWorldTransform_1,Uh=r._emscripten_bind_btCollisionWorld_contactTest_2=di._emscripten_bind_btCollisionWorld_contactTest_2,Vh=r._emscripten_bind_RayResultCallback_get_m_collisionObject_0=di._emscripten_bind_RayResultCallback_get_m_collisionObject_0,zh=r._emscripten_bind_btPoint2PointConstraint_getPivotInA_0=di._emscripten_bind_btPoint2PointConstraint_getPivotInA_0,Wh=r._emscripten_bind_btGeneric6DofSpringConstraint_setStiffness_2=di._emscripten_bind_btGeneric6DofSpringConstraint_setStiffness_2,Gh=r._emscripten_bind_btVector4_setY_1=di._emscripten_bind_btVector4_setY_1,jh=r._emscripten_bind_btCompoundShape_setMargin_1=di._emscripten_bind_btCompoundShape_setMargin_1,Hh=r._emscripten_bind_ClosestConvexResultCallback___destroy___0=di._emscripten_bind_ClosestConvexResultCallback___destroy___0,Xh=r._emscripten_bind_btDynamicsWorld_addCollisionObject_1=di._emscripten_bind_btDynamicsWorld_addCollisionObject_1,Yh=r._emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterMask_0=di._emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterMask_0,qh=(r.___cxa_can_catch=di.___cxa_can_catch,r._emscripten_bind_btDynamicsWorld_addCollisionObject_2=di._emscripten_bind_btDynamicsWorld_addCollisionObject_2),Kh=r._emscripten_bind_btDiscreteDynamicsWorld_getDispatcher_0=di._emscripten_bind_btDiscreteDynamicsWorld_getDispatcher_0,Zh=r._emscripten_bind_btWheelInfo_get_m_maxSuspensionTravelCm_0=di._emscripten_bind_btWheelInfo_get_m_maxSuspensionTravelCm_0,Qh=r._emscripten_bind_btVector4_op_mul_1=di._emscripten_bind_btVector4_op_mul_1,$h=r._emscripten_bind_btCylinderShape_btCylinderShape_1=di._emscripten_bind_btCylinderShape_btCylinderShape_1,Jh=r._emscripten_bind_btVector3___destroy___0=di._emscripten_bind_btVector3___destroy___0,tc=r._emscripten_bind_RaycastInfo___destroy___0=di._emscripten_bind_RaycastInfo___destroy___0,ec=r._emscripten_bind_btRigidBody_setAngularFactor_1=di._emscripten_bind_btRigidBody_setAngularFactor_1,ic=r._emscripten_bind_btCylinderShapeZ_calculateLocalInertia_2=di._emscripten_bind_btCylinderShapeZ_calculateLocalInertia_2,nc=r._emscripten_bind_LocalShapeInfo_set_m_triangleIndex_1=di._emscripten_bind_LocalShapeInfo_set_m_triangleIndex_1,sc=r._emscripten_bind_btMotionState_getWorldTransform_1=di._emscripten_bind_btMotionState_getWorldTransform_1,rc=r._emscripten_bind_btDynamicsWorld_getSolverInfo_0=di._emscripten_bind_btDynamicsWorld_getSolverInfo_0,oc=r._emscripten_bind_btDispatcherInfo_set_m_dispatchFunc_1=di._emscripten_bind_btDispatcherInfo_set_m_dispatchFunc_1,ac=r._emscripten_bind_btSphereShape_getMargin_0=di._emscripten_bind_btSphereShape_getMargin_0,lc=r._emscripten_bind_btGeneric6DofSpring2Constraint_btGeneric6DofSpring2Constraint_5=di._emscripten_bind_btGeneric6DofSpring2Constraint_btGeneric6DofSpring2Constraint_5,hc=r._emscripten_bind_btVector3_x_0=di._emscripten_bind_btVector3_x_0,cc=(r.___cxa_is_pointer_type=di.___cxa_is_pointer_type,r._emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_3=di._emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_3),_c=r._emscripten_bind_btCollisionObject_getCollisionShape_0=di._emscripten_bind_btCollisionObject_getCollisionShape_0,uc=r._emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_4=di._emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_4,dc=r._emscripten_bind_btManifoldPoint___destroy___0=di._emscripten_bind_btManifoldPoint___destroy___0,pc=r._emscripten_bind_btRigidBodyConstructionInfo_set_m_rollingFriction_1=di._emscripten_bind_btRigidBodyConstructionInfo_set_m_rollingFriction_1,fc=r._emscripten_bind_btVector4_length_0=di._emscripten_bind_btVector4_length_0,mc=r._emscripten_bind_btDefaultMotionState_set_m_graphicsWorldTrans_1=di._emscripten_bind_btDefaultMotionState_set_m_graphicsWorldTrans_1,gc=r._emscripten_bind_btGhostObject_setRestitution_1=di._emscripten_bind_btGhostObject_setRestitution_1,bc=r._emscripten_bind_btConeTwistConstraint_setAngularOnly_1=di._emscripten_bind_btConeTwistConstraint_setAngularOnly_1,yc=r._emscripten_bind_btCollisionObject_setFriction_1=di._emscripten_bind_btCollisionObject_setFriction_1,vc=r._emscripten_bind_btDefaultCollisionConfiguration___destroy___0=di._emscripten_bind_btDefaultCollisionConfiguration___destroy___0,Sc=r._emscripten_bind_btRigidBody_setMassProps_2=di._emscripten_bind_btRigidBody_setMassProps_2,xc=r._emscripten_bind_btVector3_setValue_3=di._emscripten_bind_btVector3_setValue_3,wc=r._emscripten_bind_btPairCachingGhostObject_setCcdMotionThreshold_1=di._emscripten_bind_btPairCachingGhostObject_setCcdMotionThreshold_1,Cc=r._emscripten_bind_RaycastInfo_get_m_suspensionLength_0=di._emscripten_bind_RaycastInfo_get_m_suspensionLength_0,Tc=r._emscripten_bind_btGhostObject_getCollisionFlags_0=di._emscripten_bind_btGhostObject_getCollisionFlags_0,Ac=r._emscripten_bind_btCapsuleShapeX___destroy___0=di._emscripten_bind_btCapsuleShapeX___destroy___0,Ec=r._emscripten_bind_btKinematicCharacterController_setFallSpeed_1=di._emscripten_bind_btKinematicCharacterController_setFallSpeed_1,Mc=r._emscripten_bind_btHingeConstraint_setLimit_4=di._emscripten_bind_btHingeConstraint_setLimit_4,Rc=r._emscripten_bind_btHingeConstraint_setLimit_5=di._emscripten_bind_btHingeConstraint_setLimit_5,Ic=r._emscripten_bind_btDefaultVehicleRaycaster___destroy___0=di._emscripten_bind_btDefaultVehicleRaycaster___destroy___0,Pc=r._emscripten_bind_btWheelInfo_set_m_maxSuspensionTravelCm_1=di._emscripten_bind_btWheelInfo_set_m_maxSuspensionTravelCm_1,Lc=r._emscripten_bind_btWheelInfo_set_m_wheelsSuspensionForce_1=di._emscripten_bind_btWheelInfo_set_m_wheelsSuspensionForce_1,Dc=r._emscripten_bind_btGhostObject_getNumOverlappingObjects_0=di._emscripten_bind_btGhostObject_getNumOverlappingObjects_0,kc=r._emscripten_bind_btTypedConstraint_getBreakingImpulseThreshold_0=di._emscripten_bind_btTypedConstraint_getBreakingImpulseThreshold_0,Oc=r._emscripten_bind_btGhostObject_getCollisionShape_0=di._emscripten_bind_btGhostObject_getCollisionShape_0,Fc=r._emscripten_bind_btCollisionObject_setAnisotropicFriction_2=di._emscripten_bind_btCollisionObject_setAnisotropicFriction_2,Bc=r._emscripten_bind_btBoxShape___destroy___0=di._emscripten_bind_btBoxShape___destroy___0,Nc=r._emscripten_bind_btPersistentManifold_getContactPoint_1=di._emscripten_bind_btPersistentManifold_getContactPoint_1,Uc=r._emscripten_bind_btGeneric6DofSpringConstraint_getBreakingImpulseThreshold_0=di._emscripten_bind_btGeneric6DofSpringConstraint_getBreakingImpulseThreshold_0,Vc=r._emscripten_bind_ConvexResultCallback_set_m_collisionFilterGroup_1=di._emscripten_bind_ConvexResultCallback_set_m_collisionFilterGroup_1,zc=r._emscripten_bind_RaycastInfo_set_m_groundObject_1=di._emscripten_bind_RaycastInfo_set_m_groundObject_1,Wc=r._emscripten_bind_btGhostObject_activate_1=di._emscripten_bind_btGhostObject_activate_1,Gc=r._emscripten_bind_btGeneric6DofSpringConstraint_enableSpring_2=di._emscripten_bind_btGeneric6DofSpringConstraint_enableSpring_2,jc=r._emscripten_bind_btManifoldPoint_getPositionWorldOnB_0=di._emscripten_bind_btManifoldPoint_getPositionWorldOnB_0,Hc=r._emscripten_bind_btManifoldPoint_get_m_positionWorldOnA_0=di._emscripten_bind_btManifoldPoint_get_m_positionWorldOnA_0,Xc=r._emscripten_bind_btGeneric6DofSpringConstraint_enableFeedback_1=di._emscripten_bind_btGeneric6DofSpringConstraint_enableFeedback_1,Yc=r._emscripten_bind_btSphereShape_setMargin_1=di._emscripten_bind_btSphereShape_setMargin_1,qc=r._emscripten_bind_btGeneric6DofSpring2Constraint_setDamping_2=di._emscripten_bind_btGeneric6DofSpring2Constraint_setDamping_2,Kc=r._emscripten_bind_btConeShapeZ_btConeShapeZ_2=di._emscripten_bind_btConeShapeZ_btConeShapeZ_2,Zc=r._emscripten_bind_btContactSolverInfo_set_m_splitImpulsePenetrationThreshold_1=di._emscripten_bind_btContactSolverInfo_set_m_splitImpulsePenetrationThreshold_1,Qc=r._emscripten_bind_btSliderConstraint_setUpperAngLimit_1=di._emscripten_bind_btSliderConstraint_setUpperAngLimit_1,$c=r._emscripten_bind_btDynamicsWorld_contactPairTest_3=di._emscripten_bind_btDynamicsWorld_contactPairTest_3,Jc=r._emscripten_bind_btCollisionWorld_getPairCache_0=di._emscripten_bind_btCollisionWorld_getPairCache_0,t_=r._emscripten_bind_btConeTwistConstraint_setMotorTarget_1=di._emscripten_bind_btConeTwistConstraint_setMotorTarget_1,e_=r._emscripten_bind_ClosestConvexResultCallback_set_m_convexFromWorld_1=di._emscripten_bind_ClosestConvexResultCallback_set_m_convexFromWorld_1,i_=r._emscripten_bind_btWheelInfo_set_m_rollInfluence_1=di._emscripten_bind_btWheelInfo_set_m_rollInfluence_1,n_=r._emscripten_bind_btGeneric6DofConstraint_setBreakingImpulseThreshold_1=di._emscripten_bind_btGeneric6DofConstraint_setBreakingImpulseThreshold_1,s_=r._emscripten_bind_btDefaultCollisionConstructionInfo_btDefaultCollisionConstructionInfo_0=di._emscripten_bind_btDefaultCollisionConstructionInfo_btDefaultCollisionConstructionInfo_0,r_=r._emscripten_bind_btGhostObject_forceActivationState_1=di._emscripten_bind_btGhostObject_forceActivationState_1,o_=r._emscripten_bind_ConcreteContactResultCallback_ConcreteContactResultCallback_0=di._emscripten_bind_ConcreteContactResultCallback_ConcreteContactResultCallback_0,a_=r._emscripten_bind_VoidPtr___destroy___0=di._emscripten_bind_VoidPtr___destroy___0,l_=r._emscripten_bind_RaycastInfo_set_m_contactNormalWS_1=di._emscripten_bind_RaycastInfo_set_m_contactNormalWS_1,h_=r._emscripten_bind_btSliderConstraint_setLowerAngLimit_1=di._emscripten_bind_btSliderConstraint_setLowerAngLimit_1,c_=r._emscripten_bind_RaycastInfo_set_m_contactPointWS_1=di._emscripten_bind_RaycastInfo_set_m_contactPointWS_1,__=r._emscripten_bind_btConeShape_btConeShape_2=di._emscripten_bind_btConeShape_btConeShape_2,u_=r._emscripten_bind_ClosestRayResultCallback_get_m_rayFromWorld_0=di._emscripten_bind_ClosestRayResultCallback_get_m_rayFromWorld_0,d_=r._emscripten_bind_btRaycastVehicle_getRigidBody_0=di._emscripten_bind_btRaycastVehicle_getRigidBody_0,p_=r._emscripten_enum_RotateOrder_RO_YZX=di._emscripten_enum_RotateOrder_RO_YZX,f_=r._emscripten_bind_RayResultCallback_get_m_collisionFilterGroup_0=di._emscripten_bind_RayResultCallback_get_m_collisionFilterGroup_0,m_=r._emscripten_bind_btWheelInfo_get_m_steering_0=di._emscripten_bind_btWheelInfo_get_m_steering_0,g_=r._emscripten_bind_btConstraintSetting_get_m_tau_0=di._emscripten_bind_btConstraintSetting_get_m_tau_0,b_=r._emscripten_bind_btConeShape_setLocalScaling_1=di._emscripten_bind_btConeShape_setLocalScaling_1,y_=r._emscripten_bind_btCollisionObject_setCollisionShape_1=di._emscripten_bind_btCollisionObject_setCollisionShape_1,v_=r._emscripten_bind_btCollisionShape___destroy___0=di._emscripten_bind_btCollisionShape___destroy___0,S_=r._emscripten_bind_ConvexResultCallback_get_m_closestHitFraction_0=di._emscripten_bind_ConvexResultCallback_get_m_closestHitFraction_0,x_=r._emscripten_bind_btDispatcherInfo_get_m_dispatchFunc_0=di._emscripten_bind_btDispatcherInfo_get_m_dispatchFunc_0,w_=r._emscripten_bind_btRigidBodyConstructionInfo_get_m_rollingFriction_0=di._emscripten_bind_btRigidBodyConstructionInfo_get_m_rollingFriction_0,C_=r._emscripten_bind_btPairCachingGhostObject_setCollisionShape_1=di._emscripten_bind_btPairCachingGhostObject_setCollisionShape_1,T_=r._emscripten_bind_btKinematicCharacterController_warp_1=di._emscripten_bind_btKinematicCharacterController_warp_1,A_=r._emscripten_bind_btContactSolverInfo___destroy___0=di._emscripten_bind_btContactSolverInfo___destroy___0,E_=r._emscripten_bind_btTriangleMesh___destroy___0=di._emscripten_bind_btTriangleMesh___destroy___0,M_=r._emscripten_bind_btKinematicCharacterController_preStep_1=di._emscripten_bind_btKinematicCharacterController_preStep_1,R_=r._emscripten_bind_btRaycastVehicle_applyEngineForce_2=di._emscripten_bind_btRaycastVehicle_applyEngineForce_2,I_=r._emscripten_bind_btRaycastVehicle_setBrake_2=di._emscripten_bind_btRaycastVehicle_setBrake_2,P_=r._emscripten_bind_ConcreteContactResultCallback___destroy___0=di._emscripten_bind_ConcreteContactResultCallback___destroy___0,L_=r._emscripten_bind_RaycastInfo_set_m_wheelAxleWS_1=di._emscripten_bind_RaycastInfo_set_m_wheelAxleWS_1,D_=r._emscripten_bind_btGeneric6DofSpring2Constraint_setAngularLowerLimit_1=di._emscripten_bind_btGeneric6DofSpring2Constraint_setAngularLowerLimit_1,k_=r._emscripten_bind_btCollisionObject___destroy___0=di._emscripten_bind_btCollisionObject___destroy___0,O_=r._emscripten_bind_btVehicleTuning_set_m_suspensionDamping_1=di._emscripten_bind_btVehicleTuning_set_m_suspensionDamping_1,F_=r._emscripten_bind_btRigidBodyConstructionInfo_set_m_linearSleepingThreshold_1=di._emscripten_bind_btRigidBodyConstructionInfo_set_m_linearSleepingThreshold_1,B_=r._emscripten_bind_btConeTwistConstraint_setMotorTargetInConstraintSpace_1=di._emscripten_bind_btConeTwistConstraint_setMotorTargetInConstraintSpace_1,N_=r._emscripten_bind_btDispatcherInfo_set_m_timeStep_1=di._emscripten_bind_btDispatcherInfo_set_m_timeStep_1,U_=r._emscripten_bind_btVector3_btVector3_3=di._emscripten_bind_btVector3_btVector3_3,V_=r._emscripten_bind_btVector3_btVector3_0=di._emscripten_bind_btVector3_btVector3_0,z_=r._emscripten_bind_btRigidBodyConstructionInfo_set_m_friction_1=di._emscripten_bind_btRigidBodyConstructionInfo_set_m_friction_1,W_=r._emscripten_bind_btDiscreteDynamicsWorld_getGravity_0=di._emscripten_bind_btDiscreteDynamicsWorld_getGravity_0,G_=r._emscripten_bind_btVector3_z_0=di._emscripten_bind_btVector3_z_0,j_=r._emscripten_bind_ClosestConvexResultCallback_get_m_hitPointWorld_0=di._emscripten_bind_ClosestConvexResultCallback_get_m_hitPointWorld_0,H_=r._emscripten_bind_btBroadphaseInterface___destroy___0=di._emscripten_bind_btBroadphaseInterface___destroy___0,X_=r._emscripten_bind_btVehicleTuning_get_m_suspensionDamping_0=di._emscripten_bind_btVehicleTuning_get_m_suspensionDamping_0,Y_=r._emscripten_bind_ConcreteContactResultCallback_addSingleResult_7=di._emscripten_bind_ConcreteContactResultCallback_addSingleResult_7,q_=r._emscripten_bind_RaycastInfo_get_m_hardPointWS_0=di._emscripten_bind_RaycastInfo_get_m_hardPointWS_0,K_=r._emscripten_bind_btConeTwistConstraint___destroy___0=di._emscripten_bind_btConeTwistConstraint___destroy___0,Z_=r._emscripten_bind_btQuadWord___destroy___0=di._emscripten_bind_btQuadWord___destroy___0,Q_=r._emscripten_bind_ClosestRayResultCallback_set_m_rayFromWorld_1=di._emscripten_bind_ClosestRayResultCallback_set_m_rayFromWorld_1,$_=r._emscripten_bind_btGeneric6DofSpringConstraint_setDamping_2=di._emscripten_bind_btGeneric6DofSpringConstraint_setDamping_2,J_=r._emscripten_bind_RaycastInfo_get_m_wheelDirectionWS_0=di._emscripten_bind_RaycastInfo_get_m_wheelDirectionWS_0,tu=r._emscripten_bind_btRigidBody_setCenterOfMassTransform_1=di._emscripten_bind_btRigidBody_setCenterOfMassTransform_1,eu=r._emscripten_bind_btWheelInfo_get_m_chassisConnectionPointCS_0=di._emscripten_bind_btWheelInfo_get_m_chassisConnectionPointCS_0,iu=r._emscripten_bind_btGhostObject_setAnisotropicFriction_2=di._emscripten_bind_btGhostObject_setAnisotropicFriction_2,nu=r._emscripten_bind_btConstraintSolver___destroy___0=di._emscripten_bind_btConstraintSolver___destroy___0,su=r._emscripten_bind_btDbvtBroadphase___destroy___0=di._emscripten_bind_btDbvtBroadphase___destroy___0,ru=r._emscripten_bind_btCapsuleShape_btCapsuleShape_2=di._emscripten_bind_btCapsuleShape_btCapsuleShape_2,ou=r._emscripten_bind_btTypedConstraint_enableFeedback_1=di._emscripten_bind_btTypedConstraint_enableFeedback_1,au=r._emscripten_bind_btGhostObject_activate_0=di._emscripten_bind_btGhostObject_activate_0,lu=r._emscripten_bind_btCapsuleShape_setLocalScaling_1=di._emscripten_bind_btCapsuleShape_setLocalScaling_1,hu=r._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDampingFactor_0=di._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDampingFactor_0,cu=r._emscripten_bind_btRigidBody_setAnisotropicFriction_2=di._emscripten_bind_btRigidBody_setAnisotropicFriction_2,_u=r._emscripten_bind_btTriangleMeshShape_setLocalScaling_1=di._emscripten_bind_btTriangleMeshShape_setLocalScaling_1,uu=r._emscripten_bind_ConvexResultCallback_set_m_closestHitFraction_1=di._emscripten_bind_ConvexResultCallback_set_m_closestHitFraction_1,du=r._emscripten_bind_btVector3_op_add_1=di._emscripten_bind_btVector3_op_add_1,pu=r._emscripten_bind_btPersistentManifold_btPersistentManifold_0=di._emscripten_bind_btPersistentManifold_btPersistentManifold_0,fu=r._emscripten_bind_ConvexResultCallback_get_m_collisionFilterMask_0=di._emscripten_bind_ConvexResultCallback_get_m_collisionFilterMask_0,mu=r._emscripten_bind_ClosestRayResultCallback_ClosestRayResultCallback_2=di._emscripten_bind_ClosestRayResultCallback_ClosestRayResultCallback_2,gu=r._emscripten_bind_btVector4___destroy___0=di._emscripten_bind_btVector4___destroy___0,bu=r._emscripten_bind_btPairCachingGhostObject_isKinematicObject_0=di._emscripten_bind_btPairCachingGhostObject_isKinematicObject_0,yu=r._emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterMask_1=di._emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterMask_1,vu=r._i64Add=di._i64Add,Su=r._emscripten_bind_btStaticPlaneShape_calculateLocalInertia_2=di._emscripten_bind_btStaticPlaneShape_calculateLocalInertia_2,xu=r._emscripten_bind_btVehicleTuning_set_m_maxSuspensionForce_1=di._emscripten_bind_btVehicleTuning_set_m_maxSuspensionForce_1,wu=r._emscripten_bind_btCollisionObject_setCcdMotionThreshold_1=di._emscripten_bind_btCollisionObject_setCcdMotionThreshold_1,Cu=r._emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_4=di._emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_4,Tu=r._emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_1=di._emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_1,Au=r._emscripten_bind_btQuadWord_setZ_1=di._emscripten_bind_btQuadWord_setZ_1,Eu=r._emscripten_bind_btRigidBodyConstructionInfo_get_m_angularSleepingThreshold_0=di._emscripten_bind_btRigidBodyConstructionInfo_get_m_angularSleepingThreshold_0,Mu=r._emscripten_bind_btPoint2PointConstraint_getPivotInB_0=di._emscripten_bind_btPoint2PointConstraint_getPivotInB_0,Ru=r._emscripten_bind_btKinematicCharacterController_playerStep_2=di._emscripten_bind_btKinematicCharacterController_playerStep_2,Iu=r._emscripten_bind_btDispatcherInfo___destroy___0=di._emscripten_bind_btDispatcherInfo___destroy___0,Pu=r._emscripten_bind_btCapsuleShape_getMargin_0=di._emscripten_bind_btCapsuleShape_getMargin_0,Lu=r._emscripten_bind_btCylinderShape_getMargin_0=di._emscripten_bind_btCylinderShape_getMargin_0,Du=r._emscripten_bind_btStaticPlaneShape_setLocalScaling_1=di._emscripten_bind_btStaticPlaneShape_setLocalScaling_1,ku=r._emscripten_bind_btConvexTriangleMeshShape_calculateLocalInertia_2=di._emscripten_bind_btConvexTriangleMeshShape_calculateLocalInertia_2,Ou=r._emscripten_bind_btQuaternion___destroy___0=di._emscripten_bind_btQuaternion___destroy___0,Fu=r._emscripten_bind_btGhostObject_getWorldTransform_0=di._emscripten_bind_btGhostObject_getWorldTransform_0,Bu=r._emscripten_bind_btDiscreteDynamicsWorld_getPairCache_0=di._emscripten_bind_btDiscreteDynamicsWorld_getPairCache_0,Nu=r._emscripten_bind_LocalConvexResult_set_m_hitFraction_1=di._emscripten_bind_LocalConvexResult_set_m_hitFraction_1,Uu=r._emscripten_bind_btCapsuleShapeZ_calculateLocalInertia_2=di._emscripten_bind_btCapsuleShapeZ_calculateLocalInertia_2,Vu=r._emscripten_bind_btDispatcherInfo_get_m_timeStep_0=di._emscripten_bind_btDispatcherInfo_get_m_timeStep_0,zu=r._emscripten_bind_btVehicleTuning_set_m_suspensionCompression_1=di._emscripten_bind_btVehicleTuning_set_m_suspensionCompression_1,Wu=r._emscripten_bind_btBoxShape_calculateLocalInertia_2=di._emscripten_bind_btBoxShape_calculateLocalInertia_2,Gu=r._emscripten_bind_btMotionState___destroy___0=di._emscripten_bind_btMotionState___destroy___0,ju=r._emscripten_bind_btGeneric6DofSpring2Constraint___destroy___0=di._emscripten_bind_btGeneric6DofSpring2Constraint___destroy___0,Hu=r._emscripten_bind_btCollisionObject_setCollisionFlags_1=di._emscripten_bind_btCollisionObject_setCollisionFlags_1,Xu=r._emscripten_bind_btGeneric6DofSpring2Constraint_getTranslationalLimitMotor_0=di._emscripten_bind_btGeneric6DofSpring2Constraint_getTranslationalLimitMotor_0,Yu=r._emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_1=di._emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_1,qu=r._emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_2=di._emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_2,Ku=r._emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_3=di._emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_3,Zu=r._emscripten_bind_btWheelInfo_set_m_suspensionStiffness_1=di._emscripten_bind_btWheelInfo_set_m_suspensionStiffness_1,Qu=r._emscripten_bind_btConvexTriangleMeshShape___destroy___0=di._emscripten_bind_btConvexTriangleMeshShape___destroy___0,$u=r._emscripten_bind_btDispatcher_getManifoldByIndexInternal_1=di._emscripten_bind_btDispatcher_getManifoldByIndexInternal_1,Ju=r._emscripten_bind_btRaycastVehicle_getWheelInfo_1=di._emscripten_bind_btRaycastVehicle_getWheelInfo_1,td=r._bitshift64Lshr=di._bitshift64Lshr,ed=r._emscripten_bind_btWheelInfo_set_m_steering_1=di._emscripten_bind_btWheelInfo_set_m_steering_1,id=r._emscripten_bind_btPairCachingGhostObject_setWorldTransform_1=di._emscripten_bind_btPairCachingGhostObject_setWorldTransform_1,nd=r._emscripten_bind_btHingeConstraint_getBreakingImpulseThreshold_0=di._emscripten_bind_btHingeConstraint_getBreakingImpulseThreshold_0,sd=r._emscripten_bind_btDefaultCollisionConstructionInfo___destroy___0=di._emscripten_bind_btDefaultCollisionConstructionInfo___destroy___0,rd=r._emscripten_bind_btGhostObject_setCcdSweptSphereRadius_1=di._emscripten_bind_btGhostObject_setCcdSweptSphereRadius_1,od=r._emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_4=di._emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_4,ad=r._emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_2=di._emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_2,ld=r._emscripten_bind_btKinematicCharacterController_setJumpSpeed_1=di._emscripten_bind_btKinematicCharacterController_setJumpSpeed_1,hd=r._emscripten_bind_btConeShapeX_calculateLocalInertia_2=di._emscripten_bind_btConeShapeX_calculateLocalInertia_2,cd=r._emscripten_bind_btPairCachingGhostObject_getOverlappingObject_1=di._emscripten_bind_btPairCachingGhostObject_getOverlappingObject_1,_d=r._emscripten_bind_btRigidBodyConstructionInfo___destroy___0=di._emscripten_bind_btRigidBodyConstructionInfo___destroy___0,ud=r._emscripten_bind_btRigidBody_getWorldTransform_0=di._emscripten_bind_btRigidBody_getWorldTransform_0,dd=r._emscripten_bind_btPoint2PointConstraint_setPivotA_1=di._emscripten_bind_btPoint2PointConstraint_setPivotA_1,pd=r._emscripten_bind_ClosestConvexResultCallback_set_m_convexToWorld_1=di._emscripten_bind_ClosestConvexResultCallback_set_m_convexToWorld_1,fd=r._memcpy=di._memcpy,md=r._emscripten_bind_btCapsuleShape_calculateLocalInertia_2=di._emscripten_bind_btCapsuleShape_calculateLocalInertia_2,gd=r._emscripten_bind_btVector3_y_0=di._emscripten_bind_btVector3_y_0,bd=r._emscripten_bind_btVehicleTuning_get_m_maxSuspensionForce_0=di._emscripten_bind_btVehicleTuning_get_m_maxSuspensionForce_0,yd=r._emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_2=di._emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_2,vd=r._emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_3=di._emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_3,Sd=r._emscripten_bind_LocalShapeInfo_get_m_triangleIndex_0=di._emscripten_bind_LocalShapeInfo_get_m_triangleIndex_0,xd=r._emscripten_bind_btGhostObject_setCollisionShape_1=di._emscripten_bind_btGhostObject_setCollisionShape_1,wd=r._emscripten_bind_btDispatcherInfo_set_m_allowedCcdPenetration_1=di._emscripten_bind_btDispatcherInfo_set_m_allowedCcdPenetration_1,Cd=r._emscripten_bind_btRigidBody_setRollingFriction_1=di._emscripten_bind_btRigidBody_setRollingFriction_1,Td=r._emscripten_bind_btPairCachingGhostObject_setRollingFriction_1=di._emscripten_bind_btPairCachingGhostObject_setRollingFriction_1,Ad=r._emscripten_bind_btDiscreteDynamicsWorld_setGravity_1=di._emscripten_bind_btDiscreteDynamicsWorld_setGravity_1,Ed=r._emscripten_bind_btVehicleTuning_set_m_suspensionStiffness_1=di._emscripten_bind_btVehicleTuning_set_m_suspensionStiffness_1,Md=r._emscripten_bind_btVector4_z_0=di._emscripten_bind_btVector4_z_0,Rd=r._emscripten_bind_btCollisionObject_forceActivationState_1=di._emscripten_bind_btCollisionObject_forceActivationState_1,Id=r._emscripten_bind_btKinematicCharacterController_onGround_0=di._emscripten_bind_btKinematicCharacterController_onGround_0,Pd=r._free=di._free,Ld=r._emscripten_bind_btGeneric6DofConstraint_getBreakingImpulseThreshold_0=di._emscripten_bind_btGeneric6DofConstraint_getBreakingImpulseThreshold_0,Dd=r._emscripten_bind_btConeTwistConstraint_setLimit_2=di._emscripten_bind_btConeTwistConstraint_setLimit_2,kd=r._emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterMask_1=di._emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterMask_1,Od=r._emscripten_bind_btRigidBody___destroy___0=di._emscripten_bind_btRigidBody___destroy___0,Fd=r._emscripten_bind_btStridingMeshInterface___destroy___0=di._emscripten_bind_btStridingMeshInterface___destroy___0,Bd=(r.runPostSets=di.runPostSets,r._emscripten_bind_btRigidBody_setSleepingThresholds_2=di._emscripten_bind_btRigidBody_setSleepingThresholds_2),Nd=r._emscripten_bind_btCollisionObject_setWorldTransform_1=di._emscripten_bind_btCollisionObject_setWorldTransform_1,Ud=r._emscripten_bind_LocalConvexResult_get_m_localShapeInfo_0=di._emscripten_bind_LocalConvexResult_get_m_localShapeInfo_0,Vd=r._emscripten_bind_btManifoldPoint_get_m_localPointA_0=di._emscripten_bind_btManifoldPoint_get_m_localPointA_0,zd=r._emscripten_bind_btRigidBodyConstructionInfo_get_m_linearDamping_0=di._emscripten_bind_btRigidBodyConstructionInfo_get_m_linearDamping_0,Wd=r._emscripten_bind_btGeneric6DofSpring2Constraint_enableFeedback_1=di._emscripten_bind_btGeneric6DofSpring2Constraint_enableFeedback_1,Gd=r._emscripten_bind_btDispatcher_getNumManifolds_0=di._emscripten_bind_btDispatcher_getNumManifolds_0,jd=r._emscripten_bind_btRigidBodyConstructionInfo_get_m_linearSleepingThreshold_0=di._emscripten_bind_btRigidBodyConstructionInfo_get_m_linearSleepingThreshold_0,Hd=r._emscripten_bind_btRigidBody_activate_1=di._emscripten_bind_btRigidBody_activate_1,Xd=r._emscripten_bind_btRigidBody_activate_0=di._emscripten_bind_btRigidBody_activate_0,Yd=r._emscripten_bind_btRaycastVehicle___destroy___0=di._emscripten_bind_btRaycastVehicle___destroy___0,qd=r._emscripten_bind_btGhostObject_setActivationState_1=di._emscripten_bind_btGhostObject_setActivationState_1,Kd=r._emscripten_bind_btCollisionWorld_contactPairTest_3=di._emscripten_bind_btCollisionWorld_contactPairTest_3,Zd=r._emscripten_bind_btCylinderShapeX___destroy___0=di._emscripten_bind_btCylinderShapeX___destroy___0,Qd=r._emscripten_bind_btManifoldPoint_getPositionWorldOnA_0=di._emscripten_bind_btManifoldPoint_getPositionWorldOnA_0,$d=r._emscripten_bind_ContactResultCallback___destroy___0=di._emscripten_bind_ContactResultCallback___destroy___0,Jd=r._emscripten_bind_btDispatcherInfo_set_m_stepCount_1=di._emscripten_bind_btDispatcherInfo_set_m_stepCount_1,tp=r._emscripten_bind_btVector4_x_0=di._emscripten_bind_btVector4_x_0,ep=r._emscripten_bind_btConstraintSetting_btConstraintSetting_0=di._emscripten_bind_btConstraintSetting_btConstraintSetting_0,ip=r._emscripten_bind_btRigidBody_getMotionState_0=di._emscripten_bind_btRigidBody_getMotionState_0,np=r._emscripten_bind_btKinematicCharacterController_getGhostObject_0=di._emscripten_bind_btKinematicCharacterController_getGhostObject_0,sp=r._emscripten_bind_btRigidBody_btRigidBody_1=di._emscripten_bind_btRigidBody_btRigidBody_1,rp=r._emscripten_bind_btTriangleMeshShape___destroy___0=di._emscripten_bind_btTriangleMeshShape___destroy___0,op=r._emscripten_bind_btKinematicCharacterController_setWalkDirection_1=di._emscripten_bind_btKinematicCharacterController_setWalkDirection_1,ap=r._emscripten_bind_btDynamicsWorld_removeAction_1=di._emscripten_bind_btDynamicsWorld_removeAction_1,lp=r._emscripten_bind_btRigidBodyConstructionInfo_get_m_restitution_0=di._emscripten_bind_btRigidBodyConstructionInfo_get_m_restitution_0,hp=r._emscripten_bind_btVehicleTuning_get_m_suspensionStiffness_0=di._emscripten_bind_btVehicleTuning_get_m_suspensionStiffness_0,cp=r._emscripten_bind_btManifoldPoint_set_m_normalWorldOnB_1=di._emscripten_bind_btManifoldPoint_set_m_normalWorldOnB_1,_p=r._emscripten_bind_btKinematicCharacterController_getGravity_0=di._emscripten_bind_btKinematicCharacterController_getGravity_0,up=r._emscripten_bind_btConeTwistConstraint_getBreakingImpulseThreshold_0=di._emscripten_bind_btConeTwistConstraint_getBreakingImpulseThreshold_0,dp=r._emscripten_bind_btGeneric6DofConstraint_setAngularLowerLimit_1=di._emscripten_bind_btGeneric6DofConstraint_setAngularLowerLimit_1,pp=r._emscripten_bind_btVector4_normalize_0=di._emscripten_bind_btVector4_normalize_0,fp=r._emscripten_bind_btQuaternion_setY_1=di._emscripten_bind_btQuaternion_setY_1,mp=r._emscripten_bind_btConeShape_calculateLocalInertia_2=di._emscripten_bind_btConeShape_calculateLocalInertia_2,gp=r._emscripten_bind_btCylinderShapeX_calculateLocalInertia_2=di._emscripten_bind_btCylinderShapeX_calculateLocalInertia_2,bp=r._emscripten_bind_ConvexResultCallback_set_m_collisionFilterMask_1=di._emscripten_bind_ConvexResultCallback_set_m_collisionFilterMask_1,yp=r._llvm_bswap_i32=di._llvm_bswap_i32,vp=r._emscripten_enum_RotateOrder_RO_XZY=di._emscripten_enum_RotateOrder_RO_XZY,Sp=r._emscripten_bind_btSphereShape_setLocalScaling_1=di._emscripten_bind_btSphereShape_setLocalScaling_1,xp=r._emscripten_bind_btVector4_w_0=di._emscripten_bind_btVector4_w_0,wp=r._emscripten_bind_btManifoldPoint_get_m_normalWorldOnB_0=di._emscripten_bind_btManifoldPoint_get_m_normalWorldOnB_0,Cp=r._emscripten_bind_btBvhTriangleMeshShape___destroy___0=di._emscripten_bind_btBvhTriangleMeshShape___destroy___0,Tp=r._emscripten_bind_ClosestRayResultCallback_get_m_rayToWorld_0=di._emscripten_bind_ClosestRayResultCallback_get_m_rayToWorld_0,Ap=r._emscripten_bind_ClosestConvexResultCallback_set_m_closestHitFraction_1=di._emscripten_bind_ClosestConvexResultCallback_set_m_closestHitFraction_1,Ep=r._emscripten_bind_btDiscreteDynamicsWorld_removeConstraint_1=di._emscripten_bind_btDiscreteDynamicsWorld_removeConstraint_1,Mp=r._emscripten_bind_btVector4_y_0=di._emscripten_bind_btVector4_y_0,Rp=r._emscripten_bind_btGeneric6DofConstraint___destroy___0=di._emscripten_bind_btGeneric6DofConstraint___destroy___0,Ip=r._emscripten_bind_btVehicleTuning_get_m_maxSuspensionTravelCm_0=di._emscripten_bind_btVehicleTuning_get_m_maxSuspensionTravelCm_0,Pp=r._emscripten_bind_btConvexHullShape_addPoint_1=di._emscripten_bind_btConvexHullShape_addPoint_1,Lp=r._emscripten_bind_btConvexHullShape_addPoint_2=di._emscripten_bind_btConvexHullShape_addPoint_2,Dp=r._emscripten_bind_btPoint2PointConstraint_getBreakingImpulseThreshold_0=di._emscripten_bind_btPoint2PointConstraint_getBreakingImpulseThreshold_0,kp=r._emscripten_bind_btTransform_getOrigin_0=di._emscripten_bind_btTransform_getOrigin_0,Op=r._emscripten_enum_RotateOrder_RO_ZYX=di._emscripten_enum_RotateOrder_RO_ZYX,Fp=r._emscripten_bind_btHingeConstraint___destroy___0=di._emscripten_bind_btHingeConstraint___destroy___0,Bp=r._emscripten_bind_btConvexShape_calculateLocalInertia_2=di._emscripten_bind_btConvexShape_calculateLocalInertia_2,Np=r._memset=di._memset,Up=r._emscripten_bind_btGeneric6DofConstraint_setLinearLowerLimit_1=di._emscripten_bind_btGeneric6DofConstraint_setLinearLowerLimit_1,Vp=r._emscripten_bind_ClosestRayResultCallback_get_m_hitNormalWorld_0=di._emscripten_bind_ClosestRayResultCallback_get_m_hitNormalWorld_0,zp=r._emscripten_bind_btTriangleMesh_btTriangleMesh_0=di._emscripten_bind_btTriangleMesh_btTriangleMesh_0,Wp=r._emscripten_bind_btTriangleMesh_btTriangleMesh_1=di._emscripten_bind_btTriangleMesh_btTriangleMesh_1,Gp=r._emscripten_bind_btTriangleMesh_btTriangleMesh_2=di._emscripten_bind_btTriangleMesh_btTriangleMesh_2,jp=r._emscripten_bind_btWheelInfo_set_m_frictionSlip_1=di._emscripten_bind_btWheelInfo_set_m_frictionSlip_1,Hp=r._emscripten_bind_btRigidBody_getCollisionShape_0=di._emscripten_bind_btRigidBody_getCollisionShape_0,Xp=r._emscripten_bind_btManifoldPoint_set_m_positionWorldOnA_1=di._emscripten_bind_btManifoldPoint_set_m_positionWorldOnA_1,Yp=r._emscripten_bind_btWheelInfo_get_m_wheelsDampingRelaxation_0=di._emscripten_bind_btWheelInfo_get_m_wheelsDampingRelaxation_0,qp=r._emscripten_bind_btManifoldPoint_get_m_localPointB_0=di._emscripten_bind_btManifoldPoint_get_m_localPointB_0,Kp=r._emscripten_bind_btDiscreteDynamicsWorld_contactPairTest_3=di._emscripten_bind_btDiscreteDynamicsWorld_contactPairTest_3,Zp=r._emscripten_bind_btSliderConstraint_setLowerLinLimit_1=di._emscripten_bind_btSliderConstraint_setLowerLinLimit_1,Qp=r._emscripten_bind_btRigidBody_getAngularVelocity_0=di._emscripten_bind_btRigidBody_getAngularVelocity_0,$p=r._emscripten_bind_btCollisionObject_setCcdSweptSphereRadius_1=di._emscripten_bind_btCollisionObject_setCcdSweptSphereRadius_1,Jp=r._emscripten_bind_btWheelInfo_get_m_wheelsRadius_0=di._emscripten_bind_btWheelInfo_get_m_wheelsRadius_0,tf=r._emscripten_bind_btRigidBody_setLinearVelocity_1=di._emscripten_bind_btRigidBody_setLinearVelocity_1,ef=r._emscripten_bind_btVehicleTuning_btVehicleTuning_0=di._emscripten_bind_btVehicleTuning_btVehicleTuning_0,nf=r._emscripten_bind_RayResultCallback_set_m_collisionObject_1=di._emscripten_bind_RayResultCallback_set_m_collisionObject_1,sf=r._emscripten_bind_ClosestRayResultCallback_set_m_rayToWorld_1=di._emscripten_bind_ClosestRayResultCallback_set_m_rayToWorld_1,rf=r._emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterGroup_0=di._emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterGroup_0,of=r._emscripten_bind_btWheelInfo_set_m_wheelsDampingRelaxation_1=di._emscripten_bind_btWheelInfo_set_m_wheelsDampingRelaxation_1,af=r._emscripten_bind_btDynamicsWorld_addAction_1=di._emscripten_bind_btDynamicsWorld_addAction_1,lf=r._emscripten_bind_btVector4_op_sub_1=di._emscripten_bind_btVector4_op_sub_1,hf=r._emscripten_bind_RaycastInfo_set_m_hardPointWS_1=di._emscripten_bind_RaycastInfo_set_m_hardPointWS_1,cf=r._emscripten_bind_btPairCachingGhostObject_getCollisionFlags_0=di._emscripten_bind_btPairCachingGhostObject_getCollisionFlags_0,_f=r._emscripten_bind_btRigidBodyConstructionInfo_set_m_linearDamping_1=di._emscripten_bind_btRigidBodyConstructionInfo_set_m_linearDamping_1,uf=r._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDamping_1=di._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDamping_1,df=r._emscripten_bind_btGeneric6DofSpring2Constraint_setLinearLowerLimit_1=di._emscripten_bind_btGeneric6DofSpring2Constraint_setLinearLowerLimit_1,pf=r._emscripten_bind_btRigidBody_setActivationState_1=di._emscripten_bind_btRigidBody_setActivationState_1,ff=r._emscripten_bind_btWheelInfo_get_m_wheelsDampingCompression_0=di._emscripten_bind_btWheelInfo_get_m_wheelsDampingCompression_0,mf=r._emscripten_bind_ClosestConvexResultCallback_hasHit_0=di._emscripten_bind_ClosestConvexResultCallback_hasHit_0,gf=r._emscripten_bind_btCapsuleShapeZ___destroy___0=di._emscripten_bind_btCapsuleShapeZ___destroy___0,bf=r._emscripten_bind_btWheelInfo_get_m_maxSuspensionForce_0=di._emscripten_bind_btWheelInfo_get_m_maxSuspensionForce_0,yf=r._emscripten_bind_ClosestRayResultCallback_get_m_collisionObject_0=di._emscripten_bind_ClosestRayResultCallback_get_m_collisionObject_0,vf=r._emscripten_bind_btTriangleMesh_addTriangle_3=di._emscripten_bind_btTriangleMesh_addTriangle_3,Sf=r._emscripten_bind_btGhostObject_getOverlappingObject_1=di._emscripten_bind_btGhostObject_getOverlappingObject_1,xf=r._emscripten_bind_btTriangleMesh_addTriangle_4=di._emscripten_bind_btTriangleMesh_addTriangle_4,wf=r._emscripten_bind_btRigidBody_applyTorqueImpulse_1=di._emscripten_bind_btRigidBody_applyTorqueImpulse_1,Cf=r._emscripten_bind_btRigidBody_setCollisionFlags_1=di._emscripten_bind_btRigidBody_setCollisionFlags_1,Tf=r._emscripten_bind_btWheelInfo_set_m_suspensionRestLength1_1=di._emscripten_bind_btWheelInfo_set_m_suspensionRestLength1_1,Af=r._emscripten_bind_btConeShape___destroy___0=di._emscripten_bind_btConeShape___destroy___0,Ef=r._emscripten_bind_btCapsuleShapeZ_btCapsuleShapeZ_2=di._emscripten_bind_btCapsuleShapeZ_btCapsuleShapeZ_2,Mf=r._emscripten_bind_btSliderConstraint_btSliderConstraint_5=di._emscripten_bind_btSliderConstraint_btSliderConstraint_5,Rf=r._emscripten_bind_btSliderConstraint_btSliderConstraint_3=di._emscripten_bind_btSliderConstraint_btSliderConstraint_3,If=r._emscripten_bind_btTransform___destroy___0=di._emscripten_bind_btTransform___destroy___0,Pf=r._emscripten_bind_btDynamicsWorld_convexSweepTest_5=di._emscripten_bind_btDynamicsWorld_convexSweepTest_5,Lf=r._emscripten_bind_btSliderConstraint___destroy___0=di._emscripten_bind_btSliderConstraint___destroy___0,Df=r._emscripten_bind_btRigidBody_forceActivationState_1=di._emscripten_bind_btRigidBody_forceActivationState_1,kf=r._emscripten_bind_btPoint2PointConstraint_setPivotB_1=di._emscripten_bind_btPoint2PointConstraint_setPivotB_1,Of=r._emscripten_bind_btManifoldPoint_getDistance_0=di._emscripten_bind_btManifoldPoint_getDistance_0,Ff=r._emscripten_bind_btGhostPairCallback___destroy___0=di._emscripten_bind_btGhostPairCallback___destroy___0,Bf=r._emscripten_bind_btKinematicCharacterController_getMaxSlope_0=di._emscripten_bind_btKinematicCharacterController_getMaxSlope_0,Nf=r._emscripten_bind_btSliderConstraint_enableFeedback_1=di._emscripten_bind_btSliderConstraint_enableFeedback_1,Uf=r._emscripten_bind_btRaycastVehicle_addWheel_7=di._emscripten_bind_btRaycastVehicle_addWheel_7,Vf=r._emscripten_bind_ClosestRayResultCallback_set_m_hitNormalWorld_1=di._emscripten_bind_ClosestRayResultCallback_set_m_hitNormalWorld_1,zf=r._emscripten_bind_LocalConvexResult_set_m_localShapeInfo_1=di._emscripten_bind_LocalConvexResult_set_m_localShapeInfo_1,Wf=r._emscripten_bind_btStaticPlaneShape___destroy___0=di._emscripten_bind_btStaticPlaneShape___destroy___0,Gf=r._emscripten_bind_btCylinderShapeZ_setLocalScaling_1=di._emscripten_bind_btCylinderShapeZ_setLocalScaling_1,jf=r._emscripten_bind_btBoxShape_setLocalScaling_1=di._emscripten_bind_btBoxShape_setLocalScaling_1,Hf=r._emscripten_bind_btConeShapeZ___destroy___0=di._emscripten_bind_btConeShapeZ___destroy___0,Xf=r._emscripten_bind_btDynamicsWorld_getPairCache_0=di._emscripten_bind_btDynamicsWorld_getPairCache_0,Yf=r._emscripten_bind_btDiscreteDynamicsWorld_convexSweepTest_5=di._emscripten_bind_btDiscreteDynamicsWorld_convexSweepTest_5,qf=r._emscripten_bind_btKinematicCharacterController_setVelocityForTimeInterval_2=di._emscripten_bind_btKinematicCharacterController_setVelocityForTimeInterval_2,Kf=r._emscripten_bind_btRigidBody_setRestitution_1=di._emscripten_bind_btRigidBody_setRestitution_1,Zf=r._emscripten_bind_btVector4_btVector4_0=di._emscripten_bind_btVector4_btVector4_0,Qf=r._emscripten_bind_btDispatcherInfo_get_m_enableSatConvex_0=di._emscripten_bind_btDispatcherInfo_get_m_enableSatConvex_0,$f=r._emscripten_bind_btVector4_btVector4_4=di._emscripten_bind_btVector4_btVector4_4,Jf=r._emscripten_bind_btKinematicCharacterController___destroy___0=di._emscripten_bind_btKinematicCharacterController___destroy___0,tm=r._emscripten_bind_btGeneric6DofSpringConstraint_setLinearLowerLimit_1=di._emscripten_bind_btGeneric6DofSpringConstraint_setLinearLowerLimit_1,em=r._emscripten_enum_RotateOrder_RO_ZXY=di._emscripten_enum_RotateOrder_RO_ZXY,im=r._emscripten_bind_LocalConvexResult_set_m_hitCollisionObject_1=di._emscripten_bind_LocalConvexResult_set_m_hitCollisionObject_1,nm=r._emscripten_bind_btRotationalLimitMotor2_set_m_currentPosition_1=di._emscripten_bind_btRotationalLimitMotor2_set_m_currentPosition_1,sm=r._emscripten_bind_btGeneric6DofSpringConstraint_setAngularLowerLimit_1=di._emscripten_bind_btGeneric6DofSpringConstraint_setAngularLowerLimit_1,rm=r._emscripten_bind_btDiscreteDynamicsWorld_rayTest_3=di._emscripten_bind_btDiscreteDynamicsWorld_rayTest_3,om=r._emscripten_bind_btWheelInfo_get_m_raycastInfo_0=di._emscripten_bind_btWheelInfo_get_m_raycastInfo_0,am=r._emscripten_bind_btContactSolverInfo_get_m_splitImpulse_0=di._emscripten_bind_btContactSolverInfo_get_m_splitImpulse_0,lm=r._emscripten_bind_btGhostPairCallback_btGhostPairCallback_0=di._emscripten_bind_btGhostPairCallback_btGhostPairCallback_0,hm=r._emscripten_bind_btKinematicCharacterController_setMaxJumpHeight_1=di._emscripten_bind_btKinematicCharacterController_setMaxJumpHeight_1,cm=r._emscripten_bind_btPairCachingGhostObject_isActive_0=di._emscripten_bind_btPairCachingGhostObject_isActive_0,_m=r._emscripten_bind_btVehicleTuning_get_m_frictionSlip_0=di._emscripten_bind_btVehicleTuning_get_m_frictionSlip_0;function um(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}r.dynCall_viiiii=di.dynCall_viiiii,r.dynCall_vid=di.dynCall_vid,r.dynCall_vi=di.dynCall_vi,r.dynCall_viiidii=di.dynCall_viiidii,r.dynCall_vii=di.dynCall_vii,r.dynCall_iiiiiiiiiii=di.dynCall_iiiiiiiiiii,r.dynCall_ii=di.dynCall_ii,r.dynCall_viidi=di.dynCall_viidi,r.dynCall_viddiii=di.dynCall_viddiii,r.dynCall_vidii=di.dynCall_vidii,r.dynCall_iiiii=di.dynCall_iiiii,r.dynCall_vidi=di.dynCall_vidi,r.dynCall_diiiiiiii=di.dynCall_diiiiiiii,r.dynCall_viiiiddddiid=di.dynCall_viiiiddddiid,r.dynCall_diiiii=di.dynCall_diiiii,r.dynCall_iiii=di.dynCall_iiii,r.dynCall_viiiiii=di.dynCall_viiiiii,r.dynCall_iiid=di.dynCall_iiid,r.dynCall_di=di.dynCall_di,r.dynCall_iiiiiii=di.dynCall_iiiiiii,r.dynCall_diiidii=di.dynCall_diiidii,r.dynCall_viidii=di.dynCall_viidii,r.dynCall_viiiiiii=di.dynCall_viiiiiii,r.dynCall_viiiiiiiii=di.dynCall_viiiiiiiii,r.dynCall_viiiiiiiiii=di.dynCall_viiiiiiiiii,r.dynCall_iii=di.dynCall_iii,r.dynCall_diii=di.dynCall_diii,r.dynCall_diiiiiiiiii=di.dynCall_diiiiiiiiii,r.dynCall_viiiid=di.dynCall_viiiid,r.dynCall_diiiiiiiii=di.dynCall_diiiiiiiii,r.dynCall_did=di.dynCall_did,r.dynCall_viiiidddddidi=di.dynCall_viiiidddddidi,r.dynCall_diidii=di.dynCall_diidii,r.dynCall_diiii=di.dynCall_diiii,r.dynCall_iiiiiiiiii=di.dynCall_iiiiiiiiii,r.dynCall_viiid=di.dynCall_viiid,r.dynCall_viii=di.dynCall_viii,r.dynCall_v=di.dynCall_v,r.dynCall_viid=di.dynCall_viid,r.dynCall_iidid=di.dynCall_iidid,r.dynCall_viiii=di.dynCall_viiii,m.stackAlloc=di.stackAlloc,m.stackSave=di.stackSave,m.stackRestore=di.stackRestore,m.establishStackSpace=di.establishStackSpace,m.setTempRet0=di.setTempRet0,m.getTempRet0=di.getTempRet0,um.prototype=new Error,um.prototype.constructor=um;var dm=null;function pm(t){function e(){r.calledRun||(r.calledRun=!0,S||(xt(),wt(),r.onRuntimeInitialized&&r.onRuntimeInitialized(),r._main&&bm&&r.callMain(t),Tt()))}t=t||r.arguments,null===dm&&(dm=Date.now()),zt>0||(St(),zt>0||r.calledRun||(r.setStatus?(r.setStatus("Running..."),setTimeout((function(){setTimeout((function(){r.setStatus("")}),1),e()}),1)):e()))}function fm(t,e){if(!e||!r.noExitRuntime)throw r.noExitRuntime||(S=!0,ot=ui,Ct(),r.onExit&&r.onExit(t)),u?n.exit(t):d&&"function"==typeof quit&&quit(t),new um(t)}Gt=function t(){r.calledRun||pm(),r.calledRun||(Gt=t)},r.callMain=r.callMain=function(t){t=t||[],xt();var e=t.length+1;function i(){for(var t=0;t<3;t++)n.push(0)}var n=[z(Pt(r.thisProgram),"i8",F)];i();for(var s=0;s<e-1;s+=1)n.push(z(Pt(t[s]),"i8",F)),i();n.push(0),n=z(n,"i32",F);try{fm(r._main(e,n,0),!0)}catch(t){if(t instanceof um)return;if("SimulateInfiniteLoop"==t)return void(r.noExitRuntime=!0);throw t&&"object"==typeof t&&t.stack&&r.printErr("exception thrown: "+[t,t.stack]),t}},r.run=r.run=pm,r.exit=r.exit=fm;var mm=[];function gm(t){void 0!==t?(r.print(t),r.printErr(t),t=JSON.stringify(t)):t="",S=!0;var e="abort("+t+") at "+tt()+"\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.";throw mm&&mm.forEach((function(i){e=i(e,t)})),e}if(r.abort=r.abort=gm,r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();var bm=!0;function ym(){}function vm(t){return(t||ym).__cache__}function Sm(t,e){var i=vm(e),n=i[t];return n||((n=Object.create((e||ym).prototype)).ptr=t,i[t]=n)}function xm(t,e){return Sm(t.ptr,e)}function wm(t){if(!t.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";t.__destroy__(),delete vm(t.__class__)[t.ptr]}function Cm(t,e){return t.ptr===e.ptr}function Tm(t){return t.ptr}function Am(t){return t.__class__}function Em(){throw"cannot construct a btCollisionShape, no constructor in IDL"}function Mm(){throw"cannot construct a btCollisionObject, no constructor in IDL"}function Rm(){throw"cannot construct a btConcaveShape, no constructor in IDL"}function Im(){throw"cannot construct a btCollisionWorld, no constructor in IDL"}function Pm(){throw"cannot construct a btTypedConstraint, no constructor in IDL"}function Lm(t,e){t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),this.ptr=ru(t,e),vm(Lm)[this.ptr]=this}function Dm(t,e,i,n,s){return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),void 0===n?(this.ptr=Xn(t,e,i),void(vm(Dm)[this.ptr]=this)):void 0===s?(this.ptr=_emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_4(t,e,i,n),void(vm(Dm)[this.ptr]=this)):(this.ptr=Hn(t,e,i,n,s),void(vm(Dm)[this.ptr]=this))}function km(){throw"cannot construct a btStridingMeshInterface, no constructor in IDL"}function Om(){throw"cannot construct a ConvexResultCallback, no constructor in IDL"}function Fm(){throw"cannot construct a btMotionState, no constructor in IDL"}function Bm(t,e){t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),this.ptr=__(t,e),vm(Bm)[this.ptr]=this}function Nm(){throw"cannot construct a btConvexShape, no constructor in IDL"}function Um(){throw"cannot construct a ContactResultCallback, no constructor in IDL"}function Vm(){throw"cannot construct a btTriangleMeshShape, no constructor in IDL"}function zm(){throw"cannot construct a btDispatcher, no constructor in IDL"}function Wm(){throw"cannot construct a btDynamicsWorld, no constructor in IDL"}function Gm(){throw"cannot construct a RayResultCallback, no constructor in IDL"}function jm(t,e,i){return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),void 0===t?(this.ptr=V_(),void(vm(jm)[this.ptr]=this)):void 0===e?(this.ptr=_emscripten_bind_btVector3_btVector3_1(t),void(vm(jm)[this.ptr]=this)):void 0===i?(this.ptr=_emscripten_bind_btVector3_btVector3_2(t,e),void(vm(jm)[this.ptr]=this)):(this.ptr=U_(t,e,i),void(vm(jm)[this.ptr]=this))}function Hm(){throw"cannot construct a btVehicleRaycaster, no constructor in IDL"}function Xm(){this.ptr=Hr(),vm(Xm)[this.ptr]=this}function Ym(){throw"cannot construct a btQuadWord, no constructor in IDL"}function qm(t){t&&"object"==typeof t&&(t=t.ptr),this.ptr=$h(t),vm(qm)[this.ptr]=this}function Km(){throw"cannot construct a btActionInterface, no constructor in IDL"}function Zm(){throw"cannot construct a btMatrix3x3, no constructor in IDL"}function Qm(){this.ptr=o_(),vm(Qm)[this.ptr]=this}function $m(t,e,i){if(t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),void 0===i)return this.ptr=yd(t,e),void(vm($m)[this.ptr]=this);this.ptr=vd(t,e,i),vm($m)[this.ptr]=this}function Jm(){this.ptr=Ya(),vm(Jm)[this.ptr]=this}function tg(){throw"cannot construct a VoidPtr, no constructor in IDL"}function eg(){this.ptr=Fh(),vm(eg)[this.ptr]=this}function ig(){throw"cannot construct a btDispatcherInfo, no constructor in IDL"}function ng(){throw"cannot construct a btCollisionConfiguration, no constructor in IDL"}function sg(t,e,i,n,s){return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),void 0===i?(this.ptr=so(t,e),void(vm(sg)[this.ptr]=this)):void 0===n?(this.ptr=ro(t,e,i),void(vm(sg)[this.ptr]=this)):void 0===s?(this.ptr=lo(t,e,i,n),void(vm(sg)[this.ptr]=this)):(this.ptr=ho(t,e,i,n,s),void(vm(sg)[this.ptr]=this))}function rg(){this.ptr=kn(),vm(rg)[this.ptr]=this}function og(t,e,i,n){if(t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),void 0===n)return this.ptr=cc(t,e,i),void(vm(og)[this.ptr]=this);this.ptr=uc(t,e,i,n),vm(og)[this.ptr]=this}function ag(){throw"cannot construct a RaycastInfo, no constructor in IDL"}function lg(){throw"cannot construct a btManifoldPoint, no constructor in IDL"}function hg(){throw"cannot construct a btBroadphaseInterface, no constructor in IDL"}function cg(t,e,i,n){t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),this.ptr=vi(t,e,i,n),vm(cg)[this.ptr]=this}function _g(t,e){if(t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),void 0===e)return this.ptr=ss(t),void(vm(_g)[this.ptr]=this);this.ptr=ns(t,e),vm(_g)[this.ptr]=this}function ug(t,e,i,n){return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),void 0===i?(this.ptr=ad(t,e),void(vm(ug)[this.ptr]=this)):void 0===n?(this.ptr=_emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_3(t,e,i),void(vm(ug)[this.ptr]=this)):(this.ptr=od(t,e,i,n),void(vm(ug)[this.ptr]=this))}function dg(t,e,i,n,s){return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),void 0===n?(this.ptr=Rf(t,e,i),void(vm(dg)[this.ptr]=this)):void 0===s?(this.ptr=_emscripten_bind_btSliderConstraint_btSliderConstraint_4(t,e,i,n),void(vm(dg)[this.ptr]=this)):(this.ptr=Mf(t,e,i,n,s),void(vm(dg)[this.ptr]=this))}function pg(t,e,i,n){return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),void 0===i?(this.ptr=Ao(t,e),void(vm(pg)[this.ptr]=this)):void 0===n?(this.ptr=_emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_3(t,e,i),void(vm(pg)[this.ptr]=this)):(this.ptr=Mo(t,e,i,n),void(vm(pg)[this.ptr]=this))}function fg(t){if(t&&"object"==typeof t&&(t=t.ptr),void 0===t)return this.ptr=la(),void(vm(fg)[this.ptr]=this);this.ptr=Tu(t),vm(fg)[this.ptr]=this}function mg(t,e){t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),this.ptr=Kc(t,e),vm(mg)[this.ptr]=this}function gg(t,e){t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),this.ptr=So(t,e),vm(gg)[this.ptr]=this}function bg(t,e){return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),void 0===t?(this.ptr=zp(),void(vm(bg)[this.ptr]=this)):void 0===e?(this.ptr=Wp(t),void(vm(bg)[this.ptr]=this)):(this.ptr=Gp(t,e),void(vm(bg)[this.ptr]=this))}function yg(){this.ptr=Fo(),vm(yg)[this.ptr]=this}function vg(){this.ptr=pu(),vm(vg)[this.ptr]=this}function Sg(t){t&&"object"==typeof t&&(t=t.ptr),this.ptr=Un(t),vm(Sg)[this.ptr]=this}function xg(t){t&&"object"==typeof t&&(t=t.ptr),this.ptr=fn(t),vm(xg)[this.ptr]=this}function wg(){this.ptr=ef(),vm(wg)[this.ptr]=this}function Cg(t){if(t&&"object"==typeof t&&(t=t.ptr),void 0===t)return this.ptr=Il(),void(vm(Cg)[this.ptr]=this);this.ptr=Pl(t),vm(Cg)[this.ptr]=this}function Tg(){throw"cannot construct a btCollisionObjectWrapper, no constructor in IDL"}function Ag(t,e){t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),this.ptr=Xr(t,e),vm(Ag)[this.ptr]=this}function Eg(t,e){return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),void 0===t?(this.ptr=Ho(),void(vm(Eg)[this.ptr]=this)):void 0===e?(this.ptr=Xo(t),void(vm(Eg)[this.ptr]=this)):(this.ptr=jo(t,e),void(vm(Eg)[this.ptr]=this))}function Mg(t,e){t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),this.ptr=mu(t,e),vm(Mg)[this.ptr]=this}function Rg(t,e,i,n,s){return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),void 0===n?(this.ptr=Wr(t,e,i),void(vm(Rg)[this.ptr]=this)):void 0===s?(this.ptr=_emscripten_bind_btGeneric6DofSpring2Constraint_btGeneric6DofSpring2Constraint_4(t,e,i,n),void(vm(Rg)[this.ptr]=this)):(this.ptr=lc(t,e,i,n,s),void(vm(Rg)[this.ptr]=this))}function Ig(t,e){t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),this.ptr=ys(t,e),vm(Ig)[this.ptr]=this}function Pg(t,e,i,n){t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),this.ptr=vh(t,e,i,n),vm(Pg)[this.ptr]=this}function Lg(t,e){t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),this.ptr=Ef(t,e),vm(Lg)[this.ptr]=this}function Dg(t){t&&"object"==typeof t&&(t=t.ptr),this.ptr=kh(t),vm(Dg)[this.ptr]=this}function kg(){throw"cannot construct a btWheelInfo, no constructor in IDL"}function Og(t,e,i,n){return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),void 0===t?(this.ptr=Zf(),void(vm(Og)[this.ptr]=this)):void 0===e?(this.ptr=_emscripten_bind_btVector4_btVector4_1(t),void(vm(Og)[this.ptr]=this)):void 0===i?(this.ptr=_emscripten_bind_btVector4_btVector4_2(t,e),void(vm(Og)[this.ptr]=this)):void 0===n?(this.ptr=_emscripten_bind_btVector4_btVector4_3(t,e,i),void(vm(Og)[this.ptr]=this)):(this.ptr=$f(t,e,i,n),void(vm(Og)[this.ptr]=this))}function Fg(t,e,i,n){if(t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),void 0===n)return this.ptr=da(t,e,i),void(vm(Fg)[this.ptr]=this);this.ptr=Cu(t,e,i,n),vm(Fg)[this.ptr]=this}function Bg(t,e){t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),this.ptr=Dl(t,e),vm(Bg)[this.ptr]=this}function Ng(){throw"cannot construct a btContactSolverInfo, no constructor in IDL"}function Ug(){throw"cannot construct a btOverlappingPairCache, no constructor in IDL"}function Vg(t){t&&"object"==typeof t&&(t=t.ptr),this.ptr=xh(t),vm(Vg)[this.ptr]=this}function zg(){this.ptr=s_(),vm(zg)[this.ptr]=this}function Wg(t,e,i,n,s,r,o){return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),r&&"object"==typeof r&&(r=r.ptr),o&&"object"==typeof o&&(o=o.ptr),void 0===i?(this.ptr=ah(t,e),void(vm(Wg)[this.ptr]=this)):void 0===n?(this.ptr=lh(t,e,i),void(vm(Wg)[this.ptr]=this)):void 0===s?(this.ptr=Jr(t,e,i,n),void(vm(Wg)[this.ptr]=this)):void 0===r?(this.ptr=oh(t,e,i,n,s),void(vm(Wg)[this.ptr]=this)):void 0===o?(this.ptr=nh(t,e,i,n,s,r),void(vm(Wg)[this.ptr]=this)):(this.ptr=sh(t,e,i,n,s,r,o),void(vm(Wg)[this.ptr]=this))}function Gg(){this.ptr=ep(),vm(Gg)[this.ptr]=this}function jg(){throw"cannot construct a btTranslationalLimitMotor2, no constructor in IDL"}function Hg(){throw"cannot construct a LocalShapeInfo, no constructor in IDL"}function Xg(){throw"cannot construct a btConstraintSolver, no constructor in IDL"}function Yg(t,e,i,n,s){return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),void 0===n?(this.ptr=ll(t,e,i),void(vm(Yg)[this.ptr]=this)):void 0===s?(this.ptr=_emscripten_bind_btGeneric6DofSpringConstraint_btGeneric6DofSpringConstraint_4(t,e,i,n),void(vm(Yg)[this.ptr]=this)):(this.ptr=on(t,e,i,n,s),void(vm(Yg)[this.ptr]=this))}function qg(t,e,i,n,s){t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),this.ptr=Sa(t,e,i,n,s),vm(qg)[this.ptr]=this}function Kg(){throw"cannot construct a btOverlappingPairCallback, no constructor in IDL"}function Zg(t){t&&"object"==typeof t&&(t=t.ptr),this.ptr=sp(t),vm(Zg)[this.ptr]=this}function Qg(t){t&&"object"==typeof t&&(t=t.ptr),this.ptr=ph(t),vm(Qg)[this.ptr]=this}function $g(t){t&&"object"==typeof t&&(t=t.ptr),this.ptr=Ml(t),vm($g)[this.ptr]=this}function Jg(t,e){return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),void 0===t?(this.ptr=Ds(),void(vm(Jg)[this.ptr]=this)):void 0===e?(this.ptr=_emscripten_bind_btTransform_btTransform_1(t),void(vm(Jg)[this.ptr]=this)):(this.ptr=Ls(t,e),void(vm(Jg)[this.ptr]=this))}function tb(t,e,i){t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),this.ptr=Zo(t,e,i),vm(tb)[this.ptr]=this}function eb(){this.ptr=lm(),vm(eb)[this.ptr]=this}function ib(){throw"cannot construct a btRotationalLimitMotor2, no constructor in IDL"}return r.noInitialRun&&(bm=!1),r.noExitRuntime=!0,pm(),ym.prototype=Object.create(ym.prototype),ym.prototype.constructor=ym,ym.prototype.__class__=ym,ym.__cache__={},r.WrapperObject=ym,r.getCache=vm,r.wrapPointer=Sm,r.castObject=xm,r.NULL=Sm(0),r.destroy=wm,r.compare=Cm,r.getPointer=Tm,r.getClass=Am,Em.prototype=Object.create(ym.prototype),Em.prototype.constructor=Em,Em.prototype.__class__=Em,Em.__cache__={},r.btCollisionShape=Em,Em.prototype.setLocalScaling=Em.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ca(e,t)},Em.prototype.calculateLocalInertia=Em.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),js(i,t,e)},Em.prototype.__destroy__=Em.prototype.__destroy__=function(){var t=this.ptr;v_(t)},Mm.prototype=Object.create(ym.prototype),Mm.prototype.constructor=Mm,Mm.prototype.__class__=Mm,Mm.__cache__={},r.btCollisionObject=Mm,Mm.prototype.setAnisotropicFriction=Mm.prototype.setAnisotropicFriction=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Fc(i,t,e)},Mm.prototype.getCollisionShape=Mm.prototype.getCollisionShape=function(){var t=this.ptr;return Sm(_c(t),Em)},Mm.prototype.setContactProcessingThreshold=Mm.prototype.setContactProcessingThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),pa(e,t)},Mm.prototype.setActivationState=Mm.prototype.setActivationState=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ns(e,t)},Mm.prototype.forceActivationState=Mm.prototype.forceActivationState=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Rd(e,t)},Mm.prototype.activate=Mm.prototype.activate=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),void 0!==t?ln(e,t):hn(e)},Mm.prototype.isActive=Mm.prototype.isActive=function(){var t=this.ptr;return!!bi(t)},Mm.prototype.isKinematicObject=Mm.prototype.isKinematicObject=function(){var t=this.ptr;return!!$i(t)},Mm.prototype.setRestitution=Mm.prototype.setRestitution=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Zl(e,t)},Mm.prototype.setFriction=Mm.prototype.setFriction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),yc(e,t)},Mm.prototype.setRollingFriction=Mm.prototype.setRollingFriction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ka(e,t)},Mm.prototype.getWorldTransform=Mm.prototype.getWorldTransform=function(){var t=this.ptr;return Sm(Er(t),Jg)},Mm.prototype.getCollisionFlags=Mm.prototype.getCollisionFlags=function(){var t=this.ptr;return sa(t)},Mm.prototype.setCollisionFlags=Mm.prototype.setCollisionFlags=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Hu(e,t)},Mm.prototype.setWorldTransform=Mm.prototype.setWorldTransform=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Nd(e,t)},Mm.prototype.setCollisionShape=Mm.prototype.setCollisionShape=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),y_(e,t)},Mm.prototype.setCcdMotionThreshold=Mm.prototype.setCcdMotionThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),wu(e,t)},Mm.prototype.setCcdSweptSphereRadius=Mm.prototype.setCcdSweptSphereRadius=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),$p(e,t)},Mm.prototype.__destroy__=Mm.prototype.__destroy__=function(){var t=this.ptr;k_(t)},Rm.prototype=Object.create(Em.prototype),Rm.prototype.constructor=Rm,Rm.prototype.__class__=Rm,Rm.__cache__={},r.btConcaveShape=Rm,Rm.prototype.setLocalScaling=Rm.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Po(e,t)},Rm.prototype.calculateLocalInertia=Rm.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),sl(i,t,e)},Rm.prototype.__destroy__=Rm.prototype.__destroy__=function(){var t=this.ptr;Eo(t)},Im.prototype=Object.create(ym.prototype),Im.prototype.constructor=Im,Im.prototype.__class__=Im,Im.__cache__={},r.btCollisionWorld=Im,Im.prototype.getDispatcher=Im.prototype.getDispatcher=function(){var t=this.ptr;return Sm(La(t),zm)},Im.prototype.rayTest=Im.prototype.rayTest=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),Jo(n,t,e,i)},Im.prototype.getPairCache=Im.prototype.getPairCache=function(){var t=this.ptr;return Sm(Jc(t),Ug)},Im.prototype.getDispatchInfo=Im.prototype.getDispatchInfo=function(){var t=this.ptr;return Sm(ea(t),ig)},Im.prototype.addCollisionObject=Im.prototype.addCollisionObject=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),void 0!==e?void 0!==i?Eh(n,t,e,i):Ah(n,t,e):Th(n,t)},Im.prototype.getBroadphase=Im.prototype.getBroadphase=function(){var t=this.ptr;return Sm(Wo(t),hg)},Im.prototype.convexSweepTest=Im.prototype.convexSweepTest=function(t,e,i,n,s){var r=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),Xs(r,t,e,i,n,s)},Im.prototype.contactPairTest=Im.prototype.contactPairTest=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),Kd(n,t,e,i)},Im.prototype.contactTest=Im.prototype.contactTest=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Uh(i,t,e)},Im.prototype.__destroy__=Im.prototype.__destroy__=function(){var t=this.ptr;Bn(t)},Pm.prototype=Object.create(ym.prototype),Pm.prototype.constructor=Pm,Pm.prototype.__class__=Pm,Pm.__cache__={},r.btTypedConstraint=Pm,Pm.prototype.enableFeedback=Pm.prototype.enableFeedback=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ou(e,t)},Pm.prototype.getBreakingImpulseThreshold=Pm.prototype.getBreakingImpulseThreshold=function(){var t=this.ptr;return kc(t)},Pm.prototype.setBreakingImpulseThreshold=Pm.prototype.setBreakingImpulseThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ai(e,t)},Pm.prototype.__destroy__=Pm.prototype.__destroy__=function(){var t=this.ptr;dh(t)},Lm.prototype=Object.create(Em.prototype),Lm.prototype.constructor=Lm,Lm.prototype.__class__=Lm,Lm.__cache__={},r.btCapsuleShape=Lm,Lm.prototype.setMargin=Lm.prototype.setMargin=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Dh(e,t)},Lm.prototype.getMargin=Lm.prototype.getMargin=function(){var t=this.ptr;return Pu(t)},Lm.prototype.setLocalScaling=Lm.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),lu(e,t)},Lm.prototype.calculateLocalInertia=Lm.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),md(i,t,e)},Lm.prototype.__destroy__=Lm.prototype.__destroy__=function(){var t=this.ptr;an(t)},Dm.prototype=Object.create(Pm.prototype),Dm.prototype.constructor=Dm,Dm.prototype.__class__=Dm,Dm.__cache__={},r.btGeneric6DofConstraint=Dm,Dm.prototype.setLinearLowerLimit=Dm.prototype.setLinearLowerLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Up(e,t)},Dm.prototype.setLinearUpperLimit=Dm.prototype.setLinearUpperLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),dl(e,t)},Dm.prototype.setAngularLowerLimit=Dm.prototype.setAngularLowerLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),dp(e,t)},Dm.prototype.setAngularUpperLimit=Dm.prototype.setAngularUpperLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Es(e,t)},Dm.prototype.enableFeedback=Dm.prototype.enableFeedback=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),fi(e,t)},Dm.prototype.getBreakingImpulseThreshold=Dm.prototype.getBreakingImpulseThreshold=function(){var t=this.ptr;return Ld(t)},Dm.prototype.setBreakingImpulseThreshold=Dm.prototype.setBreakingImpulseThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),n_(e,t)},Dm.prototype.__destroy__=Dm.prototype.__destroy__=function(){var t=this.ptr;Rp(t)},km.prototype=Object.create(ym.prototype),km.prototype.constructor=km,km.prototype.__class__=km,km.__cache__={},r.btStridingMeshInterface=km,km.prototype.__destroy__=km.prototype.__destroy__=function(){var t=this.ptr;Fd(t)},Om.prototype=Object.create(ym.prototype),Om.prototype.constructor=Om,Om.prototype.__class__=Om,Om.__cache__={},r.ConvexResultCallback=Om,Om.prototype.hasHit=Om.prototype.hasHit=function(){var t=this.ptr;return!!Gs(t)},Om.prototype.get_m_collisionFilterGroup=Om.prototype.get_m_collisionFilterGroup=function(){var t=this.ptr;return eh(t)},Om.prototype.set_m_collisionFilterGroup=Om.prototype.set_m_collisionFilterGroup=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Vc(e,t)},Om.prototype.get_m_collisionFilterMask=Om.prototype.get_m_collisionFilterMask=function(){var t=this.ptr;return fu(t)},Om.prototype.set_m_collisionFilterMask=Om.prototype.set_m_collisionFilterMask=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),bp(e,t)},Om.prototype.get_m_closestHitFraction=Om.prototype.get_m_closestHitFraction=function(){var t=this.ptr;return S_(t)},Om.prototype.set_m_closestHitFraction=Om.prototype.set_m_closestHitFraction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),uu(e,t)},Om.prototype.__destroy__=Om.prototype.__destroy__=function(){var t=this.ptr;ca(t)},Fm.prototype=Object.create(ym.prototype),Fm.prototype.constructor=Fm,Fm.prototype.__class__=Fm,Fm.__cache__={},r.btMotionState=Fm,Fm.prototype.getWorldTransform=Fm.prototype.getWorldTransform=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),sc(e,t)},Fm.prototype.setWorldTransform=Fm.prototype.setWorldTransform=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Qo(e,t)},Fm.prototype.__destroy__=Fm.prototype.__destroy__=function(){var t=this.ptr;Gu(t)},Bm.prototype=Object.create(Em.prototype),Bm.prototype.constructor=Bm,Bm.prototype.__class__=Bm,Bm.__cache__={},r.btConeShape=Bm,Bm.prototype.setLocalScaling=Bm.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),b_(e,t)},Bm.prototype.calculateLocalInertia=Bm.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),mp(i,t,e)},Bm.prototype.__destroy__=Bm.prototype.__destroy__=function(){var t=this.ptr;Af(t)},Nm.prototype=Object.create(Em.prototype),Nm.prototype.constructor=Nm,Nm.prototype.__class__=Nm,Nm.__cache__={},r.btConvexShape=Nm,Nm.prototype.setLocalScaling=Nm.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),hl(e,t)},Nm.prototype.calculateLocalInertia=Nm.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Bp(i,t,e)},Nm.prototype.__destroy__=Nm.prototype.__destroy__=function(){var t=this.ptr;Xl(t)},Um.prototype=Object.create(ym.prototype),Um.prototype.constructor=Um,Um.prototype.__class__=Um,Um.__cache__={},r.ContactResultCallback=Um,Um.prototype.addSingleResult=Um.prototype.addSingleResult=function(t,e,i,n,s,r,o){var a=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),r&&"object"==typeof r&&(r=r.ptr),o&&"object"==typeof o&&(o=o.ptr),In(a,t,e,i,n,s,r,o)},Um.prototype.__destroy__=Um.prototype.__destroy__=function(){var t=this.ptr;$d(t)},Vm.prototype=Object.create(Rm.prototype),Vm.prototype.constructor=Vm,Vm.prototype.__class__=Vm,Vm.__cache__={},r.btTriangleMeshShape=Vm,Vm.prototype.setLocalScaling=Vm.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),_u(e,t)},Vm.prototype.calculateLocalInertia=Vm.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),cl(i,t,e)},Vm.prototype.__destroy__=Vm.prototype.__destroy__=function(){var t=this.ptr;rp(t)},zm.prototype=Object.create(ym.prototype),zm.prototype.constructor=zm,zm.prototype.__class__=zm,zm.__cache__={},r.btDispatcher=zm,zm.prototype.getNumManifolds=zm.prototype.getNumManifolds=function(){var t=this.ptr;return Gd(t)},zm.prototype.getManifoldByIndexInternal=zm.prototype.getManifoldByIndexInternal=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm($u(e,t),vg)},zm.prototype.__destroy__=zm.prototype.__destroy__=function(){var t=this.ptr;Gl(t)},Wm.prototype=Object.create(Im.prototype),Wm.prototype.constructor=Wm,Wm.prototype.__class__=Wm,Wm.__cache__={},r.btDynamicsWorld=Wm,Wm.prototype.addAction=Wm.prototype.addAction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),af(e,t)},Wm.prototype.removeAction=Wm.prototype.removeAction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ap(e,t)},Wm.prototype.getSolverInfo=Wm.prototype.getSolverInfo=function(){var t=this.ptr;return Sm(rc(t),Ng)},Wm.prototype.getDispatcher=Wm.prototype.getDispatcher=function(){var t=this.ptr;return Sm(za(t),zm)},Wm.prototype.rayTest=Wm.prototype.rayTest=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),Ki(n,t,e,i)},Wm.prototype.getPairCache=Wm.prototype.getPairCache=function(){var t=this.ptr;return Sm(Xf(t),Ug)},Wm.prototype.getDispatchInfo=Wm.prototype.getDispatchInfo=function(){var t=this.ptr;return Sm(Jn(t),ig)},Wm.prototype.addCollisionObject=Wm.prototype.addCollisionObject=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),void 0!==e?void 0!==i?hs(n,t,e,i):qh(n,t,e):Xh(n,t)},Wm.prototype.getBroadphase=Wm.prototype.getBroadphase=function(){var t=this.ptr;return Sm(Tn(t),hg)},Wm.prototype.convexSweepTest=Wm.prototype.convexSweepTest=function(t,e,i,n,s){var r=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),Pf(r,t,e,i,n,s)},Wm.prototype.contactPairTest=Wm.prototype.contactPairTest=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),$c(n,t,e,i)},Wm.prototype.contactTest=Wm.prototype.contactTest=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Vr(i,t,e)},Wm.prototype.__destroy__=Wm.prototype.__destroy__=function(){var t=this.ptr;oo(t)},Gm.prototype=Object.create(ym.prototype),Gm.prototype.constructor=Gm,Gm.prototype.__class__=Gm,Gm.__cache__={},r.RayResultCallback=Gm,Gm.prototype.hasHit=Gm.prototype.hasHit=function(){var t=this.ptr;return!!fl(t)},Gm.prototype.get_m_collisionFilterGroup=Gm.prototype.get_m_collisionFilterGroup=function(){var t=this.ptr;return f_(t)},Gm.prototype.set_m_collisionFilterGroup=Gm.prototype.set_m_collisionFilterGroup=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Oa(e,t)},Gm.prototype.get_m_collisionFilterMask=Gm.prototype.get_m_collisionFilterMask=function(){var t=this.ptr;return Pa(t)},Gm.prototype.set_m_collisionFilterMask=Gm.prototype.set_m_collisionFilterMask=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),os(e,t)},Gm.prototype.get_m_collisionObject=Gm.prototype.get_m_collisionObject=function(){var t=this.ptr;return Sm(Vh(t),Mm)},Gm.prototype.set_m_collisionObject=Gm.prototype.set_m_collisionObject=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),nf(e,t)},Gm.prototype.__destroy__=Gm.prototype.__destroy__=function(){var t=this.ptr;go(t)},jm.prototype=Object.create(ym.prototype),jm.prototype.constructor=jm,jm.prototype.__class__=jm,jm.__cache__={},r.btVector3=jm,jm.prototype.length=jm.prototype.length=function(){var t=this.ptr;return is(t)},jm.prototype.x=jm.prototype.x=function(){var t=this.ptr;return hc(t)},jm.prototype.y=jm.prototype.y=function(){var t=this.ptr;return gd(t)},jm.prototype.z=jm.prototype.z=function(){var t=this.ptr;return G_(t)},jm.prototype.setX=jm.prototype.setX=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),mn(e,t)},jm.prototype.setY=jm.prototype.setY=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ao(e,t)},jm.prototype.setZ=jm.prototype.setZ=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),xn(e,t)},jm.prototype.setValue=jm.prototype.setValue=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),xc(n,t,e,i)},jm.prototype.normalize=jm.prototype.normalize=function(){var t=this.ptr;fo(t)},jm.prototype.dot=jm.prototype.dot=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Zr(e,t)},jm.prototype.op_mul=jm.prototype.op_mul=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(qi(e,t),jm)},jm.prototype.op_add=jm.prototype.op_add=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(du(e,t),jm)},jm.prototype.op_sub=jm.prototype.op_sub=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(ks(e,t),jm)},jm.prototype.__destroy__=jm.prototype.__destroy__=function(){var t=this.ptr;Jh(t)},Hm.prototype=Object.create(ym.prototype),Hm.prototype.constructor=Hm,Hm.prototype.__class__=Hm,Hm.__cache__={},r.btVehicleRaycaster=Hm,Hm.prototype.__destroy__=Hm.prototype.__destroy__=function(){var t=this.ptr;kr(t)},Xm.prototype=Object.create(Mm.prototype),Xm.prototype.constructor=Xm,Xm.prototype.__class__=Xm,Xm.__cache__={},r.btGhostObject=Xm,Xm.prototype.getNumOverlappingObjects=Xm.prototype.getNumOverlappingObjects=function(){var t=this.ptr;return Dc(t)},Xm.prototype.getOverlappingObject=Xm.prototype.getOverlappingObject=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(Sf(e,t),Mm)},Xm.prototype.setAnisotropicFriction=Xm.prototype.setAnisotropicFriction=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),iu(i,t,e)},Xm.prototype.getCollisionShape=Xm.prototype.getCollisionShape=function(){var t=this.ptr;return Sm(Oc(t),Em)},Xm.prototype.setContactProcessingThreshold=Xm.prototype.setContactProcessingThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),zo(e,t)},Xm.prototype.setActivationState=Xm.prototype.setActivationState=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),qd(e,t)},Xm.prototype.forceActivationState=Xm.prototype.forceActivationState=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),r_(e,t)},Xm.prototype.activate=Xm.prototype.activate=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),void 0!==t?Wc(e,t):au(e)},Xm.prototype.isActive=Xm.prototype.isActive=function(){var t=this.ptr;return!!uo(t)},Xm.prototype.isKinematicObject=Xm.prototype.isKinematicObject=function(){var t=this.ptr;return!!rn(t)},Xm.prototype.setRestitution=Xm.prototype.setRestitution=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),gc(e,t)},Xm.prototype.setFriction=Xm.prototype.setFriction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),lr(e,t)},Xm.prototype.setRollingFriction=Xm.prototype.setRollingFriction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),El(e,t)},Xm.prototype.getWorldTransform=Xm.prototype.getWorldTransform=function(){var t=this.ptr;return Sm(Fu(t),Jg)},Xm.prototype.getCollisionFlags=Xm.prototype.getCollisionFlags=function(){var t=this.ptr;return Tc(t)},Xm.prototype.setCollisionFlags=Xm.prototype.setCollisionFlags=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Wa(e,t)},Xm.prototype.setWorldTransform=Xm.prototype.setWorldTransform=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),pr(e,t)},Xm.prototype.setCollisionShape=Xm.prototype.setCollisionShape=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),xd(e,t)},Xm.prototype.setCcdMotionThreshold=Xm.prototype.setCcdMotionThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),fa(e,t)},Xm.prototype.setCcdSweptSphereRadius=Xm.prototype.setCcdSweptSphereRadius=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),rd(e,t)},Xm.prototype.__destroy__=Xm.prototype.__destroy__=function(){var t=this.ptr;Vo(t)},Ym.prototype=Object.create(ym.prototype),Ym.prototype.constructor=Ym,Ym.prototype.__class__=Ym,Ym.__cache__={},r.btQuadWord=Ym,Ym.prototype.x=Ym.prototype.x=function(){var t=this.ptr;return Qi(t)},Ym.prototype.y=Ym.prototype.y=function(){var t=this.ptr;return Rr(t)},Ym.prototype.z=Ym.prototype.z=function(){var t=this.ptr;return Di(t)},Ym.prototype.w=Ym.prototype.w=function(){var t=this.ptr;return Nr(t)},Ym.prototype.setX=Ym.prototype.setX=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),co(e,t)},Ym.prototype.setY=Ym.prototype.setY=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Mn(e,t)},Ym.prototype.setZ=Ym.prototype.setZ=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Au(e,t)},Ym.prototype.setW=Ym.prototype.setW=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),gs(e,t)},Ym.prototype.__destroy__=Ym.prototype.__destroy__=function(){var t=this.ptr;Z_(t)},qm.prototype=Object.create(Em.prototype),qm.prototype.constructor=qm,qm.prototype.__class__=qm,qm.__cache__={},r.btCylinderShape=qm,qm.prototype.setMargin=qm.prototype.setMargin=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Fn(e,t)},qm.prototype.getMargin=qm.prototype.getMargin=function(){var t=this.ptr;return Lu(t)},qm.prototype.setLocalScaling=qm.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),$o(e,t)},qm.prototype.calculateLocalInertia=qm.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),$a(i,t,e)},qm.prototype.__destroy__=qm.prototype.__destroy__=function(){var t=this.ptr;pi(t)},Km.prototype=Object.create(ym.prototype),Km.prototype.constructor=Km,Km.prototype.__class__=Km,Km.__cache__={},r.btActionInterface=Km,Km.prototype.__destroy__=Km.prototype.__destroy__=function(){var t=this.ptr;Bh(t)},Zm.prototype=Object.create(ym.prototype),Zm.prototype.constructor=Zm,Zm.prototype.__class__=Zm,Zm.__cache__={},r.btMatrix3x3=Zm,Zm.prototype.setEulerZYX=Zm.prototype.setEulerZYX=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),Ea(n,t,e,i)},Zm.prototype.getRotation=Zm.prototype.getRotation=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ga(e,t)},Zm.prototype.getRow=Zm.prototype.getRow=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(uh(e,t),jm)},Zm.prototype.__destroy__=Zm.prototype.__destroy__=function(){var t=this.ptr;Ws(t)},Qm.prototype=Object.create(Um.prototype),Qm.prototype.constructor=Qm,Qm.prototype.__class__=Qm,Qm.__cache__={},r.ConcreteContactResultCallback=Qm,Qm.prototype.addSingleResult=Qm.prototype.addSingleResult=function(t,e,i,n,s,r,o){var a=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),r&&"object"==typeof r&&(r=r.ptr),o&&"object"==typeof o&&(o=o.ptr),Y_(a,t,e,i,n,s,r,o)},Qm.prototype.__destroy__=Qm.prototype.__destroy__=function(){var t=this.ptr;P_(t)},$m.prototype=Object.create(Vm.prototype),$m.prototype.constructor=$m,$m.prototype.__class__=$m,$m.__cache__={},r.btBvhTriangleMeshShape=$m,$m.prototype.setLocalScaling=$m.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Qn(e,t)},$m.prototype.calculateLocalInertia=$m.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Gr(i,t,e)},$m.prototype.__destroy__=$m.prototype.__destroy__=function(){var t=this.ptr;Cp(t)},Jm.prototype=Object.create(ym.prototype),Jm.prototype.constructor=Jm,Jm.prototype.__class__=Jm,Jm.__cache__={},r.btDbvtBroadphase=Jm,Jm.prototype.__destroy__=Jm.prototype.__destroy__=function(){var t=this.ptr;su(t)},tg.prototype=Object.create(ym.prototype),tg.prototype.constructor=tg,tg.prototype.__class__=tg,tg.__cache__={},r.VoidPtr=tg,tg.prototype.__destroy__=tg.prototype.__destroy__=function(){var t=this.ptr;a_(t)},eg.prototype=Object.create(ym.prototype),eg.prototype.constructor=eg,eg.prototype.__class__=eg,eg.__cache__={},r.btSequentialImpulseConstraintSolver=eg,eg.prototype.__destroy__=eg.prototype.__destroy__=function(){var t=this.ptr;va(t)},ig.prototype=Object.create(ym.prototype),ig.prototype.constructor=ig,ig.prototype.__class__=ig,ig.__cache__={},r.btDispatcherInfo=ig,ig.prototype.get_m_timeStep=ig.prototype.get_m_timeStep=function(){var t=this.ptr;return Vu(t)},ig.prototype.set_m_timeStep=ig.prototype.set_m_timeStep=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),N_(e,t)},ig.prototype.get_m_stepCount=ig.prototype.get_m_stepCount=function(){var t=this.ptr;return fs(t)},ig.prototype.set_m_stepCount=ig.prototype.set_m_stepCount=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Jd(e,t)},ig.prototype.get_m_dispatchFunc=ig.prototype.get_m_dispatchFunc=function(){var t=this.ptr;return x_(t)},ig.prototype.set_m_dispatchFunc=ig.prototype.set_m_dispatchFunc=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),oc(e,t)},ig.prototype.get_m_timeOfImpact=ig.prototype.get_m_timeOfImpact=function(){var t=this.ptr;return Ri(t)},ig.prototype.set_m_timeOfImpact=ig.prototype.set_m_timeOfImpact=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),un(e,t)},ig.prototype.get_m_useContinuous=ig.prototype.get_m_useContinuous=function(){var t=this.ptr;return!!Fl(t)},ig.prototype.set_m_useContinuous=ig.prototype.set_m_useContinuous=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),gi(e,t)},ig.prototype.get_m_enableSatConvex=ig.prototype.get_m_enableSatConvex=function(){var t=this.ptr;return!!Qf(t)},ig.prototype.set_m_enableSatConvex=ig.prototype.set_m_enableSatConvex=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ra(e,t)},ig.prototype.get_m_enableSPU=ig.prototype.get_m_enableSPU=function(){var t=this.ptr;return!!mi(t)},ig.prototype.set_m_enableSPU=ig.prototype.set_m_enableSPU=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Fs(e,t)},ig.prototype.get_m_useEpa=ig.prototype.get_m_useEpa=function(){var t=this.ptr;return!!Ps(t)},ig.prototype.set_m_useEpa=ig.prototype.set_m_useEpa=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Lr(e,t)},ig.prototype.get_m_allowedCcdPenetration=ig.prototype.get_m_allowedCcdPenetration=function(){var t=this.ptr;return ma(t)},ig.prototype.set_m_allowedCcdPenetration=ig.prototype.set_m_allowedCcdPenetration=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),wd(e,t)},ig.prototype.get_m_useConvexConservativeDistanceUtil=ig.prototype.get_m_useConvexConservativeDistanceUtil=function(){var t=this.ptr;return!!zl(t)},ig.prototype.set_m_useConvexConservativeDistanceUtil=ig.prototype.set_m_useConvexConservativeDistanceUtil=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),xs(e,t)},ig.prototype.get_m_convexConservativeDistanceThreshold=ig.prototype.get_m_convexConservativeDistanceThreshold=function(){var t=this.ptr;return Ma(t)},ig.prototype.set_m_convexConservativeDistanceThreshold=ig.prototype.set_m_convexConservativeDistanceThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ol(e,t)},ig.prototype.__destroy__=ig.prototype.__destroy__=function(){var t=this.ptr;Iu(t)},ng.prototype=Object.create(ym.prototype),ng.prototype.constructor=ng,ng.prototype.__class__=ng,ng.__cache__={},r.btCollisionConfiguration=ng,ng.prototype.__destroy__=ng.prototype.__destroy__=function(){var t=this.ptr;gn(t)},sg.prototype=Object.create(ym.prototype),sg.prototype.constructor=sg,sg.prototype.__class__=sg,sg.__cache__={},r.btAxisSweep3=sg,sg.prototype.__destroy__=sg.prototype.__destroy__=function(){var t=this.ptr;Ci(t)},rg.prototype=Object.create(Xm.prototype),rg.prototype.constructor=rg,rg.prototype.__class__=rg,rg.__cache__={},r.btPairCachingGhostObject=rg,rg.prototype.setAnisotropicFriction=rg.prototype.setAnisotropicFriction=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Nl(i,t,e)},rg.prototype.getCollisionShape=rg.prototype.getCollisionShape=function(){var t=this.ptr;return Sm(Fa(t),Em)},rg.prototype.setContactProcessingThreshold=rg.prototype.setContactProcessingThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),_l(e,t)},rg.prototype.setActivationState=rg.prototype.setActivationState=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),wl(e,t)},rg.prototype.forceActivationState=rg.prototype.forceActivationState=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ds(e,t)},rg.prototype.activate=rg.prototype.activate=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),void 0!==t?_s(e,t):cs(e)},rg.prototype.isActive=rg.prototype.isActive=function(){var t=this.ptr;return!!cm(t)},rg.prototype.isKinematicObject=rg.prototype.isKinematicObject=function(){var t=this.ptr;return!!bu(t)},rg.prototype.setRestitution=rg.prototype.setRestitution=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ha(e,t)},rg.prototype.setFriction=rg.prototype.setFriction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Pr(e,t)},rg.prototype.setRollingFriction=rg.prototype.setRollingFriction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Td(e,t)},rg.prototype.getWorldTransform=rg.prototype.getWorldTransform=function(){var t=this.ptr;return Sm(hr(t),Jg)},rg.prototype.getCollisionFlags=rg.prototype.getCollisionFlags=function(){var t=this.ptr;return cf(t)},rg.prototype.setCollisionFlags=rg.prototype.setCollisionFlags=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Kl(e,t)},rg.prototype.setWorldTransform=rg.prototype.setWorldTransform=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),id(e,t)},rg.prototype.setCollisionShape=rg.prototype.setCollisionShape=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),C_(e,t)},rg.prototype.setCcdMotionThreshold=rg.prototype.setCcdMotionThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),wc(e,t)},rg.prototype.setCcdSweptSphereRadius=rg.prototype.setCcdSweptSphereRadius=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ja(e,t)},rg.prototype.getNumOverlappingObjects=rg.prototype.getNumOverlappingObjects=function(){var t=this.ptr;return eo(t)},rg.prototype.getOverlappingObject=rg.prototype.getOverlappingObject=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(cd(e,t),Mm)},rg.prototype.__destroy__=rg.prototype.__destroy__=function(){var t=this.ptr;ls(t)},og.prototype=Object.create(ym.prototype),og.prototype.constructor=og,og.prototype.__class__=og,og.__cache__={},r.btRigidBodyConstructionInfo=og,og.prototype.get_m_linearDamping=og.prototype.get_m_linearDamping=function(){var t=this.ptr;return zd(t)},og.prototype.set_m_linearDamping=og.prototype.set_m_linearDamping=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),_f(e,t)},og.prototype.get_m_angularDamping=og.prototype.get_m_angularDamping=function(){var t=this.ptr;return Vi(t)},og.prototype.set_m_angularDamping=og.prototype.set_m_angularDamping=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ms(e,t)},og.prototype.get_m_friction=og.prototype.get_m_friction=function(){var t=this.ptr;return bs(t)},og.prototype.set_m_friction=og.prototype.set_m_friction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),z_(e,t)},og.prototype.get_m_rollingFriction=og.prototype.get_m_rollingFriction=function(){var t=this.ptr;return w_(t)},og.prototype.set_m_rollingFriction=og.prototype.set_m_rollingFriction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),pc(e,t)},og.prototype.get_m_restitution=og.prototype.get_m_restitution=function(){var t=this.ptr;return lp(t)},og.prototype.set_m_restitution=og.prototype.set_m_restitution=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Pn(e,t)},og.prototype.get_m_linearSleepingThreshold=og.prototype.get_m_linearSleepingThreshold=function(){var t=this.ptr;return jd(t)},og.prototype.set_m_linearSleepingThreshold=og.prototype.set_m_linearSleepingThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),F_(e,t)},og.prototype.get_m_angularSleepingThreshold=og.prototype.get_m_angularSleepingThreshold=function(){var t=this.ptr;return Eu(t)},og.prototype.set_m_angularSleepingThreshold=og.prototype.set_m_angularSleepingThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Is(e,t)},og.prototype.get_m_additionalDamping=og.prototype.get_m_additionalDamping=function(){var t=this.ptr;return!!qa(t)},og.prototype.set_m_additionalDamping=og.prototype.set_m_additionalDamping=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),uf(e,t)},og.prototype.get_m_additionalDampingFactor=og.prototype.get_m_additionalDampingFactor=function(){var t=this.ptr;return hu(t)},og.prototype.set_m_additionalDampingFactor=og.prototype.set_m_additionalDampingFactor=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ua(e,t)},og.prototype.get_m_additionalLinearDampingThresholdSqr=og.prototype.get_m_additionalLinearDampingThresholdSqr=function(){var t=this.ptr;return _o(t)},og.prototype.set_m_additionalLinearDampingThresholdSqr=og.prototype.set_m_additionalLinearDampingThresholdSqr=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),xa(e,t)},og.prototype.get_m_additionalAngularDampingThresholdSqr=og.prototype.get_m_additionalAngularDampingThresholdSqr=function(){var t=this.ptr;return gl(t)},og.prototype.set_m_additionalAngularDampingThresholdSqr=og.prototype.set_m_additionalAngularDampingThresholdSqr=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),hh(e,t)},og.prototype.get_m_additionalAngularDampingFactor=og.prototype.get_m_additionalAngularDampingFactor=function(){var t=this.ptr;return ga(t)},og.prototype.set_m_additionalAngularDampingFactor=og.prototype.set_m_additionalAngularDampingFactor=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Yr(e,t)},og.prototype.__destroy__=og.prototype.__destroy__=function(){var t=this.ptr;_d(t)},ag.prototype=Object.create(ym.prototype),ag.prototype.constructor=ag,ag.prototype.__class__=ag,ag.__cache__={},r.RaycastInfo=ag,ag.prototype.get_m_contactNormalWS=ag.prototype.get_m_contactNormalWS=function(){var t=this.ptr;return Sm(bo(t),jm)},ag.prototype.set_m_contactNormalWS=ag.prototype.set_m_contactNormalWS=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),l_(e,t)},ag.prototype.get_m_contactPointWS=ag.prototype.get_m_contactPointWS=function(){var t=this.ptr;return Sm(nr(t),jm)},ag.prototype.set_m_contactPointWS=ag.prototype.set_m_contactPointWS=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),c_(e,t)},ag.prototype.get_m_suspensionLength=ag.prototype.get_m_suspensionLength=function(){var t=this.ptr;return Cc(t)},ag.prototype.set_m_suspensionLength=ag.prototype.set_m_suspensionLength=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),br(e,t)},ag.prototype.get_m_hardPointWS=ag.prototype.get_m_hardPointWS=function(){var t=this.ptr;return Sm(q_(t),jm)},ag.prototype.set_m_hardPointWS=ag.prototype.set_m_hardPointWS=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),hf(e,t)},ag.prototype.get_m_wheelDirectionWS=ag.prototype.get_m_wheelDirectionWS=function(){var t=this.ptr;return Sm(J_(t),jm)},ag.prototype.set_m_wheelDirectionWS=ag.prototype.set_m_wheelDirectionWS=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),wi(e,t)},ag.prototype.get_m_wheelAxleWS=ag.prototype.get_m_wheelAxleWS=function(){var t=this.ptr;return Sm(Ui(t),jm)},ag.prototype.set_m_wheelAxleWS=ag.prototype.set_m_wheelAxleWS=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),L_(e,t)},ag.prototype.get_m_isInContact=ag.prototype.get_m_isInContact=function(){var t=this.ptr;return!!Ih(t)},ag.prototype.set_m_isInContact=ag.prototype.set_m_isInContact=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Wn(e,t)},ag.prototype.get_m_groundObject=ag.prototype.get_m_groundObject=function(){var t=this.ptr;return rl(t)},ag.prototype.set_m_groundObject=ag.prototype.set_m_groundObject=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),zc(e,t)},ag.prototype.__destroy__=ag.prototype.__destroy__=function(){var t=this.ptr;tc(t)},lg.prototype=Object.create(ym.prototype),lg.prototype.constructor=lg,lg.prototype.__class__=lg,lg.__cache__={},r.btManifoldPoint=lg,lg.prototype.getPositionWorldOnA=lg.prototype.getPositionWorldOnA=function(){var t=this.ptr;return Sm(Qd(t),jm)},lg.prototype.getPositionWorldOnB=lg.prototype.getPositionWorldOnB=function(){var t=this.ptr;return Sm(jc(t),jm)},lg.prototype.getDistance=lg.prototype.getDistance=function(){var t=this.ptr;return Of(t)},lg.prototype.get_m_localPointA=lg.prototype.get_m_localPointA=function(){var t=this.ptr;return Sm(Vd(t),jm)},lg.prototype.set_m_localPointA=lg.prototype.set_m_localPointA=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),qr(e,t)},lg.prototype.get_m_localPointB=lg.prototype.get_m_localPointB=function(){var t=this.ptr;return Sm(qp(t),jm)},lg.prototype.set_m_localPointB=lg.prototype.set_m_localPointB=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Sn(e,t)},lg.prototype.get_m_positionWorldOnB=lg.prototype.get_m_positionWorldOnB=function(){var t=this.ptr;return Sm(Qa(t),jm)},lg.prototype.set_m_positionWorldOnB=lg.prototype.set_m_positionWorldOnB=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),vn(e,t)},lg.prototype.get_m_positionWorldOnA=lg.prototype.get_m_positionWorldOnA=function(){var t=this.ptr;return Sm(Hc(t),jm)},lg.prototype.set_m_positionWorldOnA=lg.prototype.set_m_positionWorldOnA=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Xp(e,t)},lg.prototype.get_m_normalWorldOnB=lg.prototype.get_m_normalWorldOnB=function(){var t=this.ptr;return Sm(wp(t),jm)},lg.prototype.set_m_normalWorldOnB=lg.prototype.set_m_normalWorldOnB=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),cp(e,t)},lg.prototype.__destroy__=lg.prototype.__destroy__=function(){var t=this.ptr;dc(t)},hg.prototype=Object.create(ym.prototype),hg.prototype.constructor=hg,hg.prototype.__class__=hg,hg.__cache__={},r.btBroadphaseInterface=hg,hg.prototype.__destroy__=hg.prototype.__destroy__=function(){var t=this.ptr;H_(t)},cg.prototype=Object.create(Wm.prototype),cg.prototype.constructor=cg,cg.prototype.__class__=cg,cg.__cache__={},r.btDiscreteDynamicsWorld=cg,cg.prototype.setGravity=cg.prototype.setGravity=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ad(e,t)},cg.prototype.getGravity=cg.prototype.getGravity=function(){var t=this.ptr;return Sm(W_(t),jm)},cg.prototype.addRigidBody=cg.prototype.addRigidBody=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),void 0!==e?void 0!==i?gh(n,t,e,i):_emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_2(n,t,e):bh(n,t)},cg.prototype.removeRigidBody=cg.prototype.removeRigidBody=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),fr(e,t)},cg.prototype.addConstraint=cg.prototype.addConstraint=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),void 0!==e?Ms(i,t,e):Rs(i,t)},cg.prototype.removeConstraint=cg.prototype.removeConstraint=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ep(e,t)},cg.prototype.stepSimulation=cg.prototype.stepSimulation=function(t,e,i){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),void 0===e?Hi(n,t):void 0===i?Yi(n,t,e):Xi(n,t,e,i)},cg.prototype.getDispatcher=cg.prototype.getDispatcher=function(){var t=this.ptr;return Sm(Kh(t),zm)},cg.prototype.rayTest=cg.prototype.rayTest=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),rm(n,t,e,i)},cg.prototype.getPairCache=cg.prototype.getPairCache=function(){var t=this.ptr;return Sm(Bu(t),Ug)},cg.prototype.getDispatchInfo=cg.prototype.getDispatchInfo=function(){var t=this.ptr;return Sm(Lo(t),ig)},cg.prototype.addCollisionObject=cg.prototype.addCollisionObject=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),void 0!==e?void 0!==i?Ku(n,t,e,i):qu(n,t,e):Yu(n,t)},cg.prototype.getBroadphase=cg.prototype.getBroadphase=function(){var t=this.ptr;return Sm(yr(t),hg)},cg.prototype.convexSweepTest=cg.prototype.convexSweepTest=function(t,e,i,n,s){var r=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),Yf(r,t,e,i,n,s)},cg.prototype.contactPairTest=cg.prototype.contactPairTest=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),Kp(n,t,e,i)},cg.prototype.contactTest=cg.prototype.contactTest=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),zr(i,t,e)},cg.prototype.addAction=cg.prototype.addAction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),vr(e,t)},cg.prototype.removeAction=cg.prototype.removeAction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Sh(e,t)},cg.prototype.getSolverInfo=cg.prototype.getSolverInfo=function(){var t=this.ptr;return Sm(On(t),Ng)},cg.prototype.__destroy__=cg.prototype.__destroy__=function(){var t=this.ptr;Hl(t)},_g.prototype=Object.create(Nm.prototype),_g.prototype.constructor=_g,_g.prototype.__class__=_g,_g.__cache__={},r.btConvexTriangleMeshShape=_g,_g.prototype.setLocalScaling=_g.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Tr(e,t)},_g.prototype.calculateLocalInertia=_g.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),ku(i,t,e)},_g.prototype.__destroy__=_g.prototype.__destroy__=function(){var t=this.ptr;Qu(t)},ug.prototype=Object.create(Pm.prototype),ug.prototype.constructor=ug,ug.prototype.__class__=ug,ug.__cache__={},r.btPoint2PointConstraint=ug,ug.prototype.setPivotA=ug.prototype.setPivotA=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),dd(e,t)},ug.prototype.setPivotB=ug.prototype.setPivotB=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),kf(e,t)},ug.prototype.getPivotInA=ug.prototype.getPivotInA=function(){var t=this.ptr;return Sm(zh(t),jm)},ug.prototype.getPivotInB=ug.prototype.getPivotInB=function(){var t=this.ptr;return Sm(Mu(t),jm)},ug.prototype.enableFeedback=ug.prototype.enableFeedback=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),io(e,t)},ug.prototype.getBreakingImpulseThreshold=ug.prototype.getBreakingImpulseThreshold=function(){var t=this.ptr;return Dp(t)},ug.prototype.setBreakingImpulseThreshold=ug.prototype.setBreakingImpulseThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),$n(e,t)},ug.prototype.get_m_setting=ug.prototype.get_m_setting=function(){var t=this.ptr;return Sm(Oh(t),Gg)},ug.prototype.set_m_setting=ug.prototype.set_m_setting=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Rl(e,t)},ug.prototype.__destroy__=ug.prototype.__destroy__=function(){var t=this.ptr;As(t)},dg.prototype=Object.create(Pm.prototype),dg.prototype.constructor=dg,dg.prototype.__class__=dg,dg.__cache__={},r.btSliderConstraint=dg,dg.prototype.setLowerLinLimit=dg.prototype.setLowerLinLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Zp(e,t)},dg.prototype.setUpperLinLimit=dg.prototype.setUpperLinLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),To(e,t)},dg.prototype.setLowerAngLimit=dg.prototype.setLowerAngLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),h_(e,t)},dg.prototype.setUpperAngLimit=dg.prototype.setUpperAngLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Qc(e,t)},dg.prototype.enableFeedback=dg.prototype.enableFeedback=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Nf(e,t)},dg.prototype.getBreakingImpulseThreshold=dg.prototype.getBreakingImpulseThreshold=function(){var t=this.ptr;return _a(t)},dg.prototype.setBreakingImpulseThreshold=dg.prototype.setBreakingImpulseThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),rr(e,t)},dg.prototype.__destroy__=dg.prototype.__destroy__=function(){var t=this.ptr;Lf(t)},pg.prototype=Object.create(Pm.prototype),pg.prototype.constructor=pg,pg.prototype.__class__=pg,pg.__cache__={},r.btConeTwistConstraint=pg,pg.prototype.setLimit=pg.prototype.setLimit=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Dd(i,t,e)},pg.prototype.setAngularOnly=pg.prototype.setAngularOnly=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),bc(e,t)},pg.prototype.setDamping=pg.prototype.setDamping=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Dn(e,t)},pg.prototype.enableMotor=pg.prototype.enableMotor=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),oa(e,t)},pg.prototype.setMaxMotorImpulse=pg.prototype.setMaxMotorImpulse=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ha(e,t)},pg.prototype.setMaxMotorImpulseNormalized=pg.prototype.setMaxMotorImpulseNormalized=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Cr(e,t)},pg.prototype.setMotorTarget=pg.prototype.setMotorTarget=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),t_(e,t)},pg.prototype.setMotorTargetInConstraintSpace=pg.prototype.setMotorTargetInConstraintSpace=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),B_(e,t)},pg.prototype.enableFeedback=pg.prototype.enableFeedback=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),xo(e,t)},pg.prototype.getBreakingImpulseThreshold=pg.prototype.getBreakingImpulseThreshold=function(){var t=this.ptr;return up(t)},pg.prototype.setBreakingImpulseThreshold=pg.prototype.setBreakingImpulseThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Rh(e,t)},pg.prototype.__destroy__=pg.prototype.__destroy__=function(){var t=this.ptr;K_(t)},fg.prototype=Object.create(ym.prototype),fg.prototype.constructor=fg,fg.prototype.__class__=fg,fg.__cache__={},r.btDefaultCollisionConfiguration=fg,fg.prototype.__destroy__=fg.prototype.__destroy__=function(){var t=this.ptr;vc(t)},mg.prototype=Object.create(Bm.prototype),mg.prototype.constructor=mg,mg.prototype.__class__=mg,mg.__cache__={},r.btConeShapeZ=mg,mg.prototype.setLocalScaling=mg.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),xl(e,t)},mg.prototype.calculateLocalInertia=mg.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),tr(i,t,e)},mg.prototype.__destroy__=mg.prototype.__destroy__=function(){var t=this.ptr;Hf(t)},gg.prototype=Object.create(Bm.prototype),gg.prototype.constructor=gg,gg.prototype.__class__=gg,gg.__cache__={},r.btConeShapeX=gg,gg.prototype.setLocalScaling=gg.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Do(e,t)},gg.prototype.calculateLocalInertia=gg.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),hd(i,t,e)},gg.prototype.__destroy__=gg.prototype.__destroy__=function(){var t=this.ptr;na(t)},bg.prototype=Object.create(km.prototype),bg.prototype.constructor=bg,bg.prototype.__class__=bg,bg.__cache__={},r.btTriangleMesh=bg,bg.prototype.addTriangle=bg.prototype.addTriangle=function(t,e,i,n){var s=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),void 0!==n?xf(s,t,e,i,n):vf(s,t,e,i)},bg.prototype.__destroy__=bg.prototype.__destroy__=function(){var t=this.ptr;E_(t)},yg.prototype=Object.create(Em.prototype),yg.prototype.constructor=yg,yg.prototype.__class__=yg,yg.__cache__={},r.btConvexHullShape=yg,yg.prototype.addPoint=yg.prototype.addPoint=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),void 0!==e?Lp(i,t,e):Pp(i,t)},yg.prototype.setMargin=yg.prototype.setMargin=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),$s(e,t)},yg.prototype.getMargin=yg.prototype.getMargin=function(){var t=this.ptr;return Gi(t)},yg.prototype.setLocalScaling=yg.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ra(e,t)},yg.prototype.calculateLocalInertia=yg.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),ir(i,t,e)},yg.prototype.__destroy__=yg.prototype.__destroy__=function(){var t=this.ptr;gr(t)},vg.prototype=Object.create(ym.prototype),vg.prototype.constructor=vg,vg.prototype.__class__=vg,vg.__cache__={},r.btPersistentManifold=vg,vg.prototype.getBody0=vg.prototype.getBody0=function(){var t=this.ptr;return Sm(vo(t),Mm)},vg.prototype.getBody1=vg.prototype.getBody1=function(){var t=this.ptr;return Sm(Vn(t),Mm)},vg.prototype.getNumContacts=vg.prototype.getNumContacts=function(){var t=this.ptr;return Ur(t)},vg.prototype.getContactPoint=vg.prototype.getContactPoint=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(Nc(e,t),lg)},vg.prototype.__destroy__=vg.prototype.__destroy__=function(){var t=this.ptr;Us(t)},Sg.prototype=Object.create(Em.prototype),Sg.prototype.constructor=Sg,Sg.prototype.__class__=Sg,Sg.__cache__={},r.btBoxShape=Sg,Sg.prototype.setMargin=Sg.prototype.setMargin=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ch(e,t)},Sg.prototype.getMargin=Sg.prototype.getMargin=function(){var t=this.ptr;return as(t)},Sg.prototype.setLocalScaling=Sg.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),jf(e,t)},Sg.prototype.calculateLocalInertia=Sg.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Wu(i,t,e)},Sg.prototype.__destroy__=Sg.prototype.__destroy__=function(){var t=this.ptr;Bc(t)},xg.prototype=Object.create(zm.prototype),xg.prototype.constructor=xg,xg.prototype.__class__=xg,xg.__cache__={},r.btCollisionDispatcher=xg,xg.prototype.getNumManifolds=xg.prototype.getNumManifolds=function(){var t=this.ptr;return Dr(t)},xg.prototype.getManifoldByIndexInternal=xg.prototype.getManifoldByIndexInternal=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(or(e,t),vg)},xg.prototype.__destroy__=xg.prototype.__destroy__=function(){var t=this.ptr;zi(t)},wg.prototype=Object.create(ym.prototype),wg.prototype.constructor=wg,wg.prototype.__class__=wg,wg.__cache__={},r.btVehicleTuning=wg,wg.prototype.get_m_suspensionStiffness=wg.prototype.get_m_suspensionStiffness=function(){var t=this.ptr;return hp(t)},wg.prototype.set_m_suspensionStiffness=wg.prototype.set_m_suspensionStiffness=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ed(e,t)},wg.prototype.get_m_suspensionCompression=wg.prototype.get_m_suspensionCompression=function(){var t=this.ptr;return jl(t)},wg.prototype.set_m_suspensionCompression=wg.prototype.set_m_suspensionCompression=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),zu(e,t)},wg.prototype.get_m_suspensionDamping=wg.prototype.get_m_suspensionDamping=function(){var t=this.ptr;return X_(t)},wg.prototype.set_m_suspensionDamping=wg.prototype.set_m_suspensionDamping=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),O_(e,t)},wg.prototype.get_m_maxSuspensionTravelCm=wg.prototype.get_m_maxSuspensionTravelCm=function(){var t=this.ptr;return Ip(t)},wg.prototype.set_m_maxSuspensionTravelCm=wg.prototype.set_m_maxSuspensionTravelCm=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Al(e,t)},wg.prototype.get_m_frictionSlip=wg.prototype.get_m_frictionSlip=function(){var t=this.ptr;return _m(t)},wg.prototype.set_m_frictionSlip=wg.prototype.set_m_frictionSlip=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),yi(e,t)},wg.prototype.get_m_maxSuspensionForce=wg.prototype.get_m_maxSuspensionForce=function(){var t=this.ptr;return bd(t)},wg.prototype.set_m_maxSuspensionForce=wg.prototype.set_m_maxSuspensionForce=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),xu(e,t)},Cg.prototype=Object.create(Em.prototype),Cg.prototype.constructor=Cg,Cg.prototype.__class__=Cg,Cg.__cache__={},r.btCompoundShape=Cg,Cg.prototype.addChildShape=Cg.prototype.addChildShape=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Wl(i,t,e)},Cg.prototype.removeChildShapeByIndex=Cg.prototype.removeChildShapeByIndex=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ts(e,t)},Cg.prototype.getNumChildShapes=Cg.prototype.getNumChildShapes=function(){var t=this.ptr;return jr(t)},Cg.prototype.getChildShape=Cg.prototype.getChildShape=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(Yo(e,t),Em)},Cg.prototype.setMargin=Cg.prototype.setMargin=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),jh(e,t)},Cg.prototype.getMargin=Cg.prototype.getMargin=function(){var t=this.ptr;return xi(t)},Cg.prototype.setLocalScaling=Cg.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ka(e,t)},Cg.prototype.calculateLocalInertia=Cg.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),ta(i,t,e)},Cg.prototype.__destroy__=Cg.prototype.__destroy__=function(){var t=this.ptr;ul(t)},Tg.prototype=Object.create(ym.prototype),Tg.prototype.constructor=Tg,Tg.prototype.__class__=Tg,Tg.__cache__={},r.btCollisionObjectWrapper=Tg,Ag.prototype=Object.create(Om.prototype),Ag.prototype.constructor=Ag,Ag.prototype.__class__=Ag,Ag.__cache__={},r.ClosestConvexResultCallback=Ag,Ag.prototype.hasHit=Ag.prototype.hasHit=function(){var t=this.ptr;return!!mf(t)},Ag.prototype.get_m_convexFromWorld=Ag.prototype.get_m_convexFromWorld=function(){var t=this.ptr;return Sm(Fr(t),jm)},Ag.prototype.set_m_convexFromWorld=Ag.prototype.set_m_convexFromWorld=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e_(e,t)},Ag.prototype.get_m_convexToWorld=Ag.prototype.get_m_convexToWorld=function(){var t=this.ptr;return Sm(vl(t),jm)},Ag.prototype.set_m_convexToWorld=Ag.prototype.set_m_convexToWorld=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),pd(e,t)},Ag.prototype.get_m_hitNormalWorld=Ag.prototype.get_m_hitNormalWorld=function(){var t=this.ptr;return Sm(_h(t),jm)},Ag.prototype.set_m_hitNormalWorld=Ag.prototype.set_m_hitNormalWorld=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),nn(e,t)},Ag.prototype.get_m_hitPointWorld=Ag.prototype.get_m_hitPointWorld=function(){var t=this.ptr;return Sm(j_(t),jm)},Ag.prototype.set_m_hitPointWorld=Ag.prototype.set_m_hitPointWorld=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),rs(e,t)},Ag.prototype.get_m_collisionFilterGroup=Ag.prototype.get_m_collisionFilterGroup=function(){var t=this.ptr;return Lh(t)},Ag.prototype.set_m_collisionFilterGroup=Ag.prototype.set_m_collisionFilterGroup=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Mh(e,t)},Ag.prototype.get_m_collisionFilterMask=Ag.prototype.get_m_collisionFilterMask=function(){var t=this.ptr;return Yh(t)},Ag.prototype.set_m_collisionFilterMask=Ag.prototype.set_m_collisionFilterMask=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),kd(e,t)},Ag.prototype.get_m_closestHitFraction=Ag.prototype.get_m_closestHitFraction=function(){var t=this.ptr;return Co(t)},Ag.prototype.set_m_closestHitFraction=Ag.prototype.set_m_closestHitFraction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ap(e,t)},Ag.prototype.__destroy__=Ag.prototype.__destroy__=function(){var t=this.ptr;Hh(t)},Eg.prototype=Object.create(Fm.prototype),Eg.prototype.constructor=Eg,Eg.prototype.__class__=Eg,Eg.__cache__={},r.btDefaultMotionState=Eg,Eg.prototype.getWorldTransform=Eg.prototype.getWorldTransform=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ji(e,t)},Eg.prototype.setWorldTransform=Eg.prototype.setWorldTransform=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Nh(e,t)},Eg.prototype.get_m_graphicsWorldTrans=Eg.prototype.get_m_graphicsWorldTrans=function(){var t=this.ptr;return Sm(Ln(t),Jg)},Eg.prototype.set_m_graphicsWorldTrans=Eg.prototype.set_m_graphicsWorldTrans=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),mc(e,t)},Eg.prototype.__destroy__=Eg.prototype.__destroy__=function(){var t=this.ptr;ps(t)},Mg.prototype=Object.create(Gm.prototype),Mg.prototype.constructor=Mg,Mg.prototype.__class__=Mg,Mg.__cache__={},r.ClosestRayResultCallback=Mg,Mg.prototype.hasHit=Mg.prototype.hasHit=function(){var t=this.ptr;return!!Vl(t)},Mg.prototype.get_m_rayFromWorld=Mg.prototype.get_m_rayFromWorld=function(){var t=this.ptr;return Sm(u_(t),jm)},Mg.prototype.set_m_rayFromWorld=Mg.prototype.set_m_rayFromWorld=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Q_(e,t)},Mg.prototype.get_m_rayToWorld=Mg.prototype.get_m_rayToWorld=function(){var t=this.ptr;return Sm(Tp(t),jm)},Mg.prototype.set_m_rayToWorld=Mg.prototype.set_m_rayToWorld=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),sf(e,t)},Mg.prototype.get_m_hitNormalWorld=Mg.prototype.get_m_hitNormalWorld=function(){var t=this.ptr;return Sm(Vp(t),jm)},Mg.prototype.set_m_hitNormalWorld=Mg.prototype.set_m_hitNormalWorld=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Vf(e,t)},Mg.prototype.get_m_hitPointWorld=Mg.prototype.get_m_hitPointWorld=function(){var t=this.ptr;return Sm(Ti(t),jm)},Mg.prototype.set_m_hitPointWorld=Mg.prototype.set_m_hitPointWorld=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ys(e,t)},Mg.prototype.get_m_collisionFilterGroup=Mg.prototype.get_m_collisionFilterGroup=function(){var t=this.ptr;return rf(t)},Mg.prototype.set_m_collisionFilterGroup=Mg.prototype.set_m_collisionFilterGroup=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),no(e,t)},Mg.prototype.get_m_collisionFilterMask=Mg.prototype.get_m_collisionFilterMask=function(){var t=this.ptr;return pl(t)},Mg.prototype.set_m_collisionFilterMask=Mg.prototype.set_m_collisionFilterMask=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),yu(e,t)},Mg.prototype.get_m_collisionObject=Mg.prototype.get_m_collisionObject=function(){var t=this.ptr;return Sm(yf(t),Mm)},Mg.prototype.set_m_collisionObject=Mg.prototype.set_m_collisionObject=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),zn(e,t)},Mg.prototype.__destroy__=Mg.prototype.__destroy__=function(){var t=this.ptr;Or(t)},Rg.prototype=Object.create(Pm.prototype),Rg.prototype.constructor=Rg,Rg.prototype.__class__=Rg,Rg.__cache__={},r.btGeneric6DofSpring2Constraint=Rg,Rg.prototype.setLinearLowerLimit=Rg.prototype.setLinearLowerLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),df(e,t)},Rg.prototype.setLinearUpperLimit=Rg.prototype.setLinearUpperLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ph(e,t)},Rg.prototype.setAngularLowerLimit=Rg.prototype.setAngularLowerLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),D_(e,t)},Rg.prototype.setAngularUpperLimit=Rg.prototype.setAngularUpperLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),dn(e,t)},Rg.prototype.enableSpring=Rg.prototype.enableSpring=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),es(i,t,e)},Rg.prototype.setStiffness=Rg.prototype.setStiffness=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),ya(i,t,e)},Rg.prototype.setDamping=Rg.prototype.setDamping=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),qc(i,t,e)},Rg.prototype.getTranslationalLimitMotor=Rg.prototype.getTranslationalLimitMotor=function(){var t=this.ptr;return Sm(Xu(t),jg)},Rg.prototype.getRotationalLimitMotor=Rg.prototype.getRotationalLimitMotor=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(cn(e,t),ib)},Rg.prototype.enableFeedback=Rg.prototype.enableFeedback=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Wd(e,t)},Rg.prototype.getBreakingImpulseThreshold=Rg.prototype.getBreakingImpulseThreshold=function(){var t=this.ptr;return Bi(t)},Rg.prototype.setBreakingImpulseThreshold=Rg.prototype.setBreakingImpulseThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ko(e,t)},Rg.prototype.__destroy__=Rg.prototype.__destroy__=function(){var t=this.ptr;ju(t)},Ig.prototype=Object.create(Lm.prototype),Ig.prototype.constructor=Ig,Ig.prototype.__class__=Ig,Ig.__cache__={},r.btCapsuleShapeX=Ig,Ig.prototype.setMargin=Ig.prototype.setMargin=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ba(e,t)},Ig.prototype.getMargin=Ig.prototype.getMargin=function(){var t=this.ptr;return Si(t)},Ig.prototype.setLocalScaling=Ig.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ql(e,t)},Ig.prototype.calculateLocalInertia=Ig.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),qs(i,t,e)},Ig.prototype.__destroy__=Ig.prototype.__destroy__=function(){var t=this.ptr;Ac(t)},Pg.prototype=Object.create(Ym.prototype),Pg.prototype.constructor=Pg,Pg.prototype.__class__=Pg,Pg.__cache__={},r.btQuaternion=Pg,Pg.prototype.setValue=Pg.prototype.setValue=function(t,e,i,n){var s=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),Cn(s,t,e,i,n)},Pg.prototype.normalize=Pg.prototype.normalize=function(){var t=this.ptr;yl(t)},Pg.prototype.x=Pg.prototype.x=function(){var t=this.ptr;return Ro(t)},Pg.prototype.y=Pg.prototype.y=function(){var t=this.ptr;return Ch(t)},Pg.prototype.z=Pg.prototype.z=function(){var t=this.ptr;return Oo(t)},Pg.prototype.w=Pg.prototype.w=function(){var t=this.ptr;return th(t)},Pg.prototype.setX=Pg.prototype.setX=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ei(e,t)},Pg.prototype.setY=Pg.prototype.setY=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),fp(e,t)},Pg.prototype.setZ=Pg.prototype.setZ=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ii(e,t)},Pg.prototype.setW=Pg.prototype.setW=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ni(e,t)},Pg.prototype.__destroy__=Pg.prototype.__destroy__=function(){var t=this.ptr;Ou(t)},Lg.prototype=Object.create(Lm.prototype),Lg.prototype.constructor=Lg,Lg.prototype.__class__=Lg,Lg.__cache__={},r.btCapsuleShapeZ=Lg,Lg.prototype.setMargin=Lg.prototype.setMargin=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),bn(e,t)},Lg.prototype.getMargin=Lg.prototype.getMargin=function(){var t=this.ptr;return rh(t)},Lg.prototype.setLocalScaling=Lg.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),wo(e,t)},Lg.prototype.calculateLocalInertia=Lg.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Uu(i,t,e)},Lg.prototype.__destroy__=Lg.prototype.__destroy__=function(){var t=this.ptr;gf(t)},Dg.prototype=Object.create(Hm.prototype),Dg.prototype.constructor=Dg,Dg.prototype.__class__=Dg,Dg.__cache__={},r.btDefaultVehicleRaycaster=Dg,Dg.prototype.__destroy__=Dg.prototype.__destroy__=function(){var t=this.ptr;Ic(t)},kg.prototype=Object.create(ym.prototype),kg.prototype.constructor=kg,kg.prototype.__class__=kg,kg.__cache__={},r.btWheelInfo=kg,kg.prototype.get_m_suspensionStiffness=kg.prototype.get_m_suspensionStiffness=function(){var t=this.ptr;return Fi(t)},kg.prototype.set_m_suspensionStiffness=kg.prototype.set_m_suspensionStiffness=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Zu(e,t)},kg.prototype.get_m_frictionSlip=kg.prototype.get_m_frictionSlip=function(){var t=this.ptr;return Sl(t)},kg.prototype.set_m_frictionSlip=kg.prototype.set_m_frictionSlip=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),jp(e,t)},kg.prototype.get_m_engineForce=kg.prototype.get_m_engineForce=function(){var t=this.ptr;return ws(t)},kg.prototype.set_m_engineForce=kg.prototype.set_m_engineForce=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ja(e,t)},kg.prototype.get_m_rollInfluence=kg.prototype.get_m_rollInfluence=function(){var t=this.ptr;return Kn(t)},kg.prototype.set_m_rollInfluence=kg.prototype.set_m_rollInfluence=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),i_(e,t)},kg.prototype.get_m_suspensionRestLength1=kg.prototype.get_m_suspensionRestLength1=function(){var t=this.ptr;return Oi(t)},kg.prototype.set_m_suspensionRestLength1=kg.prototype.set_m_suspensionRestLength1=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Tf(e,t)},kg.prototype.get_m_wheelsRadius=kg.prototype.get_m_wheelsRadius=function(){var t=this.ptr;return Jp(t)},kg.prototype.set_m_wheelsRadius=kg.prototype.set_m_wheelsRadius=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Os(e,t)},kg.prototype.get_m_wheelsDampingCompression=kg.prototype.get_m_wheelsDampingCompression=function(){var t=this.ptr;return ff(t)},kg.prototype.set_m_wheelsDampingCompression=kg.prototype.set_m_wheelsDampingCompression=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Bs(e,t)},kg.prototype.get_m_wheelsDampingRelaxation=kg.prototype.get_m_wheelsDampingRelaxation=function(){var t=this.ptr;return Yp(t)},kg.prototype.set_m_wheelsDampingRelaxation=kg.prototype.set_m_wheelsDampingRelaxation=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),of(e,t)},kg.prototype.get_m_steering=kg.prototype.get_m_steering=function(){var t=this.ptr;return m_(t)},kg.prototype.set_m_steering=kg.prototype.set_m_steering=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ed(e,t)},kg.prototype.get_m_maxSuspensionForce=kg.prototype.get_m_maxSuspensionForce=function(){var t=this.ptr;return bf(t)},kg.prototype.set_m_maxSuspensionForce=kg.prototype.set_m_maxSuspensionForce=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Bo(e,t)},kg.prototype.get_m_maxSuspensionTravelCm=kg.prototype.get_m_maxSuspensionTravelCm=function(){var t=this.ptr;return Zh(t)},kg.prototype.set_m_maxSuspensionTravelCm=kg.prototype.set_m_maxSuspensionTravelCm=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Pc(e,t)},kg.prototype.get_m_wheelsSuspensionForce=kg.prototype.get_m_wheelsSuspensionForce=function(){var t=this.ptr;return wh(t)},kg.prototype.set_m_wheelsSuspensionForce=kg.prototype.set_m_wheelsSuspensionForce=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Lc(e,t)},kg.prototype.get_m_bIsFrontWheel=kg.prototype.get_m_bIsFrontWheel=function(){var t=this.ptr;return!!En(t)},kg.prototype.set_m_bIsFrontWheel=kg.prototype.set_m_bIsFrontWheel=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Zs(e,t)},kg.prototype.get_m_raycastInfo=kg.prototype.get_m_raycastInfo=function(){var t=this.ptr;return Sm(om(t),ag)},kg.prototype.set_m_raycastInfo=kg.prototype.set_m_raycastInfo=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),wr(e,t)},kg.prototype.get_m_chassisConnectionPointCS=kg.prototype.get_m_chassisConnectionPointCS=function(){var t=this.ptr;return Sm(eu(t),jm)},kg.prototype.set_m_chassisConnectionPointCS=kg.prototype.set_m_chassisConnectionPointCS=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ji(e,t)},kg.prototype.__destroy__=kg.prototype.__destroy__=function(){var t=this.ptr;$r(t)},Og.prototype=Object.create(jm.prototype),Og.prototype.constructor=Og,Og.prototype.__class__=Og,Og.__cache__={},r.btVector4=Og,Og.prototype.w=Og.prototype.w=function(){var t=this.ptr;return xp(t)},Og.prototype.setValue=Og.prototype.setValue=function(t,e,i,n){var s=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),Zn(s,t,e,i,n)},Og.prototype.length=Og.prototype.length=function(){var t=this.ptr;return fc(t)},Og.prototype.x=Og.prototype.x=function(){var t=this.ptr;return tp(t)},Og.prototype.y=Og.prototype.y=function(){var t=this.ptr;return Mp(t)},Og.prototype.z=Og.prototype.z=function(){var t=this.ptr;return Md(t)},Og.prototype.setX=Og.prototype.setX=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Sr(e,t)},Og.prototype.setY=Og.prototype.setY=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Gh(e,t)},Og.prototype.setZ=Og.prototype.setZ=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Mr(e,t)},Og.prototype.normalize=Og.prototype.normalize=function(){var t=this.ptr;pp(t)},Og.prototype.dot=Og.prototype.dot=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Da(e,t)},Og.prototype.op_mul=Og.prototype.op_mul=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(Qh(e,t),jm)},Og.prototype.op_add=Og.prototype.op_add=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(Qr(e,t),jm)},Og.prototype.op_sub=Og.prototype.op_sub=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(lf(e,t),jm)},Og.prototype.__destroy__=Og.prototype.__destroy__=function(){var t=this.ptr;gu(t)},Fg.prototype=Object.create(Km.prototype),Fg.prototype.constructor=Fg,Fg.prototype.__class__=Fg,Fg.__cache__={},r.btKinematicCharacterController=Fg,Fg.prototype.setUpAxis=Fg.prototype.setUpAxis=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),_n(e,t)},Fg.prototype.setWalkDirection=Fg.prototype.setWalkDirection=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),op(e,t)},Fg.prototype.setVelocityForTimeInterval=Fg.prototype.setVelocityForTimeInterval=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),qf(i,t,e)},Fg.prototype.warp=Fg.prototype.warp=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),T_(e,t)},Fg.prototype.preStep=Fg.prototype.preStep=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),M_(e,t)},Fg.prototype.playerStep=Fg.prototype.playerStep=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Ru(i,t,e)},Fg.prototype.setFallSpeed=Fg.prototype.setFallSpeed=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ec(e,t)},Fg.prototype.setJumpSpeed=Fg.prototype.setJumpSpeed=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ld(e,t)},Fg.prototype.setMaxJumpHeight=Fg.prototype.setMaxJumpHeight=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),hm(e,t)},Fg.prototype.canJump=Fg.prototype.canJump=function(){var t=this.ptr;return!!qo(t)},Fg.prototype.jump=Fg.prototype.jump=function(){var t=this.ptr;xr(t)},Fg.prototype.setGravity=Fg.prototype.setGravity=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Gn(e,t)},Fg.prototype.getGravity=Fg.prototype.getGravity=function(){var t=this.ptr;return _p(t)},Fg.prototype.setMaxSlope=Fg.prototype.setMaxSlope=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Li(e,t)},Fg.prototype.getMaxSlope=Fg.prototype.getMaxSlope=function(){var t=this.ptr;return Bf(t)},Fg.prototype.getGhostObject=Fg.prototype.getGhostObject=function(){var t=this.ptr;return Sm(np(t),rg)},Fg.prototype.setUseGhostSweepTest=Fg.prototype.setUseGhostSweepTest=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),wn(e,t)},Fg.prototype.onGround=Fg.prototype.onGround=function(){var t=this.ptr;return!!Id(t)},Fg.prototype.__destroy__=Fg.prototype.__destroy__=function(){var t=this.ptr;Jf(t)},Bg.prototype=Object.create(Rm.prototype),Bg.prototype.constructor=Bg,Bg.prototype.__class__=Bg,Bg.__cache__={},r.btStaticPlaneShape=Bg,Bg.prototype.setLocalScaling=Bg.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Du(e,t)},Bg.prototype.calculateLocalInertia=Bg.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Su(i,t,e)},Bg.prototype.__destroy__=Bg.prototype.__destroy__=function(){var t=this.ptr;Wf(t)},Ng.prototype=Object.create(ym.prototype),Ng.prototype.constructor=Ng,Ng.prototype.__class__=Ng,Ng.__cache__={},r.btContactSolverInfo=Ng,Ng.prototype.get_m_splitImpulse=Ng.prototype.get_m_splitImpulse=function(){var t=this.ptr;return!!am(t)},Ng.prototype.set_m_splitImpulse=Ng.prototype.set_m_splitImpulse=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Go(e,t)},Ng.prototype.get_m_splitImpulsePenetrationThreshold=Ng.prototype.get_m_splitImpulsePenetrationThreshold=function(){var t=this.ptr;return us(t)},Ng.prototype.set_m_splitImpulsePenetrationThreshold=Ng.prototype.set_m_splitImpulsePenetrationThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Zc(e,t)},Ng.prototype.__destroy__=Ng.prototype.__destroy__=function(){var t=this.ptr;A_(t)},Ug.prototype=Object.create(ym.prototype),Ug.prototype.constructor=Ug,Ug.prototype.__class__=Ug,Ug.__cache__={},r.btOverlappingPairCache=Ug,Ug.prototype.setInternalGhostPairCallback=Ug.prototype.setInternalGhostPairCallback=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ll(e,t)},Ug.prototype.__destroy__=Ug.prototype.__destroy__=function(){var t=this.ptr;po(t)},Vg.prototype=Object.create(Em.prototype),Vg.prototype.constructor=Vg,Vg.prototype.__class__=Vg,Vg.__cache__={},r.btSphereShape=Vg,Vg.prototype.setMargin=Vg.prototype.setMargin=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Yc(e,t)},Vg.prototype.getMargin=Vg.prototype.getMargin=function(){var t=this.ptr;return ac(t)},Vg.prototype.setLocalScaling=Vg.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Sp(e,t)},Vg.prototype.calculateLocalInertia=Vg.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),sr(i,t,e)},Vg.prototype.__destroy__=Vg.prototype.__destroy__=function(){var t=this.ptr;tn(t)},zg.prototype=Object.create(ym.prototype),zg.prototype.constructor=zg,zg.prototype.__class__=zg,zg.__cache__={},r.btDefaultCollisionConstructionInfo=zg,zg.prototype.__destroy__=zg.prototype.__destroy__=function(){var t=this.ptr;sd(t)},Wg.prototype=Object.create(Pm.prototype),Wg.prototype.constructor=Wg,Wg.prototype.__class__=Wg,Wg.__cache__={},r.btHingeConstraint=Wg,Wg.prototype.setLimit=Wg.prototype.setLimit=function(t,e,i,n,s){var r=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),void 0!==s?Rc(r,t,e,i,n,s):Mc(r,t,e,i,n)},Wg.prototype.enableAngularMotor=Wg.prototype.enableAngularMotor=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),tl(n,t,e,i)},Wg.prototype.enableFeedback=Wg.prototype.enableFeedback=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),yn(e,t)},Wg.prototype.getBreakingImpulseThreshold=Wg.prototype.getBreakingImpulseThreshold=function(){var t=this.ptr;return nd(t)},Wg.prototype.setBreakingImpulseThreshold=Wg.prototype.setBreakingImpulseThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Jl(e,t)},Wg.prototype.__destroy__=Wg.prototype.__destroy__=function(){var t=this.ptr;Fp(t)},Gg.prototype=Object.create(ym.prototype),Gg.prototype.constructor=Gg,Gg.prototype.__class__=Gg,Gg.__cache__={},r.btConstraintSetting=Gg,Gg.prototype.get_m_tau=Gg.prototype.get_m_tau=function(){var t=this.ptr;return g_(t)},Gg.prototype.set_m_tau=Gg.prototype.set_m_tau=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),er(e,t)},Gg.prototype.get_m_damping=Gg.prototype.get_m_damping=function(){var t=this.ptr;return No(t)},Gg.prototype.set_m_damping=Gg.prototype.set_m_damping=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ks(e,t)},Gg.prototype.get_m_impulseClamp=Gg.prototype.get_m_impulseClamp=function(){var t=this.ptr;return Vs(t)},Gg.prototype.set_m_impulseClamp=Gg.prototype.set_m_impulseClamp=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),jn(e,t)},Gg.prototype.__destroy__=Gg.prototype.__destroy__=function(){var t=this.ptr;mo(t)},jg.prototype=Object.create(ym.prototype),jg.prototype.constructor=jg,jg.prototype.__class__=jg,jg.__cache__={},r.btTranslationalLimitMotor2=jg,jg.prototype.get_m_currentLinearDiff=jg.prototype.get_m_currentLinearDiff=function(){var t=this.ptr;return Sm(yo(t),jm)},jg.prototype.set_m_currentLinearDiff=jg.prototype.set_m_currentLinearDiff=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),mr(e,t)},jg.prototype.__destroy__=jg.prototype.__destroy__=function(){var t=this.ptr;pn(t)},Hg.prototype=Object.create(ym.prototype),Hg.prototype.constructor=Hg,Hg.prototype.__class__=Hg,Hg.__cache__={},r.LocalShapeInfo=Hg,Hg.prototype.get_m_shapePart=Hg.prototype.get_m_shapePart=function(){var t=this.ptr;return Yn(t)},Hg.prototype.set_m_shapePart=Hg.prototype.set_m_shapePart=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),vs(e,t)},Hg.prototype.get_m_triangleIndex=Hg.prototype.get_m_triangleIndex=function(){var t=this.ptr;return Sd(t)},Hg.prototype.set_m_triangleIndex=Hg.prototype.set_m_triangleIndex=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),nc(e,t)},Hg.prototype.__destroy__=Hg.prototype.__destroy__=function(){var t=this.ptr;An(t)},Xg.prototype=Object.create(ym.prototype),Xg.prototype.constructor=Xg,Xg.prototype.__class__=Xg,Xg.__cache__={},r.btConstraintSolver=Xg,Xg.prototype.__destroy__=Xg.prototype.__destroy__=function(){var t=this.ptr;nu(t)},Yg.prototype=Object.create(Dm.prototype),Yg.prototype.constructor=Yg,Yg.prototype.__class__=Yg,Yg.__cache__={},r.btGeneric6DofSpringConstraint=Yg,Yg.prototype.enableSpring=Yg.prototype.enableSpring=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Gc(i,t,e)},Yg.prototype.setStiffness=Yg.prototype.setStiffness=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Wh(i,t,e)},Yg.prototype.setDamping=Yg.prototype.setDamping=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),$_(i,t,e)},Yg.prototype.setLinearLowerLimit=Yg.prototype.setLinearLowerLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),tm(e,t)},Yg.prototype.setLinearUpperLimit=Yg.prototype.setLinearUpperLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),en(e,t)},Yg.prototype.setAngularLowerLimit=Yg.prototype.setAngularLowerLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),sm(e,t)},Yg.prototype.setAngularUpperLimit=Yg.prototype.setAngularUpperLimit=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),mh(e,t)},Yg.prototype.enableFeedback=Yg.prototype.enableFeedback=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Xc(e,t)},Yg.prototype.getBreakingImpulseThreshold=Yg.prototype.getBreakingImpulseThreshold=function(){var t=this.ptr;return Uc(t)},Yg.prototype.setBreakingImpulseThreshold=Yg.prototype.setBreakingImpulseThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Hs(e,t)},Yg.prototype.__destroy__=Yg.prototype.__destroy__=function(){var t=this.ptr;Cl(t)},qg.prototype=Object.create(ym.prototype),qg.prototype.constructor=qg,qg.prototype.__class__=qg,qg.__cache__={},r.LocalConvexResult=qg,qg.prototype.get_m_hitCollisionObject=qg.prototype.get_m_hitCollisionObject=function(){var t=this.ptr;return Sm(Aa(t),Mm)},qg.prototype.set_m_hitCollisionObject=qg.prototype.set_m_hitCollisionObject=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),im(e,t)},qg.prototype.get_m_localShapeInfo=qg.prototype.get_m_localShapeInfo=function(){var t=this.ptr;return Sm(Ud(t),Hg)},qg.prototype.set_m_localShapeInfo=qg.prototype.set_m_localShapeInfo=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),zf(e,t)},qg.prototype.get_m_hitNormalLocal=qg.prototype.get_m_hitNormalLocal=function(){var t=this.ptr;return Sm(Pi(t),jm)},qg.prototype.set_m_hitNormalLocal=qg.prototype.set_m_hitNormalLocal=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Io(e,t)},qg.prototype.get_m_hitPointLocal=qg.prototype.get_m_hitPointLocal=function(){var t=this.ptr;return Sm(Nn(t),jm)},qg.prototype.set_m_hitPointLocal=qg.prototype.set_m_hitPointLocal=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),dr(e,t)},qg.prototype.get_m_hitFraction=qg.prototype.get_m_hitFraction=function(){var t=this.ptr;return $l(t)},qg.prototype.set_m_hitFraction=qg.prototype.set_m_hitFraction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Nu(e,t)},qg.prototype.__destroy__=qg.prototype.__destroy__=function(){var t=this.ptr;Kr(t)},Kg.prototype=Object.create(ym.prototype),Kg.prototype.constructor=Kg,Kg.prototype.__class__=Kg,Kg.__cache__={},r.btOverlappingPairCallback=Kg,Kg.prototype.__destroy__=Kg.prototype.__destroy__=function(){var t=this.ptr;Za(t)},Zg.prototype=Object.create(Mm.prototype),Zg.prototype.constructor=Zg,Zg.prototype.__class__=Zg,Zg.__cache__={},r.btRigidBody=Zg,Zg.prototype.getCenterOfMassTransform=Zg.prototype.getCenterOfMassTransform=function(){var t=this.ptr;return Sm(sn(t),Jg)},Zg.prototype.setCenterOfMassTransform=Zg.prototype.setCenterOfMassTransform=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),tu(e,t)},Zg.prototype.setSleepingThresholds=Zg.prototype.setSleepingThresholds=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Bd(i,t,e)},Zg.prototype.setDamping=Zg.prototype.setDamping=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Va(i,t,e)},Zg.prototype.setMassProps=Zg.prototype.setMassProps=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Sc(i,t,e)},Zg.prototype.setLinearFactor=Zg.prototype.setLinearFactor=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ss(e,t)},Zg.prototype.applyTorque=Zg.prototype.applyTorque=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ta(e,t)},Zg.prototype.applyForce=Zg.prototype.applyForce=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Js(i,t,e)},Zg.prototype.applyCentralForce=Zg.prototype.applyCentralForce=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ql(e,t)},Zg.prototype.applyTorqueImpulse=Zg.prototype.applyTorqueImpulse=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),wf(e,t)},Zg.prototype.applyImpulse=Zg.prototype.applyImpulse=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),nl(i,t,e)},Zg.prototype.applyCentralImpulse=Zg.prototype.applyCentralImpulse=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Wi(e,t)},Zg.prototype.updateInertiaTensor=Zg.prototype.updateInertiaTensor=function(){var t=this.ptr;Bl(t)},Zg.prototype.getLinearVelocity=Zg.prototype.getLinearVelocity=function(){var t=this.ptr;return Sm(il(t),jm)},Zg.prototype.getAngularVelocity=Zg.prototype.getAngularVelocity=function(){var t=this.ptr;return Sm(Qp(t),jm)},Zg.prototype.setLinearVelocity=Zg.prototype.setLinearVelocity=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),tf(e,t)},Zg.prototype.setAngularVelocity=Zg.prototype.setAngularVelocity=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),al(e,t)},Zg.prototype.getMotionState=Zg.prototype.getMotionState=function(){var t=this.ptr;return Sm(ip(t),Fm)},Zg.prototype.setMotionState=Zg.prototype.setMotionState=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ia(e,t)},Zg.prototype.setAngularFactor=Zg.prototype.setAngularFactor=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ec(e,t)},Zg.prototype.upcast=Zg.prototype.upcast=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(Ar(e,t),Zg)},Zg.prototype.setAnisotropicFriction=Zg.prototype.setAnisotropicFriction=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),cu(i,t,e)},Zg.prototype.getCollisionShape=Zg.prototype.getCollisionShape=function(){var t=this.ptr;return Sm(Hp(t),Em)},Zg.prototype.setContactProcessingThreshold=Zg.prototype.setContactProcessingThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),el(e,t)},Zg.prototype.setActivationState=Zg.prototype.setActivationState=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),pf(e,t)},Zg.prototype.forceActivationState=Zg.prototype.forceActivationState=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Df(e,t)},Zg.prototype.activate=Zg.prototype.activate=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),void 0!==t?Hd(e,t):Xd(e)},Zg.prototype.isActive=Zg.prototype.isActive=function(){var t=this.ptr;return!!Ko(t)},Zg.prototype.isKinematicObject=Zg.prototype.isKinematicObject=function(){var t=this.ptr;return!!Rn(t)},Zg.prototype.setRestitution=Zg.prototype.setRestitution=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Kf(e,t)},Zg.prototype.setFriction=Zg.prototype.setFriction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ur(e,t)},Zg.prototype.setRollingFriction=Zg.prototype.setRollingFriction=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Cd(e,t)},Zg.prototype.getWorldTransform=Zg.prototype.getWorldTransform=function(){var t=this.ptr;return Sm(ud(t),Jg)},Zg.prototype.getCollisionFlags=Zg.prototype.getCollisionFlags=function(){var t=this.ptr;return wa(t)},Zg.prototype.setCollisionFlags=Zg.prototype.setCollisionFlags=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Cf(e,t)},Zg.prototype.setWorldTransform=Zg.prototype.setWorldTransform=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ol(e,t)},Zg.prototype.setCollisionShape=Zg.prototype.setCollisionShape=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ia(e,t)},Zg.prototype.setCcdMotionThreshold=Zg.prototype.setCcdMotionThreshold=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Qs(e,t)},Zg.prototype.setCcdSweptSphereRadius=Zg.prototype.setCcdSweptSphereRadius=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),cr(e,t)},Zg.prototype.__destroy__=Zg.prototype.__destroy__=function(){var t=this.ptr;Od(t)},Qg.prototype=Object.create(qm.prototype),Qg.prototype.constructor=Qg,Qg.prototype.__class__=Qg,Qg.__cache__={},r.btCylinderShapeX=Qg,Qg.prototype.setMargin=Qg.prototype.setMargin=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Br(e,t)},Qg.prototype.getMargin=Qg.prototype.getMargin=function(){var t=this.ptr;return bl(t)},Qg.prototype.setLocalScaling=Qg.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Xa(e,t)},Qg.prototype.calculateLocalInertia=Qg.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),gp(i,t,e)},Qg.prototype.__destroy__=Qg.prototype.__destroy__=function(){var t=this.ptr;Zd(t)},$g.prototype=Object.create(qm.prototype),$g.prototype.constructor=$g,$g.prototype.__class__=$g,$g.__cache__={},r.btCylinderShapeZ=$g,$g.prototype.setMargin=$g.prototype.setMargin=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),_r(e,t)},$g.prototype.getMargin=$g.prototype.getMargin=function(){var t=this.ptr;return Mi(t)},$g.prototype.setLocalScaling=$g.prototype.setLocalScaling=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Gf(e,t)},$g.prototype.calculateLocalInertia=$g.prototype.calculateLocalInertia=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),ic(i,t,e)},$g.prototype.__destroy__=$g.prototype.__destroy__=function(){var t=this.ptr;zs(t)},Jg.prototype=Object.create(ym.prototype),Jg.prototype.constructor=Jg,Jg.prototype.__class__=Jg,Jg.__cache__={},r.btTransform=Jg,Jg.prototype.setIdentity=Jg.prototype.setIdentity=function(){var t=this.ptr;ki(t)},Jg.prototype.setOrigin=Jg.prototype.setOrigin=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ul(e,t)},Jg.prototype.setRotation=Jg.prototype.setRotation=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),to(e,t)},Jg.prototype.getOrigin=Jg.prototype.getOrigin=function(){var t=this.ptr;return Sm(kp(t),jm)},Jg.prototype.getRotation=Jg.prototype.getRotation=function(){var t=this.ptr;return Sm(ih(t),Pg)},Jg.prototype.getBasis=Jg.prototype.getBasis=function(){var t=this.ptr;return Sm(Ir(t),Zm)},Jg.prototype.__destroy__=Jg.prototype.__destroy__=function(){var t=this.ptr;If(t)},tb.prototype=Object.create(Km.prototype),tb.prototype.constructor=tb,tb.prototype.__class__=tb,tb.__cache__={},r.btRaycastVehicle=tb,tb.prototype.applyEngineForce=tb.prototype.applyEngineForce=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),R_(i,t,e)},tb.prototype.setSteeringValue=tb.prototype.setSteeringValue=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Cs(i,t,e)},tb.prototype.getWheelTransformWS=tb.prototype.getWheelTransformWS=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(Ua(e,t),Jg)},tb.prototype.updateWheelTransform=tb.prototype.updateWheelTransform=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Zi(i,t,e)},tb.prototype.addWheel=tb.prototype.addWheel=function(t,e,i,n,s,r,o){var a=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),s&&"object"==typeof s&&(s=s.ptr),r&&"object"==typeof r&&(r=r.ptr),o&&"object"==typeof o&&(o=o.ptr),Sm(Uf(a,t,e,i,n,s,r,o),kg)},tb.prototype.getNumWheels=tb.prototype.getNumWheels=function(){var t=this.ptr;return Tl(t)},tb.prototype.getRigidBody=tb.prototype.getRigidBody=function(){var t=this.ptr;return Sm(d_(t),Zg)},tb.prototype.getWheelInfo=tb.prototype.getWheelInfo=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Sm(Ju(e,t),kg)},tb.prototype.setBrake=tb.prototype.setBrake=function(t,e){var i=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),I_(i,t,e)},tb.prototype.setCoordinateSystem=tb.prototype.setCoordinateSystem=function(t,e,i){var n=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),i&&"object"==typeof i&&(i=i.ptr),aa(n,t,e,i)},tb.prototype.__destroy__=tb.prototype.__destroy__=function(){var t=this.ptr;Yd(t)},eb.prototype=Object.create(ym.prototype),eb.prototype.constructor=eb,eb.prototype.__class__=eb,eb.__cache__={},r.btGhostPairCallback=eb,eb.prototype.__destroy__=eb.prototype.__destroy__=function(){var t=this.ptr;Ff(t)},ib.prototype=Object.create(ym.prototype),ib.prototype.constructor=ib,ib.prototype.__class__=ib,ib.__cache__={},r.btRotationalLimitMotor2=ib,ib.prototype.get_m_currentPosition=ib.prototype.get_m_currentPosition=function(){var t=this.ptr;return Ba(t)},ib.prototype.set_m_currentPosition=ib.prototype.set_m_currentPosition=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),nm(e,t)},ib.prototype.__destroy__=ib.prototype.__destroy__=function(){var t=this.ptr;Uo(t)},function(){function t(){r.RO_XYZ=fh(),r.RO_XZY=vp(),r.RO_YXZ=Ts(),r.RO_YZX=p_(),r.RO_ZXY=em(),r.RO_ZYX=Op()}r.calledRun?t():Mt(t)}(),r};return e()})?r.call(e,i,e,t):r)||(t.exports=o)}).call(this,i(12),"/")},,,,,,function(t,e,i){var n=i(47),s=i(48),r=s;r.v1=n,r.v4=s,t.exports=r},function(t,e,i){var n,s,r=i(22),o=i(23),a=0,l=0;t.exports=function(t,e,i){var h=e&&i||0,c=e||[],_=(t=t||{}).node||n,u=void 0!==t.clockseq?t.clockseq:s;if(null==_||null==u){var d=r();null==_&&(_=n=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==u&&(u=s=16383&(d[6]<<8|d[7]))}var p=void 0!==t.msecs?t.msecs:(new Date).getTime(),f=void 0!==t.nsecs?t.nsecs:l+1,m=p-a+(f-l)/1e4;if(m<0&&void 0===t.clockseq&&(u=u+1&16383),(m<0||p>a)&&void 0===t.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=p,l=f,s=u;var g=(1e4*(268435455&(p+=122192928e5))+f)%4294967296;c[h++]=g>>>24&255,c[h++]=g>>>16&255,c[h++]=g>>>8&255,c[h++]=255&g;var b=p/4294967296*1e4&268435455;c[h++]=b>>>8&255,c[h++]=255&b,c[h++]=b>>>24&15|16,c[h++]=b>>>16&255,c[h++]=u>>>8|128,c[h++]=255&u;for(var y=0;y<6;++y)c[h+y]=_[y];return e||o(c)}},function(t,e,i){var n=i(22),s=i(23);t.exports=function(t,e,i){var r=e&&i||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var o=(t=t||{}).random||(t.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var a=0;a<16;++a)e[r+a]=o[a];return e||s(o)}},,function(t,e,i){const{Context2d:n,CanvasRenderingContext2D:s,CanvasGradient:r,CanvasPattern:o,Image:a,ImageData:l,PNGStream:h,PDFStream:c,JPEGStream:_,DOMMatrix:u,DOMPoint:d,registerFont:p,parseFont:f,createImageData:m,loadImage:g,backends:b,version:y,cairoVersion:v,jpegVersion:S,gifVersion:x,freetypeVersion:w}=i(15),{WebGLRenderingContext:C}=i(16),T=i(32),A=s.prototype.drawImage;s.prototype.drawImage=function(t,...e){return t instanceof T&&t.__gl__&&t.__ctx__,A.call(this,t,...e)};const E=i(88);t.exports={Canvas:T,Context2d:n,CanvasRenderingContext2D:s,WebGLRenderingContext:C,CanvasGradient:r,CanvasPattern:o,Image:a,ImageData:l,PNGStream:h,PDFStream:c,JPEGStream:_,DOMMatrix:u,DOMPoint:d,registerFont:p,parseFont:f,createCanvas:function(t,e,i){return new T(t,e,i)},createImageData:m,loadImage:g,backends:b,version:y,cairoVersion:v,jpegVersion:S,gifVersion:x,freetypeVersion:w,mockDOM:E}},function(t,e,i){"use strict";const n="'([^']+)'|\"([^\"]+)\"|[\\w\\s-]+",s=new RegExp("(bold|bolder|lighter|[1-9]00) +","i"),r=new RegExp("(italic|oblique) +","i"),o=new RegExp("(small-caps) +","i"),a=new RegExp("(ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded) +","i"),l=new RegExp("([\\d\\.]+)(px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q) *((?:"+n+")( *, *(?:"+n+"))*)"),h={};t.exports=function(t){if(h[t])return h[t];const e=l.exec(t);if(!e)return;const i={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(e[1]),unit:e[2],family:e[3].replace(/["']/g,"").replace(/ *, */g,",")};let n,c,_,u,d=t.substring(0,e.index);switch((n=s.exec(d))&&(i.weight=n[1]),(c=r.exec(d))&&(i.style=c[1]),(_=o.exec(d))&&(i.variant=_[1]),(u=a.exec(d))&&(i.stretch=u[1]),i.unit){case"pt":i.size/=.75;break;case"pc":i.size*=16;break;case"in":i.size*=96;break;case"cm":i.size*=96/2.54;break;case"mm":i.size*=96/25.4;break;case"%":break;case"em":case"rem":i.size*=16/.75;break;case"q":i.size*=96/25.4/4}return h[t]=i}},function(t,e,i){var n=i(53);t.exports=function(t,e){var i=n(e),s=[];return s=(s=s.concat(i(t))).concat(i(null))}},function(t,e,i){t.exports=function(t){var e,i,h,c=0,_=0,u=999,d=[],p=[],f=1,m=0,g=0,b=!1,y=!1,v="",S=r,x=n;"300 es"===(t=t||{}).version&&(S=a,x=o);var w={},C={};for(c=0;c<S.length;c++)w[S[c]]=!0;for(c=0;c<x.length;c++)C[x[c]]=!0;return function(t){return p=[],null!==t?function(t){c=0,t.toString&&(t=t.toString());var i;v+=t.replace(/\r\n/g,"\n"),h=v.length;for(;e=v[c],c<h;){switch(i=c,u){case 0:c=R();break;case 1:case 2:c=M();break;case 3:c=I();break;case 4:c=D();break;case 11:c=L();break;case 5:c=k();break;case 9999:c=O();break;case 9:c=E();break;case 999:c=A()}if(i!==c)switch(v[i]){case"\n":m=0,++f;break;default:++m}}return _+=c,v=v.slice(c),p}(t):function(t){d.length&&T(d.join(""));return u=10,T("(eof)"),p}()};function T(t){t.length&&p.push({type:l[u],data:t,position:g,line:f,column:m})}function A(){return d=d.length?[]:d,"/"===i&&"*"===e?(g=_+c-1,u=0,i=e,c+1):"/"===i&&"/"===e?(g=_+c-1,u=1,i=e,c+1):"#"===e?(u=2,g=_+c,c):/\s/.test(e)?(u=9,g=_+c,c):(b=/\d/.test(e),y=/[^\w_]/.test(e),g=_+c,u=b?4:y?3:9999,c)}function E(){return/[^\s]/g.test(e)?(T(d.join("")),u=999,c):(d.push(e),i=e,c+1)}function M(){return"\r"!==e&&"\n"!==e||"\\"===i?(d.push(e),i=e,c+1):(T(d.join("")),u=999,c)}function R(){return"/"===e&&"*"===i?(d.push(e),T(d.join("")),u=999,c+1):(d.push(e),i=e,c+1)}function I(){if("."===i&&/\d/.test(e))return u=5,c;if("/"===i&&"*"===e)return u=0,c;if("/"===i&&"/"===e)return u=1,c;if("."===e&&d.length){for(;P(d););return u=5,c}if(";"===e||")"===e||"("===e){if(d.length)for(;P(d););return T(e),u=999,c+1}var t=2===d.length&&"="!==e;if(/[\w_\d\s]/.test(e)||t){for(;P(d););return u=999,c}return d.push(e),i=e,c+1}function P(t){for(var e,i,n=0;;){if(e=s.indexOf(t.slice(0,t.length+n).join("")),i=s[e],-1===e){if(n--+t.length>0)continue;i=t.slice(0,1).join("")}return T(i),g+=i.length,(d=d.slice(i.length)).length}}function L(){return/[^a-fA-F0-9]/.test(e)?(T(d.join("")),u=999,c):(d.push(e),i=e,c+1)}function D(){return"."===e||/[eE]/.test(e)?(d.push(e),u=5,i=e,c+1):"x"===e&&1===d.length&&"0"===d[0]?(u=11,d.push(e),i=e,c+1):/[^\d]/.test(e)?(T(d.join("")),u=999,c):(d.push(e),i=e,c+1)}function k(){return"f"===e&&(d.push(e),i=e,c+=1),/[eE]/.test(e)?(d.push(e),i=e,c+1):("-"!==e&&"+"!==e||!/[eE]/.test(i))&&/[^\d]/.test(e)?(T(d.join("")),u=999,c):(d.push(e),i=e,c+1)}function O(){if(/[^\d\w_]/.test(e)){var t=d.join("");return u=C[t]?8:w[t]?7:6,T(d.join("")),u=999,c}return d.push(e),i=e,c+1}};var n=i(25),s=i(54),r=i(26),o=i(55),a=i(56),l=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},function(t,e){t.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},function(t,e,i){var n=i(25);t.exports=n.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},function(t,e,i){var n=i(26);n=n.slice().filter((function(t){return!/^(gl\_|texture)/.test(t)})),t.exports=n.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},function(t){t.exports=JSON.parse('{"_from":"gl@^4.4.0","_id":"gl@4.9.2","_inBundle":false,"_integrity":"sha512-lLYaicQxsRPxOnKWX9pIGmtKRuw0epvI089yl9uBvemYxR9xE01eRuXJgje1U0/06Df7bdOmmcW87IPOsu52Ow==","_location":"/gl","_phantomChildren":{},"_requested":{"type":"range","registry":true,"raw":"gl@^4.4.0","name":"gl","escapedName":"gl","rawSpec":"^4.4.0","saveSpec":null,"fetchSpec":"^4.4.0"},"_requiredBy":["/node-canvas-webgl"],"_resolved":"https://registry.npmjs.org/gl/-/gl-4.9.2.tgz","_shasum":"dd31cdaec7d3c4b6761648111e55531f86137821","_spec":"gl@^4.4.0","_where":"C:\\\\Users\\\\danil\\\\Desktop\\\\dmdassc-game\\\\node_modules\\\\node-canvas-webgl","author":{"name":"Mikola Lysenko"},"browser":"browser_index.js","bugs":{"url":"https://github.com/stackgl/headless-gl/issues"},"bundleDependencies":false,"dependencies":{"bindings":"^1.5.0","bit-twiddle":"^1.0.2","glsl-tokenizer":"^2.0.2","nan":"^2.15.0","node-abi":"^2.30.1","node-gyp":"^7.1.2","prebuild-install":"^5.3.6"},"deprecated":false,"description":"Creates a WebGL context without a window","devDependencies":{"angle-normals":"^1.0.0","bunny":"^1.0.1","faucet":"0.0.1","gl-conformance":"^2.0.9","prebuild":"^10.0.1","snazzy":"^8.0.0","standard":"^14.3.4","tape":"^5.3.1"},"directories":{"test":"test"},"engines":{"node":">=12.0.0"},"gypfile":true,"homepage":"https://github.com/stackgl/headless-gl#readme","keywords":["webgl","opengl","gl","headless","server","gpgpu"],"license":"BSD-2-Clause","main":"index.js","name":"gl","repository":{"type":"git","url":"git://github.com/stackgl/headless-gl.git"},"scripts":{"install":"prebuild-install || node-gyp rebuild","prebuild":"prebuild --all --strip","rebuild":"node-gyp rebuild --verbose","test":"standard | snazzy && tape test/*.js | faucet"},"version":"4.9.2"}')},function(t,e,i){(function(n,s){var r=i(19),o=i(14),a=i(59),l=o.join,h=o.dirname,c=r.accessSync&&function(t){try{r.accessSync(t)}catch(t){return!1}return!0}||r.existsSync||o.existsSync,_={arrow:n.env.NODE_BINDINGS_ARROW||" → ",compiled:n.env.NODE_BINDINGS_COMPILED_DIR||"compiled",platform:n.platform,arch:n.arch,nodePreGyp:"node-v"+n.versions.modules+"-"+n.platform+"-"+n.arch,version:n.versions.node,bindings:"bindings.node",try:[["module_root","build","bindings"],["module_root","build","Debug","bindings"],["module_root","build","Release","bindings"],["module_root","out","Debug","bindings"],["module_root","Debug","bindings"],["module_root","out","Release","bindings"],["module_root","Release","bindings"],["module_root","build","default","bindings"],["module_root","compiled","version","platform","arch","bindings"],["module_root","addon-build","release","install-root","bindings"],["module_root","addon-build","debug","install-root","bindings"],["module_root","addon-build","default","install-root","bindings"],["module_root","lib","binding","nodePreGyp","bindings"]]};t.exports=e=function(t){"string"==typeof t?t={bindings:t}:t||(t={}),Object.keys(_).map((function(e){e in t||(t[e]=_[e])})),t.module_root||(t.module_root=e.getRoot(e.getFileName())),".node"!=o.extname(t.bindings)&&(t.bindings+=".node");for(var i,n,s,r=require,a=[],h=0,c=t.try.length;h<c;h++){i=l.apply(null,t.try[h].map((function(e){return t[e]||e}))),a.push(i);try{return n=t.path?r.resolve(i):r(i),t.path||(n.path=i),n}catch(t){if("MODULE_NOT_FOUND"!==t.code&&"QUALIFIED_PATH_RESOLUTION_FAILED"!==t.code&&!/not find/i.test(t.message))throw t}}throw(s=new Error("Could not locate the bindings file. Tried:\n"+a.map((function(e){return t.arrow+e})).join("\n"))).tries=a,s},e.getFileName=function(t){var e,i=Error.prepareStackTrace,n=Error.stackTraceLimit,r={};Error.stackTraceLimit=10,Error.prepareStackTrace=function(i,n){for(var r=0,o=n.length;r<o;r++)if((e=n[r].getFileName())!==s){if(!t)return;if(e!==t)return}},Error.captureStackTrace(r),Error.prepareStackTrace=i,Error.stackTraceLimit=n;return 0===e.indexOf("file://")&&(e=a(e)),e},e.getRoot=function(t){for(var e,i=h(t);;){if("."===i&&(i=n.cwd()),c(l(i,"package.json"))||c(l(i,"node_modules")))return i;if(e===i)throw new Error('Could not find module root given file: "'+t+'". Do you have a `package.json` file? ');e=i,i=l(i,"..")}}}).call(this,i(12),"/index.js")},function(t,e,i){var n=i(14).sep||"/";t.exports=function(t){if("string"!=typeof t||t.length<=7||"file://"!=t.substring(0,7))throw new TypeError("must pass in a file:// URI to convert to a file path");var e=decodeURI(t.substring(7)),i=e.indexOf("/"),s=e.substring(0,i),r=e.substring(i+1);"localhost"==s&&(s="");s&&(s=n+n+s);r=r.replace(/^(.+)\|/,"$1:"),"\\"==n&&(r=r.replace(/\//g,"\\"));/^.+\:/.test(r)||(r=n+r);return s+r}},function(t,e,i){const{gl:n}=i(0),{vertexCount:s}=i(17);class r{constructor(t){this.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070,this.ctx=t,this._drawArraysInstanced=n._drawArraysInstanced.bind(t),this._drawElementsInstanced=n._drawElementsInstanced.bind(t),this._vertexAttribDivisor=n._vertexAttribDivisor.bind(t)}drawArraysInstancedANGLE(t,e,i,r){const{ctx:o}=this;if(t|=0,i|=0,r|=0,(e|=0)<0||i<0||r<0)return void o.setError(n.INVALID_VALUE);if(!o._checkStencilState())return;const a=s(t,i);if(a<0)return void o.setError(n.INVALID_ENUM);if(!o._framebufferOk())return;if(0===i||0===r)return;let l=e;return i>0&&(l=i+e-1>>>0),this.checkInstancedVertexAttribState(l,r)?this._drawArraysInstanced(t,e,a,r):void 0}drawElementsInstancedANGLE(t,e,i,s,r){const{ctx:o}=this;if(t|=0,i|=0,s|=0,r|=0,(e|=0)<0||s<0||r<0)return void o.setError(n.INVALID_VALUE);if(!o._checkStencilState())return;const a=o._vertexObjectState._elementArrayBufferBinding;if(!a)return void o.setError(n.INVALID_OPERATION);let l=null,h=s;if(i===n.UNSIGNED_SHORT){if(h%2)return void o.setError(n.INVALID_OPERATION);h>>=1,l=new Uint16Array(a._elements.buffer)}else if(o._extensions.oes_element_index_uint&&i===n.UNSIGNED_INT){if(h%4)return void o.setError(n.INVALID_OPERATION);h>>=2,l=new Uint32Array(a._elements.buffer)}else{if(i!==n.UNSIGNED_BYTE)return void o.setError(n.INVALID_ENUM);l=a._elements}let c=e;switch(t){case n.TRIANGLES:e%3&&(c-=e%3);break;case n.LINES:e%2&&(c-=e%2);break;case n.POINTS:break;case n.LINE_LOOP:case n.LINE_STRIP:if(e<2)return void o.setError(n.INVALID_OPERATION);break;case n.TRIANGLE_FAN:case n.TRIANGLE_STRIP:if(e<3)return void o.setError(n.INVALID_OPERATION);break;default:return void o.setError(n.INVALID_ENUM)}if(!o._framebufferOk())return;if(0===e||0===r)return void this.checkInstancedVertexAttribState(0,0);if(e+h>>>0>l.length)return void o.setError(n.INVALID_OPERATION);let _=-1;for(let t=h;t<h+e;++t)_=Math.max(_,l[t]);_<0?this.checkInstancedVertexAttribState(0,0):this.checkInstancedVertexAttribState(_,r)&&c>0&&this._drawElementsInstanced(t,c,i,s,r)}vertexAttribDivisorANGLE(t,e){const{ctx:i}=this;if(t|=0,(e|=0)<0||t<0||t>=i._vertexObjectState._attribs.length)return void i.setError(n.INVALID_VALUE);i._vertexObjectState._attribs[t]._divisor=e,this._vertexAttribDivisor(t,e)}checkInstancedVertexAttribState(t,e){const{ctx:i}=this,s=i._activeProgram;if(!s)return i.setError(n.INVALID_OPERATION),!1;const r=i._vertexObjectState._attribs;let o=!1;for(let a=0;a<r.length;++a){const l=r[a];if(l._isPointer){const r=l._pointerBuffer;if(s._attributes.indexOf(a)>=0){if(!r)return i.setError(n.INVALID_OPERATION),!1;let s=0;if(0===l._divisor?(o=!0,s=l._pointerStride*t+l._pointerSize+l._pointerOffset):s=l._pointerStride*(Math.ceil(e/l._divisor)-1)+l._pointerSize+l._pointerOffset,s>r._size)return i.setError(n.INVALID_OPERATION),!1}}}return!!o||(i.setError(n.INVALID_OPERATION),!1)}}t.exports={ANGLEInstancedArrays:r,getANGLEInstancedArrays:function(t){return new r(t)}}},function(t,e,i){"use strict";e.byteLength=function(t){var e=h(t),i=e[0],n=e[1];return 3*(i+n)/4-n},e.toByteArray=function(t){var e,i,n=h(t),o=n[0],a=n[1],l=new r(function(t,e,i){return 3*(e+i)/4-i}(0,o,a)),c=0,_=a>0?o-4:o;for(i=0;i<_;i+=4)e=s[t.charCodeAt(i)]<<18|s[t.charCodeAt(i+1)]<<12|s[t.charCodeAt(i+2)]<<6|s[t.charCodeAt(i+3)],l[c++]=e>>16&255,l[c++]=e>>8&255,l[c++]=255&e;2===a&&(e=s[t.charCodeAt(i)]<<2|s[t.charCodeAt(i+1)]>>4,l[c++]=255&e);1===a&&(e=s[t.charCodeAt(i)]<<10|s[t.charCodeAt(i+1)]<<4|s[t.charCodeAt(i+2)]>>2,l[c++]=e>>8&255,l[c++]=255&e);return l},e.fromByteArray=function(t){for(var e,i=t.length,s=i%3,r=[],o=0,a=i-s;o<a;o+=16383)r.push(c(t,o,o+16383>a?a:o+16383));1===s?(e=t[i-1],r.push(n[e>>2]+n[e<<4&63]+"==")):2===s&&(e=(t[i-2]<<8)+t[i-1],r.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return r.join("")};for(var n=[],s=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=o.length;a<l;++a)n[a]=o[a],s[o.charCodeAt(a)]=a;function h(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function c(t,e,i){for(var s,r,o=[],a=e;a<i;a+=3)s=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(n[(r=s)>>18&63]+n[r>>12&63]+n[r>>6&63]+n[63&r]);return o.join("")}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,i,n,s){var r,o,a=8*s-n-1,l=(1<<a)-1,h=l>>1,c=-7,_=i?s-1:0,u=i?-1:1,d=t[e+_];for(_+=u,r=d&(1<<-c)-1,d>>=-c,c+=a;c>0;r=256*r+t[e+_],_+=u,c-=8);for(o=r&(1<<-c)-1,r>>=-c,c+=n;c>0;o=256*o+t[e+_],_+=u,c-=8);if(0===r)r=1-h;else{if(r===l)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),r-=h}return(d?-1:1)*o*Math.pow(2,r-n)},e.write=function(t,e,i,n,s,r){var o,a,l,h=8*r-s-1,c=(1<<h)-1,_=c>>1,u=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:r-1,p=n?1:-1,f=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),(e+=o+_>=1?u/l:u*Math.pow(2,1-_))*l>=2&&(o++,l/=2),o+_>=c?(a=0,o=c):o+_>=1?(a=(e*l-1)*Math.pow(2,s),o+=_):(a=e*Math.pow(2,_-1)*Math.pow(2,s),o=0));s>=8;t[i+d]=255&a,d+=p,a/=256,s-=8);for(o=o<<s|a,h+=s;h>0;t[i+d]=255&o,d+=p,o/=256,h-=8);t[i+d-p]|=128*f}},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e){class i{}t.exports={getOESElementIndexUint:function(t){let e=null;const n=t.getSupportedExtensions();return n&&n.indexOf("OES_element_index_uint")>=0&&(e=new i),e},OESElementIndexUint:i}},function(t,e){class i{constructor(){this.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723}}t.exports={getOESStandardDerivatives:function(t){let e=null;const n=t.getSupportedExtensions();return n&&n.indexOf("OES_standard_derivatives")>=0&&(e=new i),e},OESStandardDerivatives:i}},function(t,e){class i{}t.exports={getOESTextureFloat:function(t){let e=null;const n=t.getSupportedExtensions();return n&&n.indexOf("OES_texture_float")>=0&&(e=new i),e},OESTextureFloat:i}},function(t,e){class i{}t.exports={getOESTextureFloatLinear:function(t){let e=null;const n=t.getSupportedExtensions();return n&&n.indexOf("OES_texture_float_linear")>=0&&(e=new i),e},OESTextureFloatLinear:i}},function(t,e){class i{constructor(t){this.destroy=t.destroy.bind(t)}}t.exports={getSTACKGLDestroyContext:function(t){return new i(t)},STACKGLDestroyContext:i}},function(t,e){class i{constructor(t){this.resize=t.resize.bind(t)}}t.exports={getSTACKGLResizeDrawingBuffer:function(t){return new i(t)},STACKGLResizeDrawingBuffer:i}},function(t,e,i){const{gl:n}=i(0);class s{constructor(t){this.ctx=t;const e=t.getSupportedExtensions();if(e&&e.indexOf("WEBGL_draw_buffers")>=0){Object.assign(this,t.extWEBGL_draw_buffers()),this._buffersState=[t.BACK],this._maxDrawBuffers=t._getParameterDirect(this.MAX_DRAW_BUFFERS_WEBGL),this._ALL_ATTACHMENTS=[],this._ALL_COLOR_ATTACHMENTS=[];const e=[this.COLOR_ATTACHMENT0_WEBGL,this.COLOR_ATTACHMENT1_WEBGL,this.COLOR_ATTACHMENT2_WEBGL,this.COLOR_ATTACHMENT3_WEBGL,this.COLOR_ATTACHMENT4_WEBGL,this.COLOR_ATTACHMENT5_WEBGL,this.COLOR_ATTACHMENT6_WEBGL,this.COLOR_ATTACHMENT7_WEBGL,this.COLOR_ATTACHMENT8_WEBGL,this.COLOR_ATTACHMENT9_WEBGL,this.COLOR_ATTACHMENT10_WEBGL,this.COLOR_ATTACHMENT11_WEBGL,this.COLOR_ATTACHMENT12_WEBGL,this.COLOR_ATTACHMENT13_WEBGL,this.COLOR_ATTACHMENT14_WEBGL,this.COLOR_ATTACHMENT15_WEBGL];for(;this._ALL_ATTACHMENTS.length<this._maxDrawBuffers;){const t=e.shift();this._ALL_ATTACHMENTS.push(t),this._ALL_COLOR_ATTACHMENTS.push(t)}this._ALL_ATTACHMENTS.push(n.DEPTH_ATTACHMENT,n.STENCIL_ATTACHMENT,n.DEPTH_STENCIL_ATTACHMENT)}}drawBuffersWEBGL(t){const{ctx:e}=this;if(t.length<1)e.setError(n.INVALID_OPERATION);else{if(1===t.length&&t[0]===n.BACK)return this._buffersState=t,void e.drawBuffersWEBGL([this.COLOR_ATTACHMENT0_WEBGL]);if(!e._activeFramebuffer){if(t.length>1)return void e.setError(n.INVALID_OPERATION);for(let i=0;i<t.length;i++)if(t[i]>n.NONE)return void e.setError(n.INVALID_OPERATION)}this._buffersState=t,e.drawBuffersWEBGL(t)}}}t.exports={getWebGLDrawBuffers:function(t){const e=t.getSupportedExtensions();return e&&e.indexOf("WEBGL_draw_buffers")>=0?new s(t):null},WebGLDrawBuffers:s}},function(t,e){class i{constructor(){this.MIN_EXT=32775,this.MAX_EXT=32776}}t.exports={getEXTBlendMinMax:function(t){let e=null;const n=t.getSupportedExtensions();return n&&n.indexOf("EXT_blend_minmax")>=0&&(e=new i),e},EXTBlendMinMax:i}},function(t,e){class i{constructor(){this.TEXTURE_MAX_ANISOTROPY_EXT=34046,this.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047}}t.exports={getEXTTextureFilterAnisotropic:function(t){let e=null;const n=t.getSupportedExtensions();return n&&n.indexOf("EXT_texture_filter_anisotropic")>=0&&(e=new i),e},EXTTextureFilterAnisotropic:i}},function(t,e,i){const{Linkable:n}=i(7),{gl:s}=i(0),{checkObject:r}=i(17),{WebGLVertexArrayObjectState:o}=i(30);class a extends n{constructor(t,e,i){super(t),this._ctx=e,this._ext=i,this._vertexState=new o(e)}_performDelete(){this._vertexState.cleanUp(),delete this._vertexState,delete this._ext._vaos[this._],s.deleteVertexArrayOES.call(this._ctx,0|this._)}}class l{constructor(t){this.VERTEX_ARRAY_BINDING_OES=34229,this._ctx=t,this._vaos={},this._activeVertexArrayObject=null}createVertexArrayOES(){const{_ctx:t}=this,e=s.createVertexArrayOES.call(t);if(e<=0)return null;const i=new a(e,t,this);return this._vaos[e]=i,i}deleteVertexArrayOES(t){const{_ctx:e}=this;if(!r(t))throw new TypeError("deleteVertexArrayOES(WebGLVertexArrayObjectOES)");t instanceof a&&e._checkOwns(t)?t._pendingDelete||(this._activeVertexArrayObject===t&&this.bindVertexArrayOES(null),t._pendingDelete=!0,t._checkDelete()):e.setError(s.INVALID_OPERATION)}bindVertexArrayOES(t){const{_ctx:e,_activeVertexArrayObject:i}=this;if(!r(t))throw new TypeError("bindVertexArrayOES(WebGLVertexArrayObjectOES)");if(t){if(t instanceof a&&t._pendingDelete)return void e.setError(s.INVALID_OPERATION);if(!e._checkWrapper(t,a))return;s.bindVertexArrayOES.call(e,t._)}else t=null,s.bindVertexArrayOES.call(e,null);i!==t&&(i&&(i._refCount-=1,i._checkDelete()),t&&(t._refCount+=1)),e._vertexObjectState=null===t?e._defaultVertexObjectState:t._vertexState,this._activeVertexArrayObject=t}isVertexArrayOES(t){const{_ctx:e}=this;return!!e._isObject(t,"isVertexArrayOES",a)&&s.isVertexArrayOES.call(e,0|t._)}}t.exports={WebGLVertexArrayObjectOES:a,OESVertexArrayObject:l,getOESVertexArrayObject:function(t){const e=t.getSupportedExtensions();return e&&e.indexOf("OES_vertex_array_object")>=0?new l(t):null}}},function(t,e){t.exports={WebGLActiveInfo:class{constructor(t){this.size=t.size,this.type=t.type,this.name=t.name}}}},function(t,e,i){const{Linkable:n}=i(7),{gl:s}=i(0);t.exports={WebGLFramebuffer:class extends n{constructor(t,e){if(super(t),this._ctx=e,this._binding=0,this._width=0,this._height=0,this._status=null,this._attachments={},this._attachments[s.COLOR_ATTACHMENT0]=null,this._attachments[s.DEPTH_ATTACHMENT]=null,this._attachments[s.STENCIL_ATTACHMENT]=null,this._attachments[s.DEPTH_STENCIL_ATTACHMENT]=null,this._attachmentLevel={},this._attachmentLevel[s.COLOR_ATTACHMENT0]=0,this._attachmentLevel[s.DEPTH_ATTACHMENT]=0,this._attachmentLevel[s.STENCIL_ATTACHMENT]=0,this._attachmentLevel[s.DEPTH_STENCIL_ATTACHMENT]=0,this._attachmentFace={},this._attachmentFace[s.COLOR_ATTACHMENT0]=0,this._attachmentFace[s.DEPTH_ATTACHMENT]=0,this._attachmentFace[s.STENCIL_ATTACHMENT]=0,this._attachmentFace[s.DEPTH_STENCIL_ATTACHMENT]=0,e._extensions.webgl_draw_buffers){const{webgl_draw_buffers:t}=e._extensions;this._attachments[t.COLOR_ATTACHMENT1_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT2_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT3_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT4_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT5_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT6_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT7_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT8_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT9_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT10_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT11_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT12_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT13_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT14_WEBGL]=null,this._attachments[t.COLOR_ATTACHMENT15_WEBGL]=null,this._attachments[s.NONE]=null,this._attachments[s.BACK]=null,this._attachmentLevel[t.COLOR_ATTACHMENT1_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT2_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT3_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT4_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT5_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT6_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT7_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT8_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT9_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT10_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT11_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT12_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT13_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT14_WEBGL]=0,this._attachmentLevel[t.COLOR_ATTACHMENT15_WEBGL]=0,this._attachmentLevel[s.NONE]=null,this._attachmentLevel[s.BACK]=null,this._attachmentFace[t.COLOR_ATTACHMENT1_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT2_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT3_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT4_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT5_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT6_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT7_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT8_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT9_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT10_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT11_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT12_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT13_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT14_WEBGL]=0,this._attachmentFace[t.COLOR_ATTACHMENT15_WEBGL]=0,this._attachmentFace[s.NONE]=null,this._attachmentFace[s.BACK]=null}}_clearAttachment(t){const e=this._attachments[t];e&&(this._attachments[t]=null,this._unlink(e))}_setAttachment(t,e){this._attachments[e]!==t&&(this._clearAttachment(e),t&&(this._attachments[e]=t,this._link(t)))}_performDelete(){const t=this._ctx;delete t._framebuffers[0|this._],s.deleteFramebuffer.call(t,0|this._)}}}},function(t,e){t.exports={WebGLDrawingBufferWrapper:class{constructor(t,e,i){this._framebuffer=t,this._color=e,this._depthStencil=i}}}},function(t,e,i){const{Linkable:n}=i(7),{gl:s}=i(0);t.exports={WebGLProgram:class extends n{constructor(t,e){super(t),this._ctx=e,this._linkCount=0,this._linkStatus=!1,this._linkInfoLog="not linked",this._attributes=[],this._uniforms=[]}_performDelete(){const t=this._ctx;delete t._programs[0|this._],s.deleteProgram.call(t,0|this._)}}}},function(t,e,i){const{Linkable:n}=i(7),{gl:s}=i(0);t.exports={WebGLRenderbuffer:class extends n{constructor(t,e){super(t),this._ctx=e,this._binding=0,this._width=0,this._height=0,this._format=0}_performDelete(){const t=this._ctx;delete t._renderbuffers[0|this._],s.deleteRenderbuffer.call(t,0|this._)}}}},function(t,e,i){const{gl:n}=i(0),{Linkable:s}=i(7);t.exports={WebGLShader:class extends s{constructor(t,e,i){super(t),this._type=i,this._ctx=e,this._source="",this._compileStatus=!1,this._compileInfo=""}_performDelete(){const t=this._ctx;delete t._shaders[0|this._],n.deleteShader.call(t,0|this._)}}}},function(t,e){t.exports={WebGLShaderPrecisionFormat:class{constructor(t){this.rangeMin=t.rangeMin,this.rangeMax=t.rangeMax,this.precision=t.precision}}}},function(t,e,i){const{Linkable:n}=i(7),{gl:s}=i(0);t.exports={WebGLTexture:class extends n{constructor(t,e){super(t),this._ctx=e,this._binding=0,this._levelWidth=new Int32Array(32),this._levelHeight=new Int32Array(32),this._format=0,this._type=0,this._complete=!0}_performDelete(){const t=this._ctx;delete t._textures[0|this._],s.deleteTexture.call(t,0|this._)}}}},function(t,e,i){"use strict";var n,s="object"==typeof Reflect?Reflect:null,r=s&&"function"==typeof s.apply?s.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)};n=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(t,e){return new Promise((function(i,n){function s(i){t.removeListener(e,r),n(i)}function r(){"function"==typeof t.removeListener&&t.removeListener("error",s),i([].slice.call(arguments))}g(t,e,r,{once:!0}),"error"!==e&&function(t,e,i){"function"==typeof t.on&&g(t,"error",e,i)}(t,s,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function h(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function c(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function _(t,e,i,n){var s,r,o,a;if(h(i),void 0===(r=t._events)?(r=t._events=Object.create(null),t._eventsCount=0):(void 0!==r.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),r=t._events),o=r[e]),void 0===o)o=r[e]=i,++t._eventsCount;else if("function"==typeof o?o=r[e]=n?[i,o]:[o,i]:n?o.unshift(i):o.push(i),(s=c(t))>0&&o.length>s&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=o.length,a=l,console&&console.warn&&console.warn(a)}return t}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(t,e,i){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:i},s=u.bind(n);return s.listener=i,n.wrapFn=s,s}function p(t,e,i){var n=t._events;if(void 0===n)return[];var s=n[e];return void 0===s?[]:"function"==typeof s?i?[s.listener||s]:[s]:i?function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(s):m(s,s.length)}function f(t){var e=this._events;if(void 0!==e){var i=e[t];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function m(t,e){for(var i=new Array(e),n=0;n<e;++n)i[n]=t[n];return i}function g(t,e,i,n){if("function"==typeof t.on)n.once?t.once(e,i):t.on(e,i);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function s(r){n.once&&t.removeEventListener(e,s),i(r)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");l=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var n="error"===t,s=this._events;if(void 0!==s)n=n&&void 0===s.error;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[t];if(void 0===l)return!1;if("function"==typeof l)r(l,this,e);else{var h=l.length,c=m(l,h);for(i=0;i<h;++i)r(c[i],this,e)}return!0},a.prototype.addListener=function(t,e){return _(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return _(this,t,e,!0)},a.prototype.once=function(t,e){return h(e),this.on(t,d(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return h(e),this.prependListener(t,d(this,t,e)),this},a.prototype.removeListener=function(t,e){var i,n,s,r,o;if(h(e),void 0===(n=this._events))return this;if(void 0===(i=n[t]))return this;if(i===e||i.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!=typeof i){for(s=-1,r=i.length-1;r>=0;r--)if(i[r]===e||i[r].listener===e){o=i[r].listener,s=r;break}if(s<0)return this;0===s?i.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(i,s),1===i.length&&(n[t]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",t,o||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[t]),this;if(0===arguments.length){var s,r=Object.keys(i);for(n=0;n<r.length;++n)"removeListener"!==(s=r[n])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=i[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},a.prototype.listeners=function(t){return p(this,t,!0)},a.prototype.rawListeners=function(t){return p(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):f.call(t,e)},a.prototype.listenerCount=f,a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(t,e,i){"undefined"!=typeof WebGLRenderingContext?t.exports=i(84):t.exports=i(85)},function(t,e){t.exports=function(t,e,i){if(e|=0,!((t|=0)>0&&e>0))return null;const n=document.createElement("canvas");if(!n)return null;let s;n.width=t,n.height=e;try{s=n.getContext("webgl",i)}catch(t){try{s=n.getContext("experimental-webgl",i)}catch(t){return null}}const r=s.getExtension,o={destroy:function(){const t=r.call(s,"WEBGL_lose_context");t&&t.loseContext()}},a={resize:function(t,e){n.width=t,n.height=e}},l=s.getSupportedExtensions().slice();return l.push("STACKGL_destroy_context","STACKGL_resize_drawingbuffer"),s.getSupportedExtensions=function(){return l.slice()},s.getExtension=function(t){const e=t.toLowerCase();return"stackgl_resize_drawingbuffer"===e?a:"stackgl_destroy_context"===e?o:r.call(s,t)},s||null}},function(t,e,i){const n=i(24),{WebGLContextAttributes:s}=i(86),{WebGLRenderingContext:r,wrapContext:o}=i(16),{WebGLTextureUnit:a}=i(87),{WebGLVertexArrayObjectState:l,WebGLVertexArrayGlobalState:h}=i(30);let c=0;function _(t,e,i){return t&&"object"==typeof t&&e in t?!!t[e]:i}t.exports=function(t,e,i){if(e|=0,!((t|=0)>0&&e>0))return null;const u=new s(_(i,"alpha",!0),_(i,"depth",!0),_(i,"stencil",!1),!1,_(i,"premultipliedAlpha",!0),_(i,"preserveDrawingBuffer",!1),_(i,"preferLowPowerToHighPerformance",!1),_(i,"failIfMajorPerformanceCaveat",!1));let d;u.premultipliedAlpha=u.premultipliedAlpha&&u.alpha;try{d=new r(1,1,u.alpha,u.depth,u.stencil,u.antialias,u.premultipliedAlpha,u.preserveDrawingBuffer,u.preferLowPowerToHighPerformance,u.failIfMajorPerformanceCaveat)}catch(t){}if(!d)return null;d.drawingBufferWidth=t,d.drawingBufferHeight=e,d._=c++,d._contextAttributes=u,d._extensions={},d._programs={},d._shaders={},d._buffers={},d._textures={},d._framebuffers={},d._renderbuffers={},d._activeProgram=null,d._activeFramebuffer=null,d._activeRenderbuffer=null,d._checkStencil=!1,d._stencilState=!0;const p=d.getParameter(d.MAX_COMBINED_TEXTURE_IMAGE_UNITS);d._textureUnits=new Array(p);for(let t=0;t<p;++t)d._textureUnits[t]=new a(t);d._activeTextureUnit=0,d.activeTexture(d.TEXTURE0),d._errorStack=[],d._defaultVertexObjectState=new l(d),d._vertexObjectState=d._defaultVertexObjectState,d._vertexGlobalState=new h(d),d._maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE),d._maxTextureLevel=n.log2(n.nextPow2(d._maxTextureSize)),d._maxCubeMapSize=d.getParameter(d.MAX_CUBE_MAP_TEXTURE_SIZE),d._maxCubeMapLevel=n.log2(n.nextPow2(d._maxCubeMapSize)),d._unpackAlignment=4,d._packAlignment=4,d._allocateDrawingBuffer(t,e);const f=d.createBuffer();return d._attrib0Buffer=f,d.bindBuffer(d.ARRAY_BUFFER,null),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,null),d.bindFramebuffer(d.FRAMEBUFFER,null),d.bindRenderbuffer(d.RENDERBUFFER,null),d.viewport(0,0,t,e),d.scissor(0,0,t,e),d.clearDepth(1),d.clearColor(0,0,0,0),d.clearStencil(0),d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT|d.STENCIL_BUFFER_BIT),o(d)}},function(t,e){t.exports={WebGLContextAttributes:class{constructor(t,e,i,n,s,r,o,a){this.alpha=t,this.depth=e,this.stencil=i,this.antialias=n,this.premultipliedAlpha=s,this.preserveDrawingBuffer=r,this.preferLowPowerToHighPerformance=o,this.failIfMajorPerformanceCaveat=a}}}},function(t,e){t.exports={WebGLTextureUnit:class{constructor(t,e){this._ctx=t,this._idx=e,this._mode=0,this._bind2D=null,this._bindCube=null}}}},function(t,e,i){(function(e){const{Image:n,CanvasRenderingContext2D:s}=i(15),{WebGLRenderingContext:r}=i(16),o=i(32);t.exports=function(t=e,{mockImage:i=!0}={}){const a=t.HTMLCanvasElement,l=t.HTMLImageElement;t.CanvasRenderingContext2D=s,t.WebGLRenderingContext=r,e.window===t&&e.document&&e.document===t.document&&(e.CanvasRenderingContext2D=s,e.WebGLRenderingContext=r);const h=s.prototype.drawImage;if(s.prototype.drawImage=function(t,...e){if(t instanceof a)t=t._getCanvas();else if(i&&t instanceof l){if(!t._loaded)return;t=t._image}return h.call(this,t,...e)},"function"==typeof a){if(a.prototype._getCanvas=function(){return this._canvas||(this._canvas=new o(this.width,this.height)),this._canvas},a.prototype.getContext=function(t){const e=this._getCanvas();return this._context||(this._context=e.getContext(t)||null,this._context.canvas=this),this._context},a.prototype.toDataURL=function(...t){return this._getCanvas().toDataURL(...t)},a.prototype.toBuffer=function(...t){return this._getCanvas().toBuffer(...t)},Object.defineProperty(a.prototype,"width",{get(){const t=parseInt(this.getAttributeNS(null,"width"),10);return Number.isNaN(t)||t<0||t>2147483647?300:t},set(t){t=t>2147483647?300:t,this.setAttributeNS(null,"width",String(t));this._getCanvas().width=t}}),Object.defineProperty(a.prototype,"height",{get(){const t=parseInt(this.getAttributeNS(null,"height"),10);return Number.isNaN(t)||t<0||t>2147483647?150:t},set(t){t=t>2147483647?150:t,this.setAttributeNS(null,"height",String(t));this._getCanvas().height=t}}),i){if(!Object.getOwnPropertyDescriptor(l.prototype,"__src__")){const e=Object.getOwnPropertyDescriptor(l.prototype,"src");Object.defineProperty(l.prototype,"__src__",e),Object.defineProperty(l.prototype,"src",{get(){return this.__src__},set(e){this._image||(this._image=new n,this._image.onload=()=>{this._loaded=!0,this.dispatchEvent(new t.Event("load"))}),this.__src__=e,this._image.src=this.__src__}}),Object.defineProperty(l.prototype,"width",{get(){if(this.hasAttributeNS(null,"width")){const t=parseInt(this.getAttributeNS(null,"width"),10);return Number.isNaN(t)||t<0?0:t}return this._image?this._image.width:0},set(t){this.setAttributeNS(null,"width",String(t))}}),Object.defineProperty(l.prototype,"height",{get(){if(this.hasAttributeNS(null,"height")){const t=parseInt(this.getAttributeNS(null,"height"),10);return Number.isNaN(t)||t<0?0:t}return this._image?this._image.height:0},set(t){this.setAttributeNS(null,"height",String(t))}})}}return a}throw new TypeError("HTMLCanvasElement is not defined.")}}).call(this,i(28))},,,,function(t,e,i){"use strict";i.r(e),i.d(e,"protocol",(function(){return L})),i.d(e,"Manager",(function(){return W})),i.d(e,"Socket",(function(){return U})),i.d(e,"io",(function(){return j})),i.d(e,"connect",(function(){return j})),i.d(e,"default",(function(){return j}));var n={};i.r(n),i.d(n,"protocol",(function(){return L})),i.d(n,"PacketType",(function(){return D})),i.d(n,"Encoder",(function(){return k})),i.d(n,"Decoder",(function(){return O}));var s=i(10),r=i.n(s);var o=i(34),a=i.n(o),l=i(2),h=function(t){const e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||a.a))return new XMLHttpRequest}catch(t){}if(!e)try{return new(l.a[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}},c=i(3),_=i(1),u=i(8),d=i(13),p=i.n(d),f=i(9),m=i.n(f),g=i(5);class b extends u.a{constructor(){super(...arguments),this.polling=!1}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(t++,this.once("pollComplete",(function(){--t||e()}))),this.writable||(t++,this.once("drain",(function(){--t||e()})))}else e()}poll(){this.polling=!0,this.doPoll(),this.emit("poll")}onData(t){Object(g.b)(t,this.socket.binaryType).forEach(t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose(),!1;this.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,Object(g.d)(t,t=>{this.doWrite(t,()=>{this.writable=!0,this.emit("drain")})})}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let i="";!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=p()()),this.supportsBinary||t.sid||(t.b64=1),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(i=":"+this.opts.port);const n=m.a.encode(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(n.length?"?"+n:"")}}function y(){}const v=null!=new h({xdomain:!1}).responseType;class S extends _.Emitter{constructor(t,e){super(),Object(c.a)(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.create()}create(){const t=Object(c.b)(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new h(t);try{e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(t){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{4===e.readyState&&(200===e.status||1223===e.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof e.status?e.status:0)},0))},e.send(this.data)}catch(t){return void this.setTimeoutFn(()=>{this.onError(t)},0)}"undefined"!=typeof document&&(this.index=S.requestsCount++,S.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(t){this.emit("data",t),this.onSuccess()}onError(t){this.emit("error",t),this.cleanup(!0)}cleanup(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=y,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete S.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&this.onData(t)}abort(){this.cleanup()}}if(S.requestsCount=0,S.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",x);else if("function"==typeof addEventListener){const t="onpagehide"in l.a?"pagehide":"unload";addEventListener(t,x,!1)}function x(){for(let t in S.requests)S.requests.hasOwnProperty(t)&&S.requests[t].abort()}const w={websocket:i(35).a,polling:class extends b{constructor(t){if(super(t),"undefined"!=typeof location){const e="https:"===location.protocol;let i=location.port;i||(i=e?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||i!==t.port,this.xs=t.secure!==e}const e=t&&t.forceBase64;this.supportsBinary=v&&!e}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new S(this.uri(),t)}doWrite(t,e){const i=this.request({method:"POST",data:t});i.on("success",e),i.on("error",t=>{this.onError("xhr post error",t)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",t=>{this.onError("xhr poll error",t)}),this.pollXhr=t}}};class C extends _.Emitter{constructor(t,e={}){super(),t&&"object"==typeof t&&(e=t,t=null),t?(t=r()(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=r()(e.host).host),Object(c.a)(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=m.a.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const e=function(t){const e={};for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}(this.opts.query);e.EIO=g.e,e.transport=t,this.id&&(e.sid=this.id);const i=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new w[t](i)}open(){let t;if(this.opts.rememberUpgrade&&C.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",()=>{this.onClose("transport close")})}probe(t){let e=this.createTransport(t),i=!1;C.priorWebsocketSuccess=!1;const n=()=>{i||(e.send([{type:"ping",data:"probe"}]),e.once("packet",t=>{if(!i)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;C.priorWebsocketSuccess="websocket"===e.name,this.transport.pause(()=>{i||"closed"!==this.readyState&&(h(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}}))};function s(){i||(i=!0,h(),e.close(),e=null)}const r=t=>{const i=new Error("probe error: "+t);i.transport=e.name,s(),this.emitReserved("upgradeError",i)};function o(){r("transport closed")}function a(){r("socket closed")}function l(t){e&&t.name!==e.name&&s()}const h=()=>{e.removeListener("open",n),e.removeListener("error",r),e.removeListener("close",o),this.off("close",a),this.off("upgrading",l)};e.once("open",n),e.once("error",r),e.once("close",o),this.once("close",a),this.once("upgrading",l),e.open()}onOpen(){if(this.readyState="open",C.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))}write(t,e,i){return this.sendPacket("message",t,e,i),this}send(t,e,i){return this.sendPacket("message",t,e,i),this}sendPacket(t,e,i,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof i&&(n=i,i=null),"closing"===this.readyState||"closed"===this.readyState)return;(i=i||{}).compress=!1!==i.compress;const s={type:t,data:e,options:i};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},i=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}onError(t){C.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let i=0;const n=t.length;for(;i<n;i++)~this.transports.indexOf(t[i])&&e.push(t[i]);return e}}C.protocol=g.e;C.protocol;const T="function"==typeof ArrayBuffer,A=Object.prototype.toString,E="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===A.call(Blob),M="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===A.call(File);function R(t){return T&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||E&&t instanceof Blob||M&&t instanceof File}function I(t){const e=[],i=t.data,n=t;return n.data=function t(e,i){if(!e)return e;if(R(e)){const t={_placeholder:!0,num:i.length};return i.push(e),t}if(Array.isArray(e)){const n=new Array(e.length);for(let s=0;s<e.length;s++)n[s]=t(e[s],i);return n}if("object"==typeof e&&!(e instanceof Date)){const n={};for(const s in e)e.hasOwnProperty(s)&&(n[s]=t(e[s],i));return n}return e}(i,e),n.attachments=e.length,{packet:n,buffers:e}}function P(t,e){return t.data=function t(e,i){if(!e)return e;if(e&&e._placeholder)return i[e.num];if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=t(e[n],i);else if("object"==typeof e)for(const n in e)e.hasOwnProperty(n)&&(e[n]=t(e[n],i));return e}(t.data,e),t.attachments=void 0,t}const L=5;var D;!function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(D||(D={}));class k{encode(t){return t.type!==D.EVENT&&t.type!==D.ACK||!function t(e,i){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let i=0,n=e.length;i<n;i++)if(t(e[i]))return!0;return!1}if(R(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return t(e.toJSON(),!0);for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&t(e[i]))return!0;return!1}(t)?[this.encodeAsString(t)]:(t.type=t.type===D.EVENT?D.BINARY_EVENT:D.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let e=""+t.type;return t.type!==D.BINARY_EVENT&&t.type!==D.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data)),e}encodeAsBinary(t){const e=I(t),i=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(i),n}}class O extends _.Emitter{constructor(){super()}add(t){let e;if("string"==typeof t)e=this.decodeString(t),e.type===D.BINARY_EVENT||e.type===D.BINARY_ACK?(this.reconstructor=new F(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e);else{if(!R(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const i={type:Number(t.charAt(0))};if(void 0===D[i.type])throw new Error("unknown packet type "+i.type);if(i.type===D.BINARY_EVENT||i.type===D.BINARY_ACK){const n=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const s=t.substring(n,e);if(s!=Number(s)||"-"!==t.charAt(e))throw new Error("Illegal attachments");i.attachments=Number(s)}if("/"===t.charAt(e+1)){const n=e+1;for(;++e;){if(","===t.charAt(e))break;if(e===t.length)break}i.nsp=t.substring(n,e)}else i.nsp="/";const n=t.charAt(e+1);if(""!==n&&Number(n)==n){const n=e+1;for(;++e;){const i=t.charAt(e);if(null==i||Number(i)!=i){--e;break}if(e===t.length)break}i.id=Number(t.substring(n,e+1))}if(t.charAt(++e)){const n=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(e));if(!O.isPayloadValid(i.type,n))throw new Error("invalid payload");i.data=n}return i}static isPayloadValid(t,e){switch(t){case D.CONNECT:return"object"==typeof e;case D.DISCONNECT:return void 0===e;case D.CONNECT_ERROR:return"string"==typeof e||"object"==typeof e;case D.EVENT:case D.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case D.ACK:case D.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class F{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=P(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function B(t,e,i){return t.on(e,i),function(){t.off(e,i)}}const N=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class U extends _.Emitter{constructor(t,e,i){super(),this.connected=!1,this.disconnected=!0,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const t=this.io;this.subs=[B(t,"open",this.onopen.bind(this)),B(t,"packet",this.onpacket.bind(this)),B(t,"error",this.onerror.bind(this)),B(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(N.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);const i={type:D.EVENT,data:e,options:{}};i.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(this.acks[this.ids]=e.pop(),i.id=this.ids++);const n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)||(this.connected?this.packet(i):this.sendBuffer.push(i)),this.flags={},this}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth(t=>{this.packet({type:D.CONNECT,data:t})}):this.packet({type:D.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t){this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",t)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case D.CONNECT:if(t.data&&t.data.sid){const e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case D.EVENT:case D.BINARY_EVENT:this.onevent(t);break;case D.ACK:case D.BINARY_ACK:this.onack(t);break;case D.DISCONNECT:this.ondisconnect();break;case D.CONNECT_ERROR:const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const i of e)i.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let i=!1;return function(...n){i||(i=!0,e.packet({type:D.ACK,id:t,data:n}))}}onack(t){const e=this.acks[t.id];"function"==typeof e&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>this.packet(t)),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:D.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}var V=i(36),z=i.n(V);class W extends _.Emitter{constructor(t,e){var i;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,Object(c.a)(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(i=e.randomizationFactor)&&void 0!==i?i:.5),this.backoff=new z.a({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const s=e.parser||n;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new C(this.uri,this.opts);const e=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const n=B(e,"open",(function(){i.onopen(),t&&t()})),s=B(e,"error",e=>{i.cleanup(),i._readyState="closed",this.emitReserved("error",e),t?t(e):i.maybeReconnectOnOpen()});if(!1!==this._timeout){const t=this._timeout;0===t&&n();const i=this.setTimeoutFn(()=>{n(),e.close(),e.emit("error",new Error("timeout"))},t);this.opts.autoUnref&&i.unref(),this.subs.push((function(){clearTimeout(i)}))}return this.subs.push(n),this.subs.push(s),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(B(t,"ping",this.onping.bind(this)),B(t,"data",this.ondata.bind(this)),B(t,"error",this.onerror.bind(this)),B(t,"close",this.onclose.bind(this)),B(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,e){let i=this.nsps[t];return i||(i=new U(this,t,e),this.nsps[t]=i),i}_destroy(t){const e=Object.keys(this.nsps);for(const t of e){if(this.nsps[t].active)return}this._close()}_packet(t){const e=this.encoder.encode(t);for(let i=0;i<e.length;i++)this.engine.write(e[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,"opening"===this._readyState&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open(e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()}))},e);this.opts.autoUnref&&i.unref(),this.subs.push((function(){clearTimeout(i)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const G={};function j(t,e){"object"==typeof t&&(e=t,t=void 0);const i=function(t,e="",i){let n=t;i=i||"undefined"!=typeof location&&location,null==t&&(t=i.protocol+"//"+i.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?i.protocol+t:i.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==i?i.protocol+"//"+t:"https://"+t),n=r()(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const s=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+e,n.href=n.protocol+"://"+s+(i&&i.port===n.port?"":":"+n.port),n}(t,(e=e||{}).path||"/socket.io"),n=i.source,s=i.id,o=i.path,a=G[s]&&o in G[s].nsps;let l;return e.forceNew||e["force new connection"]||!1===e.multiplex||a?l=new W(n,e):(G[s]||(G[s]=new W(n,e)),l=G[s]),i.query&&!e.query&&(e.query=i.queryKey),l.socket(i.path,e)}Object.assign(j,{Manager:W,Socket:U,io:j,connect:j})}]]);